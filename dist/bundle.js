/*! For license information please see bundle.js.LICENSE.txt */
(()=>{var t,e,n={4042:function(t){t.exports=function(t){function e(i){if(n[i])return n[i].exports;var a=n[i]={exports:{},id:i,loaded:!1};return t[i].call(a.exports,a,a.exports,e),a.loaded=!0,a.exports}var n={};return e.m=t,e.c=n,e.p="dist/",e(0)}([function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var a=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},r=(i(n(1)),n(6)),o=i(r),s=i(n(7)),l=i(n(8)),c=i(n(9)),u=i(n(10)),h=i(n(11)),d=i(n(14)),p=[],f=!1,m={offset:120,delay:0,easing:"ease",duration:400,disable:!1,once:!1,startEvent:"DOMContentLoaded",throttleDelay:99,debounceDelay:50,disableMutationObserver:!1},g=function(){if(arguments.length>0&&void 0!==arguments[0]&&arguments[0]&&(f=!0),f)return p=(0,h.default)(p,m),(0,u.default)(p,m.once),p},_=function(){p=(0,d.default)(),g()};t.exports={init:function(t){m=a(m,t),p=(0,d.default)();var e=document.all&&!window.atob;return function(t){return!0===t||"mobile"===t&&c.default.mobile()||"phone"===t&&c.default.phone()||"tablet"===t&&c.default.tablet()||"function"==typeof t&&!0===t()}(m.disable)||e?void p.forEach((function(t,e){t.node.removeAttribute("data-aos"),t.node.removeAttribute("data-aos-easing"),t.node.removeAttribute("data-aos-duration"),t.node.removeAttribute("data-aos-delay")})):(m.disableMutationObserver||l.default.isSupported()||(console.info('\n      aos: MutationObserver is not supported on this browser,\n      code mutations observing has been disabled.\n      You may have to call "refreshHard()" by yourself.\n    '),m.disableMutationObserver=!0),document.querySelector("body").setAttribute("data-aos-easing",m.easing),document.querySelector("body").setAttribute("data-aos-duration",m.duration),document.querySelector("body").setAttribute("data-aos-delay",m.delay),"DOMContentLoaded"===m.startEvent&&["complete","interactive"].indexOf(document.readyState)>-1?g(!0):"load"===m.startEvent?window.addEventListener(m.startEvent,(function(){g(!0)})):document.addEventListener(m.startEvent,(function(){g(!0)})),window.addEventListener("resize",(0,s.default)(g,m.debounceDelay,!0)),window.addEventListener("orientationchange",(0,s.default)(g,m.debounceDelay,!0)),window.addEventListener("scroll",(0,o.default)((function(){(0,u.default)(p,m.once)}),m.throttleDelay)),m.disableMutationObserver||l.default.ready("[data-aos]",_),p)},refresh:g,refreshHard:_}},function(t,e){},,,,,function(t,e){(function(e){"use strict";function n(t,e,n){function a(e){var n=h,i=d;return h=d=void 0,_=e,f=t.apply(i,n)}function o(t){var n=t-g;return void 0===g||n>=e||n<0||w&&t-_>=p}function l(){var t=b();return o(t)?c(t):void(m=setTimeout(l,function(t){var n=e-(t-g);return w?v(n,p-(t-_)):n}(t)))}function c(t){return m=void 0,A&&h?a(t):(h=d=void 0,f)}function u(){var t=b(),n=o(t);if(h=arguments,d=this,g=t,n){if(void 0===m)return function(t){return _=t,m=setTimeout(l,e),y?a(t):f}(g);if(w)return m=setTimeout(l,e),a(g)}return void 0===m&&(m=setTimeout(l,e)),f}var h,d,p,f,m,g,_=0,y=!1,w=!1,A=!0;if("function"!=typeof t)throw new TypeError(s);return e=r(e)||0,i(n)&&(y=!!n.leading,p=(w="maxWait"in n)?x(r(n.maxWait)||0,e):p,A="trailing"in n?!!n.trailing:A),u.cancel=function(){void 0!==m&&clearTimeout(m),_=0,h=g=d=m=void 0},u.flush=function(){return void 0===m?f:c(b())},u}function i(t){var e=void 0===t?"undefined":o(t);return!!t&&("object"==e||"function"==e)}function a(t){return"symbol"==(void 0===t?"undefined":o(t))||function(t){return!!t&&"object"==(void 0===t?"undefined":o(t))}(t)&&y.call(t)==c}function r(t){if("number"==typeof t)return t;if(a(t))return l;if(i(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=i(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(u,"");var n=d.test(t);return n||p.test(t)?f(t.slice(2),n?2:8):h.test(t)?l:+t}var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s="Expected a function",l=NaN,c="[object Symbol]",u=/^\s+|\s+$/g,h=/^[-+]0x[0-9a-f]+$/i,d=/^0b[01]+$/i,p=/^0o[0-7]+$/i,f=parseInt,m="object"==(void 0===e?"undefined":o(e))&&e&&e.Object===Object&&e,g="object"==("undefined"==typeof self?"undefined":o(self))&&self&&self.Object===Object&&self,_=m||g||Function("return this")(),y=Object.prototype.toString,x=Math.max,v=Math.min,b=function(){return _.Date.now()};t.exports=function(t,e,a){var r=!0,o=!0;if("function"!=typeof t)throw new TypeError(s);return i(a)&&(r="leading"in a?!!a.leading:r,o="trailing"in a?!!a.trailing:o),n(t,e,{leading:r,maxWait:e,trailing:o})}}).call(e,function(){return this}())},function(t,e){(function(e){"use strict";function n(t){var e=void 0===t?"undefined":r(t);return!!t&&("object"==e||"function"==e)}function i(t){return"symbol"==(void 0===t?"undefined":r(t))||function(t){return!!t&&"object"==(void 0===t?"undefined":r(t))}(t)&&_.call(t)==l}function a(t){if("number"==typeof t)return t;if(i(t))return s;if(n(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=n(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(c,"");var a=h.test(t);return a||d.test(t)?p(t.slice(2),a?2:8):u.test(t)?s:+t}var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o="Expected a function",s=NaN,l="[object Symbol]",c=/^\s+|\s+$/g,u=/^[-+]0x[0-9a-f]+$/i,h=/^0b[01]+$/i,d=/^0o[0-7]+$/i,p=parseInt,f="object"==(void 0===e?"undefined":r(e))&&e&&e.Object===Object&&e,m="object"==("undefined"==typeof self?"undefined":r(self))&&self&&self.Object===Object&&self,g=f||m||Function("return this")(),_=Object.prototype.toString,y=Math.max,x=Math.min,v=function(){return g.Date.now()};t.exports=function(t,e,i){function r(e){var n=h,i=d;return h=d=void 0,_=e,f=t.apply(i,n)}function s(t){var n=t-g;return void 0===g||n>=e||n<0||w&&t-_>=p}function l(){var t=v();return s(t)?c(t):void(m=setTimeout(l,function(t){var n=e-(t-g);return w?x(n,p-(t-_)):n}(t)))}function c(t){return m=void 0,A&&h?r(t):(h=d=void 0,f)}function u(){var t=v(),n=s(t);if(h=arguments,d=this,g=t,n){if(void 0===m)return function(t){return _=t,m=setTimeout(l,e),b?r(t):f}(g);if(w)return m=setTimeout(l,e),r(g)}return void 0===m&&(m=setTimeout(l,e)),f}var h,d,p,f,m,g,_=0,b=!1,w=!1,A=!0;if("function"!=typeof t)throw new TypeError(o);return e=a(e)||0,n(i)&&(b=!!i.leading,p=(w="maxWait"in i)?y(a(i.maxWait)||0,e):p,A="trailing"in i?!!i.trailing:A),u.cancel=function(){void 0!==m&&clearTimeout(m),_=0,h=g=d=m=void 0},u.flush=function(){return void 0===m?f:c(v())},u}}).call(e,function(){return this}())},function(t,e){"use strict";function n(t){var e=void 0,i=void 0;for(e=0;e<t.length;e+=1){if((i=t[e]).dataset&&i.dataset.aos)return!0;if(i.children&&n(i.children))return!0}return!1}function i(){return window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver}function a(t){t&&t.forEach((function(t){var e=Array.prototype.slice.call(t.addedNodes),i=Array.prototype.slice.call(t.removedNodes);if(n(e.concat(i)))return r()}))}Object.defineProperty(e,"__esModule",{value:!0});var r=function(){};e.default={isSupported:function(){return!!i()},ready:function(t,e){var n=window.document,o=new(i())(a);r=e,o.observe(n.documentElement,{childList:!0,subtree:!0,removedNodes:!0})}}},function(t,e){"use strict";function n(){return navigator.userAgent||navigator.vendor||window.opera||""}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),a=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i,r=/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i,o=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i,s=/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i,l=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return i(t,[{key:"phone",value:function(){var t=n();return!(!a.test(t)&&!r.test(t.substr(0,4)))}},{key:"mobile",value:function(){var t=n();return!(!o.test(t)&&!s.test(t.substr(0,4)))}},{key:"tablet",value:function(){return this.mobile()&&!this.phone()}}]),t}();e.default=new l},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.default=function(t,e){var n=window.pageYOffset,i=window.innerHeight;t.forEach((function(t,a){!function(t,e,n){var i=t.node.getAttribute("data-aos-once");e>t.position?t.node.classList.add("aos-animate"):void 0!==i&&("false"===i||!n&&"true"!==i)&&t.node.classList.remove("aos-animate")}(t,i+n,e)}))}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(t){return t&&t.__esModule?t:{default:t}}(n(12));e.default=function(t,e){return t.forEach((function(t,n){t.node.classList.add("aos-init"),t.position=(0,i.default)(t.node,e.offset)})),t}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(t){return t&&t.__esModule?t:{default:t}}(n(13));e.default=function(t,e){var n=0,a=0,r=window.innerHeight,o={offset:t.getAttribute("data-aos-offset"),anchor:t.getAttribute("data-aos-anchor"),anchorPlacement:t.getAttribute("data-aos-anchor-placement")};switch(o.offset&&!isNaN(o.offset)&&(a=parseInt(o.offset)),o.anchor&&document.querySelectorAll(o.anchor)&&(t=document.querySelectorAll(o.anchor)[0]),n=(0,i.default)(t).top,o.anchorPlacement){case"top-bottom":break;case"center-bottom":n+=t.offsetHeight/2;break;case"bottom-bottom":n+=t.offsetHeight;break;case"top-center":n+=r/2;break;case"bottom-center":n+=r/2+t.offsetHeight;break;case"center-center":n+=r/2+t.offsetHeight/2;break;case"top-top":n+=r;break;case"bottom-top":n+=t.offsetHeight+r;break;case"center-top":n+=t.offsetHeight/2+r}return o.anchorPlacement||o.offset||isNaN(e)||(a=e),n+a}},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.default=function(t){for(var e=0,n=0;t&&!isNaN(t.offsetLeft)&&!isNaN(t.offsetTop);)e+=t.offsetLeft-("BODY"!=t.tagName?t.scrollLeft:0),n+=t.offsetTop-("BODY"!=t.tagName?t.scrollTop:0),t=t.offsetParent;return{top:n,left:e}}},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.default=function(t){return t=t||document.querySelectorAll("[data-aos]"),Array.prototype.map.call(t,(function(t){return{node:t}}))}}])},5441:(t,e,n)=>{"use strict";n.d(e,{A:()=>s});var i=n(1354),a=n.n(i),r=n(6314),o=n.n(r)()(a());o.push([t.id,'[data-aos][data-aos][data-aos-duration="50"],body[data-aos-duration="50"] [data-aos]{transition-duration:50ms}[data-aos][data-aos][data-aos-delay="50"],body[data-aos-delay="50"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="50"].aos-animate,body[data-aos-delay="50"] [data-aos].aos-animate{transition-delay:50ms}[data-aos][data-aos][data-aos-duration="100"],body[data-aos-duration="100"] [data-aos]{transition-duration:.1s}[data-aos][data-aos][data-aos-delay="100"],body[data-aos-delay="100"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="100"].aos-animate,body[data-aos-delay="100"] [data-aos].aos-animate{transition-delay:.1s}[data-aos][data-aos][data-aos-duration="150"],body[data-aos-duration="150"] [data-aos]{transition-duration:.15s}[data-aos][data-aos][data-aos-delay="150"],body[data-aos-delay="150"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="150"].aos-animate,body[data-aos-delay="150"] [data-aos].aos-animate{transition-delay:.15s}[data-aos][data-aos][data-aos-duration="200"],body[data-aos-duration="200"] [data-aos]{transition-duration:.2s}[data-aos][data-aos][data-aos-delay="200"],body[data-aos-delay="200"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="200"].aos-animate,body[data-aos-delay="200"] [data-aos].aos-animate{transition-delay:.2s}[data-aos][data-aos][data-aos-duration="250"],body[data-aos-duration="250"] [data-aos]{transition-duration:.25s}[data-aos][data-aos][data-aos-delay="250"],body[data-aos-delay="250"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="250"].aos-animate,body[data-aos-delay="250"] [data-aos].aos-animate{transition-delay:.25s}[data-aos][data-aos][data-aos-duration="300"],body[data-aos-duration="300"] [data-aos]{transition-duration:.3s}[data-aos][data-aos][data-aos-delay="300"],body[data-aos-delay="300"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="300"].aos-animate,body[data-aos-delay="300"] [data-aos].aos-animate{transition-delay:.3s}[data-aos][data-aos][data-aos-duration="350"],body[data-aos-duration="350"] [data-aos]{transition-duration:.35s}[data-aos][data-aos][data-aos-delay="350"],body[data-aos-delay="350"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="350"].aos-animate,body[data-aos-delay="350"] [data-aos].aos-animate{transition-delay:.35s}[data-aos][data-aos][data-aos-duration="400"],body[data-aos-duration="400"] [data-aos]{transition-duration:.4s}[data-aos][data-aos][data-aos-delay="400"],body[data-aos-delay="400"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="400"].aos-animate,body[data-aos-delay="400"] [data-aos].aos-animate{transition-delay:.4s}[data-aos][data-aos][data-aos-duration="450"],body[data-aos-duration="450"] [data-aos]{transition-duration:.45s}[data-aos][data-aos][data-aos-delay="450"],body[data-aos-delay="450"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="450"].aos-animate,body[data-aos-delay="450"] [data-aos].aos-animate{transition-delay:.45s}[data-aos][data-aos][data-aos-duration="500"],body[data-aos-duration="500"] [data-aos]{transition-duration:.5s}[data-aos][data-aos][data-aos-delay="500"],body[data-aos-delay="500"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="500"].aos-animate,body[data-aos-delay="500"] [data-aos].aos-animate{transition-delay:.5s}[data-aos][data-aos][data-aos-duration="550"],body[data-aos-duration="550"] [data-aos]{transition-duration:.55s}[data-aos][data-aos][data-aos-delay="550"],body[data-aos-delay="550"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="550"].aos-animate,body[data-aos-delay="550"] [data-aos].aos-animate{transition-delay:.55s}[data-aos][data-aos][data-aos-duration="600"],body[data-aos-duration="600"] [data-aos]{transition-duration:.6s}[data-aos][data-aos][data-aos-delay="600"],body[data-aos-delay="600"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="600"].aos-animate,body[data-aos-delay="600"] [data-aos].aos-animate{transition-delay:.6s}[data-aos][data-aos][data-aos-duration="650"],body[data-aos-duration="650"] [data-aos]{transition-duration:.65s}[data-aos][data-aos][data-aos-delay="650"],body[data-aos-delay="650"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="650"].aos-animate,body[data-aos-delay="650"] [data-aos].aos-animate{transition-delay:.65s}[data-aos][data-aos][data-aos-duration="700"],body[data-aos-duration="700"] [data-aos]{transition-duration:.7s}[data-aos][data-aos][data-aos-delay="700"],body[data-aos-delay="700"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="700"].aos-animate,body[data-aos-delay="700"] [data-aos].aos-animate{transition-delay:.7s}[data-aos][data-aos][data-aos-duration="750"],body[data-aos-duration="750"] [data-aos]{transition-duration:.75s}[data-aos][data-aos][data-aos-delay="750"],body[data-aos-delay="750"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="750"].aos-animate,body[data-aos-delay="750"] [data-aos].aos-animate{transition-delay:.75s}[data-aos][data-aos][data-aos-duration="800"],body[data-aos-duration="800"] [data-aos]{transition-duration:.8s}[data-aos][data-aos][data-aos-delay="800"],body[data-aos-delay="800"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="800"].aos-animate,body[data-aos-delay="800"] [data-aos].aos-animate{transition-delay:.8s}[data-aos][data-aos][data-aos-duration="850"],body[data-aos-duration="850"] [data-aos]{transition-duration:.85s}[data-aos][data-aos][data-aos-delay="850"],body[data-aos-delay="850"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="850"].aos-animate,body[data-aos-delay="850"] [data-aos].aos-animate{transition-delay:.85s}[data-aos][data-aos][data-aos-duration="900"],body[data-aos-duration="900"] [data-aos]{transition-duration:.9s}[data-aos][data-aos][data-aos-delay="900"],body[data-aos-delay="900"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="900"].aos-animate,body[data-aos-delay="900"] [data-aos].aos-animate{transition-delay:.9s}[data-aos][data-aos][data-aos-duration="950"],body[data-aos-duration="950"] [data-aos]{transition-duration:.95s}[data-aos][data-aos][data-aos-delay="950"],body[data-aos-delay="950"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="950"].aos-animate,body[data-aos-delay="950"] [data-aos].aos-animate{transition-delay:.95s}[data-aos][data-aos][data-aos-duration="1000"],body[data-aos-duration="1000"] [data-aos]{transition-duration:1s}[data-aos][data-aos][data-aos-delay="1000"],body[data-aos-delay="1000"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="1000"].aos-animate,body[data-aos-delay="1000"] [data-aos].aos-animate{transition-delay:1s}[data-aos][data-aos][data-aos-duration="1050"],body[data-aos-duration="1050"] [data-aos]{transition-duration:1.05s}[data-aos][data-aos][data-aos-delay="1050"],body[data-aos-delay="1050"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="1050"].aos-animate,body[data-aos-delay="1050"] [data-aos].aos-animate{transition-delay:1.05s}[data-aos][data-aos][data-aos-duration="1100"],body[data-aos-duration="1100"] [data-aos]{transition-duration:1.1s}[data-aos][data-aos][data-aos-delay="1100"],body[data-aos-delay="1100"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="1100"].aos-animate,body[data-aos-delay="1100"] [data-aos].aos-animate{transition-delay:1.1s}[data-aos][data-aos][data-aos-duration="1150"],body[data-aos-duration="1150"] [data-aos]{transition-duration:1.15s}[data-aos][data-aos][data-aos-delay="1150"],body[data-aos-delay="1150"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="1150"].aos-animate,body[data-aos-delay="1150"] [data-aos].aos-animate{transition-delay:1.15s}[data-aos][data-aos][data-aos-duration="1200"],body[data-aos-duration="1200"] [data-aos]{transition-duration:1.2s}[data-aos][data-aos][data-aos-delay="1200"],body[data-aos-delay="1200"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="1200"].aos-animate,body[data-aos-delay="1200"] [data-aos].aos-animate{transition-delay:1.2s}[data-aos][data-aos][data-aos-duration="1250"],body[data-aos-duration="1250"] [data-aos]{transition-duration:1.25s}[data-aos][data-aos][data-aos-delay="1250"],body[data-aos-delay="1250"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="1250"].aos-animate,body[data-aos-delay="1250"] [data-aos].aos-animate{transition-delay:1.25s}[data-aos][data-aos][data-aos-duration="1300"],body[data-aos-duration="1300"] [data-aos]{transition-duration:1.3s}[data-aos][data-aos][data-aos-delay="1300"],body[data-aos-delay="1300"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="1300"].aos-animate,body[data-aos-delay="1300"] [data-aos].aos-animate{transition-delay:1.3s}[data-aos][data-aos][data-aos-duration="1350"],body[data-aos-duration="1350"] [data-aos]{transition-duration:1.35s}[data-aos][data-aos][data-aos-delay="1350"],body[data-aos-delay="1350"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="1350"].aos-animate,body[data-aos-delay="1350"] [data-aos].aos-animate{transition-delay:1.35s}[data-aos][data-aos][data-aos-duration="1400"],body[data-aos-duration="1400"] [data-aos]{transition-duration:1.4s}[data-aos][data-aos][data-aos-delay="1400"],body[data-aos-delay="1400"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="1400"].aos-animate,body[data-aos-delay="1400"] [data-aos].aos-animate{transition-delay:1.4s}[data-aos][data-aos][data-aos-duration="1450"],body[data-aos-duration="1450"] [data-aos]{transition-duration:1.45s}[data-aos][data-aos][data-aos-delay="1450"],body[data-aos-delay="1450"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="1450"].aos-animate,body[data-aos-delay="1450"] [data-aos].aos-animate{transition-delay:1.45s}[data-aos][data-aos][data-aos-duration="1500"],body[data-aos-duration="1500"] [data-aos]{transition-duration:1.5s}[data-aos][data-aos][data-aos-delay="1500"],body[data-aos-delay="1500"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="1500"].aos-animate,body[data-aos-delay="1500"] [data-aos].aos-animate{transition-delay:1.5s}[data-aos][data-aos][data-aos-duration="1550"],body[data-aos-duration="1550"] [data-aos]{transition-duration:1.55s}[data-aos][data-aos][data-aos-delay="1550"],body[data-aos-delay="1550"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="1550"].aos-animate,body[data-aos-delay="1550"] [data-aos].aos-animate{transition-delay:1.55s}[data-aos][data-aos][data-aos-duration="1600"],body[data-aos-duration="1600"] [data-aos]{transition-duration:1.6s}[data-aos][data-aos][data-aos-delay="1600"],body[data-aos-delay="1600"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="1600"].aos-animate,body[data-aos-delay="1600"] [data-aos].aos-animate{transition-delay:1.6s}[data-aos][data-aos][data-aos-duration="1650"],body[data-aos-duration="1650"] [data-aos]{transition-duration:1.65s}[data-aos][data-aos][data-aos-delay="1650"],body[data-aos-delay="1650"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="1650"].aos-animate,body[data-aos-delay="1650"] [data-aos].aos-animate{transition-delay:1.65s}[data-aos][data-aos][data-aos-duration="1700"],body[data-aos-duration="1700"] [data-aos]{transition-duration:1.7s}[data-aos][data-aos][data-aos-delay="1700"],body[data-aos-delay="1700"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="1700"].aos-animate,body[data-aos-delay="1700"] [data-aos].aos-animate{transition-delay:1.7s}[data-aos][data-aos][data-aos-duration="1750"],body[data-aos-duration="1750"] [data-aos]{transition-duration:1.75s}[data-aos][data-aos][data-aos-delay="1750"],body[data-aos-delay="1750"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="1750"].aos-animate,body[data-aos-delay="1750"] [data-aos].aos-animate{transition-delay:1.75s}[data-aos][data-aos][data-aos-duration="1800"],body[data-aos-duration="1800"] [data-aos]{transition-duration:1.8s}[data-aos][data-aos][data-aos-delay="1800"],body[data-aos-delay="1800"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="1800"].aos-animate,body[data-aos-delay="1800"] [data-aos].aos-animate{transition-delay:1.8s}[data-aos][data-aos][data-aos-duration="1850"],body[data-aos-duration="1850"] [data-aos]{transition-duration:1.85s}[data-aos][data-aos][data-aos-delay="1850"],body[data-aos-delay="1850"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="1850"].aos-animate,body[data-aos-delay="1850"] [data-aos].aos-animate{transition-delay:1.85s}[data-aos][data-aos][data-aos-duration="1900"],body[data-aos-duration="1900"] [data-aos]{transition-duration:1.9s}[data-aos][data-aos][data-aos-delay="1900"],body[data-aos-delay="1900"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="1900"].aos-animate,body[data-aos-delay="1900"] [data-aos].aos-animate{transition-delay:1.9s}[data-aos][data-aos][data-aos-duration="1950"],body[data-aos-duration="1950"] [data-aos]{transition-duration:1.95s}[data-aos][data-aos][data-aos-delay="1950"],body[data-aos-delay="1950"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="1950"].aos-animate,body[data-aos-delay="1950"] [data-aos].aos-animate{transition-delay:1.95s}[data-aos][data-aos][data-aos-duration="2000"],body[data-aos-duration="2000"] [data-aos]{transition-duration:2s}[data-aos][data-aos][data-aos-delay="2000"],body[data-aos-delay="2000"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="2000"].aos-animate,body[data-aos-delay="2000"] [data-aos].aos-animate{transition-delay:2s}[data-aos][data-aos][data-aos-duration="2050"],body[data-aos-duration="2050"] [data-aos]{transition-duration:2.05s}[data-aos][data-aos][data-aos-delay="2050"],body[data-aos-delay="2050"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="2050"].aos-animate,body[data-aos-delay="2050"] [data-aos].aos-animate{transition-delay:2.05s}[data-aos][data-aos][data-aos-duration="2100"],body[data-aos-duration="2100"] [data-aos]{transition-duration:2.1s}[data-aos][data-aos][data-aos-delay="2100"],body[data-aos-delay="2100"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="2100"].aos-animate,body[data-aos-delay="2100"] [data-aos].aos-animate{transition-delay:2.1s}[data-aos][data-aos][data-aos-duration="2150"],body[data-aos-duration="2150"] [data-aos]{transition-duration:2.15s}[data-aos][data-aos][data-aos-delay="2150"],body[data-aos-delay="2150"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="2150"].aos-animate,body[data-aos-delay="2150"] [data-aos].aos-animate{transition-delay:2.15s}[data-aos][data-aos][data-aos-duration="2200"],body[data-aos-duration="2200"] [data-aos]{transition-duration:2.2s}[data-aos][data-aos][data-aos-delay="2200"],body[data-aos-delay="2200"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="2200"].aos-animate,body[data-aos-delay="2200"] [data-aos].aos-animate{transition-delay:2.2s}[data-aos][data-aos][data-aos-duration="2250"],body[data-aos-duration="2250"] [data-aos]{transition-duration:2.25s}[data-aos][data-aos][data-aos-delay="2250"],body[data-aos-delay="2250"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="2250"].aos-animate,body[data-aos-delay="2250"] [data-aos].aos-animate{transition-delay:2.25s}[data-aos][data-aos][data-aos-duration="2300"],body[data-aos-duration="2300"] [data-aos]{transition-duration:2.3s}[data-aos][data-aos][data-aos-delay="2300"],body[data-aos-delay="2300"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="2300"].aos-animate,body[data-aos-delay="2300"] [data-aos].aos-animate{transition-delay:2.3s}[data-aos][data-aos][data-aos-duration="2350"],body[data-aos-duration="2350"] [data-aos]{transition-duration:2.35s}[data-aos][data-aos][data-aos-delay="2350"],body[data-aos-delay="2350"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="2350"].aos-animate,body[data-aos-delay="2350"] [data-aos].aos-animate{transition-delay:2.35s}[data-aos][data-aos][data-aos-duration="2400"],body[data-aos-duration="2400"] [data-aos]{transition-duration:2.4s}[data-aos][data-aos][data-aos-delay="2400"],body[data-aos-delay="2400"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="2400"].aos-animate,body[data-aos-delay="2400"] [data-aos].aos-animate{transition-delay:2.4s}[data-aos][data-aos][data-aos-duration="2450"],body[data-aos-duration="2450"] [data-aos]{transition-duration:2.45s}[data-aos][data-aos][data-aos-delay="2450"],body[data-aos-delay="2450"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="2450"].aos-animate,body[data-aos-delay="2450"] [data-aos].aos-animate{transition-delay:2.45s}[data-aos][data-aos][data-aos-duration="2500"],body[data-aos-duration="2500"] [data-aos]{transition-duration:2.5s}[data-aos][data-aos][data-aos-delay="2500"],body[data-aos-delay="2500"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="2500"].aos-animate,body[data-aos-delay="2500"] [data-aos].aos-animate{transition-delay:2.5s}[data-aos][data-aos][data-aos-duration="2550"],body[data-aos-duration="2550"] [data-aos]{transition-duration:2.55s}[data-aos][data-aos][data-aos-delay="2550"],body[data-aos-delay="2550"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="2550"].aos-animate,body[data-aos-delay="2550"] [data-aos].aos-animate{transition-delay:2.55s}[data-aos][data-aos][data-aos-duration="2600"],body[data-aos-duration="2600"] [data-aos]{transition-duration:2.6s}[data-aos][data-aos][data-aos-delay="2600"],body[data-aos-delay="2600"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="2600"].aos-animate,body[data-aos-delay="2600"] [data-aos].aos-animate{transition-delay:2.6s}[data-aos][data-aos][data-aos-duration="2650"],body[data-aos-duration="2650"] [data-aos]{transition-duration:2.65s}[data-aos][data-aos][data-aos-delay="2650"],body[data-aos-delay="2650"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="2650"].aos-animate,body[data-aos-delay="2650"] [data-aos].aos-animate{transition-delay:2.65s}[data-aos][data-aos][data-aos-duration="2700"],body[data-aos-duration="2700"] [data-aos]{transition-duration:2.7s}[data-aos][data-aos][data-aos-delay="2700"],body[data-aos-delay="2700"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="2700"].aos-animate,body[data-aos-delay="2700"] [data-aos].aos-animate{transition-delay:2.7s}[data-aos][data-aos][data-aos-duration="2750"],body[data-aos-duration="2750"] [data-aos]{transition-duration:2.75s}[data-aos][data-aos][data-aos-delay="2750"],body[data-aos-delay="2750"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="2750"].aos-animate,body[data-aos-delay="2750"] [data-aos].aos-animate{transition-delay:2.75s}[data-aos][data-aos][data-aos-duration="2800"],body[data-aos-duration="2800"] [data-aos]{transition-duration:2.8s}[data-aos][data-aos][data-aos-delay="2800"],body[data-aos-delay="2800"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="2800"].aos-animate,body[data-aos-delay="2800"] [data-aos].aos-animate{transition-delay:2.8s}[data-aos][data-aos][data-aos-duration="2850"],body[data-aos-duration="2850"] [data-aos]{transition-duration:2.85s}[data-aos][data-aos][data-aos-delay="2850"],body[data-aos-delay="2850"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="2850"].aos-animate,body[data-aos-delay="2850"] [data-aos].aos-animate{transition-delay:2.85s}[data-aos][data-aos][data-aos-duration="2900"],body[data-aos-duration="2900"] [data-aos]{transition-duration:2.9s}[data-aos][data-aos][data-aos-delay="2900"],body[data-aos-delay="2900"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="2900"].aos-animate,body[data-aos-delay="2900"] [data-aos].aos-animate{transition-delay:2.9s}[data-aos][data-aos][data-aos-duration="2950"],body[data-aos-duration="2950"] [data-aos]{transition-duration:2.95s}[data-aos][data-aos][data-aos-delay="2950"],body[data-aos-delay="2950"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="2950"].aos-animate,body[data-aos-delay="2950"] [data-aos].aos-animate{transition-delay:2.95s}[data-aos][data-aos][data-aos-duration="3000"],body[data-aos-duration="3000"] [data-aos]{transition-duration:3s}[data-aos][data-aos][data-aos-delay="3000"],body[data-aos-delay="3000"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="3000"].aos-animate,body[data-aos-delay="3000"] [data-aos].aos-animate{transition-delay:3s}[data-aos][data-aos][data-aos-easing=linear],body[data-aos-easing=linear] [data-aos]{transition-timing-function:cubic-bezier(.25,.25,.75,.75)}[data-aos][data-aos][data-aos-easing=ease],body[data-aos-easing=ease] [data-aos]{transition-timing-function:ease}[data-aos][data-aos][data-aos-easing=ease-in],body[data-aos-easing=ease-in] [data-aos]{transition-timing-function:ease-in}[data-aos][data-aos][data-aos-easing=ease-out],body[data-aos-easing=ease-out] [data-aos]{transition-timing-function:ease-out}[data-aos][data-aos][data-aos-easing=ease-in-out],body[data-aos-easing=ease-in-out] [data-aos]{transition-timing-function:ease-in-out}[data-aos][data-aos][data-aos-easing=ease-in-back],body[data-aos-easing=ease-in-back] [data-aos]{transition-timing-function:cubic-bezier(.6,-.28,.735,.045)}[data-aos][data-aos][data-aos-easing=ease-out-back],body[data-aos-easing=ease-out-back] [data-aos]{transition-timing-function:cubic-bezier(.175,.885,.32,1.275)}[data-aos][data-aos][data-aos-easing=ease-in-out-back],body[data-aos-easing=ease-in-out-back] [data-aos]{transition-timing-function:cubic-bezier(.68,-.55,.265,1.55)}[data-aos][data-aos][data-aos-easing=ease-in-sine],body[data-aos-easing=ease-in-sine] [data-aos]{transition-timing-function:cubic-bezier(.47,0,.745,.715)}[data-aos][data-aos][data-aos-easing=ease-out-sine],body[data-aos-easing=ease-out-sine] [data-aos]{transition-timing-function:cubic-bezier(.39,.575,.565,1)}[data-aos][data-aos][data-aos-easing=ease-in-out-sine],body[data-aos-easing=ease-in-out-sine] [data-aos]{transition-timing-function:cubic-bezier(.445,.05,.55,.95)}[data-aos][data-aos][data-aos-easing=ease-in-quad],body[data-aos-easing=ease-in-quad] [data-aos]{transition-timing-function:cubic-bezier(.55,.085,.68,.53)}[data-aos][data-aos][data-aos-easing=ease-out-quad],body[data-aos-easing=ease-out-quad] [data-aos]{transition-timing-function:cubic-bezier(.25,.46,.45,.94)}[data-aos][data-aos][data-aos-easing=ease-in-out-quad],body[data-aos-easing=ease-in-out-quad] [data-aos]{transition-timing-function:cubic-bezier(.455,.03,.515,.955)}[data-aos][data-aos][data-aos-easing=ease-in-cubic],body[data-aos-easing=ease-in-cubic] [data-aos]{transition-timing-function:cubic-bezier(.55,.085,.68,.53)}[data-aos][data-aos][data-aos-easing=ease-out-cubic],body[data-aos-easing=ease-out-cubic] [data-aos]{transition-timing-function:cubic-bezier(.25,.46,.45,.94)}[data-aos][data-aos][data-aos-easing=ease-in-out-cubic],body[data-aos-easing=ease-in-out-cubic] [data-aos]{transition-timing-function:cubic-bezier(.455,.03,.515,.955)}[data-aos][data-aos][data-aos-easing=ease-in-quart],body[data-aos-easing=ease-in-quart] [data-aos]{transition-timing-function:cubic-bezier(.55,.085,.68,.53)}[data-aos][data-aos][data-aos-easing=ease-out-quart],body[data-aos-easing=ease-out-quart] [data-aos]{transition-timing-function:cubic-bezier(.25,.46,.45,.94)}[data-aos][data-aos][data-aos-easing=ease-in-out-quart],body[data-aos-easing=ease-in-out-quart] [data-aos]{transition-timing-function:cubic-bezier(.455,.03,.515,.955)}[data-aos^=fade][data-aos^=fade]{opacity:0;transition-property:opacity,transform}[data-aos^=fade][data-aos^=fade].aos-animate{opacity:1;transform:translateZ(0)}[data-aos=fade-up]{transform:translate3d(0,100px,0)}[data-aos=fade-down]{transform:translate3d(0,-100px,0)}[data-aos=fade-right]{transform:translate3d(-100px,0,0)}[data-aos=fade-left]{transform:translate3d(100px,0,0)}[data-aos=fade-up-right]{transform:translate3d(-100px,100px,0)}[data-aos=fade-up-left]{transform:translate3d(100px,100px,0)}[data-aos=fade-down-right]{transform:translate3d(-100px,-100px,0)}[data-aos=fade-down-left]{transform:translate3d(100px,-100px,0)}[data-aos^=zoom][data-aos^=zoom]{opacity:0;transition-property:opacity,transform}[data-aos^=zoom][data-aos^=zoom].aos-animate{opacity:1;transform:translateZ(0) scale(1)}[data-aos=zoom-in]{transform:scale(.6)}[data-aos=zoom-in-up]{transform:translate3d(0,100px,0) scale(.6)}[data-aos=zoom-in-down]{transform:translate3d(0,-100px,0) scale(.6)}[data-aos=zoom-in-right]{transform:translate3d(-100px,0,0) scale(.6)}[data-aos=zoom-in-left]{transform:translate3d(100px,0,0) scale(.6)}[data-aos=zoom-out]{transform:scale(1.2)}[data-aos=zoom-out-up]{transform:translate3d(0,100px,0) scale(1.2)}[data-aos=zoom-out-down]{transform:translate3d(0,-100px,0) scale(1.2)}[data-aos=zoom-out-right]{transform:translate3d(-100px,0,0) scale(1.2)}[data-aos=zoom-out-left]{transform:translate3d(100px,0,0) scale(1.2)}[data-aos^=slide][data-aos^=slide]{transition-property:transform}[data-aos^=slide][data-aos^=slide].aos-animate{transform:translateZ(0)}[data-aos=slide-up]{transform:translate3d(0,100%,0)}[data-aos=slide-down]{transform:translate3d(0,-100%,0)}[data-aos=slide-right]{transform:translate3d(-100%,0,0)}[data-aos=slide-left]{transform:translate3d(100%,0,0)}[data-aos^=flip][data-aos^=flip]{backface-visibility:hidden;transition-property:transform}[data-aos=flip-left]{transform:perspective(2500px) rotateY(-100deg)}[data-aos=flip-left].aos-animate{transform:perspective(2500px) rotateY(0)}[data-aos=flip-right]{transform:perspective(2500px) rotateY(100deg)}[data-aos=flip-right].aos-animate{transform:perspective(2500px) rotateY(0)}[data-aos=flip-up]{transform:perspective(2500px) rotateX(-100deg)}[data-aos=flip-up].aos-animate{transform:perspective(2500px) rotateX(0)}[data-aos=flip-down]{transform:perspective(2500px) rotateX(100deg)}[data-aos=flip-down].aos-animate{transform:perspective(2500px) rotateX(0)}',"",{version:3,sources:["webpack://./node_modules/aos/dist/aos.css"],names:[],mappings:"AAAA,qFAAqF,wBAAwB,CAAC,+EAA+E,kBAAkB,CAAC,uGAAuG,qBAAqB,CAAC,uFAAuF,uBAAuB,CAAC,iFAAiF,kBAAkB,CAAC,yGAAyG,oBAAoB,CAAC,uFAAuF,wBAAwB,CAAC,iFAAiF,kBAAkB,CAAC,yGAAyG,qBAAqB,CAAC,uFAAuF,uBAAuB,CAAC,iFAAiF,kBAAkB,CAAC,yGAAyG,oBAAoB,CAAC,uFAAuF,wBAAwB,CAAC,iFAAiF,kBAAkB,CAAC,yGAAyG,qBAAqB,CAAC,uFAAuF,uBAAuB,CAAC,iFAAiF,kBAAkB,CAAC,yGAAyG,oBAAoB,CAAC,uFAAuF,wBAAwB,CAAC,iFAAiF,kBAAkB,CAAC,yGAAyG,qBAAqB,CAAC,uFAAuF,uBAAuB,CAAC,iFAAiF,kBAAkB,CAAC,yGAAyG,oBAAoB,CAAC,uFAAuF,wBAAwB,CAAC,iFAAiF,kBAAkB,CAAC,yGAAyG,qBAAqB,CAAC,uFAAuF,uBAAuB,CAAC,iFAAiF,kBAAkB,CAAC,yGAAyG,oBAAoB,CAAC,uFAAuF,wBAAwB,CAAC,iFAAiF,kBAAkB,CAAC,yGAAyG,qBAAqB,CAAC,uFAAuF,uBAAuB,CAAC,iFAAiF,kBAAkB,CAAC,yGAAyG,oBAAoB,CAAC,uFAAuF,wBAAwB,CAAC,iFAAiF,kBAAkB,CAAC,yGAAyG,qBAAqB,CAAC,uFAAuF,uBAAuB,CAAC,iFAAiF,kBAAkB,CAAC,yGAAyG,oBAAoB,CAAC,uFAAuF,wBAAwB,CAAC,iFAAiF,kBAAkB,CAAC,yGAAyG,qBAAqB,CAAC,uFAAuF,uBAAuB,CAAC,iFAAiF,kBAAkB,CAAC,yGAAyG,oBAAoB,CAAC,uFAAuF,wBAAwB,CAAC,iFAAiF,kBAAkB,CAAC,yGAAyG,qBAAqB,CAAC,uFAAuF,uBAAuB,CAAC,iFAAiF,kBAAkB,CAAC,yGAAyG,oBAAoB,CAAC,uFAAuF,wBAAwB,CAAC,iFAAiF,kBAAkB,CAAC,yGAAyG,qBAAqB,CAAC,yFAAyF,sBAAsB,CAAC,mFAAmF,kBAAkB,CAAC,2GAA2G,mBAAmB,CAAC,yFAAyF,yBAAyB,CAAC,mFAAmF,kBAAkB,CAAC,2GAA2G,sBAAsB,CAAC,yFAAyF,wBAAwB,CAAC,mFAAmF,kBAAkB,CAAC,2GAA2G,qBAAqB,CAAC,yFAAyF,yBAAyB,CAAC,mFAAmF,kBAAkB,CAAC,2GAA2G,sBAAsB,CAAC,yFAAyF,wBAAwB,CAAC,mFAAmF,kBAAkB,CAAC,2GAA2G,qBAAqB,CAAC,yFAAyF,yBAAyB,CAAC,mFAAmF,kBAAkB,CAAC,2GAA2G,sBAAsB,CAAC,yFAAyF,wBAAwB,CAAC,mFAAmF,kBAAkB,CAAC,2GAA2G,qBAAqB,CAAC,yFAAyF,yBAAyB,CAAC,mFAAmF,kBAAkB,CAAC,2GAA2G,sBAAsB,CAAC,yFAAyF,wBAAwB,CAAC,mFAAmF,kBAAkB,CAAC,2GAA2G,qBAAqB,CAAC,yFAAyF,yBAAyB,CAAC,mFAAmF,kBAAkB,CAAC,2GAA2G,sBAAsB,CAAC,yFAAyF,wBAAwB,CAAC,mFAAmF,kBAAkB,CAAC,2GAA2G,qBAAqB,CAAC,yFAAyF,yBAAyB,CAAC,mFAAmF,kBAAkB,CAAC,2GAA2G,sBAAsB,CAAC,yFAAyF,wBAAwB,CAAC,mFAAmF,kBAAkB,CAAC,2GAA2G,qBAAqB,CAAC,yFAAyF,yBAAyB,CAAC,mFAAmF,kBAAkB,CAAC,2GAA2G,sBAAsB,CAAC,yFAAyF,wBAAwB,CAAC,mFAAmF,kBAAkB,CAAC,2GAA2G,qBAAqB,CAAC,yFAAyF,yBAAyB,CAAC,mFAAmF,kBAAkB,CAAC,2GAA2G,sBAAsB,CAAC,yFAAyF,wBAAwB,CAAC,mFAAmF,kBAAkB,CAAC,2GAA2G,qBAAqB,CAAC,yFAAyF,yBAAyB,CAAC,mFAAmF,kBAAkB,CAAC,2GAA2G,sBAAsB,CAAC,yFAAyF,wBAAwB,CAAC,mFAAmF,kBAAkB,CAAC,2GAA2G,qBAAqB,CAAC,yFAAyF,yBAAyB,CAAC,mFAAmF,kBAAkB,CAAC,2GAA2G,sBAAsB,CAAC,yFAAyF,sBAAsB,CAAC,mFAAmF,kBAAkB,CAAC,2GAA2G,mBAAmB,CAAC,yFAAyF,yBAAyB,CAAC,mFAAmF,kBAAkB,CAAC,2GAA2G,sBAAsB,CAAC,yFAAyF,wBAAwB,CAAC,mFAAmF,kBAAkB,CAAC,2GAA2G,qBAAqB,CAAC,yFAAyF,yBAAyB,CAAC,mFAAmF,kBAAkB,CAAC,2GAA2G,sBAAsB,CAAC,yFAAyF,wBAAwB,CAAC,mFAAmF,kBAAkB,CAAC,2GAA2G,qBAAqB,CAAC,yFAAyF,yBAAyB,CAAC,mFAAmF,kBAAkB,CAAC,2GAA2G,sBAAsB,CAAC,yFAAyF,wBAAwB,CAAC,mFAAmF,kBAAkB,CAAC,2GAA2G,qBAAqB,CAAC,yFAAyF,yBAAyB,CAAC,mFAAmF,kBAAkB,CAAC,2GAA2G,sBAAsB,CAAC,yFAAyF,wBAAwB,CAAC,mFAAmF,kBAAkB,CAAC,2GAA2G,qBAAqB,CAAC,yFAAyF,yBAAyB,CAAC,mFAAmF,kBAAkB,CAAC,2GAA2G,sBAAsB,CAAC,yFAAyF,wBAAwB,CAAC,mFAAmF,kBAAkB,CAAC,2GAA2G,qBAAqB,CAAC,yFAAyF,yBAAyB,CAAC,mFAAmF,kBAAkB,CAAC,2GAA2G,sBAAsB,CAAC,yFAAyF,wBAAwB,CAAC,mFAAmF,kBAAkB,CAAC,2GAA2G,qBAAqB,CAAC,yFAAyF,yBAAyB,CAAC,mFAAmF,kBAAkB,CAAC,2GAA2G,sBAAsB,CAAC,yFAAyF,wBAAwB,CAAC,mFAAmF,kBAAkB,CAAC,2GAA2G,qBAAqB,CAAC,yFAAyF,yBAAyB,CAAC,mFAAmF,kBAAkB,CAAC,2GAA2G,sBAAsB,CAAC,yFAAyF,wBAAwB,CAAC,mFAAmF,kBAAkB,CAAC,2GAA2G,qBAAqB,CAAC,yFAAyF,yBAAyB,CAAC,mFAAmF,kBAAkB,CAAC,2GAA2G,sBAAsB,CAAC,yFAAyF,wBAAwB,CAAC,mFAAmF,kBAAkB,CAAC,2GAA2G,qBAAqB,CAAC,yFAAyF,yBAAyB,CAAC,mFAAmF,kBAAkB,CAAC,2GAA2G,sBAAsB,CAAC,yFAAyF,sBAAsB,CAAC,mFAAmF,kBAAkB,CAAC,2GAA2G,mBAAmB,CAAC,qFAAqF,wDAAwD,CAAC,iFAAiF,+BAA+B,CAAC,uFAAuF,kCAAkC,CAAC,yFAAyF,mCAAmC,CAAC,+FAA+F,sCAAsC,CAAC,iGAAiG,0DAA0D,CAAC,mGAAmG,4DAA4D,CAAC,yGAAyG,2DAA2D,CAAC,iGAAiG,wDAAwD,CAAC,mGAAmG,wDAAwD,CAAC,yGAAyG,yDAAyD,CAAC,iGAAiG,yDAAyD,CAAC,mGAAmG,wDAAwD,CAAC,yGAAyG,2DAA2D,CAAC,mGAAmG,yDAAyD,CAAC,qGAAqG,wDAAwD,CAAC,2GAA2G,2DAA2D,CAAC,mGAAmG,yDAAyD,CAAC,qGAAqG,wDAAwD,CAAC,2GAA2G,2DAA2D,CAAC,iCAAiC,SAAS,CAAC,qCAAqC,CAAC,6CAA6C,SAAS,CAAC,uBAAuB,CAAC,mBAAmB,gCAAgC,CAAC,qBAAqB,iCAAiC,CAAC,sBAAsB,iCAAiC,CAAC,qBAAqB,gCAAgC,CAAC,yBAAyB,qCAAqC,CAAC,wBAAwB,oCAAoC,CAAC,2BAA2B,sCAAsC,CAAC,0BAA0B,qCAAqC,CAAC,iCAAiC,SAAS,CAAC,qCAAqC,CAAC,6CAA6C,SAAS,CAAC,gCAAgC,CAAC,mBAAmB,mBAAmB,CAAC,sBAAsB,0CAA0C,CAAC,wBAAwB,2CAA2C,CAAC,yBAAyB,2CAA2C,CAAC,wBAAwB,0CAA0C,CAAC,oBAAoB,oBAAoB,CAAC,uBAAuB,2CAA2C,CAAC,yBAAyB,4CAA4C,CAAC,0BAA0B,4CAA4C,CAAC,yBAAyB,2CAA2C,CAAC,mCAAmC,6BAA6B,CAAC,+CAA+C,uBAAuB,CAAC,oBAAoB,+BAA+B,CAAC,sBAAsB,gCAAgC,CAAC,uBAAuB,gCAAgC,CAAC,sBAAsB,+BAA+B,CAAC,iCAAiC,0BAA0B,CAAC,6BAA6B,CAAC,qBAAqB,8CAA8C,CAAC,iCAAiC,wCAAwC,CAAC,sBAAsB,6CAA6C,CAAC,kCAAkC,wCAAwC,CAAC,mBAAmB,8CAA8C,CAAC,+BAA+B,wCAAwC,CAAC,qBAAqB,6CAA6C,CAAC,iCAAiC,wCAAwC",sourcesContent:['[data-aos][data-aos][data-aos-duration="50"],body[data-aos-duration="50"] [data-aos]{transition-duration:50ms}[data-aos][data-aos][data-aos-delay="50"],body[data-aos-delay="50"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="50"].aos-animate,body[data-aos-delay="50"] [data-aos].aos-animate{transition-delay:50ms}[data-aos][data-aos][data-aos-duration="100"],body[data-aos-duration="100"] [data-aos]{transition-duration:.1s}[data-aos][data-aos][data-aos-delay="100"],body[data-aos-delay="100"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="100"].aos-animate,body[data-aos-delay="100"] [data-aos].aos-animate{transition-delay:.1s}[data-aos][data-aos][data-aos-duration="150"],body[data-aos-duration="150"] [data-aos]{transition-duration:.15s}[data-aos][data-aos][data-aos-delay="150"],body[data-aos-delay="150"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="150"].aos-animate,body[data-aos-delay="150"] [data-aos].aos-animate{transition-delay:.15s}[data-aos][data-aos][data-aos-duration="200"],body[data-aos-duration="200"] [data-aos]{transition-duration:.2s}[data-aos][data-aos][data-aos-delay="200"],body[data-aos-delay="200"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="200"].aos-animate,body[data-aos-delay="200"] [data-aos].aos-animate{transition-delay:.2s}[data-aos][data-aos][data-aos-duration="250"],body[data-aos-duration="250"] [data-aos]{transition-duration:.25s}[data-aos][data-aos][data-aos-delay="250"],body[data-aos-delay="250"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="250"].aos-animate,body[data-aos-delay="250"] [data-aos].aos-animate{transition-delay:.25s}[data-aos][data-aos][data-aos-duration="300"],body[data-aos-duration="300"] [data-aos]{transition-duration:.3s}[data-aos][data-aos][data-aos-delay="300"],body[data-aos-delay="300"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="300"].aos-animate,body[data-aos-delay="300"] [data-aos].aos-animate{transition-delay:.3s}[data-aos][data-aos][data-aos-duration="350"],body[data-aos-duration="350"] [data-aos]{transition-duration:.35s}[data-aos][data-aos][data-aos-delay="350"],body[data-aos-delay="350"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="350"].aos-animate,body[data-aos-delay="350"] [data-aos].aos-animate{transition-delay:.35s}[data-aos][data-aos][data-aos-duration="400"],body[data-aos-duration="400"] [data-aos]{transition-duration:.4s}[data-aos][data-aos][data-aos-delay="400"],body[data-aos-delay="400"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="400"].aos-animate,body[data-aos-delay="400"] [data-aos].aos-animate{transition-delay:.4s}[data-aos][data-aos][data-aos-duration="450"],body[data-aos-duration="450"] [data-aos]{transition-duration:.45s}[data-aos][data-aos][data-aos-delay="450"],body[data-aos-delay="450"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="450"].aos-animate,body[data-aos-delay="450"] [data-aos].aos-animate{transition-delay:.45s}[data-aos][data-aos][data-aos-duration="500"],body[data-aos-duration="500"] [data-aos]{transition-duration:.5s}[data-aos][data-aos][data-aos-delay="500"],body[data-aos-delay="500"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="500"].aos-animate,body[data-aos-delay="500"] [data-aos].aos-animate{transition-delay:.5s}[data-aos][data-aos][data-aos-duration="550"],body[data-aos-duration="550"] [data-aos]{transition-duration:.55s}[data-aos][data-aos][data-aos-delay="550"],body[data-aos-delay="550"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="550"].aos-animate,body[data-aos-delay="550"] [data-aos].aos-animate{transition-delay:.55s}[data-aos][data-aos][data-aos-duration="600"],body[data-aos-duration="600"] [data-aos]{transition-duration:.6s}[data-aos][data-aos][data-aos-delay="600"],body[data-aos-delay="600"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="600"].aos-animate,body[data-aos-delay="600"] [data-aos].aos-animate{transition-delay:.6s}[data-aos][data-aos][data-aos-duration="650"],body[data-aos-duration="650"] [data-aos]{transition-duration:.65s}[data-aos][data-aos][data-aos-delay="650"],body[data-aos-delay="650"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="650"].aos-animate,body[data-aos-delay="650"] [data-aos].aos-animate{transition-delay:.65s}[data-aos][data-aos][data-aos-duration="700"],body[data-aos-duration="700"] [data-aos]{transition-duration:.7s}[data-aos][data-aos][data-aos-delay="700"],body[data-aos-delay="700"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="700"].aos-animate,body[data-aos-delay="700"] [data-aos].aos-animate{transition-delay:.7s}[data-aos][data-aos][data-aos-duration="750"],body[data-aos-duration="750"] [data-aos]{transition-duration:.75s}[data-aos][data-aos][data-aos-delay="750"],body[data-aos-delay="750"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="750"].aos-animate,body[data-aos-delay="750"] [data-aos].aos-animate{transition-delay:.75s}[data-aos][data-aos][data-aos-duration="800"],body[data-aos-duration="800"] [data-aos]{transition-duration:.8s}[data-aos][data-aos][data-aos-delay="800"],body[data-aos-delay="800"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="800"].aos-animate,body[data-aos-delay="800"] [data-aos].aos-animate{transition-delay:.8s}[data-aos][data-aos][data-aos-duration="850"],body[data-aos-duration="850"] [data-aos]{transition-duration:.85s}[data-aos][data-aos][data-aos-delay="850"],body[data-aos-delay="850"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="850"].aos-animate,body[data-aos-delay="850"] [data-aos].aos-animate{transition-delay:.85s}[data-aos][data-aos][data-aos-duration="900"],body[data-aos-duration="900"] [data-aos]{transition-duration:.9s}[data-aos][data-aos][data-aos-delay="900"],body[data-aos-delay="900"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="900"].aos-animate,body[data-aos-delay="900"] [data-aos].aos-animate{transition-delay:.9s}[data-aos][data-aos][data-aos-duration="950"],body[data-aos-duration="950"] [data-aos]{transition-duration:.95s}[data-aos][data-aos][data-aos-delay="950"],body[data-aos-delay="950"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="950"].aos-animate,body[data-aos-delay="950"] [data-aos].aos-animate{transition-delay:.95s}[data-aos][data-aos][data-aos-duration="1000"],body[data-aos-duration="1000"] [data-aos]{transition-duration:1s}[data-aos][data-aos][data-aos-delay="1000"],body[data-aos-delay="1000"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="1000"].aos-animate,body[data-aos-delay="1000"] [data-aos].aos-animate{transition-delay:1s}[data-aos][data-aos][data-aos-duration="1050"],body[data-aos-duration="1050"] [data-aos]{transition-duration:1.05s}[data-aos][data-aos][data-aos-delay="1050"],body[data-aos-delay="1050"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="1050"].aos-animate,body[data-aos-delay="1050"] [data-aos].aos-animate{transition-delay:1.05s}[data-aos][data-aos][data-aos-duration="1100"],body[data-aos-duration="1100"] [data-aos]{transition-duration:1.1s}[data-aos][data-aos][data-aos-delay="1100"],body[data-aos-delay="1100"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="1100"].aos-animate,body[data-aos-delay="1100"] [data-aos].aos-animate{transition-delay:1.1s}[data-aos][data-aos][data-aos-duration="1150"],body[data-aos-duration="1150"] [data-aos]{transition-duration:1.15s}[data-aos][data-aos][data-aos-delay="1150"],body[data-aos-delay="1150"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="1150"].aos-animate,body[data-aos-delay="1150"] [data-aos].aos-animate{transition-delay:1.15s}[data-aos][data-aos][data-aos-duration="1200"],body[data-aos-duration="1200"] [data-aos]{transition-duration:1.2s}[data-aos][data-aos][data-aos-delay="1200"],body[data-aos-delay="1200"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="1200"].aos-animate,body[data-aos-delay="1200"] [data-aos].aos-animate{transition-delay:1.2s}[data-aos][data-aos][data-aos-duration="1250"],body[data-aos-duration="1250"] [data-aos]{transition-duration:1.25s}[data-aos][data-aos][data-aos-delay="1250"],body[data-aos-delay="1250"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="1250"].aos-animate,body[data-aos-delay="1250"] [data-aos].aos-animate{transition-delay:1.25s}[data-aos][data-aos][data-aos-duration="1300"],body[data-aos-duration="1300"] [data-aos]{transition-duration:1.3s}[data-aos][data-aos][data-aos-delay="1300"],body[data-aos-delay="1300"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="1300"].aos-animate,body[data-aos-delay="1300"] [data-aos].aos-animate{transition-delay:1.3s}[data-aos][data-aos][data-aos-duration="1350"],body[data-aos-duration="1350"] [data-aos]{transition-duration:1.35s}[data-aos][data-aos][data-aos-delay="1350"],body[data-aos-delay="1350"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="1350"].aos-animate,body[data-aos-delay="1350"] [data-aos].aos-animate{transition-delay:1.35s}[data-aos][data-aos][data-aos-duration="1400"],body[data-aos-duration="1400"] [data-aos]{transition-duration:1.4s}[data-aos][data-aos][data-aos-delay="1400"],body[data-aos-delay="1400"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="1400"].aos-animate,body[data-aos-delay="1400"] [data-aos].aos-animate{transition-delay:1.4s}[data-aos][data-aos][data-aos-duration="1450"],body[data-aos-duration="1450"] [data-aos]{transition-duration:1.45s}[data-aos][data-aos][data-aos-delay="1450"],body[data-aos-delay="1450"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="1450"].aos-animate,body[data-aos-delay="1450"] [data-aos].aos-animate{transition-delay:1.45s}[data-aos][data-aos][data-aos-duration="1500"],body[data-aos-duration="1500"] [data-aos]{transition-duration:1.5s}[data-aos][data-aos][data-aos-delay="1500"],body[data-aos-delay="1500"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="1500"].aos-animate,body[data-aos-delay="1500"] [data-aos].aos-animate{transition-delay:1.5s}[data-aos][data-aos][data-aos-duration="1550"],body[data-aos-duration="1550"] [data-aos]{transition-duration:1.55s}[data-aos][data-aos][data-aos-delay="1550"],body[data-aos-delay="1550"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="1550"].aos-animate,body[data-aos-delay="1550"] [data-aos].aos-animate{transition-delay:1.55s}[data-aos][data-aos][data-aos-duration="1600"],body[data-aos-duration="1600"] [data-aos]{transition-duration:1.6s}[data-aos][data-aos][data-aos-delay="1600"],body[data-aos-delay="1600"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="1600"].aos-animate,body[data-aos-delay="1600"] [data-aos].aos-animate{transition-delay:1.6s}[data-aos][data-aos][data-aos-duration="1650"],body[data-aos-duration="1650"] [data-aos]{transition-duration:1.65s}[data-aos][data-aos][data-aos-delay="1650"],body[data-aos-delay="1650"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="1650"].aos-animate,body[data-aos-delay="1650"] [data-aos].aos-animate{transition-delay:1.65s}[data-aos][data-aos][data-aos-duration="1700"],body[data-aos-duration="1700"] [data-aos]{transition-duration:1.7s}[data-aos][data-aos][data-aos-delay="1700"],body[data-aos-delay="1700"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="1700"].aos-animate,body[data-aos-delay="1700"] [data-aos].aos-animate{transition-delay:1.7s}[data-aos][data-aos][data-aos-duration="1750"],body[data-aos-duration="1750"] [data-aos]{transition-duration:1.75s}[data-aos][data-aos][data-aos-delay="1750"],body[data-aos-delay="1750"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="1750"].aos-animate,body[data-aos-delay="1750"] [data-aos].aos-animate{transition-delay:1.75s}[data-aos][data-aos][data-aos-duration="1800"],body[data-aos-duration="1800"] [data-aos]{transition-duration:1.8s}[data-aos][data-aos][data-aos-delay="1800"],body[data-aos-delay="1800"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="1800"].aos-animate,body[data-aos-delay="1800"] [data-aos].aos-animate{transition-delay:1.8s}[data-aos][data-aos][data-aos-duration="1850"],body[data-aos-duration="1850"] [data-aos]{transition-duration:1.85s}[data-aos][data-aos][data-aos-delay="1850"],body[data-aos-delay="1850"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="1850"].aos-animate,body[data-aos-delay="1850"] [data-aos].aos-animate{transition-delay:1.85s}[data-aos][data-aos][data-aos-duration="1900"],body[data-aos-duration="1900"] [data-aos]{transition-duration:1.9s}[data-aos][data-aos][data-aos-delay="1900"],body[data-aos-delay="1900"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="1900"].aos-animate,body[data-aos-delay="1900"] [data-aos].aos-animate{transition-delay:1.9s}[data-aos][data-aos][data-aos-duration="1950"],body[data-aos-duration="1950"] [data-aos]{transition-duration:1.95s}[data-aos][data-aos][data-aos-delay="1950"],body[data-aos-delay="1950"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="1950"].aos-animate,body[data-aos-delay="1950"] [data-aos].aos-animate{transition-delay:1.95s}[data-aos][data-aos][data-aos-duration="2000"],body[data-aos-duration="2000"] [data-aos]{transition-duration:2s}[data-aos][data-aos][data-aos-delay="2000"],body[data-aos-delay="2000"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="2000"].aos-animate,body[data-aos-delay="2000"] [data-aos].aos-animate{transition-delay:2s}[data-aos][data-aos][data-aos-duration="2050"],body[data-aos-duration="2050"] [data-aos]{transition-duration:2.05s}[data-aos][data-aos][data-aos-delay="2050"],body[data-aos-delay="2050"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="2050"].aos-animate,body[data-aos-delay="2050"] [data-aos].aos-animate{transition-delay:2.05s}[data-aos][data-aos][data-aos-duration="2100"],body[data-aos-duration="2100"] [data-aos]{transition-duration:2.1s}[data-aos][data-aos][data-aos-delay="2100"],body[data-aos-delay="2100"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="2100"].aos-animate,body[data-aos-delay="2100"] [data-aos].aos-animate{transition-delay:2.1s}[data-aos][data-aos][data-aos-duration="2150"],body[data-aos-duration="2150"] [data-aos]{transition-duration:2.15s}[data-aos][data-aos][data-aos-delay="2150"],body[data-aos-delay="2150"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="2150"].aos-animate,body[data-aos-delay="2150"] [data-aos].aos-animate{transition-delay:2.15s}[data-aos][data-aos][data-aos-duration="2200"],body[data-aos-duration="2200"] [data-aos]{transition-duration:2.2s}[data-aos][data-aos][data-aos-delay="2200"],body[data-aos-delay="2200"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="2200"].aos-animate,body[data-aos-delay="2200"] [data-aos].aos-animate{transition-delay:2.2s}[data-aos][data-aos][data-aos-duration="2250"],body[data-aos-duration="2250"] [data-aos]{transition-duration:2.25s}[data-aos][data-aos][data-aos-delay="2250"],body[data-aos-delay="2250"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="2250"].aos-animate,body[data-aos-delay="2250"] [data-aos].aos-animate{transition-delay:2.25s}[data-aos][data-aos][data-aos-duration="2300"],body[data-aos-duration="2300"] [data-aos]{transition-duration:2.3s}[data-aos][data-aos][data-aos-delay="2300"],body[data-aos-delay="2300"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="2300"].aos-animate,body[data-aos-delay="2300"] [data-aos].aos-animate{transition-delay:2.3s}[data-aos][data-aos][data-aos-duration="2350"],body[data-aos-duration="2350"] [data-aos]{transition-duration:2.35s}[data-aos][data-aos][data-aos-delay="2350"],body[data-aos-delay="2350"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="2350"].aos-animate,body[data-aos-delay="2350"] [data-aos].aos-animate{transition-delay:2.35s}[data-aos][data-aos][data-aos-duration="2400"],body[data-aos-duration="2400"] [data-aos]{transition-duration:2.4s}[data-aos][data-aos][data-aos-delay="2400"],body[data-aos-delay="2400"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="2400"].aos-animate,body[data-aos-delay="2400"] [data-aos].aos-animate{transition-delay:2.4s}[data-aos][data-aos][data-aos-duration="2450"],body[data-aos-duration="2450"] [data-aos]{transition-duration:2.45s}[data-aos][data-aos][data-aos-delay="2450"],body[data-aos-delay="2450"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="2450"].aos-animate,body[data-aos-delay="2450"] [data-aos].aos-animate{transition-delay:2.45s}[data-aos][data-aos][data-aos-duration="2500"],body[data-aos-duration="2500"] [data-aos]{transition-duration:2.5s}[data-aos][data-aos][data-aos-delay="2500"],body[data-aos-delay="2500"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="2500"].aos-animate,body[data-aos-delay="2500"] [data-aos].aos-animate{transition-delay:2.5s}[data-aos][data-aos][data-aos-duration="2550"],body[data-aos-duration="2550"] [data-aos]{transition-duration:2.55s}[data-aos][data-aos][data-aos-delay="2550"],body[data-aos-delay="2550"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="2550"].aos-animate,body[data-aos-delay="2550"] [data-aos].aos-animate{transition-delay:2.55s}[data-aos][data-aos][data-aos-duration="2600"],body[data-aos-duration="2600"] [data-aos]{transition-duration:2.6s}[data-aos][data-aos][data-aos-delay="2600"],body[data-aos-delay="2600"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="2600"].aos-animate,body[data-aos-delay="2600"] [data-aos].aos-animate{transition-delay:2.6s}[data-aos][data-aos][data-aos-duration="2650"],body[data-aos-duration="2650"] [data-aos]{transition-duration:2.65s}[data-aos][data-aos][data-aos-delay="2650"],body[data-aos-delay="2650"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="2650"].aos-animate,body[data-aos-delay="2650"] [data-aos].aos-animate{transition-delay:2.65s}[data-aos][data-aos][data-aos-duration="2700"],body[data-aos-duration="2700"] [data-aos]{transition-duration:2.7s}[data-aos][data-aos][data-aos-delay="2700"],body[data-aos-delay="2700"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="2700"].aos-animate,body[data-aos-delay="2700"] [data-aos].aos-animate{transition-delay:2.7s}[data-aos][data-aos][data-aos-duration="2750"],body[data-aos-duration="2750"] [data-aos]{transition-duration:2.75s}[data-aos][data-aos][data-aos-delay="2750"],body[data-aos-delay="2750"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="2750"].aos-animate,body[data-aos-delay="2750"] [data-aos].aos-animate{transition-delay:2.75s}[data-aos][data-aos][data-aos-duration="2800"],body[data-aos-duration="2800"] [data-aos]{transition-duration:2.8s}[data-aos][data-aos][data-aos-delay="2800"],body[data-aos-delay="2800"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="2800"].aos-animate,body[data-aos-delay="2800"] [data-aos].aos-animate{transition-delay:2.8s}[data-aos][data-aos][data-aos-duration="2850"],body[data-aos-duration="2850"] [data-aos]{transition-duration:2.85s}[data-aos][data-aos][data-aos-delay="2850"],body[data-aos-delay="2850"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="2850"].aos-animate,body[data-aos-delay="2850"] [data-aos].aos-animate{transition-delay:2.85s}[data-aos][data-aos][data-aos-duration="2900"],body[data-aos-duration="2900"] [data-aos]{transition-duration:2.9s}[data-aos][data-aos][data-aos-delay="2900"],body[data-aos-delay="2900"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="2900"].aos-animate,body[data-aos-delay="2900"] [data-aos].aos-animate{transition-delay:2.9s}[data-aos][data-aos][data-aos-duration="2950"],body[data-aos-duration="2950"] [data-aos]{transition-duration:2.95s}[data-aos][data-aos][data-aos-delay="2950"],body[data-aos-delay="2950"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="2950"].aos-animate,body[data-aos-delay="2950"] [data-aos].aos-animate{transition-delay:2.95s}[data-aos][data-aos][data-aos-duration="3000"],body[data-aos-duration="3000"] [data-aos]{transition-duration:3s}[data-aos][data-aos][data-aos-delay="3000"],body[data-aos-delay="3000"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="3000"].aos-animate,body[data-aos-delay="3000"] [data-aos].aos-animate{transition-delay:3s}[data-aos][data-aos][data-aos-easing=linear],body[data-aos-easing=linear] [data-aos]{transition-timing-function:cubic-bezier(.25,.25,.75,.75)}[data-aos][data-aos][data-aos-easing=ease],body[data-aos-easing=ease] [data-aos]{transition-timing-function:ease}[data-aos][data-aos][data-aos-easing=ease-in],body[data-aos-easing=ease-in] [data-aos]{transition-timing-function:ease-in}[data-aos][data-aos][data-aos-easing=ease-out],body[data-aos-easing=ease-out] [data-aos]{transition-timing-function:ease-out}[data-aos][data-aos][data-aos-easing=ease-in-out],body[data-aos-easing=ease-in-out] [data-aos]{transition-timing-function:ease-in-out}[data-aos][data-aos][data-aos-easing=ease-in-back],body[data-aos-easing=ease-in-back] [data-aos]{transition-timing-function:cubic-bezier(.6,-.28,.735,.045)}[data-aos][data-aos][data-aos-easing=ease-out-back],body[data-aos-easing=ease-out-back] [data-aos]{transition-timing-function:cubic-bezier(.175,.885,.32,1.275)}[data-aos][data-aos][data-aos-easing=ease-in-out-back],body[data-aos-easing=ease-in-out-back] [data-aos]{transition-timing-function:cubic-bezier(.68,-.55,.265,1.55)}[data-aos][data-aos][data-aos-easing=ease-in-sine],body[data-aos-easing=ease-in-sine] [data-aos]{transition-timing-function:cubic-bezier(.47,0,.745,.715)}[data-aos][data-aos][data-aos-easing=ease-out-sine],body[data-aos-easing=ease-out-sine] [data-aos]{transition-timing-function:cubic-bezier(.39,.575,.565,1)}[data-aos][data-aos][data-aos-easing=ease-in-out-sine],body[data-aos-easing=ease-in-out-sine] [data-aos]{transition-timing-function:cubic-bezier(.445,.05,.55,.95)}[data-aos][data-aos][data-aos-easing=ease-in-quad],body[data-aos-easing=ease-in-quad] [data-aos]{transition-timing-function:cubic-bezier(.55,.085,.68,.53)}[data-aos][data-aos][data-aos-easing=ease-out-quad],body[data-aos-easing=ease-out-quad] [data-aos]{transition-timing-function:cubic-bezier(.25,.46,.45,.94)}[data-aos][data-aos][data-aos-easing=ease-in-out-quad],body[data-aos-easing=ease-in-out-quad] [data-aos]{transition-timing-function:cubic-bezier(.455,.03,.515,.955)}[data-aos][data-aos][data-aos-easing=ease-in-cubic],body[data-aos-easing=ease-in-cubic] [data-aos]{transition-timing-function:cubic-bezier(.55,.085,.68,.53)}[data-aos][data-aos][data-aos-easing=ease-out-cubic],body[data-aos-easing=ease-out-cubic] [data-aos]{transition-timing-function:cubic-bezier(.25,.46,.45,.94)}[data-aos][data-aos][data-aos-easing=ease-in-out-cubic],body[data-aos-easing=ease-in-out-cubic] [data-aos]{transition-timing-function:cubic-bezier(.455,.03,.515,.955)}[data-aos][data-aos][data-aos-easing=ease-in-quart],body[data-aos-easing=ease-in-quart] [data-aos]{transition-timing-function:cubic-bezier(.55,.085,.68,.53)}[data-aos][data-aos][data-aos-easing=ease-out-quart],body[data-aos-easing=ease-out-quart] [data-aos]{transition-timing-function:cubic-bezier(.25,.46,.45,.94)}[data-aos][data-aos][data-aos-easing=ease-in-out-quart],body[data-aos-easing=ease-in-out-quart] [data-aos]{transition-timing-function:cubic-bezier(.455,.03,.515,.955)}[data-aos^=fade][data-aos^=fade]{opacity:0;transition-property:opacity,transform}[data-aos^=fade][data-aos^=fade].aos-animate{opacity:1;transform:translateZ(0)}[data-aos=fade-up]{transform:translate3d(0,100px,0)}[data-aos=fade-down]{transform:translate3d(0,-100px,0)}[data-aos=fade-right]{transform:translate3d(-100px,0,0)}[data-aos=fade-left]{transform:translate3d(100px,0,0)}[data-aos=fade-up-right]{transform:translate3d(-100px,100px,0)}[data-aos=fade-up-left]{transform:translate3d(100px,100px,0)}[data-aos=fade-down-right]{transform:translate3d(-100px,-100px,0)}[data-aos=fade-down-left]{transform:translate3d(100px,-100px,0)}[data-aos^=zoom][data-aos^=zoom]{opacity:0;transition-property:opacity,transform}[data-aos^=zoom][data-aos^=zoom].aos-animate{opacity:1;transform:translateZ(0) scale(1)}[data-aos=zoom-in]{transform:scale(.6)}[data-aos=zoom-in-up]{transform:translate3d(0,100px,0) scale(.6)}[data-aos=zoom-in-down]{transform:translate3d(0,-100px,0) scale(.6)}[data-aos=zoom-in-right]{transform:translate3d(-100px,0,0) scale(.6)}[data-aos=zoom-in-left]{transform:translate3d(100px,0,0) scale(.6)}[data-aos=zoom-out]{transform:scale(1.2)}[data-aos=zoom-out-up]{transform:translate3d(0,100px,0) scale(1.2)}[data-aos=zoom-out-down]{transform:translate3d(0,-100px,0) scale(1.2)}[data-aos=zoom-out-right]{transform:translate3d(-100px,0,0) scale(1.2)}[data-aos=zoom-out-left]{transform:translate3d(100px,0,0) scale(1.2)}[data-aos^=slide][data-aos^=slide]{transition-property:transform}[data-aos^=slide][data-aos^=slide].aos-animate{transform:translateZ(0)}[data-aos=slide-up]{transform:translate3d(0,100%,0)}[data-aos=slide-down]{transform:translate3d(0,-100%,0)}[data-aos=slide-right]{transform:translate3d(-100%,0,0)}[data-aos=slide-left]{transform:translate3d(100%,0,0)}[data-aos^=flip][data-aos^=flip]{backface-visibility:hidden;transition-property:transform}[data-aos=flip-left]{transform:perspective(2500px) rotateY(-100deg)}[data-aos=flip-left].aos-animate{transform:perspective(2500px) rotateY(0)}[data-aos=flip-right]{transform:perspective(2500px) rotateY(100deg)}[data-aos=flip-right].aos-animate{transform:perspective(2500px) rotateY(0)}[data-aos=flip-up]{transform:perspective(2500px) rotateX(-100deg)}[data-aos=flip-up].aos-animate{transform:perspective(2500px) rotateX(0)}[data-aos=flip-down]{transform:perspective(2500px) rotateX(100deg)}[data-aos=flip-down].aos-animate{transform:perspective(2500px) rotateX(0)}'],sourceRoot:""}]);const s=o},6965:(t,e,n)=>{"use strict";n.d(e,{A:()=>gt});var i=n(1354),a=n.n(i),r=n(6314),o=n.n(r),s=n(4417),l=n.n(s),c=new URL(n(426),n.b),u=new URL(n(3873),n.b),h=new URL(n(6839),n.b),d=new URL(n(4972),n.b),p=new URL(n(3825),n.b),f=new URL(n(6686),n.b),m=new URL(n(6827),n.b),g=new URL(n(7324),n.b),_=new URL(n(690),n.b),y=new URL(n(4262),n.b),x=new URL(n(2912),n.b),v=new URL(n(2556),n.b),b=new URL(n(3750),n.b),w=new URL(n(577),n.b),A=new URL(n(5565),n.b),C=new URL(n(1991),n.b),E=new URL(n(3764),n.b),T=new URL(n(311),n.b),S=new URL(n(20),n.b),M=new URL(n(2990),n.b),k=new URL(n(3200),n.b),I=new URL(n(5454),n.b),P=new URL(n(1340),n.b),z=new URL(n(6008),n.b),D=new URL(n(5721),n.b),L=new URL(n(7138),n.b),B=new URL(n(7256),n.b),O=new URL(n(7354),n.b),R=new URL(n(8548),n.b),F=new URL(n(9098),n.b),N=o()(a()),j=l()(c),V=l()(u),U=l()(h),G=l()(d),q=l()(p),$=l()(f),W=l()(m),H=l()(g),Z=l()(_),Y=l()(y),X=l()(x),K=l()(v),Q=l()(b),J=l()(w),tt=l()(A),et=l()(C),nt=l()(E),it=l()(T),at=l()(S),rt=l()(M),ot=l()(k),st=l()(I),lt=l()(P),ct=l()(z),ut=l()(D),ht=l()(L),dt=l()(B),pt=l()(O),ft=l()(R),mt=l()(F);N.push([t.id,`.mapboxgl-map{font:12px/20px Helvetica Neue,Arial,Helvetica,sans-serif;overflow:hidden;position:relative;-webkit-tap-highlight-color:rgb(0 0 0/0)}.mapboxgl-canvas{left:0;position:absolute;top:0}.mapboxgl-map:-webkit-full-screen{height:100%;width:100%}.mapboxgl-canary{background-color:salmon}.mapboxgl-canvas-container.mapboxgl-interactive,.mapboxgl-ctrl-group button.mapboxgl-ctrl-compass{cursor:grab;-webkit-user-select:none;user-select:none}.mapboxgl-canvas-container.mapboxgl-interactive.mapboxgl-track-pointer{cursor:pointer}.mapboxgl-canvas-container.mapboxgl-interactive:active,.mapboxgl-ctrl-group button.mapboxgl-ctrl-compass:active{cursor:grabbing}.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate,.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate .mapboxgl-canvas{touch-action:pan-x pan-y}.mapboxgl-canvas-container.mapboxgl-touch-drag-pan,.mapboxgl-canvas-container.mapboxgl-touch-drag-pan .mapboxgl-canvas{touch-action:pinch-zoom}.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate.mapboxgl-touch-drag-pan,.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate.mapboxgl-touch-drag-pan .mapboxgl-canvas{touch-action:none}.mapboxgl-ctrl-bottom-left,.mapboxgl-ctrl-bottom-right,.mapboxgl-ctrl-top-left,.mapboxgl-ctrl-top-right{pointer-events:none;position:absolute;z-index:2}.mapboxgl-ctrl-top-left{left:0;top:0}.mapboxgl-ctrl-top-right{right:0;top:0}.mapboxgl-ctrl-bottom-left{bottom:0;left:0}.mapboxgl-ctrl-bottom-right{bottom:0;right:0}.mapboxgl-ctrl{clear:both;pointer-events:auto;transform:translate(0)}.mapboxgl-ctrl-top-left .mapboxgl-ctrl{float:left;margin:10px 0 0 10px}.mapboxgl-ctrl-top-right .mapboxgl-ctrl{float:right;margin:10px 10px 0 0}.mapboxgl-ctrl-bottom-left .mapboxgl-ctrl{float:left;margin:0 0 10px 10px}.mapboxgl-ctrl-bottom-right .mapboxgl-ctrl{float:right;margin:0 10px 10px 0}.mapboxgl-ctrl-group{background:#fff;border-radius:4px}.mapboxgl-ctrl-group:not(:empty){box-shadow:0 0 0 2px rgba(0,0,0,.1)}@media (-ms-high-contrast:active){.mapboxgl-ctrl-group:not(:empty){box-shadow:0 0 0 2px ButtonText}}.mapboxgl-ctrl-group button{background-color:transparent;border:0;box-sizing:border-box;cursor:pointer;display:block;height:29px;outline:none;overflow:hidden;padding:0;width:29px}.mapboxgl-ctrl-group button+button{border-top:1px solid #ddd}.mapboxgl-ctrl button .mapboxgl-ctrl-icon{background-position:50%;background-repeat:no-repeat;display:block;height:100%;width:100%}@media (-ms-high-contrast:active){.mapboxgl-ctrl-icon{background-color:transparent}.mapboxgl-ctrl-group button+button{border-top:1px solid ButtonText}}.mapboxgl-ctrl-attrib-button:focus,.mapboxgl-ctrl-group button:focus{box-shadow:0 0 2px 2px #0096ff}.mapboxgl-ctrl button:disabled{cursor:not-allowed}.mapboxgl-ctrl button:disabled .mapboxgl-ctrl-icon{opacity:.25}.mapboxgl-ctrl-group button:first-child{border-radius:4px 4px 0 0}.mapboxgl-ctrl-group button:last-child{border-radius:0 0 4px 4px}.mapboxgl-ctrl-group button:only-child{border-radius:inherit}.mapboxgl-ctrl button:not(:disabled):hover{background-color:rgb(0 0 0/5%)}.mapboxgl-ctrl-group button:focus:focus-visible{box-shadow:0 0 2px 2px #0096ff}.mapboxgl-ctrl-group button:focus:not(:focus-visible){box-shadow:none}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url(${j})}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url(${V})}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url(${U})}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url(${G})}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url(${q})}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url(${$})}}.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url(${W})}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url(${H})}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url(${Z})}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url(${Y})}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url(${X})}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url(${K})}}.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url(${Q})}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url(${J})}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url(${tt})}}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url(${et})}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url(${nt})}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active .mapboxgl-ctrl-icon{background-image:url(${it})}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active-error .mapboxgl-ctrl-icon{background-image:url(${at})}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background .mapboxgl-ctrl-icon{background-image:url(${rt})}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background-error .mapboxgl-ctrl-icon{background-image:url(${ot})}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-waiting .mapboxgl-ctrl-icon{animation:mapboxgl-spin 2s linear infinite}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url(${st})}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url(${lt})}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active .mapboxgl-ctrl-icon{background-image:url(${it})}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active-error .mapboxgl-ctrl-icon{background-image:url(${at})}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background .mapboxgl-ctrl-icon{background-image:url(${rt})}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background-error .mapboxgl-ctrl-icon{background-image:url(${ot})}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url(${ct})}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url(${ut})}}@keyframes mapboxgl-spin{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}a.mapboxgl-ctrl-logo{background-image:url(${ht});background-repeat:no-repeat;cursor:pointer;display:block;height:23px;margin:0 0 -4px -4px;overflow:hidden;width:88px}a.mapboxgl-ctrl-logo.mapboxgl-compact{width:23px}@media (-ms-high-contrast:active){a.mapboxgl-ctrl-logo{background-color:transparent;background-image:url(${dt})}}@media (-ms-high-contrast:black-on-white){a.mapboxgl-ctrl-logo{background-image:url(${pt})}}.mapboxgl-ctrl.mapboxgl-ctrl-attrib{background-color:hsla(0,0%,100%,.5);margin:0;padding:0 5px}@media screen{.mapboxgl-ctrl-attrib.mapboxgl-compact{background-color:#fff;border-radius:12px;box-sizing:content-box;margin:10px;min-height:20px;padding:2px 24px 2px 0;position:relative}.mapboxgl-ctrl-attrib.mapboxgl-compact-show{padding:2px 28px 2px 8px;visibility:visible}.mapboxgl-ctrl-bottom-left>.mapboxgl-ctrl-attrib.mapboxgl-compact-show,.mapboxgl-ctrl-top-left>.mapboxgl-ctrl-attrib.mapboxgl-compact-show{border-radius:12px;padding:2px 8px 2px 28px}.mapboxgl-ctrl-attrib.mapboxgl-compact .mapboxgl-ctrl-attrib-inner{display:none}.mapboxgl-ctrl-attrib-button{background-color:hsla(0,0%,100%,.5);background-image:url(${ft});border:0;border-radius:12px;box-sizing:border-box;cursor:pointer;display:none;height:24px;outline:none;position:absolute;right:0;top:0;width:24px}.mapboxgl-ctrl-bottom-left .mapboxgl-ctrl-attrib-button,.mapboxgl-ctrl-top-left .mapboxgl-ctrl-attrib-button{left:0}.mapboxgl-ctrl-attrib.mapboxgl-compact .mapboxgl-ctrl-attrib-button,.mapboxgl-ctrl-attrib.mapboxgl-compact-show .mapboxgl-ctrl-attrib-inner{display:block}.mapboxgl-ctrl-attrib.mapboxgl-compact-show .mapboxgl-ctrl-attrib-button{background-color:rgb(0 0 0/5%)}.mapboxgl-ctrl-bottom-right>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{bottom:0;right:0}.mapboxgl-ctrl-top-right>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{right:0;top:0}.mapboxgl-ctrl-top-left>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{left:0;top:0}.mapboxgl-ctrl-bottom-left>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{bottom:0;left:0}}@media screen and (-ms-high-contrast:active){.mapboxgl-ctrl-attrib.mapboxgl-compact:after{background-image:url(${mt})}}@media screen and (-ms-high-contrast:black-on-white){.mapboxgl-ctrl-attrib.mapboxgl-compact:after{background-image:url(${ft})}}.mapboxgl-ctrl-attrib a{color:rgba(0,0,0,.75);text-decoration:none}.mapboxgl-ctrl-attrib a:hover{color:inherit;text-decoration:underline}.mapboxgl-ctrl-attrib .mapbox-improve-map{font-weight:700;margin-left:2px}.mapboxgl-attrib-empty{display:none}.mapboxgl-ctrl-scale{background-color:hsla(0,0%,100%,.75);border:2px solid #333;border-top:#333;box-sizing:border-box;color:#333;font-size:10px;padding:0 5px;white-space:nowrap}.mapboxgl-popup{display:flex;left:0;pointer-events:none;position:absolute;top:0;will-change:transform}.mapboxgl-popup-anchor-top,.mapboxgl-popup-anchor-top-left,.mapboxgl-popup-anchor-top-right{flex-direction:column}.mapboxgl-popup-anchor-bottom,.mapboxgl-popup-anchor-bottom-left,.mapboxgl-popup-anchor-bottom-right{flex-direction:column-reverse}.mapboxgl-popup-anchor-left{flex-direction:row}.mapboxgl-popup-anchor-right{flex-direction:row-reverse}.mapboxgl-popup-tip{border:10px solid transparent;height:0;width:0;z-index:1}.mapboxgl-popup-anchor-top .mapboxgl-popup-tip{align-self:center;border-bottom-color:#fff;border-top:none}.mapboxgl-popup-anchor-top-left .mapboxgl-popup-tip{align-self:flex-start;border-bottom-color:#fff;border-left:none;border-top:none}.mapboxgl-popup-anchor-top-right .mapboxgl-popup-tip{align-self:flex-end;border-bottom-color:#fff;border-right:none;border-top:none}.mapboxgl-popup-anchor-bottom .mapboxgl-popup-tip{align-self:center;border-bottom:none;border-top-color:#fff}.mapboxgl-popup-anchor-bottom-left .mapboxgl-popup-tip{align-self:flex-start;border-bottom:none;border-left:none;border-top-color:#fff}.mapboxgl-popup-anchor-bottom-right .mapboxgl-popup-tip{align-self:flex-end;border-bottom:none;border-right:none;border-top-color:#fff}.mapboxgl-popup-anchor-left .mapboxgl-popup-tip{align-self:center;border-left:none;border-right-color:#fff}.mapboxgl-popup-anchor-right .mapboxgl-popup-tip{align-self:center;border-left-color:#fff;border-right:none}.mapboxgl-popup-close-button{background-color:transparent;border:0;border-radius:0 3px 0 0;cursor:pointer;position:absolute;right:0;top:0}.mapboxgl-popup-close-button:hover{background-color:rgb(0 0 0/5%)}.mapboxgl-popup-content{background:#fff;border-radius:3px;box-shadow:0 1px 2px rgba(0,0,0,.1);padding:10px 10px 15px;pointer-events:auto;position:relative}.mapboxgl-popup-anchor-top-left .mapboxgl-popup-content{border-top-left-radius:0}.mapboxgl-popup-anchor-top-right .mapboxgl-popup-content{border-top-right-radius:0}.mapboxgl-popup-anchor-bottom-left .mapboxgl-popup-content{border-bottom-left-radius:0}.mapboxgl-popup-anchor-bottom-right .mapboxgl-popup-content{border-bottom-right-radius:0}.mapboxgl-popup-track-pointer{display:none}.mapboxgl-popup-track-pointer *{pointer-events:none;user-select:none}.mapboxgl-map:hover .mapboxgl-popup-track-pointer{display:flex}.mapboxgl-map:active .mapboxgl-popup-track-pointer{display:none}.mapboxgl-marker{left:0;opacity:1;position:absolute;top:0;transition:opacity .2s;will-change:transform}.mapboxgl-user-location-dot,.mapboxgl-user-location-dot:before{background-color:#1da1f2;border-radius:50%;height:15px;width:15px}.mapboxgl-user-location-dot:before{animation:mapboxgl-user-location-dot-pulse 2s infinite;content:"";position:absolute}.mapboxgl-user-location-dot:after{border:2px solid #fff;border-radius:50%;box-shadow:0 0 3px rgba(0,0,0,.35);box-sizing:border-box;content:"";height:19px;left:-2px;position:absolute;top:-2px;width:19px}.mapboxgl-user-location-show-heading .mapboxgl-user-location-heading{height:0;width:0}.mapboxgl-user-location-show-heading .mapboxgl-user-location-heading:after,.mapboxgl-user-location-show-heading .mapboxgl-user-location-heading:before{border-bottom:7.5px solid #4aa1eb;content:"";position:absolute}.mapboxgl-user-location-show-heading .mapboxgl-user-location-heading:before{border-left:7.5px solid transparent;transform:translateY(-28px) skewY(-20deg)}.mapboxgl-user-location-show-heading .mapboxgl-user-location-heading:after{border-right:7.5px solid transparent;transform:translate(7.5px,-28px) skewY(20deg)}@keyframes mapboxgl-user-location-dot-pulse{0%{opacity:1;transform:scale(1)}70%{opacity:0;transform:scale(3)}to{opacity:0;transform:scale(1)}}.mapboxgl-user-location-dot-stale{background-color:#aaa}.mapboxgl-user-location-dot-stale:after{display:none}.mapboxgl-user-location-accuracy-circle{background-color:#1da1f233;border-radius:100%;height:1px;width:1px}.mapboxgl-crosshair,.mapboxgl-crosshair .mapboxgl-interactive,.mapboxgl-crosshair .mapboxgl-interactive:active{cursor:crosshair}.mapboxgl-boxzoom{background:#fff;border:2px dotted #202020;height:0;left:0;opacity:.5;position:absolute;top:0;width:0}@media print{.mapbox-improve-map{display:none}}.mapboxgl-scroll-zoom-blocker,.mapboxgl-touch-pan-blocker{align-items:center;background:rgba(0,0,0,.7);color:#fff;display:flex;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica,Arial,sans-serif;height:100%;justify-content:center;left:0;opacity:0;pointer-events:none;position:absolute;text-align:center;top:0;transition:opacity .75s ease-in-out;transition-delay:1s;width:100%}.mapboxgl-scroll-zoom-blocker-show,.mapboxgl-touch-pan-blocker-show{opacity:1;transition:opacity .1s ease-in-out}.mapboxgl-canvas-container.mapboxgl-touch-pan-blocker-override.mapboxgl-scrollable-page,.mapboxgl-canvas-container.mapboxgl-touch-pan-blocker-override.mapboxgl-scrollable-page .mapboxgl-canvas{touch-action:pan-x pan-y}`,"",{version:3,sources:["webpack://./node_modules/mapbox-gl/dist/mapbox-gl.css"],names:[],mappings:"AAAA,cAAc,wDAAwD,CAAC,eAAe,CAAC,iBAAiB,CAAC,wCAAwC,CAAC,iBAAiB,MAAM,CAAC,iBAAiB,CAAC,KAAK,CAAC,kCAAkC,WAAW,CAAC,UAAU,CAAC,iBAAiB,uBAAuB,CAAC,kGAAkG,WAAW,CAAC,wBAAwB,CAAC,gBAAgB,CAAC,uEAAuE,cAAc,CAAC,gHAAgH,eAAe,CAAC,6HAA6H,wBAAwB,CAAC,uHAAuH,uBAAuB,CAAC,6KAA6K,iBAAiB,CAAC,wGAAwG,mBAAmB,CAAC,iBAAiB,CAAC,SAAS,CAAC,wBAAwB,MAAM,CAAC,KAAK,CAAC,yBAAyB,OAAO,CAAC,KAAK,CAAC,2BAA2B,QAAQ,CAAC,MAAM,CAAC,4BAA4B,QAAQ,CAAC,OAAO,CAAC,eAAe,UAAU,CAAC,mBAAmB,CAAC,sBAAsB,CAAC,uCAAuC,UAAU,CAAC,oBAAoB,CAAC,wCAAwC,WAAW,CAAC,oBAAoB,CAAC,0CAA0C,UAAU,CAAC,oBAAoB,CAAC,2CAA2C,WAAW,CAAC,oBAAoB,CAAC,qBAAqB,eAAe,CAAC,iBAAiB,CAAC,iCAAiC,mCAAmC,CAAC,kCAAkC,iCAAiC,+BAA+B,CAAC,CAAC,4BAA4B,4BAA4B,CAAC,QAAQ,CAAC,qBAAqB,CAAC,cAAc,CAAC,aAAa,CAAC,WAAW,CAAC,YAAY,CAAC,eAAe,CAAC,SAAS,CAAC,UAAU,CAAC,mCAAmC,yBAAyB,CAAC,0CAA0C,uBAAuB,CAAC,2BAA2B,CAAC,aAAa,CAAC,WAAW,CAAC,UAAU,CAAC,kCAAkC,oBAAoB,4BAA4B,CAAC,mCAAmC,+BAA+B,CAAC,CAAC,qEAAqE,8BAA8B,CAAC,+BAA+B,kBAAkB,CAAC,mDAAmD,WAAW,CAAC,wCAAwC,yBAAyB,CAAC,uCAAuC,yBAAyB,CAAC,uCAAuC,qBAAqB,CAAC,2CAA2C,8BAA8B,CAAC,gDAAgD,8BAA8B,CAAC,sDAAsD,eAAe,CAAC,iEAAiE,wDAAsP,CAAC,gEAAgE,wDAAwV,CAAC,kCAAkC,iEAAiE,wDAAsP,CAAC,gEAAgE,wDAAwV,CAAC,CAAC,0CAA0C,iEAAiE,wDAAsP,CAAC,gEAAgE,wDAAwV,CAAC,CAAC,mEAAmE,wDAAkb,CAAC,+DAA+D,wDAA2a,CAAC,kCAAkC,mEAAmE,wDAAkb,CAAC,+DAA+D,wDAAyb,CAAC,CAAC,0CAA0C,mEAAmE,yDAAkb,CAAC,+DAA+D,yDAAyb,CAAC,CAAC,gEAAgE,yDAAkP,CAAC,kCAAkC,gEAAgE,yDAAkP,CAAC,CAAC,0CAA0C,gEAAgE,yDAAkP,CAAC,CAAC,kEAAkE,yDAAge,CAAC,2EAA2E,yDAA+d,CAAC,iGAAiG,yDAAme,CAAC,uGAAuG,yDAAme,CAAC,qGAAqG,yDAAkf,CAAC,2GAA2G,yDAAkf,CAAC,kGAAkG,0CAA0C,CAAC,kCAAkC,kEAAkE,yDAAge,CAAC,2EAA2E,yDAA+d,CAAC,iGAAiG,yDAAme,CAAC,uGAAuG,yDAAme,CAAC,qGAAqG,yDAAkf,CAAC,2GAA2G,yDAAkf,CAAC,CAAC,0CAA0C,kEAAkE,yDAAge,CAAC,2EAA2E,yDAA+d,CAAC,CAAC,yBAAyB,GAAG,sBAAsB,CAAC,GAAG,uBAAuB,CAAC,CAAC,qBAAqB,yDAA+lG,CAAC,2BAA2B,CAAC,cAAc,CAAC,aAAa,CAAC,WAAW,CAAC,oBAAoB,CAAC,eAAe,CAAC,UAAU,CAAC,sCAAsC,UAAU,CAAC,kCAAkC,qBAAqB,4BAA4B,CAAC,yDAA2lG,CAAC,CAAC,0CAA0C,qBAAqB,yDAAymG,CAAC,CAAC,oCAAoC,mCAAmC,CAAC,QAAQ,CAAC,aAAa,CAAC,cAAc,uCAAuC,qBAAqB,CAAC,kBAAkB,CAAC,sBAAsB,CAAC,WAAW,CAAC,eAAe,CAAC,sBAAsB,CAAC,iBAAiB,CAAC,4CAA4C,wBAAwB,CAAC,kBAAkB,CAAC,2IAA2I,kBAAkB,CAAC,wBAAwB,CAAC,mEAAmE,YAAY,CAAC,6BAA6B,mCAAmC,CAAC,yDAA4Q,CAAC,QAAQ,CAAC,kBAAkB,CAAC,qBAAqB,CAAC,cAAc,CAAC,YAAY,CAAC,WAAW,CAAC,YAAY,CAAC,iBAAiB,CAAC,OAAO,CAAC,KAAK,CAAC,UAAU,CAAC,6GAA6G,MAAM,CAAC,4IAA4I,aAAa,CAAC,yEAAyE,8BAA8B,CAAC,yEAAyE,QAAQ,CAAC,OAAO,CAAC,sEAAsE,OAAO,CAAC,KAAK,CAAC,qEAAqE,MAAM,CAAC,KAAK,CAAC,wEAAwE,QAAQ,CAAC,MAAM,CAAC,CAAC,6CAA6C,6CAA6C,yDAA0R,CAAC,CAAC,qDAAqD,6CAA6C,yDAA4Q,CAAC,CAAC,wBAAwB,qBAAqB,CAAC,oBAAoB,CAAC,8BAA8B,aAAa,CAAC,yBAAyB,CAAC,0CAA0C,eAAe,CAAC,eAAe,CAAC,uBAAuB,YAAY,CAAC,qBAAqB,oCAAoC,CAAC,qBAAqB,CAAC,eAAe,CAAC,qBAAqB,CAAC,UAAU,CAAC,cAAc,CAAC,aAAa,CAAC,kBAAkB,CAAC,gBAAgB,YAAY,CAAC,MAAM,CAAC,mBAAmB,CAAC,iBAAiB,CAAC,KAAK,CAAC,qBAAqB,CAAC,4FAA4F,qBAAqB,CAAC,qGAAqG,6BAA6B,CAAC,4BAA4B,kBAAkB,CAAC,6BAA6B,0BAA0B,CAAC,oBAAoB,6BAA6B,CAAC,QAAQ,CAAC,OAAO,CAAC,SAAS,CAAC,+CAA+C,iBAAiB,CAAC,wBAAwB,CAAC,eAAe,CAAC,oDAAoD,qBAAqB,CAAC,wBAAwB,CAAC,gBAAgB,CAAC,eAAe,CAAC,qDAAqD,mBAAmB,CAAC,wBAAwB,CAAC,iBAAiB,CAAC,eAAe,CAAC,kDAAkD,iBAAiB,CAAC,kBAAkB,CAAC,qBAAqB,CAAC,uDAAuD,qBAAqB,CAAC,kBAAkB,CAAC,gBAAgB,CAAC,qBAAqB,CAAC,wDAAwD,mBAAmB,CAAC,kBAAkB,CAAC,iBAAiB,CAAC,qBAAqB,CAAC,gDAAgD,iBAAiB,CAAC,gBAAgB,CAAC,uBAAuB,CAAC,iDAAiD,iBAAiB,CAAC,sBAAsB,CAAC,iBAAiB,CAAC,6BAA6B,4BAA4B,CAAC,QAAQ,CAAC,uBAAuB,CAAC,cAAc,CAAC,iBAAiB,CAAC,OAAO,CAAC,KAAK,CAAC,mCAAmC,8BAA8B,CAAC,wBAAwB,eAAe,CAAC,iBAAiB,CAAC,mCAAmC,CAAC,sBAAsB,CAAC,mBAAmB,CAAC,iBAAiB,CAAC,wDAAwD,wBAAwB,CAAC,yDAAyD,yBAAyB,CAAC,2DAA2D,2BAA2B,CAAC,4DAA4D,4BAA4B,CAAC,8BAA8B,YAAY,CAAC,gCAAgC,mBAAmB,CAAC,gBAAgB,CAAC,kDAAkD,YAAY,CAAC,mDAAmD,YAAY,CAAC,iBAAiB,MAAM,CAAC,SAAS,CAAC,iBAAiB,CAAC,KAAK,CAAC,sBAAsB,CAAC,qBAAqB,CAAC,+DAA+D,wBAAwB,CAAC,iBAAiB,CAAC,WAAW,CAAC,UAAU,CAAC,mCAAmC,sDAAsD,CAAC,UAAU,CAAC,iBAAiB,CAAC,kCAAkC,qBAAqB,CAAC,iBAAiB,CAAC,kCAAkC,CAAC,qBAAqB,CAAC,UAAU,CAAC,WAAW,CAAC,SAAS,CAAC,iBAAiB,CAAC,QAAQ,CAAC,UAAU,CAAC,qEAAqE,QAAQ,CAAC,OAAO,CAAC,uJAAuJ,iCAAiC,CAAC,UAAU,CAAC,iBAAiB,CAAC,4EAA4E,mCAAmC,CAAC,yCAAyC,CAAC,2EAA2E,oCAAoC,CAAC,6CAA6C,CAAC,4CAA4C,GAAG,SAAS,CAAC,kBAAkB,CAAC,IAAI,SAAS,CAAC,kBAAkB,CAAC,GAAG,SAAS,CAAC,kBAAkB,CAAC,CAAC,kCAAkC,qBAAqB,CAAC,wCAAwC,YAAY,CAAC,wCAAwC,0BAA0B,CAAC,kBAAkB,CAAC,UAAU,CAAC,SAAS,CAAC,+GAA+G,gBAAgB,CAAC,kBAAkB,eAAe,CAAC,yBAAyB,CAAC,QAAQ,CAAC,MAAM,CAAC,UAAU,CAAC,iBAAiB,CAAC,KAAK,CAAC,OAAO,CAAC,aAAa,oBAAoB,YAAY,CAAC,CAAC,0DAA0D,kBAAkB,CAAC,yBAAyB,CAAC,UAAU,CAAC,YAAY,CAAC,gFAAgF,CAAC,WAAW,CAAC,sBAAsB,CAAC,MAAM,CAAC,SAAS,CAAC,mBAAmB,CAAC,iBAAiB,CAAC,iBAAiB,CAAC,KAAK,CAAC,mCAAmC,CAAC,mBAAmB,CAAC,UAAU,CAAC,oEAAoE,SAAS,CAAC,kCAAkC,CAAC,iMAAiM,wBAAwB",sourcesContent:[".mapboxgl-map{font:12px/20px Helvetica Neue,Arial,Helvetica,sans-serif;overflow:hidden;position:relative;-webkit-tap-highlight-color:rgb(0 0 0/0)}.mapboxgl-canvas{left:0;position:absolute;top:0}.mapboxgl-map:-webkit-full-screen{height:100%;width:100%}.mapboxgl-canary{background-color:salmon}.mapboxgl-canvas-container.mapboxgl-interactive,.mapboxgl-ctrl-group button.mapboxgl-ctrl-compass{cursor:grab;-webkit-user-select:none;user-select:none}.mapboxgl-canvas-container.mapboxgl-interactive.mapboxgl-track-pointer{cursor:pointer}.mapboxgl-canvas-container.mapboxgl-interactive:active,.mapboxgl-ctrl-group button.mapboxgl-ctrl-compass:active{cursor:grabbing}.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate,.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate .mapboxgl-canvas{touch-action:pan-x pan-y}.mapboxgl-canvas-container.mapboxgl-touch-drag-pan,.mapboxgl-canvas-container.mapboxgl-touch-drag-pan .mapboxgl-canvas{touch-action:pinch-zoom}.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate.mapboxgl-touch-drag-pan,.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate.mapboxgl-touch-drag-pan .mapboxgl-canvas{touch-action:none}.mapboxgl-ctrl-bottom-left,.mapboxgl-ctrl-bottom-right,.mapboxgl-ctrl-top-left,.mapboxgl-ctrl-top-right{pointer-events:none;position:absolute;z-index:2}.mapboxgl-ctrl-top-left{left:0;top:0}.mapboxgl-ctrl-top-right{right:0;top:0}.mapboxgl-ctrl-bottom-left{bottom:0;left:0}.mapboxgl-ctrl-bottom-right{bottom:0;right:0}.mapboxgl-ctrl{clear:both;pointer-events:auto;transform:translate(0)}.mapboxgl-ctrl-top-left .mapboxgl-ctrl{float:left;margin:10px 0 0 10px}.mapboxgl-ctrl-top-right .mapboxgl-ctrl{float:right;margin:10px 10px 0 0}.mapboxgl-ctrl-bottom-left .mapboxgl-ctrl{float:left;margin:0 0 10px 10px}.mapboxgl-ctrl-bottom-right .mapboxgl-ctrl{float:right;margin:0 10px 10px 0}.mapboxgl-ctrl-group{background:#fff;border-radius:4px}.mapboxgl-ctrl-group:not(:empty){box-shadow:0 0 0 2px rgba(0,0,0,.1)}@media (-ms-high-contrast:active){.mapboxgl-ctrl-group:not(:empty){box-shadow:0 0 0 2px ButtonText}}.mapboxgl-ctrl-group button{background-color:transparent;border:0;box-sizing:border-box;cursor:pointer;display:block;height:29px;outline:none;overflow:hidden;padding:0;width:29px}.mapboxgl-ctrl-group button+button{border-top:1px solid #ddd}.mapboxgl-ctrl button .mapboxgl-ctrl-icon{background-position:50%;background-repeat:no-repeat;display:block;height:100%;width:100%}@media (-ms-high-contrast:active){.mapboxgl-ctrl-icon{background-color:transparent}.mapboxgl-ctrl-group button+button{border-top:1px solid ButtonText}}.mapboxgl-ctrl-attrib-button:focus,.mapboxgl-ctrl-group button:focus{box-shadow:0 0 2px 2px #0096ff}.mapboxgl-ctrl button:disabled{cursor:not-allowed}.mapboxgl-ctrl button:disabled .mapboxgl-ctrl-icon{opacity:.25}.mapboxgl-ctrl-group button:first-child{border-radius:4px 4px 0 0}.mapboxgl-ctrl-group button:last-child{border-radius:0 0 4px 4px}.mapboxgl-ctrl-group button:only-child{border-radius:inherit}.mapboxgl-ctrl button:not(:disabled):hover{background-color:rgb(0 0 0/5%)}.mapboxgl-ctrl-group button:focus:focus-visible{box-shadow:0 0 2px 2px #0096ff}.mapboxgl-ctrl-group button:focus:not(:focus-visible){box-shadow:none}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='%23333' viewBox='0 0 29 29'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='%23333' viewBox='0 0 29 29'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E\")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='%23fff' viewBox='0 0 29 29'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='%23fff' viewBox='0 0 29 29'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E\")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='%23000' viewBox='0 0 29 29'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='%23000' viewBox='0 0 29 29'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E\")}}.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='%23333' viewBox='0 0 29 29'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 29 29'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E\")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='%23fff' viewBox='0 0 29 29'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='%23fff' viewBox='0 0 29 29'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E\")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='%23000' viewBox='0 0 29 29'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='%23000' viewBox='0 0 29 29'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E\")}}.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='%23333' viewBox='0 0 29 29'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath id='south' d='M10.5 16l4 8 4-8h-8z' fill='%23ccc'/%3E%3C/svg%3E\")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='%23fff' viewBox='0 0 29 29'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath id='south' d='M10.5 16l4 8 4-8h-8z' fill='%23999'/%3E%3C/svg%3E\")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='%23000' viewBox='0 0 29 29'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath id='south' d='M10.5 16l4 8 4-8h-8z' fill='%23ccc'/%3E%3C/svg%3E\")}}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7z'/%3E%3Ccircle id='dot' cx='10' cy='10' r='2'/%3E%3Cpath id='stroke' d='M14 5l1 1-9 9-1-1 9-9z' display='none'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23aaa'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7z'/%3E%3Ccircle id='dot' cx='10' cy='10' r='2'/%3E%3Cpath id='stroke' d='M14 5l1 1-9 9-1-1 9-9z' fill='%23f00'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7z'/%3E%3Ccircle id='dot' cx='10' cy='10' r='2'/%3E%3Cpath id='stroke' d='M14 5l1 1-9 9-1-1 9-9z' display='none'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active-error .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e58978'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7z'/%3E%3Ccircle id='dot' cx='10' cy='10' r='2'/%3E%3Cpath id='stroke' d='M14 5l1 1-9 9-1-1 9-9z' display='none'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7z'/%3E%3Ccircle id='dot' cx='10' cy='10' r='2' display='none'/%3E%3Cpath id='stroke' d='M14 5l1 1-9 9-1-1 9-9z' display='none'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background-error .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e54e33'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7z'/%3E%3Ccircle id='dot' cx='10' cy='10' r='2' display='none'/%3E%3Cpath id='stroke' d='M14 5l1 1-9 9-1-1 9-9z' display='none'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-waiting .mapboxgl-ctrl-icon{animation:mapboxgl-spin 2s linear infinite}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7z'/%3E%3Ccircle id='dot' cx='10' cy='10' r='2'/%3E%3Cpath id='stroke' d='M14 5l1 1-9 9-1-1 9-9z' display='none'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23999'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7z'/%3E%3Ccircle id='dot' cx='10' cy='10' r='2'/%3E%3Cpath id='stroke' d='M14 5l1 1-9 9-1-1 9-9z' fill='%23f00'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7z'/%3E%3Ccircle id='dot' cx='10' cy='10' r='2'/%3E%3Cpath id='stroke' d='M14 5l1 1-9 9-1-1 9-9z' display='none'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active-error .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e58978'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7z'/%3E%3Ccircle id='dot' cx='10' cy='10' r='2'/%3E%3Cpath id='stroke' d='M14 5l1 1-9 9-1-1 9-9z' display='none'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7z'/%3E%3Ccircle id='dot' cx='10' cy='10' r='2' display='none'/%3E%3Cpath id='stroke' d='M14 5l1 1-9 9-1-1 9-9z' display='none'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background-error .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e54e33'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7z'/%3E%3Ccircle id='dot' cx='10' cy='10' r='2' display='none'/%3E%3Cpath id='stroke' d='M14 5l1 1-9 9-1-1 9-9z' display='none'/%3E%3C/svg%3E\")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23000'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7z'/%3E%3Ccircle id='dot' cx='10' cy='10' r='2'/%3E%3Cpath id='stroke' d='M14 5l1 1-9 9-1-1 9-9z' display='none'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23666'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7z'/%3E%3Ccircle id='dot' cx='10' cy='10' r='2'/%3E%3Cpath id='stroke' d='M14 5l1 1-9 9-1-1 9-9z' fill='%23f00'/%3E%3C/svg%3E\")}}@keyframes mapboxgl-spin{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}a.mapboxgl-ctrl-logo{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd' viewBox='0 0 88 23'%3E%3Cdefs%3E%3Cpath id='logo' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='text' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='clip'%3E%3Crect x='0' y='0' width='100%25' height='100%25' fill='white'/%3E%3Cuse xlink:href='%23logo'/%3E%3Cuse xlink:href='%23text'/%3E%3C/mask%3E%3Cg id='outline' opacity='0.3' stroke='%23000' stroke-width='3'%3E%3Ccircle mask='url(%23clip)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23text' mask='url(%23clip)'/%3E%3C/g%3E%3Cg id='fill' opacity='0.9' fill='%23fff'%3E%3Cuse xlink:href='%23logo'/%3E%3Cuse xlink:href='%23text'/%3E%3C/g%3E%3C/svg%3E\");background-repeat:no-repeat;cursor:pointer;display:block;height:23px;margin:0 0 -4px -4px;overflow:hidden;width:88px}a.mapboxgl-ctrl-logo.mapboxgl-compact{width:23px}@media (-ms-high-contrast:active){a.mapboxgl-ctrl-logo{background-color:transparent;background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd' viewBox='0 0 88 23'%3E%3Cdefs%3E%3Cpath id='logo' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='text' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='clip'%3E%3Crect x='0' y='0' width='100%25' height='100%25' fill='white'/%3E%3Cuse xlink:href='%23logo'/%3E%3Cuse xlink:href='%23text'/%3E%3C/mask%3E%3Cg id='outline' opacity='1' stroke='%23000' stroke-width='3'%3E%3Ccircle mask='url(%23clip)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23text' mask='url(%23clip)'/%3E%3C/g%3E%3Cg id='fill' opacity='1' fill='%23fff'%3E%3Cuse xlink:href='%23logo'/%3E%3Cuse xlink:href='%23text'/%3E%3C/g%3E%3C/svg%3E\")}}@media (-ms-high-contrast:black-on-white){a.mapboxgl-ctrl-logo{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd' viewBox='0 0 88 23'%3E%3Cdefs%3E%3Cpath id='logo' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='text' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='clip'%3E%3Crect x='0' y='0' width='100%25' height='100%25' fill='white'/%3E%3Cuse xlink:href='%23logo'/%3E%3Cuse xlink:href='%23text'/%3E%3C/mask%3E%3Cg id='outline' opacity='1' stroke='%23fff' stroke-width='3' fill='%23fff'%3E%3Ccircle mask='url(%23clip)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23text' mask='url(%23clip)'/%3E%3C/g%3E%3Cg id='fill' opacity='1' fill='%23000'%3E%3Cuse xlink:href='%23logo'/%3E%3Cuse xlink:href='%23text'/%3E%3C/g%3E%3C/svg%3E\")}}.mapboxgl-ctrl.mapboxgl-ctrl-attrib{background-color:hsla(0,0%,100%,.5);margin:0;padding:0 5px}@media screen{.mapboxgl-ctrl-attrib.mapboxgl-compact{background-color:#fff;border-radius:12px;box-sizing:content-box;margin:10px;min-height:20px;padding:2px 24px 2px 0;position:relative}.mapboxgl-ctrl-attrib.mapboxgl-compact-show{padding:2px 28px 2px 8px;visibility:visible}.mapboxgl-ctrl-bottom-left>.mapboxgl-ctrl-attrib.mapboxgl-compact-show,.mapboxgl-ctrl-top-left>.mapboxgl-ctrl-attrib.mapboxgl-compact-show{border-radius:12px;padding:2px 8px 2px 28px}.mapboxgl-ctrl-attrib.mapboxgl-compact .mapboxgl-ctrl-attrib-inner{display:none}.mapboxgl-ctrl-attrib-button{background-color:hsla(0,0%,100%,.5);background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd'%3E%3Cpath d='M4 10a6 6 0 1 0 12 0 6 6 0 1 0-12 0m5-3a1 1 0 1 0 2 0 1 1 0 1 0-2 0m0 3a1 1 0 1 1 2 0v3a1 1 0 1 1-2 0'/%3E%3C/svg%3E\");border:0;border-radius:12px;box-sizing:border-box;cursor:pointer;display:none;height:24px;outline:none;position:absolute;right:0;top:0;width:24px}.mapboxgl-ctrl-bottom-left .mapboxgl-ctrl-attrib-button,.mapboxgl-ctrl-top-left .mapboxgl-ctrl-attrib-button{left:0}.mapboxgl-ctrl-attrib.mapboxgl-compact .mapboxgl-ctrl-attrib-button,.mapboxgl-ctrl-attrib.mapboxgl-compact-show .mapboxgl-ctrl-attrib-inner{display:block}.mapboxgl-ctrl-attrib.mapboxgl-compact-show .mapboxgl-ctrl-attrib-button{background-color:rgb(0 0 0/5%)}.mapboxgl-ctrl-bottom-right>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{bottom:0;right:0}.mapboxgl-ctrl-top-right>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{right:0;top:0}.mapboxgl-ctrl-top-left>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{left:0;top:0}.mapboxgl-ctrl-bottom-left>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{bottom:0;left:0}}@media screen and (-ms-high-contrast:active){.mapboxgl-ctrl-attrib.mapboxgl-compact:after{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd' fill='%23fff'%3E%3Cpath d='M4 10a6 6 0 1 0 12 0 6 6 0 1 0-12 0m5-3a1 1 0 1 0 2 0 1 1 0 1 0-2 0m0 3a1 1 0 1 1 2 0v3a1 1 0 1 1-2 0'/%3E%3C/svg%3E\")}}@media screen and (-ms-high-contrast:black-on-white){.mapboxgl-ctrl-attrib.mapboxgl-compact:after{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd'%3E%3Cpath d='M4 10a6 6 0 1 0 12 0 6 6 0 1 0-12 0m5-3a1 1 0 1 0 2 0 1 1 0 1 0-2 0m0 3a1 1 0 1 1 2 0v3a1 1 0 1 1-2 0'/%3E%3C/svg%3E\")}}.mapboxgl-ctrl-attrib a{color:rgba(0,0,0,.75);text-decoration:none}.mapboxgl-ctrl-attrib a:hover{color:inherit;text-decoration:underline}.mapboxgl-ctrl-attrib .mapbox-improve-map{font-weight:700;margin-left:2px}.mapboxgl-attrib-empty{display:none}.mapboxgl-ctrl-scale{background-color:hsla(0,0%,100%,.75);border:2px solid #333;border-top:#333;box-sizing:border-box;color:#333;font-size:10px;padding:0 5px;white-space:nowrap}.mapboxgl-popup{display:flex;left:0;pointer-events:none;position:absolute;top:0;will-change:transform}.mapboxgl-popup-anchor-top,.mapboxgl-popup-anchor-top-left,.mapboxgl-popup-anchor-top-right{flex-direction:column}.mapboxgl-popup-anchor-bottom,.mapboxgl-popup-anchor-bottom-left,.mapboxgl-popup-anchor-bottom-right{flex-direction:column-reverse}.mapboxgl-popup-anchor-left{flex-direction:row}.mapboxgl-popup-anchor-right{flex-direction:row-reverse}.mapboxgl-popup-tip{border:10px solid transparent;height:0;width:0;z-index:1}.mapboxgl-popup-anchor-top .mapboxgl-popup-tip{align-self:center;border-bottom-color:#fff;border-top:none}.mapboxgl-popup-anchor-top-left .mapboxgl-popup-tip{align-self:flex-start;border-bottom-color:#fff;border-left:none;border-top:none}.mapboxgl-popup-anchor-top-right .mapboxgl-popup-tip{align-self:flex-end;border-bottom-color:#fff;border-right:none;border-top:none}.mapboxgl-popup-anchor-bottom .mapboxgl-popup-tip{align-self:center;border-bottom:none;border-top-color:#fff}.mapboxgl-popup-anchor-bottom-left .mapboxgl-popup-tip{align-self:flex-start;border-bottom:none;border-left:none;border-top-color:#fff}.mapboxgl-popup-anchor-bottom-right .mapboxgl-popup-tip{align-self:flex-end;border-bottom:none;border-right:none;border-top-color:#fff}.mapboxgl-popup-anchor-left .mapboxgl-popup-tip{align-self:center;border-left:none;border-right-color:#fff}.mapboxgl-popup-anchor-right .mapboxgl-popup-tip{align-self:center;border-left-color:#fff;border-right:none}.mapboxgl-popup-close-button{background-color:transparent;border:0;border-radius:0 3px 0 0;cursor:pointer;position:absolute;right:0;top:0}.mapboxgl-popup-close-button:hover{background-color:rgb(0 0 0/5%)}.mapboxgl-popup-content{background:#fff;border-radius:3px;box-shadow:0 1px 2px rgba(0,0,0,.1);padding:10px 10px 15px;pointer-events:auto;position:relative}.mapboxgl-popup-anchor-top-left .mapboxgl-popup-content{border-top-left-radius:0}.mapboxgl-popup-anchor-top-right .mapboxgl-popup-content{border-top-right-radius:0}.mapboxgl-popup-anchor-bottom-left .mapboxgl-popup-content{border-bottom-left-radius:0}.mapboxgl-popup-anchor-bottom-right .mapboxgl-popup-content{border-bottom-right-radius:0}.mapboxgl-popup-track-pointer{display:none}.mapboxgl-popup-track-pointer *{pointer-events:none;user-select:none}.mapboxgl-map:hover .mapboxgl-popup-track-pointer{display:flex}.mapboxgl-map:active .mapboxgl-popup-track-pointer{display:none}.mapboxgl-marker{left:0;opacity:1;position:absolute;top:0;transition:opacity .2s;will-change:transform}.mapboxgl-user-location-dot,.mapboxgl-user-location-dot:before{background-color:#1da1f2;border-radius:50%;height:15px;width:15px}.mapboxgl-user-location-dot:before{animation:mapboxgl-user-location-dot-pulse 2s infinite;content:\"\";position:absolute}.mapboxgl-user-location-dot:after{border:2px solid #fff;border-radius:50%;box-shadow:0 0 3px rgba(0,0,0,.35);box-sizing:border-box;content:\"\";height:19px;left:-2px;position:absolute;top:-2px;width:19px}.mapboxgl-user-location-show-heading .mapboxgl-user-location-heading{height:0;width:0}.mapboxgl-user-location-show-heading .mapboxgl-user-location-heading:after,.mapboxgl-user-location-show-heading .mapboxgl-user-location-heading:before{border-bottom:7.5px solid #4aa1eb;content:\"\";position:absolute}.mapboxgl-user-location-show-heading .mapboxgl-user-location-heading:before{border-left:7.5px solid transparent;transform:translateY(-28px) skewY(-20deg)}.mapboxgl-user-location-show-heading .mapboxgl-user-location-heading:after{border-right:7.5px solid transparent;transform:translate(7.5px,-28px) skewY(20deg)}@keyframes mapboxgl-user-location-dot-pulse{0%{opacity:1;transform:scale(1)}70%{opacity:0;transform:scale(3)}to{opacity:0;transform:scale(1)}}.mapboxgl-user-location-dot-stale{background-color:#aaa}.mapboxgl-user-location-dot-stale:after{display:none}.mapboxgl-user-location-accuracy-circle{background-color:#1da1f233;border-radius:100%;height:1px;width:1px}.mapboxgl-crosshair,.mapboxgl-crosshair .mapboxgl-interactive,.mapboxgl-crosshair .mapboxgl-interactive:active{cursor:crosshair}.mapboxgl-boxzoom{background:#fff;border:2px dotted #202020;height:0;left:0;opacity:.5;position:absolute;top:0;width:0}@media print{.mapbox-improve-map{display:none}}.mapboxgl-scroll-zoom-blocker,.mapboxgl-touch-pan-blocker{align-items:center;background:rgba(0,0,0,.7);color:#fff;display:flex;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica,Arial,sans-serif;height:100%;justify-content:center;left:0;opacity:0;pointer-events:none;position:absolute;text-align:center;top:0;transition:opacity .75s ease-in-out;transition-delay:1s;width:100%}.mapboxgl-scroll-zoom-blocker-show,.mapboxgl-touch-pan-blocker-show{opacity:1;transition:opacity .1s ease-in-out}.mapboxgl-canvas-container.mapboxgl-touch-pan-blocker-override.mapboxgl-scrollable-page,.mapboxgl-canvas-container.mapboxgl-touch-pan-blocker-override.mapboxgl-scrollable-page .mapboxgl-canvas{touch-action:pan-x pan-y}"],sourceRoot:""}]);const gt=N},6314:t=>{"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var n="",i=void 0!==e[5];return e[4]&&(n+="@supports (".concat(e[4],") {")),e[2]&&(n+="@media ".concat(e[2]," {")),i&&(n+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),n+=t(e),i&&(n+="}"),e[2]&&(n+="}"),e[4]&&(n+="}"),n})).join("")},e.i=function(t,n,i,a,r){"string"==typeof t&&(t=[[null,t,void 0]]);var o={};if(i)for(var s=0;s<this.length;s++){var l=this[s][0];null!=l&&(o[l]=!0)}for(var c=0;c<t.length;c++){var u=[].concat(t[c]);i&&o[u[0]]||(void 0!==r&&(void 0===u[5]||(u[1]="@layer".concat(u[5].length>0?" ".concat(u[5]):""," {").concat(u[1],"}")),u[5]=r),n&&(u[2]?(u[1]="@media ".concat(u[2]," {").concat(u[1],"}"),u[2]=n):u[2]=n),a&&(u[4]?(u[1]="@supports (".concat(u[4],") {").concat(u[1],"}"),u[4]=a):u[4]="".concat(a)),e.push(u))}},e}},4417:t=>{"use strict";t.exports=function(t,e){return e||(e={}),t?(t=String(t.__esModule?t.default:t),/^['"].*['"]$/.test(t)&&(t=t.slice(1,-1)),e.hash&&(t+=e.hash),/["'() \t\n]|(%20)/.test(t)||e.needQuotes?'"'.concat(t.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):t):t}},1354:t=>{"use strict";t.exports=function(t){var e=t[1],n=t[3];if(!n)return e;if("function"==typeof btoa){var i=btoa(unescape(encodeURIComponent(JSON.stringify(n)))),a="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(i),r="/*# ".concat(a," */");return[e].concat([r]).join("\n")}return[e].join("\n")}},182:(t,e,n)=>{t=n.nmd(t);var i="__lodash_hash_undefined__",a=9007199254740991,r="[object Arguments]",o="[object AsyncFunction]",s="[object Function]",l="[object GeneratorFunction]",c="[object Null]",u="[object Object]",h="[object Proxy]",d="[object Undefined]",p=/^\[object .+?Constructor\]$/,f=/^(?:0|[1-9]\d*)$/,m={};m["[object Float32Array]"]=m["[object Float64Array]"]=m["[object Int8Array]"]=m["[object Int16Array]"]=m["[object Int32Array]"]=m["[object Uint8Array]"]=m["[object Uint8ClampedArray]"]=m["[object Uint16Array]"]=m["[object Uint32Array]"]=!0,m[r]=m["[object Array]"]=m["[object ArrayBuffer]"]=m["[object Boolean]"]=m["[object DataView]"]=m["[object Date]"]=m["[object Error]"]=m[s]=m["[object Map]"]=m["[object Number]"]=m[u]=m["[object RegExp]"]=m["[object Set]"]=m["[object String]"]=m["[object WeakMap]"]=!1;var g,_,y,x="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g,v="object"==typeof self&&self&&self.Object===Object&&self,b=x||v||Function("return this")(),w=e&&!e.nodeType&&e,A=w&&t&&!t.nodeType&&t,C=A&&A.exports===w,E=C&&x.process,T=function(){try{return A&&A.require&&A.require("util").types||E&&E.binding&&E.binding("util")}catch(t){}}(),S=T&&T.isTypedArray,M=Array.prototype,k=Function.prototype,I=Object.prototype,P=b["__core-js_shared__"],z=k.toString,D=I.hasOwnProperty,L=(g=/[^.]+$/.exec(P&&P.keys&&P.keys.IE_PROTO||""))?"Symbol(src)_1."+g:"",B=I.toString,O=z.call(Object),R=RegExp("^"+z.call(D).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),F=C?b.Buffer:void 0,N=b.Symbol,j=b.Uint8Array,V=(F&&F.allocUnsafe,_=Object.getPrototypeOf,y=Object,function(t){return _(y(t))}),U=Object.create,G=I.propertyIsEnumerable,q=M.splice,$=N?N.toStringTag:void 0,W=function(){try{var t=dt(Object,"defineProperty");return t({},"",{}),t}catch(t){}}(),H=F?F.isBuffer:void 0,Z=Math.max,Y=Date.now,X=dt(b,"Map"),K=dt(Object,"create"),Q=function(){function t(){}return function(e){if(!Ct(e))return{};if(U)return U(e);t.prototype=e;var n=new t;return t.prototype=void 0,n}}();function J(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}function tt(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}function et(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}function nt(t){var e=this.__data__=new tt(t);this.size=e.size}function it(t,e,n){(void 0!==n&&!_t(t[e],n)||void 0===n&&!(e in t))&&ot(t,e,n)}function at(t,e,n){var i=t[e];D.call(t,e)&&_t(i,n)&&(void 0!==n||e in t)||ot(t,e,n)}function rt(t,e){for(var n=t.length;n--;)if(_t(t[n][0],e))return n;return-1}function ot(t,e,n){"__proto__"==e&&W?W(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}J.prototype.clear=function(){this.__data__=K?K(null):{},this.size=0},J.prototype.delete=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},J.prototype.get=function(t){var e=this.__data__;if(K){var n=e[t];return n===i?void 0:n}return D.call(e,t)?e[t]:void 0},J.prototype.has=function(t){var e=this.__data__;return K?void 0!==e[t]:D.call(e,t)},J.prototype.set=function(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=K&&void 0===e?i:e,this},tt.prototype.clear=function(){this.__data__=[],this.size=0},tt.prototype.delete=function(t){var e=this.__data__,n=rt(e,t);return!(n<0||(n==e.length-1?e.pop():q.call(e,n,1),--this.size,0))},tt.prototype.get=function(t){var e=this.__data__,n=rt(e,t);return n<0?void 0:e[n][1]},tt.prototype.has=function(t){return rt(this.__data__,t)>-1},tt.prototype.set=function(t,e){var n=this.__data__,i=rt(n,t);return i<0?(++this.size,n.push([t,e])):n[i][1]=e,this},et.prototype.clear=function(){this.size=0,this.__data__={hash:new J,map:new(X||tt),string:new J}},et.prototype.delete=function(t){var e=ht(this,t).delete(t);return this.size-=e?1:0,e},et.prototype.get=function(t){return ht(this,t).get(t)},et.prototype.has=function(t){return ht(this,t).has(t)},et.prototype.set=function(t,e){var n=ht(this,t),i=n.size;return n.set(t,e),this.size+=n.size==i?0:1,this},nt.prototype.clear=function(){this.__data__=new tt,this.size=0},nt.prototype.delete=function(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n},nt.prototype.get=function(t){return this.__data__.get(t)},nt.prototype.has=function(t){return this.__data__.has(t)},nt.prototype.set=function(t,e){var n=this.__data__;if(n instanceof tt){var i=n.__data__;if(!X||i.length<199)return i.push([t,e]),this.size=++n.size,this;n=this.__data__=new et(i)}return n.set(t,e),this.size=n.size,this};function st(t){return null==t?void 0===t?d:c:$&&$ in Object(t)?function(t){var e=D.call(t,$),n=t[$];try{t[$]=void 0;var i=!0}catch(t){}var a=B.call(t);return i&&(e?t[$]=n:delete t[$]),a}(t):function(t){return B.call(t)}(t)}function lt(t){return Et(t)&&st(t)==r}function ct(t,e,n,i,a){t!==e&&function(t,e,n){for(var i=-1,a=Object(t),r=n(t),o=r.length;o--;){var s=r[++i];if(!1===e(a[s],s,a))break}}(e,(function(r,o){if(a||(a=new nt),Ct(r))!function(t,e,n,i,a,r,o){var s=mt(t,n),l=mt(e,n),c=o.get(l);if(c)it(t,n,c);else{var h,d,p,f,m,g=r?r(s,l,n+"",t,e,o):void 0,_=void 0===g;if(_){var y=xt(l),x=!y&&bt(l),v=!y&&!x&&Tt(l);g=l,y||x||v?xt(s)?g=s:Et(m=s)&&vt(m)?g=function(t,e){var n=-1,i=t.length;for(e||(e=Array(i));++n<i;)e[n]=t[n];return e}(s):x?(_=!1,g=function(t,e){return t.slice()}(l)):v?(_=!1,f=new(p=(h=l).buffer).constructor(p.byteLength),new j(f).set(new j(p)),d=f,g=new h.constructor(d,h.byteOffset,h.length)):g=[]:function(t){if(!Et(t)||st(t)!=u)return!1;var e=V(t);if(null===e)return!0;var n=D.call(e,"constructor")&&e.constructor;return"function"==typeof n&&n instanceof n&&z.call(n)==O}(l)||yt(l)?(g=s,yt(s)?g=function(t){return function(t,e,n,i){var a=!n;n||(n={});for(var r=-1,o=e.length;++r<o;){var s=e[r],l=void 0;void 0===l&&(l=t[s]),a?ot(n,s,l):at(n,s,l)}return n}(t,St(t))}(s):Ct(s)&&!wt(s)||(g=function(t){return"function"!=typeof t.constructor||ft(t)?{}:Q(V(t))}(l))):_=!1}_&&(o.set(l,g),a(g,l,i,r,o),o.delete(l)),it(t,n,g)}}(t,e,o,n,ct,i,a);else{var s=i?i(mt(t,o),r,o+"",t,e,a):void 0;void 0===s&&(s=r),it(t,o,s)}}),St)}var ut=W?function(t,e){return W(t,"toString",{configurable:!0,enumerable:!1,value:(n=e,function(){return n}),writable:!0});var n}:It;function ht(t,e){var n,i,a=t.__data__;return("string"==(i=typeof(n=e))||"number"==i||"symbol"==i||"boolean"==i?"__proto__"!==n:null===n)?a["string"==typeof e?"string":"hash"]:a.map}function dt(t,e){var n=function(t,e){return null==t?void 0:t[e]}(t,e);return function(t){return!(!Ct(t)||function(t){return!!L&&L in t}(t))&&(wt(t)?R:p).test(function(t){if(null!=t){try{return z.call(t)}catch(t){}try{return t+""}catch(t){}}return""}(t))}(n)?n:void 0}function pt(t,e){var n=typeof t;return!!(e=null==e?a:e)&&("number"==n||"symbol"!=n&&f.test(t))&&t>-1&&t%1==0&&t<e}function ft(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||I)}function mt(t,e){if(("constructor"!==e||"function"!=typeof t[e])&&"__proto__"!=e)return t[e]}var gt=function(t){var e=0,n=0;return function(){var i=Y(),a=16-(i-n);if(n=i,a>0){if(++e>=800)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}(ut);function _t(t,e){return t===e||t!=t&&e!=e}var yt=lt(function(){return arguments}())?lt:function(t){return Et(t)&&D.call(t,"callee")&&!G.call(t,"callee")},xt=Array.isArray;function vt(t){return null!=t&&At(t.length)&&!wt(t)}var bt=H||function(){return!1};function wt(t){if(!Ct(t))return!1;var e=st(t);return e==s||e==l||e==o||e==h}function At(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=a}function Ct(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}function Et(t){return null!=t&&"object"==typeof t}var Tt=S?function(t){return function(e){return t(e)}}(S):function(t){return Et(t)&&At(t.length)&&!!m[st(t)]};function St(t){return vt(t)?function(t,e){var n=xt(t),i=!n&&yt(t),a=!n&&!i&&bt(t),r=!n&&!i&&!a&&Tt(t),o=n||i||a||r,s=o?function(t,e){for(var n=-1,i=Array(t);++n<t;)i[n]=e(n);return i}(t.length,String):[],l=s.length;for(var c in t)!e&&!D.call(t,c)||o&&("length"==c||a&&("offset"==c||"parent"==c)||r&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||pt(c,l))||s.push(c);return s}(t,!0):function(t){if(!Ct(t))return function(t){var e=[];if(null!=t)for(var n in Object(t))e.push(n);return e}(t);var e=ft(t),n=[];for(var i in t)("constructor"!=i||!e&&D.call(t,i))&&n.push(i);return n}(t)}var Mt,kt=(Mt=function(t,e,n){ct(t,e,n)},function(t,e){return gt(function(t,e,n){return e=Z(void 0===e?t.length-1:e,0),function(){for(var i=arguments,a=-1,r=Z(i.length-e,0),o=Array(r);++a<r;)o[a]=i[e+a];a=-1;for(var s=Array(e+1);++a<e;)s[a]=i[a];return s[e]=n(o),function(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}(t,this,s)}}(t,e,It),t+"")}((function(t,e){var n=-1,i=e.length,a=i>1?e[i-1]:void 0,r=i>2?e[2]:void 0;for(a=Mt.length>3&&"function"==typeof a?(i--,a):void 0,r&&function(t,e,n){if(!Ct(n))return!1;var i=typeof e;return!!("number"==i?vt(n)&&pt(e,n.length):"string"==i&&e in n)&&_t(n[e],t)}(e[0],e[1],r)&&(a=i<3?void 0:a,i=1),t=Object(t);++n<i;){var o=e[n];o&&Mt(t,o,n)}return t})));function It(t){return t}t.exports=kt},842:function(t){t.exports=function(){"use strict";var t,e,n;function i(i,a){if(t)if(e){var r="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+t+")(sharedChunk); ("+e+")(sharedChunk); self.onerror = null;",o={};t(o),n=a(o),"undefined"!=typeof window&&window&&window.URL&&window.URL.createObjectURL&&(n.workerUrl=window.URL.createObjectURL(new Blob([r],{type:"text/javascript"})))}else e=a;else t=a}return i(0,(function(t){var e="3.5.1";let n;const i={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(null==n){const t=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{n=null!="MISSING_ENV_VAR".API_URL_REGEX?new RegExp("MISSING_ENV_VAR".API_URL_REGEX):t}catch(e){n=t}}return n},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!i.API_URL)return null;try{const t=new URL(i.API_URL);return"api.mapbox.cn"===t.hostname?"https://events.mapbox.cn/events/v2":"api.mapbox.com"===t.hostname?"https://events.mapbox.com/events/v2":null}catch(t){return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",RASTERARRAYS_URL_PREFIX:"rasterarrays/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,DEFAULT_STYLE:"mapbox://styles/mapbox/standard",MAX_PARALLEL_IMAGE_REQUESTS:16,DRACO_URL:"https://api.mapbox.com/mapbox-gl-js/draco_decoder_gltf_v1.5.6.wasm",MESHOPT_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_base_v0.20.wasm",MESHOPT_SIMD_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_simd_v0.20.wasm",GLYPHS_URL:"mapbox://fonts/mapbox/{fontstack}/{range}.pbf",TILES3D_URL_PREFIX:"3dtiles/v1"};function a(t){return i.API_URL_REGEX.test(t)}function r(t){return 0===t.indexOf("mapbox:")}function o(t){return i.API_CDN_URL_REGEX.test(t)}function s(t){return i.API_SPRITE_REGEX.test(t)}function l(t){return i.API_STYLE_REGEX.test(t)&&!s(t)}const c={create:"create",load:"load",fullLoad:"fullLoad"},u={mark(t){performance.mark(t)},measure(t,e,n){performance.measure(t,e,n)}};function h(t){const e=t.name.split("?")[0];return o(e)&&e.includes("mapbox-gl.js")?"javascript":o(e)&&e.includes("mapbox-gl.css")?"css":function(t){return i.API_FONTS_REGEX.test(t)}(e)?"fontRange":s(e)?"sprite":l(e)?"style":function(t){return i.API_TILEJSON_REGEX.test(t)}(e)?"tilejson":"other"}function d(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var p={},f={};Object.defineProperty(f,"__esModule",{value:!0}),f.setMatrixArrayType=function(t){f.ARRAY_TYPE=g=t},f.toRadian=function(t){return t*y},f.equals=function(t,e){return Math.abs(t-e)<=m*Math.max(1,Math.abs(t),Math.abs(e))},f.RANDOM=f.ARRAY_TYPE=f.EPSILON=void 0;var m=1e-6;f.EPSILON=m;var g="undefined"!=typeof Float32Array?Float32Array:Array;f.ARRAY_TYPE=g;var _=Math.random;f.RANDOM=_;var y=Math.PI/180;Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});var x={};function v(t){return v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},v(t)}Object.defineProperty(x,"__esModule",{value:!0}),x.create=function(){var t=new b.ARRAY_TYPE(4);return b.ARRAY_TYPE!=Float32Array&&(t[1]=0,t[2]=0),t[0]=1,t[3]=1,t},x.clone=function(t){var e=new b.ARRAY_TYPE(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},x.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},x.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},x.fromValues=function(t,e,n,i){var a=new b.ARRAY_TYPE(4);return a[0]=t,a[1]=e,a[2]=n,a[3]=i,a},x.set=function(t,e,n,i,a){return t[0]=e,t[1]=n,t[2]=i,t[3]=a,t},x.transpose=function(t,e){if(t===e){var n=e[1];t[1]=e[2],t[2]=n}else t[0]=e[0],t[1]=e[2],t[2]=e[1],t[3]=e[3];return t},x.invert=function(t,e){var n=e[0],i=e[1],a=e[2],r=e[3],o=n*r-a*i;return o?(t[0]=r*(o=1/o),t[1]=-i*o,t[2]=-a*o,t[3]=n*o,t):null},x.adjoint=function(t,e){var n=e[0];return t[0]=e[3],t[1]=-e[1],t[2]=-e[2],t[3]=n,t},x.determinant=function(t){return t[0]*t[3]-t[2]*t[1]},x.multiply=A,x.rotate=function(t,e,n){var i=e[0],a=e[1],r=e[2],o=e[3],s=Math.sin(n),l=Math.cos(n);return t[0]=i*l+r*s,t[1]=a*l+o*s,t[2]=i*-s+r*l,t[3]=a*-s+o*l,t},x.scale=function(t,e,n){var i=e[1],a=e[2],r=e[3],o=n[0],s=n[1];return t[0]=e[0]*o,t[1]=i*o,t[2]=a*s,t[3]=r*s,t},x.fromRotation=function(t,e){var n=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=n,t[2]=-n,t[3]=i,t},x.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t},x.str=function(t){return"mat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},x.frob=function(t){return Math.hypot(t[0],t[1],t[2],t[3])},x.LDU=function(t,e,n,i){return t[2]=i[2]/i[0],n[0]=i[0],n[1]=i[1],n[3]=i[3]-t[2]*n[1],[t,e,n]},x.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t},x.subtract=C,x.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},x.equals=function(t,e){var n=t[0],i=t[1],a=t[2],r=t[3],o=e[0],s=e[1],l=e[2],c=e[3];return Math.abs(n-o)<=b.EPSILON*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(i-s)<=b.EPSILON*Math.max(1,Math.abs(i),Math.abs(s))&&Math.abs(a-l)<=b.EPSILON*Math.max(1,Math.abs(a),Math.abs(l))&&Math.abs(r-c)<=b.EPSILON*Math.max(1,Math.abs(r),Math.abs(c))},x.multiplyScalar=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t},x.multiplyScalarAndAdd=function(t,e,n,i){return t[0]=e[0]+n[0]*i,t[1]=e[1]+n[1]*i,t[2]=e[2]+n[2]*i,t[3]=e[3]+n[3]*i,t},x.sub=x.mul=void 0;var b=function(t,e){if(t&&t.__esModule)return t;if(null===t||"object"!==v(t)&&"function"!=typeof t)return{default:t};var n=w(void 0);if(n&&n.has(t))return n.get(t);var i={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in t)if("default"!==r&&Object.prototype.hasOwnProperty.call(t,r)){var o=a?Object.getOwnPropertyDescriptor(t,r):null;o&&(o.get||o.set)?Object.defineProperty(i,r,o):i[r]=t[r]}return i.default=t,n&&n.set(t,i),i}(f);function w(t){if("function"!=typeof WeakMap)return null;var e=new WeakMap,n=new WeakMap;return(w=function(t){return t?n:e})(t)}function A(t,e,n){var i=e[0],a=e[1],r=e[2],o=e[3],s=n[0],l=n[1],c=n[2],u=n[3];return t[0]=i*s+r*l,t[1]=a*s+o*l,t[2]=i*c+r*u,t[3]=a*c+o*u,t}function C(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t}x.mul=A,x.sub=C;var E={};function T(t){return T="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},T(t)}Object.defineProperty(E,"__esModule",{value:!0}),E.create=function(){var t=new S.ARRAY_TYPE(6);return S.ARRAY_TYPE!=Float32Array&&(t[1]=0,t[2]=0,t[4]=0,t[5]=0),t[0]=1,t[3]=1,t},E.clone=function(t){var e=new S.ARRAY_TYPE(6);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e},E.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t},E.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},E.fromValues=function(t,e,n,i,a,r){var o=new S.ARRAY_TYPE(6);return o[0]=t,o[1]=e,o[2]=n,o[3]=i,o[4]=a,o[5]=r,o},E.set=function(t,e,n,i,a,r,o){return t[0]=e,t[1]=n,t[2]=i,t[3]=a,t[4]=r,t[5]=o,t},E.invert=function(t,e){var n=e[0],i=e[1],a=e[2],r=e[3],o=e[4],s=e[5],l=n*r-i*a;return l?(t[0]=r*(l=1/l),t[1]=-i*l,t[2]=-a*l,t[3]=n*l,t[4]=(a*s-r*o)*l,t[5]=(i*o-n*s)*l,t):null},E.determinant=function(t){return t[0]*t[3]-t[1]*t[2]},E.multiply=k,E.rotate=function(t,e,n){var i=e[0],a=e[1],r=e[2],o=e[3],s=e[4],l=e[5],c=Math.sin(n),u=Math.cos(n);return t[0]=i*u+r*c,t[1]=a*u+o*c,t[2]=i*-c+r*u,t[3]=a*-c+o*u,t[4]=s,t[5]=l,t},E.scale=function(t,e,n){var i=e[1],a=e[2],r=e[3],o=e[4],s=e[5],l=n[0],c=n[1];return t[0]=e[0]*l,t[1]=i*l,t[2]=a*c,t[3]=r*c,t[4]=o,t[5]=s,t},E.translate=function(t,e,n){var i=e[0],a=e[1],r=e[2],o=e[3],s=e[4],l=e[5],c=n[0],u=n[1];return t[0]=i,t[1]=a,t[2]=r,t[3]=o,t[4]=i*c+r*u+s,t[5]=a*c+o*u+l,t},E.fromRotation=function(t,e){var n=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=n,t[2]=-n,t[3]=i,t[4]=0,t[5]=0,t},E.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t[4]=0,t[5]=0,t},E.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=e[0],t[5]=e[1],t},E.str=function(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"},E.frob=function(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],1)},E.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t},E.subtract=I,E.multiplyScalar=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t},E.multiplyScalarAndAdd=function(t,e,n,i){return t[0]=e[0]+n[0]*i,t[1]=e[1]+n[1]*i,t[2]=e[2]+n[2]*i,t[3]=e[3]+n[3]*i,t[4]=e[4]+n[4]*i,t[5]=e[5]+n[5]*i,t},E.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]},E.equals=function(t,e){var n=t[0],i=t[1],a=t[2],r=t[3],o=t[4],s=t[5],l=e[0],c=e[1],u=e[2],h=e[3],d=e[4],p=e[5];return Math.abs(n-l)<=S.EPSILON*Math.max(1,Math.abs(n),Math.abs(l))&&Math.abs(i-c)<=S.EPSILON*Math.max(1,Math.abs(i),Math.abs(c))&&Math.abs(a-u)<=S.EPSILON*Math.max(1,Math.abs(a),Math.abs(u))&&Math.abs(r-h)<=S.EPSILON*Math.max(1,Math.abs(r),Math.abs(h))&&Math.abs(o-d)<=S.EPSILON*Math.max(1,Math.abs(o),Math.abs(d))&&Math.abs(s-p)<=S.EPSILON*Math.max(1,Math.abs(s),Math.abs(p))},E.sub=E.mul=void 0;var S=function(t,e){if(t&&t.__esModule)return t;if(null===t||"object"!==T(t)&&"function"!=typeof t)return{default:t};var n=M(void 0);if(n&&n.has(t))return n.get(t);var i={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in t)if("default"!==r&&Object.prototype.hasOwnProperty.call(t,r)){var o=a?Object.getOwnPropertyDescriptor(t,r):null;o&&(o.get||o.set)?Object.defineProperty(i,r,o):i[r]=t[r]}return i.default=t,n&&n.set(t,i),i}(f);function M(t){if("function"!=typeof WeakMap)return null;var e=new WeakMap,n=new WeakMap;return(M=function(t){return t?n:e})(t)}function k(t,e,n){var i=e[0],a=e[1],r=e[2],o=e[3],s=e[4],l=e[5],c=n[0],u=n[1],h=n[2],d=n[3],p=n[4],f=n[5];return t[0]=i*c+r*u,t[1]=a*c+o*u,t[2]=i*h+r*d,t[3]=a*h+o*d,t[4]=i*p+r*f+s,t[5]=a*p+o*f+l,t}function I(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t}E.mul=k,E.sub=I;var P={};function z(t){return z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},z(t)}Object.defineProperty(P,"__esModule",{value:!0}),P.create=function(){var t=new D.ARRAY_TYPE(9);return D.ARRAY_TYPE!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t},P.fromMat4=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t},P.clone=function(t){var e=new D.ARRAY_TYPE(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},P.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},P.fromValues=function(t,e,n,i,a,r,o,s,l){var c=new D.ARRAY_TYPE(9);return c[0]=t,c[1]=e,c[2]=n,c[3]=i,c[4]=a,c[5]=r,c[6]=o,c[7]=s,c[8]=l,c},P.set=function(t,e,n,i,a,r,o,s,l,c){return t[0]=e,t[1]=n,t[2]=i,t[3]=a,t[4]=r,t[5]=o,t[6]=s,t[7]=l,t[8]=c,t},P.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},P.transpose=function(t,e){if(t===e){var n=e[1],i=e[2],a=e[5];t[1]=e[3],t[2]=e[6],t[3]=n,t[5]=e[7],t[6]=i,t[7]=a}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t},P.invert=function(t,e){var n=e[0],i=e[1],a=e[2],r=e[3],o=e[4],s=e[5],l=e[6],c=e[7],u=e[8],h=u*o-s*c,d=-u*r+s*l,p=c*r-o*l,f=n*h+i*d+a*p;return f?(t[0]=h*(f=1/f),t[1]=(-u*i+a*c)*f,t[2]=(s*i-a*o)*f,t[3]=d*f,t[4]=(u*n-a*l)*f,t[5]=(-s*n+a*r)*f,t[6]=p*f,t[7]=(-c*n+i*l)*f,t[8]=(o*n-i*r)*f,t):null},P.adjoint=function(t,e){var n=e[0],i=e[1],a=e[2],r=e[3],o=e[4],s=e[5],l=e[6],c=e[7],u=e[8];return t[0]=o*u-s*c,t[1]=a*c-i*u,t[2]=i*s-a*o,t[3]=s*l-r*u,t[4]=n*u-a*l,t[5]=a*r-n*s,t[6]=r*c-o*l,t[7]=i*l-n*c,t[8]=n*o-i*r,t},P.determinant=function(t){var e=t[3],n=t[4],i=t[5],a=t[6],r=t[7],o=t[8];return t[0]*(o*n-i*r)+t[1]*(-o*e+i*a)+t[2]*(r*e-n*a)},P.multiply=B,P.translate=function(t,e,n){var i=e[0],a=e[1],r=e[2],o=e[3],s=e[4],l=e[5],c=e[6],u=e[7],h=e[8],d=n[0],p=n[1];return t[0]=i,t[1]=a,t[2]=r,t[3]=o,t[4]=s,t[5]=l,t[6]=d*i+p*o+c,t[7]=d*a+p*s+u,t[8]=d*r+p*l+h,t},P.rotate=function(t,e,n){var i=e[0],a=e[1],r=e[2],o=e[3],s=e[4],l=e[5],c=e[6],u=e[7],h=e[8],d=Math.sin(n),p=Math.cos(n);return t[0]=p*i+d*o,t[1]=p*a+d*s,t[2]=p*r+d*l,t[3]=p*o-d*i,t[4]=p*s-d*a,t[5]=p*l-d*r,t[6]=c,t[7]=u,t[8]=h,t},P.scale=function(t,e,n){var i=n[0],a=n[1];return t[0]=i*e[0],t[1]=i*e[1],t[2]=i*e[2],t[3]=a*e[3],t[4]=a*e[4],t[5]=a*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},P.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t},P.fromRotation=function(t,e){var n=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=n,t[2]=0,t[3]=-n,t[4]=i,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},P.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},P.fromMat2d=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t},P.fromQuat=function(t,e){var n=e[0],i=e[1],a=e[2],r=e[3],o=n+n,s=i+i,l=a+a,c=n*o,u=i*o,h=i*s,d=a*o,p=a*s,f=a*l,m=r*o,g=r*s,_=r*l;return t[0]=1-h-f,t[3]=u-_,t[6]=d+g,t[1]=u+_,t[4]=1-c-f,t[7]=p-m,t[2]=d-g,t[5]=p+m,t[8]=1-c-h,t},P.normalFromMat4=function(t,e){var n=e[0],i=e[1],a=e[2],r=e[3],o=e[4],s=e[5],l=e[6],c=e[7],u=e[8],h=e[9],d=e[10],p=e[11],f=e[12],m=e[13],g=e[14],_=e[15],y=n*s-i*o,x=n*l-a*o,v=n*c-r*o,b=i*l-a*s,w=i*c-r*s,A=a*c-r*l,C=u*m-h*f,E=u*g-d*f,T=u*_-p*f,S=h*g-d*m,M=h*_-p*m,k=d*_-p*g,I=y*k-x*M+v*S+b*T-w*E+A*C;return I?(t[0]=(s*k-l*M+c*S)*(I=1/I),t[1]=(l*T-o*k-c*E)*I,t[2]=(o*M-s*T+c*C)*I,t[3]=(a*M-i*k-r*S)*I,t[4]=(n*k-a*T+r*E)*I,t[5]=(i*T-n*M-r*C)*I,t[6]=(m*A-g*w+_*b)*I,t[7]=(g*v-f*A-_*x)*I,t[8]=(f*w-m*v+_*y)*I,t):null},P.projection=function(t,e,n){return t[0]=2/e,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/n,t[5]=0,t[6]=-1,t[7]=1,t[8]=1,t},P.str=function(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"},P.frob=function(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8])},P.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t},P.subtract=O,P.multiplyScalar=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t},P.multiplyScalarAndAdd=function(t,e,n,i){return t[0]=e[0]+n[0]*i,t[1]=e[1]+n[1]*i,t[2]=e[2]+n[2]*i,t[3]=e[3]+n[3]*i,t[4]=e[4]+n[4]*i,t[5]=e[5]+n[5]*i,t[6]=e[6]+n[6]*i,t[7]=e[7]+n[7]*i,t[8]=e[8]+n[8]*i,t},P.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]},P.equals=function(t,e){var n=t[0],i=t[1],a=t[2],r=t[3],o=t[4],s=t[5],l=t[6],c=t[7],u=t[8],h=e[0],d=e[1],p=e[2],f=e[3],m=e[4],g=e[5],_=e[6],y=e[7],x=e[8];return Math.abs(n-h)<=D.EPSILON*Math.max(1,Math.abs(n),Math.abs(h))&&Math.abs(i-d)<=D.EPSILON*Math.max(1,Math.abs(i),Math.abs(d))&&Math.abs(a-p)<=D.EPSILON*Math.max(1,Math.abs(a),Math.abs(p))&&Math.abs(r-f)<=D.EPSILON*Math.max(1,Math.abs(r),Math.abs(f))&&Math.abs(o-m)<=D.EPSILON*Math.max(1,Math.abs(o),Math.abs(m))&&Math.abs(s-g)<=D.EPSILON*Math.max(1,Math.abs(s),Math.abs(g))&&Math.abs(l-_)<=D.EPSILON*Math.max(1,Math.abs(l),Math.abs(_))&&Math.abs(c-y)<=D.EPSILON*Math.max(1,Math.abs(c),Math.abs(y))&&Math.abs(u-x)<=D.EPSILON*Math.max(1,Math.abs(u),Math.abs(x))},P.sub=P.mul=void 0;var D=function(t,e){if(t&&t.__esModule)return t;if(null===t||"object"!==z(t)&&"function"!=typeof t)return{default:t};var n=L(void 0);if(n&&n.has(t))return n.get(t);var i={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in t)if("default"!==r&&Object.prototype.hasOwnProperty.call(t,r)){var o=a?Object.getOwnPropertyDescriptor(t,r):null;o&&(o.get||o.set)?Object.defineProperty(i,r,o):i[r]=t[r]}return i.default=t,n&&n.set(t,i),i}(f);function L(t){if("function"!=typeof WeakMap)return null;var e=new WeakMap,n=new WeakMap;return(L=function(t){return t?n:e})(t)}function B(t,e,n){var i=e[0],a=e[1],r=e[2],o=e[3],s=e[4],l=e[5],c=e[6],u=e[7],h=e[8],d=n[0],p=n[1],f=n[2],m=n[3],g=n[4],_=n[5],y=n[6],x=n[7],v=n[8];return t[0]=d*i+p*o+f*c,t[1]=d*a+p*s+f*u,t[2]=d*r+p*l+f*h,t[3]=m*i+g*o+_*c,t[4]=m*a+g*s+_*u,t[5]=m*r+g*l+_*h,t[6]=y*i+x*o+v*c,t[7]=y*a+x*s+v*u,t[8]=y*r+x*l+v*h,t}function O(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t}P.mul=B,P.sub=O;var R={};function F(t){return F="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},F(t)}Object.defineProperty(R,"__esModule",{value:!0}),R.create=function(){var t=new N.ARRAY_TYPE(16);return N.ARRAY_TYPE!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t},R.clone=function(t){var e=new N.ARRAY_TYPE(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},R.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},R.fromValues=function(t,e,n,i,a,r,o,s,l,c,u,h,d,p,f,m){var g=new N.ARRAY_TYPE(16);return g[0]=t,g[1]=e,g[2]=n,g[3]=i,g[4]=a,g[5]=r,g[6]=o,g[7]=s,g[8]=l,g[9]=c,g[10]=u,g[11]=h,g[12]=d,g[13]=p,g[14]=f,g[15]=m,g},R.set=function(t,e,n,i,a,r,o,s,l,c,u,h,d,p,f,m,g){return t[0]=e,t[1]=n,t[2]=i,t[3]=a,t[4]=r,t[5]=o,t[6]=s,t[7]=l,t[8]=c,t[9]=u,t[10]=h,t[11]=d,t[12]=p,t[13]=f,t[14]=m,t[15]=g,t},R.identity=V,R.transpose=function(t,e){if(t===e){var n=e[1],i=e[2],a=e[3],r=e[6],o=e[7],s=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=i,t[9]=r,t[11]=e[14],t[12]=a,t[13]=o,t[14]=s}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t},R.invert=function(t,e){var n=e[0],i=e[1],a=e[2],r=e[3],o=e[4],s=e[5],l=e[6],c=e[7],u=e[8],h=e[9],d=e[10],p=e[11],f=e[12],m=e[13],g=e[14],_=e[15],y=n*s-i*o,x=n*l-a*o,v=n*c-r*o,b=i*l-a*s,w=i*c-r*s,A=a*c-r*l,C=u*m-h*f,E=u*g-d*f,T=u*_-p*f,S=h*g-d*m,M=h*_-p*m,k=d*_-p*g,I=y*k-x*M+v*S+b*T-w*E+A*C;return I?(t[0]=(s*k-l*M+c*S)*(I=1/I),t[1]=(a*M-i*k-r*S)*I,t[2]=(m*A-g*w+_*b)*I,t[3]=(d*w-h*A-p*b)*I,t[4]=(l*T-o*k-c*E)*I,t[5]=(n*k-a*T+r*E)*I,t[6]=(g*v-f*A-_*x)*I,t[7]=(u*A-d*v+p*x)*I,t[8]=(o*M-s*T+c*C)*I,t[9]=(i*T-n*M-r*C)*I,t[10]=(f*w-m*v+_*y)*I,t[11]=(h*v-u*w-p*y)*I,t[12]=(s*E-o*S-l*C)*I,t[13]=(n*S-i*E+a*C)*I,t[14]=(m*x-f*b-g*y)*I,t[15]=(u*b-h*x+d*y)*I,t):null},R.adjoint=function(t,e){var n=e[0],i=e[1],a=e[2],r=e[3],o=e[4],s=e[5],l=e[6],c=e[7],u=e[8],h=e[9],d=e[10],p=e[11],f=e[12],m=e[13],g=e[14],_=e[15];return t[0]=s*(d*_-p*g)-h*(l*_-c*g)+m*(l*p-c*d),t[1]=-(i*(d*_-p*g)-h*(a*_-r*g)+m*(a*p-r*d)),t[2]=i*(l*_-c*g)-s*(a*_-r*g)+m*(a*c-r*l),t[3]=-(i*(l*p-c*d)-s*(a*p-r*d)+h*(a*c-r*l)),t[4]=-(o*(d*_-p*g)-u*(l*_-c*g)+f*(l*p-c*d)),t[5]=n*(d*_-p*g)-u*(a*_-r*g)+f*(a*p-r*d),t[6]=-(n*(l*_-c*g)-o*(a*_-r*g)+f*(a*c-r*l)),t[7]=n*(l*p-c*d)-o*(a*p-r*d)+u*(a*c-r*l),t[8]=o*(h*_-p*m)-u*(s*_-c*m)+f*(s*p-c*h),t[9]=-(n*(h*_-p*m)-u*(i*_-r*m)+f*(i*p-r*h)),t[10]=n*(s*_-c*m)-o*(i*_-r*m)+f*(i*c-r*s),t[11]=-(n*(s*p-c*h)-o*(i*p-r*h)+u*(i*c-r*s)),t[12]=-(o*(h*g-d*m)-u*(s*g-l*m)+f*(s*d-l*h)),t[13]=n*(h*g-d*m)-u*(i*g-a*m)+f*(i*d-a*h),t[14]=-(n*(s*g-l*m)-o*(i*g-a*m)+f*(i*l-a*s)),t[15]=n*(s*d-l*h)-o*(i*d-a*h)+u*(i*l-a*s),t},R.determinant=function(t){var e=t[0],n=t[1],i=t[2],a=t[3],r=t[4],o=t[5],s=t[6],l=t[7],c=t[8],u=t[9],h=t[10],d=t[11],p=t[12],f=t[13],m=t[14],g=t[15];return(e*o-n*r)*(h*g-d*m)-(e*s-i*r)*(u*g-d*f)+(e*l-a*r)*(u*m-h*f)+(n*s-i*o)*(c*g-d*p)-(n*l-a*o)*(c*m-h*p)+(i*l-a*s)*(c*f-u*p)},R.multiply=U,R.translate=function(t,e,n){var i,a,r,o,s,l,c,u,h,d,p,f,m=n[0],g=n[1],_=n[2];return e===t?(t[12]=e[0]*m+e[4]*g+e[8]*_+e[12],t[13]=e[1]*m+e[5]*g+e[9]*_+e[13],t[14]=e[2]*m+e[6]*g+e[10]*_+e[14],t[15]=e[3]*m+e[7]*g+e[11]*_+e[15]):(a=e[1],r=e[2],o=e[3],s=e[4],l=e[5],c=e[6],u=e[7],h=e[8],d=e[9],p=e[10],f=e[11],t[0]=i=e[0],t[1]=a,t[2]=r,t[3]=o,t[4]=s,t[5]=l,t[6]=c,t[7]=u,t[8]=h,t[9]=d,t[10]=p,t[11]=f,t[12]=i*m+s*g+h*_+e[12],t[13]=a*m+l*g+d*_+e[13],t[14]=r*m+c*g+p*_+e[14],t[15]=o*m+u*g+f*_+e[15]),t},R.scale=function(t,e,n){var i=n[0],a=n[1],r=n[2];return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*a,t[5]=e[5]*a,t[6]=e[6]*a,t[7]=e[7]*a,t[8]=e[8]*r,t[9]=e[9]*r,t[10]=e[10]*r,t[11]=e[11]*r,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},R.rotate=function(t,e,n,i){var a,r,o,s,l,c,u,h,d,p,f,m,g,_,y,x,v,b,w,A,C,E,T,S,M=i[0],k=i[1],I=i[2],P=Math.hypot(M,k,I);return P<N.EPSILON?null:(M*=P=1/P,k*=P,I*=P,a=Math.sin(n),r=Math.cos(n),l=e[1],c=e[2],u=e[3],d=e[5],p=e[6],f=e[7],g=e[9],_=e[10],y=e[11],x=M*M*(o=1-r)+r,w=M*k*o-I*a,A=k*k*o+r,C=I*k*o+M*a,E=M*I*o+k*a,T=k*I*o-M*a,S=I*I*o+r,t[0]=(s=e[0])*x+(h=e[4])*(v=k*M*o+I*a)+(m=e[8])*(b=I*M*o-k*a),t[1]=l*x+d*v+g*b,t[2]=c*x+p*v+_*b,t[3]=u*x+f*v+y*b,t[4]=s*w+h*A+m*C,t[5]=l*w+d*A+g*C,t[6]=c*w+p*A+_*C,t[7]=u*w+f*A+y*C,t[8]=s*E+h*T+m*S,t[9]=l*E+d*T+g*S,t[10]=c*E+p*T+_*S,t[11]=u*E+f*T+y*S,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)},R.rotateX=function(t,e,n){var i=Math.sin(n),a=Math.cos(n),r=e[4],o=e[5],s=e[6],l=e[7],c=e[8],u=e[9],h=e[10],d=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=r*a+c*i,t[5]=o*a+u*i,t[6]=s*a+h*i,t[7]=l*a+d*i,t[8]=c*a-r*i,t[9]=u*a-o*i,t[10]=h*a-s*i,t[11]=d*a-l*i,t},R.rotateY=function(t,e,n){var i=Math.sin(n),a=Math.cos(n),r=e[0],o=e[1],s=e[2],l=e[3],c=e[8],u=e[9],h=e[10],d=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=r*a-c*i,t[1]=o*a-u*i,t[2]=s*a-h*i,t[3]=l*a-d*i,t[8]=r*i+c*a,t[9]=o*i+u*a,t[10]=s*i+h*a,t[11]=l*i+d*a,t},R.rotateZ=function(t,e,n){var i=Math.sin(n),a=Math.cos(n),r=e[0],o=e[1],s=e[2],l=e[3],c=e[4],u=e[5],h=e[6],d=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=r*a+c*i,t[1]=o*a+u*i,t[2]=s*a+h*i,t[3]=l*a+d*i,t[4]=c*a-r*i,t[5]=u*a-o*i,t[6]=h*a-s*i,t[7]=d*a-l*i,t},R.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t},R.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},R.fromRotation=function(t,e,n){var i,a,r,o=n[0],s=n[1],l=n[2],c=Math.hypot(o,s,l);return c<N.EPSILON?null:(o*=c=1/c,s*=c,l*=c,i=Math.sin(e),a=Math.cos(e),t[0]=o*o*(r=1-a)+a,t[1]=s*o*r+l*i,t[2]=l*o*r-s*i,t[3]=0,t[4]=o*s*r-l*i,t[5]=s*s*r+a,t[6]=l*s*r+o*i,t[7]=0,t[8]=o*l*r+s*i,t[9]=s*l*r-o*i,t[10]=l*l*r+a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)},R.fromXRotation=function(t,e){var n=Math.sin(e),i=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=i,t[6]=n,t[7]=0,t[8]=0,t[9]=-n,t[10]=i,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},R.fromYRotation=function(t,e){var n=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=0,t[2]=-n,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=n,t[9]=0,t[10]=i,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},R.fromZRotation=function(t,e){var n=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=n,t[2]=0,t[3]=0,t[4]=-n,t[5]=i,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},R.fromRotationTranslation=G,R.fromQuat2=function(t,e){var n=new N.ARRAY_TYPE(3),i=-e[0],a=-e[1],r=-e[2],o=e[3],s=e[4],l=e[5],c=e[6],u=e[7],h=i*i+a*a+r*r+o*o;return h>0?(n[0]=2*(s*o+u*i+l*r-c*a)/h,n[1]=2*(l*o+u*a+c*i-s*r)/h,n[2]=2*(c*o+u*r+s*a-l*i)/h):(n[0]=2*(s*o+u*i+l*r-c*a),n[1]=2*(l*o+u*a+c*i-s*r),n[2]=2*(c*o+u*r+s*a-l*i)),G(t,e,n),t},R.getTranslation=function(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t},R.getScaling=q,R.getRotation=function(t,e){var n=new N.ARRAY_TYPE(3);q(n,e);var i=1/n[0],a=1/n[1],r=1/n[2],o=e[0]*i,s=e[1]*a,l=e[2]*r,c=e[4]*i,u=e[5]*a,h=e[6]*r,d=e[8]*i,p=e[9]*a,f=e[10]*r,m=o+u+f,g=0;return m>0?(g=2*Math.sqrt(m+1),t[3]=.25*g,t[0]=(h-p)/g,t[1]=(d-l)/g,t[2]=(s-c)/g):o>u&&o>f?(g=2*Math.sqrt(1+o-u-f),t[3]=(h-p)/g,t[0]=.25*g,t[1]=(s+c)/g,t[2]=(d+l)/g):u>f?(g=2*Math.sqrt(1+u-o-f),t[3]=(d-l)/g,t[0]=(s+c)/g,t[1]=.25*g,t[2]=(h+p)/g):(g=2*Math.sqrt(1+f-o-u),t[3]=(s-c)/g,t[0]=(d+l)/g,t[1]=(h+p)/g,t[2]=.25*g),t},R.fromRotationTranslationScale=function(t,e,n,i){var a=e[0],r=e[1],o=e[2],s=e[3],l=a+a,c=r+r,u=o+o,h=a*l,d=a*c,p=a*u,f=r*c,m=r*u,g=o*u,_=s*l,y=s*c,x=s*u,v=i[0],b=i[1],w=i[2];return t[0]=(1-(f+g))*v,t[1]=(d+x)*v,t[2]=(p-y)*v,t[3]=0,t[4]=(d-x)*b,t[5]=(1-(h+g))*b,t[6]=(m+_)*b,t[7]=0,t[8]=(p+y)*w,t[9]=(m-_)*w,t[10]=(1-(h+f))*w,t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t},R.fromRotationTranslationScaleOrigin=function(t,e,n,i,a){var r=e[0],o=e[1],s=e[2],l=e[3],c=r+r,u=o+o,h=s+s,d=r*c,p=r*u,f=r*h,m=o*u,g=o*h,_=s*h,y=l*c,x=l*u,v=l*h,b=i[0],w=i[1],A=i[2],C=a[0],E=a[1],T=a[2],S=(1-(m+_))*b,M=(p+v)*b,k=(f-x)*b,I=(p-v)*w,P=(1-(d+_))*w,z=(g+y)*w,D=(f+x)*A,L=(g-y)*A,B=(1-(d+m))*A;return t[0]=S,t[1]=M,t[2]=k,t[3]=0,t[4]=I,t[5]=P,t[6]=z,t[7]=0,t[8]=D,t[9]=L,t[10]=B,t[11]=0,t[12]=n[0]+C-(S*C+I*E+D*T),t[13]=n[1]+E-(M*C+P*E+L*T),t[14]=n[2]+T-(k*C+z*E+B*T),t[15]=1,t},R.fromQuat=function(t,e){var n=e[0],i=e[1],a=e[2],r=e[3],o=n+n,s=i+i,l=a+a,c=n*o,u=i*o,h=i*s,d=a*o,p=a*s,f=a*l,m=r*o,g=r*s,_=r*l;return t[0]=1-h-f,t[1]=u+_,t[2]=d-g,t[3]=0,t[4]=u-_,t[5]=1-c-f,t[6]=p+m,t[7]=0,t[8]=d+g,t[9]=p-m,t[10]=1-c-h,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},R.frustum=function(t,e,n,i,a,r,o){var s=1/(n-e),l=1/(a-i),c=1/(r-o);return t[0]=2*r*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*r*l,t[6]=0,t[7]=0,t[8]=(n+e)*s,t[9]=(a+i)*l,t[10]=(o+r)*c,t[11]=-1,t[12]=0,t[13]=0,t[14]=o*r*2*c,t[15]=0,t},R.perspectiveNO=$,R.perspectiveZO=function(t,e,n,i,a){var r,o=1/Math.tan(e/2);return t[0]=o/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=a&&a!==1/0?(t[10]=a*(r=1/(i-a)),t[14]=a*i*r):(t[10]=-1,t[14]=-i),t},R.perspectiveFromFieldOfView=function(t,e,n,i){var a=Math.tan(e.upDegrees*Math.PI/180),r=Math.tan(e.downDegrees*Math.PI/180),o=Math.tan(e.leftDegrees*Math.PI/180),s=Math.tan(e.rightDegrees*Math.PI/180),l=2/(o+s),c=2/(a+r);return t[0]=l,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=c,t[6]=0,t[7]=0,t[8]=-(o-s)*l*.5,t[9]=(a-r)*c*.5,t[10]=i/(n-i),t[11]=-1,t[12]=0,t[13]=0,t[14]=i*n/(n-i),t[15]=0,t},R.orthoNO=W,R.orthoZO=function(t,e,n,i,a,r,o){var s=1/(e-n),l=1/(i-a),c=1/(r-o);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=c,t[11]=0,t[12]=(e+n)*s,t[13]=(a+i)*l,t[14]=r*c,t[15]=1,t},R.lookAt=function(t,e,n,i){var a,r,o,s,l,c,u,h,d,p,f=e[0],m=e[1],g=e[2],_=i[0],y=i[1],x=i[2],v=n[0],b=n[1],w=n[2];return Math.abs(f-v)<N.EPSILON&&Math.abs(m-b)<N.EPSILON&&Math.abs(g-w)<N.EPSILON?V(t):(u=f-v,h=m-b,d=g-w,a=y*(d*=p=1/Math.hypot(u,h,d))-x*(h*=p),r=x*(u*=p)-_*d,o=_*h-y*u,(p=Math.hypot(a,r,o))?(a*=p=1/p,r*=p,o*=p):(a=0,r=0,o=0),s=h*o-d*r,l=d*a-u*o,c=u*r-h*a,(p=Math.hypot(s,l,c))?(s*=p=1/p,l*=p,c*=p):(s=0,l=0,c=0),t[0]=a,t[1]=s,t[2]=u,t[3]=0,t[4]=r,t[5]=l,t[6]=h,t[7]=0,t[8]=o,t[9]=c,t[10]=d,t[11]=0,t[12]=-(a*f+r*m+o*g),t[13]=-(s*f+l*m+c*g),t[14]=-(u*f+h*m+d*g),t[15]=1,t)},R.targetTo=function(t,e,n,i){var a=e[0],r=e[1],o=e[2],s=i[0],l=i[1],c=i[2],u=a-n[0],h=r-n[1],d=o-n[2],p=u*u+h*h+d*d;p>0&&(u*=p=1/Math.sqrt(p),h*=p,d*=p);var f=l*d-c*h,m=c*u-s*d,g=s*h-l*u;return(p=f*f+m*m+g*g)>0&&(f*=p=1/Math.sqrt(p),m*=p,g*=p),t[0]=f,t[1]=m,t[2]=g,t[3]=0,t[4]=h*g-d*m,t[5]=d*f-u*g,t[6]=u*m-h*f,t[7]=0,t[8]=u,t[9]=h,t[10]=d,t[11]=0,t[12]=a,t[13]=r,t[14]=o,t[15]=1,t},R.str=function(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"},R.frob=function(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15])},R.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t[9]=e[9]+n[9],t[10]=e[10]+n[10],t[11]=e[11]+n[11],t[12]=e[12]+n[12],t[13]=e[13]+n[13],t[14]=e[14]+n[14],t[15]=e[15]+n[15],t},R.subtract=H,R.multiplyScalar=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t[9]=e[9]*n,t[10]=e[10]*n,t[11]=e[11]*n,t[12]=e[12]*n,t[13]=e[13]*n,t[14]=e[14]*n,t[15]=e[15]*n,t},R.multiplyScalarAndAdd=function(t,e,n,i){return t[0]=e[0]+n[0]*i,t[1]=e[1]+n[1]*i,t[2]=e[2]+n[2]*i,t[3]=e[3]+n[3]*i,t[4]=e[4]+n[4]*i,t[5]=e[5]+n[5]*i,t[6]=e[6]+n[6]*i,t[7]=e[7]+n[7]*i,t[8]=e[8]+n[8]*i,t[9]=e[9]+n[9]*i,t[10]=e[10]+n[10]*i,t[11]=e[11]+n[11]*i,t[12]=e[12]+n[12]*i,t[13]=e[13]+n[13]*i,t[14]=e[14]+n[14]*i,t[15]=e[15]+n[15]*i,t},R.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]},R.equals=function(t,e){var n=t[0],i=t[1],a=t[2],r=t[3],o=t[4],s=t[5],l=t[6],c=t[7],u=t[8],h=t[9],d=t[10],p=t[11],f=t[12],m=t[13],g=t[14],_=t[15],y=e[0],x=e[1],v=e[2],b=e[3],w=e[4],A=e[5],C=e[6],E=e[7],T=e[8],S=e[9],M=e[10],k=e[11],I=e[12],P=e[13],z=e[14],D=e[15];return Math.abs(n-y)<=N.EPSILON*Math.max(1,Math.abs(n),Math.abs(y))&&Math.abs(i-x)<=N.EPSILON*Math.max(1,Math.abs(i),Math.abs(x))&&Math.abs(a-v)<=N.EPSILON*Math.max(1,Math.abs(a),Math.abs(v))&&Math.abs(r-b)<=N.EPSILON*Math.max(1,Math.abs(r),Math.abs(b))&&Math.abs(o-w)<=N.EPSILON*Math.max(1,Math.abs(o),Math.abs(w))&&Math.abs(s-A)<=N.EPSILON*Math.max(1,Math.abs(s),Math.abs(A))&&Math.abs(l-C)<=N.EPSILON*Math.max(1,Math.abs(l),Math.abs(C))&&Math.abs(c-E)<=N.EPSILON*Math.max(1,Math.abs(c),Math.abs(E))&&Math.abs(u-T)<=N.EPSILON*Math.max(1,Math.abs(u),Math.abs(T))&&Math.abs(h-S)<=N.EPSILON*Math.max(1,Math.abs(h),Math.abs(S))&&Math.abs(d-M)<=N.EPSILON*Math.max(1,Math.abs(d),Math.abs(M))&&Math.abs(p-k)<=N.EPSILON*Math.max(1,Math.abs(p),Math.abs(k))&&Math.abs(f-I)<=N.EPSILON*Math.max(1,Math.abs(f),Math.abs(I))&&Math.abs(m-P)<=N.EPSILON*Math.max(1,Math.abs(m),Math.abs(P))&&Math.abs(g-z)<=N.EPSILON*Math.max(1,Math.abs(g),Math.abs(z))&&Math.abs(_-D)<=N.EPSILON*Math.max(1,Math.abs(_),Math.abs(D))},R.sub=R.mul=R.ortho=R.perspective=void 0;var N=function(t,e){if(t&&t.__esModule)return t;if(null===t||"object"!==F(t)&&"function"!=typeof t)return{default:t};var n=j(void 0);if(n&&n.has(t))return n.get(t);var i={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in t)if("default"!==r&&Object.prototype.hasOwnProperty.call(t,r)){var o=a?Object.getOwnPropertyDescriptor(t,r):null;o&&(o.get||o.set)?Object.defineProperty(i,r,o):i[r]=t[r]}return i.default=t,n&&n.set(t,i),i}(f);function j(t){if("function"!=typeof WeakMap)return null;var e=new WeakMap,n=new WeakMap;return(j=function(t){return t?n:e})(t)}function V(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function U(t,e,n){var i=e[0],a=e[1],r=e[2],o=e[3],s=e[4],l=e[5],c=e[6],u=e[7],h=e[8],d=e[9],p=e[10],f=e[11],m=e[12],g=e[13],_=e[14],y=e[15],x=n[0],v=n[1],b=n[2],w=n[3];return t[0]=x*i+v*s+b*h+w*m,t[1]=x*a+v*l+b*d+w*g,t[2]=x*r+v*c+b*p+w*_,t[3]=x*o+v*u+b*f+w*y,t[4]=(x=n[4])*i+(v=n[5])*s+(b=n[6])*h+(w=n[7])*m,t[5]=x*a+v*l+b*d+w*g,t[6]=x*r+v*c+b*p+w*_,t[7]=x*o+v*u+b*f+w*y,t[8]=(x=n[8])*i+(v=n[9])*s+(b=n[10])*h+(w=n[11])*m,t[9]=x*a+v*l+b*d+w*g,t[10]=x*r+v*c+b*p+w*_,t[11]=x*o+v*u+b*f+w*y,t[12]=(x=n[12])*i+(v=n[13])*s+(b=n[14])*h+(w=n[15])*m,t[13]=x*a+v*l+b*d+w*g,t[14]=x*r+v*c+b*p+w*_,t[15]=x*o+v*u+b*f+w*y,t}function G(t,e,n){var i=e[0],a=e[1],r=e[2],o=e[3],s=i+i,l=a+a,c=r+r,u=i*s,h=i*l,d=i*c,p=a*l,f=a*c,m=r*c,g=o*s,_=o*l,y=o*c;return t[0]=1-(p+m),t[1]=h+y,t[2]=d-_,t[3]=0,t[4]=h-y,t[5]=1-(u+m),t[6]=f+g,t[7]=0,t[8]=d+_,t[9]=f-g,t[10]=1-(u+p),t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function q(t,e){var n=e[4],i=e[5],a=e[6],r=e[8],o=e[9],s=e[10];return t[0]=Math.hypot(e[0],e[1],e[2]),t[1]=Math.hypot(n,i,a),t[2]=Math.hypot(r,o,s),t}function $(t,e,n,i,a){var r,o=1/Math.tan(e/2);return t[0]=o/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=a&&a!==1/0?(t[10]=(a+i)*(r=1/(i-a)),t[14]=2*a*i*r):(t[10]=-1,t[14]=-2*i),t}function W(t,e,n,i,a,r,o){var s=1/(e-n),l=1/(i-a),c=1/(r-o);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(e+n)*s,t[13]=(a+i)*l,t[14]=(o+r)*c,t[15]=1,t}function H(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t[9]=e[9]-n[9],t[10]=e[10]-n[10],t[11]=e[11]-n[11],t[12]=e[12]-n[12],t[13]=e[13]-n[13],t[14]=e[14]-n[14],t[15]=e[15]-n[15],t}R.perspective=$,R.ortho=W,R.mul=U,R.sub=H;var Z={},Y={};function X(t){return X="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},X(t)}Object.defineProperty(Y,"__esModule",{value:!0}),Y.create=J,Y.clone=function(t){var e=new K.ARRAY_TYPE(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},Y.length=tt,Y.fromValues=function(t,e,n){var i=new K.ARRAY_TYPE(3);return i[0]=t,i[1]=e,i[2]=n,i},Y.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},Y.set=function(t,e,n,i){return t[0]=e,t[1]=n,t[2]=i,t},Y.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t},Y.subtract=et,Y.multiply=nt,Y.divide=it,Y.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t},Y.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t},Y.min=function(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t},Y.max=function(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t},Y.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t},Y.scale=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t},Y.scaleAndAdd=function(t,e,n,i){return t[0]=e[0]+n[0]*i,t[1]=e[1]+n[1]*i,t[2]=e[2]+n[2]*i,t},Y.distance=at,Y.squaredDistance=rt,Y.squaredLength=ot,Y.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t},Y.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t},Y.normalize=function(t,e){var n=e[0],i=e[1],a=e[2],r=n*n+i*i+a*a;return r>0&&(r=1/Math.sqrt(r)),t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t},Y.dot=st,Y.cross=function(t,e,n){var i=e[0],a=e[1],r=e[2],o=n[0],s=n[1],l=n[2];return t[0]=a*l-r*s,t[1]=r*o-i*l,t[2]=i*s-a*o,t},Y.lerp=function(t,e,n,i){var a=e[0],r=e[1],o=e[2];return t[0]=a+i*(n[0]-a),t[1]=r+i*(n[1]-r),t[2]=o+i*(n[2]-o),t},Y.hermite=function(t,e,n,i,a,r){var o=r*r,s=o*(2*r-3)+1,l=o*(r-2)+r,c=o*(r-1),u=o*(3-2*r);return t[0]=e[0]*s+n[0]*l+i[0]*c+a[0]*u,t[1]=e[1]*s+n[1]*l+i[1]*c+a[1]*u,t[2]=e[2]*s+n[2]*l+i[2]*c+a[2]*u,t},Y.bezier=function(t,e,n,i,a,r){var o=1-r,s=o*o,l=r*r,c=s*o,u=3*r*s,h=3*l*o,d=l*r;return t[0]=e[0]*c+n[0]*u+i[0]*h+a[0]*d,t[1]=e[1]*c+n[1]*u+i[1]*h+a[1]*d,t[2]=e[2]*c+n[2]*u+i[2]*h+a[2]*d,t},Y.random=function(t,e){e=e||1;var n=2*K.RANDOM()*Math.PI,i=2*K.RANDOM()-1,a=Math.sqrt(1-i*i)*e;return t[0]=Math.cos(n)*a,t[1]=Math.sin(n)*a,t[2]=i*e,t},Y.transformMat4=function(t,e,n){var i=e[0],a=e[1],r=e[2],o=n[3]*i+n[7]*a+n[11]*r+n[15];return t[0]=(n[0]*i+n[4]*a+n[8]*r+n[12])/(o=o||1),t[1]=(n[1]*i+n[5]*a+n[9]*r+n[13])/o,t[2]=(n[2]*i+n[6]*a+n[10]*r+n[14])/o,t},Y.transformMat3=function(t,e,n){var i=e[0],a=e[1],r=e[2];return t[0]=i*n[0]+a*n[3]+r*n[6],t[1]=i*n[1]+a*n[4]+r*n[7],t[2]=i*n[2]+a*n[5]+r*n[8],t},Y.transformQuat=function(t,e,n){var i=n[0],a=n[1],r=n[2],o=e[0],s=e[1],l=e[2],c=a*l-r*s,u=r*o-i*l,h=i*s-a*o,d=a*h-r*u,p=r*c-i*h,f=i*u-a*c,m=2*n[3];return u*=m,h*=m,p*=2,f*=2,t[0]=o+(c*=m)+(d*=2),t[1]=s+u+p,t[2]=l+h+f,t},Y.rotateX=function(t,e,n,i){var a=[],r=[];return a[0]=e[0]-n[0],a[1]=e[1]-n[1],a[2]=e[2]-n[2],r[0]=a[0],r[1]=a[1]*Math.cos(i)-a[2]*Math.sin(i),r[2]=a[1]*Math.sin(i)+a[2]*Math.cos(i),t[0]=r[0]+n[0],t[1]=r[1]+n[1],t[2]=r[2]+n[2],t},Y.rotateY=function(t,e,n,i){var a=[],r=[];return a[0]=e[0]-n[0],a[1]=e[1]-n[1],a[2]=e[2]-n[2],r[0]=a[2]*Math.sin(i)+a[0]*Math.cos(i),r[1]=a[1],r[2]=a[2]*Math.cos(i)-a[0]*Math.sin(i),t[0]=r[0]+n[0],t[1]=r[1]+n[1],t[2]=r[2]+n[2],t},Y.rotateZ=function(t,e,n,i){var a=[],r=[];return a[0]=e[0]-n[0],a[1]=e[1]-n[1],a[2]=e[2]-n[2],r[0]=a[0]*Math.cos(i)-a[1]*Math.sin(i),r[1]=a[0]*Math.sin(i)+a[1]*Math.cos(i),r[2]=a[2],t[0]=r[0]+n[0],t[1]=r[1]+n[1],t[2]=r[2]+n[2],t},Y.angle=function(t,e){var n=t[0],i=t[1],a=t[2],r=e[0],o=e[1],s=e[2],l=Math.sqrt(n*n+i*i+a*a)*Math.sqrt(r*r+o*o+s*s),c=l&&st(t,e)/l;return Math.acos(Math.min(Math.max(c,-1),1))},Y.zero=function(t){return t[0]=0,t[1]=0,t[2]=0,t},Y.str=function(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"},Y.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]},Y.equals=function(t,e){var n=t[0],i=t[1],a=t[2],r=e[0],o=e[1],s=e[2];return Math.abs(n-r)<=K.EPSILON*Math.max(1,Math.abs(n),Math.abs(r))&&Math.abs(i-o)<=K.EPSILON*Math.max(1,Math.abs(i),Math.abs(o))&&Math.abs(a-s)<=K.EPSILON*Math.max(1,Math.abs(a),Math.abs(s))},Y.forEach=Y.sqrLen=Y.len=Y.sqrDist=Y.dist=Y.div=Y.mul=Y.sub=void 0;var K=function(t,e){if(t&&t.__esModule)return t;if(null===t||"object"!==X(t)&&"function"!=typeof t)return{default:t};var n=Q(void 0);if(n&&n.has(t))return n.get(t);var i={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in t)if("default"!==r&&Object.prototype.hasOwnProperty.call(t,r)){var o=a?Object.getOwnPropertyDescriptor(t,r):null;o&&(o.get||o.set)?Object.defineProperty(i,r,o):i[r]=t[r]}return i.default=t,n&&n.set(t,i),i}(f);function Q(t){if("function"!=typeof WeakMap)return null;var e=new WeakMap,n=new WeakMap;return(Q=function(t){return t?n:e})(t)}function J(){var t=new K.ARRAY_TYPE(3);return K.ARRAY_TYPE!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function tt(t){return Math.hypot(t[0],t[1],t[2])}function et(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function nt(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t}function it(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t}function at(t,e){return Math.hypot(e[0]-t[0],e[1]-t[1],e[2]-t[2])}function rt(t,e){var n=e[0]-t[0],i=e[1]-t[1],a=e[2]-t[2];return n*n+i*i+a*a}function ot(t){var e=t[0],n=t[1],i=t[2];return e*e+n*n+i*i}function st(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}Y.sub=et,Y.mul=nt,Y.div=it,Y.dist=at,Y.sqrDist=rt,Y.len=tt,Y.sqrLen=ot;var lt,ct=(lt=J(),function(t,e,n,i,a,r){var o,s;for(e||(e=3),n||(n=0),s=i?Math.min(i*e+n,t.length):t.length,o=n;o<s;o+=e)lt[0]=t[o],lt[1]=t[o+1],lt[2]=t[o+2],a(lt,lt,r),t[o]=lt[0],t[o+1]=lt[1],t[o+2]=lt[2];return t});Y.forEach=ct;var ut={};function ht(t){return ht="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ht(t)}Object.defineProperty(ut,"__esModule",{value:!0}),ut.create=ft,ut.clone=function(t){var e=new dt.ARRAY_TYPE(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},ut.fromValues=function(t,e,n,i){var a=new dt.ARRAY_TYPE(4);return a[0]=t,a[1]=e,a[2]=n,a[3]=i,a},ut.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},ut.set=function(t,e,n,i,a){return t[0]=e,t[1]=n,t[2]=i,t[3]=a,t},ut.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t},ut.subtract=mt,ut.multiply=gt,ut.divide=_t,ut.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t[3]=Math.ceil(e[3]),t},ut.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t[3]=Math.floor(e[3]),t},ut.min=function(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t[3]=Math.min(e[3],n[3]),t},ut.max=function(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t[3]=Math.max(e[3],n[3]),t},ut.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t[3]=Math.round(e[3]),t},ut.scale=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t},ut.scaleAndAdd=function(t,e,n,i){return t[0]=e[0]+n[0]*i,t[1]=e[1]+n[1]*i,t[2]=e[2]+n[2]*i,t[3]=e[3]+n[3]*i,t},ut.distance=yt,ut.squaredDistance=xt,ut.length=vt,ut.squaredLength=bt,ut.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t},ut.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t},ut.normalize=function(t,e){var n=e[0],i=e[1],a=e[2],r=e[3],o=n*n+i*i+a*a+r*r;return o>0&&(o=1/Math.sqrt(o)),t[0]=n*o,t[1]=i*o,t[2]=a*o,t[3]=r*o,t},ut.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]},ut.cross=function(t,e,n,i){var a=n[0]*i[1]-n[1]*i[0],r=n[0]*i[2]-n[2]*i[0],o=n[0]*i[3]-n[3]*i[0],s=n[1]*i[2]-n[2]*i[1],l=n[1]*i[3]-n[3]*i[1],c=n[2]*i[3]-n[3]*i[2],u=e[0],h=e[1],d=e[2],p=e[3];return t[0]=h*c-d*l+p*s,t[1]=-u*c+d*o-p*r,t[2]=u*l-h*o+p*a,t[3]=-u*s+h*r-d*a,t},ut.lerp=function(t,e,n,i){var a=e[0],r=e[1],o=e[2],s=e[3];return t[0]=a+i*(n[0]-a),t[1]=r+i*(n[1]-r),t[2]=o+i*(n[2]-o),t[3]=s+i*(n[3]-s),t},ut.random=function(t,e){var n,i,a,r,o,s;e=e||1;do{o=(n=2*dt.RANDOM()-1)*n+(i=2*dt.RANDOM()-1)*i}while(o>=1);do{s=(a=2*dt.RANDOM()-1)*a+(r=2*dt.RANDOM()-1)*r}while(s>=1);var l=Math.sqrt((1-o)/s);return t[0]=e*n,t[1]=e*i,t[2]=e*a*l,t[3]=e*r*l,t},ut.transformMat4=function(t,e,n){var i=e[0],a=e[1],r=e[2],o=e[3];return t[0]=n[0]*i+n[4]*a+n[8]*r+n[12]*o,t[1]=n[1]*i+n[5]*a+n[9]*r+n[13]*o,t[2]=n[2]*i+n[6]*a+n[10]*r+n[14]*o,t[3]=n[3]*i+n[7]*a+n[11]*r+n[15]*o,t},ut.transformQuat=function(t,e,n){var i=e[0],a=e[1],r=e[2],o=n[0],s=n[1],l=n[2],c=n[3],u=c*i+s*r-l*a,h=c*a+l*i-o*r,d=c*r+o*a-s*i,p=-o*i-s*a-l*r;return t[0]=u*c+p*-o+h*-l-d*-s,t[1]=h*c+p*-s+d*-o-u*-l,t[2]=d*c+p*-l+u*-s-h*-o,t[3]=e[3],t},ut.zero=function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t},ut.str=function(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},ut.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},ut.equals=function(t,e){var n=t[0],i=t[1],a=t[2],r=t[3],o=e[0],s=e[1],l=e[2],c=e[3];return Math.abs(n-o)<=dt.EPSILON*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(i-s)<=dt.EPSILON*Math.max(1,Math.abs(i),Math.abs(s))&&Math.abs(a-l)<=dt.EPSILON*Math.max(1,Math.abs(a),Math.abs(l))&&Math.abs(r-c)<=dt.EPSILON*Math.max(1,Math.abs(r),Math.abs(c))},ut.forEach=ut.sqrLen=ut.len=ut.sqrDist=ut.dist=ut.div=ut.mul=ut.sub=void 0;var dt=function(t,e){if(t&&t.__esModule)return t;if(null===t||"object"!==ht(t)&&"function"!=typeof t)return{default:t};var n=pt(void 0);if(n&&n.has(t))return n.get(t);var i={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in t)if("default"!==r&&Object.prototype.hasOwnProperty.call(t,r)){var o=a?Object.getOwnPropertyDescriptor(t,r):null;o&&(o.get||o.set)?Object.defineProperty(i,r,o):i[r]=t[r]}return i.default=t,n&&n.set(t,i),i}(f);function pt(t){if("function"!=typeof WeakMap)return null;var e=new WeakMap,n=new WeakMap;return(pt=function(t){return t?n:e})(t)}function ft(){var t=new dt.ARRAY_TYPE(4);return dt.ARRAY_TYPE!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function mt(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t}function gt(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t[3]=e[3]*n[3],t}function _t(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t[3]=e[3]/n[3],t}function yt(t,e){return Math.hypot(e[0]-t[0],e[1]-t[1],e[2]-t[2],e[3]-t[3])}function xt(t,e){var n=e[0]-t[0],i=e[1]-t[1],a=e[2]-t[2],r=e[3]-t[3];return n*n+i*i+a*a+r*r}function vt(t){return Math.hypot(t[0],t[1],t[2],t[3])}function bt(t){var e=t[0],n=t[1],i=t[2],a=t[3];return e*e+n*n+i*i+a*a}ut.sub=mt,ut.mul=gt,ut.div=_t,ut.dist=yt,ut.sqrDist=xt,ut.len=vt,ut.sqrLen=bt;var wt=function(){var t=ft();return function(e,n,i,a,r,o){var s,l;for(n||(n=4),i||(i=0),l=a?Math.min(a*n+i,e.length):e.length,s=i;s<l;s+=n)t[0]=e[s],t[1]=e[s+1],t[2]=e[s+2],t[3]=e[s+3],r(t,t,o),e[s]=t[0],e[s+1]=t[1],e[s+2]=t[2],e[s+3]=t[3];return e}}();function At(t){return At="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},At(t)}ut.forEach=wt,Object.defineProperty(Z,"__esModule",{value:!0}),Z.create=It,Z.identity=function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},Z.setAxisAngle=Pt,Z.getAxisAngle=function(t,e){var n=2*Math.acos(e[3]),i=Math.sin(n/2);return i>Ct.EPSILON?(t[0]=e[0]/i,t[1]=e[1]/i,t[2]=e[2]/i):(t[0]=1,t[1]=0,t[2]=0),n},Z.getAngle=function(t,e){var n=Ft(t,e);return Math.acos(2*n*n-1)},Z.multiply=zt,Z.rotateX=function(t,e,n){n*=.5;var i=e[0],a=e[1],r=e[2],o=e[3],s=Math.sin(n),l=Math.cos(n);return t[0]=i*l+o*s,t[1]=a*l+r*s,t[2]=r*l-a*s,t[3]=o*l-i*s,t},Z.rotateY=function(t,e,n){n*=.5;var i=e[0],a=e[1],r=e[2],o=e[3],s=Math.sin(n),l=Math.cos(n);return t[0]=i*l-r*s,t[1]=a*l+o*s,t[2]=r*l+i*s,t[3]=o*l-a*s,t},Z.rotateZ=function(t,e,n){n*=.5;var i=e[0],a=e[1],r=e[2],o=e[3],s=Math.sin(n),l=Math.cos(n);return t[0]=i*l+a*s,t[1]=a*l-i*s,t[2]=r*l+o*s,t[3]=o*l-r*s,t},Z.calculateW=function(t,e){var n=e[0],i=e[1],a=e[2];return t[0]=n,t[1]=i,t[2]=a,t[3]=Math.sqrt(Math.abs(1-n*n-i*i-a*a)),t},Z.exp=Dt,Z.ln=Lt,Z.pow=function(t,e,n){return Lt(t,e),Rt(t,t,n),Dt(t,t),t},Z.slerp=Bt,Z.random=function(t){var e=Ct.RANDOM(),n=Ct.RANDOM(),i=Ct.RANDOM(),a=Math.sqrt(1-e),r=Math.sqrt(e);return t[0]=a*Math.sin(2*Math.PI*n),t[1]=a*Math.cos(2*Math.PI*n),t[2]=r*Math.sin(2*Math.PI*i),t[3]=r*Math.cos(2*Math.PI*i),t},Z.invert=function(t,e){var n=e[0],i=e[1],a=e[2],r=e[3],o=n*n+i*i+a*a+r*r,s=o?1/o:0;return t[0]=-n*s,t[1]=-i*s,t[2]=-a*s,t[3]=r*s,t},Z.conjugate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t},Z.fromMat3=Ot,Z.fromEuler=function(t,e,n,i){var a=.5*Math.PI/180;e*=a,n*=a,i*=a;var r=Math.sin(e),o=Math.cos(e),s=Math.sin(n),l=Math.cos(n),c=Math.sin(i),u=Math.cos(i);return t[0]=r*l*u-o*s*c,t[1]=o*s*u+r*l*c,t[2]=o*l*c-r*s*u,t[3]=o*l*u+r*s*c,t},Z.str=function(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},Z.setAxes=Z.sqlerp=Z.rotationTo=Z.equals=Z.exactEquals=Z.normalize=Z.sqrLen=Z.squaredLength=Z.len=Z.length=Z.lerp=Z.dot=Z.scale=Z.mul=Z.add=Z.set=Z.copy=Z.fromValues=Z.clone=void 0;var Ct=kt(f),Et=kt(P),Tt=kt(Y),St=kt(ut);function Mt(t){if("function"!=typeof WeakMap)return null;var e=new WeakMap,n=new WeakMap;return(Mt=function(t){return t?n:e})(t)}function kt(t,e){if(t&&t.__esModule)return t;if(null===t||"object"!==At(t)&&"function"!=typeof t)return{default:t};var n=Mt(e);if(n&&n.has(t))return n.get(t);var i={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in t)if("default"!==r&&Object.prototype.hasOwnProperty.call(t,r)){var o=a?Object.getOwnPropertyDescriptor(t,r):null;o&&(o.get||o.set)?Object.defineProperty(i,r,o):i[r]=t[r]}return i.default=t,n&&n.set(t,i),i}function It(){var t=new Ct.ARRAY_TYPE(4);return Ct.ARRAY_TYPE!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function Pt(t,e,n){n*=.5;var i=Math.sin(n);return t[0]=i*e[0],t[1]=i*e[1],t[2]=i*e[2],t[3]=Math.cos(n),t}function zt(t,e,n){var i=e[0],a=e[1],r=e[2],o=e[3],s=n[0],l=n[1],c=n[2],u=n[3];return t[0]=i*u+o*s+a*c-r*l,t[1]=a*u+o*l+r*s-i*c,t[2]=r*u+o*c+i*l-a*s,t[3]=o*u-i*s-a*l-r*c,t}function Dt(t,e){var n=e[0],i=e[1],a=e[2],r=e[3],o=Math.sqrt(n*n+i*i+a*a),s=Math.exp(r),l=o>0?s*Math.sin(o)/o:0;return t[0]=n*l,t[1]=i*l,t[2]=a*l,t[3]=s*Math.cos(o),t}function Lt(t,e){var n=e[0],i=e[1],a=e[2],r=e[3],o=Math.sqrt(n*n+i*i+a*a),s=o>0?Math.atan2(o,r)/o:0;return t[0]=n*s,t[1]=i*s,t[2]=a*s,t[3]=.5*Math.log(n*n+i*i+a*a+r*r),t}function Bt(t,e,n,i){var a,r,o,s,l,c=e[0],u=e[1],h=e[2],d=e[3],p=n[0],f=n[1],m=n[2],g=n[3];return(r=c*p+u*f+h*m+d*g)<0&&(r=-r,p=-p,f=-f,m=-m,g=-g),1-r>Ct.EPSILON?(a=Math.acos(r),o=Math.sin(a),s=Math.sin((1-i)*a)/o,l=Math.sin(i*a)/o):(s=1-i,l=i),t[0]=s*c+l*p,t[1]=s*u+l*f,t[2]=s*h+l*m,t[3]=s*d+l*g,t}function Ot(t,e){var n,i=e[0]+e[4]+e[8];if(i>0)n=Math.sqrt(i+1),t[3]=.5*n,t[0]=(e[5]-e[7])*(n=.5/n),t[1]=(e[6]-e[2])*n,t[2]=(e[1]-e[3])*n;else{var a=0;e[4]>e[0]&&(a=1),e[8]>e[3*a+a]&&(a=2);var r=(a+1)%3,o=(a+2)%3;n=Math.sqrt(e[3*a+a]-e[3*r+r]-e[3*o+o]+1),t[a]=.5*n,t[3]=(e[3*r+o]-e[3*o+r])*(n=.5/n),t[r]=(e[3*r+a]+e[3*a+r])*n,t[o]=(e[3*o+a]+e[3*a+o])*n}return t}Z.clone=St.clone,Z.fromValues=St.fromValues,Z.copy=St.copy,Z.set=St.set,Z.add=St.add,Z.mul=zt;var Rt=St.scale;Z.scale=Rt;var Ft=St.dot;Z.dot=Ft,Z.lerp=St.lerp;var Nt=St.length;Z.length=Nt,Z.len=Nt;var jt=St.squaredLength;Z.squaredLength=jt,Z.sqrLen=jt;var Vt=St.normalize;Z.normalize=Vt,Z.exactEquals=St.exactEquals,Z.equals=St.equals;var Ut,Gt,qt,$t=(Ut=Tt.create(),Gt=Tt.fromValues(1,0,0),qt=Tt.fromValues(0,1,0),function(t,e,n){var i=Tt.dot(e,n);return i<-.999999?(Tt.cross(Ut,Gt,e),Tt.len(Ut)<1e-6&&Tt.cross(Ut,qt,e),Tt.normalize(Ut,Ut),Pt(t,Ut,Math.PI),t):i>.999999?(t[0]=0,t[1]=0,t[2]=0,t[3]=1,t):(Tt.cross(Ut,e,n),t[0]=Ut[0],t[1]=Ut[1],t[2]=Ut[2],t[3]=1+i,Vt(t,t))});Z.rotationTo=$t;var Wt,Ht,Zt=(Wt=It(),Ht=It(),function(t,e,n,i,a,r){return Bt(Wt,e,a,r),Bt(Ht,n,i,r),Bt(t,Wt,Ht,2*r*(1-r)),t});Z.sqlerp=Zt;var Yt,Xt=(Yt=Et.create(),function(t,e,n,i){return Yt[0]=n[0],Yt[3]=n[1],Yt[6]=n[2],Yt[1]=i[0],Yt[4]=i[1],Yt[7]=i[2],Yt[2]=-e[0],Yt[5]=-e[1],Yt[8]=-e[2],Vt(t,Ot(t,Yt))});Z.setAxes=Xt;var Kt={};function Qt(t){return Qt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qt(t)}Object.defineProperty(Kt,"__esModule",{value:!0}),Kt.create=function(){var t=new Jt.ARRAY_TYPE(8);return Jt.ARRAY_TYPE!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[4]=0,t[5]=0,t[6]=0,t[7]=0),t[3]=1,t},Kt.clone=function(t){var e=new Jt.ARRAY_TYPE(8);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e},Kt.fromValues=function(t,e,n,i,a,r,o,s){var l=new Jt.ARRAY_TYPE(8);return l[0]=t,l[1]=e,l[2]=n,l[3]=i,l[4]=a,l[5]=r,l[6]=o,l[7]=s,l},Kt.fromRotationTranslationValues=function(t,e,n,i,a,r,o){var s=new Jt.ARRAY_TYPE(8);s[0]=t,s[1]=e,s[2]=n,s[3]=i;var l=.5*a,c=.5*r,u=.5*o;return s[4]=l*i+c*n-u*e,s[5]=c*i+u*t-l*n,s[6]=u*i+l*e-c*t,s[7]=-l*t-c*e-u*n,s},Kt.fromRotationTranslation=ae,Kt.fromTranslation=function(t,e){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t[4]=.5*e[0],t[5]=.5*e[1],t[6]=.5*e[2],t[7]=0,t},Kt.fromRotation=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=0,t[5]=0,t[6]=0,t[7]=0,t},Kt.fromMat4=function(t,e){var n=te.create();ee.getRotation(n,e);var i=new Jt.ARRAY_TYPE(3);return ee.getTranslation(i,e),ae(t,n,i),t},Kt.copy=re,Kt.identity=function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t[6]=0,t[7]=0,t},Kt.set=function(t,e,n,i,a,r,o,s,l){return t[0]=e,t[1]=n,t[2]=i,t[3]=a,t[4]=r,t[5]=o,t[6]=s,t[7]=l,t},Kt.getDual=function(t,e){return t[0]=e[4],t[1]=e[5],t[2]=e[6],t[3]=e[7],t},Kt.setDual=function(t,e){return t[4]=e[0],t[5]=e[1],t[6]=e[2],t[7]=e[3],t},Kt.getTranslation=function(t,e){var n=e[4],i=e[5],a=e[6],r=e[7],o=-e[0],s=-e[1],l=-e[2],c=e[3];return t[0]=2*(n*c+r*o+i*l-a*s),t[1]=2*(i*c+r*s+a*o-n*l),t[2]=2*(a*c+r*l+n*s-i*o),t},Kt.translate=function(t,e,n){var i=e[0],a=e[1],r=e[2],o=e[3],s=.5*n[0],l=.5*n[1],c=.5*n[2],u=e[4],h=e[5],d=e[6],p=e[7];return t[0]=i,t[1]=a,t[2]=r,t[3]=o,t[4]=o*s+a*c-r*l+u,t[5]=o*l+r*s-i*c+h,t[6]=o*c+i*l-a*s+d,t[7]=-i*s-a*l-r*c+p,t},Kt.rotateX=function(t,e,n){var i=-e[0],a=-e[1],r=-e[2],o=e[3],s=e[4],l=e[5],c=e[6],u=e[7],h=s*o+u*i+l*r-c*a,d=l*o+u*a+c*i-s*r,p=c*o+u*r+s*a-l*i,f=u*o-s*i-l*a-c*r;return te.rotateX(t,e,n),t[4]=h*(o=t[3])+f*(i=t[0])+d*(r=t[2])-p*(a=t[1]),t[5]=d*o+f*a+p*i-h*r,t[6]=p*o+f*r+h*a-d*i,t[7]=f*o-h*i-d*a-p*r,t},Kt.rotateY=function(t,e,n){var i=-e[0],a=-e[1],r=-e[2],o=e[3],s=e[4],l=e[5],c=e[6],u=e[7],h=s*o+u*i+l*r-c*a,d=l*o+u*a+c*i-s*r,p=c*o+u*r+s*a-l*i,f=u*o-s*i-l*a-c*r;return te.rotateY(t,e,n),t[4]=h*(o=t[3])+f*(i=t[0])+d*(r=t[2])-p*(a=t[1]),t[5]=d*o+f*a+p*i-h*r,t[6]=p*o+f*r+h*a-d*i,t[7]=f*o-h*i-d*a-p*r,t},Kt.rotateZ=function(t,e,n){var i=-e[0],a=-e[1],r=-e[2],o=e[3],s=e[4],l=e[5],c=e[6],u=e[7],h=s*o+u*i+l*r-c*a,d=l*o+u*a+c*i-s*r,p=c*o+u*r+s*a-l*i,f=u*o-s*i-l*a-c*r;return te.rotateZ(t,e,n),t[4]=h*(o=t[3])+f*(i=t[0])+d*(r=t[2])-p*(a=t[1]),t[5]=d*o+f*a+p*i-h*r,t[6]=p*o+f*r+h*a-d*i,t[7]=f*o-h*i-d*a-p*r,t},Kt.rotateByQuatAppend=function(t,e,n){var i=n[0],a=n[1],r=n[2],o=n[3],s=e[0],l=e[1],c=e[2],u=e[3];return t[0]=s*o+u*i+l*r-c*a,t[1]=l*o+u*a+c*i-s*r,t[2]=c*o+u*r+s*a-l*i,t[3]=u*o-s*i-l*a-c*r,t[4]=(s=e[4])*o+(u=e[7])*i+(l=e[5])*r-(c=e[6])*a,t[5]=l*o+u*a+c*i-s*r,t[6]=c*o+u*r+s*a-l*i,t[7]=u*o-s*i-l*a-c*r,t},Kt.rotateByQuatPrepend=function(t,e,n){var i=e[0],a=e[1],r=e[2],o=e[3],s=n[0],l=n[1],c=n[2],u=n[3];return t[0]=i*u+o*s+a*c-r*l,t[1]=a*u+o*l+r*s-i*c,t[2]=r*u+o*c+i*l-a*s,t[3]=o*u-i*s-a*l-r*c,t[4]=i*(u=n[7])+o*(s=n[4])+a*(c=n[6])-r*(l=n[5]),t[5]=a*u+o*l+r*s-i*c,t[6]=r*u+o*c+i*l-a*s,t[7]=o*u-i*s-a*l-r*c,t},Kt.rotateAroundAxis=function(t,e,n,i){if(Math.abs(i)<Jt.EPSILON)return re(t,e);var a=Math.hypot(n[0],n[1],n[2]);i*=.5;var r=Math.sin(i),o=r*n[0]/a,s=r*n[1]/a,l=r*n[2]/a,c=Math.cos(i),u=e[0],h=e[1],d=e[2],p=e[3];t[0]=u*c+p*o+h*l-d*s,t[1]=h*c+p*s+d*o-u*l,t[2]=d*c+p*l+u*s-h*o,t[3]=p*c-u*o-h*s-d*l;var f=e[4],m=e[5],g=e[6],_=e[7];return t[4]=f*c+_*o+m*l-g*s,t[5]=m*c+_*s+g*o-f*l,t[6]=g*c+_*l+f*s-m*o,t[7]=_*c-f*o-m*s-g*l,t},Kt.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t},Kt.multiply=oe,Kt.scale=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t},Kt.lerp=function(t,e,n,i){var a=1-i;return se(e,n)<0&&(i=-i),t[0]=e[0]*a+n[0]*i,t[1]=e[1]*a+n[1]*i,t[2]=e[2]*a+n[2]*i,t[3]=e[3]*a+n[3]*i,t[4]=e[4]*a+n[4]*i,t[5]=e[5]*a+n[5]*i,t[6]=e[6]*a+n[6]*i,t[7]=e[7]*a+n[7]*i,t},Kt.invert=function(t,e){var n=ce(e);return t[0]=-e[0]/n,t[1]=-e[1]/n,t[2]=-e[2]/n,t[3]=e[3]/n,t[4]=-e[4]/n,t[5]=-e[5]/n,t[6]=-e[6]/n,t[7]=e[7]/n,t},Kt.conjugate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t[4]=-e[4],t[5]=-e[5],t[6]=-e[6],t[7]=e[7],t},Kt.normalize=function(t,e){var n=ce(e);if(n>0){n=Math.sqrt(n);var i=e[0]/n,a=e[1]/n,r=e[2]/n,o=e[3]/n,s=e[4],l=e[5],c=e[6],u=e[7],h=i*s+a*l+r*c+o*u;t[0]=i,t[1]=a,t[2]=r,t[3]=o,t[4]=(s-i*h)/n,t[5]=(l-a*h)/n,t[6]=(c-r*h)/n,t[7]=(u-o*h)/n}return t},Kt.str=function(t){return"quat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+")"},Kt.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]},Kt.equals=function(t,e){var n=t[0],i=t[1],a=t[2],r=t[3],o=t[4],s=t[5],l=t[6],c=t[7],u=e[0],h=e[1],d=e[2],p=e[3],f=e[4],m=e[5],g=e[6],_=e[7];return Math.abs(n-u)<=Jt.EPSILON*Math.max(1,Math.abs(n),Math.abs(u))&&Math.abs(i-h)<=Jt.EPSILON*Math.max(1,Math.abs(i),Math.abs(h))&&Math.abs(a-d)<=Jt.EPSILON*Math.max(1,Math.abs(a),Math.abs(d))&&Math.abs(r-p)<=Jt.EPSILON*Math.max(1,Math.abs(r),Math.abs(p))&&Math.abs(o-f)<=Jt.EPSILON*Math.max(1,Math.abs(o),Math.abs(f))&&Math.abs(s-m)<=Jt.EPSILON*Math.max(1,Math.abs(s),Math.abs(m))&&Math.abs(l-g)<=Jt.EPSILON*Math.max(1,Math.abs(l),Math.abs(g))&&Math.abs(c-_)<=Jt.EPSILON*Math.max(1,Math.abs(c),Math.abs(_))},Kt.sqrLen=Kt.squaredLength=Kt.len=Kt.length=Kt.dot=Kt.mul=Kt.setReal=Kt.getReal=void 0;var Jt=ie(f),te=ie(Z),ee=ie(R);function ne(t){if("function"!=typeof WeakMap)return null;var e=new WeakMap,n=new WeakMap;return(ne=function(t){return t?n:e})(t)}function ie(t,e){if(t&&t.__esModule)return t;if(null===t||"object"!==Qt(t)&&"function"!=typeof t)return{default:t};var n=ne(e);if(n&&n.has(t))return n.get(t);var i={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in t)if("default"!==r&&Object.prototype.hasOwnProperty.call(t,r)){var o=a?Object.getOwnPropertyDescriptor(t,r):null;o&&(o.get||o.set)?Object.defineProperty(i,r,o):i[r]=t[r]}return i.default=t,n&&n.set(t,i),i}function ae(t,e,n){var i=.5*n[0],a=.5*n[1],r=.5*n[2],o=e[0],s=e[1],l=e[2],c=e[3];return t[0]=o,t[1]=s,t[2]=l,t[3]=c,t[4]=i*c+a*l-r*s,t[5]=a*c+r*o-i*l,t[6]=r*c+i*s-a*o,t[7]=-i*o-a*s-r*l,t}function re(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t}function oe(t,e,n){var i=e[0],a=e[1],r=e[2],o=e[3],s=n[4],l=n[5],c=n[6],u=n[7],h=e[4],d=e[5],p=e[6],f=e[7],m=n[0],g=n[1],_=n[2],y=n[3];return t[0]=i*y+o*m+a*_-r*g,t[1]=a*y+o*g+r*m-i*_,t[2]=r*y+o*_+i*g-a*m,t[3]=o*y-i*m-a*g-r*_,t[4]=i*u+o*s+a*c-r*l+h*y+f*m+d*_-p*g,t[5]=a*u+o*l+r*s-i*c+d*y+f*g+p*m-h*_,t[6]=r*u+o*c+i*l-a*s+p*y+f*_+h*g-d*m,t[7]=o*u-i*s-a*l-r*c+f*y-h*m-d*g-p*_,t}Kt.getReal=te.copy,Kt.setReal=te.copy,Kt.mul=oe;var se=te.dot;Kt.dot=se;var le=te.length;Kt.length=le,Kt.len=le;var ce=te.squaredLength;Kt.squaredLength=ce,Kt.sqrLen=ce;var ue={};function he(t){return he="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},he(t)}Object.defineProperty(ue,"__esModule",{value:!0}),ue.create=fe,ue.clone=function(t){var e=new de.ARRAY_TYPE(2);return e[0]=t[0],e[1]=t[1],e},ue.fromValues=function(t,e){var n=new de.ARRAY_TYPE(2);return n[0]=t,n[1]=e,n},ue.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t},ue.set=function(t,e,n){return t[0]=e,t[1]=n,t},ue.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t},ue.subtract=me,ue.multiply=ge,ue.divide=_e,ue.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t},ue.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t},ue.min=function(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t},ue.max=function(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t},ue.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t},ue.scale=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t},ue.scaleAndAdd=function(t,e,n,i){return t[0]=e[0]+n[0]*i,t[1]=e[1]+n[1]*i,t},ue.distance=ye,ue.squaredDistance=xe,ue.length=ve,ue.squaredLength=be,ue.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t},ue.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t},ue.normalize=function(t,e){var n=e[0],i=e[1],a=n*n+i*i;return a>0&&(a=1/Math.sqrt(a)),t[0]=e[0]*a,t[1]=e[1]*a,t},ue.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]},ue.cross=function(t,e,n){var i=e[0]*n[1]-e[1]*n[0];return t[0]=t[1]=0,t[2]=i,t},ue.lerp=function(t,e,n,i){var a=e[0],r=e[1];return t[0]=a+i*(n[0]-a),t[1]=r+i*(n[1]-r),t},ue.random=function(t,e){e=e||1;var n=2*de.RANDOM()*Math.PI;return t[0]=Math.cos(n)*e,t[1]=Math.sin(n)*e,t},ue.transformMat2=function(t,e,n){var i=e[0],a=e[1];return t[0]=n[0]*i+n[2]*a,t[1]=n[1]*i+n[3]*a,t},ue.transformMat2d=function(t,e,n){var i=e[0],a=e[1];return t[0]=n[0]*i+n[2]*a+n[4],t[1]=n[1]*i+n[3]*a+n[5],t},ue.transformMat3=function(t,e,n){var i=e[0],a=e[1];return t[0]=n[0]*i+n[3]*a+n[6],t[1]=n[1]*i+n[4]*a+n[7],t},ue.transformMat4=function(t,e,n){var i=e[0],a=e[1];return t[0]=n[0]*i+n[4]*a+n[12],t[1]=n[1]*i+n[5]*a+n[13],t},ue.rotate=function(t,e,n,i){var a=e[0]-n[0],r=e[1]-n[1],o=Math.sin(i),s=Math.cos(i);return t[0]=a*s-r*o+n[0],t[1]=a*o+r*s+n[1],t},ue.angle=function(t,e){var n=t[0],i=t[1],a=e[0],r=e[1],o=Math.sqrt(n*n+i*i)*Math.sqrt(a*a+r*r);return Math.acos(Math.min(Math.max(o&&(n*a+i*r)/o,-1),1))},ue.zero=function(t){return t[0]=0,t[1]=0,t},ue.str=function(t){return"vec2("+t[0]+", "+t[1]+")"},ue.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]},ue.equals=function(t,e){var n=t[0],i=t[1],a=e[0],r=e[1];return Math.abs(n-a)<=de.EPSILON*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(i-r)<=de.EPSILON*Math.max(1,Math.abs(i),Math.abs(r))},ue.forEach=ue.sqrLen=ue.sqrDist=ue.dist=ue.div=ue.mul=ue.sub=ue.len=void 0;var de=function(t,e){if(t&&t.__esModule)return t;if(null===t||"object"!==he(t)&&"function"!=typeof t)return{default:t};var n=pe(void 0);if(n&&n.has(t))return n.get(t);var i={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in t)if("default"!==r&&Object.prototype.hasOwnProperty.call(t,r)){var o=a?Object.getOwnPropertyDescriptor(t,r):null;o&&(o.get||o.set)?Object.defineProperty(i,r,o):i[r]=t[r]}return i.default=t,n&&n.set(t,i),i}(f);function pe(t){if("function"!=typeof WeakMap)return null;var e=new WeakMap,n=new WeakMap;return(pe=function(t){return t?n:e})(t)}function fe(){var t=new de.ARRAY_TYPE(2);return de.ARRAY_TYPE!=Float32Array&&(t[0]=0,t[1]=0),t}function me(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t}function ge(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t}function _e(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t}function ye(t,e){return Math.hypot(e[0]-t[0],e[1]-t[1])}function xe(t,e){var n=e[0]-t[0],i=e[1]-t[1];return n*n+i*i}function ve(t){return Math.hypot(t[0],t[1])}function be(t){var e=t[0],n=t[1];return e*e+n*n}ue.len=ve,ue.sub=me,ue.mul=ge,ue.div=_e,ue.dist=ye,ue.sqrDist=xe,ue.sqrLen=be;var we=function(){var t=fe();return function(e,n,i,a,r,o){var s,l;for(n||(n=2),i||(i=0),l=a?Math.min(a*n+i,e.length):e.length,s=i;s<l;s+=n)t[0]=e[s],t[1]=e[s+1],r(t,t,o),e[s]=t[0],e[s+1]=t[1];return e}}();function Ae(t){return Ae="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ae(t)}ue.forEach=we,Object.defineProperty(p,"__esModule",{value:!0}),t.aA=p.vec4=t._=p.vec3=p.vec2=p.quat2=t.av=p.quat=t.ad=p.mat4=t.bC=p.mat3=p.mat2d=t.aC=p.mat2=p.glMatrix=void 0;var Ce=Be(f);p.glMatrix=Ce;var Ee=Be(x);t.aC=p.mat2=Ee;var Te=Be(E);p.mat2d=Te;var Se=Be(P);t.bC=p.mat3=Se;var Me=Be(R);t.ad=p.mat4=Me;var ke=Be(Z);t.av=p.quat=ke;var Ie=Be(Kt);p.quat2=Ie;var Pe=Be(ue);p.vec2=Pe;var ze=Be(Y);t._=p.vec3=ze;var De=Be(ut);function Le(t){if("function"!=typeof WeakMap)return null;var e=new WeakMap,n=new WeakMap;return(Le=function(t){return t?n:e})(t)}function Be(t,e){if(t&&t.__esModule)return t;if(null===t||"object"!==Ae(t)&&"function"!=typeof t)return{default:t};var n=Le(e);if(n&&n.has(t))return n.get(t);var i={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in t)if("default"!==r&&Object.prototype.hasOwnProperty.call(t,r)){var o=a?Object.getOwnPropertyDescriptor(t,r):null;o&&(o.get||o.set)?Object.defineProperty(i,r,o):i[r]=t[r]}return i.default=t,n&&n.set(t,i),i}t.aA=p.vec4=De;var Oe=Re;function Re(t,e,n,i){this.cx=3*t,this.bx=3*(n-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(i-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=e,this.p2x=n,this.p2y=i}Re.prototype={sampleCurveX:function(t){return((this.ax*t+this.bx)*t+this.cx)*t},sampleCurveY:function(t){return((this.ay*t+this.by)*t+this.cy)*t},sampleCurveDerivativeX:function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},solveCurveX:function(t,e){if(void 0===e&&(e=1e-6),t<0)return 0;if(t>1)return 1;for(var n=t,i=0;i<8;i++){var a=this.sampleCurveX(n)-t;if(Math.abs(a)<e)return n;var r=this.sampleCurveDerivativeX(n);if(Math.abs(r)<1e-6)break;n-=a/r}var o=0,s=1;for(n=t,i=0;i<20&&(a=this.sampleCurveX(n),!(Math.abs(a-t)<e));i++)t>a?o=n:s=n,n=.5*(s-o)+o;return n},solve:function(t,e){return this.sampleCurveY(this.solveCurveX(t,e))}};var Fe=d(Oe),Ne=je;function je(t,e){this.x=t,this.y=e}je.prototype={clone:function(){return new je(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,e){return this.clone()._rotateAround(t,e)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var e=t.x-this.x,n=t.y-this.y;return e*e+n*n},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,e){return Math.atan2(this.x*e-this.y*t,this.x*t+this.y*e)},_matMult:function(t){var e=t[2]*this.x+t[3]*this.y;return this.x=t[0]*this.x+t[1]*this.y,this.y=e,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var e=Math.cos(t),n=Math.sin(t),i=n*this.x+e*this.y;return this.x=e*this.x-n*this.y,this.y=i,this},_rotateAround:function(t,e){var n=Math.cos(t),i=Math.sin(t),a=e.y+i*(this.x-e.x)+n*(this.y-e.y);return this.x=e.x+n*(this.x-e.x)-i*(this.y-e.y),this.y=a,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},je.convert=function(t){return t instanceof je?t:Array.isArray(t)?new je(t[0],t[1]):t};var Ve=d(Ne);const Ue=Math.PI/180,Ge=180/Math.PI;function qe(t){return t*Ue}function $e(t){return t*Ge}const We=[[0,0],[1,0],[1,1],[0,1]];function He(t){if(t<=0)return 0;if(t>=1)return 1;const e=t*t,n=e*t;return 4*(t<.5?n:3*(t-e)+n-.75)}function Ze(t,e,n,i){const a=new Fe(t,e,n,i);return function(t){return a.solve(t)}}const Ye=Ze(.25,.1,.25,1);function Xe(t,e,n){return Math.min(n,Math.max(e,t))}function Ke(t,e,n){return(n=Xe((n-t)/(e-t),0,1))*n*(3-2*n)}function Qe(t,e,n){const i=n-e,a=((t-e)%i+i)%i+e;return a===e?n:a}function Je(t,e,n){if(!t.length)return n(null,[]);let i=t.length;const a=new Array(t.length);let r=null;t.forEach(((t,o)=>{e(t,((t,e)=>{t&&(r=t),a[o]=e,0==--i&&n(r,a)}))}))}function tn(t){const e=[];for(const n in t)e.push(t[n]);return e}function en(t,...e){for(const n of e)for(const e in n)t[e]=n[e];return t}let nn=1;function an(){return nn++}function rn(){return function t(e){return e?(e^Math.random()*(16>>e/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,t)}()}function on(t){return t<=1?1:Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))}function sn(t){return!!t&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(t)}function ln(t,e){t.forEach((t=>{e[t]&&(e[t]=e[t].bind(e))}))}function cn(t,e){return-1!==t.indexOf(e,t.length-e.length)}function un(t,e,n){const i={};for(const n in t)i[n]=e.call(this,t[n],n,t);return i}function hn(t,e,n){const i={};for(const n in t)e.call(this,t[n],n,t)&&(i[n]=t[n]);return i}function dn(t){return Array.isArray(t)?t.map(dn):"object"==typeof t&&t?un(t,dn):t}const pn={};function fn(t){pn[t]||("undefined"!=typeof console&&console.warn(t),pn[t]=!0)}function mn(t,e,n){return(n.y-t.y)*(e.x-t.x)>(e.y-t.y)*(n.x-t.x)}function gn(t){let e=0;for(let n,i,a=0,r=t.length,o=r-1;a<r;o=a++)n=t[a],i=t[o],e+=(i.x-n.x)*(n.y+i.y);return e}function _n([t,e,n]){const i=qe(e+90),a=qe(n);return{x:t*Math.cos(i)*Math.sin(a),y:t*Math.sin(i)*Math.sin(a),z:t*Math.cos(a),azimuthal:e,polar:n}}function yn(){return"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope}function xn(t){const e={};if(t.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,((t,n,i,a)=>{const r=i||a;return e[n]=!r||r.toLowerCase(),""})),e["max-age"]){const t=parseInt(e["max-age"],10);isNaN(t)?delete e["max-age"]:e["max-age"]=t}return e}let vn,bn,wn,An,Cn,En,Tn=null;function Sn(t){try{const e=self[t];return e.setItem("_mapbox_test_",1),e.removeItem("_mapbox_test_"),!0}catch(t){return!1}}function Mn(t,e){return[t[4*e],t[4*e+1],t[4*e+2],t[4*e+3]]}function kn(t,e,n,i){for(;e<n;){const a=e+n>>1;t[a]<i?e=a+1:n=a}return e}function In(t,e,n,i){for(;e<n;){const a=e+n>>1;t[a]<=i?e=a+1:n=a}return e}function Pn(t){return t>0?1/(1.001-t):1+t}function zn(t){return t>0?1-1/(1.001-t):-t}function Dn(){return null==vn&&(vn=self.OffscreenCanvas&&new OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof self.createImageBitmap),vn}const Ln={now:()=>void 0!==An?An:performance.now(),setNow(t){An=t},restoreNow(){An=void 0},frame(t){const e=requestAnimationFrame(t);return{cancel:()=>cancelAnimationFrame(e)}},getImageData(t,e=0){const{width:n,height:i}=t;Cn||(Cn=document.createElement("canvas"));const a=Cn.getContext("2d",{willReadFrequently:!0});if(!a)throw new Error("failed to create canvas 2d context");return(n>Cn.width||i>Cn.height)&&(Cn.width=n,Cn.height=i),a.clearRect(-e,-e,n+2*e,i+2*e),a.drawImage(t,0,0,n,i),a.getImageData(-e,-e,n+2*e,i+2*e)},resolveURL:t=>(bn||(bn=document.createElement("a")),bn.href=t,bn.href),get devicePixelRatio(){return window.devicePixelRatio},get prefersReducedMotion(){return!!window.matchMedia&&(null==wn&&(wn=window.matchMedia("(prefers-reduced-motion: reduce)")),wn.matches)},hasCanvasFingerprintNoise(){if(void 0!==En)return En;if(!Dn())return En=!1,!1;const t=new OffscreenCanvas(85,1),e=t.getContext("2d",{willReadFrequently:!0});let n=0;for(let i=0;i<t.width;++i)e.fillStyle=`rgba(${n++},${n++},${n++}, 255)`,e.fillRect(i,0,1,1);const i=e.getImageData(0,0,t.width,t.height);n=0;for(let t=0;t<i.data.length;++t)if(t%4!=3&&n++!==i.data[t])return En=!0,!0;return En=!1,!1}};function Bn(t,e){const n=t.indexOf("?");if(n<0)return`${t}?${new URLSearchParams(e).toString()}`;const i=new URLSearchParams(t.slice(n));for(const t in e)i.set(t,e[t]);return`${t.slice(0,n)}?${i.toString()}`}function On(t,e={persistentParams:[]}){const n=t.indexOf("?");if(n<0)return t;const i=new URLSearchParams,a=new URLSearchParams(t.slice(n));for(const t of e.persistentParams){const e=a.get(t);e&&i.set(t,e)}const r=i.toString();return`${t.slice(0,n)}${r.length>0?`?${r}`:""}`}const Rn="mapbox-tiles";let Fn,Nn,jn=500,Vn=50;function Un(){try{return caches}catch(t){}}function Gn(){const t=Un();t&&!Fn&&(Fn=t.open(Rn))}let qn=1/0;const $n={supported:!1,testSupport:function(t){!Zn&&Hn&&(Yn?Kn(t):Wn=t)}};let Wn,Hn,Zn=!1,Yn=!1;const Xn="undefined"!=typeof self?self:{};function Kn(t){const e=t.createTexture();t.bindTexture(t.TEXTURE_2D,e);try{if(t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,Hn),t.isContextLost())return;$n.supported=!0}catch(t){}t.deleteTexture(e),Zn=!0}Xn.document&&(Hn=Xn.document.createElement("img"),Hn.onload=function(){Wn&&Kn(Wn),Wn=null,Yn=!0},Hn.onerror=function(){Zn=!0,Wn=null},Hn.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const Qn={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image",Model:"Model"};"function"==typeof Object.freeze&&Object.freeze(Qn);class Jn extends Error{constructor(t,e,n){401===e&&a(n)&&(t+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(t),this.status=e,this.url=n}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const ti=yn()?()=>self.worker&&self.worker.referrer:()=>("blob:"===location.protocol?parent:self).location.href,ei=function(t,e){if(!(/^file:/.test(n=t.url)||/^file:/.test(ti())&&!/^\w+:/.test(n))){if(self.fetch&&self.Request&&self.AbortController&&Request.prototype.hasOwnProperty("signal"))return function(t,e){const n=new AbortController,i=new Request(t.url,{method:t.method||"GET",body:t.body,credentials:t.credentials,headers:t.headers,referrer:ti(),referrerPolicy:t.referrerPolicy,signal:n.signal});let r=!1,o=!1;const s=(l=i.url).indexOf("sku=")>0&&a(l);var l;"json"===t.type&&i.headers.set("Accept","application/json");const c=(n,a,r)=>{if(o)return;if(n&&"SecurityError"!==n.message&&fn(n.toString()),a&&r)return u(a);const l=Date.now();fetch(i).then((n=>{if(n.ok){const t=s?n.clone():null;return u(n,t,l)}return e(new Jn(n.statusText,n.status,t.url))})).catch((n=>{"AbortError"!==n.name&&e(new Error(`${n.message} ${t.url}`))}))},u=(n,a,s)=>{("arrayBuffer"===t.type?n.arrayBuffer():"json"===t.type?n.json():n.text()).then((t=>{o||(a&&s&&function(t,e,n){if(Gn(),!Fn)return;const i=xn(e.headers.get("Cache-Control")||"");if(i["no-store"])return;const a={status:e.status,statusText:e.statusText,headers:new Headers};e.headers.forEach(((t,e)=>a.headers.set(e,t))),i["max-age"]&&a.headers.set("Expires",new Date(n+1e3*i["max-age"]).toUTCString());const r=a.headers.get("Expires");if(!r)return;if(new Date(r).getTime()-n<42e4)return;let o=On(t.url,{persistentParams:["language","worldview"]});if(206===e.status){const e=t.headers.get("Range");if(!e)return;a.status=200,o=Bn(o,{range:e})}!function(t,e){if(void 0===Nn)try{new Response(new ReadableStream),Nn=!0}catch(t){Nn=!1}Nn?e(t.body):t.blob().then(e)}(e,(t=>{const n=new Response(200!==(i=e.status)&&404!==i&&[101,103,204,205,304].includes(i)?null:t,a);var i;Gn(),Fn&&Fn.then((t=>t.put(o,n))).catch((t=>fn(t.message)))}))}(i,a,s),r=!0,e(null,t,n.headers.get("Cache-Control"),n.headers.get("Expires")))})).catch((t=>{o||e(new Error(t.message))}))};return s?function(t,e){if(Gn(),!Fn)return e(null);Fn.then((n=>{let i=On(t.url,{persistentParams:["language","worldview"]});const a=t.headers.get("Range");a&&(i=Bn(i,{range:a})),n.match(i).then((t=>{const a=function(t){if(!t)return!1;const e=new Date(t.headers.get("Expires")||0),n=xn(t.headers.get("Cache-Control")||"");return e>Date.now()&&!n["no-cache"]}(t);n.delete(i),a&&n.put(i,t.clone()),e(null,t,a)})).catch(e)})).catch(e)}(i,c):c(null,null),{cancel:()=>{o=!0,r||n.abort()}}}(t,e);if(yn()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",t,e,void 0,!0)}var n;return function(t,e){const n=new XMLHttpRequest;n.open(t.method||"GET",t.url,!0),"arrayBuffer"===t.type&&(n.responseType="arraybuffer");for(const e in t.headers)n.setRequestHeader(e,t.headers[e]);return"json"===t.type&&(n.responseType="text",n.setRequestHeader("Accept","application/json")),n.withCredentials="include"===t.credentials,n.onerror=()=>{e(new Error(n.statusText))},n.onload=()=>{if((n.status>=200&&n.status<300||0===n.status)&&null!==n.response){let i=n.response;if("json"===t.type)try{i=JSON.parse(n.response)}catch(t){return e(t)}e(null,i,n.getResponseHeader("Cache-Control"),n.getResponseHeader("Expires"))}else e(new Jn(n.statusText,n.status,t.url))},n.send(t.body),{cancel:()=>n.abort()}}(t,e)},ni=function(t,e){return ei(en(t,{type:"arrayBuffer"}),e)};function ii(t){const e=document.createElement("a");return e.href=t,e.protocol===location.protocol&&e.host===location.host}const ai="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let ri,oi;ri=[],oi=0;const si=function(t,e){if($n.supported&&(t.headers||(t.headers={}),t.headers.accept="image/webp,*/*"),oi>=i.MAX_PARALLEL_IMAGE_REQUESTS){const n={requestParameters:t,callback:e,cancelled:!1,cancel(){this.cancelled=!0}};return ri.push(n),n}oi++;let n=!1;const a=()=>{if(!n)for(n=!0,oi--;ri.length&&oi<i.MAX_PARALLEL_IMAGE_REQUESTS;){const t=ri.shift(),{requestParameters:e,callback:n,cancelled:i}=t;i||(t.cancel=si(e,n).cancel)}},r=ni(t,((t,n,i,r)=>{a(),t?e(t):n&&(self.createImageBitmap?function(t,e){const n=new Blob([new Uint8Array(t)],{type:"image/png"});createImageBitmap(n).then((t=>{e(null,t)})).catch((t=>{e(new Error(`Could not load image because of ${t.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))}))}(n,((t,n)=>e(t,n,i,r))):function(t,e){const n=new Image;n.onload=()=>{e(null,n),URL.revokeObjectURL(n.src),n.onload=null,requestAnimationFrame((()=>{n.src=ai}))},n.onerror=()=>e(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const i=new Blob([new Uint8Array(t)],{type:"image/png"});n.src=t.byteLength?URL.createObjectURL(i):ai}(n,((t,n)=>e(t,n,i,r))))}));return{cancel:()=>{r.cancel(),a()}}},li="01",ci="NO_ACCESS_TOKEN",ui=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function hi(t){const e=t.match(ui);if(!e)throw new Error("Unable to parse URL object");return{protocol:e[1],authority:e[2],path:e[3]||"/",params:e[4]?e[4].split("&"):[]}}function di(t){const e=t.params.length?`?${t.params.join("&")}`:"";return`${t.protocol}://${t.authority}${t.path}${e}`}const pi="mapbox.eventData";function fi(t){if(!t)return null;const e=t.split(".");if(!e||3!==e.length)return null;try{return JSON.parse(decodeURIComponent(atob(e[1]).split("").map((t=>"%"+("00"+t.charCodeAt(0).toString(16)).slice(-2))).join("")))}catch(t){return null}}class mi{constructor(t){this.type=t,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(t){const e=fi(i.ACCESS_TOKEN);let n="";return n=e&&e.u?btoa(encodeURIComponent(e.u).replace(/%([0-9A-F]{2})/g,((t,e)=>String.fromCharCode(Number("0x"+e))))):i.ACCESS_TOKEN||"",t?`${pi}.${t}:${n}`:`${pi}:${n}`}fetchEventData(){const t=Sn("localStorage"),e=this.getStorageKey(),n=this.getStorageKey("uuid");if(t)try{const t=localStorage.getItem(e);t&&(this.eventData=JSON.parse(t));const i=localStorage.getItem(n);i&&(this.anonId=i)}catch(t){fn("Unable to read from LocalStorage")}}saveEventData(){const t=Sn("localStorage"),e=this.getStorageKey(),n=this.getStorageKey("uuid"),i=this.anonId;if(t&&i)try{localStorage.setItem(n,i),Object.keys(this.eventData).length>=1&&localStorage.setItem(e,JSON.stringify(this.eventData))}catch(t){fn("Unable to write to LocalStorage")}}processRequests(t){}postEvent(t,e,n,a){if(!i.EVENTS_URL)return;const r=hi(i.EVENTS_URL);r.params.push(`access_token=${a||i.ACCESS_TOKEN||""}`);const o={event:this.type,created:new Date(t).toISOString()},s=e?en(o,e):o,l={url:di(r),headers:{"Content-Type":"text/plain"},body:JSON.stringify([s])};this.pendingRequest=function(t,e){return ei(en(t,{method:"POST"}),e)}(l,(t=>{this.pendingRequest=null,n(t),this.saveEventData(),this.processRequests(a)}))}queueRequest(t,e){this.queue.push(t),this.processRequests(e)}}const gi=new class extends mi{constructor(t){super("appUserTurnstile"),this._customAccessToken=t}postTurnstileEvent(t,e){i.EVENTS_URL&&i.ACCESS_TOKEN&&Array.isArray(t)&&t.some((t=>r(t)||a(t)))&&this.queueRequest(Date.now(),e)}processRequests(t){if(this.pendingRequest||0===this.queue.length)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const n=fi(i.ACCESS_TOKEN),a=n?n.u:i.ACCESS_TOKEN;let r=a!==this.eventData.tokenU;sn(this.anonId)||(this.anonId=rn(),r=!0);const o=this.queue.shift();if(this.eventData.lastSuccess){const t=new Date(this.eventData.lastSuccess),e=new Date(o),n=(o-this.eventData.lastSuccess)/864e5;r=r||n>=1||n<-1||t.getDate()!==e.getDate()}else r=!0;r?this.postEvent(o,{sdkIdentifier:"mapbox-gl-js",sdkVersion:e,skuId:li,"enabled.telemetry":!1,userId:this.anonId},(t=>{t||(this.eventData.lastSuccess=o,this.eventData.tokenU=a)}),t):this.processRequests()}},_i=gi.postTurnstileEvent.bind(gi),yi=new class extends mi{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(t,e,n,a){this.skuToken=e,this.errorCb=a,i.EVENTS_URL&&(n||i.ACCESS_TOKEN?this.queueRequest({id:t,timestamp:Date.now()},n):this.errorCb(new Error(ci)))}processRequests(t){if(this.pendingRequest||0===this.queue.length)return;const{id:n,timestamp:i}=this.queue.shift();n&&this.success[n]||(this.anonId||this.fetchEventData(),sn(this.anonId)||(this.anonId=rn()),this.postEvent(i,{sdkIdentifier:"mapbox-gl-js",sdkVersion:e,skuId:li,skuToken:this.skuToken,userId:this.anonId},(t=>{t?this.errorCb(t):n&&(this.success[n]=!0)}),t))}remove(){this.errorCb=null}},xi=yi.postMapLoadEvent.bind(yi),vi=new class extends mi{constructor(){super("style.load"),this.eventIdPerMapInstanceMap=new Map,this.mapInstanceIdMap=new WeakMap}getMapInstanceId(t){let e=this.mapInstanceIdMap.get(t);return e||(e=rn(),this.mapInstanceIdMap.set(t,e)),e}getEventId(t){const e=this.eventIdPerMapInstanceMap.get(t)||0;return this.eventIdPerMapInstanceMap.set(t,e+1),e}postStyleLoadEvent(t,e){const{map:n,style:a,importedStyles:r}=e;if(!i.EVENTS_URL||!t&&!i.ACCESS_TOKEN)return;const o=this.getMapInstanceId(n),s={mapInstanceId:o,eventId:this.getEventId(o),style:a};r.length&&(s.importedStyles=r),this.queueRequest({timestamp:Date.now(),payload:s},t)}processRequests(t){if(this.pendingRequest||0===this.queue.length)return;const{timestamp:e,payload:n}=this.queue.shift();this.postEvent(e,n,(()=>{}),t)}},bi=vi.postStyleLoadEvent.bind(vi),wi=new class extends mi{constructor(){super("gljs.performance")}postPerformanceEvent(t,e){i.EVENTS_URL&&(t||i.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:e},t)}processRequests(t){if(this.pendingRequest||0===this.queue.length)return;const{timestamp:n,performanceData:i}=this.queue.shift(),a=function(t){const n=performance.getEntriesByType("resource"),i=performance.getEntriesByType("mark"),a=function(t){const e={};if(t)for(const n in t)if("other"!==n)for(const i of t[n]){const t=`${n}ResolveRangeMin`,a=`${n}ResolveRangeMax`,r=`${n}RequestCount`,o=`${n}RequestCachedCount`;e[t]=Math.min(e[t]||1/0,i.startTime),e[a]=Math.max(e[a]||-1/0,i.responseEnd);const s=t=>{void 0===e[t]&&(e[t]=0),++e[t]};void 0!==i.transferSize&&0===i.transferSize&&s(o),s(r)}return e}(function(t,e){const n={};if(t)for(const i of t){const t=e(i);void 0===n[t]&&(n[t]=[]),n[t].push(i)}return n}(n,h)),r=window.devicePixelRatio,o=navigator.connection||navigator.mozConnection||navigator.webkitConnection,s=o?o.effectiveType:void 0,u={counters:[],metadata:[],attributes:[]},d=(t,e,n)=>{null!=n&&t.push({name:e,value:n.toString()})};for(const t in a)d(u.counters,t,a[t]);if(t.interactionRange[0]!==1/0&&t.interactionRange[1]!==-1/0&&(d(u.counters,"interactionRangeMin",t.interactionRange[0]),d(u.counters,"interactionRangeMax",t.interactionRange[1])),i)for(const t of Object.keys(c)){const e=c[t],n=i.find((t=>t.name===e));n&&d(u.counters,e,n.startTime)}return d(u.counters,"visibilityHidden",t.visibilityHidden),d(u.attributes,"style",function(t){if(t)for(const e of t){const t=e.name.split("?")[0];if(l(t)){const e=t.split("/").slice(-2);if(2===e.length)return`mapbox://styles/${e[0]}/${e[1]}`}}}(n)),d(u.attributes,"terrainEnabled",t.terrainEnabled?"true":"false"),d(u.attributes,"fogEnabled",t.fogEnabled?"true":"false"),d(u.attributes,"projection",t.projection),d(u.attributes,"zoom",t.zoom),d(u.metadata,"devicePixelRatio",r),d(u.metadata,"connectionEffectiveType",s),d(u.metadata,"navigatorUserAgent",navigator.userAgent),d(u.metadata,"screenWidth",window.screen.width),d(u.metadata,"screenHeight",window.screen.height),d(u.metadata,"windowWidth",window.innerWidth),d(u.metadata,"windowHeight",window.innerHeight),d(u.metadata,"mapWidth",t.width/r),d(u.metadata,"mapHeight",t.height/r),d(u.metadata,"webglRenderer",t.renderer),d(u.metadata,"webglVendor",t.vendor),d(u.metadata,"sdkVersion",e),d(u.metadata,"sdkIdentifier","mapbox-gl-js"),u}(i);for(const t of a.metadata);for(const t of a.counters);for(const t of a.attributes);this.postEvent(n,a,(()=>{}),t)}},Ai=wi.postPerformanceEvent.bind(wi),Ci=new class extends mi{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(t,e,n,a){if(!i.API_URL||!i.SESSION_PATH)return;const r=hi(i.API_URL+i.SESSION_PATH);r.params.push(`sku=${e||""}`),r.params.push(`access_token=${a||i.ACCESS_TOKEN||""}`);const o={url:di(r),headers:{"Content-Type":"text/plain"}};this.pendingRequest=function(t,e){return ei(en(t,{method:"GET"}),e)}(o,(t=>{this.pendingRequest=null,n(t),this.saveEventData(),this.processRequests(a)}))}getSessionAPI(t,e,n,a){this.skuToken=e,this.errorCb=a,i.SESSION_PATH&&i.API_URL&&(n||i.ACCESS_TOKEN?this.queueRequest({id:t,timestamp:Date.now()},n):this.errorCb(new Error(ci)))}processRequests(t){if(this.pendingRequest||0===this.queue.length)return;const{id:e,timestamp:n}=this.queue.shift();e&&this.success[e]||this.getSession(n,this.skuToken,(t=>{t?this.errorCb(t):e&&(this.success[e]=!0)}),t)}remove(){this.errorCb=null}},Ei=Ci.getSessionAPI.bind(Ci),Ti=new Set;var Si={exports:{}},Mi=function(t,e){var n,i,a,r,o,s,l,c;for(i=t.length-(n=3&t.length),a=e,o=3432918353,s=461845907,c=0;c<i;)l=255&t.charCodeAt(c)|(255&t.charCodeAt(++c))<<8|(255&t.charCodeAt(++c))<<16|(255&t.charCodeAt(++c))<<24,++c,a=27492+(65535&(r=5*(65535&(a=(a^=l=(65535&(l=(l=(65535&l)*o+(((l>>>16)*o&65535)<<16)&4294967295)<<15|l>>>17))*s+(((l>>>16)*s&65535)<<16)&4294967295)<<13|a>>>19))+((5*(a>>>16)&65535)<<16)&4294967295))+((58964+(r>>>16)&65535)<<16);switch(l=0,n){case 3:l^=(255&t.charCodeAt(c+2))<<16;case 2:l^=(255&t.charCodeAt(c+1))<<8;case 1:a^=l=(65535&(l=(l=(65535&(l^=255&t.charCodeAt(c)))*o+(((l>>>16)*o&65535)<<16)&4294967295)<<15|l>>>17))*s+(((l>>>16)*s&65535)<<16)&4294967295}return a^=t.length,a=2246822507*(65535&(a^=a>>>16))+((2246822507*(a>>>16)&65535)<<16)&4294967295,a=3266489909*(65535&(a^=a>>>13))+((3266489909*(a>>>16)&65535)<<16)&4294967295,(a^=a>>>16)>>>0},ki=function(t,e){for(var n,i=t.length,a=e^i,r=0;i>=4;)n=1540483477*(65535&(n=255&t.charCodeAt(r)|(255&t.charCodeAt(++r))<<8|(255&t.charCodeAt(++r))<<16|(255&t.charCodeAt(++r))<<24))+((1540483477*(n>>>16)&65535)<<16),a=1540483477*(65535&a)+((1540483477*(a>>>16)&65535)<<16)^(n=1540483477*(65535&(n^=n>>>24))+((1540483477*(n>>>16)&65535)<<16)),i-=4,++r;switch(i){case 3:a^=(255&t.charCodeAt(r+2))<<16;case 2:a^=(255&t.charCodeAt(r+1))<<8;case 1:a=1540483477*(65535&(a^=255&t.charCodeAt(r)))+((1540483477*(a>>>16)&65535)<<16)}return a=1540483477*(65535&(a^=a>>>13))+((1540483477*(a>>>16)&65535)<<16),(a^=a>>>15)>>>0};Si.exports=Mi,Si.exports.murmur3=Mi,Si.exports.murmur2=ki;var Ii=d(Si.exports);function Pi(t,e,n){n[t]&&-1!==n[t].indexOf(e)||(n[t]=n[t]||[],n[t].push(e))}function zi(t,e,n){if(n&&n[t]){const i=n[t].indexOf(e);-1!==i&&n[t].splice(i,1)}}class Di{constructor(t,e={}){en(this,e),this.type=t}}class Li extends Di{constructor(t,e={}){super("error",en({error:t},e))}}class Bi{on(t,e){return this._listeners=this._listeners||{},Pi(t,e,this._listeners),this}off(t,e){return zi(t,e,this._listeners),zi(t,e,this._oneTimeListeners),this}once(t,e){return e?(this._oneTimeListeners=this._oneTimeListeners||{},Pi(t,e,this._oneTimeListeners),this):new Promise((e=>this.once(t,e)))}fire(t,e){"string"==typeof t&&(t=new Di(t,e||{}));const n=t.type;if(this.listens(n)){t.target=this;const e=this._listeners&&this._listeners[n]?this._listeners[n].slice():[];for(const n of e)n.call(this,t);const i=this._oneTimeListeners&&this._oneTimeListeners[n]?this._oneTimeListeners[n].slice():[];for(const e of i)zi(n,e,this._oneTimeListeners),e.call(this,t);const a=this._eventedParent;a&&(en(t,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),a.fire(t))}else t instanceof Li&&console.error(t.error);return this}listens(t){return!!(this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t))}setEventedParent(t,e){return this._eventedParent=t,this._eventedParentData=e,this}}t.F=void 0;var Oi={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function Ri(t){return(t=Math.round(t))<0?0:t>255?255:t}function Fi(t){return Ri("%"===t[t.length-1]?parseFloat(t)/100*255:parseInt(t))}function Ni(t){return(e="%"===t[t.length-1]?parseFloat(t)/100:parseFloat(t))<0?0:e>1?1:e;var e}function ji(t,e,n){return n<0?n+=1:n>1&&(n-=1),6*n<1?t+(e-t)*n*6:2*n<1?e:3*n<2?t+(e-t)*(2/3-n)*6:t}try{t.F={}.parseCSSColor=function(t){var e,n=t.replace(/ /g,"").toLowerCase();if(n in Oi)return Oi[n].slice();if("#"===n[0])return 4===n.length?(e=parseInt(n.substr(1),16))>=0&&e<=4095?[(3840&e)>>4|(3840&e)>>8,240&e|(240&e)>>4,15&e|(15&e)<<4,1]:null:7===n.length&&(e=parseInt(n.substr(1),16))>=0&&e<=16777215?[(16711680&e)>>16,(65280&e)>>8,255&e,1]:null;var i=n.indexOf("("),a=n.indexOf(")");if(-1!==i&&a+1===n.length){var r=n.substr(0,i),o=n.substr(i+1,a-(i+1)).split(","),s=1;switch(r){case"rgba":if(4!==o.length)return null;s=Ni(o.pop());case"rgb":return 3!==o.length?null:[Fi(o[0]),Fi(o[1]),Fi(o[2]),s];case"hsla":if(4!==o.length)return null;s=Ni(o.pop());case"hsl":if(3!==o.length)return null;var l=(parseFloat(o[0])%360+360)%360/360,c=Ni(o[1]),u=Ni(o[2]),h=u<=.5?u*(c+1):u+c-u*c,d=2*u-h;return[Ri(255*ji(d,h,l+1/3)),Ri(255*ji(d,h,l)),Ri(255*ji(d,h,l-1/3)),s];default:return null}}return null}}catch(t){}class Vi{constructor(t,e,n,i=1){this.r=t,this.g=e,this.b=n,this.a=i}static parse(e){if(!e)return;if(e instanceof Vi)return e;if("string"!=typeof e)return;const n=t.F(e);return n?new Vi(n[0]/255*n[3],n[1]/255*n[3],n[2]/255*n[3],n[3]):void 0}toString(){const[t,e,n,i]=0===this.a?[0,0,0,0]:[255*this.r/this.a,255*this.g/this.a,255*this.b/this.a,this.a];return`rgba(${Math.round(t)},${Math.round(e)},${Math.round(n)},${i})`}toRenderColor(t){const{r:e,g:n,b:i,a}=this;return new Ui(t,e,n,i,a)}}class Ui{constructor(t,e,n,i,a){if(t){const r=t.image.height,o=r*r;e=0===a?0:e/a*(r-1),n=0===a?0:n/a*(r-1),i=0===a?0:i/a*(r-1);const s=Math.floor(e),l=Math.floor(n),c=Math.floor(i),u=Math.ceil(e),h=Math.ceil(n),d=Math.ceil(i),p=e-s,f=n-l,m=i-c,g=t.image.data,_=4*(s+l*o+c*r),y=4*(s+l*o+d*r),x=4*(s+h*o+c*r),v=4*(s+h*o+d*r),b=4*(u+l*o+c*r),w=4*(u+l*o+d*r),A=4*(u+h*o+c*r),C=4*(u+h*o+d*r);if(_<0||C>=g.length)throw new Error("out of range");this.r=Gi(Gi(Gi(g[_],g[y],m),Gi(g[x],g[v],m),f),Gi(Gi(g[b],g[w],m),Gi(g[A],g[C],m),f),p)/255*a,this.g=Gi(Gi(Gi(g[_+1],g[y+1],m),Gi(g[x+1],g[v+1],m),f),Gi(Gi(g[b+1],g[w+1],m),Gi(g[A+1],g[C+1],m),f),p)/255*a,this.b=Gi(Gi(Gi(g[_+2],g[y+2],m),Gi(g[x+2],g[v+2],m),f),Gi(Gi(g[b+2],g[w+2],m),Gi(g[A+2],g[C+2],m),f),p)/255*a,this.a=a}else this.r=e,this.g=n,this.b=i,this.a=a}toArray(){const{r:t,g:e,b:n,a:i}=this;return 0===i?[0,0,0,0]:[255*t/i,255*e/i,255*n/i,i]}toArray01(){const{r:t,g:e,b:n,a:i}=this;return 0===i?[0,0,0,0]:[t/i,e/i,n/i,i]}toArray01Scaled(t){const{r:e,g:n,b:i,a}=this;return 0===a?[0,0,0]:[e/a*t,n/a*t,i/a*t]}toArray01PremultipliedAlpha(){const{r:t,g:e,b:n,a:i}=this;return[t,e,n,i]}toArray01Linear(){const{r:t,g:e,b:n,a:i}=this;return 0===i?[0,0,0,0]:[Math.pow(t/i,2.2),Math.pow(e/i,2.2),Math.pow(n/i,2.2),i]}}function Gi(t,e,n){return t*(1-n)+e*n}function qi(t,e,n){return t.map(((t,i)=>Gi(t,e[i],n)))}Vi.black=new Vi(0,0,0,1),Vi.white=new Vi(1,1,1,1),Vi.transparent=new Vi(0,0,0,0),Vi.red=new Vi(1,0,0,1),Vi.blue=new Vi(0,0,1,1);var $i=Object.freeze({__proto__:null,array:qi,color:function(t,e,n){return new Vi(Gi(t.r,e.r,n),Gi(t.g,e.g,n),Gi(t.b,e.b,n),Gi(t.a,e.a,n))},number:Gi});function Wi(t,...e){for(const n of e)for(const e in n)t[e]=n[e];return t}class Hi extends Error{constructor(t,e){super(e),this.message=e,this.key=t}}class Zi{constructor(t,e=[]){this.parent=t,this.bindings={};for(const[t,n]of e)this.bindings[t]=n}concat(t){return new Zi(this,t)}get(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(`${t} not found in scope.`)}has(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)}}const Yi={kind:"null"},Xi={kind:"number"},Ki={kind:"string"},Qi={kind:"boolean"},Ji={kind:"color"},ta={kind:"object"},ea={kind:"value"},na={kind:"collator"},ia={kind:"formatted"},aa={kind:"resolvedImage"};function ra(t,e){return{kind:"array",itemType:t,N:e}}function oa(t){if("array"===t.kind){const e=oa(t.itemType);return"number"==typeof t.N?`array<${e}, ${t.N}>`:"value"===t.itemType.kind?"array":`array<${e}>`}return t.kind}const sa=[Yi,Xi,Ki,Qi,Ji,ia,ta,ra(ea),aa];function la(t,e){if("error"===e.kind)return null;if("array"===t.kind){if("array"===e.kind&&(0===e.N&&"value"===e.itemType.kind||!la(t.itemType,e.itemType))&&("number"!=typeof t.N||t.N===e.N))return null}else{if(t.kind===e.kind)return null;if("value"===t.kind)for(const t of sa)if(!la(t,e))return null}return`Expected ${oa(t)} but found ${oa(e)} instead.`}function ca(t,e){return e.some((e=>e.kind===t.kind))}function ua(t,e){return e.some((e=>"null"===e?null===t:"array"===e?Array.isArray(t):"object"===e?t&&!Array.isArray(t)&&"object"==typeof t:e===typeof t))}class ha{constructor(t,e,n){this.sensitivity=t?e?"variant":"case":e?"accent":"base",this.locale=n,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(t,e){return this.collator.compare(t,e)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class da{constructor(t,e,n,i,a){this.text=t.normalize?t.normalize():t,this.image=e,this.scale=n,this.fontStack=i,this.textColor=a}}class pa{constructor(t){this.sections=t}static fromString(t){return new pa([new da(t,null,null,null,null)])}isEmpty(){return 0===this.sections.length||!this.sections.some((t=>0!==t.text.length||t.image&&0!==t.image.namePrimary.length))}static factory(t){return t instanceof pa?t:pa.fromString(t)}toString(){return 0===this.sections.length?"":this.sections.map((t=>t.text)).join("")}serialize(){const t=["format"];for(const e of this.sections){if(e.image){t.push(["image",e.image.namePrimary]);continue}t.push(e.text);const n={};e.fontStack&&(n["text-font"]=["literal",e.fontStack.split(",")]),e.scale&&(n["font-scale"]=e.scale),e.textColor&&(n["text-color"]=["rgba"].concat(e.textColor.toRenderColor(null).toArray())),t.push(n)}return t}}class fa{constructor(t){this.namePrimary=t.namePrimary,t.nameSecondary&&(this.nameSecondary=t.nameSecondary),this.available=t.available}toString(){return this.nameSecondary?`[${this.namePrimary},${this.nameSecondary}]`:this.namePrimary}static fromString(t,e){return t?new fa({namePrimary:t,nameSecondary:e,available:!1}):null}serialize(){return this.nameSecondary?["image",this.namePrimary,this.nameSecondary]:["image",this.namePrimary]}}function ma(t,e,n,i){return"number"==typeof t&&t>=0&&t<=255&&"number"==typeof e&&e>=0&&e<=255&&"number"==typeof n&&n>=0&&n<=255?void 0===i||"number"==typeof i&&i>=0&&i<=1?null:`Invalid rgba value [${[t,e,n,i].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${("number"==typeof i?[t,e,n,i]:[t,e,n]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function ga(t){if(null===t)return!0;if("string"==typeof t)return!0;if("boolean"==typeof t)return!0;if("number"==typeof t)return!0;if(t instanceof Vi)return!0;if(t instanceof ha)return!0;if(t instanceof pa)return!0;if(t instanceof fa)return!0;if(Array.isArray(t)){for(const e of t)if(!ga(e))return!1;return!0}if("object"==typeof t){for(const e in t)if(!ga(t[e]))return!1;return!0}return!1}function _a(t){if(null===t)return Yi;if("string"==typeof t)return Ki;if("boolean"==typeof t)return Qi;if("number"==typeof t)return Xi;if(t instanceof Vi)return Ji;if(t instanceof ha)return na;if(t instanceof pa)return ia;if(t instanceof fa)return aa;if(Array.isArray(t)){const e=t.length;let n;for(const e of t){const t=_a(e);if(n){if(n===t)continue;n=ea;break}n=t}return ra(n||ea,e)}return ta}function ya(t){const e=typeof t;return null===t?"":"string"===e||"number"===e||"boolean"===e?String(t):t instanceof Vi||t instanceof pa||t instanceof fa?t.toString():JSON.stringify(t)}class xa{constructor(t,e){this.type=t,this.value=e}static parse(t,e){if(2!==t.length)return e.error(`'literal' expression requires exactly one argument, but found ${t.length-1} instead.`);if(!ga(t[1]))return e.error("invalid value");const n=t[1];let i=_a(n);const a=e.expectedType;return"array"!==i.kind||0!==i.N||!a||"array"!==a.kind||"number"==typeof a.N&&0!==a.N||(i=a),new xa(i,n)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof Vi?["rgba"].concat(this.value.toRenderColor(null).toArray()):this.value instanceof pa?this.value.serialize():this.value}}class va{constructor(t){this.name="ExpressionEvaluationError",this.message=t}toJSON(){return this.message}}const ba={string:Ki,number:Xi,boolean:Qi,object:ta};class wa{constructor(t,e){this.type=t,this.args=e}static parse(t,e){if(t.length<2)return e.error("Expected at least one argument.");let n,i=1;const a=t[0];if("array"===a){let a,r;if(t.length>2){const n=t[1];if("string"!=typeof n||!(n in ba)||"object"===n)return e.error('The item type argument of "array" must be one of string, number, boolean',1);a=ba[n],i++}else a=ea;if(t.length>3){if(null!==t[2]&&("number"!=typeof t[2]||t[2]<0||t[2]!==Math.floor(t[2])))return e.error('The length argument to "array" must be a positive integer literal',2);r=t[2],i++}n=ra(a,r)}else n=ba[a];const r=[];for(;i<t.length;i++){const n=e.parse(t[i],i,ea);if(!n)return null;r.push(n)}return new wa(n,r)}evaluate(t){for(let e=0;e<this.args.length;e++){const n=this.args[e].evaluate(t);if(!la(this.type,_a(n)))return n;if(e===this.args.length-1)throw new va(`Expected value to be of type ${oa(this.type)}, but found ${oa(_a(n))} instead.`)}return null}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every((t=>t.outputDefined()))}serialize(){const t=this.type,e=[t.kind];if("array"===t.kind){const n=t.itemType;if("string"===n.kind||"number"===n.kind||"boolean"===n.kind){e.push(n.kind);const i=t.N;("number"==typeof i||this.args.length>1)&&e.push(i)}}return e.concat(this.args.map((t=>t.serialize())))}}class Aa{constructor(t){this.type=ia,this.sections=t}static parse(t,e){if(t.length<2)return e.error("Expected at least one argument.");const n=t[1];if(!Array.isArray(n)&&"object"==typeof n)return e.error("First argument must be an image or text section.");const i=[];let a=!1;for(let n=1;n<=t.length-1;++n){const r=t[n];if(a&&"object"==typeof r&&!Array.isArray(r)){a=!1;let t=null;if(r["font-scale"]&&(t=e.parse(r["font-scale"],1,Xi),!t))return null;let n=null;if(r["text-font"]&&(n=e.parse(r["text-font"],1,ra(Ki)),!n))return null;let o=null;if(r["text-color"]&&(o=e.parse(r["text-color"],1,Ji),!o))return null;const s=i[i.length-1];s.scale=t,s.font=n,s.textColor=o}else{const r=e.parse(t[n],1,ea);if(!r)return null;const o=r.type.kind;if("string"!==o&&"value"!==o&&"null"!==o&&"resolvedImage"!==o)return e.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");a=!0,i.push({content:r,scale:null,font:null,textColor:null})}}return new Aa(i)}evaluate(t){return new pa(this.sections.map((e=>{const n=e.content.evaluate(t);return _a(n)===aa?new da("",n,null,null,null):new da(ya(n),null,e.scale?e.scale.evaluate(t):null,e.font?e.font.evaluate(t).join(","):null,e.textColor?e.textColor.evaluate(t):null)})))}eachChild(t){for(const e of this.sections)t(e.content),e.scale&&t(e.scale),e.font&&t(e.font),e.textColor&&t(e.textColor)}outputDefined(){return!1}serialize(){const t=["format"];for(const e of this.sections){t.push(e.content.serialize());const n={};e.scale&&(n["font-scale"]=e.scale.serialize()),e.font&&(n["text-font"]=e.font.serialize()),e.textColor&&(n["text-color"]=e.textColor.serialize()),t.push(n)}return t}}class Ca{constructor(t,e){this.type=aa,this.inputPrimary=t,this.inputSecondary=e}static parse(t,e){if(t.length<2)return e.error("Expected two or more arguments.");const n=e.parse(t[1],1,Ki);if(!n)return e.error("No image name provided.");if(2===t.length)return new Ca(n);const i=e.parse(t[2],1,Ki);return i?new Ca(n,i):e.error("Secondary image variant is not a string.")}evaluate(t){const e=fa.fromString(this.inputPrimary.evaluate(t),this.inputSecondary?this.inputSecondary.evaluate(t):void 0);return e&&t.availableImages&&(e.available=t.availableImages.indexOf(e.namePrimary)>-1,e.nameSecondary&&e.available&&t.availableImages&&(e.available=t.availableImages.indexOf(e.nameSecondary)>-1)),e}eachChild(t){t(this.inputPrimary),this.inputSecondary&&t(this.inputSecondary)}outputDefined(){return!1}serialize(){return this.inputSecondary?["image",this.inputPrimary.serialize(),this.inputSecondary.serialize()]:["image",this.inputPrimary.serialize()]}}function Ea(t){return t instanceof Number?"number":t instanceof String?"string":t instanceof Boolean?"boolean":Array.isArray(t)?"array":null===t?"null":typeof t}const Ta={"to-boolean":Qi,"to-color":Ji,"to-number":Xi,"to-string":Ki};class Sa{constructor(t,e){this.type=t,this.args=e}static parse(t,e){if(t.length<2)return e.error("Expected at least one argument.");const n=t[0],i=[];let a=Yi;if("to-array"===n){if(!Array.isArray(t[1]))return null;const n=t[1].length;if(e.expectedType){if("array"!==e.expectedType.kind)return e.error(`Expected ${e.expectedType.kind} but found array.`);a=ra(e.expectedType.itemType,n)}else{if(!(n>0&&ga(t[1][0])))return null;a=ra(_a(t[1][0]),n)}for(let r=0;r<n;r++){const n=t[1][r];let o;if("array"===Ea(n))o=e.parse(n,void 0,a.itemType);else{const t=Ea(n);if(t!==a.itemType.kind)return e.error(`Expected ${a.itemType.kind} but found ${t}.`);o=e.registry.literal.parse(["literal",void 0===n?null:n],e)}if(!o)return null;i.push(o)}}else{if(("to-boolean"===n||"to-string"===n)&&2!==t.length)return e.error("Expected one argument.");a=Ta[n];for(let n=1;n<t.length;n++){const a=e.parse(t[n],n,ea);if(!a)return null;i.push(a)}}return new Sa(a,i)}evaluate(t){if("boolean"===this.type.kind)return Boolean(this.args[0].evaluate(t));if("color"===this.type.kind){let e,n;for(const i of this.args){if(e=i.evaluate(t),n=null,e instanceof Vi)return e;if("string"==typeof e){const n=t.parseColor(e);if(n)return n}else if(Array.isArray(e)&&(n=e.length<3||e.length>4?`Invalid rbga value ${JSON.stringify(e)}: expected an array containing either three or four numeric values.`:ma(e[0],e[1],e[2],e[3]),!n))return new Vi(e[0]/255,e[1]/255,e[2]/255,e[3])}throw new va(n||`Could not parse color from value '${"string"==typeof e?e:String(JSON.stringify(e))}'`)}if("number"===this.type.kind){let e=null;for(const n of this.args){if(e=n.evaluate(t),null===e)return 0;const i=Number(e);if(!isNaN(i))return i}throw new va(`Could not convert ${JSON.stringify(e)} to number.`)}return"formatted"===this.type.kind?pa.fromString(ya(this.args[0].evaluate(t))):"resolvedImage"===this.type.kind?fa.fromString(ya(this.args[0].evaluate(t))):"array"===this.type.kind?this.args.map((e=>e.evaluate(t))):ya(this.args[0].evaluate(t))}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every((t=>t.outputDefined()))}serialize(){if("formatted"===this.type.kind)return new Aa([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if("resolvedImage"===this.type.kind)return new Ca(this.args[0]).serialize();const t="array"===this.type.kind?[]:[`to-${this.type.kind}`];return this.eachChild((e=>{t.push(e.serialize())})),t}}const Ma=["Unknown","Point","LineString","Polygon"];class ka{constructor(t,e){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null,this.scope=t,this.options=e}id(){return this.feature&&void 0!==this.feature.id?this.feature.id:null}geometryType(){return this.feature?"number"==typeof this.feature.type?Ma[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}measureLight(t){return this.globals.brightness||0}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const t=this.featureDistanceData.center,e=this.featureDistanceData.scale,{x:n,y:i}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(n*e-t[0])+this.featureDistanceData.bearing[1]*(i*e-t[1])}return 0}parseColor(t){let e=this._parseColorCache[t];return e||(e=this._parseColorCache[t]=Vi.parse(t)),e}getConfig(t){return this.options?this.options.get(t):null}}class Ia{constructor(t,e,n,i,a){this.name=t,this.type=e,this._evaluate=n,this.args=i,this._overloadIndex=a}evaluate(t){if(!this._evaluate){const t=Ia.definitions[this.name];this._evaluate=Array.isArray(t)?t[2]:t.overloads[this._overloadIndex][1]}return this._evaluate(t,this.args)}eachChild(t){this.args.forEach(t)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map((t=>t.serialize())))}static parse(t,e){const n=t[0],i=Ia.definitions[n];if(!i)return e.error(`Unknown expression "${n}". If you wanted a literal array, use ["literal", [...]].`,0);const a=Array.isArray(i)?i[0]:i.type,r=Array.isArray(i)?[[i[1],i[2]]]:i.overloads,o=[];let s=null,l=-1;for(const[i,c]of r){if(Array.isArray(i)&&i.length!==t.length-1)continue;o.push(i),l++,s=new Xr(e.registry,e.path,null,e.scope,void 0,e._scope,e.options);const r=[];let u=!1;for(let e=1;e<t.length;e++){const n=t[e],a=Array.isArray(i)?i[e-1]:i.type,o=s.parse(n,1+r.length,a);if(!o){u=!0;break}r.push(o)}if(!u)if(Array.isArray(i)&&i.length!==r.length)s.error(`Expected ${i.length} arguments, but found ${r.length} instead.`);else{for(let t=0;t<r.length;t++){const e=Array.isArray(i)?i[t]:i.type,n=r[t];s.concat(t+1).checkSubtype(e,n.type)}if(0===s.errors.length)return new Ia(n,a,c,r,l)}}if(1===o.length)e.errors.push(...s.errors);else{const n=(o.length?o:r.map((([t])=>t))).map(Pa).join(" | "),i=[];for(let n=1;n<t.length;n++){const a=e.parse(t[n],1+i.length);if(!a)return null;i.push(oa(a.type))}e.error(`Expected arguments of type ${n}, but found (${i.join(", ")}) instead.`)}return null}static register(t,e){Ia.definitions=e;for(const n in e)t[n]=Ia}}function Pa(t){return Array.isArray(t)?`(${t.map(oa).join(", ")})`:`(${oa(t.type)}...)`}class za{constructor(t,e,n){this.type=na,this.locale=n,this.caseSensitive=t,this.diacriticSensitive=e}static parse(t,e){if(2!==t.length)return e.error("Expected one argument.");const n=t[1];if("object"!=typeof n||Array.isArray(n))return e.error("Collator options argument must be an object.");const i=e.parse(void 0!==n["case-sensitive"]&&n["case-sensitive"],1,Qi);if(!i)return null;const a=e.parse(void 0!==n["diacritic-sensitive"]&&n["diacritic-sensitive"],1,Qi);if(!a)return null;let r=null;return n.locale&&(r=e.parse(n.locale,1,Ki),!r)?null:new za(i,a,r)}evaluate(t){return new ha(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)}eachChild(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)}outputDefined(){return!1}serialize(){const t={};return t["case-sensitive"]=this.caseSensitive.serialize(),t["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(t.locale=this.locale.serialize()),["collator",t]}}var Da={exports:{}};Da.exports=function(){function t(n,i,a,r,o){for(;r>a;){if(r-a>600){var s=r-a+1,l=i-a+1,c=Math.log(s),u=.5*Math.exp(2*c/3),h=.5*Math.sqrt(c*u*(s-u)/s)*(l-s/2<0?-1:1);t(n,i,Math.max(a,Math.floor(i-l*u/s+h)),Math.min(r,Math.floor(i+(s-l)*u/s+h)),o)}var d=n[i],p=a,f=r;for(e(n,a,i),o(n[r],d)>0&&e(n,a,r);p<f;){for(e(n,p,f),p++,f--;o(n[p],d)<0;)p++;for(;o(n[f],d)>0;)f--}0===o(n[a],d)?e(n,a,f):e(n,++f,r),f<=i&&(a=f+1),i<=f&&(r=f-1)}}function e(t,e,n){var i=t[e];t[e]=t[n],t[n]=i}function n(t,e){return t<e?-1:t>e?1:0}return function(e,i,a,r,o){t(e,i,a||0,r||e.length-1,o||n)}}();var La=d(Da.exports);function Ba(t){let e=0;for(let n,i,a=0,r=t.length,o=r-1;a<r;o=a++)n=t[a],i=t[o],e+=(i.x-n.x)*(n.y+i.y);return e}function Oa(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[2]=Math.max(t[2],e[0]),t[3]=Math.max(t[3],e[1])}function Ra(t,e){return!(t[0]<=e[0]||t[2]>=e[2]||t[1]<=e[1]||t[3]>=e[3])}function Fa(t,e,n){const i=t[0]-e[0],a=t[1]-e[1],r=t[0]-n[0],o=t[1]-n[1];return i*o-r*a==0&&i*r<=0&&a*o<=0}function Na(t,e,n=!1){let i=!1;for(let s=0,l=e.length;s<l;s++){const l=e[s];for(let e=0,s=l.length,c=s-1;e<s;c=e++){const s=l[c],u=l[e];if(Fa(t,s,u))return n;(r=s)[1]>(a=t)[1]!=(o=u)[1]>a[1]&&a[0]<(o[0]-r[0])*(a[1]-r[1])/(o[1]-r[1])+r[0]&&(i=!i)}}var a,r,o;return i}function ja(t,e,n,i){const a=i[0]-n[0],r=i[1]-n[1],o=(t[0]-n[0])*r-a*(t[1]-n[1]),s=(e[0]-n[0])*r-a*(e[1]-n[1]);return o>0&&s<0||o<0&&s>0}function Va(t,e,n,i){return 0!=(a=[i[0]-n[0],i[1]-n[1]])[0]*(r=[e[0]-t[0],e[1]-t[1]])[1]-a[1]*r[0]&&!(!ja(t,e,n,i)||!ja(n,i,t,e));var a,r}const Ua=8192;function Ga(t,e){const n=(180+t[0])/360,i=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t[1]*Math.PI/360)))/360,a=Math.pow(2,e.z);return[Math.round(n*a*Ua),Math.round(i*a*Ua)]}function qa(t,e){for(let n=0;n<e.length;n++)if(Na(t,e[n]))return!0;return!1}function $a(t,e,n){for(const i of n)for(let n=0,a=i.length,r=a-1;n<a;r=n++)if(Va(t,e,i[r],i[n]))return!0;return!1}function Wa(t,e){for(let n=0;n<t.length;++n)if(!Na(t[n],e))return!1;for(let n=0;n<t.length-1;++n)if($a(t[n],t[n+1],e))return!1;return!0}function Ha(t,e){for(let n=0;n<e.length;n++)if(Wa(t,e[n]))return!0;return!1}function Za(t,e,n){const i=[];for(let a=0;a<t.length;a++){const r=[];for(let i=0;i<t[a].length;i++){const o=Ga(t[a][i],n);Oa(e,o),r.push(o)}i.push(r)}return i}function Ya(t,e,n){const i=[];for(let a=0;a<t.length;a++){const r=Za(t[a],e,n);i.push(r)}return i}function Xa(t,e,n,i){if(t[0]<n[0]||t[0]>n[2]){const e=.5*i;let a=t[0]-n[0]>e?-i:n[0]-t[0]>e?i:0;0===a&&(a=t[0]-n[2]>e?-i:n[2]-t[0]>e?i:0),t[0]+=a}Oa(e,t)}function Ka(t,e,n,i){const a=Math.pow(2,i.z)*Ua,r=[i.x*Ua,i.y*Ua],o=[];if(!t)return o;for(const i of t)for(const t of i){const i=[t.x+r[0],t.y+r[1]];Xa(i,e,n,a),o.push(i)}return o}function Qa(t,e,n,i){const a=Math.pow(2,i.z)*Ua,r=[i.x*Ua,i.y*Ua],o=[];if(!t)return o;for(const n of t){const t=[];for(const i of n){const n=[i.x+r[0],i.y+r[1]];Oa(e,n),t.push(n)}o.push(t)}if(e[2]-e[0]<=a/2){(s=e)[0]=s[1]=1/0,s[2]=s[3]=-1/0;for(const t of o)for(const i of t)Xa(i,e,n,a)}var s;return o}class Ja{constructor(t,e){this.type=Qi,this.geojson=t,this.geometries=e}static parse(t,e){if(2!==t.length)return e.error(`'within' expression requires exactly one argument, but found ${t.length-1} instead.`);if(ga(t[1])){const e=t[1];if("FeatureCollection"===e.type)for(let t=0;t<e.features.length;++t){const n=e.features[t].geometry.type;if("Polygon"===n||"MultiPolygon"===n)return new Ja(e,e.features[t].geometry)}else if("Feature"===e.type){const t=e.geometry.type;if("Polygon"===t||"MultiPolygon"===t)return new Ja(e,e.geometry)}else if("Polygon"===e.type||"MultiPolygon"===e.type)return new Ja(e,e)}return e.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(null!=t.geometry()&&null!=t.canonicalID()){if("Point"===t.geometryType())return function(t,e){const n=[1/0,1/0,-1/0,-1/0],i=[1/0,1/0,-1/0,-1/0],a=t.canonicalID();if(!a)return!1;if("Polygon"===e.type){const r=Za(e.coordinates,i,a),o=Ka(t.geometry(),n,i,a);if(!Ra(n,i))return!1;for(const t of o)if(!Na(t,r))return!1}if("MultiPolygon"===e.type){const r=Ya(e.coordinates,i,a),o=Ka(t.geometry(),n,i,a);if(!Ra(n,i))return!1;for(const t of o)if(!qa(t,r))return!1}return!0}(t,this.geometries);if("LineString"===t.geometryType())return function(t,e){const n=[1/0,1/0,-1/0,-1/0],i=[1/0,1/0,-1/0,-1/0],a=t.canonicalID();if(!a)return!1;if("Polygon"===e.type){const r=Za(e.coordinates,i,a),o=Qa(t.geometry(),n,i,a);if(!Ra(n,i))return!1;for(const t of o)if(!Wa(t,r))return!1}if("MultiPolygon"===e.type){const r=Ya(e.coordinates,i,a),o=Qa(t.geometry(),n,i,a);if(!Ra(n,i))return!1;for(const t of o)if(!Ha(t,r))return!1}return!0}(t,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}const tr={kilometers:1,miles:1e3/1609.344,nauticalmiles:1e3/1852,meters:1e3,metres:1e3,yards:1e3/.9144,feet:1e3/.3048,inches:1e3/.0254},er=1/298.257223563,nr=er*(2-er),ir=Math.PI/180;class ar{static fromTile(t,e,n){const i=Math.PI*(1-2*(t+.5)/Math.pow(2,e)),a=Math.atan(.5*(Math.exp(i)-Math.exp(-i)))/ir;return new ar(a,n)}static get units(){return tr}constructor(t,e){if(void 0===t)throw new Error("No latitude given.");if(e&&!tr[e])throw new Error(`Unknown unit ${e}. Use one of: ${Object.keys(tr).join(", ")}`);const n=6378.137*ir*(e?tr[e]:1),i=Math.cos(t*ir),a=1/(1-nr*(1-i*i)),r=Math.sqrt(a);this.kx=n*r*i,this.ky=n*r*a*(1-nr)}distance(t,e){const n=sr(t[0]-e[0])*this.kx,i=(t[1]-e[1])*this.ky;return Math.sqrt(n*n+i*i)}bearing(t,e){const n=sr(e[0]-t[0])*this.kx;return Math.atan2(n,(e[1]-t[1])*this.ky)/ir}destination(t,e,n){const i=n*ir;return this.offset(t,Math.sin(i)*e,Math.cos(i)*e)}offset(t,e,n){return[t[0]+e/this.kx,t[1]+n/this.ky]}lineDistance(t){let e=0;for(let n=0;n<t.length-1;n++)e+=this.distance(t[n],t[n+1]);return e}area(t){let e=0;for(let n=0;n<t.length;n++){const i=t[n];for(let t=0,a=i.length,r=a-1;t<a;r=t++)e+=sr(i[t][0]-i[r][0])*(i[t][1]+i[r][1])*(n?-1:1)}return Math.abs(e)/2*this.kx*this.ky}along(t,e){let n=0;if(e<=0)return t[0];for(let i=0;i<t.length-1;i++){const a=t[i],r=t[i+1],o=this.distance(a,r);if(n+=o,n>e)return or(a,r,(e-(n-o))/o)}return t[t.length-1]}pointToSegmentDistance(t,e,n){let[i,a]=e,r=sr(n[0]-i)*this.kx,o=(n[1]-a)*this.ky;if(0!==r||0!==o){const e=(sr(t[0]-i)*this.kx*r+(t[1]-a)*this.ky*o)/(r*r+o*o);e>1?(i=n[0],a=n[1]):e>0&&(i+=r/this.kx*e,a+=o/this.ky*e)}return r=sr(t[0]-i)*this.kx,o=(t[1]-a)*this.ky,Math.sqrt(r*r+o*o)}pointOnLine(t,e){let n=1/0,i=t[0][0],a=t[0][1],r=0,o=0;for(let s=0;s<t.length-1;s++){let l=t[s][0],c=t[s][1],u=sr(t[s+1][0]-l)*this.kx,h=(t[s+1][1]-c)*this.ky,d=0;0===u&&0===h||(d=(sr(e[0]-l)*this.kx*u+(e[1]-c)*this.ky*h)/(u*u+h*h),d>1?(l=t[s+1][0],c=t[s+1][1]):d>0&&(l+=u/this.kx*d,c+=h/this.ky*d)),u=sr(e[0]-l)*this.kx,h=(e[1]-c)*this.ky;const p=u*u+h*h;p<n&&(n=p,i=l,a=c,r=s,o=d)}return{point:[i,a],index:r,t:Math.max(0,Math.min(1,o))}}lineSlice(t,e,n){let i=this.pointOnLine(n,t),a=this.pointOnLine(n,e);if(i.index>a.index||i.index===a.index&&i.t>a.t){const t=i;i=a,a=t}const r=[i.point],o=i.index+1,s=a.index;!rr(n[o],r[0])&&o<=s&&r.push(n[o]);for(let t=o+1;t<=s;t++)r.push(n[t]);return rr(n[s],a.point)||r.push(a.point),r}lineSliceAlong(t,e,n){let i=0;const a=[];for(let r=0;r<n.length-1;r++){const o=n[r],s=n[r+1],l=this.distance(o,s);if(i+=l,i>t&&0===a.length&&a.push(or(o,s,(t-(i-l))/l)),i>=e)return a.push(or(o,s,(e-(i-l))/l)),a;i>t&&a.push(s)}return a}bufferPoint(t,e){const n=e/this.ky,i=e/this.kx;return[t[0]-i,t[1]-n,t[0]+i,t[1]+n]}bufferBBox(t,e){const n=e/this.ky,i=e/this.kx;return[t[0]-i,t[1]-n,t[2]+i,t[3]+n]}insideBBox(t,e){return sr(t[0]-e[0])>=0&&sr(t[0]-e[2])<=0&&t[1]>=e[1]&&t[1]<=e[3]}}function rr(t,e){return t[0]===e[0]&&t[1]===e[1]}function or(t,e,n){const i=sr(e[0]-t[0]);return[t[0]+i*n,t[1]+(e[1]-t[1])*n]}function sr(t){for(;t<-180;)t+=360;for(;t>180;)t-=360;return t}var lr={exports:{}};!function(t,e){t.exports=function(){var t=function(t,n){if(void 0===t&&(t=[]),void 0===n&&(n=e),this.data=t,this.length=this.data.length,this.compare=n,this.length>0)for(var i=(this.length>>1)-1;i>=0;i--)this._down(i)};function e(t,e){return t<e?-1:t>e?1:0}return t.prototype.push=function(t){this.data.push(t),this.length++,this._up(this.length-1)},t.prototype.pop=function(){if(0!==this.length){var t=this.data[0],e=this.data.pop();return this.length--,this.length>0&&(this.data[0]=e,this._down(0)),t}},t.prototype.peek=function(){return this.data[0]},t.prototype._up=function(t){for(var e=this.data,n=this.compare,i=e[t];t>0;){var a=t-1>>1,r=e[a];if(n(i,r)>=0)break;e[t]=r,t=a}e[t]=i},t.prototype._down=function(t){for(var e=this.data,n=this.compare,i=this.length>>1,a=e[t];t<i;){var r=1+(t<<1),o=e[r],s=r+1;if(s<this.length&&n(e[s],o)<0&&(r=s,o=e[s]),n(o,a)>=0)break;e[t]=o,t=r}e[t]=a},t}()}(lr);var cr=d(lr.exports),ur=8192;function hr(t,e){return e.dist-t.dist}const dr=100,pr=50;function fr(t){const e=[1/0,1/0,-1/0,-1/0];if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function mr(t){return t[1]-t[0]+1}function gr(t,e){const n=t[1]>=t[0]&&t[1]<e;return n||console.warn("Distance Expression: Index is out of range"),n}function _r(t,e){if(t[0]>t[1])return[null,null];const n=mr(t);if(e){if(2===n)return[t,null];const e=Math.floor(n/2);return[[t[0],t[0]+e],[t[0]+e,t[1]]]}{if(1===n)return[t,null];const e=Math.floor(n/2)-1;return[[t[0],t[0]+e],[t[0]+e+1,t[1]]]}}function yr(t,e){const n=[1/0,1/0,-1/0,-1/0];if(!gr(e,t.length))return n;for(let i=e[0];i<=e[1];++i)Oa(n,t[i]);return n}function xr(t){const e=[1/0,1/0,-1/0,-1/0];for(let n=0;n<t.length;++n)for(let i=0;i<t[n].length;++i)Oa(e,t[n][i]);return e}function vr(t,e,n){if(fr(t)||fr(e))return NaN;let i=0,a=0;return t[2]<e[0]&&(i=e[0]-t[2]),t[0]>e[2]&&(i=t[0]-e[2]),t[1]>e[3]&&(a=t[1]-e[3]),t[3]<e[1]&&(a=e[1]-t[3]),n.distance([0,0],[i,a])}function br(t){return 360*t-180}function wr(t){return 360/Math.PI*Math.atan(Math.exp((180-360*t)*Math.PI/180))-90}function Ar(t,e){const n=Math.pow(2,e.z),i=(t.y/ur+e.y)/n;return[br((t.x/ur+e.x)/n),wr(i)]}function Cr(t,e){const n=[];for(let i=0;i<t.length;++i)n.push(Ar(t[i],e));return n}function Er(t,e,n){const i=n.pointOnLine(e,t).point;return n.distance(t,i)}function Tr(t,e,n,i,a){const r=n.slice(i[0],i[1]+1);let o=1/0;for(let n=e[0];n<=e[1];++n)if(0===(o=Math.min(o,Er(t[n],r,a))))return 0;return o}function Sr(t,e,n,i,a){const r=Math.min(a.pointToSegmentDistance(t,n,i),a.pointToSegmentDistance(e,n,i)),o=Math.min(a.pointToSegmentDistance(n,t,e),a.pointToSegmentDistance(i,t,e));return Math.min(r,o)}function Mr(t,e,n,i,a){if(!gr(e,t.length)||!gr(i,n.length))return NaN;let r=1/0;for(let o=e[0];o<e[1];++o)for(let e=i[0];e<i[1];++e){if(Va(t[o],t[o+1],n[e],n[e+1]))return 0;r=Math.min(r,Sr(t[o],t[o+1],n[e],n[e+1],a))}return r}function kr(t,e,n,i,a){if(!gr(e,t.length)||!gr(i,n.length))return NaN;let r=1/0;for(let o=e[0];o<=e[1];++o)for(let e=i[0];e<=i[1];++e)if(0===(r=Math.min(r,a.distance(t[o],n[e]))))return r;return r}function Ir(t,e,n){if(Na(t,e,!0))return 0;let i=1/0;for(const a of e){const e=a.length;if(e<2)return console.warn("Distance Expression: Invalid polygon!"),NaN;if(a[0]!==a[e-1]&&0===(i=Math.min(i,n.pointToSegmentDistance(t,a[e-1],a[0]))))return i;if(0===(i=Math.min(i,Er(t,a,n))))return i}return i}function Pr(t,e,n,i){if(!gr(e,t.length))return NaN;for(let i=e[0];i<=e[1];++i)if(Na(t[i],n,!0))return 0;let a=1/0;for(let r=e[0];r<e[1];++r)for(const e of n)for(let n=0,o=e.length,s=o-1;n<o;s=n++){if(Va(t[r],t[r+1],e[s],e[n]))return 0;a=Math.min(a,Sr(t[r],t[r+1],e[s],e[n],i))}return a}function zr(t,e){for(const n of t)for(let t=0;t<=n.length-1;++t)if(Na(n[t],e,!0))return!0;return!1}function Dr(t,e,n,i=1/0){const a=xr(t),r=xr(e);if(i!==1/0&&vr(a,r,n)>=i)return i;if(Ra(a,r)){if(zr(t,e))return 0}else if(zr(e,t))return 0;let o=i;for(const i of t)for(let t=0,a=i.length,r=a-1;t<a;r=t++)for(const a of e)for(let e=0,s=a.length,l=s-1;e<s;l=e++){if(Va(i[r],i[t],a[l],a[e]))return 0;o=Math.min(o,Sr(i[r],i[t],a[l],a[e],n))}return o}function Lr(t,e,n,i,a,r,o){if(null===r||null===o)return;const s=vr(yr(i,r),yr(a,o),n);s<e&&t.push({dist:s,range1:r,range2:o})}function Br(t,e,n,i,a=1/0){let r=Math.min(i.distance(t[0],n[0][0]),a);if(0===r)return r;const o=new cr([{dist:0,range1:[0,t.length-1],range2:[0,0]}],hr),s=e?pr:dr,l=xr(n);for(;o.length;){const a=o.pop();if(a.dist>=r)continue;const c=a.range1;if(mr(c)<=s){if(!gr(c,t.length))return NaN;if(e){const e=Pr(t,c,n,i);if(0===(r=Math.min(r,e)))return r}else for(let e=c[0];e<=c[1];++e){const a=Ir(t[e],n,i);if(0===(r=Math.min(r,a)))return r}}else{const n=_r(c,e);if(null!==n[0]){const e=vr(yr(t,n[0]),l,i);e<r&&o.push({dist:e,range1:n[0],range2:[0,0]})}if(null!==n[1]){const e=vr(yr(t,n[1]),l,i);e<r&&o.push({dist:e,range1:n[1],range2:[0,0]})}}}return r}function Or(t,e,n,i,a,r=1/0){let o=Math.min(r,a.distance(t[0],n[0]));if(0===o)return o;const s=new cr([{dist:0,range1:[0,t.length-1],range2:[0,n.length-1]}],hr),l=e?pr:dr,c=i?pr:dr;for(;s.length;){const r=s.pop();if(r.dist>=o)continue;const u=r.range1,h=r.range2;if(mr(u)<=l&&mr(h)<=c){if(!gr(u,t.length)||!gr(h,n.length))return NaN;if(e&&i?o=Math.min(o,Mr(t,u,n,h,a)):e||i?e&&!i?o=Math.min(o,Tr(n,h,t,u,a)):!e&&i&&(o=Math.min(o,Tr(t,u,n,h,a))):o=Math.min(o,kr(t,u,n,h,a)),0===o)return o}else{const r=_r(u,e),l=_r(h,i);Lr(s,o,a,t,n,r[0],l[0]),Lr(s,o,a,t,n,r[0],l[1]),Lr(s,o,a,t,n,r[1],l[0]),Lr(s,o,a,t,n,r[1],l[1])}}return o}function Rr(t,e,n,i,a=1/0){let r=a;const o=yr(t,[0,t.length-1]);for(const a of n)if(!(r!==1/0&&vr(o,yr(a,[0,a.length-1]),i)>=r)&&(r=Math.min(r,Or(t,e,a,!0,i,r)),0===r))return r;return r}function Fr(t,e,n,i,a=1/0){let r=a;const o=yr(t,[0,t.length-1]);for(const a of n){if(r!==1/0&&vr(o,xr(a),i)>=r)continue;const n=Br(t,e,a,i,r);if(isNaN(n))return n;if(0===(r=Math.min(r,n)))return r}return r}function Nr(t){return"Point"===t||"MultiPoint"===t||"LineString"===t||"MultiLineString"===t||"Polygon"===t||"MultiPolygon"===t}class jr{constructor(t,e){this.type=Xi,this.geojson=t,this.geometries=e}static parse(t,e){if(2!==t.length)return e.error(`'distance' expression requires either one argument, but found ' ${t.length-1} instead.`);if(ga(t[1])){const e=t[1];if("FeatureCollection"===e.type){for(let t=0;t<e.features.length;++t)if(Nr(e.features[t].geometry.type))return new jr(e,e.features[t].geometry)}else if("Feature"===e.type){if(Nr(e.geometry.type))return new jr(e,e.geometry)}else if(Nr(e.type))return new jr(e,e)}return e.error("'distance' expression needs to be an array with format ['Distance', GeoJSONObj].")}evaluate(t){const e=t.geometry(),n=t.canonicalID();if(null!=e&&null!=n){if("Point"===t.geometryType())return function(t,e,n){const i=[];for(const n of t)for(const t of n)i.push(Ar(t,e));const a=new ar(i[0][1],"meters");return"Point"===n.type||"MultiPoint"===n.type||"LineString"===n.type?Or(i,!1,"Point"===n.type?[n.coordinates]:n.coordinates,"LineString"===n.type,a):"MultiLineString"===n.type?Rr(i,!1,n.coordinates,a):"Polygon"===n.type||"MultiPolygon"===n.type?Fr(i,!1,"Polygon"===n.type?[n.coordinates]:n.coordinates,a):null}(e,n,this.geometries);if("LineString"===t.geometryType())return function(t,e,n){const i=[];for(const n of t){const t=[];for(const i of n)t.push(Ar(i,e));i.push(t)}const a=new ar(i[0][0][1],"meters");if("Point"===n.type||"MultiPoint"===n.type||"LineString"===n.type)return Rr("Point"===n.type?[n.coordinates]:n.coordinates,"LineString"===n.type,i,a);if("MultiLineString"===n.type){let t=1/0;for(let e=0;e<n.coordinates.length;e++){const r=Rr(n.coordinates[e],!0,i,a,t);if(isNaN(r))return r;if(0===(t=Math.min(t,r)))return t}return t}if("Polygon"===n.type||"MultiPolygon"===n.type){let t=1/0;for(let e=0;e<i.length;e++){const r=Fr(i[e],!0,"Polygon"===n.type?[n.coordinates]:n.coordinates,a,t);if(isNaN(r))return r;if(0===(t=Math.min(t,r)))return t}return t}return null}(e,n,this.geometries);if("Polygon"===t.geometryType())return function(t,e,n){const i=[];for(const n of function(t,e){const n=t.length;if(n<=1)return[t];const i=[];let a,r;for(let e=0;e<n;e++){const n=Ba(t[e]);0!==n&&(t[e].area=Math.abs(n),void 0===r&&(r=n<0),r===n<0?(a&&i.push(a),a=[t[e]]):a.push(t[e]))}return a&&i.push(a),i}(t)){const t=[];for(let i=0;i<n.length;++i)t.push(Cr(n[i],e));i.push(t)}const a=new ar(i[0][0][0][1],"meters");if("Point"===n.type||"MultiPoint"===n.type||"LineString"===n.type)return Fr("Point"===n.type?[n.coordinates]:n.coordinates,"LineString"===n.type,i,a);if("MultiLineString"===n.type){let t=1/0;for(let e=0;e<n.coordinates.length;e++){const r=Fr(n.coordinates[e],!0,i,a,t);if(isNaN(r))return r;if(0===(t=Math.min(t,r)))return t}return t}return"Polygon"===n.type||"MultiPolygon"===n.type?function(t,e,n){let i=1/0;for(const a of t)for(const t of e){const e=Dr(a,t,n,i);if(isNaN(e))return e;if(0===(i=Math.min(i,e)))return i}return i}("Polygon"===n.type?[n.coordinates]:n.coordinates,i,a):null}(e,n,this.geometries);console.warn("Distance Expression: currently only evaluates valid Point/LineString/Polygon geometries.")}else console.warn("Distance Expression: requirs valid feature and canonical information.");return null}eachChild(){}outputDefined(){return!0}serialize(){return["distance",this.geojson]}}function Vr(t,e){switch(t){case"string":return ya(e);case"number":return+e;case"boolean":return!!e;case"color":return Vi.parse(e);case"formatted":return pa.fromString(ya(e));case"resolvedImage":return fa.fromString(ya(e))}return e}function Ur(t,e,n,i){return void 0!==i&&(t=i*Math.round(t/i)),void 0!==e&&t<e&&(t=e),void 0!==n&&t>n&&(t=n),t}class Gr{constructor(t,e,n){this.type=t,this.key=e,this.scope=n}static parse(t,e){let n=e.expectedType;if(null==n&&(n=ea),t.length<2||t.length>3)return e.error("Invalid number of arguments for 'config' expression.");const i=e.parse(t[1],1);if(!(i instanceof xa))return e.error("Key name of 'config' expression must be a string literal.");if(t.length>=3){const a=e.parse(t[2],2);return a instanceof xa?new Gr(n,ya(i.value),ya(a.value)):e.error("Scope of 'config' expression must be a string literal.")}return new Gr(n,ya(i.value))}evaluate(t){const e=[this.key,this.scope,t.scope].filter(Boolean).join(""),n=t.getConfig(e);if(!n)return null;const{type:i,value:a,values:r,minValue:o,maxValue:s,stepValue:l}=n,c=n.default.evaluate(t);let u=c;if(a){const e=t.scope;t.scope=(e||"").split("").slice(1).join(""),u=a.evaluate(t),t.scope=e}return i&&(u=Vr(i,u)),void 0===u||void 0===o&&void 0===s&&void 0===l||("number"==typeof u?u=Ur(u,o,s,l):Array.isArray(u)&&(u=u.map((t=>"number"==typeof t?Ur(t,o,s,l):t)))),void 0!==a&&void 0!==u&&r&&!r.includes(u)&&(u=c,i&&(u=Vr(i,u))),(i&&i!==this.type||void 0!==u&&_a(u)!==this.type)&&(u=Vr(this.type.kind,u)),u}eachChild(){}outputDefined(){return!1}serialize(){const t=["config",this.key];return this.scope&&t.concat(this.key),t}}function qr(t){if(t instanceof Ia){if("get"===t.name&&1===t.args.length)return!1;if("feature-state"===t.name)return!1;if("has"===t.name&&1===t.args.length)return!1;if("properties"===t.name||"geometry-type"===t.name||"id"===t.name)return!1;if(/^filter-/.test(t.name))return!1}if(t instanceof Ja)return!1;if(t instanceof jr)return!1;let e=!0;return t.eachChild((t=>{e&&!qr(t)&&(e=!1)})),e}function $r(t){if(t instanceof Ia&&"feature-state"===t.name)return!1;let e=!0;return t.eachChild((t=>{e&&!$r(t)&&(e=!1)})),e}function Wr(t){if(t instanceof Gr)return!1;let e=!0;return t.eachChild((t=>{e&&!Wr(t)&&(e=!1)})),e}function Hr(t,e){if(t instanceof Ia&&e.indexOf(t.name)>=0)return!1;let n=!0;return t.eachChild((t=>{n&&!Hr(t,e)&&(n=!1)})),n}class Zr{constructor(t,e){this.type=e.type,this.name=t,this.boundExpression=e}static parse(t,e){if(2!==t.length||"string"!=typeof t[1])return e.error("'var' expression requires exactly one string literal argument.");const n=t[1];return e.scope.has(n)?new Zr(n,e.scope.get(n)):e.error(`Unknown variable "${n}". Make sure "${n}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(t){return this.boundExpression.evaluate(t)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}class Yr{constructor(t,e=[],n,i=new Zi,a=[],r,o){this.registry=t,this.path=e,this.key=e.map((t=>`[${t}]`)).join(""),this.scope=i,this.errors=a,this.expectedType=n,this._scope=r,this.options=o}parse(t,e,n,i,a={}){return e||n?this.concat(e,n,i)._parse(t,a):this._parse(t,a)}_parse(t,e){function n(t,e,n){return"assert"===n?new wa(e,[t]):"coerce"===n?new Sa(e,[t]):t}if(null!==t&&"string"!=typeof t&&"boolean"!=typeof t&&"number"!=typeof t||(t=["literal",t]),Array.isArray(t)){if(0===t.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const i="string"==typeof t[0]?this.registry[t[0]]:void 0;if(i){let a=i.parse(t,this);if(!a)return null;if(this.expectedType){const t=this.expectedType,i=a.type;if("string"!==t.kind&&"number"!==t.kind&&"boolean"!==t.kind&&"object"!==t.kind&&"array"!==t.kind||"value"!==i.kind)if("color"!==t.kind&&"formatted"!==t.kind&&"resolvedImage"!==t.kind||"value"!==i.kind&&"string"!==i.kind){if(this.checkSubtype(t,i))return null}else a=n(a,t,e.typeAnnotation||"coerce");else a=n(a,t,e.typeAnnotation||"assert")}if(!(a instanceof xa)&&"resolvedImage"!==a.type.kind&&Kr(a)){const e=new ka(this._scope,this.options);try{a=new xa(a.type,a.evaluate(e))}catch(t){return this.error(t.message),null}}return a}return Sa.parse(["to-array",t],this)}return this.error(void 0===t?"'undefined' value invalid. Use null instead.":"object"==typeof t?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof t} instead.`)}concat(t,e,n){const i="number"==typeof t?this.path.concat(t):this.path,a=n?this.scope.concat(n):this.scope;return new Yr(this.registry,i,e||null,a,this.errors,this._scope,this.options)}error(t,...e){const n=`${this.key}${e.map((t=>`[${t}]`)).join("")}`;this.errors.push(new Hi(n,t))}checkSubtype(t,e){const n=la(t,e);return n&&this.error(n),n}}var Xr=Yr;function Kr(t){if(t instanceof Zr)return Kr(t.boundExpression);if(t instanceof Ia&&"error"===t.name)return!1;if(t instanceof za)return!1;if(t instanceof Ja)return!1;if(t instanceof jr)return!1;if(t instanceof Gr)return!1;const e=t instanceof Sa||t instanceof wa;let n=!0;return t.eachChild((t=>{n=e?n&&Kr(t):n&&t instanceof xa})),!!n&&qr(t)&&Hr(t,["zoom","heatmap-density","line-progress","raster-value","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center","measure-light","raster-particle-speed"])}function Qr(t,e){const n=t.length-1;let i,a,r=0,o=n,s=0;for(;r<=o;)if(s=Math.floor((r+o)/2),i=t[s],a=t[s+1],i<=e){if(s===n||e<a)return s;r=s+1}else{if(!(i>e))throw new va("Input is not a number.");o=s-1}return 0}class Jr{constructor(t,e,n){this.type=t,this.input=e,this.labels=[],this.outputs=[];for(const[t,e]of n)this.labels.push(t),this.outputs.push(e)}static parse(t,e){if(t.length-1<4)return e.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return e.error("Expected an even number of arguments.");const n=e.parse(t[1],1,Xi);if(!n)return null;const i=[];let a=null;e.expectedType&&"value"!==e.expectedType.kind&&(a=e.expectedType);for(let n=1;n<t.length;n+=2){const r=1===n?-1/0:t[n],o=t[n+1],s=n,l=n+1;if("number"!=typeof r)return e.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',s);if(i.length&&i[i.length-1][0]>=r)return e.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',s);const c=e.parse(o,l,a);if(!c)return null;a=a||c.type,i.push([r,c])}return new Jr(a,n,i)}evaluate(t){const e=this.labels,n=this.outputs;if(1===e.length)return n[0].evaluate(t);const i=this.input.evaluate(t);if(i<=e[0])return n[0].evaluate(t);const a=e.length;return i>=e[a-1]?n[a-1].evaluate(t):n[Qr(e,i)].evaluate(t)}eachChild(t){t(this.input);for(const e of this.outputs)t(e)}outputDefined(){return this.outputs.every((t=>t.outputDefined()))}serialize(){const t=["step",this.input.serialize()];for(let e=0;e<this.labels.length;e++)e>0&&t.push(this.labels[e]),t.push(this.outputs[e].serialize());return t}}const to=.95047,eo=1.08883,no=4/29,io=6/29,ao=3*io*io,ro=io*io*io,oo=Math.PI/180,so=180/Math.PI;function lo(t){return t>ro?Math.pow(t,1/3):t/ao+no}function co(t){return t>io?t*t*t:ao*(t-no)}function uo(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function ho(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function po(t){const e=ho(t.r),n=ho(t.g),i=ho(t.b),a=lo((.4124564*e+.3575761*n+.1804375*i)/to),r=lo((.2126729*e+.7151522*n+.072175*i)/1);return{l:116*r-16,a:500*(a-r),b:200*(r-lo((.0193339*e+.119192*n+.9503041*i)/eo)),alpha:t.a}}function fo(t){let e=(t.l+16)/116,n=isNaN(t.a)?e:e+t.a/500,i=isNaN(t.b)?e:e-t.b/200;return e=1*co(e),n=to*co(n),i=eo*co(i),new Vi(uo(3.2404542*n-1.5371385*e-.4985314*i),uo(-.969266*n+1.8760108*e+.041556*i),uo(.0556434*n-.2040259*e+1.0572252*i),t.alpha)}function mo(t,e,n){const i=e-t;return t+n*(i>180||i<-180?i-360*Math.round(i/360):i)}const go={forward:po,reverse:fo,interpolate:function(t,e,n){return{l:Gi(t.l,e.l,n),a:Gi(t.a,e.a,n),b:Gi(t.b,e.b,n),alpha:Gi(t.alpha,e.alpha,n)}}},_o={forward:function(t){const{l:e,a:n,b:i}=po(t),a=Math.atan2(i,n)*so;return{h:a<0?a+360:a,c:Math.sqrt(n*n+i*i),l:e,alpha:t.a}},reverse:function(t){const e=t.h*oo,n=t.c;return fo({l:t.l,a:Math.cos(e)*n,b:Math.sin(e)*n,alpha:t.alpha})},interpolate:function(t,e,n){return{h:mo(t.h,e.h,n),c:Gi(t.c,e.c,n),l:Gi(t.l,e.l,n),alpha:Gi(t.alpha,e.alpha,n)}}};var yo=Object.freeze({__proto__:null,hcl:_o,lab:go});class xo{constructor(t,e,n,i,a){this.type=t,this.operator=e,this.interpolation=n,this.input=i,this.labels=[],this.outputs=[];for(const[t,e]of a)this.labels.push(t),this.outputs.push(e)}static interpolationFactor(t,e,n,i){let a=0;if("exponential"===t.name)a=vo(e,t.base,n,i);else if("linear"===t.name)a=vo(e,1,n,i);else if("cubic-bezier"===t.name){const r=t.controlPoints;a=new Fe(r[0],r[1],r[2],r[3]).solve(vo(e,1,n,i))}return a}static parse(t,e){let[n,i,a,...r]=t;if(!Array.isArray(i)||0===i.length)return e.error("Expected an interpolation type expression.",1);if("linear"===i[0])i={name:"linear"};else if("exponential"===i[0]){const t=i[1];if("number"!=typeof t)return e.error("Exponential interpolation requires a numeric base.",1,1);i={name:"exponential",base:t}}else{if("cubic-bezier"!==i[0])return e.error(`Unknown interpolation type ${String(i[0])}`,1,0);{const t=i.slice(1);if(4!==t.length||t.some((t=>"number"!=typeof t||t<0||t>1)))return e.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);i={name:"cubic-bezier",controlPoints:t}}}if(t.length-1<4)return e.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return e.error("Expected an even number of arguments.");if(a=e.parse(a,2,Xi),!a)return null;const o=[];let s=null;"interpolate-hcl"===n||"interpolate-lab"===n?s=Ji:e.expectedType&&"value"!==e.expectedType.kind&&(s=e.expectedType);for(let t=0;t<r.length;t+=2){const n=r[t],i=r[t+1],a=t+3,l=t+4;if("number"!=typeof n)return e.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',a);if(o.length&&o[o.length-1][0]>=n)return e.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',a);const c=e.parse(i,l,s);if(!c)return null;s=s||c.type,o.push([n,c])}return"number"===s.kind||"color"===s.kind||"array"===s.kind&&"number"===s.itemType.kind&&"number"==typeof s.N?new xo(s,n,i,a,o):e.error(`Type ${oa(s)} is not interpolatable.`)}evaluate(t){const e=this.labels,n=this.outputs;if(1===e.length)return n[0].evaluate(t);const i=this.input.evaluate(t);if(i<=e[0])return n[0].evaluate(t);const a=e.length;if(i>=e[a-1])return n[a-1].evaluate(t);const r=Qr(e,i),o=xo.interpolationFactor(this.interpolation,i,e[r],e[r+1]),s=n[r].evaluate(t),l=n[r+1].evaluate(t);return"interpolate"===this.operator?$i[this.type.kind.toLowerCase()](s,l,o):"interpolate-hcl"===this.operator?_o.reverse(_o.interpolate(_o.forward(s),_o.forward(l),o)):go.reverse(go.interpolate(go.forward(s),go.forward(l),o))}eachChild(t){t(this.input);for(const e of this.outputs)t(e)}outputDefined(){return this.outputs.every((t=>t.outputDefined()))}serialize(){let t;t="linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const e=[this.operator,t,this.input.serialize()];for(let t=0;t<this.labels.length;t++)e.push(this.labels[t],this.outputs[t].serialize());return e}}function vo(t,e,n,i){const a=i-n,r=t-n;return 0===a?0:1===e?r/a:(Math.pow(e,r)-1)/(Math.pow(e,a)-1)}class bo{constructor(t,e){this.type=t,this.args=e}static parse(t,e){if(t.length<2)return e.error("Expectected at least one argument.");let n=null;const i=e.expectedType;i&&"value"!==i.kind&&(n=i);const a=[];for(const i of t.slice(1)){const t=e.parse(i,1+a.length,n,void 0,{typeAnnotation:"omit"});if(!t)return null;n=n||t.type,a.push(t)}const r=i&&a.some((t=>la(i,t.type)));return new bo(r?ea:n,a)}evaluate(t){let e,n=null,i=0;for(const a of this.args){if(i++,n=a.evaluate(t),n&&n instanceof fa&&!n.available&&(e||(e=n),n=null,i===this.args.length))return e;if(null!==n)break}return n}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every((t=>t.outputDefined()))}serialize(){const t=["coalesce"];return this.eachChild((e=>{t.push(e.serialize())})),t}}class wo{constructor(t,e){this.type=e.type,this.bindings=[].concat(t),this.result=e}evaluate(t){return this.result.evaluate(t)}eachChild(t){for(const e of this.bindings)t(e[1]);t(this.result)}static parse(t,e){if(t.length<4)return e.error(`Expected at least 3 arguments, but found ${t.length-1} instead.`);const n=[];for(let i=1;i<t.length-1;i+=2){const a=t[i];if("string"!=typeof a)return e.error(`Expected string, but found ${typeof a} instead.`,i);if(/[^a-zA-Z0-9_]/.test(a))return e.error("Variable names must contain only alphanumeric characters or '_'.",i);const r=e.parse(t[i+1],i+1);if(!r)return null;n.push([a,r])}const i=e.parse(t[t.length-1],t.length-1,e.expectedType,n);return i?new wo(n,i):null}outputDefined(){return this.result.outputDefined()}serialize(){const t=["let"];for(const[e,n]of this.bindings)t.push(e,n.serialize());return t.push(this.result.serialize()),t}}class Ao{constructor(t,e,n){this.type=t,this.index=e,this.input=n}static parse(t,e){if(3!==t.length)return e.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const n=e.parse(t[1],1,Xi),i=e.parse(t[2],2,ra(e.expectedType||ea));return n&&i?new Ao(i.type.itemType,n,i):null}evaluate(t){const e=this.index.evaluate(t),n=this.input.evaluate(t);if(e<0)throw new va(`Array index out of bounds: ${e} < 0.`);if(e>=n.length)throw new va(`Array index out of bounds: ${e} > ${n.length-1}.`);if(e!==Math.floor(e))throw new va(`Array index must be an integer, but found ${e} instead.`);return n[e]}eachChild(t){t(this.index),t(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}class Co{constructor(t,e){this.type=Qi,this.needle=t,this.haystack=e}static parse(t,e){if(3!==t.length)return e.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const n=e.parse(t[1],1,ea),i=e.parse(t[2],2,ea);return n&&i?ca(n.type,[Qi,Ki,Xi,Yi,ea])?new Co(n,i):e.error(`Expected first argument to be of type boolean, string, number or null, but found ${oa(n.type)} instead`):null}evaluate(t){const e=this.needle.evaluate(t),n=this.haystack.evaluate(t);if(null==n)return!1;if(!ua(e,["boolean","string","number","null"]))throw new va(`Expected first argument to be of type boolean, string, number or null, but found ${oa(_a(e))} instead.`);if(!ua(n,["string","array"]))throw new va(`Expected second argument to be of type array or string, but found ${oa(_a(n))} instead.`);return n.indexOf(e)>=0}eachChild(t){t(this.needle),t(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}class Eo{constructor(t,e,n){this.type=Xi,this.needle=t,this.haystack=e,this.fromIndex=n}static parse(t,e){if(t.length<=2||t.length>=5)return e.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const n=e.parse(t[1],1,ea),i=e.parse(t[2],2,ea);if(!n||!i)return null;if(!ca(n.type,[Qi,Ki,Xi,Yi,ea]))return e.error(`Expected first argument to be of type boolean, string, number or null, but found ${oa(n.type)} instead`);if(4===t.length){const a=e.parse(t[3],3,Xi);return a?new Eo(n,i,a):null}return new Eo(n,i)}evaluate(t){const e=this.needle.evaluate(t),n=this.haystack.evaluate(t);if(!ua(e,["boolean","string","number","null"]))throw new va(`Expected first argument to be of type boolean, string, number or null, but found ${oa(_a(e))} instead.`);if(!ua(n,["string","array"]))throw new va(`Expected second argument to be of type array or string, but found ${oa(_a(n))} instead.`);if(this.fromIndex){const i=this.fromIndex.evaluate(t);return n.indexOf(e,i)}return n.indexOf(e)}eachChild(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)}outputDefined(){return!1}serialize(){if(null!=this.fromIndex&&void 0!==this.fromIndex){const t=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),t]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}class To{constructor(t,e,n,i,a,r){this.inputType=t,this.type=e,this.input=n,this.cases=i,this.outputs=a,this.otherwise=r}static parse(t,e){if(t.length<5)return e.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if(t.length%2!=1)return e.error("Expected an even number of arguments.");let n,i;e.expectedType&&"value"!==e.expectedType.kind&&(i=e.expectedType);const a={},r=[];for(let o=2;o<t.length-1;o+=2){let s=t[o];const l=t[o+1];Array.isArray(s)||(s=[s]);const c=e.concat(o);if(0===s.length)return c.error("Expected at least one branch label.");for(const t of s){if("number"!=typeof t&&"string"!=typeof t)return c.error("Branch labels must be numbers or strings.");if("number"==typeof t&&Math.abs(t)>Number.MAX_SAFE_INTEGER)return c.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if("number"==typeof t&&Math.floor(t)!==t)return c.error("Numeric branch labels must be integer values.");if(n){if(c.checkSubtype(n,_a(t)))return null}else n=_a(t);if(void 0!==a[String(t)])return c.error("Branch labels must be unique.");a[String(t)]=r.length}const u=e.parse(l,o,i);if(!u)return null;i=i||u.type,r.push(u)}const o=e.parse(t[1],1,ea);if(!o)return null;const s=e.parse(t[t.length-1],t.length-1,i);return s?"value"!==o.type.kind&&e.concat(1).checkSubtype(n,o.type)?null:new To(n,i,o,a,r,s):null}evaluate(t){const e=this.input.evaluate(t);return(_a(e)===this.inputType&&this.outputs[this.cases[e]]||this.otherwise).evaluate(t)}eachChild(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)}outputDefined(){return this.outputs.every((t=>t.outputDefined()))&&this.otherwise.outputDefined()}serialize(){const t=["match",this.input.serialize()],e=Object.keys(this.cases).sort(),n=[],i={};for(const t of e){const e=i[this.cases[t]];void 0===e?(i[this.cases[t]]=n.length,n.push([this.cases[t],[t]])):n[e][1].push(t)}const a=t=>"number"===this.inputType.kind?Number(t):t;for(const[e,i]of n)t.push(1===i.length?a(i[0]):i.map(a)),t.push(this.outputs[e].serialize());return t.push(this.otherwise.serialize()),t}}class So{constructor(t,e,n){this.type=t,this.branches=e,this.otherwise=n}static parse(t,e){if(t.length<4)return e.error(`Expected at least 3 arguments, but found only ${t.length-1}.`);if(t.length%2!=0)return e.error("Expected an odd number of arguments.");let n;e.expectedType&&"value"!==e.expectedType.kind&&(n=e.expectedType);const i=[];for(let a=1;a<t.length-1;a+=2){const r=e.parse(t[a],a,Qi);if(!r)return null;const o=e.parse(t[a+1],a+1,n);if(!o)return null;i.push([r,o]),n=n||o.type}const a=e.parse(t[t.length-1],t.length-1,n);return a?new So(n,i,a):null}evaluate(t){for(const[e,n]of this.branches)if(e.evaluate(t))return n.evaluate(t);return this.otherwise.evaluate(t)}eachChild(t){for(const[e,n]of this.branches)t(e),t(n);t(this.otherwise)}outputDefined(){return this.branches.every((([t,e])=>e.outputDefined()))&&this.otherwise.outputDefined()}serialize(){const t=["case"];return this.eachChild((e=>{t.push(e.serialize())})),t}}class Mo{constructor(t,e,n,i){this.type=t,this.input=e,this.beginIndex=n,this.endIndex=i}static parse(t,e){if(t.length<=2||t.length>=5)return e.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const n=e.parse(t[1],1,ea),i=e.parse(t[2],2,Xi);if(!n||!i)return null;if(!ca(n.type,[ra(ea),Ki,ea]))return e.error(`Expected first argument to be of type array or string, but found ${oa(n.type)} instead`);if(4===t.length){const a=e.parse(t[3],3,Xi);return a?new Mo(n.type,n,i,a):null}return new Mo(n.type,n,i)}evaluate(t){const e=this.input.evaluate(t),n=this.beginIndex.evaluate(t);if(!ua(e,["string","array"]))throw new va(`Expected first argument to be of type array or string, but found ${oa(_a(e))} instead.`);if(this.endIndex){const i=this.endIndex.evaluate(t);return e.slice(n,i)}return e.slice(n)}eachChild(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)}outputDefined(){return!1}serialize(){if(null!=this.endIndex&&void 0!==this.endIndex){const t=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),t]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}function ko(t,e){return"=="===t||"!="===t?"boolean"===e.kind||"string"===e.kind||"number"===e.kind||"null"===e.kind||"value"===e.kind:"string"===e.kind||"number"===e.kind||"value"===e.kind}function Io(t,e,n,i){return 0===i.compare(e,n)}function Po(t,e,n){const i="=="!==t&&"!="!==t;return class a{constructor(t,e,n){this.type=Qi,this.lhs=t,this.rhs=e,this.collator=n,this.hasUntypedArgument="value"===t.type.kind||"value"===e.type.kind}static parse(t,e){if(3!==t.length&&4!==t.length)return e.error("Expected two or three arguments.");const n=t[0];let r=e.parse(t[1],1,ea);if(!r)return null;if(!ko(n,r.type))return e.concat(1).error(`"${n}" comparisons are not supported for type '${oa(r.type)}'.`);let o=e.parse(t[2],2,ea);if(!o)return null;if(!ko(n,o.type))return e.concat(2).error(`"${n}" comparisons are not supported for type '${oa(o.type)}'.`);if(r.type.kind!==o.type.kind&&"value"!==r.type.kind&&"value"!==o.type.kind)return e.error(`Cannot compare types '${oa(r.type)}' and '${oa(o.type)}'.`);i&&("value"===r.type.kind&&"value"!==o.type.kind?r=new wa(o.type,[r]):"value"!==r.type.kind&&"value"===o.type.kind&&(o=new wa(r.type,[o])));let s=null;if(4===t.length){if("string"!==r.type.kind&&"string"!==o.type.kind&&"value"!==r.type.kind&&"value"!==o.type.kind)return e.error("Cannot use collator to compare non-string types.");if(s=e.parse(t[3],3,na),!s)return null}return new a(r,o,s)}evaluate(a){const r=this.lhs.evaluate(a),o=this.rhs.evaluate(a);if(i&&this.hasUntypedArgument){const e=_a(r),n=_a(o);if(e.kind!==n.kind||"string"!==e.kind&&"number"!==e.kind)throw new va(`Expected arguments for "${t}" to be (string, string) or (number, number), but found (${e.kind}, ${n.kind}) instead.`)}if(this.collator&&!i&&this.hasUntypedArgument){const t=_a(r),n=_a(o);if("string"!==t.kind||"string"!==n.kind)return e(a,r,o)}return this.collator?n(a,r,o,this.collator.evaluate(a)):e(a,r,o)}eachChild(t){t(this.lhs),t(this.rhs),this.collator&&t(this.collator)}outputDefined(){return!0}serialize(){const e=[t];return this.eachChild((t=>{e.push(t.serialize())})),e}}}const zo=Po("==",(function(t,e,n){return e===n}),Io),Do=Po("!=",(function(t,e,n){return e!==n}),(function(t,e,n,i){return!Io(0,e,n,i)})),Lo=Po("<",(function(t,e,n){return e<n}),(function(t,e,n,i){return i.compare(e,n)<0})),Bo=Po(">",(function(t,e,n){return e>n}),(function(t,e,n,i){return i.compare(e,n)>0})),Oo=Po("<=",(function(t,e,n){return e<=n}),(function(t,e,n,i){return i.compare(e,n)<=0})),Ro=Po(">=",(function(t,e,n){return e>=n}),(function(t,e,n,i){return i.compare(e,n)>=0}));class Fo{constructor(t,e,n,i,a,r){this.type=Ki,this.number=t,this.locale=e,this.currency=n,this.unit=i,this.minFractionDigits=a,this.maxFractionDigits=r}static parse(t,e){if(3!==t.length)return e.error("Expected two arguments.");const n=e.parse(t[1],1,Xi);if(!n)return null;const i=t[2];if("object"!=typeof i||Array.isArray(i))return e.error("NumberFormat options argument must be an object.");let a=null;if(i.locale&&(a=e.parse(i.locale,1,Ki),!a))return null;let r=null;if(i.currency&&(r=e.parse(i.currency,1,Ki),!r))return null;let o=null;if(i.unit&&(o=e.parse(i.unit,1,Ki),!o))return null;let s=null;if(i["min-fraction-digits"]&&(s=e.parse(i["min-fraction-digits"],1,Xi),!s))return null;let l=null;return i["max-fraction-digits"]&&(l=e.parse(i["max-fraction-digits"],1,Xi),!l)?null:new Fo(n,a,r,o,s,l)}evaluate(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(t):void 0,unit:this.unit?this.unit.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))}eachChild(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.unit&&t(this.unit),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const t={};return this.locale&&(t.locale=this.locale.serialize()),this.currency&&(t.currency=this.currency.serialize()),this.unit&&(t.unit=this.unit.serialize()),this.minFractionDigits&&(t["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(t["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),t]}}class No{constructor(t){this.type=Xi,this.input=t}static parse(t,e){if(2!==t.length)return e.error(`Expected 1 argument, but found ${t.length-1} instead.`);const n=e.parse(t[1],1);return n?"array"!==n.type.kind&&"string"!==n.type.kind&&"value"!==n.type.kind?e.error(`Expected argument of type string or array, but found ${oa(n.type)} instead.`):new No(n):null}evaluate(t){const e=this.input.evaluate(t);if("string"==typeof e)return e.length;if(Array.isArray(e))return e.length;throw new va(`Expected value to be of type string or array, but found ${oa(_a(e))} instead.`)}eachChild(t){t(this.input)}outputDefined(){return!1}serialize(){const t=["length"];return this.eachChild((e=>{t.push(e.serialize())})),t}}function jo(t){return function(){t=1831565813+(t|=0)|0;let e=Math.imul(t^t>>>15,1|t);return e=e+Math.imul(e^e>>>7,61|e)^e,((e^e>>>14)>>>0)/4294967296}}const Vo={"==":zo,"!=":Do,">":Bo,"<":Lo,">=":Ro,"<=":Oo,array:wa,at:Ao,boolean:wa,case:So,coalesce:bo,collator:za,format:Aa,image:Ca,in:Co,"index-of":Eo,interpolate:xo,"interpolate-hcl":xo,"interpolate-lab":xo,length:No,let:wo,literal:xa,match:To,number:wa,"number-format":Fo,object:wa,slice:Mo,step:Jr,string:wa,"to-boolean":Sa,"to-color":Sa,"to-number":Sa,"to-string":Sa,var:Zr,within:Ja,distance:jr,config:Gr};function Uo(t,[e,n,i,a]){e=e.evaluate(t),n=n.evaluate(t),i=i.evaluate(t);const r=a?a.evaluate(t):1,o=ma(e,n,i,r);if(o)throw new va(o);return new Vi(e/255*r,n/255*r,i/255*r,r)}function Go(t,[e,n,i,a]){e=e.evaluate(t),n=n.evaluate(t),i=i.evaluate(t);const r=a?a.evaluate(t):1,o=function(t,e,n,i){return"number"==typeof t&&t>=0&&t<=360?"number"==typeof e&&e>=0&&e<=100&&"number"==typeof n&&n>=0&&n<=100?void 0===i||"number"==typeof i&&i>=0&&i<=1?null:`Invalid hsla value [${[t,e,n,i].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid hsla value [${("number"==typeof i?[t,e,n,i]:[t,e,n]).join(", ")}]: 's', and 'l' must be between 0 and 100.`:`Invalid hsla value [${("number"==typeof i?[t,e,n,i]:[t,e,n]).join(", ")}]: 'h' must be between 0 and 360.`}(e,n,i,r);if(o)throw new va(o);const s=`hsla(${e}, ${n}%, ${i}%, ${r})`,l=Vi.parse(s);if(!l)throw new va(`Failed to parse HSLA color: ${s}`);return l}function qo(t,e){return t in e}function $o(t,e){const n=e[t];return void 0===n?null:n}function Wo(t){return{type:t}}function Ho(t){return{result:"success",value:t}}function Zo(t){return{result:"error",value:t}}function Yo(t,e){return!!t&&!!t.parameters&&t.parameters.indexOf(e)>-1}function Xo(t){return"data-driven"===t["property-type"]}function Ko(t){return Yo(t.expression,"measure-light")}function Qo(t){return Yo(t.expression,"zoom")}function Jo(t){return!!t.expression&&t.expression.interpolated}function ts(t){return"object"==typeof t&&null!==t&&!Array.isArray(t)}function es(t){return t}function ns(t,e){const n="color"===e.type,i=t.stops&&"object"==typeof t.stops[0][0],a=i||!(i||void 0!==t.property),r=t.type||(Jo(e)?"exponential":"interval");if(n&&((t=Wi({},t)).stops&&(t.stops=t.stops.map((t=>[t[0],Vi.parse(t[1])]))),t.default=Vi.parse(t.default?t.default:e.default)),t.colorSpace&&"rgb"!==t.colorSpace&&!yo[t.colorSpace])throw new Error(`Unknown color space: ${t.colorSpace}`);let o,s,l;if("exponential"===r)o=os;else if("interval"===r)o=rs;else if("categorical"===r){o=as,s=Object.create(null);for(const e of t.stops)s[e[0]]=e[1];l=typeof t.stops[0][0]}else{if("identity"!==r)throw new Error(`Unknown function type "${r}"`);o=ss}if(i){const n={},i=[];for(let e=0;e<t.stops.length;e++){const a=t.stops[e],r=a[0].zoom;void 0===n[r]&&(n[r]={zoom:r,type:t.type,property:t.property,default:t.default,stops:[]},i.push(r)),n[r].stops.push([a[0].value,a[1]])}const a=[];for(const t of i)a.push([n[t].zoom,ns(n[t],e)]);const r={name:"linear"};return{kind:"composite",interpolationType:r,interpolationFactor:xo.interpolationFactor.bind(void 0,r),zoomStops:a.map((t=>t[0])),evaluate:({zoom:n},i)=>os({stops:a,base:t.base},e,n).evaluate(n,i)}}if(a){const n="exponential"===r?{name:"exponential",base:void 0!==t.base?t.base:1}:null;return{kind:"camera",interpolationType:n,interpolationFactor:xo.interpolationFactor.bind(void 0,n),zoomStops:t.stops.map((t=>t[0])),evaluate:({zoom:n})=>o(t,e,n,s,l)}}return{kind:"source",evaluate(n,i){const a=i&&i.properties?i.properties[t.property]:void 0;return void 0===a?is(t.default,e.default):o(t,e,a,s,l)}}}function is(t,e,n){return void 0!==t?t:void 0!==e?e:void 0!==n?n:void 0}function as(t,e,n,i,a){return is(typeof n===a?i[n]:void 0,t.default,e.default)}function rs(t,e,n){if("number"!==Ea(n))return is(t.default,e.default);const i=t.stops.length;if(1===i)return t.stops[0][1];if(n<=t.stops[0][0])return t.stops[0][1];if(n>=t.stops[i-1][0])return t.stops[i-1][1];const a=Qr(t.stops.map((t=>t[0])),n);return t.stops[a][1]}function os(t,e,n){const i=void 0!==t.base?t.base:1;if("number"!==Ea(n))return is(t.default,e.default);const a=t.stops.length;if(1===a)return t.stops[0][1];if(n<=t.stops[0][0])return t.stops[0][1];if(n>=t.stops[a-1][0])return t.stops[a-1][1];const r=Qr(t.stops.map((t=>t[0])),n),o=function(t,e,n,i){const a=i-n,r=t-n;return 0===a?0:1===e?r/a:(Math.pow(e,r)-1)/(Math.pow(e,a)-1)}(n,i,t.stops[r][0],t.stops[r+1][0]),s=t.stops[r][1],l=t.stops[r+1][1];let c=$i[e.type]||es;if(t.colorSpace&&"rgb"!==t.colorSpace){const e=yo[t.colorSpace];c=(t,n)=>e.reverse(e.interpolate(e.forward(t),e.forward(n),o))}return"function"==typeof s.evaluate?{evaluate(...t){const e=s.evaluate.apply(void 0,t),n=l.evaluate.apply(void 0,t);if(void 0!==e&&void 0!==n)return c(e,n,o)}}:c(s,l,o)}function ss(t,e,n){return"color"===e.type?n=Vi.parse(n):"formatted"===e.type?n=pa.fromString(n.toString()):"resolvedImage"===e.type?n=fa.fromString(n.toString()):Ea(n)===e.type||"enum"===e.type&&e.values[n]||(n=void 0),is(n,t.default,e.default)}Ia.register(Vo,{error:[{kind:"error"},[Ki],(t,[e])=>{throw new va(e.evaluate(t))}],typeof:[Ki,[ea],(t,[e])=>oa(_a(e.evaluate(t)))],"to-rgba":[ra(Xi,4),[Ji],(t,[e])=>e.evaluate(t).toRenderColor(null).toArray()],rgb:[Ji,[Xi,Xi,Xi],Uo],rgba:[Ji,[Xi,Xi,Xi,Xi],Uo],hsl:[Ji,[Xi,Xi,Xi],Go],hsla:[Ji,[Xi,Xi,Xi,Xi],Go],has:{type:Qi,overloads:[[[Ki],(t,[e])=>qo(e.evaluate(t),t.properties())],[[Ki,ta],(t,[e,n])=>qo(e.evaluate(t),n.evaluate(t))]]},get:{type:ea,overloads:[[[Ki],(t,[e])=>$o(e.evaluate(t),t.properties())],[[Ki,ta],(t,[e,n])=>$o(e.evaluate(t),n.evaluate(t))]]},"feature-state":[ea,[Ki],(t,[e])=>$o(e.evaluate(t),t.featureState||{})],properties:[ta,[],t=>t.properties()],"geometry-type":[Ki,[],t=>t.geometryType()],id:[ea,[],t=>t.id()],zoom:[Xi,[],t=>t.globals.zoom],pitch:[Xi,[],t=>t.globals.pitch||0],"distance-from-center":[Xi,[],t=>t.distanceFromCenter()],"measure-light":[Xi,[Ki],(t,[e])=>t.measureLight(e.evaluate(t))],"heatmap-density":[Xi,[],t=>t.globals.heatmapDensity||0],"line-progress":[Xi,[],t=>t.globals.lineProgress||0],"raster-value":[Xi,[],t=>t.globals.rasterValue||0],"raster-particle-speed":[Xi,[],t=>t.globals.rasterParticleSpeed||0],"sky-radial-progress":[Xi,[],t=>t.globals.skyRadialProgress||0],accumulated:[ea,[],t=>void 0===t.globals.accumulated?null:t.globals.accumulated],"+":[Xi,Wo(Xi),(t,e)=>{let n=0;for(const i of e)n+=i.evaluate(t);return n}],"*":[Xi,Wo(Xi),(t,e)=>{let n=1;for(const i of e)n*=i.evaluate(t);return n}],"-":{type:Xi,overloads:[[[Xi,Xi],(t,[e,n])=>e.evaluate(t)-n.evaluate(t)],[[Xi],(t,[e])=>-e.evaluate(t)]]},"/":[Xi,[Xi,Xi],(t,[e,n])=>e.evaluate(t)/n.evaluate(t)],"%":[Xi,[Xi,Xi],(t,[e,n])=>e.evaluate(t)%n.evaluate(t)],ln2:[Xi,[],()=>Math.LN2],pi:[Xi,[],()=>Math.PI],e:[Xi,[],()=>Math.E],"^":[Xi,[Xi,Xi],(t,[e,n])=>Math.pow(e.evaluate(t),n.evaluate(t))],sqrt:[Xi,[Xi],(t,[e])=>Math.sqrt(e.evaluate(t))],log10:[Xi,[Xi],(t,[e])=>Math.log(e.evaluate(t))/Math.LN10],ln:[Xi,[Xi],(t,[e])=>Math.log(e.evaluate(t))],log2:[Xi,[Xi],(t,[e])=>Math.log(e.evaluate(t))/Math.LN2],sin:[Xi,[Xi],(t,[e])=>Math.sin(e.evaluate(t))],cos:[Xi,[Xi],(t,[e])=>Math.cos(e.evaluate(t))],tan:[Xi,[Xi],(t,[e])=>Math.tan(e.evaluate(t))],asin:[Xi,[Xi],(t,[e])=>Math.asin(e.evaluate(t))],acos:[Xi,[Xi],(t,[e])=>Math.acos(e.evaluate(t))],atan:[Xi,[Xi],(t,[e])=>Math.atan(e.evaluate(t))],min:[Xi,Wo(Xi),(t,e)=>Math.min(...e.map((e=>e.evaluate(t))))],max:[Xi,Wo(Xi),(t,e)=>Math.max(...e.map((e=>e.evaluate(t))))],abs:[Xi,[Xi],(t,[e])=>Math.abs(e.evaluate(t))],round:[Xi,[Xi],(t,[e])=>{const n=e.evaluate(t);return n<0?-Math.round(-n):Math.round(n)}],floor:[Xi,[Xi],(t,[e])=>Math.floor(e.evaluate(t))],ceil:[Xi,[Xi],(t,[e])=>Math.ceil(e.evaluate(t))],"filter-==":[Qi,[Ki,ea],(t,[e,n])=>t.properties()[e.value]===n.value],"filter-id-==":[Qi,[ea],(t,[e])=>t.id()===e.value],"filter-type-==":[Qi,[Ki],(t,[e])=>t.geometryType()===e.value],"filter-<":[Qi,[Ki,ea],(t,[e,n])=>{const i=t.properties()[e.value],a=n.value;return typeof i==typeof a&&i<a}],"filter-id-<":[Qi,[ea],(t,[e])=>{const n=t.id(),i=e.value;return typeof n==typeof i&&n<i}],"filter->":[Qi,[Ki,ea],(t,[e,n])=>{const i=t.properties()[e.value],a=n.value;return typeof i==typeof a&&i>a}],"filter-id->":[Qi,[ea],(t,[e])=>{const n=t.id(),i=e.value;return typeof n==typeof i&&n>i}],"filter-<=":[Qi,[Ki,ea],(t,[e,n])=>{const i=t.properties()[e.value],a=n.value;return typeof i==typeof a&&i<=a}],"filter-id-<=":[Qi,[ea],(t,[e])=>{const n=t.id(),i=e.value;return typeof n==typeof i&&n<=i}],"filter->=":[Qi,[Ki,ea],(t,[e,n])=>{const i=t.properties()[e.value],a=n.value;return typeof i==typeof a&&i>=a}],"filter-id->=":[Qi,[ea],(t,[e])=>{const n=t.id(),i=e.value;return typeof n==typeof i&&n>=i}],"filter-has":[Qi,[ea],(t,[e])=>e.value in t.properties()],"filter-has-id":[Qi,[],t=>null!==t.id()&&void 0!==t.id()],"filter-type-in":[Qi,[ra(Ki)],(t,[e])=>e.value.indexOf(t.geometryType())>=0],"filter-id-in":[Qi,[ra(ea)],(t,[e])=>e.value.indexOf(t.id())>=0],"filter-in-small":[Qi,[Ki,ra(ea)],(t,[e,n])=>n.value.indexOf(t.properties()[e.value])>=0],"filter-in-large":[Qi,[Ki,ra(ea)],(t,[e,n])=>function(t,e,n,i){for(;n<=i;){const a=n+i>>1;if(e[a]===t)return!0;e[a]>t?i=a-1:n=a+1}return!1}(t.properties()[e.value],n.value,0,n.value.length-1)],all:{type:Qi,overloads:[[[Qi,Qi],(t,[e,n])=>e.evaluate(t)&&n.evaluate(t)],[Wo(Qi),(t,e)=>{for(const n of e)if(!n.evaluate(t))return!1;return!0}]]},any:{type:Qi,overloads:[[[Qi,Qi],(t,[e,n])=>e.evaluate(t)||n.evaluate(t)],[Wo(Qi),(t,e)=>{for(const n of e)if(n.evaluate(t))return!0;return!1}]]},"!":[Qi,[Qi],(t,[e])=>!e.evaluate(t)],"is-supported-script":[Qi,[Ki],(t,[e])=>{const n=t.globals&&t.globals.isSupportedScript;return!n||n(e.evaluate(t))}],upcase:[Ki,[Ki],(t,[e])=>e.evaluate(t).toUpperCase()],downcase:[Ki,[Ki],(t,[e])=>e.evaluate(t).toLowerCase()],concat:[Ki,Wo(ea),(t,e)=>e.map((e=>ya(e.evaluate(t)))).join("")],"resolved-locale":[Ki,[na],(t,[e])=>e.evaluate(t).resolvedLocale()],random:[Xi,[Xi,Xi,ea],(t,e)=>{const[n,i,a]=e.map((e=>e.evaluate(t)));if(n>i)return n;if(n===i)return n;let r;if("string"==typeof a)r=function(t){let e=0;if(0===t.length)return e;for(let n=0;n<t.length;n++)e=(e<<5)-e+t.charCodeAt(n),e|=0;return e}(a);else{if("number"!=typeof a)throw new va(`Invalid seed input: ${a}`);r=a}return n+jo(r)()*(i-n)}]});class ls{constructor(t,e,n,i){this.expression=t,this._warningHistory={},this._evaluator=new ka(n,i),this._defaultValue=e?function(t){return"color"===t.type&&(ts(t.default)||Array.isArray(t.default))?new Vi(0,0,0,0):"color"===t.type?Vi.parse(t.default)||null:void 0===t.default?null:t.default}(e):null,this._enumValues=e&&"enum"===e.type?e.values:null}evaluateWithoutErrorHandling(t,e,n,i,a,r,o,s){return this._evaluator.globals=t,this._evaluator.feature=e,this._evaluator.featureState=n,this._evaluator.canonical=i||null,this._evaluator.availableImages=a||null,this._evaluator.formattedSection=r,this._evaluator.featureTileCoord=o||null,this._evaluator.featureDistanceData=s||null,this.expression.evaluate(this._evaluator)}evaluate(t,e,n,i,a,r,o,s){this._evaluator.globals=t,this._evaluator.feature=e||null,this._evaluator.featureState=n||null,this._evaluator.canonical=i||null,this._evaluator.availableImages=a||null,this._evaluator.formattedSection=r||null,this._evaluator.featureTileCoord=o||null,this._evaluator.featureDistanceData=s||null;try{const t=this.expression.evaluate(this._evaluator);if(null==t||"number"==typeof t&&t!=t)return this._defaultValue;if(this._enumValues&&!(t in this._enumValues))throw new va(`Expected value to be one of ${Object.keys(this._enumValues).map((t=>JSON.stringify(t))).join(", ")}, but found ${JSON.stringify(t)} instead.`);return t}catch(t){return this._warningHistory[t.message]||(this._warningHistory[t.message]=!0,"undefined"!=typeof console&&console.warn(t.message)),this._defaultValue}}}function cs(t){return Array.isArray(t)&&t.length>0&&"string"==typeof t[0]&&t[0]in Vo}function us(t,e,n,i){const a=new Xr(Vo,[],e?function(t){const e={color:Ji,string:Ki,number:Xi,enum:Ki,boolean:Qi,formatted:ia,resolvedImage:aa};return"array"===t.type?ra(e[t.value]||ea,t.length):e[t.type]}(e):void 0,void 0,void 0,n,i),r=a.parse(t,void 0,void 0,void 0,e&&"string"===e.type?{typeAnnotation:"coerce"}:void 0);return r?Ho(new ls(r,e,n,i)):Zo(a.errors)}class hs{constructor(t,e,n){this.kind=t,this._styleExpression=e,this.isLightConstant=n,this.isStateDependent="constant"!==t&&!$r(e.expression),this.isConfigDependent=!Wr(e.expression)}evaluateWithoutErrorHandling(t,e,n,i,a,r){return this._styleExpression.evaluateWithoutErrorHandling(t,e,n,i,a,r)}evaluate(t,e,n,i,a,r){return this._styleExpression.evaluate(t,e,n,i,a,r)}}class ds{constructor(t,e,n,i,a){this.kind=t,this.zoomStops=n,this._styleExpression=e,this.isStateDependent="camera"!==t&&!$r(e.expression),this.isLightConstant=a,this.isConfigDependent=!Wr(e.expression),this.interpolationType=i}evaluateWithoutErrorHandling(t,e,n,i,a,r){return this._styleExpression.evaluateWithoutErrorHandling(t,e,n,i,a,r)}evaluate(t,e,n,i,a,r){return this._styleExpression.evaluate(t,e,n,i,a,r)}interpolationFactor(t,e,n){return this.interpolationType?xo.interpolationFactor(this.interpolationType,t,e,n):0}}function ps(t,e,n,i){if("error"===(t=us(t,e,n,i)).result)return t;const a=t.value.expression,r=qr(a);if(!r&&!Xo(e))return Zo([new Hi("","data expressions not supported")]);const o=Hr(a,["zoom","pitch","distance-from-center"]);if(!o&&!Qo(e))return Zo([new Hi("","zoom expressions not supported")]);const s=Hr(a,["measure-light"]);if(!s&&!Ko(e))return Zo([new Hi("","measure-light expression not supported")]);const l=e.expression&&e.expression.relaxZoomRestriction,c=ms(a);return c||o||l?c instanceof Hi?Zo([c]):c instanceof xo&&!Jo(e)?Zo([new Hi("",'"interpolate" expressions cannot be used with this property')]):Ho(c?new ds(r?"camera":"composite",t.value,c.labels,c instanceof xo?c.interpolation:void 0,s):new hs(r?"constant":"source",t.value,s)):Zo([new Hi("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression, or in the properties of atmosphere.')])}class fs{constructor(t,e){this._parameters=t,this._specification=e,Wi(this,ns(this._parameters,this._specification))}static deserialize(t){return new fs(t._parameters,t._specification)}static serialize(t){return{_parameters:t._parameters,_specification:t._specification}}}function ms(t){let e=null;if(t instanceof wo)e=ms(t.result);else if(t instanceof bo){for(const n of t.args)if(e=ms(n),e)break}else(t instanceof Jr||t instanceof xo)&&t.input instanceof Ia&&"zoom"===t.input.name&&(e=t);return e instanceof Hi||t.eachChild((t=>{const n=ms(t);n instanceof Hi?e=n:e&&n&&e!==n&&(e=new Hi("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))})),e}var gs=ys,_s=3;function ys(t,e,n){var i=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;var a=new Int32Array(this.arrayBuffer);t=a[0],this.d=(e=a[1])+2*(n=a[2]);for(var r=0;r<this.d*this.d;r++){var o=a[_s+r],s=a[_s+r+1];i.push(o===s?null:a.subarray(o,s))}var l=a[_s+i.length+1];this.keys=a.subarray(a[_s+i.length],l),this.bboxes=a.subarray(l),this.insert=this._insertReadonly}else{this.d=e+2*n;for(var c=0;c<this.d*this.d;c++)i.push([]);this.keys=[],this.bboxes=[]}this.n=e,this.extent=t,this.padding=n,this.scale=e/t,this.uid=0;var u=n/e*t;this.min=-u,this.max=t+u}ys.prototype.insert=function(t,e,n,i,a){this._forEachCell(e,n,i,a,this._insertCell,this.uid++),this.keys.push(t),this.bboxes.push(e),this.bboxes.push(n),this.bboxes.push(i),this.bboxes.push(a)},ys.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},ys.prototype._insertCell=function(t,e,n,i,a,r){this.cells[a].push(r)},ys.prototype.query=function(t,e,n,i,a){var r=this.min,o=this.max;if(t<=r&&e<=r&&o<=n&&o<=i&&!a)return Array.prototype.slice.call(this.keys);var s=[];return this._forEachCell(t,e,n,i,this._queryCell,s,{},a),s},ys.prototype._queryCell=function(t,e,n,i,a,r,o,s){var l=this.cells[a];if(null!==l)for(var c=this.keys,u=this.bboxes,h=0;h<l.length;h++){var d=l[h];if(void 0===o[d]){var p=4*d;(s?s(u[p+0],u[p+1],u[p+2],u[p+3]):t<=u[p+2]&&e<=u[p+3]&&n>=u[p+0]&&i>=u[p+1])?(o[d]=!0,r.push(c[d])):o[d]=!1}}},ys.prototype._forEachCell=function(t,e,n,i,a,r,o,s){for(var l=this._convertToCellCoord(t),c=this._convertToCellCoord(e),u=this._convertToCellCoord(n),h=this._convertToCellCoord(i),d=l;d<=u;d++)for(var p=c;p<=h;p++){var f=this.d*p+d;if((!s||s(this._convertFromCellCoord(d),this._convertFromCellCoord(p),this._convertFromCellCoord(d+1),this._convertFromCellCoord(p+1)))&&a.call(this,t,e,n,i,f,r,o,s))return}},ys.prototype._convertFromCellCoord=function(t){return(t-this.padding)/this.scale},ys.prototype._convertToCellCoord=function(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))},ys.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var t=this.cells,e=_s+this.cells.length+1+1,n=0,i=0;i<this.cells.length;i++)n+=this.cells[i].length;var a=new Int32Array(e+n+this.keys.length+this.bboxes.length);a[0]=this.extent,a[1]=this.n,a[2]=this.padding;for(var r=e,o=0;o<t.length;o++){var s=t[o];a[_s+o]=r,a.set(s,r),r+=s.length}return a[_s+t.length]=r,a.set(this.keys,r),a[_s+t.length+1]=r+=this.keys.length,a.set(this.bboxes,r),r+=this.bboxes.length,a.buffer};var xs=d(gs);const vs={};function bs(t,e,n={}){Object.defineProperty(t,"_classRegistryKey",{value:e,writable:!1}),vs[e]={klass:t,omit:n.omit||[]}}bs(Object,"Object"),xs.serialize=function(t,e){const n=t.toArrayBuffer();return e&&e.add(n),{buffer:n}},xs.deserialize=function(t){return new xs(t.buffer)},Object.defineProperty(xs,"name",{value:"Grid"}),bs(xs,"Grid"),bs(Vi,"Color"),bs(Error,"Error"),bs(pa,"Formatted"),bs(da,"FormattedSection"),bs(Jn,"AJAXError"),bs(fa,"ResolvedImage"),bs(fs,"StylePropertyFunction"),bs(ls,"StyleExpression",{omit:["_evaluator"]}),bs(ds,"ZoomDependentExpression"),bs(hs,"ZoomConstantExpression"),bs(Ia,"CompoundExpression",{omit:["_evaluate"]});for(const t in Vo)vs[Vo[t]._classRegistryKey]||bs(Vo[t],`Expression${t}`);function ws(t){return t&&"undefined"!=typeof ArrayBuffer&&(t instanceof ArrayBuffer||t.constructor&&"ArrayBuffer"===t.constructor.name)}function As(t){return self.ImageBitmap&&t instanceof ImageBitmap}function Cs(t,e){if(null==t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp)return t;if(ws(t)||As(t))return e&&e.add(t),t;if(ArrayBuffer.isView(t)){const n=t;return e&&e.add(n.buffer),n}if(t instanceof ImageData)return e&&e.add(t.data.buffer),t;if(Array.isArray(t)){const n=[];for(const i of t)n.push(Cs(i,e));return n}if(t instanceof Map){const e={$name:"Map"};for(const[n,i]of t.entries())e[n]=Cs(i);return e}if("object"==typeof t){const n=t.constructor,i=n._classRegistryKey;if(!i)throw new Error(`can't serialize object of unregistered class ${i}`);const a=n.serialize?n.serialize(t,e):{};if(!n.serialize){for(const n in t)t.hasOwnProperty(n)&&(vs[i].omit.indexOf(n)>=0||(a[n]=Cs(t[n],e)));t instanceof Error&&(a.message=t.message)}if(a.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==i&&(a.$name=i),a}throw new Error("can't serialize object of type "+typeof t)}function Es(t){if(null==t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp||ws(t)||As(t)||ArrayBuffer.isView(t)||t instanceof ImageData)return t;if(Array.isArray(t))return t.map(Es);if("object"==typeof t){const e=t.$name||"Object";if("Map"===e){const e=new Map;for(const n of Object.keys(t))"$name"!==n&&e.set(n,Es(t[n]));return e}const{klass:n}=vs[e];if(!n)throw new Error(`can't deserialize unregistered class ${e}`);if(n.deserialize)return n.deserialize(t);const i=Object.create(n.prototype);for(const e of Object.keys(t))"$name"!==e&&(i[e]=Es(t[e]));return i}throw new Error("can't deserialize object of type "+typeof t)}const Ts={"Latin-1 Supplement":t=>t>=128&&t<=255,Arabic:t=>t>=1536&&t<=1791,"Arabic Supplement":t=>t>=1872&&t<=1919,"Arabic Extended-A":t=>t>=2208&&t<=2303,"Hangul Jamo":t=>t>=4352&&t<=4607,"Unified Canadian Aboriginal Syllabics":t=>t>=5120&&t<=5759,Khmer:t=>t>=6016&&t<=6143,"Unified Canadian Aboriginal Syllabics Extended":t=>t>=6320&&t<=6399,"General Punctuation":t=>t>=8192&&t<=8303,"Letterlike Symbols":t=>t>=8448&&t<=8527,"Number Forms":t=>t>=8528&&t<=8591,"Miscellaneous Technical":t=>t>=8960&&t<=9215,"Control Pictures":t=>t>=9216&&t<=9279,"Optical Character Recognition":t=>t>=9280&&t<=9311,"Enclosed Alphanumerics":t=>t>=9312&&t<=9471,"Geometric Shapes":t=>t>=9632&&t<=9727,"Miscellaneous Symbols":t=>t>=9728&&t<=9983,"Miscellaneous Symbols and Arrows":t=>t>=11008&&t<=11263,"CJK Radicals Supplement":t=>t>=11904&&t<=12031,"Kangxi Radicals":t=>t>=12032&&t<=12255,"Ideographic Description Characters":t=>t>=12272&&t<=12287,"CJK Symbols and Punctuation":t=>t>=12288&&t<=12351,Hiragana:t=>t>=12352&&t<=12447,Katakana:t=>t>=12448&&t<=12543,Bopomofo:t=>t>=12544&&t<=12591,"Hangul Compatibility Jamo":t=>t>=12592&&t<=12687,Kanbun:t=>t>=12688&&t<=12703,"Bopomofo Extended":t=>t>=12704&&t<=12735,"CJK Strokes":t=>t>=12736&&t<=12783,"Katakana Phonetic Extensions":t=>t>=12784&&t<=12799,"Enclosed CJK Letters and Months":t=>t>=12800&&t<=13055,"CJK Compatibility":t=>t>=13056&&t<=13311,"CJK Unified Ideographs Extension A":t=>t>=13312&&t<=19903,"Yijing Hexagram Symbols":t=>t>=19904&&t<=19967,"CJK Unified Ideographs":t=>t>=19968&&t<=40959,"Yi Syllables":t=>t>=40960&&t<=42127,"Yi Radicals":t=>t>=42128&&t<=42191,"Hangul Jamo Extended-A":t=>t>=43360&&t<=43391,"Hangul Syllables":t=>t>=44032&&t<=55215,"Hangul Jamo Extended-B":t=>t>=55216&&t<=55295,"Private Use Area":t=>t>=57344&&t<=63743,"CJK Compatibility Ideographs":t=>t>=63744&&t<=64255,"Arabic Presentation Forms-A":t=>t>=64336&&t<=65023,"Vertical Forms":t=>t>=65040&&t<=65055,"CJK Compatibility Forms":t=>t>=65072&&t<=65103,"Small Form Variants":t=>t>=65104&&t<=65135,"Arabic Presentation Forms-B":t=>t>=65136&&t<=65279,"Halfwidth and Fullwidth Forms":t=>t>=65280&&t<=65519,"CJK Unified Ideographs Extension B":t=>t>=131072&&t<=173791};function Ss(t){for(const e of t)if(Is(e.charCodeAt(0)))return!0;return!1}function Ms(t){for(const e of t)if(!ks(e.charCodeAt(0)))return!1;return!0}function ks(t){return!(Ts.Arabic(t)||Ts["Arabic Supplement"](t)||Ts["Arabic Extended-A"](t)||Ts["Arabic Presentation Forms-A"](t)||Ts["Arabic Presentation Forms-B"](t))}function Is(t){return!(746!==t&&747!==t&&(t<4352||!(Ts["Bopomofo Extended"](t)||Ts.Bopomofo(t)||Ts["CJK Compatibility Forms"](t)&&!(t>=65097&&t<=65103)||Ts["CJK Compatibility Ideographs"](t)||Ts["CJK Compatibility"](t)||Ts["CJK Radicals Supplement"](t)||Ts["CJK Strokes"](t)||!(!Ts["CJK Symbols and Punctuation"](t)||t>=12296&&t<=12305||t>=12308&&t<=12319||12336===t)||Ts["CJK Unified Ideographs Extension A"](t)||Ts["CJK Unified Ideographs"](t)||Ts["Enclosed CJK Letters and Months"](t)||Ts["Hangul Compatibility Jamo"](t)||Ts["Hangul Jamo Extended-A"](t)||Ts["Hangul Jamo Extended-B"](t)||Ts["Hangul Jamo"](t)||Ts["Hangul Syllables"](t)||Ts.Hiragana(t)||Ts["Ideographic Description Characters"](t)||Ts.Kanbun(t)||Ts["Kangxi Radicals"](t)||Ts["Katakana Phonetic Extensions"](t)||Ts.Katakana(t)&&12540!==t||!(!Ts["Halfwidth and Fullwidth Forms"](t)||65288===t||65289===t||65293===t||t>=65306&&t<=65310||65339===t||65341===t||65343===t||t>=65371&&t<=65503||65507===t||t>=65512&&t<=65519)||!(!Ts["Small Form Variants"](t)||t>=65112&&t<=65118||t>=65123&&t<=65126)||Ts["Unified Canadian Aboriginal Syllabics"](t)||Ts["Unified Canadian Aboriginal Syllabics Extended"](t)||Ts["Vertical Forms"](t)||Ts["Yijing Hexagram Symbols"](t)||Ts["Yi Syllables"](t)||Ts["Yi Radicals"](t))))}function Ps(t){return!(Is(t)||function(t){return!!(Ts["Latin-1 Supplement"](t)&&(167===t||169===t||174===t||177===t||188===t||189===t||190===t||215===t||247===t)||Ts["General Punctuation"](t)&&(8214===t||8224===t||8225===t||8240===t||8241===t||8251===t||8252===t||8258===t||8263===t||8264===t||8265===t||8273===t)||Ts["Letterlike Symbols"](t)||Ts["Number Forms"](t)||Ts["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||9003===t||t>=9085&&t<=9114||t>=9150&&t<=9165||9167===t||t>=9169&&t<=9179||t>=9186&&t<=9215)||Ts["Control Pictures"](t)&&9251!==t||Ts["Optical Character Recognition"](t)||Ts["Enclosed Alphanumerics"](t)||Ts["Geometric Shapes"](t)||Ts["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||Ts["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||Ts["CJK Symbols and Punctuation"](t)||Ts.Katakana(t)||Ts["Private Use Area"](t)||Ts["CJK Compatibility Forms"](t)||Ts["Small Form Variants"](t)||Ts["Halfwidth and Fullwidth Forms"](t)||8734===t||8756===t||8757===t||t>=9984&&t<=10087||t>=10102&&t<=10131||65532===t||65533===t)}(t))}function zs(t){return t>=1424&&t<=2303||Ts["Arabic Presentation Forms-A"](t)||Ts["Arabic Presentation Forms-B"](t)}function Ds(t,e){return!(!e&&zs(t)||t>=2304&&t<=3583||t>=3840&&t<=4255||Ts.Khmer(t))}function Ls(t){for(const e of t)if(zs(e.charCodeAt(0)))return!0;return!1}const Bs="deferred",Os="loading",Rs="loaded";let Fs=null,Ns="unavailable",js=null;const Vs=function(t){t&&"string"==typeof t&&t.indexOf("NetworkError")>-1&&(Ns="error"),Fs&&Fs(t)};function Us(){Gs.fire(new Di("pluginStateChange",{pluginStatus:Ns,pluginURL:js}))}const Gs=new Bi,qs=function(){return Ns},$s=function(){if(Ns!==Bs||!js)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Ns=Os,Us(),js&&ni({url:js},(t=>{t?Vs(t):(Ns=Rs,Us())}))},Ws={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>Ns===Rs||null!=Ws.applyArabicShaping,isLoading:()=>Ns===Os,setState(t){Ns=t.pluginStatus,js=t.pluginURL},isParsed:()=>null!=Ws.applyArabicShaping&&null!=Ws.processBidirectionalText&&null!=Ws.processStyledBidirectionalText,getPluginURL:()=>js};class Hs{constructor(t,e){this.zoom=t,e?(this.now=e.now,this.fadeDuration=e.fadeDuration,this.transition=e.transition,this.pitch=e.pitch,this.brightness=e.brightness):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0,this.brightness=0)}isSupportedScript(t){return function(t,e){for(const n of t)if(!Ds(n.charCodeAt(0),e))return!1;return!0}(t,Ws.isLoaded())}}class Zs{constructor(t,e,n,i){this.property=t,this.value=e,this.expression=function(t,e,n,i){if(ts(t))return new fs(t,e);if(cs(t)||Array.isArray(t)&&t.length>0){const a=ps(t,e,n,i);if("error"===a.result)throw new Error(a.value.map((t=>`${t.key}: ${t.message}`)).join(", "));return a.value}{let n=t;return"string"==typeof t&&"color"===e.type&&(n=Vi.parse(t)),{kind:"constant",isConfigDependent:!1,evaluate:()=>n}}}(void 0===e?t.specification.default:e,t.specification,n,i)}isDataDriven(){return"source"===this.expression.kind||"composite"===this.expression.kind}possiblyEvaluate(t,e,n){return this.property.possiblyEvaluate(this,t,e,n)}}class Ys{constructor(t,e,n){this.property=t,this.value=new Zs(t,void 0,e,n)}transitioned(t,e){return new Ks(this.property,this.value,e,en({},t.transition,this.transition),t.now)}untransitioned(){return new Ks(this.property,this.value,null,{},0)}}class Xs{constructor(t,e,n){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues),this._scope=e,this._options=n,this.isConfigDependent=!1}getValue(t){return dn(this._values[t].value.value)}setValue(t,e){this._values.hasOwnProperty(t)||(this._values[t]=new Ys(this._values[t].property,this._scope,this._options)),this._values[t].value=new Zs(this._values[t].property,null===e?void 0:dn(e),this._scope,this._options),this.isConfigDependent=this.isConfigDependent||this._values[t].value.expression.isConfigDependent}setTransitionOrValue(t,e){e&&(this._options=e);const n=this._properties.properties;if(t)for(const e in t){const i=t[e];if(cn(e,"-transition")){const t=e.slice(0,-11);n[t]&&this.setTransition(t,i)}else n.hasOwnProperty(e)&&this.setValue(e,i)}}getTransition(t){return dn(this._values[t].transition)}setTransition(t,e){this._values.hasOwnProperty(t)||(this._values[t]=new Ys(this._values[t].property)),this._values[t].transition=dn(e)||void 0}serialize(){const t={};for(const e of Object.keys(this._values)){const n=this.getValue(e);void 0!==n&&(t[e]=n);const i=this.getTransition(e);void 0!==i&&(t[`${e}-transition`]=i)}return t}transitioned(t,e){const n=new Qs(this._properties);for(const i of Object.keys(this._values))n._values[i]=this._values[i].transitioned(t,e._values[i]);return n}untransitioned(){const t=new Qs(this._properties);for(const e of Object.keys(this._values))t._values[e]=this._values[e].untransitioned();return t}}class Ks{constructor(t,e,n,i,a){const r=i.delay||0,o=i.duration||0;a=a||0,this.property=t,this.value=e,this.begin=a+r,this.end=this.begin+o,t.specification.transition&&(i.delay||i.duration)&&(this.prior=n)}possiblyEvaluate(t,e,n){const i=t.now||0,a=this.value.possiblyEvaluate(t,e,n),r=this.prior;if(r){if(i>this.end)return this.prior=null,a;if(this.value.isDataDriven())return this.prior=null,a;if(i<this.begin)return r.possiblyEvaluate(t,e,n);{const o=(i-this.begin)/(this.end-this.begin);return this.property.interpolate(r.possiblyEvaluate(t,e,n),a,He(o))}}return a}}class Qs{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)}possiblyEvaluate(t,e,n){const i=new el(this._properties);for(const a of Object.keys(this._values))i._values[a]=this._values[a].possiblyEvaluate(t,e,n);return i}hasTransition(){for(const t of Object.keys(this._values))if(this._values[t].prior)return!0;return!1}}class Js{constructor(t,e,n){this._properties=t,this._values=Object.create(t.defaultPropertyValues),this._scope=e,this._options=n,this.isConfigDependent=!1}getValue(t){return dn(this._values[t].value)}setValue(t,e){this._values[t]=new Zs(this._values[t].property,null===e?void 0:dn(e),this._scope,this._options),this.isConfigDependent=this.isConfigDependent||this._values[t].expression.isConfigDependent}serialize(){const t={};for(const e of Object.keys(this._values)){const n=this.getValue(e);void 0!==n&&(t[e]=n)}return t}possiblyEvaluate(t,e,n){const i=new el(this._properties);for(const a of Object.keys(this._values))i._values[a]=this._values[a].possiblyEvaluate(t,e,n);return i}}class tl{constructor(t,e,n){this.property=t,this.value=e,this.parameters=n}isConstant(){return"constant"===this.value.kind}constantOr(t){return"constant"===this.value.kind?this.value.value:t}evaluate(t,e,n,i){return this.property.evaluate(this.value,this.parameters,t,e,n,i)}}class el{constructor(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)}get(t){return this._values[t]}}class nl{constructor(t){this.specification=t}possiblyEvaluate(t,e){return t.expression.evaluate(e)}interpolate(t,e,n){const i=$i[this.specification.type];return i?i(t,e,n):t}}class il{constructor(t,e){this.specification=t,this.overrides=e}possiblyEvaluate(t,e,n,i){return new tl(this,"constant"===t.expression.kind||"camera"===t.expression.kind?{kind:"constant",value:t.expression.evaluate(e,null,{},n,i)}:t.expression,e)}interpolate(t,e,n){if("constant"!==t.value.kind||"constant"!==e.value.kind)return t;if(void 0===t.value.value||void 0===e.value.value)return new tl(this,{kind:"constant",value:void 0},t.parameters);const i=$i[this.specification.type];return i?new tl(this,{kind:"constant",value:i(t.value.value,e.value.value,n)},t.parameters):t}evaluate(t,e,n,i,a,r){return"constant"===t.kind?t.value:t.evaluate(e,n,i,a,r)}}class al{constructor(t){this.specification=t}possiblyEvaluate(t,e,n,i){return!!t.expression.evaluate(e,null,{},n,i)}interpolate(){return!1}}class rl{constructor(t){this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const e=new Hs(0,{});for(const n in t){const i=t[n];i.specification.overridable&&this.overridableProperties.push(n);const a=this.defaultPropertyValues[n]=new Zs(i,void 0),r=this.defaultTransitionablePropertyValues[n]=new Ys(i);this.defaultTransitioningPropertyValues[n]=r.untransitioned(),this.defaultPossiblyEvaluatedValues[n]=a.possiblyEvaluate(e)}}}bs(il,"DataDrivenProperty"),bs(nl,"DataConstantProperty"),bs(al,"ColorRampProperty");var ol=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"fragment":{"type":"boolean"},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360},"pitch":{"type":"number","default":0},"light":{"type":"light"},"lights":{"required":false,"type":"array","value":"light-3d"},"terrain":{"type":"terrain","optional":true},"fog":{"type":"fog"},"camera":{"type":"camera"},"color-theme":{"type":"colorTheme"},"imports":{"type":"array","value":"import"},"schema":{"type":"schema"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string","default":"mapbox://fonts/mapbox/{fontstack}/{range}.pbf"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"},"models":{"type":"models"}},"model":{"type":"string","required":true},"import":{"id":{"type":"string","required":true},"url":{"type":"string","required":true},"config":{"type":"config"},"data":{"type":"$root"}},"config":{"*":{"type":"*"}},"schema":{"*":{"type":"option"}},"option":{"default":{"type":"*","property-type":"data-constant","expression":{},"required":true},"type":{"type":"enum","values":{"string":1,"number":1,"boolean":1,"color":1}},"array":{"type":"boolean"},"minValue":{"type":"number"},"maxValue":{"type":"number"},"stepValue":{"type":"number"},"values":{"type":"array","value":"*"},"metadata":{"type":"*"}},"models":{"*":{"type":"model"}},"light-3d":{"id":{"type":"string","required":true},"properties":{"type":"properties"},"type":{"type":"enum","values":{"ambient":{},"directional":{},"flat":{}}}},"properties":["properties_light_directional","properties_light_ambient","properties_light_flat"],"properties_light_directional":{"direction":{"type":"array","default":[210,30],"minimum":[0,0],"maximum":[360,90],"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"cast-shadows":{"type":"boolean","default":false,"expression":{},"property-type":"data-constant"},"shadow-intensity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_ambient":{"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_flat":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"property-type":"data-constant","expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_raster_array","source_geojson","source_video","source_image","source_model"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":1,"mapbox":1},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_array":{"experimental":true,"type":{"required":true,"type":"enum","values":{"raster-array":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"rasterLayers":{"type":"*"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":1}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"},"dynamic":{"type":"boolean","default":false}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":1}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":1}},"url":{"required":false,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_model":{"type":{"required":true,"type":"enum","values":{"model":1,"batched-model":1}},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"tiles":{"type":"array","value":"string"}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"raster-particle":{"experimental":true},"hillshade":{},"model":{"experimental":true},"background":{},"sky":{},"slot":{},"clip":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"slot":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_clip","layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_raster-particle","layout_hillshade","layout_background","layout_sky","layout_model"],"layout_background":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_model":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"model-id":{"type":"string","default":"","property-type":"data-driven","expression":{"parameters":["zoom","feature"]}}},"layout_clip":{"clip-layer-types":{"type":"array","value":"enum","values":{"model":1,"symbol":1},"default":[],"expression":{},"property-type":"data-constant","experimental":true}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","experimental":true,"private":true,"default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":1,"round":1,"square":1},"default":"butt","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":1,"round":1,"miter":1,"none":1},"default":"miter","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-z-offset":{"type":"number","experimental":true,"expression":{"parameters":["zoom","feature","line-progress"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":1,"line":1,"line-center":1},"default":"point","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":1,"viewport-y":1,"source":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-z-elevate":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":1,"width":1,"height":1,"both":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":1,"left":1,"center":1,"right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","default":0,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":1,"vertical":1},"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":1,"uppercase":1,"lowercase":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_raster-particle":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":1,"!=":1,">":1,">=":1,"<":1,"<=":1,"in":1,"!in":1,"all":1,"any":1,"none":1,"has":1,"!has":1}},"geometry_type":{"type":"enum","values":{"Point":1,"LineString":1,"Polygon":1}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":1,"exponential":1,"interval":1,"categorical":1},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":1,"lab":1,"hcl":1},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vertical-range":{"type":"array","default":[0,0],"minimum":0,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}}},"camera":{"camera-projection":{"type":"enum","values":{"perspective":1,"orthographic":1},"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"default":"perspective","property-type":"data-constant"}},"colorTheme":{"data":{"type":"string","property-type":"data-constant","expression":{}}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"property-type":"data-constant","expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":1,"equalEarth":1,"equirectangular":1,"lambertConformalConic":1,"mercator":1,"naturalEarth":1,"winkelTripel":1,"globe":1},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_raster-particle","paint_hillshade","paint_background","paint_sky","paint_model"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","private":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-wall-radius":{"property-type":"data-constant","type":"number","experimental":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-radius":{"property-type":"data-constant","type":"number","experimental":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-attenuation":{"property-type":"data-constant","type":"number","experimental":true,"default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-flood-light-color":{"property-type":"data-constant","type":"color","experimental":true,"default":"#ffffff","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-intensity":{"property-type":"data-constant","type":"number","experimental":true,"default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-wall-radius":{"property-type":"data-driven","type":"number","experimental":true,"default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-radius":{"property-type":"data-driven","type":"number","experimental":true,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-attenuation":{"property-type":"data-constant","type":"number","experimental":true,"default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-vertical-scale":{"property-type":"data-constant","type":"number","experimental":true,"default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-rounded-roof":{"property-type":"data-constant","type":"boolean","default":true,"experimental":true,"expression":{"parameters":["zoom"]}},"fill-extrusion-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"fill-extrusion-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"property-type":"constant"},"line-trim-fade-range":{"type":"array","value":"number","experimental":true,"length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-trim-color":{"type":"color","experimental":true,"default":"transparent","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-border-width":{"type":"number","private":true,"default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-border-color":{"type":"color","private":true,"default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-occlusion-opacity":{"type":"number","default":0,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"property-type":"data-constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-driven"},"text-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-image-cross-fade":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"transition":true},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-color-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-color":{"type":"color","expression":{"interpolated":true,"parameters":["raster-value"]},"property-type":"color-ramp"},"raster-color-mix":{"type":"array","default":[0.2126,0.7152,0.0722,0],"length":4,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-color-range":{"type":"array","length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":1,"nearest":1},"default":"linear","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"raster-array-band":{"type":"string","required":false,"experimental":true,"property-type":"data-constant"},"raster-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster-particle":{"raster-particle-array-band":{"type":"string","required":false,"property-type":"data-constant"},"raster-particle-count":{"type":"number","default":512,"minimum":1,"property-type":"data-constant"},"raster-particle-color":{"type":"color","expression":{"interpolated":true,"parameters":["raster-particle-speed"]},"property-type":"color-ramp"},"raster-particle-max-speed":{"type":"number","default":1,"minimum":1,"property-type":"data-constant"},"raster-particle-speed-factor":{"type":"number","default":0.2,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-particle-fade-opacity-factor":{"type":"number","default":0.98,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-particle-reset-rate-factor":{"type":"number","default":0.8,"minimum":0,"maximum":1,"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":1,"atmosphere":1},"default":"atmosphere","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","default":10,"minimum":0,"maximum":100,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","value":"number","default":[0,0],"length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","default":90,"minimum":0,"maximum":180,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_model":{"model-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"model-rotation":{"type":"array","value":"number","length":3,"default":[0,0,0],"period":360,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-scale":{"type":"array","value":"number","length":3,"default":[1,1,1],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-translation":{"type":"array","value":"number","length":3,"default":[0,0,0],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-color":{"type":"color","default":"#ffffff","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light","zoom"]},"transition":true},"model-color-mix-intensity":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-type":{"type":"enum","values":{"common-3d":1,"location-indicator":1},"default":"common-3d","property-type":"data-constant"},"model-cast-shadows":{"type":"boolean","default":true,"expression":{},"property-type":"data-constant"},"model-receive-shadows":{"type":"boolean","default":true,"expression":{},"property-type":"data-constant"},"model-ambient-occlusion-intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant","transition":true},"model-emissive-strength":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":5,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-roughness":{"type":"number","default":1,"minimum":0,"maximum":1,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state"]},"transition":true},"model-height-based-emissive-strength-multiplier":{"type":"array","default":[1,1,1,1,0],"length":5,"value":"number","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"model-front-cutoff":{"type":"array","private":true,"value":"number","property-type":"data-constant","expression":{"interpolated":true,"parameters":["zoom"]},"length":3,"default":[0,0,1],"minimum":[0,0,0],"maximum":[1,1,1]}},"transition":{"duration":{"type":"number","default":300,"minimum":0},"delay":{"type":"number","default":0,"minimum":0}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function sl(t){return t instanceof Number||t instanceof String||t instanceof Boolean?t.valueOf():t}function ll(t){if(Array.isArray(t))return t.map(ll);if(t instanceof Object&&!(t instanceof Number||t instanceof String||t instanceof Boolean)){const e={};for(const n in t)e[n]=ll(t[n]);return e}return sl(t)}function cl(t){if(!0===t||!1===t)return!0;if(!Array.isArray(t)||0===t.length)return!1;switch(t[0]){case"has":return t.length>=2&&"$id"!==t[1]&&"$type"!==t[1];case"in":return t.length>=3&&("string"!=typeof t[1]||Array.isArray(t[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==t.length||Array.isArray(t[1])||Array.isArray(t[2]);case"any":case"all":for(const e of t.slice(1))if(!cl(e)&&"boolean"!=typeof e)return!1;return!0;default:return!0}}function ul(t,e="fill"){if(null==t)return{filter:()=>!0,needGeometry:!1,needFeature:!1};cl(t)||(t=_l(t));const n=t;let i=!0;try{i=function(t){if(!pl(t))return t;let e=ll(t);return dl(e),e=hl(e),e}(n)}catch(t){console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.\nThis is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md\nand paste the contents of this message in the report.\nThank you!\nFilter Expression:\n${JSON.stringify(n,null,2)}\n        `)}const a=ol[`filter_${e}`],r=us(i,a);let o=null;if("error"===r.result)throw new Error(r.value.map((t=>`${t.key}: ${t.message}`)).join(", "));o=(t,e,n)=>r.value.evaluate(t,e,{},n);let s=null,l=null;if(i!==n){const t=us(n,a);if("error"===t.result)throw new Error(t.value.map((t=>`${t.key}: ${t.message}`)).join(", "));s=(e,n,i,a,r)=>t.value.evaluate(e,n,{},i,void 0,void 0,a,r),l=!qr(t.value.expression)}return{filter:o,dynamicFilter:s||void 0,needGeometry:gl(i),needFeature:!!l}}function hl(t){if(!Array.isArray(t))return t;const e=function(t){if(fl.has(t[0]))for(let e=1;e<t.length;e++)if(pl(t[e]))return!0;return t}(t);return!0===e?e:e.map((t=>hl(t)))}function dl(t){let e=!1;const n=[];if("case"===t[0]){for(let i=1;i<t.length-1;i+=2)e=e||pl(t[i]),n.push(t[i+1]);n.push(t[t.length-1])}else if("match"===t[0]){e=e||pl(t[1]);for(let e=2;e<t.length-1;e+=2)n.push(t[e+1]);n.push(t[t.length-1])}else if("step"===t[0]){e=e||pl(t[1]);for(let e=1;e<t.length-1;e+=2)n.push(t[e+1])}e&&(t.length=0,t.push("any",...n));for(let e=1;e<t.length;e++)dl(t[e])}function pl(t){if(!Array.isArray(t))return!1;if("pitch"===(e=t[0])||"distance-from-center"===e)return!0;var e;for(let e=1;e<t.length;e++)if(pl(t[e]))return!0;return!1}const fl=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function ml(t,e){return t<e?-1:t>e?1:0}function gl(t){if(!Array.isArray(t))return!1;if("within"===t[0]||"distance"===t[0])return!0;for(let e=1;e<t.length;e++)if(gl(t[e]))return!0;return!1}function _l(t){if(!t)return!0;const e=t[0];return t.length<=1?"any"!==e:"=="===e?yl(t[1],t[2],"=="):"!="===e?bl(yl(t[1],t[2],"==")):"<"===e||">"===e||"<="===e||">="===e?yl(t[1],t[2],e):"any"===e?(n=t.slice(1),["any"].concat(n.map(_l))):"all"===e?["all"].concat(t.slice(1).map(_l)):"none"===e?["all"].concat(t.slice(1).map(_l).map(bl)):"in"===e?xl(t[1],t.slice(2)):"!in"===e?bl(xl(t[1],t.slice(2))):"has"===e?vl(t[1]):"!has"!==e||bl(vl(t[1]));var n}function yl(t,e,n){switch(t){case"$type":return[`filter-type-${n}`,e];case"$id":return[`filter-id-${n}`,e];default:return[`filter-${n}`,t,e]}}function xl(t,e){if(0===e.length)return!1;switch(t){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some((t=>typeof t!=typeof e[0]))?["filter-in-large",t,["literal",e.sort(ml)]]:["filter-in-small",t,["literal",e]]}}function vl(t){switch(t){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",t]}}function bl(t){return["!",t]}const wl="";function Al(t,e){return e?`${t}${wl}${e}`:t}const Cl="-transition",El=new Set(["fill","line","background","hillshade","raster"]);class Tl extends Bi{constructor(t,e,n,i,a){if(super(),this.id=t.id,this.fqid=Al(this.id,n),this.type=t.type,this.scope=n,this.lut=i,this.options=a,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,this.isConfigDependent=!1,"custom"!==t.type&&(this.metadata=t.metadata,this.minzoom=t.minzoom,this.maxzoom=t.maxzoom,"background"!==t.type&&"sky"!==t.type&&"slot"!==t.type&&(this.source=t.source,this.sourceLayer=t["source-layer"],this.filter=t.filter),t.slot&&(this.slot=t.slot),e.layout&&(this._unevaluatedLayout=new Js(e.layout,this.scope,a),this.isConfigDependent=this.isConfigDependent||this._unevaluatedLayout.isConfigDependent),e.paint)){this._transitionablePaint=new Xs(e.paint,this.scope,a);for(const e in t.paint)this.setPaintProperty(e,t.paint[e]);for(const e in t.layout)this.setLayoutProperty(e,t.layout[e]);this.isConfigDependent=this.isConfigDependent||this._transitionablePaint.isConfigDependent,this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new el(e.paint)}}onAdd(t){}onRemove(t){}isDraped(t){return El.has(this.type)}getLayoutProperty(t){return"visibility"===t?this.visibility:this._unevaluatedLayout.getValue(t)}setLayoutProperty(t,e){if("custom"===this.type&&"visibility"===t)return void(this.visibility=e);const n=this._unevaluatedLayout;n._properties.properties[t]&&(n.setValue(t,e),this.isConfigDependent=this.isConfigDependent||n.isConfigDependent,"visibility"===t&&this.possiblyEvaluateVisibility())}possiblyEvaluateVisibility(){this.visibility=this._unevaluatedLayout._values.visibility.possiblyEvaluate({zoom:0})}getPaintProperty(t){return cn(t,Cl)?this._transitionablePaint.getTransition(t.slice(0,-11)):this._transitionablePaint.getValue(t)}setPaintProperty(t,e){const n=this._transitionablePaint,i=n._properties.properties;if(cn(t,Cl)){const a=t.slice(0,-11);return i[a]&&n.setTransition(a,e||void 0),!1}if(!i[t])return!1;const a=n._values[t],r=a.value.isDataDriven(),o=a.value;n.setValue(t,e),this.isConfigDependent=this.isConfigDependent||n.isConfigDependent,this._handleSpecialPaintPropertyUpdate(t);const s=n._values[t].value,l=s.isDataDriven(),c=cn(t,"pattern")||"line-dasharray"===t;return l||r||c||this._handleOverridablePaintPropertyUpdate(t,o,s)}_handleSpecialPaintPropertyUpdate(t){}getProgramIds(){return null}getDefaultProgramParams(t,e,n){return null}_handleOverridablePaintPropertyUpdate(t,e,n){return!1}isHidden(t){return!!(this.minzoom&&t<this.minzoom)||!!(this.maxzoom&&t>=this.maxzoom)||"none"===this.visibility}updateTransitions(t){this._transitioningPaint=this._transitionablePaint.transitioned(t,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(t,e){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(t,void 0,e)),this.paint=this._transitioningPaint.possiblyEvaluate(t,void 0,e)}serialize(){return hn({id:this.id,type:this.type,slot:this.slot,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()},((t,e)=>!(void 0===t||"layout"===e&&!Object.keys(t).length||"paint"===e&&!Object.keys(t).length)))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}hasShadowPass(){return!1}canCastShadows(){return!1}hasLightBeamPass(){return!1}cutoffRange(){return 0}tileCoverLift(){return 0}resize(){}isStateDependent(){for(const t in this.paint._values){const e=this.paint.get(t);if(e instanceof tl&&Xo(e.property.specification)&&("source"===e.value.kind||"composite"===e.value.kind)&&e.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=ul(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}getLayerRenderingStats(){return this._stats}resetLayerRenderingStats(t){this._stats&&("shadow"===t.renderPass?this._stats.numRenderedVerticesInShadowPass=0:this._stats.numRenderedVerticesInTransparentPass=0)}queryRadius(t){}queryIntersectsFeature(t,e,n,i,a,r,o,s,l){}queryIntersectsMatchingFeature(t,e,n,i){}}const Sl={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Ml{constructor(t,e){this._structArray=t,this._pos1=e*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class kl{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(t,e){return t._trim(),e&&(t.isTransferred=!0,e.add(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}}static deserialize(t){const e=Object.create(this.prototype);return e.arrayBuffer=t.arrayBuffer,e.length=t.length,e.capacity=t.arrayBuffer.byteLength/e.bytesPerElement,e._refreshViews(),e}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(t){this.reserve(t),this.length=t}reserve(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const e=this.uint8;this._refreshViews(),e&&this.uint8.set(e)}}_refreshViews(){throw new Error("StructArray#_refreshViews() must be implemented by each concrete StructArray layout")}emplace(...t){throw new Error("StructArray#emplace() must be implemented by each concrete StructArray layout")}emplaceBack(...t){throw new Error("StructArray#emplaceBack() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function Il(t,e=1){let n=0,i=0;return{members:t.map((t=>{const a=Sl[t.type].BYTES_PER_ELEMENT,r=n=Pl(n,Math.max(e,a)),o=t.components||1;return i=Math.max(i,a),n+=a*o,{name:t.name,type:t.type,components:o,offset:r}})),size:Pl(n,Math.max(i,e)),alignment:e}}function Pl(t,e){return Math.ceil(t/e)*e}class zl extends kl{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,e){const n=this.length;return this.resize(n+1),this.emplace(n,t,e)}emplace(t,e,n){const i=2*t;return this.int16[i+0]=e,this.int16[i+1]=n,t}}zl.prototype.bytesPerElement=4,bs(zl,"StructArrayLayout2i4");class Dl extends kl{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,e,n){const i=this.length;return this.resize(i+1),this.emplace(i,t,e,n)}emplace(t,e,n,i){const a=3*t;return this.int16[a+0]=e,this.int16[a+1]=n,this.int16[a+2]=i,t}}Dl.prototype.bytesPerElement=6,bs(Dl,"StructArrayLayout3i6");class Ll extends kl{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,e,n,i){const a=this.length;return this.resize(a+1),this.emplace(a,t,e,n,i)}emplace(t,e,n,i,a){const r=4*t;return this.int16[r+0]=e,this.int16[r+1]=n,this.int16[r+2]=i,this.int16[r+3]=a,t}}Ll.prototype.bytesPerElement=8,bs(Ll,"StructArrayLayout4i8");class Bl extends kl{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,e,n,i,a){const r=this.length;return this.resize(r+1),this.emplace(r,t,e,n,i,a)}emplace(t,e,n,i,a,r){const o=5*t;return this.int16[o+0]=e,this.int16[o+1]=n,this.int16[o+2]=i,this.int16[o+3]=a,this.int16[o+4]=r,t}}Bl.prototype.bytesPerElement=10,bs(Bl,"StructArrayLayout5i10");class Ol extends kl{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,e,n,i,a,r,o){const s=this.length;return this.resize(s+1),this.emplace(s,t,e,n,i,a,r,o)}emplace(t,e,n,i,a,r,o,s){const l=6*t,c=12*t,u=3*t;return this.int16[l+0]=e,this.int16[l+1]=n,this.uint8[c+4]=i,this.uint8[c+5]=a,this.uint8[c+6]=r,this.uint8[c+7]=o,this.float32[u+2]=s,t}}Ol.prototype.bytesPerElement=12,bs(Ol,"StructArrayLayout2i4ub1f12");class Rl extends kl{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,e,n,i){const a=this.length;return this.resize(a+1),this.emplace(a,t,e,n,i)}emplace(t,e,n,i,a){const r=4*t;return this.float32[r+0]=e,this.float32[r+1]=n,this.float32[r+2]=i,this.float32[r+3]=a,t}}Rl.prototype.bytesPerElement=16,bs(Rl,"StructArrayLayout4f16");class Fl extends kl{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,e,n){const i=this.length;return this.resize(i+1),this.emplace(i,t,e,n)}emplace(t,e,n,i){const a=3*t;return this.float32[a+0]=e,this.float32[a+1]=n,this.float32[a+2]=i,t}}Fl.prototype.bytesPerElement=12,bs(Fl,"StructArrayLayout3f12");class Nl extends kl{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,e,n,i,a){const r=this.length;return this.resize(r+1),this.emplace(r,t,e,n,i,a)}emplace(t,e,n,i,a,r){const o=6*t,s=3*t;return this.uint16[o+0]=e,this.uint16[o+1]=n,this.uint16[o+2]=i,this.uint16[o+3]=a,this.float32[s+2]=r,t}}Nl.prototype.bytesPerElement=12,bs(Nl,"StructArrayLayout4ui1f12");class jl extends kl{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,e,n,i){const a=this.length;return this.resize(a+1),this.emplace(a,t,e,n,i)}emplace(t,e,n,i,a){const r=4*t;return this.uint16[r+0]=e,this.uint16[r+1]=n,this.uint16[r+2]=i,this.uint16[r+3]=a,t}}jl.prototype.bytesPerElement=8,bs(jl,"StructArrayLayout4ui8");class Vl extends kl{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,e,n,i,a,r){const o=this.length;return this.resize(o+1),this.emplace(o,t,e,n,i,a,r)}emplace(t,e,n,i,a,r,o){const s=6*t;return this.int16[s+0]=e,this.int16[s+1]=n,this.int16[s+2]=i,this.int16[s+3]=a,this.int16[s+4]=r,this.int16[s+5]=o,t}}Vl.prototype.bytesPerElement=12,bs(Vl,"StructArrayLayout6i12");class Ul extends kl{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,e,n,i,a,r,o,s,l,c,u,h){const d=this.length;return this.resize(d+1),this.emplace(d,t,e,n,i,a,r,o,s,l,c,u,h)}emplace(t,e,n,i,a,r,o,s,l,c,u,h,d){const p=12*t;return this.int16[p+0]=e,this.int16[p+1]=n,this.int16[p+2]=i,this.int16[p+3]=a,this.uint16[p+4]=r,this.uint16[p+5]=o,this.uint16[p+6]=s,this.uint16[p+7]=l,this.int16[p+8]=c,this.int16[p+9]=u,this.int16[p+10]=h,this.int16[p+11]=d,t}}Ul.prototype.bytesPerElement=24,bs(Ul,"StructArrayLayout4i4ui4i24");class Gl extends kl{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,e,n,i,a,r){const o=this.length;return this.resize(o+1),this.emplace(o,t,e,n,i,a,r)}emplace(t,e,n,i,a,r,o){const s=10*t,l=5*t;return this.int16[s+0]=e,this.int16[s+1]=n,this.int16[s+2]=i,this.float32[l+2]=a,this.float32[l+3]=r,this.float32[l+4]=o,t}}Gl.prototype.bytesPerElement=20,bs(Gl,"StructArrayLayout3i3f20");class ql extends kl{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t){const e=this.length;return this.resize(e+1),this.emplace(e,t)}emplace(t,e){return this.uint32[1*t+0]=e,t}}ql.prototype.bytesPerElement=4,bs(ql,"StructArrayLayout1ul4");class $l extends kl{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t){const e=this.length;return this.resize(e+1),this.emplace(e,t)}emplace(t,e){return this.float32[1*t+0]=e,t}}$l.prototype.bytesPerElement=4,bs($l,"StructArrayLayout1f4");class Wl extends kl{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,e){const n=this.length;return this.resize(n+1),this.emplace(n,t,e)}emplace(t,e,n){const i=2*t;return this.uint16[i+0]=e,this.uint16[i+1]=n,t}}Wl.prototype.bytesPerElement=4,bs(Wl,"StructArrayLayout2ui4");class Hl extends kl{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,e,n,i,a,r,o,s,l,c,u,h,d){const p=this.length;return this.resize(p+1),this.emplace(p,t,e,n,i,a,r,o,s,l,c,u,h,d)}emplace(t,e,n,i,a,r,o,s,l,c,u,h,d,p){const f=20*t,m=10*t;return this.int16[f+0]=e,this.int16[f+1]=n,this.int16[f+2]=i,this.int16[f+3]=a,this.int16[f+4]=r,this.float32[m+3]=o,this.float32[m+4]=s,this.float32[m+5]=l,this.float32[m+6]=c,this.int16[f+14]=u,this.uint32[m+8]=h,this.uint16[f+18]=d,this.uint16[f+19]=p,t}}Hl.prototype.bytesPerElement=40,bs(Hl,"StructArrayLayout5i4f1i1ul2ui40");class Zl extends kl{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,e,n,i,a,r,o){const s=this.length;return this.resize(s+1),this.emplace(s,t,e,n,i,a,r,o)}emplace(t,e,n,i,a,r,o,s){const l=8*t;return this.int16[l+0]=e,this.int16[l+1]=n,this.int16[l+2]=i,this.int16[l+4]=a,this.int16[l+5]=r,this.int16[l+6]=o,this.int16[l+7]=s,t}}Zl.prototype.bytesPerElement=16,bs(Zl,"StructArrayLayout3i2i2i16");class Yl extends kl{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,e,n,i,a){const r=this.length;return this.resize(r+1),this.emplace(r,t,e,n,i,a)}emplace(t,e,n,i,a,r){const o=4*t,s=8*t;return this.float32[o+0]=e,this.float32[o+1]=n,this.float32[o+2]=i,this.int16[s+6]=a,this.int16[s+7]=r,t}}Yl.prototype.bytesPerElement=16,bs(Yl,"StructArrayLayout2f1f2i16");class Xl extends kl{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,e,n,i){const a=this.length;return this.resize(a+1),this.emplace(a,t,e,n,i)}emplace(t,e,n,i,a){const r=12*t,o=3*t;return this.uint8[r+0]=e,this.uint8[r+1]=n,this.float32[o+1]=i,this.float32[o+2]=a,t}}Xl.prototype.bytesPerElement=12,bs(Xl,"StructArrayLayout2ub2f12");class Kl extends kl{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,e,n){const i=this.length;return this.resize(i+1),this.emplace(i,t,e,n)}emplace(t,e,n,i){const a=3*t;return this.uint16[a+0]=e,this.uint16[a+1]=n,this.uint16[a+2]=i,t}}Kl.prototype.bytesPerElement=6,bs(Kl,"StructArrayLayout3ui6");class Ql extends kl{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t,e,n,i,a,r,o,s,l,c,u,h,d,p,f,m,g,_,y,x,v){const b=this.length;return this.resize(b+1),this.emplace(b,t,e,n,i,a,r,o,s,l,c,u,h,d,p,f,m,g,_,y,x,v)}emplace(t,e,n,i,a,r,o,s,l,c,u,h,d,p,f,m,g,_,y,x,v,b){const w=30*t,A=15*t,C=60*t;return this.int16[w+0]=e,this.int16[w+1]=n,this.int16[w+2]=i,this.float32[A+2]=a,this.float32[A+3]=r,this.uint16[w+8]=o,this.uint16[w+9]=s,this.uint32[A+5]=l,this.uint32[A+6]=c,this.uint32[A+7]=u,this.uint16[w+16]=h,this.uint16[w+17]=d,this.uint16[w+18]=p,this.float32[A+10]=f,this.float32[A+11]=m,this.uint8[C+48]=g,this.uint8[C+49]=_,this.uint8[C+50]=y,this.uint32[A+13]=x,this.int16[w+28]=v,this.uint8[C+58]=b,t}}Ql.prototype.bytesPerElement=60,bs(Ql,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class Jl extends kl{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t,e,n,i,a,r,o,s,l,c,u,h,d,p,f,m,g,_,y,x,v,b,w,A,C,E,T,S,M,k,I,P,z,D){const L=this.length;return this.resize(L+1),this.emplace(L,t,e,n,i,a,r,o,s,l,c,u,h,d,p,f,m,g,_,y,x,v,b,w,A,C,E,T,S,M,k,I,P,z,D)}emplace(t,e,n,i,a,r,o,s,l,c,u,h,d,p,f,m,g,_,y,x,v,b,w,A,C,E,T,S,M,k,I,P,z,D,L){const B=22*t,O=44*t,R=88*t;return this.float32[B+0]=e,this.float32[B+1]=n,this.int16[O+4]=i,this.int16[O+5]=a,this.int16[O+6]=r,this.int16[O+7]=o,this.int16[O+8]=s,this.int16[O+9]=l,this.int16[O+10]=c,this.int16[O+11]=u,this.int16[O+12]=h,this.uint16[O+13]=d,this.uint16[O+14]=p,this.uint16[O+15]=f,this.uint16[O+16]=m,this.uint16[O+17]=g,this.uint16[O+18]=_,this.uint16[O+19]=y,this.uint16[O+20]=x,this.uint16[O+21]=v,this.uint16[O+22]=b,this.uint16[O+23]=w,this.uint16[O+24]=A,this.uint16[O+25]=C,this.uint16[O+26]=E,this.uint16[O+27]=T,this.uint32[B+14]=S,this.float32[B+15]=M,this.float32[B+16]=k,this.float32[B+17]=I,this.float32[B+18]=P,this.float32[B+19]=z,this.float32[B+20]=D,this.uint8[R+84]=L,t}}Jl.prototype.bytesPerElement=88,bs(Jl,"StructArrayLayout2f9i15ui1ul6f1ub88");class tc extends kl{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,e,n,i,a){const r=this.length;return this.resize(r+1),this.emplace(r,t,e,n,i,a)}emplace(t,e,n,i,a,r){const o=5*t;return this.float32[o+0]=e,this.float32[o+1]=n,this.float32[o+2]=i,this.float32[o+3]=a,this.float32[o+4]=r,t}}tc.prototype.bytesPerElement=20,bs(tc,"StructArrayLayout5f20");class ec extends kl{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,e,n,i,a,r,o){const s=this.length;return this.resize(s+1),this.emplace(s,t,e,n,i,a,r,o)}emplace(t,e,n,i,a,r,o,s){const l=7*t;return this.float32[l+0]=e,this.float32[l+1]=n,this.float32[l+2]=i,this.float32[l+3]=a,this.float32[l+4]=r,this.float32[l+5]=o,this.float32[l+6]=s,t}}ec.prototype.bytesPerElement=28,bs(ec,"StructArrayLayout7f28");class nc extends kl{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,e){const n=this.length;return this.resize(n+1),this.emplace(n,t,e)}emplace(t,e,n){const i=2*t;return this.float32[i+0]=e,this.float32[i+1]=n,t}}nc.prototype.bytesPerElement=8,bs(nc,"StructArrayLayout2f8");class ic extends kl{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,e,n,i){const a=this.length;return this.resize(a+1),this.emplace(a,t,e,n,i)}emplace(t,e,n,i,a){const r=6*t;return this.uint32[3*t+0]=e,this.uint16[r+2]=n,this.uint16[r+3]=i,this.uint16[r+4]=a,t}}ic.prototype.bytesPerElement=12,bs(ic,"StructArrayLayout1ul3ui12");class ac extends kl{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t){const e=this.length;return this.resize(e+1),this.emplace(e,t)}emplace(t,e){return this.uint16[1*t+0]=e,t}}ac.prototype.bytesPerElement=2,bs(ac,"StructArrayLayout1ui2");class rc extends kl{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,e,n,i,a,r,o,s,l,c,u,h,d,p,f,m){const g=this.length;return this.resize(g+1),this.emplace(g,t,e,n,i,a,r,o,s,l,c,u,h,d,p,f,m)}emplace(t,e,n,i,a,r,o,s,l,c,u,h,d,p,f,m,g){const _=16*t;return this.float32[_+0]=e,this.float32[_+1]=n,this.float32[_+2]=i,this.float32[_+3]=a,this.float32[_+4]=r,this.float32[_+5]=o,this.float32[_+6]=s,this.float32[_+7]=l,this.float32[_+8]=c,this.float32[_+9]=u,this.float32[_+10]=h,this.float32[_+11]=d,this.float32[_+12]=p,this.float32[_+13]=f,this.float32[_+14]=m,this.float32[_+15]=g,t}}rc.prototype.bytesPerElement=64,bs(rc,"StructArrayLayout16f64");class oc extends kl{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,e,n,i,a,r,o){const s=this.length;return this.resize(s+1),this.emplace(s,t,e,n,i,a,r,o)}emplace(t,e,n,i,a,r,o,s){const l=10*t,c=5*t;return this.uint16[l+0]=e,this.uint16[l+1]=n,this.uint16[l+2]=i,this.uint16[l+3]=a,this.float32[c+2]=r,this.float32[c+3]=o,this.float32[c+4]=s,t}}oc.prototype.bytesPerElement=20,bs(oc,"StructArrayLayout4ui3f20");class sc extends kl{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t){const e=this.length;return this.resize(e+1),this.emplace(e,t)}emplace(t,e){return this.int16[1*t+0]=e,t}}sc.prototype.bytesPerElement=2,bs(sc,"StructArrayLayout1i2");class lc extends kl{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer)}emplaceBack(t){const e=this.length;return this.resize(e+1),this.emplace(e,t)}emplace(t,e){return this.uint8[1*t+0]=e,t}}lc.prototype.bytesPerElement=1,bs(lc,"StructArrayLayout1ub1");class cc extends Ml{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}cc.prototype.size=40;class uc extends Hl{get(t){return new cc(this,t)}}bs(uc,"CollisionBoxArray");class hc extends Ml{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(t){this._structArray.uint8[this._pos1+49]=t}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(t){this._structArray.uint8[this._pos1+50]=t}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(t){this._structArray.uint32[this._pos4+13]=t}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(t){this._structArray.uint8[this._pos1+58]=t}}hc.prototype.size=60;class dc extends Ql{get(t){return new hc(this,t)}}bs(dc,"PlacedSymbolArray");class pc extends Ml{get tileAnchorX(){return this._structArray.float32[this._pos4+0]}get tileAnchorY(){return this._structArray.float32[this._pos4+1]}get projectedAnchorX(){return this._structArray.int16[this._pos2+4]}get projectedAnchorY(){return this._structArray.int16[this._pos2+5]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+6]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+7]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+11]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get key(){return this._structArray.uint16[this._pos2+13]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+14]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+15]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+17]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+19]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+21]}get featureIndex(){return this._structArray.uint16[this._pos2+22]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+23]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numIconVertices(){return this._structArray.uint16[this._pos2+25]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+26]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+27]}get crossTileID(){return this._structArray.uint32[this._pos4+14]}set crossTileID(t){this._structArray.uint32[this._pos4+14]=t}get textOffset0(){return this._structArray.float32[this._pos4+15]}get textOffset1(){return this._structArray.float32[this._pos4+16]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+17]}get zOffset(){return this._structArray.float32[this._pos4+18]}set zOffset(t){this._structArray.float32[this._pos4+18]=t}get occlusionState(){return this._structArray.float32[this._pos4+19]}set occlusionState(t){this._structArray.float32[this._pos4+19]=t}get occlusionOpacity(){return this._structArray.float32[this._pos4+20]}set occlusionOpacity(t){this._structArray.float32[this._pos4+20]=t}get hasIconTextFit(){return this._structArray.uint8[this._pos1+84]}}pc.prototype.size=88;class fc extends Jl{get(t){return new pc(this,t)}}bs(fc,"SymbolInstanceArray");class mc extends $l{getoffsetX(t){return this.float32[1*t+0]}}bs(mc,"GlyphOffsetArray");class gc extends zl{getx(t){return this.int16[2*t+0]}gety(t){return this.int16[2*t+1]}}bs(gc,"SymbolLineVertexArray");class _c extends Ml{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}_c.prototype.size=12;class yc extends ic{get(t){return new _c(this,t)}}bs(yc,"FeatureIndexArray");class xc extends Wl{geta_centroid_pos0(t){return this.uint16[2*t+0]}geta_centroid_pos1(t){return this.uint16[2*t+1]}}bs(xc,"FillExtrusionCentroidArray");const vc=Il([{name:"a_pos",components:2,type:"Int16"}],4),bc=Il([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class wc{constructor(t=[]){this.segments=t}_prepareSegment(t,e,n,i){let a=this.segments[this.segments.length-1];return t>wc.MAX_VERTEX_ARRAY_LENGTH&&fn(`Max vertices per segment is ${wc.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${t}`),(!a||a.vertexLength+t>wc.MAX_VERTEX_ARRAY_LENGTH||a.sortKey!==i)&&(a={vertexOffset:e,primitiveOffset:n,vertexLength:0,primitiveLength:0},void 0!==i&&(a.sortKey=i),this.segments.push(a)),a}prepareSegment(t,e,n,i){return this._prepareSegment(t,e.length,n.length,i)}get(){return this.segments}destroy(){for(const t of this.segments)for(const e in t.vaos)t.vaos[e].destroy()}static simpleSegment(t,e,n,i){return new wc([{vertexOffset:t,primitiveOffset:e,vertexLength:n,primitiveLength:i,vaos:{},sortKey:0}])}}function Ac(t,e){return 256*(t=Xe(Math.floor(t),0,255))+Xe(Math.floor(e),0,255)}wc.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,bs(wc,"SegmentVector");const Cc=Il([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),Ec=Il([{name:"a_dash",components:4,type:"Uint16"}]);class Tc{constructor(){this.ids=[],this.uniqueIds=[],this.positions=[],this.indexed=!1}add(t,e,n,i){this.ids.push(Sc(t)),this.positions.push(e,n,i)}eachPosition(t,e){const n=Sc(t);let i=0,a=this.ids.length-1;for(;i<a;){const t=i+a>>1;this.ids[t]>=n?a=t:i=t+1}for(;this.ids[i]===n;)e(this.positions[3*i],this.positions[3*i+1],this.positions[3*i+2]),i++}static serialize(t,e){const n=new Float64Array(t.ids),i=new Uint32Array(t.positions);return Mc(n,i,0,n.length-1),e&&(e.add(n.buffer),e.add(i.buffer)),{ids:n,positions:i}}static deserialize(t){const e=new Tc;let n;e.ids=t.ids,e.positions=t.positions;for(const t of e.ids)t!==n&&e.uniqueIds.push(t),n=t;return e.indexed=!0,e}}function Sc(t){const e=+t;return!isNaN(e)&&Number.MIN_SAFE_INTEGER<=e&&e<=Number.MAX_SAFE_INTEGER?e:Ii(String(t))}function Mc(t,e,n,i){for(;n<i;){const a=t[n+i>>1];let r=n-1,o=i+1;for(;;){do{r++}while(t[r]<a);do{o--}while(t[o]>a);if(r>=o)break;kc(t,r,o),kc(e,3*r,3*o),kc(e,3*r+1,3*o+1),kc(e,3*r+2,3*o+2)}o-n<i-o?(Mc(t,e,n,o),n=o+1):(Mc(t,e,o+1,i),i=o)}}function kc(t,e,n){const i=t[e];t[e]=t[n],t[n]=i}bs(Tc,"FeaturePositionMap");class Ic{constructor(t){this.gl=t.gl,this.initialized=!1}fetchUniformLocation(t,e){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(t,e),this.initialized=!0),!!this.location}set(t,e,n){throw new Error("Uniform#set() must be implemented by each concrete Uniform")}}class Pc extends Ic{constructor(t){super(t),this.current=0}set(t,e,n){this.fetchUniformLocation(t,e)&&this.current!==n&&(this.current=n,this.gl.uniform1i(this.location,n))}}class zc extends Ic{constructor(t){super(t),this.current=0}set(t,e,n){this.fetchUniformLocation(t,e)&&this.current!==n&&(this.current=n,this.gl.uniform1f(this.location,n))}}class Dc extends Ic{constructor(t){super(t),this.current=[0,0]}set(t,e,n){this.fetchUniformLocation(t,e)&&(n[0]===this.current[0]&&n[1]===this.current[1]||(this.current=n,this.gl.uniform2f(this.location,n[0],n[1])))}}class Lc extends Ic{constructor(t){super(t),this.current=[0,0,0]}set(t,e,n){this.fetchUniformLocation(t,e)&&(n[0]===this.current[0]&&n[1]===this.current[1]&&n[2]===this.current[2]||(this.current=n,this.gl.uniform3f(this.location,n[0],n[1],n[2])))}}class Bc extends Ic{constructor(t){super(t),this.current=[0,0,0,0]}set(t,e,n){this.fetchUniformLocation(t,e)&&(n[0]===this.current[0]&&n[1]===this.current[1]&&n[2]===this.current[2]&&n[3]===this.current[3]||(this.current=n,this.gl.uniform4f(this.location,n[0],n[1],n[2],n[3])))}}class Oc extends Ic{constructor(t){super(t),this.current=Vi.transparent.toRenderColor(null)}set(t,e,n){this.fetchUniformLocation(t,e)&&(n.r===this.current.r&&n.g===this.current.g&&n.b===this.current.b&&n.a===this.current.a||(this.current=n,this.gl.uniform4f(this.location,n.r,n.g,n.b,n.a)))}}const Rc=new Float32Array(16);class Fc extends Ic{constructor(t){super(t),this.current=Rc}set(t,e,n){if(this.fetchUniformLocation(t,e)){if(n[12]!==this.current[12]||n[0]!==this.current[0])return this.current=n,void this.gl.uniformMatrix4fv(this.location,!1,n);for(let t=1;t<16;t++)if(n[t]!==this.current[t]){this.current=n,this.gl.uniformMatrix4fv(this.location,!1,n);break}}}}const Nc=new Float32Array(9),jc=new Float32Array(4);class Vc extends Ic{constructor(t){super(t),this.current=jc}set(t,e,n){if(this.fetchUniformLocation(t,e))for(let t=0;t<4;t++)if(n[t]!==this.current[t]){this.current=n,this.gl.uniformMatrix2fv(this.location,!1,n);break}}}function Uc(t){return[Ac(255*t.r,255*t.g),Ac(255*t.b,255*t.a)]}class Gc{constructor(t,e,n,i){this.value=t,this.uniformNames=e.map((t=>`u_${t}`)),this.type=n,this.context=i}setUniform(t,e,n,i,a){const r=i.constantOr(this.value);e.set(t,a,r instanceof Vi?r.toRenderColor(this.context.lut):r)}getBinding(t,e){return"color"===this.type?new Oc(t):new zc(t)}}class qc{constructor(t,e){this.uniformNames=e.map((t=>`u_${t}`)),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(t){this.pixelRatio=t.pixelRatio||1,this.pattern=t.tl.concat(t.br)}setUniform(t,e,n,i,a){const r="u_pattern"===a||"u_dash"===a?this.pattern:"u_pixel_ratio"===a?this.pixelRatio:null;r&&e.set(t,a,r)}getBinding(t,e){return"u_pattern"===e||"u_dash"===e?new Bc(t):new zc(t)}}class $c{constructor(t,e,n,i){this.expression=t,this.type=n,this.maxValue=0,this.paintVertexAttributes=e.map((t=>({name:`a_${t}`,type:"Float32",components:"color"===n?2:1,offset:0}))),this.paintVertexArray=new i}populatePaintArray(t,e,n,i,a,r,o){const s=this.paintVertexArray.length,l=this.expression.evaluate(new Hs(0,{brightness:r}),e,{},a,i,o);this.paintVertexArray.resize(t),this._setPaintValue(s,t,l,this.context)}updatePaintArray(t,e,n,i,a,r,o){const s=this.expression.evaluate({zoom:0,brightness:o},n,i,void 0,a);this._setPaintValue(t,e,s,this.context)}_setPaintValue(t,e,n,i){if("color"===this.type){const a=Uc(n.toRenderColor(i.lut));for(let n=t;n<e;n++)this.paintVertexArray.emplace(n,a[0],a[1])}else{for(let i=t;i<e;i++)this.paintVertexArray.emplace(i,n);this.maxValue=Math.max(this.maxValue,Math.abs(n))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Wc{constructor(t,e,n,i,a,r){this.expression=t,this.uniformNames=e.map((t=>`u_${t}_t`)),this.type=n,this.useIntegerZoom=i,this.context=a,this.maxValue=0,this.paintVertexAttributes=e.map((t=>({name:`a_${t}`,type:"Float32",components:"color"===n?4:2,offset:0}))),this.paintVertexArray=new r}populatePaintArray(t,e,n,i,a,r,o){const s=this.expression.evaluate(new Hs(this.context.zoom,{brightness:r}),e,{},a,i,o),l=this.expression.evaluate(new Hs(this.context.zoom+1,{brightness:r}),e,{},a,i,o),c=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValue(c,t,s,l,this.context)}updatePaintArray(t,e,n,i,a,r,o){const s=this.expression.evaluate({zoom:this.context.zoom,brightness:o},n,i,void 0,a),l=this.expression.evaluate({zoom:this.context.zoom+1,brightness:o},n,i,void 0,a);this._setPaintValue(t,e,s,l,this.context)}_setPaintValue(t,e,n,i,a){if("color"===this.type){const i=Uc(n.toRenderColor(a.lut)),r=Uc(n.toRenderColor(a.lut));for(let n=t;n<e;n++)this.paintVertexArray.emplace(n,i[0],i[1],r[0],r[1])}else{for(let a=t;a<e;a++)this.paintVertexArray.emplace(a,n,i);this.maxValue=Math.max(this.maxValue,Math.abs(n),Math.abs(i))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(t,e,n,i,a){const r=this.useIntegerZoom?Math.floor(n.zoom):n.zoom,o=Xe(this.expression.interpolationFactor(r,this.context.zoom,this.context.zoom+1),0,1);e.set(t,a,o)}getBinding(t,e){return new zc(t)}}class Hc{constructor(t,e,n,i,a){this.expression=t,this.layerId=a,this.paintVertexAttributes=("array"===n?Ec:Cc).members;for(let t=0;t<e.length;++t);this.paintVertexArray=new i}populatePaintArray(t,e,n,i){const a=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValues(a,t,e.patterns&&e.patterns[this.layerId],n)}updatePaintArray(t,e,n,i,a,r,o){this._setPaintValues(t,e,n.patterns&&n.patterns[this.layerId],r)}_setPaintValues(t,e,n,i){if(!i||!n)return;const a=i[n];if(!a)return;const{tl:r,br:o,pixelRatio:s}=a;for(let n=t;n<e;n++)this.paintVertexArray.emplace(n,r[0],r[1],o[0],o[1],s)}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Zc{constructor(t,e,n=(()=>!0)){this.binders={},this._buffers=[],this.context=e;const i=[];for(const a in t.paint._values){const r=t.paint.get(a);if(!n(a))continue;if(!(r instanceof tl&&Xo(r.property.specification)))continue;const o=Kc(a,t.type),s=r.value,l=r.property.specification.type,c=!!r.property.useIntegerZoom,u="line-dasharray"===a||a.endsWith("pattern"),h="line-dasharray"===a&&"constant"!==t.layout.get("line-cap").value.kind;if("constant"!==s.kind||h)if("source"===s.kind||h||u){const e=tu(a,l,"source");this.binders[a]=u?new Hc(s,o,l,e,t.id):new $c(s,o,l,e),i.push(`/a_${a}`)}else{const t=tu(a,l,"composite");this.binders[a]=new Wc(s,o,l,c,e,t),i.push(`/z_${a}`)}else this.binders[a]=u?new qc(s.value,o):new Gc(s.value,o,l,e),i.push(`/u_${a}`)}this.cacheKey=i.sort().join("")}getMaxValue(t){const e=this.binders[t];return e instanceof $c||e instanceof Wc?e.maxValue:0}populatePaintArrays(t,e,n,i,a,r,o){for(const s in this.binders){const l=this.binders[s];l.context=this.context,(l instanceof $c||l instanceof Wc||l instanceof Hc)&&l.populatePaintArray(t,e,n,i,a,r,o)}}setConstantPatternPositions(t){for(const e in this.binders){const n=this.binders[e];n instanceof qc&&n.setConstantPatternPositions(t)}}updatePaintArrays(t,e,n,i,a,r,o,s){let l=!1;const c=Object.keys(t),u=0!==c.length,h=u?c:e.uniqueIds;this.context.lut=a.lut;for(const c in this.binders){const d=this.binders[c];if(d.context=this.context,(d instanceof $c||d instanceof Wc||d instanceof Hc)&&(!0===d.expression.isStateDependent||!1===d.expression.isLightConstant)){const p=a.paint.get(c);d.expression=p.value;for(const n of h){const a=t[n.toString()];e.eachPosition(n,((t,e,n)=>{const l=i.feature(t);d.updatePaintArray(e,n,l,a,r,o,s)}))}if(!u)for(const e of n.uniqueIds){const a=t[e.toString()];n.eachPosition(e,((t,e,n)=>{const l=i.feature(t);d.updatePaintArray(e,n,l,a,r,o,s)}))}l=!0}}return l}defines(){const t=[];for(const e in this.binders){const n=this.binders[e];(n instanceof Gc||n instanceof qc)&&t.push(...n.uniformNames.map((t=>`#define HAS_UNIFORM_${t}`)))}return t}getBinderAttributes(){const t=[];for(const e in this.binders){const n=this.binders[e];if(n instanceof $c||n instanceof Wc||n instanceof Hc)for(let e=0;e<n.paintVertexAttributes.length;e++)t.push(n.paintVertexAttributes[e].name)}return t}getBinderUniforms(){const t=[];for(const e in this.binders){const n=this.binders[e];if(n instanceof Gc||n instanceof qc||n instanceof Wc)for(const e of n.uniformNames)t.push(e)}return t}getPaintVertexBuffers(){return this._buffers}getUniforms(t){const e=[];for(const n in this.binders){const i=this.binders[n];if(i instanceof Gc||i instanceof qc||i instanceof Wc)for(const a of i.uniformNames)e.push({name:a,property:n,binding:i.getBinding(t,a)})}return e}setUniforms(t,e,n,i,a){for(const{name:e,property:r,binding:o}of n)this.binders[r].setUniform(t,o,a,i.get(r),e)}updatePaintBuffers(){this._buffers=[];for(const t in this.binders){const e=this.binders[t];(e instanceof $c||e instanceof Wc||e instanceof Hc)&&e.paintVertexBuffer&&this._buffers.push(e.paintVertexBuffer)}}upload(t){for(const e in this.binders){const n=this.binders[e];(n instanceof $c||n instanceof Wc||n instanceof Hc)&&n.upload(t)}this.updatePaintBuffers()}destroy(){for(const t in this.binders){const e=this.binders[t];(e instanceof $c||e instanceof Wc||e instanceof Hc)&&e.destroy()}}}class Yc{constructor(t,e,n=(()=>!0)){this.programConfigurations={};for(const i of t)this.programConfigurations[i.id]=new Zc(i,e,n);this.needsUpload=!1,this._featureMap=new Tc,this._featureMapWithoutIds=new Tc,this._bufferOffset=0,this._idlessCounter=0}populatePaintArrays(t,e,n,i,a,r,o,s){for(const n in this.programConfigurations)this.programConfigurations[n].populatePaintArrays(t,e,i,a,r,o,s);void 0!==e.id?this._featureMap.add(e.id,n,this._bufferOffset,t):(this._featureMapWithoutIds.add(this._idlessCounter,n,this._bufferOffset,t),this._idlessCounter+=1),this._bufferOffset=t,this.needsUpload=!0}updatePaintArrays(t,e,n,i,a,r){for(const o of n)this.needsUpload=this.programConfigurations[o.id].updatePaintArrays(t,this._featureMap,this._featureMapWithoutIds,e,o,i,a,r||0)||this.needsUpload}get(t){return this.programConfigurations[t]}upload(t){if(this.needsUpload){for(const e in this.programConfigurations)this.programConfigurations[e].upload(t);this.needsUpload=!1}}destroy(){for(const t in this.programConfigurations)this.programConfigurations[t].destroy()}}const Xc={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-occlusion-opacity":["occlusion_opacity"],"icon-occlusion-opacity":["occlusion_opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-emissive-strength":["emissive_strength"],"icon-emissive-strength":["emissive_strength"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function Kc(t,e){return Xc[t]||[t.replace(`${e}-`,"").replace(/-/g,"_")]}const Qc={"line-pattern":{source:Nl,composite:Nl},"fill-pattern":{source:Nl,composite:Nl},"fill-extrusion-pattern":{source:Nl,composite:Nl},"line-dasharray":{source:jl,composite:jl}},Jc={color:{source:nc,composite:Rl},number:{source:$l,composite:nc}};function tu(t,e,n){const i=Qc[t];return i&&i[n]||Jc[e][n]}bs(Gc,"ConstantBinder"),bs(qc,"PatternConstantBinder"),bs($c,"SourceExpressionBinder"),bs(Hc,"PatternCompositeBinder"),bs(Wc,"CompositeExpressionBinder"),bs(Zc,"ProgramConfiguration",{omit:["_buffers"]}),bs(Yc,"ProgramConfigurationSet");const eu=ur/Math.PI/2,nu=5,iu=6,au=16383,ru=64,ou=[ru,32,16],su=-eu,lu=eu;function cu(t,e,n,i=eu){return n=qe(n),[t*Math.sin(n)*i,-e*i,t*Math.cos(n)*i]}function uu(t,e,n){return cu(Math.cos(qe(t)),Math.sin(qe(t)),e,n)}const hu=6371008.8,du=2*Math.PI*hu;class pu{constructor(t,e){if(isNaN(t)||isNaN(e))throw new Error(`Invalid LngLat object: (${t}, ${e})`);if(this.lng=+t,this.lat=+e,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new pu(Qe(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(t){const e=Math.PI/180,n=this.lat*e,i=t.lat*e,a=Math.sin(n)*Math.sin(i)+Math.cos(n)*Math.cos(i)*Math.cos((t.lng-this.lng)*e);return hu*Math.acos(Math.min(a,1))}toBounds(t=0){const e=360*t/40075017,n=e/Math.cos(Math.PI/180*this.lat);return new fu({lng:this.lng-n,lat:this.lat-e},{lng:this.lng+n,lat:this.lat+e})}toEcef(t){return uu(this.lat,this.lng,eu+t*eu/hu)}static convert(t){if(t instanceof pu)return t;if(Array.isArray(t)&&(2===t.length||3===t.length))return new pu(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&"object"==typeof t&&null!==t)return new pu(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}class fu{constructor(t,e){if(t)if(e)this.setSouthWest(t).setNorthEast(e);else if(4===t.length){const e=t;this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]])}else{const e=t;this.setSouthWest(e[0]).setNorthEast(e[1])}}setNorthEast(t){return this._ne=t instanceof pu?new pu(t.lng,t.lat):pu.convert(t),this}setSouthWest(t){return this._sw=t instanceof pu?new pu(t.lng,t.lat):pu.convert(t),this}extend(t){const e=this._sw,n=this._ne;let i,a;if(t instanceof pu)i=t,a=t;else{if(!(t instanceof fu))return Array.isArray(t)?4===t.length||t.every(Array.isArray)?this.extend(fu.convert(t)):this.extend(pu.convert(t)):"object"==typeof t&&null!==t&&t.hasOwnProperty("lat")&&(t.hasOwnProperty("lon")||t.hasOwnProperty("lng"))?this.extend(pu.convert(t)):this;if(i=t._sw,a=t._ne,!i||!a)return this}return e||n?(e.lng=Math.min(i.lng,e.lng),e.lat=Math.min(i.lat,e.lat),n.lng=Math.max(a.lng,n.lng),n.lat=Math.max(a.lat,n.lat)):(this._sw=new pu(i.lng,i.lat),this._ne=new pu(a.lng,a.lat)),this}getCenter(){return new pu((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new pu(this.getWest(),this.getNorth())}getSouthEast(){return new pu(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(t){const{lng:e,lat:n}=pu.convert(t);let i=this._sw.lng<=e&&e<=this._ne.lng;return this._sw.lng>this._ne.lng&&(i=this._sw.lng>=e&&e>=this._ne.lng),this._sw.lat<=n&&n<=this._ne.lat&&i}static convert(t){return!t||t instanceof fu?t:new fu(t)}}var mu={};!function(t,e){!function(t){function e(t,e,i){var a=n(256*t,256*(e=Math.pow(2,i)-e-1),i),r=n(256*(t+1),256*(e+1),i);return a[0]+","+a[1]+","+r[0]+","+r[1]}function n(t,e,n){var i=2*Math.PI*6378137/256/Math.pow(2,n);return[t*i-2*Math.PI*6378137/2,e*i-2*Math.PI*6378137/2]}t.getURL=function(t,n,i,a,r,o){return o=o||{},t+"?"+["bbox="+e(i,a,r),"format="+(o.format||"image/png"),"service="+(o.service||"WMS"),"version="+(o.version||"1.1.1"),"request="+(o.request||"GetMap"),"srs="+(o.srs||"EPSG:3857"),"width="+(o.width||256),"height="+(o.height||256),"layers="+n].join("&")},t.getTileBBox=e,t.getMercCoords=n,Object.defineProperty(t,"__esModule",{value:!0})}(e)}(0,mu);var gu=mu;class _u{constructor(t,e,n){this.z=t,this.x=e,this.y=n,this.key=vu(0,t,t,e,n)}equals(t){return this.z===t.z&&this.x===t.x&&this.y===t.y}url(t,e){const n=gu.getTileBBox(this.x,this.y,this.z),i=function(t,e,n){let i,a="";for(let r=t;r>0;r--)i=1<<r-1,a+=(e&i?1:0)+(n&i?2:0);return a}(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String("tms"===e?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",i).replace("{bbox-epsg-3857}",n)}toString(){return`${this.z}/${this.x}/${this.y}`}}class yu{constructor(t,e){this.wrap=t,this.canonical=e,this.key=vu(t,e.z,e.z,e.x,e.y)}}class xu{constructor(t,e,n,i,a){this.overscaledZ=t,this.wrap=e,this.canonical=new _u(n,+i,+a),this.key=0===e&&t===n?this.canonical.key:vu(e,t,n,i,a)}equals(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)}scaledTo(t){const e=this.canonical.z-t;return t>this.canonical.z?new xu(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new xu(t,this.wrap,t,this.canonical.x>>e,this.canonical.y>>e)}calculateScaledKey(t,e=!0){if(this.overscaledZ===t&&e)return this.key;if(t>this.canonical.z)return vu(this.wrap*+e,t,this.canonical.z,this.canonical.x,this.canonical.y);{const n=this.canonical.z-t;return vu(this.wrap*+e,t,t,this.canonical.x>>n,this.canonical.y>>n)}}isChildOf(t){if(t.wrap!==this.wrap)return!1;const e=this.canonical.z-t.canonical.z;return 0===t.overscaledZ||t.overscaledZ<this.overscaledZ&&t.canonical.z<this.canonical.z&&t.canonical.x===this.canonical.x>>e&&t.canonical.y===this.canonical.y>>e}children(t){if(this.overscaledZ>=t)return[new xu(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const e=this.canonical.z+1,n=2*this.canonical.x,i=2*this.canonical.y;return[new xu(e,this.wrap,e,n,i),new xu(e,this.wrap,e,n+1,i),new xu(e,this.wrap,e,n,i+1),new xu(e,this.wrap,e,n+1,i+1)]}isLessThan(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))}wrapped(){return new xu(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(t){return new xu(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new yu(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function vu(t,e,n,i,a){const r=1<<Math.min(n,22);let o=r*(a%r)+i%r;return t&&n<22&&(o+=r*r*((t<0?-2*t-1:2*t)%(1<<2*(22-n)))),16*(32*o+n)+(e-n)}const bu=[t=>{let e=t.canonical.x-1,n=t.wrap;return e<0&&(e=(1<<t.canonical.z)-1,n--),new xu(t.overscaledZ,n,t.canonical.z,e,t.canonical.y)},t=>{let e=t.canonical.x+1,n=t.wrap;return e===1<<t.canonical.z&&(e=0,n++),new xu(t.overscaledZ,n,t.canonical.z,e,t.canonical.y)},t=>new xu(t.overscaledZ,t.wrap,t.canonical.z,t.canonical.x,(0===t.canonical.y?1<<t.canonical.z:t.canonical.y)-1),t=>new xu(t.overscaledZ,t.wrap,t.canonical.z,t.canonical.x,t.canonical.y===(1<<t.canonical.z)-1?0:t.canonical.y+1)];bs(_u,"CanonicalTileID"),bs(xu,"OverscaledTileID",{omit:["projMatrix","expandedProjMatrix"]});const wu=0,Au=25.5;function Cu(t){return du*Math.cos(t*Math.PI/180)}function Eu(t){return(180+t)/360}function Tu(t){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t*Math.PI/360)))/360}function Su(t,e){return t/Cu(e)}function Mu(t){return 360*t-180}function ku(t){return 360/Math.PI*Math.atan(Math.exp((180-360*t)*Math.PI/180))-90}function Iu(t,e){return t*Cu(ku(e))}const Pu=85.051129;function zu(t){return Math.cos(qe(Xe(t,-Pu,Pu)))}function Du(t,e){const n=Xe(e,wu,Au),i=Math.pow(2,n);return zu(t)*du/(512*i)}function Lu(t){return 1/Math.cos(t*Math.PI/180)}function Bu(t,e=0){const n=Math.exp(Math.PI*(1-(t.y+e/ur)/(1<<t.z)*2));return 80150034*n/(n*n+1)/ur/(1<<t.z)}class Ou{constructor(t,e,n=0){this.x=+t,this.y=+e,this.z=+n}static fromLngLat(t,e=0){const n=pu.convert(t);return new Ou(Eu(n.lng),Tu(n.lat),Su(e,n.lat))}toLngLat(){return new pu(Mu(this.x),ku(this.y))}toAltitude(){return Iu(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/du*Lu(ku(this.y))}}function Ru(t,e,n,i,a,r,o,s,l){const c=(e+i)/2,u=(n+a)/2,h=new Ve(c,u);s(h),function(t,e,n,i,a,r){const o=n-a,s=i-r;return Math.abs((i-e)*o-(n-t)*s)/Math.hypot(o,s)}(h.x,h.y,r.x,r.y,o.x,o.y)>=l?(Ru(t,e,n,c,u,r,h,s,l),Ru(t,c,u,i,a,h,o,s,l)):t.push(o)}function Fu(t,e,n){let i=t[0],a=i.x,r=i.y;e(i);const o=[i];for(let s=1;s<t.length;s++){const l=t[s],{x:c,y:u}=l;e(l),Ru(o,a,r,c,u,i,l,e,n),a=c,r=u,i=l}return o}function Nu(t,e,n,i){if(i(e,n)){const a=e.add(n)._mult(.5);Nu(t,e,a,i),Nu(t,a,n,i)}else t.push(n)}function ju(t,e){let n=t[0];const i=[n];for(let a=1;a<t.length;a++){const r=t[a];Nu(i,n,r,e),n=r}return i}const Vu=Math.pow(2,14)-1,Uu=-Vu-1;function Gu(t,e){const n=Math.round(t.x*e),i=Math.round(t.y*e);return t.x=Xe(n,Uu,Vu),t.y=Xe(i,Uu,Vu),(n<t.x||n>t.x+1||i<t.y||i>t.y+1)&&fn("Geometry exceeds allowed extent, reduce your vector tile buffer size"),t}function qu(t,e,n){const i=t.loadGeometry(),a=t.extent,r=ur/a;if(e&&n&&n.projection.isReprojectedInTileSpace){const r=1<<e.z,{scale:o,x:s,y:l,projection:c}=n,u=t=>{const n=Mu((e.x+t.x/a)/r),i=ku((e.y+t.y/a)/r),u=c.project(n,i);t.x=(u.x*o-s)*a,t.y=(u.y*o-l)*a};for(let e=0;e<i.length;e++)if(1!==t.type)i[e]=Fu(i[e],u,1);else{const t=[];for(const n of i[e])n.x<0||n.x>=a||n.y<0||n.y>=a||(u(n),t.push(n));i[e]=t}}for(const t of i)for(const e of t)Gu(e,r);return i}function $u(t,e){return{type:t.type,id:t.id,properties:t.properties,geometry:e?qu(t):[]}}function Wu(t,e,n,i,a){t.emplaceBack(2*e+(i+1)/2,2*n+(a+1)/2)}function Hu(t,e,n){const i=16384;t.emplaceBack(e.x,e.y,e.z,n[0]*i,n[1]*i,n[2]*i)}class Zu{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((t=>t.fqid)),this.index=t.index,this.hasPattern=!1,this.projection=t.projection,this.layoutVertexArray=new zl,this.indexArray=new Kl,this.segments=new wc,this.programConfigurations=new Yc(t.layers,{zoom:t.zoom,lut:t.lut}),this.stateDependentLayerIds=this.layers.filter((t=>t.isStateDependent())).map((t=>t.id))}updateFootprints(t,e){}populate(t,e,n,i){const a=this.layers[0],r=[];let o=null;"circle"===a.type&&(o=a.layout.get("circle-sort-key"));for(const{feature:e,id:a,index:s,sourceLayerIndex:l}of t){const t=this.layers[0]._featureFilter.needGeometry,c=$u(e,t);if(!this.layers[0]._featureFilter.filter(new Hs(this.zoom),c,n))continue;const u=o?o.evaluate(c,{},n):void 0,h={id:a,properties:e.properties,type:e.type,sourceLayerIndex:l,index:s,geometry:t?c.geometry:qu(e,n,i),patterns:{},sortKey:u};r.push(h)}o&&r.sort(((t,e)=>t.sortKey-e.sortKey));let s=null;"globe"===i.projection.name&&(this.globeExtVertexArray=new Vl,s=i.projection);for(const i of r){const{geometry:a,index:r,sourceLayerIndex:o}=i,l=t[r].feature;this.addFeature(i,a,r,e.availableImages,n,s,e.brightness),e.featureIndex.insert(l,a,r,o,this.index)}}update(t,e,n,i,a){const r=0!==Object.keys(t).length;r&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(t,e,r?this.stateDependentLayers:this.layers,n,i,a)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,vc.members),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=t.createVertexBuffer(this.globeExtVertexArray,bc.members))),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(t,e,n,i,a,r,o){for(const n of e)for(const e of n){const n=e.x,i=e.y;if(n<0||n>=ur||i<0||i>=ur)continue;if(r){const t=r.projectTilePoint(n,i,a),e=r.upVector(a,n,i),o=this.globeExtVertexArray;Hu(o,t,e),Hu(o,t,e),Hu(o,t,e),Hu(o,t,e)}const o=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,t.sortKey),s=o.vertexLength;Wu(this.layoutVertexArray,n,i,-1,-1),Wu(this.layoutVertexArray,n,i,1,-1),Wu(this.layoutVertexArray,n,i,1,1),Wu(this.layoutVertexArray,n,i,-1,1),this.indexArray.emplaceBack(s,s+1,s+2),this.indexArray.emplaceBack(s,s+2,s+3),o.vertexLength+=4,o.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,n,{},i,a,o)}}function Yu(t,e){for(let n=0;n<t.length;n++)if(ah(e,t[n]))return!0;for(let n=0;n<e.length;n++)if(ah(t,e[n]))return!0;return!!Ju(t,e)}function Xu(t,e,n){return!!ah(t,e)||!!eh(e,t,n)}function Ku(t,e){if(1===t.length)return ih(e,t[0]);for(let n=0;n<e.length;n++){const i=e[n];for(let e=0;e<i.length;e++)if(ah(t,i[e]))return!0}for(let n=0;n<t.length;n++)if(ih(e,t[n]))return!0;for(let n=0;n<e.length;n++)if(Ju(t,e[n]))return!0;return!1}function Qu(t,e,n){if(t.length>1){if(Ju(t,e))return!0;for(let i=0;i<e.length;i++)if(eh(e[i],t,n))return!0}for(let i=0;i<t.length;i++)if(eh(t[i],e,n))return!0;return!1}function Ju(t,e){if(0===t.length||0===e.length)return!1;for(let n=0;n<t.length-1;n++){const i=t[n],a=t[n+1];for(let t=0;t<e.length-1;t++)if(th(i,a,e[t],e[t+1]))return!0}return!1}function th(t,e,n,i){return mn(t,n,i)!==mn(e,n,i)&&mn(t,e,n)!==mn(t,e,i)}function eh(t,e,n){const i=n*n;if(1===e.length)return t.distSqr(e[0])<i;for(let n=1;n<e.length;n++)if(nh(t,e[n-1],e[n])<i)return!0;return!1}function nh(t,e,n){const i=e.distSqr(n);if(0===i)return t.distSqr(e);const a=((t.x-e.x)*(n.x-e.x)+(t.y-e.y)*(n.y-e.y))/i;return t.distSqr(a<0?e:a>1?n:n.sub(e)._mult(a)._add(e))}function ih(t,e){let n,i,a,r=!1;for(let o=0;o<t.length;o++){n=t[o];for(let t=0,o=n.length-1;t<n.length;o=t++)i=n[t],a=n[o],i.y>e.y!=a.y>e.y&&e.x<(a.x-i.x)*(e.y-i.y)/(a.y-i.y)+i.x&&(r=!r)}return r}function ah(t,e){let n=!1;for(let i=0,a=t.length-1;i<t.length;a=i++){const r=t[i],o=t[a];r.y>e.y!=o.y>e.y&&e.x<(o.x-r.x)*(e.y-r.y)/(o.y-r.y)+r.x&&(n=!n)}return n}function rh(t,e,n,i,a){for(const r of t)if(e<=r.x&&n<=r.y&&i>=r.x&&a>=r.y)return!0;const r=[new Ve(e,n),new Ve(e,a),new Ve(i,a),new Ve(i,n)];if(t.length>2)for(const e of r)if(ah(t,e))return!0;for(let e=0;e<t.length-1;e++)if(oh(t[e],t[e+1],r))return!0;return!1}function oh(t,e,n){const i=n[0],a=n[2];if(t.x<i.x&&e.x<i.x||t.x>a.x&&e.x>a.x||t.y<i.y&&e.y<i.y||t.y>a.y&&e.y>a.y)return!1;const r=mn(t,e,n[0]);return r!==mn(t,e,n[1])||r!==mn(t,e,n[2])||r!==mn(t,e,n[3])}function sh(t,e,n,i,a,r){let o=e.y-t.y,s=t.x-e.x;if(r=r||0){const t=o*o+s*s;if(0===t)return!0;const e=Math.sqrt(t);o/=e,s/=e}return!((n.x-t.x)*o+(n.y-t.y)*s-r<0||(i.x-t.x)*o+(i.y-t.y)*s-r<0||(a.x-t.x)*o+(a.y-t.y)*s-r<0)}function lh(t,e,n,i,a,r,o){return!(sh(t,e,i,a,r,o)||sh(e,n,i,a,r,o)||sh(n,t,i,a,r,o)||sh(i,a,t,e,n,o)||sh(a,r,t,e,n,o)||sh(r,i,t,e,n,o))}function ch(t,e,n){const i=e.paint.get(t).value;return"constant"===i.kind?i.value:n.programConfigurations.get(e.id).getMaxValue(t)}function uh(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function hh(t,e,n,i,a){if(!e[0]&&!e[1])return t;const r=Ve.convert(e)._mult(a);"viewport"===n&&r._rotate(-i);const o=[];for(let e=0;e<t.length;e++)o.push(t[e].sub(r));return o}function dh(t,e,n,i){const a=Ve.convert(t)._mult(i);return"viewport"===e&&a._rotate(-n),a}bs(Zu,"CircleBucket",{omit:["layers"]});const ph=new rl({"circle-sort-key":new il(ol.layout_circle["circle-sort-key"]),visibility:new nl(ol.layout_circle.visibility)});var fh={paint:new rl({"circle-radius":new il(ol.paint_circle["circle-radius"]),"circle-color":new il(ol.paint_circle["circle-color"]),"circle-blur":new il(ol.paint_circle["circle-blur"]),"circle-opacity":new il(ol.paint_circle["circle-opacity"]),"circle-translate":new nl(ol.paint_circle["circle-translate"]),"circle-translate-anchor":new nl(ol.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new nl(ol.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new nl(ol.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new il(ol.paint_circle["circle-stroke-width"]),"circle-stroke-color":new il(ol.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new il(ol.paint_circle["circle-stroke-opacity"]),"circle-emissive-strength":new nl(ol.paint_circle["circle-emissive-strength"])}),layout:ph};class mh{constructor(t,e){this.pos=t,this.dir=e}intersectsPlane(e,n,i){const a=t._.dot(n,this.dir);if(Math.abs(a)<1e-6)return!1;const r=((e[0]-this.pos[0])*n[0]+(e[1]-this.pos[1])*n[1]+(e[2]-this.pos[2])*n[2])/a;return i[0]=this.pos[0]+this.dir[0]*r,i[1]=this.pos[1]+this.dir[1]*r,i[2]=this.pos[2]+this.dir[2]*r,!0}closestPointOnSphere(e,n,i){if(t._.equals(this.pos,e)||0===n)return i[0]=i[1]=i[2]=0,!1;const[a,r,o]=this.dir,s=this.pos[0]-e[0],l=this.pos[1]-e[1],c=this.pos[2]-e[2],u=a*a+r*r+o*o,h=2*(s*a+l*r+c*o),d=h*h-4*u*(s*s+l*l+c*c-n*n);if(d<0){const t=Math.max(-h/2,0),e=s+a*t,u=l+r*t,d=c+o*t,p=Math.hypot(e,u,d);return i[0]=e*n/p,i[1]=u*n/p,i[2]=d*n/p,!1}{const t=(-h-Math.sqrt(d))/(2*u);if(t<0){const t=Math.hypot(s,l,c);return i[0]=s*n/t,i[1]=l*n/t,i[2]=c*n/t,!1}return i[0]=s+a*t,i[1]=l+r*t,i[2]=c+o*t,!0}}}class gh{constructor(t,e,n,i,a){this.TL=t,this.TR=e,this.BR=n,this.BL=i,this.horizon=a}static fromInvProjectionMatrix(e,n,i){const a=[-1,1,1],r=[1,1,1],o=[1,-1,1],s=[-1,-1,1],l=t._.transformMat4(a,a,e),c=t._.transformMat4(r,r,e),u=t._.transformMat4(o,o,e),h=t._.transformMat4(s,s,e);return new gh(l,c,u,h,n/i)}}function _h(e,n,i){let a=1/0,r=-1/0;const o=[];for(const s of e){t._.sub(o,s,n);const e=t._.dot(o,i);a=Math.min(a,e),r=Math.max(r,e)}return[a,r]}function yh(e,n){let i=!0;for(let a=0;a<e.planes.length;a++){const r=e.planes[a];let o=0;for(let e=0;e<n.length;e++)o+=t._.dot(r,n[e])+r[3]>=0;if(0===o)return 0;o!==n.length&&(i=!1)}return i?2:1}function xh(t,e){for(const n of t.projections){const i=_h(e,t.points[0],n.axis);if(n.projection[1]<i[0]||n.projection[0]>i[1])return 0}return 1}function vh(e,n){let i=0;const a=[0,0,0,0];for(let r=0;r<e.length;r++)a[0]=e[r][0],a[1]=e[r][1],a[2]=e[r][2],a[3]=1,t.aA.dot(a,n)>=0&&i++;return i}class bh{constructor(e,n){this.points=e||new Array(8).fill([0,0,0]),this.planes=n||new Array(6).fill([0,0,0,0]),this.bounds=wh.fromPoints(this.points),this.projections=[],this.frustumEdges=[t._.sub([],this.points[2],this.points[3]),t._.sub([],this.points[0],this.points[3]),t._.sub([],this.points[4],this.points[0]),t._.sub([],this.points[5],this.points[1]),t._.sub([],this.points[6],this.points[2]),t._.sub([],this.points[7],this.points[3])];for(const t of this.frustumEdges){const e=[0,-t[2],t[1]],n=[t[2],0,-t[0]];this.projections.push({axis:e,projection:_h(this.points,this.points[0],e)}),this.projections.push({axis:n,projection:_h(this.points,this.points[0],n)})}}static fromInvProjectionMatrix(e,n,i,a){const r=Math.pow(2,i),o=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map((i=>{const o=t.aA.transformMat4([],i,e),s=1/o[3]/n*r;return t.aA.mul(o,o,[s,s,a?1/o[3]:s,s])})),s=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map((e=>{const n=t._.sub([],o[e[0]],o[e[1]]),i=t._.sub([],o[e[2]],o[e[1]]),a=t._.normalize([],t._.cross([],n,i)),r=-t._.dot(a,o[e[1]]);return a.concat(r)})),l=[];for(let t=0;t<o.length;t++)l.push([o[t][0],o[t][1],o[t][2]]);return new bh(l,s)}intersectsPrecise(e,n,i){for(let t=0;t<n.length;t++)if(!vh(e,n[t]))return 0;for(let t=0;t<this.planes.length;t++)if(!vh(e,this.planes[t]))return 0;for(const n of i)for(const i of this.frustumEdges){const a=t._.cross([],n,i),r=t._.length(a);if(0===r)continue;t._.scale(a,a,1/r);const o=_h(this.points,this.points[0],a),s=_h(e,this.points[0],a);if(o[0]>s[1]||s[0]>o[1])return 0}return 1}}class wh{static fromPoints(e){const n=[1/0,1/0,1/0],i=[-1/0,-1/0,-1/0];for(const a of e)t._.min(n,n,a),t._.max(i,i,a);return new wh(n,i)}static fromTileIdAndHeight(t,e,n){const i=1<<t.canonical.z,a=t.canonical.x,r=t.canonical.y;return new wh([a/i,r/i,e],[(a+1)/i,(r+1)/i,n])}static applyTransform(e,n){const i=e.getCorners();for(let e=0;e<i.length;++e)t._.transformMat4(i[e],i[e],n);return wh.fromPoints(i)}static projectAabbCorners(e,n){const i=e.getCorners();for(let e=0;e<i.length;++e)t._.transformMat4(i[e],i[e],n);return i}constructor(e,n){this.min=e,this.max=n,this.center=t._.scale([],t._.add([],this.min,this.max),.5)}quadrant(e){const n=[e%2==0,e<2],i=t._.clone(this.min),a=t._.clone(this.max);for(let t=0;t<n.length;t++)i[t]=n[t]?this.min[t]:this.center[t],a[t]=n[t]?this.center[t]:this.max[t];return a[2]=this.max[2],new wh(i,a)}distanceX(t){return Math.max(Math.min(this.max[0],t[0]),this.min[0])-t[0]}distanceY(t){return Math.max(Math.min(this.max[1],t[1]),this.min[1])-t[1]}distanceZ(t){return Math.max(Math.min(this.max[2],t[2]),this.min[2])-t[2]}getCorners(){const t=this.min,e=this.max;return[[t[0],t[1],t[2]],[e[0],t[1],t[2]],[e[0],e[1],t[2]],[t[0],e[1],t[2]],[t[0],t[1],e[2]],[e[0],t[1],e[2]],[e[0],e[1],e[2]],[t[0],e[1],e[2]]]}intersects(t){return this.intersectsAabb(t.bounds)?yh(t,this.getCorners()):0}intersectsFlat(t){return this.intersectsAabb(t.bounds)?yh(t,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsPrecise(t,e){return e||this.intersects(t)?xh(t,this.getCorners()):0}intersectsPreciseFlat(t,e){return e||this.intersectsFlat(t)?xh(t,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsAabb(t){for(let e=0;e<3;++e)if(this.min[e]>t.max[e]||t.min[e]>this.max[e])return!1;return!0}intersectsAabbXY(t){return!(this.min[0]>t.max[0]||t.min[0]>this.max[0]||this.min[1]>t.max[1]||t.min[1]>this.max[1])}encapsulate(t){for(let e=0;e<3;e++)this.min[e]=Math.min(this.min[e],t.min[e]),this.max[e]=Math.max(this.max[e],t.max[e])}encapsulatePoint(t){for(let e=0;e<3;e++)this.min[e]=Math.min(this.min[e],t[e]),this.max[e]=Math.max(this.max[e],t[e])}closestPoint(t){return[Math.max(Math.min(this.max[0],t[0]),this.min[0]),Math.max(Math.min(this.max[1],t[1]),this.min[1]),Math.max(Math.min(this.max[2],t[2]),this.min[2])]}}bs(wh,"Aabb");const Ah=Il([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:Ch}=Ah,Eh=Il([{name:"a_pos_3",components:3,type:"Int16"}]);var Th=Il([{name:"a_pos",type:"Int16",components:2}]);function Sh(t){return t*eu/hu}const Mh=[new wh([su,su,su],[lu,lu,lu]),new wh([su,su,su],[0,0,lu]),new wh([0,su,su],[lu,0,lu]),new wh([su,0,su],[0,lu,lu]),new wh([0,0,su],[lu,lu,lu])];function kh(e,n,i,a=!0){const r=t._.scale([],e._camera.position,e.worldSize),o=[n,i,1,1];t.aA.transformMat4(o,o,e.pixelMatrixInverse),t.aA.scale(o,o,1/o[3]);const s=t._.sub([],o,r),l=t._.normalize([],s),c=e.globeMatrix,u=[c[12],c[13],c[14]],h=t._.sub([],u,r),d=t._.length(h),p=t._.normalize([],h),f=e.worldSize/(2*Math.PI),m=t._.dot(p,l),g=Math.asin(f/d);if(g<Math.acos(m)){if(!a)return null;const e=[],n=[];t._.scale(e,l,d/m),t._.normalize(n,t._.sub(n,e,h)),t._.normalize(l,t._.add(l,h,t._.scale(l,n,Math.tan(g)*d)))}const _=[];new mh(r,l).closestPointOnSphere(u,f,_);const y=t._.normalize([],Mn(c,0)),x=t._.normalize([],Mn(c,1)),v=t._.normalize([],Mn(c,2)),b=t._.dot(y,_),w=t._.dot(x,_),A=t._.dot(v,_),C=$e(Math.asin(-w/f));let E=$e(Math.atan2(b,A));E=e.center.lng+function(t,e){const n=(e-t+180)%360-180;return n<-180?n+360:n}(e.center.lng,E);const T=Eu(E),S=Xe(Tu(C),0,1);return new Ou(T,S)}class Ih{constructor(e,n,i){this.a=t._.sub([],e,i),this.b=t._.sub([],n,i),this.center=i;const a=t._.normalize([],this.a),r=t._.normalize([],this.b);this.angle=Math.acos(t._.dot(a,r))}}function Ph(t,e){if(0===t.angle)return null;let n;return n=0===t.a[e]?1/t.angle*.5*Math.PI:1/t.angle*Math.atan(t.b[e]/t.a[e]/Math.sin(t.angle)-1/Math.tan(t.angle)),n<0||n>1?null:function(t,e,n,i){const a=Math.sin(n);return t*(Math.sin((1-i)*n)/a)+e*(Math.sin(i*n)/a)}(t.a[e],t.b[e],t.angle,Xe(n,0,1))+t.center[e]}function zh(t){if(t.z<=1)return Mh[t.z+2*t.y+t.x];const e=Fh(Rh(t));return wh.fromPoints(e)}function Dh(e,n,i){return t._.scale(e,e,1-i),t._.scaleAndAdd(e,e,n,i)}function Lh(e,n){const i=Hh(n.zoom);if(0===i)return zh(e);const a=Rh(e),r=Fh(a),o=Eu(a.getWest())*n.worldSize,s=Eu(a.getEast())*n.worldSize,l=Tu(a.getNorth())*n.worldSize,c=Tu(a.getSouth())*n.worldSize,u=[o,l,0],h=[s,l,0],d=[o,c,0],p=[s,c,0],f=t.ad.invert([],n.globeMatrix);return t._.transformMat4(u,u,f),t._.transformMat4(h,h,f),t._.transformMat4(d,d,f),t._.transformMat4(p,p,f),r[0]=Dh(r[0],d,i),r[1]=Dh(r[1],p,i),r[2]=Dh(r[2],h,i),r[3]=Dh(r[3],u,i),wh.fromPoints(r)}function Bh(e,n,i){for(const a of e)t._.transformMat4(a,a,n),t._.scale(a,a,i)}function Oh(e,n,i,a){const r=n/e.worldSize,o=e.globeMatrix;if(i.z<=1){const t=zh(i).getCorners();return Bh(t,o,r),wh.fromPoints(t)}const s=Rh(i,a),l=Fh(s,eu+Sh(e._tileCoverLift));Bh(l,o,r);const c=Number.MAX_VALUE,u=[-c,-c,-c],h=[c,c,c];if(s.contains(e.center)){for(const e of l)t._.min(h,h,e),t._.max(u,u,e);u[2]=0;const n=e.point,i=[n.x*r,n.y*r,0];return t._.min(h,h,i),t._.max(u,u,i),new wh(h,u)}if(e._tileCoverLift>0){for(const e of l)t._.min(h,h,e),t._.max(u,u,e);return new wh(h,u)}const d=[o[12]*r,o[13]*r,o[14]*r],p=s.getCenter(),f=Xe(e.center.lat,-Pu,Pu),m=Xe(p.lat,-Pu,Pu),g=Eu(e.center.lng),_=Tu(f);let y=g-Eu(p.lng);const x=_-Tu(m);y>.5?y-=1:y<-.5&&(y+=1);let v=0;if(Math.abs(y)>Math.abs(x))v=y>=0?1:3;else{v=x>=0?0:2;const e=[o[4]*r,o[5]*r,o[6]*r],n=-Math.sin(qe(x>=0?s.getSouth():s.getNorth()))*eu;t._.scaleAndAdd(d,d,e,n)}const b=l[v],w=l[(v+1)%4],A=new Ih(b,w,d),C=[Ph(A,0)||b[0],Ph(A,1)||b[1],Ph(A,2)||b[2]],E=Hh(e.zoom);if(E>0){const a=function({x:t,y:e,z:n},i,a,r,o){const s=1/(1<<n);let l=t*s,c=l+s,u=e*s,h=u+s,d=0;const p=(l+c)/2-r;return p>.5?d=-1:p<-.5&&(d=1),l=((l+d)*i-(r*=i))*a+r,c=((c+d)*i-r)*a+r,u=(u*i-(o*=i))*a+o,h=(h*i-o)*a+o,[[l,h,0],[c,h,0],[c,u,0],[l,u,0]]}(i,n,e._pixelsPerMercatorPixel,g,_);for(let t=0;t<l.length;t++)Dh(l[t],a[t],E);const r=t._.add([],a[v],a[(v+1)%4]);t._.scale(r,r,.5),Dh(C,r,E)}for(const e of l)t._.min(h,h,e),t._.max(u,u,e);return h[2]=Math.min(b[2],w[2]),t._.min(h,h,C),t._.max(u,u,C),new wh(h,u)}function Rh({x:t,y:e,z:n},i=!1){const a=1/(1<<n),r=new pu(Mu(t*a),e===(1<<n)-1&&i?-90:ku((e+1)*a)),o=new pu(Mu((t+1)*a),0===e&&i?90:ku(e*a));return new fu(r,o)}function Fh(t,e=eu){const n=qe(t.getNorth()),i=qe(t.getSouth()),a=Math.cos(n),r=Math.cos(i),o=Math.sin(n),s=Math.sin(i),l=t.getWest(),c=t.getEast();return[cu(r,s,l,e),cu(r,s,c,e),cu(a,o,c,e),cu(a,o,l,e)]}function Nh(t,e,n,i){const a=1<<n.z,r=(t/ur+n.x)/a;return uu(ku((e/ur+n.y)/a),Mu(r),i)}function jh({min:t,max:e}){return au/Math.max(e[0]-t[0],e[1]-t[1],e[2]-t[2])}const Vh=new Float64Array(16);function Uh(e){const n=jh(e),i=t.ad.fromScaling(Vh,[n,n,n]);return t.ad.translate(i,i,t._.negate([],e.min))}function Gh(e){const n=t.ad.fromTranslation(Vh,e.min),i=1/jh(e);return t.ad.scale(n,n,[i,i,i])}function qh(t){const e=ur/(2*Math.PI);return t/(2*Math.PI)/e}function $h(t,e){return ur/(512*Math.pow(2,t))*jh(zh(e))}function Wh(e,n,i,a,r){const o=qh(i),s=[e,n,-i/(2*Math.PI)],l=t.ad.identity(new Float64Array(16));return t.ad.translate(l,l,s),t.ad.scale(l,l,[o,o,o]),t.ad.rotateX(l,l,qe(-r)),t.ad.rotateY(l,l,qe(-a)),l}function Hh(t){return Ke(nu,iu,t)}function Zh(e,n){const i=uu(n.lat,n.lng),a=function(e){const n=uu(e._center.lat,e._center.lng),i=t._.fromValues(0,1,0);let a=t._.cross([],i,n);const r=t.ad.fromRotation([],-e.angle,n);a=t._.transformMat4(a,a,r),t.ad.fromRotation(r,-e._pitch,a);const o=t._.normalize([],n);return t._.scale(o,o,Sh(e.cameraToCenterDistance/e.pixelsPerMeter)),t._.transformMat4(o,o,r),t._.add([],n,o)}(e),r=t._.subtract([],a,i);return t._.angle(r,i)}function Yh(t,e){return Zh(t,e)>Math.PI/2*1.01}const Xh=qe(85),Kh=Math.cos(Xh),Qh=Math.sin(Xh),Jh=t.ad.create(),td=t=>{const e=[];return"map"===t.paint.get("circle-pitch-alignment")&&e.push("PITCH_WITH_MAP"),"map"===t.paint.get("circle-pitch-scale")&&e.push("SCALE_WITH_MAP"),e};function ed(e,n,i,a,r,o,s,l,c){if(o&&e.queryGeometry.isAboveHorizon)return!1;o&&(c*=e.pixelToTileUnitsFactor);const u=e.tileID.canonical,h=i.projection.upVectorScale(u,i.center.lat,i.worldSize).metersToTile;for(const d of n)for(const n of d){const d=n.add(l),p=r&&i.elevation?i.elevation.exaggeration()*r.getElevationAt(d.x,d.y,!0):0,f=i.projection.projectTilePoint(d.x,d.y,u);if(p>0){const t=i.projection.upVector(u,d.x,d.y);f.x+=t[0]*h*p,f.y+=t[1]*h*p,f.z+=t[2]*h*p}const m=o?d:nd(f.x,f.y,f.z,a),g=o?e.tilespaceRays.map((t=>rd(t,p))):e.queryGeometry.screenGeometry,_=t.aA.transformMat4([],[f.x,f.y,f.z,1],a);if(!s&&o?c*=_[3]/i.cameraToCenterDistance:s&&!o&&(c*=i.cameraToCenterDistance/_[3]),o){const t=ku((n.y/ur+u.y)/(1<<u.z));c/=i.projection.pixelsPerMeter(t,1)/Su(1,t)}if(Xu(g,m,c))return!0}return!1}function nd(e,n,i,a){const r=t.aA.transformMat4([],[e,n,i,1],a);return new Ve(r[0]/r[3],r[1]/r[3])}const id=t._.fromValues(0,0,0),ad=t._.fromValues(0,0,1);function rd(e,n){const i=t._.create();return id[2]=n,e.intersectsPlane(id,ad,i),new Ve(i[0],i[1])}class od extends Zu{}function sd(t,{width:e,height:n},i,a){if(a){if(a instanceof Uint8ClampedArray)a=new Uint8Array(a.buffer);else if(a.length!==e*n*i)throw new RangeError("mismatched image size")}else a=new Uint8Array(e*n*i);return t.width=e,t.height=n,t.data=a,t}function ld(t,e,n){const{width:i,height:a}=e;i===t.width&&a===t.height||(cd(t,e,{x:0,y:0},{x:0,y:0},{width:Math.min(t.width,i),height:Math.min(t.height,a)},n,null),t.width=i,t.height=a,t.data=e.data)}function cd(t,e,n,i,a,r,o,s){if(0===a.width||0===a.height)return e;if(a.width>t.width||a.height>t.height||n.x>t.width-a.width||n.y>t.height-a.height)throw new RangeError("out of range source coordinates for image copy");if(a.width>e.width||a.height>e.height||i.x>e.width-a.width||i.y>e.height-a.height)throw new RangeError("out of range destination coordinates for image copy");const l=t.data,c=e.data,u=4===r&&s;for(let s=0;s<a.height;s++){const h=((n.y+s)*t.width+n.x)*r,d=((i.y+s)*e.width+i.x)*r;if(u)for(let t=0;t<a.width;t++){const e=h+t*r+3,n=d+t*r;c[n+0]=255,c[n+1]=255,c[n+2]=255,c[n+3]=l[e]}else if(o)for(let t=0;t<a.width;t++){const e=h+t*r,n=d+t*r,i=l[e+3],a=new Vi(l[e+0]/255*i,l[e+1]/255*i,l[e+2]/255*i,i).toRenderColor(o).toArray();c[n+0]=a[0],c[n+1]=a[1],c[n+2]=a[2],c[n+3]=a[3]}else for(let t=0;t<a.width*r;t++)c[d+t]=l[h+t]}return e}bs(od,"HeatmapBucket",{omit:["layers"]});class ud{constructor(t,e){sd(this,t,1,e)}resize(t){ld(this,new ud(t),1)}clone(){return new ud({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,e,n,i,a){cd(t,e,n,i,a,1,null)}}class hd{constructor(t,e){sd(this,t,4,e)}resize(t){ld(this,new hd(t),4)}replace(t,e){e?this.data.set(t):this.data=t instanceof Uint8ClampedArray?new Uint8Array(t.buffer):t}clone(){return new hd({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,e,n,i,a,r,o){cd(t,e,n,i,a,4,r,o)}}class dd{constructor(t,e){this.width=t.width,this.height=t.height,this.data=e instanceof Uint8Array?new Float32Array(e.buffer):e}}bs(ud,"AlphaImage"),bs(hd,"RGBAImage");const pd=new rl({visibility:new nl(ol.layout_heatmap.visibility)});var fd={paint:new rl({"heatmap-radius":new il(ol.paint_heatmap["heatmap-radius"]),"heatmap-weight":new il(ol.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new nl(ol.paint_heatmap["heatmap-intensity"]),"heatmap-color":new al(ol.paint_heatmap["heatmap-color"]),"heatmap-opacity":new nl(ol.paint_heatmap["heatmap-opacity"])}),layout:pd};function md(t){const e={},n=t.resolution||256,i=t.clips?t.clips.length:1,a=t.image||new hd({width:n,height:i}),r=(n,i,r)=>{e[t.evaluationKey]=r;const o=t.expression.evaluate(e);o&&(a.data[n+i+0]=Math.floor(255*o.r/o.a),a.data[n+i+1]=Math.floor(255*o.g/o.a),a.data[n+i+2]=Math.floor(255*o.b/o.a),a.data[n+i+3]=Math.floor(255*o.a))};if(t.clips)for(let e=0,a=0;e<i;++e,a+=4*n)for(let i=0,o=0;i<n;i++,o+=4){const s=i/(n-1),{start:l,end:c}=t.clips[e];r(a,o,l*(1-s)+c*s)}else for(let t=0,e=0;t<n;t++,e+=4)r(0,e,t/(n-1));return a}const gd=new rl({visibility:new nl(ol.layout_hillshade.visibility)});var _d={paint:new rl({"hillshade-illumination-direction":new nl(ol.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new nl(ol.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new nl(ol.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new nl(ol.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new nl(ol.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new nl(ol.paint_hillshade["hillshade-accent-color"]),"hillshade-emissive-strength":new nl(ol.paint_hillshade["hillshade-emissive-strength"])}),layout:gd};const yd=Il([{name:"a_pos",components:2,type:"Int16"}],4),{members:xd}=yd;function vd(t,e,n=2){const i=e&&e.length,a=i?e[0]*n:t.length;let r=bd(t,0,a,n,!0);const o=[];if(!r||r.next===r.prev)return o;let s,l,c;if(i&&(r=function(t,e,n,i){const a=[];for(let n=0,r=e.length;n<r;n++){const o=bd(t,e[n]*i,n<r-1?e[n+1]*i:t.length,i,!1);o===o.next&&(o.steiner=!0),a.push(zd(o))}a.sort(Md);for(let t=0;t<a.length;t++)n=kd(a[t],n);return n}(t,e,r,n)),t.length>80*n){s=1/0,l=1/0;let e=-1/0,i=-1/0;for(let r=n;r<a;r+=n){const n=t[r],a=t[r+1];n<s&&(s=n),a<l&&(l=a),n>e&&(e=n),a>i&&(i=a)}c=Math.max(e-s,i-l),c=0!==c?32767/c:0}return Ad(r,o,n,s,l,c,0),o}function bd(t,e,n,i,a){let r;if(a===function(t,e,n,i){let a=0;for(let r=e,o=n-i;r<n;r+=i)a+=(t[o]-t[r])*(t[r+1]+t[o+1]),o=r;return a}(t,e,n,i)>0)for(let a=e;a<n;a+=i)r=Ud(a/i|0,t[a],t[a+1],r);else for(let a=n-i;a>=e;a-=i)r=Ud(a/i|0,t[a],t[a+1],r);return r&&Od(r,r.next)&&(Gd(r),r=r.next),r}function wd(t,e){if(!t)return t;e||(e=t);let n,i=t;do{if(n=!1,i.steiner||!Od(i,i.next)&&0!==Bd(i.prev,i,i.next))i=i.next;else{if(Gd(i),i=e=i.prev,i===i.next)break;n=!0}}while(n||i!==e);return e}function Ad(t,e,n,i,a,r,o){if(!t)return;!o&&r&&function(t,e,n,i){let a=t;do{0===a.z&&(a.z=Pd(a.x,a.y,e,n,i)),a.prevZ=a.prev,a.nextZ=a.next,a=a.next}while(a!==t);a.prevZ.nextZ=null,a.prevZ=null,function(t){let e,n=1;do{let i,a=t;t=null;let r=null;for(e=0;a;){e++;let o=a,s=0;for(let t=0;t<n&&(s++,o=o.nextZ,o);t++);let l=n;for(;s>0||l>0&&o;)0!==s&&(0===l||!o||a.z<=o.z)?(i=a,a=a.nextZ,s--):(i=o,o=o.nextZ,l--),r?r.nextZ=i:t=i,i.prevZ=r,r=i;a=o}r.nextZ=null,n*=2}while(e>1)}(a)}(t,i,a,r);let s=t;for(;t.prev!==t.next;){const l=t.prev,c=t.next;if(r?Ed(t,i,a,r):Cd(t))e.push(l.i,t.i,c.i),Gd(t),t=c.next,s=c.next;else if((t=c)===s){o?1===o?Ad(t=Td(wd(t),e),e,n,i,a,r,2):2===o&&Sd(t,e,n,i,a,r):Ad(wd(t),e,n,i,a,r,1);break}}}function Cd(t){const e=t.prev,n=t,i=t.next;if(Bd(e,n,i)>=0)return!1;const a=e.x,r=n.x,o=i.x,s=e.y,l=n.y,c=i.y,u=a<r?a<o?a:o:r<o?r:o,h=s<l?s<c?s:c:l<c?l:c,d=a>r?a>o?a:o:r>o?r:o,p=s>l?s>c?s:c:l>c?l:c;let f=i.next;for(;f!==e;){if(f.x>=u&&f.x<=d&&f.y>=h&&f.y<=p&&Dd(a,s,r,l,o,c,f.x,f.y)&&Bd(f.prev,f,f.next)>=0)return!1;f=f.next}return!0}function Ed(t,e,n,i){const a=t.prev,r=t,o=t.next;if(Bd(a,r,o)>=0)return!1;const s=a.x,l=r.x,c=o.x,u=a.y,h=r.y,d=o.y,p=s<l?s<c?s:c:l<c?l:c,f=u<h?u<d?u:d:h<d?h:d,m=s>l?s>c?s:c:l>c?l:c,g=u>h?u>d?u:d:h>d?h:d,_=Pd(p,f,e,n,i),y=Pd(m,g,e,n,i);let x=t.prevZ,v=t.nextZ;for(;x&&x.z>=_&&v&&v.z<=y;){if(x.x>=p&&x.x<=m&&x.y>=f&&x.y<=g&&x!==a&&x!==o&&Dd(s,u,l,h,c,d,x.x,x.y)&&Bd(x.prev,x,x.next)>=0)return!1;if(x=x.prevZ,v.x>=p&&v.x<=m&&v.y>=f&&v.y<=g&&v!==a&&v!==o&&Dd(s,u,l,h,c,d,v.x,v.y)&&Bd(v.prev,v,v.next)>=0)return!1;v=v.nextZ}for(;x&&x.z>=_;){if(x.x>=p&&x.x<=m&&x.y>=f&&x.y<=g&&x!==a&&x!==o&&Dd(s,u,l,h,c,d,x.x,x.y)&&Bd(x.prev,x,x.next)>=0)return!1;x=x.prevZ}for(;v&&v.z<=y;){if(v.x>=p&&v.x<=m&&v.y>=f&&v.y<=g&&v!==a&&v!==o&&Dd(s,u,l,h,c,d,v.x,v.y)&&Bd(v.prev,v,v.next)>=0)return!1;v=v.nextZ}return!0}function Td(t,e){let n=t;do{const i=n.prev,a=n.next.next;!Od(i,a)&&Rd(i,n,n.next,a)&&jd(i,a)&&jd(a,i)&&(e.push(i.i,n.i,a.i),Gd(n),Gd(n.next),n=t=a),n=n.next}while(n!==t);return wd(n)}function Sd(t,e,n,i,a,r){let o=t;do{let t=o.next.next;for(;t!==o.prev;){if(o.i!==t.i&&Ld(o,t)){let s=Vd(o,t);return o=wd(o,o.next),s=wd(s,s.next),Ad(o,e,n,i,a,r,0),void Ad(s,e,n,i,a,r,0)}t=t.next}o=o.next}while(o!==t)}function Md(t,e){return t.x-e.x}function kd(t,e){const n=function(t,e){let n=e;const i=t.x,a=t.y;let r,o=-1/0;do{if(a<=n.y&&a>=n.next.y&&n.next.y!==n.y){const t=n.x+(a-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(t<=i&&t>o&&(o=t,r=n.x<n.next.x?n:n.next,t===i))return r}n=n.next}while(n!==e);if(!r)return null;const s=r,l=r.x,c=r.y;let u=1/0;n=r;do{if(i>=n.x&&n.x>=l&&i!==n.x&&Dd(a<c?i:o,a,l,c,a<c?o:i,a,n.x,n.y)){const e=Math.abs(a-n.y)/(i-n.x);jd(n,t)&&(e<u||e===u&&(n.x>r.x||n.x===r.x&&Id(r,n)))&&(r=n,u=e)}n=n.next}while(n!==s);return r}(t,e);if(!n)return e;const i=Vd(n,t);return wd(i,i.next),wd(n,n.next)}function Id(t,e){return Bd(t.prev,t,e.prev)<0&&Bd(e.next,t,t.next)<0}function Pd(t,e,n,i,a){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-n)*a|0)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-i)*a|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function zd(t){let e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next}while(e!==t);return n}function Dd(t,e,n,i,a,r,o,s){return(a-o)*(e-s)>=(t-o)*(r-s)&&(t-o)*(i-s)>=(n-o)*(e-s)&&(n-o)*(r-s)>=(a-o)*(i-s)}function Ld(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){let n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&Rd(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&(jd(t,e)&&jd(e,t)&&function(t,e){let n=t,i=!1;const a=(t.x+e.x)/2,r=(t.y+e.y)/2;do{n.y>r!=n.next.y>r&&n.next.y!==n.y&&a<(n.next.x-n.x)*(r-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next}while(n!==t);return i}(t,e)&&(Bd(t.prev,t,e.prev)||Bd(t,e.prev,e))||Od(t,e)&&Bd(t.prev,t,t.next)>0&&Bd(e.prev,e,e.next)>0)}function Bd(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function Od(t,e){return t.x===e.x&&t.y===e.y}function Rd(t,e,n,i){const a=Nd(Bd(t,e,n)),r=Nd(Bd(t,e,i)),o=Nd(Bd(n,i,t)),s=Nd(Bd(n,i,e));return a!==r&&o!==s||!(0!==a||!Fd(t,n,e))||!(0!==r||!Fd(t,i,e))||!(0!==o||!Fd(n,t,i))||!(0!==s||!Fd(n,e,i))}function Fd(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function Nd(t){return t>0?1:t<0?-1:0}function jd(t,e){return Bd(t.prev,t,t.next)<0?Bd(t,e,t.next)>=0&&Bd(t,t.prev,e)>=0:Bd(t,e,t.prev)<0||Bd(t,t.next,e)<0}function Vd(t,e){const n=qd(t.i,t.x,t.y),i=qd(e.i,e.x,e.y),a=t.next,r=e.prev;return t.next=e,e.prev=t,n.next=a,a.prev=n,i.next=n,n.prev=i,r.next=i,i.prev=r,i}function Ud(t,e,n,i){const a=qd(t,e,n);return i?(a.next=i.next,a.prev=i,i.next.prev=a,i.next=a):(a.prev=a,a.next=a),a}function Gd(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function qd(t,e,n){return{i:t,x:e,y:n,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function $d(t,e){const n=t.length;if(n<=1)return[t];const i=[];let a,r;for(let e=0;e<n;e++){const n=gn(t[e]);0!==n&&(t[e].area=Math.abs(n),void 0===r&&(r=n<0),r===n<0?(a&&i.push(a),a=[t[e]]):a.push(t[e]))}if(a&&i.push(a),e>1)for(let t=0;t<i.length;t++)i[t].length<=e||(La(i[t],e,1,i[t].length-1,Wd),i[t]=i[t].slice(0,e));return i}function Wd(t,e){return e.area-t.area}function Hd(t,e,n){const i=n.patternDependencies;let a=!1;for(const n of e){const e=n.paint.get(`${t}-pattern`);e.isConstant()||(a=!0);const r=e.constantOr(null);r&&(a=!0,i[r]=!0)}return a}function Zd(t,e,n,i,a){const r=a.patternDependencies;for(const o of e){const e=o.paint.get(`${t}-pattern`).value;if("constant"!==e.kind){let t=e.evaluate({zoom:i},n,{},a.availableImages);t=t&&t.name?t.name:t,r[t]=!0,n.patterns[o.id]=t}}return n}class Yd{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((t=>t.fqid)),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new zl,this.indexArray=new Kl,this.indexArray2=new Wl,this.programConfigurations=new Yc(t.layers,{zoom:t.zoom,lut:t.lut}),this.segments=new wc,this.segments2=new wc,this.stateDependentLayerIds=this.layers.filter((t=>t.isStateDependent())).map((t=>t.id)),this.projection=t.projection}updateFootprints(t,e){}populate(t,e,n,i){this.hasPattern=Hd("fill",this.layers,e);const a=this.layers[0].layout.get("fill-sort-key"),r=[];for(const{feature:o,id:s,index:l,sourceLayerIndex:c}of t){const t=this.layers[0]._featureFilter.needGeometry,u=$u(o,t);if(!this.layers[0]._featureFilter.filter(new Hs(this.zoom),u,n))continue;const h=a?a.evaluate(u,{},n,e.availableImages):void 0,d={id:s,properties:o.properties,type:o.type,sourceLayerIndex:c,index:l,geometry:t?u.geometry:qu(o,n,i),patterns:{},sortKey:h};r.push(d)}a&&r.sort(((t,e)=>t.sortKey-e.sortKey));for(const i of r){const{geometry:a,index:r,sourceLayerIndex:o}=i;if(this.hasPattern){const t=Zd("fill",this.layers,i,this.zoom,e);this.patternFeatures.push(t)}else this.addFeature(i,a,r,n,{},e.availableImages,e.brightness);e.featureIndex.insert(t[r].feature,a,r,o,this.index)}}update(t,e,n,i,a){const r=0!==Object.keys(t).length;r&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(t,e,r?this.stateDependentLayers:this.layers,n,i,a)}addFeatures(t,e,n,i,a,r){for(const t of this.patternFeatures)this.addFeature(t,t.geometry,t.index,e,n,i,r)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,xd),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(t,e,n,i,a,r=[],o){for(const t of $d(e,500)){let e=0;for(const n of t)e+=n.length;const n=this.segments.prepareSegment(e,this.layoutVertexArray,this.indexArray),i=n.vertexLength,a=[],r=[];for(const e of t){if(0===e.length)continue;e!==t[0]&&r.push(a.length/2);const n=this.segments2.prepareSegment(e.length,this.layoutVertexArray,this.indexArray2),i=n.vertexLength;this.layoutVertexArray.emplaceBack(e[0].x,e[0].y),this.indexArray2.emplaceBack(i+e.length-1,i),a.push(e[0].x),a.push(e[0].y);for(let t=1;t<e.length;t++)this.layoutVertexArray.emplaceBack(e[t].x,e[t].y),this.indexArray2.emplaceBack(i+t-1,i+t),a.push(e[t].x),a.push(e[t].y);n.vertexLength+=e.length,n.primitiveLength+=e.length}const o=vd(a,r);for(let t=0;t<o.length;t+=3)this.indexArray.emplaceBack(i+o[t],i+o[t+1],i+o[t+2]);n.vertexLength+=e,n.primitiveLength+=o.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,n,a,r,i,o)}}bs(Yd,"FillBucket",{omit:["layers","patternFeatures"]});const Xd=new rl({"fill-sort-key":new il(ol.layout_fill["fill-sort-key"]),visibility:new nl(ol.layout_fill.visibility)});var Kd={paint:new rl({"fill-antialias":new nl(ol.paint_fill["fill-antialias"]),"fill-opacity":new il(ol.paint_fill["fill-opacity"]),"fill-color":new il(ol.paint_fill["fill-color"]),"fill-outline-color":new il(ol.paint_fill["fill-outline-color"]),"fill-translate":new nl(ol.paint_fill["fill-translate"]),"fill-translate-anchor":new nl(ol.paint_fill["fill-translate-anchor"]),"fill-pattern":new il(ol.paint_fill["fill-pattern"]),"fill-emissive-strength":new nl(ol.paint_fill["fill-emissive-strength"])}),layout:Xd};class Qd{constructor(t,e,n,i){if(this.triangleCount=e.length/3,this.min=new Ve(0,0),this.max=new Ve(0,0),this.xScale=0,this.yScale=0,this.cellsX=0,this.cellsY=0,this.cells=[],this.payload=[],0===this.triangleCount||0===t.length)return;const[a,r]=[t[0].clone(),t[0].clone()];for(let e=1;e<t.length;++e){const n=t[e];a.x=Math.min(a.x,n.x),a.y=Math.min(a.y,n.y),r.x=Math.max(r.x,n.x),r.y=Math.max(r.y,n.y)}if(i){const t=Math.ceil(Math.max(r.x-a.x,r.y-a.y)/i);n=Math.max(n,t)}if(0===n)return;this.min=a,this.max=r;const o=this.max.sub(this.min);o.x=Math.max(o.x,1),o.y=Math.max(o.y,1);const s=Math.max(o.x,o.y)/n;this.cellsX=Math.max(1,Math.ceil(o.x/s)),this.cellsY=Math.max(1,Math.ceil(o.y/s)),this.xScale=1/s,this.yScale=1/s;const l=[];for(let n=0;n<this.triangleCount;n++){const i=t[e[3*n+0]].sub(this.min),a=t[e[3*n+1]].sub(this.min),r=t[e[3*n+2]].sub(this.min),o=Jd(Math.floor(Math.min(i.x,a.x,r.x)),this.xScale,this.cellsX),c=Jd(Math.floor(Math.max(i.x,a.x,r.x)),this.xScale,this.cellsX),u=Jd(Math.floor(Math.min(i.y,a.y,r.y)),this.yScale,this.cellsY),h=Jd(Math.floor(Math.max(i.y,a.y,r.y)),this.yScale,this.cellsY),d=new Ve(0,0),p=new Ve(0,0),f=new Ve(0,0),m=new Ve(0,0);for(let t=u;t<=h;++t){d.y=p.y=t*s,f.y=m.y=(t+1)*s;for(let e=o;e<=c;++e)d.x=f.x=e*s,p.x=m.x=(e+1)*s,(lh(i,a,r,d,p,m)||lh(i,a,r,d,m,f))&&l.push({cellIdx:t*this.cellsX+e,triIdx:n})}}if(0===l.length)return;l.sort(((t,e)=>t.cellIdx-e.cellIdx||t.triIdx-e.triIdx));let c=0;for(;c<l.length;){const t=l[c].cellIdx,e={start:this.payload.length,len:0};for(;c<l.length&&l[c].cellIdx===t;)++e.len,this.payload.push(l[c++].triIdx);this.cells[t]=e}}_lazyInitLookup(){this.lookup||(this.lookup=new Uint8Array(Math.ceil(this.triangleCount/8))),this.lookup.fill(0)}queryPoint(t,e){if(0===this.triangleCount||0===this.cells.length)return;if(t.x>this.max.x||this.min.x>t.x||t.y>this.max.y||this.min.y>t.y)return;const n=Jd(t.x-this.min.x,this.xScale,this.cellsX),i=Jd(t.y-this.min.y,this.yScale,this.cellsY),a=this.cells[i*this.cellsX+n];if(a){this._lazyInitLookup();for(let t=0;t<a.len;t++){const n=this.payload[a.start+t],i=Math.floor(n/8),r=1<<n%8;if(!(this.lookup[i]&r)&&(this.lookup[i]|=r,e.push(n),e.length===this.triangleCount))return}}}query(t,e,n){if(0===this.triangleCount||0===this.cells.length)return;if(t.x>this.max.x||this.min.x>e.x)return;if(t.y>this.max.y||this.min.y>e.y)return;this._lazyInitLookup();const i=Jd(t.x-this.min.x,this.xScale,this.cellsX),a=Jd(e.x-this.min.x,this.xScale,this.cellsX),r=Jd(t.y-this.min.y,this.yScale,this.cellsY),o=Jd(e.y-this.min.y,this.yScale,this.cellsY);for(let t=r;t<=o;t++)for(let e=i;e<=a;e++){const i=this.cells[t*this.cellsX+e];if(i)for(let t=0;t<i.len;t++){const e=this.payload[i.start+t],a=Math.floor(e/8),r=1<<e%8;if(!(this.lookup[a]&r)&&(this.lookup[a]|=r,n.push(e),n.length===this.triangleCount))return}}}}function Jd(t,e,n){return Math.max(0,Math.min(n-1,Math.floor(t*e)))}bs(Qd,"TriangleGridIndex");class tp{constructor(t){this.zoom=t.zoom,this.layers=t.layers,this.layerIds=this.layers.map((t=>t.fqid)),this.index=t.index,this.hasPattern=!1,this.stateDependentLayerIds=this.layers.filter((t=>t.isStateDependent())).map((t=>t.id)),this.footprints=[]}updateFootprints(t,e){for(const n of this.footprints)e.push({footprint:n,id:t})}populate(t,e,n,i){const a=[];for(const{feature:e,id:r,index:o,sourceLayerIndex:s}of t){const t=this.layers[0]._featureFilter.needGeometry,l=$u(e,t);if(!this.layers[0]._featureFilter.filter(new Hs(this.zoom),l,n))continue;const c={id:r,properties:e.properties,type:e.type,sourceLayerIndex:s,index:o,geometry:t?l.geometry:qu(e,n,i),patterns:{}};a.push(c)}for(const i of a){const{geometry:a,index:r,sourceLayerIndex:o}=i;this.addFeature(i,a,r,n,{},e.availableImages,e.brightness),e.featureIndex.insert(t[r].feature,a,r,o,this.index)}}isEmpty(){return 0===this.footprints.length}uploadPending(){return!1}upload(t){}update(t,e,n,i,a){}destroy(){}addFeature(t,e,n,i,a,r=[],o){for(const t of $d(e,2)){const e=[],n=[],i=[],a=new Ve(1/0,1/0),r=new Ve(-1/0,-1/0);for(const o of t)if(0!==o.length){o!==t[0]&&i.push(n.length/2);for(let t=0;t<o.length;t++)n.push(o[t].x),n.push(o[t].y),e.push(o[t]),a.x=Math.min(a.x,o[t].x),a.y=Math.min(a.y,o[t].y),r.x=Math.max(r.x,o[t].x),r.y=Math.max(r.y,o[t].y)}const o=vd(n,i),s=new Qd(e,o,8,256);this.footprints.push({vertices:e,indices:o,grid:s,min:a,max:r})}}}bs(tp,"ClipBucket",{omit:["layers"]});const ep=new rl({"clip-layer-types":new nl(ol.layout_clip["clip-layer-types"])});var np={paint:new rl({}),layout:ep};const ip=Il([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),ap=Il([{name:"a_pos_end",components:4,type:"Int16"},{name:"a_angular_offset_factor",components:1,type:"Int16"}]),rp=Il([{name:"a_centroid_pos",components:2,type:"Uint16"}]),op=Il([{name:"a_hidden_by_landmark",components:1,type:"Uint8"}]),sp=Il([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:lp}=ip;var cp={},up=Ne,hp=dp;function dp(t,e,n,i,a){this.properties={},this.extent=n,this.type=0,this._pbf=t,this._geometry=-1,this._keys=i,this._values=a,t.readFields(pp,this,e)}function pp(t,e,n){1==t?e.id=n.readVarint():2==t?function(t,e){for(var n=t.readVarint()+t.pos;t.pos<n;){var i=e._keys[t.readVarint()],a=e._values[t.readVarint()];e.properties[i]=a}}(n,e):3==t?e.type=n.readVarint():4==t&&(e._geometry=n.pos)}function fp(t){for(var e,n,i=0,a=0,r=t.length,o=r-1;a<r;o=a++)i+=((n=t[o]).x-(e=t[a]).x)*(e.y+n.y);return i}dp.types=["Unknown","Point","LineString","Polygon"],dp.prototype.loadGeometry=function(){var t=this._pbf;t.pos=this._geometry;for(var e,n=t.readVarint()+t.pos,i=1,a=0,r=0,o=0,s=[];t.pos<n;){if(a<=0){var l=t.readVarint();i=7&l,a=l>>3}if(a--,1===i||2===i)r+=t.readSVarint(),o+=t.readSVarint(),1===i&&(e&&s.push(e),e=[]),e.push(new up(r,o));else{if(7!==i)throw new Error("unknown command "+i);e&&e.push(e[0].clone())}}return e&&s.push(e),s},dp.prototype.bbox=function(){var t=this._pbf;t.pos=this._geometry;for(var e=t.readVarint()+t.pos,n=1,i=0,a=0,r=0,o=1/0,s=-1/0,l=1/0,c=-1/0;t.pos<e;){if(i<=0){var u=t.readVarint();n=7&u,i=u>>3}if(i--,1===n||2===n)(a+=t.readSVarint())<o&&(o=a),a>s&&(s=a),(r+=t.readSVarint())<l&&(l=r),r>c&&(c=r);else if(7!==n)throw new Error("unknown command "+n)}return[o,l,s,c]},dp.prototype.toGeoJSON=function(t,e,n){var i,a,r=this.extent*Math.pow(2,n),o=this.extent*t,s=this.extent*e,l=this.loadGeometry(),c=dp.types[this.type];function u(t){for(var e=0;e<t.length;e++){var n=t[e];t[e]=[360*(n.x+o)/r-180,360/Math.PI*Math.atan(Math.exp((180-360*(n.y+s)/r)*Math.PI/180))-90]}}switch(this.type){case 1:var h=[];for(i=0;i<l.length;i++)h[i]=l[i][0];u(l=h);break;case 2:for(i=0;i<l.length;i++)u(l[i]);break;case 3:for(l=function(t){var e=t.length;if(e<=1)return[t];for(var n,i,a=[],r=0;r<e;r++){var o=fp(t[r]);0!==o&&(void 0===i&&(i=o<0),i===o<0?(n&&a.push(n),n=[t[r]]):n.push(t[r]))}return n&&a.push(n),a}(l),i=0;i<l.length;i++)for(a=0;a<l[i].length;a++)u(l[i][a])}1===l.length?l=l[0]:c="Multi"+c;var d={type:"Feature",geometry:{type:c,coordinates:l},properties:this.properties};return"id"in this&&(d.id=this.id),d};var mp=hp,gp=_p;function _p(t,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=t,this._keys=[],this._values=[],this._features=[],t.readFields(yp,this,e),this.length=this._features.length}function yp(t,e,n){15===t?e.version=n.readVarint():1===t?e.name=n.readString():5===t?e.extent=n.readVarint():2===t?e._features.push(n.pos):3===t?e._keys.push(n.readString()):4===t&&e._values.push(function(t){for(var e=null,n=t.readVarint()+t.pos;t.pos<n;){var i=t.readVarint()>>3;e=1===i?t.readString():2===i?t.readFloat():3===i?t.readDouble():4===i?t.readVarint64():5===i?t.readVarint():6===i?t.readSVarint():7===i?t.readBoolean():null}return e}(n))}_p.prototype.feature=function(t){if(t<0||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];var e=this._pbf.readVarint()+this._pbf.pos;return new mp(this._pbf,e,this.extent,this._keys,this._values)};var xp=gp;function vp(t,e,n){if(3===t){var i=new xp(n,n.readVarint()+n.pos);i.length&&(e[i.name]=i)}}var bp=cp.VectorTile=function(t,e){this.layers=t.readFields(vp,{},e)},wp=cp.VectorTileFeature=hp;cp.VectorTileLayer=gp;class Ap extends Ve{constructor(t,e,n){super(t,e),this.z=n}}class Cp extends Ap{constructor(t,e,n,i){super(t,e,n),this.w=i}}function Ep(t,e,n,i){const a=[],r=0===i?(t,e,n,i,a,r)=>{t.push(new Ve(r,n+(r-e)/(i-e)*(a-n)))}:(t,e,n,i,a,r)=>{t.push(new Ve(e+(r-n)/(a-n)*(i-e),r))};for(const o of t){const t=[];for(const a of o){if(a.length<=2)continue;const o=[];for(let t=0;t<a.length-1;t++){const s=a[t].x,l=a[t].y,c=a[t+1].x,u=a[t+1].y,h=0===i?s:l,d=0===i?c:u;h<e?d>e&&r(o,s,l,c,u,e):h>n?d<n&&r(o,s,l,c,u,n):o.push(a[t]),d<e&&h>=e&&r(o,s,l,c,u,e),d>n&&h<=n&&r(o,s,l,c,u,n)}let s=a[a.length-1];const l=0===i?s.x:s.y;l>=e&&l<=n&&o.push(s),o.length&&(s=o[o.length-1],o[0].x===s.x&&o[0].y===s.y||o.push(o[0]),t.push(o))}t.length&&a.push(t)}return a}function Tp(t,e,n,i){const a="x"===n?"y":"x",r=(i-t[n])/(e[n]-t[n]);t[a]=t[a]+(e[a]-t[a])*r,t[n]=i,t.hasOwnProperty("z")&&(t.z=Gi(t.z,e.z,r)),t.hasOwnProperty("w")&&(t.w=Gi(t.w,e.w,r))}function Sp(t,e,n,i){const a=n,r=i;for(const n of["x","y"]){let i=t,o=e;i[n]>=o[n]&&(i=e,o=t),i[n]<a&&o[n]>a&&Tp(i,o,n,a),i[n]<r&&o[n]>r&&Tp(o,i,n,r)}}function Mp(t,e){return t.x-e.x||t.y-e.y}function kp(t,e){return 0===Mp(t.min,e.min)&&0===Mp(t.max,e.max)}function Ip(t,e){return!(t.min.x>e.max.x||t.max.x<e.min.x||t.min.y>e.max.y||t.max.y<e.min.y)}function Pp(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n].sourceId!==e[n].sourceId||!kp(t[n],e[n])||t[n].order!==e[n].order||t[n].clipMask!==e[n].clipMask)return!1;return!0}function zp(t,e,n){const i=1/ur,a=1/(1<<n.canonical.z),r=(e.x*i+n.canonical.x)*a+n.wrap,o=(e.y*i+n.canonical.y)*a;return{min:new Ve((t.x*i+n.canonical.x)*a+n.wrap,(t.y*i+n.canonical.y)*a),max:new Ve(r,o)}}function Dp(t,e,n){const i=1<<n.canonical.z,a=((e.x-n.wrap)*i-n.canonical.x)*ur,r=(e.y*i-n.canonical.y)*ur;return{min:new Ve(((t.x-n.wrap)*i-n.canonical.x)*ur,(t.y*i-n.canonical.y)*ur),max:new Ve(a,r)}}function Lp(t,e,n,i,a,r,o){const s=t.indices,l=t.vertices,c=[];for(let u=i;u<i+a;u+=3){const i=e[n[u+0]+r],a=e[n[u+1]+r],h=e[n[u+2]+r],d=Math.min(i.x,a.x,h.x),p=Math.max(i.x,a.x,h.x),f=Math.min(i.y,a.y,h.y),m=Math.max(i.y,a.y,h.y);c.length=0,t.grid.query(new Ve(d,f),new Ve(p,m),c);for(let t=0;t<c.length;t++){const e=c[t];if(lh(l[s[3*e+0]],l[s[3*e+1]],l[s[3*e+2]],i,a,h,o))return!0}}return!1}function Bp(t,e,n,i){if(!t||!n)return!1;let a=t.vertices;if(!e.canonical.equals(i.canonical)||e.wrap!==i.wrap){if(n.vertices.length<t.vertices.length)return Bp(n,i,t,e);const r=e.canonical,o=i.canonical,s=Math.pow(2,o.z-r.z);a=t.vertices.map((t=>new Ve((t.x+r.x*ur)*s-o.x*ur,(t.y+r.y*ur)*s-o.y*ur)))}return Lp(n,a,t.indices,0,t.indices.length,0,0)}function Op(t,e,n,i){const a=Math.pow(2,i.z-n.z);return new Ve((t+n.x*ur)*a-i.x*ur,(e+n.y*ur)*a-i.y*ur)}function Rp(t,e){const n=[];e.footprint.grid.queryPoint(t,n);const i=e.footprint.indices,a=e.footprint.vertices;for(let e=0;e<n.length;e++){const r=n[e];if(ah([a[i[3*r+0]],a[i[3*r+1]],a[i[3*r+2]]],t))return!0}return!1}class Fp{constructor(t){this.size=t,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(t,e){const n=this.toIdx(t,e);return{min:this.minimums[n],max:this.maximums[n]}}isLeaf(t,e){return this.leaves[this.toIdx(t,e)]}toIdx(t,e){return e*this.size+t}}function Np(t,e,n,i){let a=0,r=Number.MAX_VALUE;for(let o=0;o<3;o++)if(Math.abs(i[o])<1e-15){if(n[o]<t[o]||n[o]>e[o])return null}else{const s=1/i[o];let l=(t[o]-n[o])*s,c=(e[o]-n[o])*s;if(l>c){const t=l;l=c,c=t}if(l>a&&(a=l),c<r&&(r=c),a>r)return null}return a}function jp(t,e,n,i,a,r,o,s,l,c,u){const h=i-t,d=a-e,p=r-n,f=o-t,m=s-e,g=l-n,_=u[1]*g-u[2]*m,y=u[2]*f-u[0]*g,x=u[0]*m-u[1]*f,v=h*_+d*y+p*x;if(Math.abs(v)<1e-15)return null;const b=1/v,w=c[0]-t,A=c[1]-e,C=c[2]-n,E=(w*_+A*y+C*x)*b;if(E<0||E>1)return null;const T=A*p-C*d,S=C*h-w*p,M=w*d-A*h,k=(u[0]*T+u[1]*S+u[2]*M)*b;return k<0||E+k>1?null:(f*T+m*S+g*M)*b}function Vp(t,e,n){return(t-e)/(n-e)}function Up(t,e,n,i,a,r,o,s,l){const c=1<<n,u=r-i,h=o-a,d=(t+1)/c*u+i,p=(e+0)/c*h+a,f=(e+1)/c*h+a;s[0]=(t+0)/c*u+i,s[1]=p,l[0]=d,l[1]=f}class Gp{constructor(t){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=t,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const e=function(t){const e=Math.ceil(Math.log2(t.dim/8)),n=[];let i=Math.ceil(Math.pow(2,e));const a=1/i,r=(t,e,n,i,a)=>{const r=i?1:0,o=(t+1)*n-r,s=e*n,l=(e+1)*n-r;a[0]=t*n,a[1]=s,a[2]=o,a[3]=l};let o=new Fp(i);const s=[];for(let e=0;e<i*i;e++){r(e%i,Math.floor(e/i),a,!1,s);const n=$p(s[0],s[1],t),l=$p(s[2],s[1],t),c=$p(s[2],s[3],t),u=$p(s[0],s[3],t);o.minimums.push(Math.min(n,l,c,u)),o.maximums.push(Math.max(n,l,c,u)),o.leaves.push(1)}for(n.push(o),i/=2;i>=1;i/=2){const t=n[n.length-1];o=new Fp(i);for(let e=0;e<i*i;e++){r(e%i,Math.floor(e/i),2,!0,s);const n=t.getElevation(s[0],s[1]),a=t.getElevation(s[2],s[1]),l=t.getElevation(s[2],s[3]),c=t.getElevation(s[0],s[3]),u=t.isLeaf(s[0],s[1]),h=t.isLeaf(s[2],s[1]),d=t.isLeaf(s[2],s[3]),p=t.isLeaf(s[0],s[3]),f=Math.min(n.min,a.min,l.min,c.min),m=Math.max(n.max,a.max,l.max,c.max),g=u&&h&&d&&p;o.maximums.push(m),o.minimums.push(f),o.leaves.push(m-f<=5&&g?1:0)}n.push(o)}return n}(this.dem),n=e.length-1,i=e[n];this._addNode(i.minimums[0],i.maximums[0],i.leaves[0]),this._construct(e,0,0,n,0)}raycastRoot(t,e,n,i,a,r,o=1){return Np([t,e,-100],[n,i,this.maximums[0]*o],a,r)}raycast(e,n,i,a,r,o,s=1){if(!this.nodeCount)return null;const l=this.raycastRoot(e,n,i,a,r,o,s);if(null==l)return null;const c=[],u=[],h=[],d=[],p=[{idx:0,t:l,nodex:0,nodey:0,depth:0}];for(;p.length>0;){const{idx:l,t:f,nodex:m,nodey:g,depth:_}=p.pop();if(this.leaves[l]){Up(m,g,_,e,n,i,a,h,d);const l=1<<_,c=(m+0)/l,u=(m+1)/l,p=(g+0)/l,y=(g+1)/l,x=$p(c,p,this.dem)*s,v=$p(u,p,this.dem)*s,b=$p(u,y,this.dem)*s,w=$p(c,y,this.dem)*s,A=jp(h[0],h[1],x,d[0],h[1],v,d[0],d[1],b,r,o),C=jp(d[0],d[1],b,h[0],d[1],w,h[0],h[1],x,r,o),E=Math.min(null!==A?A:Number.MAX_VALUE,null!==C?C:Number.MAX_VALUE);if(E!==Number.MAX_VALUE)return E;{const e=t._.scaleAndAdd([],r,o,f);if(qp(x,v,w,b,Vp(e[0],h[0],d[0]),Vp(e[1],h[1],d[1]))>=e[2])return f}continue}let y=0;for(let t=0;t<this._siblingOffset.length;t++){Up((m<<1)+this._siblingOffset[t][0],(g<<1)+this._siblingOffset[t][1],_+1,e,n,i,a,h,d),h[2]=-100,d[2]=this.maximums[this.childOffsets[l]+t]*s;const p=Np(h,d,r,o);if(null!=p){const e=p;c[t]=e;let n=!1;for(let i=0;i<y&&!n;i++)e>=c[u[i]]&&(u.splice(i,0,t),n=!0);n||(u[y]=t),y++}}for(let t=0;t<y;t++){const e=u[t];p.push({idx:this.childOffsets[l]+e,t:c[e],nodex:(m<<1)+this._siblingOffset[e][0],nodey:(g<<1)+this._siblingOffset[e][1],depth:_+1})}}return null}_addNode(t,e,n){return this.minimums.push(t),this.maximums.push(e),this.leaves.push(n),this.childOffsets.push(0),this.nodeCount++}_construct(t,e,n,i,a){if(1===t[i].isLeaf(e,n))return;this.childOffsets[a]||(this.childOffsets[a]=this.nodeCount);const r=i-1,o=t[r];let s=0,l=0;for(let t=0;t<this._siblingOffset.length;t++){const i=2*e+this._siblingOffset[t][0],a=2*n+this._siblingOffset[t][1],r=o.getElevation(i,a),c=o.isLeaf(i,a),u=this._addNode(r.min,r.max,c);c&&(s|=1<<t),l||(l=u)}for(let i=0;i<this._siblingOffset.length;i++)s&1<<i||this._construct(t,2*e+this._siblingOffset[i][0],2*n+this._siblingOffset[i][1],r,l+i)}}function qp(t,e,n,i,a,r){return Gi(Gi(t,n,r),Gi(e,i,r),a)}function $p(t,e,n){const i=n.dim,a=Xe(t*i-.5,0,i-1),r=Xe(e*i-.5,0,i-1),o=Math.floor(a),s=Math.floor(r),l=Math.min(o+1,i-1),c=Math.min(s+1,i-1);return qp(n.get(o,s),n.get(l,s),n.get(o,c),n.get(l,c),a-o,r-s)}const Wp={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function Hp(t,e,n){return(256*t*256+256*e+n)/10-1e4}function Zp(t,e,n){return 256*t+e+n/256-32768}class Yp{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(t,e,n,i=!1){if(this.uid=t,e.height!==e.width)throw new RangeError("DEM tiles must be square");if(n&&"mapbox"!==n&&"terrarium"!==n)return fn(`"${n}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=e.height;const a=this.dim=e.height-2,r=new Uint32Array(e.data.buffer);if(this.pixels=new Uint8Array(e.data.buffer),this.floatView=new Float32Array(e.data.buffer),this.borderReady=i,this._modifiedForSources={},!i){for(let t=0;t<a;t++)r[this._idx(-1,t)]=r[this._idx(0,t)],r[this._idx(a,t)]=r[this._idx(a-1,t)],r[this._idx(t,-1)]=r[this._idx(t,0)],r[this._idx(t,a)]=r[this._idx(t,a-1)];r[this._idx(-1,-1)]=r[this._idx(0,0)],r[this._idx(a,-1)]=r[this._idx(a-1,0)],r[this._idx(-1,a)]=r[this._idx(0,a-1)],r[this._idx(a,a)]=r[this._idx(a-1,a-1)]}const o="terrarium"===n?Zp:Hp;for(let t=0;t<r.length;++t){const e=4*t;this.floatView[t]=o(this.pixels[e],this.pixels[e+1],this.pixels[e+2])}this._timestamp=Ln.now()}_buildQuadTree(){this._tree=new Gp(this)}get(t,e,n=!1){n&&(t=Xe(t,-1,this.dim),e=Xe(e,-1,this.dim));const i=this._idx(t,e);return this.floatView[i]}set(t,e,n){const i=this._idx(t,e),a=this.floatView[i];return this.floatView[i]=n,n-a}static getUnpackVector(t){return Wp[t]}_idx(t,e){if(t<-1||t>=this.dim+1||e<-1||e>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(e+1)*this.stride+(t+1)}static pack(t,e){const n=[0,0,0,0],i=Yp.getUnpackVector(e);let a=Math.floor((t+i[3])/i[2]);return n[2]=a%256,a=Math.floor(a/256),n[1]=a%256,a=Math.floor(a/256),n[0]=a,n}getPixels(){return new dd({width:this.stride,height:this.stride},this.pixels)}backfillBorder(t,e,n){if(this.dim!==t.dim)throw new Error("dem dimension mismatch");let i=e*this.dim,a=e*this.dim+this.dim,r=n*this.dim,o=n*this.dim+this.dim;switch(e){case-1:i=a-1;break;case 1:a=i+1}switch(n){case-1:r=o-1;break;case 1:o=r+1}const s=-e*this.dim,l=-n*this.dim;for(let e=r;e<o;e++)for(let n=i;n<a;n++){const i=4*this._idx(n,e),a=4*this._idx(n+s,e+l);this.pixels[i+0]=t.pixels[a+0],this.pixels[i+1]=t.pixels[a+1],this.pixels[i+2]=t.pixels[a+2],this.pixels[i+3]=t.pixels[a+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}bs(Yp,"DEMData"),bs(Gp,"DemMinMaxQuadTree",{omit:["dem"]});class Xp{constructor(t,e,n){this._demTile=t,this._dem=this._demTile.dem,this._scale=e,this._offset=n}static create(t,e,n){const i=n||t.findDEMTileFor(e);if(!i||!i.dem)return;const a=i.dem,r=i.tileID,o=1<<e.canonical.z-r.canonical.z;return new Xp(i,a.dim/ur/o,[(e.canonical.x/o-r.canonical.x)*a.dim,(e.canonical.y/o-r.canonical.y)*a.dim])}tileCoordToPixel(t,e){const n=e*this._scale+this._offset[1],i=Math.floor(t*this._scale+this._offset[0]),a=Math.floor(n);return new Ve(i,a)}getElevationAt(t,e,n,i){const a=t*this._scale+this._offset[0],r=e*this._scale+this._offset[1],o=Math.floor(a),s=Math.floor(r),l=this._dem;return i=!!i,n?Gi(Gi(l.get(o,s,i),l.get(o,s+1,i),r-s),Gi(l.get(o+1,s,i),l.get(o+1,s+1,i),r-s),a-o):l.get(o,s,i)}getElevationAtPixel(t,e,n){return this._dem.get(t,e,!!n)}getMeterToDEM(t){return(1<<this._demTile.tileID.canonical.z)*Su(1,t)*this._dem.stride}}const Kp={None:0,Model:1,Symbol:2,FillExtrusion:4,All:7},Qp=wp.types,Jp=["fill-extrusion-base","fill-extrusion-height","fill-extrusion-color","fill-extrusion-pattern","fill-extrusion-flood-light-wall-radius"],tf=["fill-extrusion-flood-light-ground-radius"],ef=Math.pow(2,13),nf=Math.pow(2,15)-1,af=new Ve(0,1),rf=2147483648;function of(t,e,n,i,a,r,o,s){t.emplaceBack((e<<1)+o,(n<<1)+r,(Math.floor(i*ef)<<1)+a,Math.round(s))}function sf(t,e,n,i,a,r){t.emplaceBack(e.x,e.y,(n.x<<1)+i,(n.y<<1)+a,r)}function lf(t,e,n){const i=16384;t.emplaceBack(e.x,e.y,e.z,n[0]*i,n[1]*i,n[2]*i)}class cf{constructor(){this.vertexOffset=0,this.vertexCount=0,this.indexOffset=0,this.indexCount=0}}class uf{constructor(){this.centroidXY=new Ve(0,0),this.vertexArrayOffset=0,this.vertexCount=0,this.groundVertexArrayOffset=0,this.groundVertexCount=0,this.flags=0,this.footprintSegIdx=-1,this.footprintSegLen=0,this.polygonSegIdx=-1,this.polygonSegLen=0,this.min=new Ve(Number.MAX_VALUE,Number.MAX_VALUE),this.max=new Ve(-Number.MAX_VALUE,-Number.MAX_VALUE),this.height=0}span(){return new Ve(this.max.x-this.min.x,this.max.y-this.min.y)}}class hf{constructor(){this.acc=new Ve(0,0),this.accCount=0,this.centroidDataIndex=0}startRing(t,e){t.min.x===Number.MAX_VALUE&&(t.min.x=t.max.x=e.x,t.min.y=t.max.y=e.y)}appendEdge(t,e,n){this.accCount++,this.acc._add(e);let i=!!this.borders;e.x<t.min.x?(t.min.x=e.x,i=!0):e.x>t.max.x&&(t.max.x=e.x,i=!0),e.y<t.min.y?(t.min.y=e.y,i=!0):e.y>t.max.y&&(t.max.y=e.y,i=!0),((0===e.x||e.x===ur)&&e.x===n.x)!=((0===e.y||e.y===ur)&&e.y===n.y)&&this.processBorderOverlap(e,n),i&&this.checkBorderIntersection(e,n)}checkBorderIntersection(t,e){e.x<0!=t.x<0&&this.addBorderIntersection(0,Gi(e.y,t.y,(0-e.x)/(t.x-e.x))),e.x>ur!=t.x>ur&&this.addBorderIntersection(1,Gi(e.y,t.y,(ur-e.x)/(t.x-e.x))),e.y<0!=t.y<0&&this.addBorderIntersection(2,Gi(e.x,t.x,(0-e.y)/(t.y-e.y))),e.y>ur!=t.y>ur&&this.addBorderIntersection(3,Gi(e.x,t.x,(ur-e.y)/(t.y-e.y)))}addBorderIntersection(t,e){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const n=this.borders[t];e<n[0]&&(n[0]=e),e>n[1]&&(n[1]=e)}processBorderOverlap(t,e){if(t.x===e.x){if(t.y===e.y)return;const n=0===t.x?0:1;this.addBorderIntersection(n,e.y),this.addBorderIntersection(n,t.y)}else{const n=0===t.y?2:3;this.addBorderIntersection(n,e.x),this.addBorderIntersection(n,t.x)}}centroid(){return 0===this.accCount?new Ve(0,0):new Ve(Math.floor(Math.max(0,this.acc.x)/this.accCount),Math.floor(Math.max(0,this.acc.y)/this.accCount))}intersectsCount(){return this.borders?this.borders.reduce(((t,e)=>t+ +(e[0]!==Number.MAX_VALUE)),0):0}}function df(t,e){const n=t.add(e)._unit(),i=Xe(t.x*n.x+t.y*n.y,-1,1);var a,r,o;return a=Math.acos(i),Math.min(4,Math.max(-4,Math.tan(a)))/4*nf*((r=t).x*(o=e).y-r.y*o.x<0?-1:1)}const pf=[t=>t.x<0,t=>t.x>ur,t=>t.y<0,t=>t.y>ur];function ff(t,e,n,i){const a=[4];if(0===i)return a;n._mult(i);const r=t.sub(n),o=e.sub(n),s=[t,e,r,o];for(let t=0;t<4;t++)for(const e of s)if(pf[t](e)){a.push(t);break}return a}class mf{constructor(t){this.vertexArray=new Bl,this.indexArray=new Kl,this.programConfigurations=new Yc(t.layers,{zoom:t.zoom,lut:t.lut},(t=>tf.includes(t))),this._segments=new wc,this.hiddenByLandmarkVertexArray=new lc,this._segmentToGroundQuads={},this._segmentToGroundQuads[0]=[],this._segmentToRegionTriCounts={},this._segmentToRegionTriCounts[0]=[0,0,0,0,0],this.regionSegments={},this.regionSegments[4]=new wc}getDefaultSegment(){return this.regionSegments[4]}hasData(){return 0!==this.vertexArray.length}addData(t,e,n,i=!1){const a=t.length;if(a>2){let r=Math.max(0,this._segments.get().length-1);const o=this._segments._prepareSegment(4*a,this.vertexArray.length,2*this._segmentToGroundQuads[r].length);let s;r!==this._segments.get().length-1&&(r++,this._segmentToGroundQuads[r]=[],this._segmentToRegionTriCounts[r]=[0,0,0,0,0]);{const e=t[0],n=t[1];s=df(e.sub(t[a-1])._perp()._unit(),n.sub(e)._perp()._unit())}for(let l=0;l<a;l++){const c=l===a-1?0:l+1,u=t[l],h=t[c],d=t[c===a-1?0:c+1],p=h.sub(u)._perp()._unit(),f=df(p,d.sub(h)._perp()._unit()),m=s,g=f;if(vf(u,h,e)||i&&bf(u,e)&&bf(h,e)){s=f;continue}const _=o.vertexLength;sf(this.vertexArray,u,h,1,1,m),sf(this.vertexArray,u,h,1,0,m),sf(this.vertexArray,u,h,0,1,g),sf(this.vertexArray,u,h,0,0,g),o.vertexLength+=4;const y=ff(u,h,p,n);for(const t of y)this._segmentToGroundQuads[r].push({id:_,region:t}),this._segmentToRegionTriCounts[r][t]+=2,o.primitiveLength+=2;s=f}}}prepareBorderSegments(){if(!this.hasData())return;const t=this._segments.get(),e=t.length;for(let t=0;t<e;t++)this._segmentToGroundQuads[t].sort(((t,e)=>t.region-e.region));for(let n=0;n<e;n++){const e=this._segmentToGroundQuads[n],i=t[n],a=this._segmentToRegionTriCounts[n];a.reduce(((t,e)=>t+e),0);let r=0;for(let t=0;t<=4;t++){const e=a[t];if(0!==e){let n=this.regionSegments[t];n||(n=this.regionSegments[t]=new wc);const a={vertexOffset:i.vertexOffset,primitiveOffset:i.primitiveOffset+r,vertexLength:i.vertexLength,primitiveLength:e};n.get().push(a)}r+=e}for(let t=0;t<e.length;t++){const n=e[t].id;this.indexArray.emplaceBack(n,n+1,n+3),this.indexArray.emplaceBack(n,n+3,n+2)}}this._segmentToGroundQuads=null,this._segmentToRegionTriCounts=null,this._segments.destroy(),this._segments=null}addPaintPropertiesData(t,e,n,i,a,r){this.hasData()&&this.programConfigurations.populatePaintArrays(this.vertexArray.length,t,e,n,i,a,r)}upload(t){this.hasData()&&(this.vertexBuffer=t.createVertexBuffer(this.vertexArray,ap.members),this.indexBuffer=t.createIndexBuffer(this.indexArray))}uploadPaintProperties(t){this.hasData()&&this.programConfigurations.upload(t)}update(t,e,n,i,a,r){this.hasData()&&this.programConfigurations.updatePaintArrays(t,e,n,i,a,r)}updateHiddenByLandmark(t){if(!this.hasData())return;const e=t.groundVertexCount+t.groundVertexArrayOffset;if(0===t.groundVertexCount)return;const n=t.flags&rf?1:0;for(let i=t.groundVertexArrayOffset;i<e;++i)this.hiddenByLandmarkVertexArray.emplace(i,n);this._needsHiddenByLandmarkUpdate=!0}uploadHiddenByLandmark(t){this.hasData()&&this._needsHiddenByLandmarkUpdate&&(!this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexArray.length>0?this.hiddenByLandmarkVertexBuffer=t.createVertexBuffer(this.hiddenByLandmarkVertexArray,op.members,!0):this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.updateData(this.hiddenByLandmarkVertexArray),this._needsHiddenByLandmarkUpdate=!1)}destroy(){if(this.vertexBuffer){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.destroy(),this._segments&&this._segments.destroy(),this.programConfigurations.destroy();for(let t=0;t<=4;t++){const e=this.regionSegments[t];e&&e.destroy()}}}}class gf{constructor(t){this.zoom=t.zoom,this.canonical=t.canonical,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((t=>t.fqid)),this.index=t.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=t.projection,this.activeReplacements=[],this.replacementUpdateTime=0,this.centroidData=[],this.footprintIndices=new Kl,this.footprintVertices=new zl,this.footprintSegments=[],this.layoutVertexArray=new Ll,this.centroidVertexArray=new xc,this.indexArray=new Kl,this.programConfigurations=new Yc(t.layers,{zoom:t.zoom,lut:t.lut},(t=>Jp.includes(t))),this.segments=new wc,this.stateDependentLayerIds=this.layers.filter((t=>t.isStateDependent())).map((t=>t.id)),this.groundEffect=new mf(t),this.maxHeight=0,this.partLookup={},this.triangleSubSegments=[],this.polygonSegments=[]}updateFootprints(t,e){}populate(t,e,n,i){this.features=[],this.hasPattern=Hd("fill-extrusion",this.layers,e),this.featuresOnBorder=[],this.borderFeatureIndices=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=Bu(n),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter;for(const{feature:a,id:r,index:o,sourceLayerIndex:s}of t){const t=this.layers[0]._featureFilter.needGeometry,l=$u(a,t);if(!this.layers[0]._featureFilter.filter(new Hs(this.zoom),l,n))continue;const c={id:r,sourceLayerIndex:s,index:o,geometry:t?l.geometry:qu(a,n,i),properties:a.properties,type:a.type,patterns:{}},u=this.layoutVertexArray.length;this.hasPattern?this.features.push(Zd("fill-extrusion",this.layers,c,this.zoom,e)):this.addFeature(c,c.geometry,o,n,{},e.availableImages,i,e.brightness),e.featureIndex.insert(a,c.geometry,o,s,this.index,u)}this.sortBorders(),"mercator"===this.projection.name&&this.splitToSubtiles(),this.groundEffect.prepareBorderSegments(),this.polygonSegments.length=0}addFeatures(t,e,n,i,a,r){for(const t of this.features){const{geometry:o}=t;this.addFeature(t,o,t.index,e,n,i,a,r)}this.sortBorders(),"mercator"===this.projection.name&&this.splitToSubtiles()}update(t,e,n,i,a){const r=0!==Object.keys(t).length;if(r&&!this.stateDependentLayers.length)return;const o=r?this.stateDependentLayers:this.layers;this.programConfigurations.updatePaintArrays(t,e,o,n,i,a),this.groundEffect.update(t,e,o,n,i,a)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload||this.groundEffect.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,lp),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=t.createVertexBuffer(this.layoutVertexExtArray,sp.members,!0)),this.groundEffect.upload(t)),this.groundEffect.uploadPaintProperties(t),this.programConfigurations.upload(t),this.uploaded=!0}uploadCentroid(t){this.groundEffect.uploadHiddenByLandmark(t),this.needsCentroidUpdate&&(!this.centroidVertexBuffer&&this.centroidVertexArray.length>0?this.centroidVertexBuffer=t.createVertexBuffer(this.centroidVertexArray,rp.members,!0):this.centroidVertexBuffer&&this.centroidVertexBuffer.updateData(this.centroidVertexArray),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.groundEffect.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(t,e,n,i,a,r,o,s){const l=this.layers[0].paint.get("fill-extrusion-flood-light-ground-radius").evaluate(t,{})/this.tileToMeter,c=[new Ve(0,0),new Ve(ur,ur)],u=o.projection,h="globe"===u.name,d="Polygon"===Qp[t.type],p=new hf;p.centroidDataIndex=this.centroidData.length;const f=new uf,m=this.layers[0].paint.get("fill-extrusion-base").evaluate(t,{},i)<=0,g=this.layers[0].paint.get("fill-extrusion-height").evaluate(t,{},i);f.height=g,f.vertexArrayOffset=this.layoutVertexArray.length,f.groundVertexArrayOffset=this.groundEffect.vertexArray.length,h&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new Vl);const _=$d(e,500);for(let t=_.length-1;t>=0;t--){const e=_[t];(0===e.length||(y=e[0]).every((t=>t.x<=0))||y.every((t=>t.x>=ur))||y.every((t=>t.y<=0))||y.every((t=>t.y>=ur)))&&_.splice(t,1)}var y;let x;if(h)x=Ef(_,c,i);else{x=[];for(const t of _)x.push({polygon:t,bounds:c})}const v=d?this.edgeRadius:0,b=v>0&&this.zoom<17,w=(t,e)=>{if(0===t.length)return!1;const n=t[t.length-1];return e.x===n.x&&e.y===n.y};for(const{polygon:t,bounds:e}of x){let n=0,a=0;for(const e of t)d&&!e[0].equals(e[e.length-1])&&e.push(e[0]),a+=d?e.length-1:e.length;const r=this.segments.prepareSegment((d?5:4)*a,this.layoutVertexArray,this.indexArray);f.footprintSegIdx<0&&(f.footprintSegIdx=this.footprintSegments.length),f.polygonSegIdx<0&&(f.polygonSegIdx=this.polygonSegments.length);const o={triangleArrayOffset:this.indexArray.length,triangleCount:0,triangleSegIdx:this.segments.segments.length-1},s=new cf;if(s.vertexOffset=this.footprintVertices.length,s.indexOffset=3*this.footprintIndices.length,s.ringIndices=[],d){const a=[],o=[];n=r.vertexLength;for(let n=0;n<t.length;n++){const c=t[n];c.length&&0!==n&&o.push(a.length/2);const d=[];let p,f;p=c[1].sub(c[0])._perp()._unit(),s.ringIndices.push(c.length-1);for(let t=1;t<c.length;t++){const e=c[t],n=c[t===c.length-1?1:t+1],o=e.clone();if(v){f=n.sub(e)._perp()._unit();const t=p.add(f)._unit(),i=v*Math.min(4,1/(p.x*t.x+p.y*t.y));o.x+=i*t.x,o.y+=i*t.y,o.x=Math.round(o.x),o.y=Math.round(o.y),p=f}!m||0!==v&&!b||w(d,o)||d.push(o),of(this.layoutVertexArray,o.x,o.y,0,0,1,1,0),r.vertexLength++,this.footprintVertices.emplaceBack(e.x,e.y),a.push(e.x,e.y),h&&lf(this.layoutVertexExtArray,u.projectTilePoint(o.x,o.y,i),u.upVector(i,o.x,o.y))}m&&(0===v||b)&&(0!==d.length&&w(d,d[0])&&d.pop(),this.groundEffect.addData(d,e,l))}const c=vd(a,o);for(let t=0;t<c.length;t+=3)this.footprintIndices.emplaceBack(s.vertexOffset+c[t+0],s.vertexOffset+c[t+1],s.vertexOffset+c[t+2]),this.indexArray.emplaceBack(n+c[t],n+c[t+2],n+c[t+1]),r.primitiveLength++;s.indexCount+=c.length,s.vertexCount+=this.footprintVertices.length-s.vertexOffset}for(let a=0;a<t.length;a++){const o=t[a];p.startRing(f,o[0]);let s=o.length>4&&wf(o[o.length-2],o[0],o[1]),c=v?yf(o[o.length-2],o[0],o[1],v):0;const g=[];let _,y,x;y=o[1].sub(o[0])._perp()._unit();let b=!0;for(let t=1,a=0;t<o.length;t++){let l=o[t-1],d=o[t];const A=o[t===o.length-1?1:t+1];if(p.appendEdge(f,d,l),vf(d,l,e)){v&&(y=A.sub(d)._perp()._unit(),b=!b);continue}const C=d.sub(l)._perp(),E=C.x/(Math.abs(C.x)+Math.abs(C.y)),T=C.y>0?1:0,S=l.dist(d);if(a+S>32768&&(a=0),v){x=A.sub(d)._perp()._unit();let t=xf(l,d,A,_f(y,x),v);isNaN(t)&&(t=0);const e=d.sub(l)._unit();l=l.add(e.mult(c))._round(),d=d.add(e.mult(-t))._round(),c=t,y=x,m&&this.zoom>=17&&(w(g,l)||g.push(l),w(g,d)||g.push(d))}const M=r.vertexLength,k=o.length>4&&wf(l,d,A);let I=Af(a,s,b);if(of(this.layoutVertexArray,l.x,l.y,E,T,0,0,I),of(this.layoutVertexArray,l.x,l.y,E,T,0,1,I),a+=S,I=Af(a,k,!b),s=k,of(this.layoutVertexArray,d.x,d.y,E,T,0,0,I),of(this.layoutVertexArray,d.x,d.y,E,T,0,1,I),r.vertexLength+=4,this.indexArray.emplaceBack(M+0,M+1,M+2),this.indexArray.emplaceBack(M+1,M+3,M+2),r.primitiveLength+=2,v){const i=n+(1===t?o.length-2:t-2),a=1===t?n:i+1;if(this.indexArray.emplaceBack(M+1,i,M+3),this.indexArray.emplaceBack(i,a,M+3),r.primitiveLength+=2,void 0===_&&(_=M),!vf(A,o[t],e)){const e=t===o.length-1?_:r.vertexLength;this.indexArray.emplaceBack(M+2,M+3,e),this.indexArray.emplaceBack(M+3,e+1,e),this.indexArray.emplaceBack(M+3,a,e+1),r.primitiveLength+=3}b=!b}if(h){const t=this.layoutVertexExtArray,e=u.projectTilePoint(l.x,l.y,i),n=u.projectTilePoint(d.x,d.y,i),a=u.upVector(i,l.x,l.y),r=u.upVector(i,d.x,d.y);lf(t,e,a),lf(t,e,a),lf(t,n,r),lf(t,n,r)}}d&&(n+=o.length-1),m&&v&&this.zoom>=17&&(0!==g.length&&w(g,g[0])&&g.pop(),this.groundEffect.addData(g,e,l,v>0))}this.footprintSegments.push(s),o.triangleCount=this.indexArray.length-o.triangleArrayOffset,this.polygonSegments.push(o),++f.footprintSegLen,++f.polygonSegLen}if(f.vertexCount=this.layoutVertexArray.length-f.vertexArrayOffset,f.groundVertexCount=this.groundEffect.vertexArray.length-f.groundVertexArrayOffset,0!==f.vertexCount){if(f.centroidXY=p.borders?af:this.encodeCentroid(p,f),this.centroidData.push(f),p.borders){this.featuresOnBorder.push(p);const t=this.featuresOnBorder.length-1;for(let e=0;e<p.borders.length;e++)p.borders[e][0]!==Number.MAX_VALUE&&this.borderFeatureIndices[e].push(t)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,n,a,r,i,s),this.groundEffect.addPaintPropertiesData(t,n,a,r,i,s),this.maxHeight=Math.max(this.maxHeight,g)}}sortBorders(){for(let t=0;t<this.borderFeatureIndices.length;t++)this.borderFeatureIndices[t].sort(((e,n)=>this.featuresOnBorder[e].borders[t][0]-this.featuresOnBorder[n].borders[t][0]))}splitToSubtiles(){const t=[];for(let e=0;e<this.centroidData.length;e++){const n=this.centroidData[e],i=+(n.min.y+n.max.y>ur),a=2*i+(+(n.min.x+n.max.x>ur)^i);for(let i=0;i<n.polygonSegLen;i++){const r=n.polygonSegIdx+i;t.push({centroidIdx:e,subtile:a,polygonSegmentIdx:r,triangleSegmentIdx:this.polygonSegments[r].triangleSegIdx})}}const e=new Kl;t.sort(((t,e)=>t.triangleSegmentIdx===e.triangleSegmentIdx?t.subtile-e.subtile:t.triangleSegmentIdx-e.triangleSegmentIdx));let n=0,i=0,a=0;for(const e of t){if(e.triangleSegmentIdx!==n)break;a++}const r=t.length;for(;i!==t.length;){n=t[i].triangleSegmentIdx;let o=0,s=i,l=i;for(let e=s;e<a&&t[e].subtile===o;e++)l++;for(;s!==a;){const i=t[s];o=i.subtile;const r=this.centroidData[i.centroidIdx].min.clone(),c=this.centroidData[i.centroidIdx].max.clone(),u={vertexOffset:this.segments.segments[n].vertexOffset,primitiveOffset:e.length,vertexLength:this.segments.segments[n].vertexLength,primitiveLength:0,sortKey:void 0,vaos:{}};for(let n=s;n<l;n++){const i=t[n],a=this.polygonSegments[i.polygonSegmentIdx],o=this.centroidData[i.centroidIdx].min,s=this.centroidData[i.centroidIdx].max,l=this.indexArray.uint16;for(let t=a.triangleArrayOffset;t<a.triangleArrayOffset+a.triangleCount;t++)e.emplaceBack(l[3*t],l[3*t+1],l[3*t+2]);u.primitiveLength+=a.triangleCount,r.x=Math.min(r.x,o.x),r.y=Math.min(r.y,o.y),c.x=Math.max(c.x,s.x),c.y=Math.max(c.y,s.y)}u.primitiveLength>0&&this.triangleSubSegments.push({segment:u,min:r,max:c}),s=l;for(let e=s;e<a&&t[e].subtile===t[s].subtile;e++)l++}i=a;for(let e=i;e<r&&t[e].triangleSegmentIdx===t[i].triangleSegmentIdx;e++)a++}e._trim(),this.indexArray=e}getVisibleSegments(t,e,n){let i=0,a=0;const r=1<<t.canonical.z;if(e){const n=e.getMinMaxForTile(t);n&&(i=n.min,a=n.max)}a+=this.maxHeight;const o=t.toUnwrapped();let s;const l=[o.canonical.x/r+o.wrap,o.canonical.y/r],c=[(o.canonical.x+1)/r+o.wrap,(o.canonical.y+1)/r],u=new wc,h=(t,e,n)=>[t[0]*(1-n[0])+e[0]*n[0],t[1]*(1-n[1])+e[1]*n[1]],d=[],p=[];for(const t of this.triangleSubSegments){d[0]=t.min.x/ur,d[1]=t.min.y/ur,p[0]=t.max.x/ur,p[1]=t.max.y/ur;const e=h(l,c,d),r=h(l,c,p);if(0===new wh([e[0],e[1],i],[r[0],r[1],a]).intersectsPrecise(n)){s&&(u.segments.push(s),s=void 0);continue}const o=t.segment;s&&s.vertexOffset!==o.vertexOffset&&(u.segments.push(s),s=void 0),s?(s.vertexLength+=o.vertexLength,s.primitiveLength+=o.primitiveLength):s={vertexOffset:o.vertexOffset,primitiveLength:o.primitiveLength,vertexLength:o.vertexLength,primitiveOffset:o.primitiveOffset,sortKey:void 0,vaos:{}}}return s&&u.segments.push(s),u}encodeCentroid(t,e){const n=t.centroid(),i=e.span(),a=Math.min(7,Math.round(i.x*this.tileToMeter/10)),r=Math.min(7,Math.round(i.y*this.tileToMeter/10));return new Ve(Xe(n.x,1,ur-1)<<3|a,Xe(n.y,1,ur-1)<<3|r)}encodeBorderCentroid(t){if(!t.borders)return new Ve(0,0);const e=t.borders,n=Number.MAX_VALUE;if(e[0][0]!==n||e[1][0]!==n){const t=e[0][0]!==n?0:1;return new Ve(6|(e[0][0]!==n?0:65528),(e[t][0]+e[t][1])/2<<3|6)}{const t=e[2][0]!==n?2:3;return new Ve((e[t][0]+e[t][1])/2<<3|6,6|(e[2][0]!==n?0:65528))}}showCentroid(t){const e=this.centroidData[t.centroidDataIndex];e.flags&=rf,e.centroidXY.x=0,e.centroidXY.y=0,this.writeCentroidToBuffer(e)}writeCentroidToBuffer(t){this.groundEffect.updateHiddenByLandmark(t);const e=t.vertexArrayOffset,n=t.vertexCount+t.vertexArrayOffset,i=t.flags&rf?af:t.centroidXY,a=this.centroidVertexArray.geta_centroid_pos0(e);if(this.centroidVertexArray.geta_centroid_pos1(e)!==i.y||a!==i.x){for(let t=e;t<n;++t)this.centroidVertexArray.emplace(t,i.x,i.y);this.needsCentroidUpdate=!0}}createCentroidsBuffer(){this.centroidVertexArray.resize(this.layoutVertexArray.length),this.groundEffect.hiddenByLandmarkVertexArray.resize(this.groundEffect.vertexArray.length);for(const t of this.centroidData)this.writeCentroidToBuffer(t)}updateReplacement(t,e,n){if(e.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=e.updateTime;const i=e.getReplacementRegionsForTile(t.toUnwrapped());if(Pp(this.activeReplacements,i))return;if(this.activeReplacements=i,0===this.centroidVertexArray.length)this.createCentroidsBuffer();else for(const t of this.centroidData)t.flags&=2147483647;const a=[];for(const e of this.activeReplacements){if(e.order<n)continue;const i=Math.pow(2,e.footprintTileId.canonical.z-t.canonical.z);for(const n of this.centroidData)if(!(n.flags&rf||e.min.x>n.max.x||n.min.x>e.max.x||e.min.y>n.max.y||n.min.y>e.max.y))for(let r=0;r<n.footprintSegLen;r++){const o=this.footprintSegments[n.footprintSegIdx+r];if(a.length=0,Tf(this.footprintVertices,o.vertexOffset,o.vertexCount,e.footprintTileId.canonical,t.canonical,a),Lp(e.footprint,a,this.footprintIndices.uint16,o.indexOffset,o.indexCount,-o.vertexOffset,-i)){n.flags|=rf;break}}}for(const t of this.centroidData)this.writeCentroidToBuffer(t);this.borderDoneWithNeighborZ=[-1,-1,-1,-1]}footprintContainsPoint(t,e,n){let i=!1;for(let a=0;a<n.footprintSegLen;a++){const r=this.footprintSegments[n.footprintSegIdx+a];let o=0;for(const n of r.ringIndices){for(let a=o,s=n+o-1;a<n+o;s=a++){const n=this.footprintVertices.int16[2*(a+r.vertexOffset)+0],o=this.footprintVertices.int16[2*(a+r.vertexOffset)+1],l=this.footprintVertices.int16[2*(s+r.vertexOffset)+1];o>e!=l>e&&t<(this.footprintVertices.int16[2*(s+r.vertexOffset)+0]-n)*(e-o)/(l-o)+n&&(i=!i)}o=n}}return i}getHeightAtTileCoord(t,e){let n=Number.NEGATIVE_INFINITY,i=!0;const a=4*(t+ur)*ur+(e+ur);if(this.partLookup.hasOwnProperty(a)){const t=this.partLookup[a];return t?{height:t.height,hidden:!!(t.flags&rf)}:void 0}for(const r of this.centroidData)t>r.max.x||r.min.x>t||e>r.max.y||r.min.y>e||this.footprintContainsPoint(t,e,r)&&r&&r.height>n&&(n=r.height,this.partLookup[a]=r,i=!!(r.flags&rf));if(n!==Number.NEGATIVE_INFINITY)return{height:n,hidden:i};this.partLookup[a]=void 0}}function _f(t,e){const n=t.add(e)._unit();return t.x*n.x+t.y*n.y}function yf(t,e,n,i){const a=e.sub(t)._perp()._unit(),r=n.sub(e)._perp()._unit();return xf(t,e,n,_f(a,r),i)}function xf(t,e,n,i,a){const r=Math.sqrt(1-i*i);return Math.min(t.dist(e)/3,e.dist(n)/3,a*r/i)}function vf(t,e,n){return t.x<n[0].x&&e.x<n[0].x||t.x>n[1].x&&e.x>n[1].x||t.y<n[0].y&&e.y<n[0].y||t.y>n[1].y&&e.y>n[1].y}function bf(t,e){return t.x<e[0].x||t.x>e[1].x||t.y<e[0].y||t.y>e[1].y}function wf(t,e,n){if(t.x<0||t.x>=ur||e.x<0||e.x>=ur||n.x<0||n.x>=ur)return!1;const i=n.sub(e),a=i.perp(),r=t.sub(e);return(i.x*r.x+i.y*r.y)/Math.sqrt((i.x*i.x+i.y*i.y)*(r.x*r.x+r.y*r.y))>-.866&&a.x*r.x+a.y*r.y<0}function Af(t,e,n){const i=e?2|t:-3&t;return n?1|i:-2&i}function Cf(){const t=Math.PI/32,e=Math.tan(t),n=hu;return n*Math.sqrt(1+2*e*e)-n}function Ef(t,e,n){const i=1<<n.z,a=Mu(n.x/i),r=Mu((n.x+1)/i),o=ku(n.y/i),s=ku((n.y+1)/i);return function(t,e,n,i,a=0,r){const o=[];if(!t.length||!n||!i)return o;const s=(t,e)=>{for(const n of t)o.push({polygon:n,bounds:e})},l=Math.ceil(Math.log2(n)),c=Math.ceil(Math.log2(i)),u=l-c,h=[];for(let t=0;t<Math.abs(u);t++)h.push(u>0?0:1);for(let t=0;t<Math.min(l,c);t++)h.push(0),h.push(1);let d=t;if(d=Ep(d,e[0].y-a,e[1].y+a,1),d=Ep(d,e[0].x-a,e[1].x+a,0),!d.length)return o;const p=[];for(h.length?p.push({polygons:d,bounds:e,depth:0}):s(d,e);p.length;){const t=p.pop(),e=t.depth,n=h[e],i=t.bounds[0],o=t.bounds[1],l=0===n?i.x:i.y,c=0===n?o.x:o.y,u=r?r(n,l,c):.5*(l+c),d=Ep(t.polygons,l-a,u+a,n),f=Ep(t.polygons,u-a,c+a,n);if(d.length){const t=[i,new Ve(0===n?u:o.x,1===n?u:o.y)];h.length>e+1?p.push({polygons:d,bounds:t,depth:e+1}):s(d,t)}if(f.length){const t=[new Ve(0===n?u:i.x,1===n?u:i.y),o];h.length>e+1?p.push({polygons:f,bounds:t,depth:e+1}):s(f,t)}}return o}(t,e,Math.ceil((r-a)/11.25),Math.ceil((o-s)/11.25),1,((t,e,a)=>{if(0===t)return.5*(e+a);{const t=ku((n.y+e/ur)/i);return(Tu(.5*(ku((n.y+a/ur)/i)+t))*i-n.y)*ur}}))}function Tf(t,e,n,i,a,r){const o=Math.pow(2,i.z-a.z);for(let s=0;s<n;s++){let n=t.int16[2*(s+e)+0],l=t.int16[2*(s+e)+1];n=(n+a.x*ur)*o-i.x*ur,l=(l+a.y*ur)*o-i.y*ur,r.push(new Ve(n,l))}}bs(gf,"FillExtrusionBucket",{omit:["layers","features"]}),bs(uf,"PartData"),bs(cf,"FootprintSegment"),bs(hf,"BorderCentroidData"),bs(mf,"GroundEffect");const Sf=new rl({visibility:new nl(ol["layout_fill-extrusion"].visibility),"fill-extrusion-edge-radius":new nl(ol["layout_fill-extrusion"]["fill-extrusion-edge-radius"])});var Mf={paint:new rl({"fill-extrusion-opacity":new nl(ol["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new il(ol["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new nl(ol["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new nl(ol["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new il(ol["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new il(ol["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new il(ol["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new nl(ol["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new nl(ol["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new nl(ol["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-ambient-occlusion-wall-radius":new nl(ol["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-wall-radius"]),"fill-extrusion-ambient-occlusion-ground-radius":new nl(ol["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-radius"]),"fill-extrusion-ambient-occlusion-ground-attenuation":new nl(ol["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-attenuation"]),"fill-extrusion-flood-light-color":new nl(ol["paint_fill-extrusion"]["fill-extrusion-flood-light-color"]),"fill-extrusion-flood-light-intensity":new nl(ol["paint_fill-extrusion"]["fill-extrusion-flood-light-intensity"]),"fill-extrusion-flood-light-wall-radius":new il(ol["paint_fill-extrusion"]["fill-extrusion-flood-light-wall-radius"]),"fill-extrusion-flood-light-ground-radius":new il(ol["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-radius"]),"fill-extrusion-flood-light-ground-attenuation":new nl(ol["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-attenuation"]),"fill-extrusion-vertical-scale":new nl(ol["paint_fill-extrusion"]["fill-extrusion-vertical-scale"]),"fill-extrusion-rounded-roof":new nl(ol["paint_fill-extrusion"]["fill-extrusion-rounded-roof"]),"fill-extrusion-cutoff-fade-range":new nl(ol["paint_fill-extrusion"]["fill-extrusion-cutoff-fade-range"]),"fill-extrusion-emissive-strength":new nl(ol["paint_fill-extrusion"]["fill-extrusion-emissive-strength"])}),layout:Sf};function kf(t,e){return t.x*e.x+t.y*e.y}function If(t,e){if(1===t.length){let n=0;const i=e[n++];let a;for(;!a||i.equals(a);)if(a=e[n++],!a)return 1/0;for(;n<e.length;n++){const r=e[n],o=t[0],s=a.sub(i),l=r.sub(i),c=o.sub(i),u=kf(s,s),h=kf(s,l),d=kf(l,l),p=kf(c,s),f=kf(c,l),m=u*d-h*h,g=(d*p-h*f)/m,_=(u*f-h*p)/m,y=i.z*(1-g-_)+a.z*g+r.z*_;if(isFinite(y))return y}return 1/0}{let t=1/0;for(const n of e)t=Math.min(t,n.z);return t}}function Pf(t,e,n,i,a,r,o,s){const l=o*a.getElevationAt(t,e,!0,!0),c=0!==r[0],u=c?0===r[1]?o*(r[0]/7-450):o*function(t,e,n){const i=Math.floor(e[0]/8),a=Math.floor(e[1]/8),r=10*(e[0]-8*i),o=10*(e[1]-8*a),s=t.getElevationAt(i,a,!0,!0),l=t.getMeterToDEM(n),c=Math.floor(.5*(r*l-1)),u=Math.floor(.5*(o*l-1)),h=t.tileCoordToPixel(i,a),d=2*c+1,p=2*u+1,f=function(t,e,n,i,a){return[t.getElevationAtPixel(e,n,!0),t.getElevationAtPixel(e+a,n,!0),t.getElevationAtPixel(e,n+a,!0),t.getElevationAtPixel(e+i,n+a,!0)]}(t,h.x-c,h.y-u,d,p),m=Math.abs(f[0]-f[1]),g=Math.abs(f[2]-f[3]),_=Math.abs(f[0]-f[2])+Math.abs(f[1]-f[3]),y=Math.min(.25,.5*l*(m+g)/d),x=Math.min(.25,.5*l*_/p);return s+Math.max(y*r,x*o)}(a,r,s):l;return{base:l+(0===n)?-1:n,top:c?Math.max(u+i,l+n+2):l+i}}const zf=Il([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:Df}=zf,Lf=Il([{name:"a_packed",components:4,type:"Float32"}]),{members:Bf}=Lf,Of=Il([{name:"a_pattern_data",components:3,type:"Float32"}]),{members:Rf}=Of,Ff=Il([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Nf=Il([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),jf=Il([{name:"a_projected_pos",components:4,type:"Float32"}],4);Il([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const Vf=Il([{name:"a_occlusion_query_opacity",components:1,type:"Float32"}],4),Uf=Il([{name:"a_z_offset",components:1,type:"Float32"}],4),Gf=Il([{name:"a_texb",components:2,type:"Uint16"}]),qf=Il([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),$f=Il([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"},{name:"a_z_offset",components:1,type:"Float32"}]);Il([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const Wf=Il([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),Hf=Il([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);Il([{name:"triangle",components:3,type:"Uint16"}]),Il([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),Il([{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Float32",name:"zOffset"},{type:"Float32",name:"occlusionState"},{type:"Float32",name:"occlusionOpacity"},{type:"Uint8",name:"hasIconTextFit"}]),Il([{type:"Float32",name:"offsetX"}]),Il([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);class Zf{constructor(t,e){this.width=t,this.height=e,this.nextRow=0,this.image=new ud({width:t,height:e}),this.positions={},this.uploaded=!1}getDash(t,e){const n=this.getKey(t,e);return this.positions[n]}trim(){const t=this.width,e=this.height=on(this.nextRow);this.image.resize({width:t,height:e})}getKey(t,e){return t.join(",")+e}getDashRanges(t,e,n){const i=[];let a=t.length%2==1?-t[t.length-1]*n:0,r=t[0]*n,o=!0;i.push({left:a,right:r,isDash:o,zeroLength:0===t[0]});let s=t[0];for(let e=1;e<t.length;e++){o=!o;const l=t[e];a=s*n,s+=l,r=s*n,i.push({left:a,right:r,isDash:o,zeroLength:0===l})}return i}addRoundDash(t,e,n){const i=e/2;for(let e=-n;e<=n;e++){const a=this.width*(this.nextRow+n+e);let r=0,o=t[r];for(let s=0;s<this.width;s++){s/o.right>1&&(o=t[++r]);const l=Math.abs(s-o.left),c=Math.abs(s-o.right),u=Math.min(l,c);let h;const d=e/n*(i+1);if(o.isDash){const t=i-Math.abs(d);h=Math.sqrt(u*u+t*t)}else h=i-Math.sqrt(u*u+d*d);this.image.data[a+s]=Math.max(0,Math.min(255,h+128))}}}addRegularDash(t,e){for(let e=t.length-1;e>=0;--e){const n=t[e],i=t[e+1];n.zeroLength?t.splice(e,1):i&&i.isDash===n.isDash&&(i.left=n.left,t.splice(e,1))}const n=t[0],i=t[t.length-1];n.isDash===i.isDash&&(n.left=i.left-this.width,i.right=n.right+this.width);const a=this.width*this.nextRow;let r=0,o=t[r];for(let n=0;n<this.width;n++){n/o.right>1&&(o=t[++r]);const i=Math.abs(n-o.left),s=Math.abs(n-o.right),l=Math.min(i,s);this.image.data[a+n]=Math.max(0,Math.min(255,(o.isDash?l:-l)+e+128))}}addDash(t,e){const n=this.getKey(t,e);if(this.positions[n])return this.positions[n];const i="round"===e,a=i?7:0,r=2*a+1;if(this.nextRow+r>this.height)return fn("LineAtlas out of space"),null;0===t.length&&t.push(1);let o=0;for(let e=0;e<t.length;e++)t[e]<0&&(fn("Negative value is found in line dasharray, replacing values with 0"),t[e]=0),o+=t[e];if(0!==o){const n=this.width/o,r=this.getDashRanges(t,this.width,n);i?this.addRoundDash(r,n,a):this.addRegularDash(r,"square"===e?.5*n:0)}const s=this.nextRow+a;this.nextRow+=r;const l={tl:[s,a],br:[o,0]};return this.positions[n]=l,l}}bs(Zf,"LineAtlas");const Yf=wp.types,Xf=Math.cos(Math.PI/180*37.5),Kf=Math.cos(Math.PI/180*5);class Qf{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((t=>t.fqid)),this.index=t.index,this.projection=t.projection,this.hasPattern=!1,this.hasZOffset=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach((t=>{this.gradients[t.id]={}})),this.layoutVertexArray=new Ol,this.layoutVertexArray2=new Rl,this.patternVertexArray=new Fl,this.indexArray=new Kl,this.programConfigurations=new Yc(t.layers,{zoom:t.zoom,lut:t.lut}),this.segments=new wc,this.maxLineLength=0,this.zOffsetVertexArray=new $l,this.stateDependentLayerIds=this.layers.filter((t=>t.isStateDependent())).map((t=>t.id)),this.tessellationStep=t.tessellationStep?t.tessellationStep:ur/64}updateFootprints(t,e){}populate(t,e,n,i){this.hasPattern=Hd("line",this.layers,e);const a=this.layers[0].layout.get("line-sort-key"),r=this.layers[0].layout.get("line-z-offset");this.hasZOffset=!r.isConstant()||!!r.constantOr(0);const o=[];for(const{feature:e,id:r,index:s,sourceLayerIndex:l}of t){const t=this.layers[0]._featureFilter.needGeometry,c=$u(e,t);if(!this.layers[0]._featureFilter.filter(new Hs(this.zoom),c,n))continue;const u=a?a.evaluate(c,{},n):void 0,h={id:r,properties:e.properties,type:e.type,sourceLayerIndex:l,index:s,geometry:t?c.geometry:qu(e,n,i),patterns:{},sortKey:u};o.push(h)}a&&o.sort(((t,e)=>t.sortKey-e.sortKey));const{lineAtlas:s,featureIndex:l}=e,c=this.addConstantDashes(s);for(const i of o){const{geometry:a,index:r,sourceLayerIndex:o}=i;if(c&&this.addFeatureDashes(i,s),this.hasPattern){const t=Zd("line",this.layers,i,this.zoom,e);this.patternFeatures.push(t)}else this.addFeature(i,a,r,n,s.positions,e.availableImages,e.brightness);l.insert(t[r].feature,a,r,o,this.index)}}addConstantDashes(t){let e=!1;for(const n of this.layers){const i=n.paint.get("line-dasharray").value,a=n.layout.get("line-cap").value;if("constant"!==i.kind||"constant"!==a.kind)e=!0;else{const e=a.value,n=i.value;if(!n)continue;t.addDash(n,e)}}return e}addFeatureDashes(t,e){const n=this.zoom;for(const i of this.layers){const a=i.paint.get("line-dasharray").value,r=i.layout.get("line-cap").value;if("constant"===a.kind&&"constant"===r.kind)continue;let o,s;if("constant"===a.kind){if(o=a.value,!o)continue}else o=a.evaluate({zoom:n},t);s="constant"===r.kind?r.value:r.evaluate({zoom:n},t),e.addDash(o,s),t.patterns[i.id]=e.getKey(o,s)}}update(t,e,n,i,a){const r=0!==Object.keys(t).length;r&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(t,e,r?this.stateDependentLayers:this.layers,n,i,a)}addFeatures(t,e,n,i,a,r){for(const t of this.patternFeatures)this.addFeature(t,t.geometry,t.index,e,n,i,r)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(0!==this.layoutVertexArray2.length&&(this.layoutVertexBuffer2=t.createVertexBuffer(this.layoutVertexArray2,Bf)),0!==this.patternVertexArray.length&&(this.patternVertexBuffer=t.createVertexBuffer(this.patternVertexArray,Rf)),!this.zOffsetVertexBuffer&&this.zOffsetVertexArray.length>0&&(this.zOffsetVertexBuffer=t.createVertexBuffer(this.zOffsetVertexArray,Uf.members,!0)),this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Df),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy(),this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(t){if(t.properties&&t.properties.hasOwnProperty("mapbox_clip_start")&&t.properties.hasOwnProperty("mapbox_clip_end"))return{start:+t.properties.mapbox_clip_start,end:+t.properties.mapbox_clip_end}}addFeature(t,e,n,i,a,r,o){const s=this.layers[0].layout,l=s.get("line-join").evaluate(t,{}),c=s.get("line-cap").evaluate(t,{}),u=s.get("line-miter-limit"),h=s.get("line-round-limit");this.lineClips=this.lineFeatureClips(t);for(const n of e)this.addLine(n,t,i,l,c,u,h);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,n,a,r,i,o)}addLine(t,e,n,i,a,r,o){this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.currentVertex=void 0;const s={zoom:this.zoom,lineProgress:void 0},l=this.layers[0].layout,c="none"===i;if(this.patternJoinNone=this.hasPattern&&c,this.segmentStart=0,this.segmentStartf32=0,this.segmentPoints=[],this.lineClips){this.lineClipsArray.push(this.lineClips);for(let e=0;e<t.length-1;e++)this.totalDistance+=t[e].dist(t[e+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const u="Polygon"===Yf[e.type];let h=t.length;for(;h>=2&&t[h-1].equals(t[h-2]);)h--;let d=0;for(;d<h-1&&t[d].equals(t[d+1]);)d++;if(h<(u?3:2))return;"bevel"===i&&(r=1.05);const p=this.overscaling<=16?15*ur/(512*this.overscaling):0,f=this.segments.prepareSegment(10*h,this.layoutVertexArray,this.indexArray);let m,g,_,y,x,v;this.e1=this.e2=-1,u&&(m=t[h-2],x=t[d].sub(m)._unit()._perp());for(let n=d;n<h;n++){if(_=n===h-1?u?t[d+1]:void 0:t[n+1],_&&t[n].equals(_))continue;if(x&&(y=x),m&&(g=m),m=t[n],this.hasZOffset){const t=l.get("line-z-offset").value;if("constant"===t.kind)v=t.value;else{if(this.lineClips){const t=this.totalDistance/(this.lineClips.end-this.lineClips.start);s.lineProgress=(t*this.lineClips.start+this.distance+(g?g.dist(m):0))/t}else fn(`line-z-offset evaluation for ${this.layerIds[0]} requires enabling 'lineMetrics' for the source.`),s.lineProgress=0;v=t.evaluate(s,e)}v=v||0}x=_?_.sub(m)._unit()._perp():y,y=y||x;const b=g&&_;let w=b?i:u||c?"butt":a;const A=y.x*x.x+y.y*x.y;if(c){const t=function(t){if(t.patternJoinNone){const e=t.segmentPoints.length/2,n=t.lineSoFar-t.segmentStart;for(let i=0;i<e;++i){const e=t.segmentPoints[2*i+1],a=Math.round(t.segmentPoints[2*i])+.5+.25*e;t.patternVertexArray.emplaceBack(a,n,t.segmentStart),t.patternVertexArray.emplaceBack(a,n,t.segmentStart)}t.segmentPoints.length=0}t.e1=t.e2=-1};if(b&&A<Kf){this.updateDistance(g,m),this.addCurrentVertex(m,y,1,1,f,v),t(this),this.addCurrentVertex(m,x,-1,-1,f,v);continue}if(g){if(!_){this.updateDistance(g,m),this.addCurrentVertex(m,y,1,1,f,v),t(this);continue}w="miter"}}let C=y.add(x);0===C.x&&0===C.y||C._unit();const E=C.x*x.x+C.y*x.y,T=0!==E?1/E:1/0,S=2*Math.sqrt(2-2*E),M=E<Xf&&g&&_,k=y.x*x.y-y.y*x.x>0;if(M&&n>d){const t=m.dist(g);if(t>2*p){const e=m.sub(m.sub(g)._mult(p/t)._round());this.updateDistance(g,e),this.addCurrentVertex(e,y,0,0,f,v),g=e}}if(b&&"round"===w&&(T<o?w="miter":T<=2&&(w="fakeround")),"miter"===w&&T>r&&(w="bevel"),"bevel"===w&&(T>2&&(w="flipbevel"),T<r&&(w="miter")),g&&this.updateDistance(g,m),"miter"===w)C._mult(T),this.addCurrentVertex(m,C,0,0,f,v);else if("flipbevel"===w){if(T>100)C=x.mult(-1);else{const t=T*y.add(x).mag()/y.sub(x).mag();C._perp()._mult(t*(k?-1:1))}this.addCurrentVertex(m,C,0,0,f,v),this.addCurrentVertex(m,C.mult(-1),0,0,f,v)}else if("bevel"===w||"fakeround"===w){const t=-Math.sqrt(T*T-1),e=k?t:0,n=k?0:t;if(g&&this.addCurrentVertex(m,y,e,n,f,v),"fakeround"===w){const t=Math.round(180*S/Math.PI/20);for(let e=1;e<t;e++){let n=e/t;if(.5!==n){const t=n-.5;n+=n*t*(n-1)*((1.0904+A*(A*(3.55645-1.43519*A)-3.2452))*t*t+(.848013+A*(.215638*A-1.06021)))}const i=x.sub(y)._mult(n)._add(y)._unit()._mult(k?-1:1);this.addHalfVertex(m,i.x,i.y,!1,k,0,f,v)}}_&&this.addCurrentVertex(m,x,-e,-n,f,v)}else"butt"===w?this.addCurrentVertex(m,C,0,0,f,v):"square"===w?(g||this.addCurrentVertex(m,C,-1,-1,f,v),this.addCurrentVertex(m,C,0,0,f,v),g&&this.addCurrentVertex(m,C,1,1,f,v)):"round"===w&&(g&&(this.addCurrentVertex(m,y,0,0,f,v),this.addCurrentVertex(m,y,1,1,f,v,!0)),_&&(this.addCurrentVertex(m,x,-1,-1,f,v,!0),this.addCurrentVertex(m,x,0,0,f,v)));if(M&&n<h-1){const t=m.dist(_);if(t>2*p){const e=m.add(_.sub(m)._mult(p/t)._round());this.updateDistance(m,e),this.addCurrentVertex(e,x,0,0,f,v),m=e}}}}addVerticesTo(t,e,n,i,a,r,o,s,l,c){const u=(e.w-t.w)/this.tessellationStep|0;if(u>1){this.lineSoFar=t.w;const h=(e.x-t.x)/u,d=(e.y-t.y)/u,p=(e.z-t.z)/u,f=(e.w-t.w)/u;for(let e=1;e<u;++e)t.x+=h,t.y+=d,t.z+=p,this.lineSoFar+=f,this.addHalfVertex(t,n,i,c,!1,o,l,t.z),this.addHalfVertex(t,a,r,c,!0,-s,l,t.z)}this.lineSoFar=e.w,this.addHalfVertex(e,n,i,c,!1,o,l,e.z),this.addHalfVertex(e,a,r,c,!0,-s,l,e.z)}addCurrentVertex(t,e,n,i,a,r,o=!1){const s=e.x+e.y*n,l=e.y-e.x*n,c=e.y*i-e.x,u=-e.y-e.x*i;if(null!=r){const e=-10,h=ur+10,d=r,p=new Cp(t.x,t.y,d,this.lineSoFar),f=Jf(t,e,h),m=this.lineSoFar;if(this.currentVertex)if(f){const r=this.currentVertexIsOutside,p=this.currentVertex,f=new Cp(t.x,t.y,d,this.lineSoFar);Sp(p,f,e,h),Jf(f,e,h)||(r&&(this.e1=this.e2=-1,this.lineSoFar=p.w,this.addHalfVertex(p,s,l,o,!1,n,a,p.z),this.addHalfVertex(p,c,u,o,!0,-i,a,p.z)),this.addVerticesTo(p,f,s,l,c,u,n,i,a,o))}else{const t=this.currentVertex;this.currentVertexIsOutside&&(Sp(t,p,e,h),this.e1=this.e2=-1,this.lineSoFar=t.w,this.addHalfVertex(t,s,l,o,!1,n,a,t.z),this.addHalfVertex(t,c,u,o,!0,-i,a,t.z)),this.addVerticesTo(t,p,s,l,c,u,n,i,a,o)}else f||(this.addHalfVertex(t,s,l,o,!1,n,a,r),this.addHalfVertex(t,c,u,o,!0,-i,a,r));this.currentVertex=p,this.currentVertexIsOutside=f,this.lineSoFar=m}else this.addHalfVertex(t,s,l,o,!1,n,a,r),this.addHalfVertex(t,c,u,o,!0,-i,a,r)}addHalfVertex({x:t,y:e},n,i,a,r,o,s,l){this.patternJoinNone&&(0===this.segmentPoints.length&&(this.segmentStart=this.lineSoFar,this.segmentStartf32=Math.fround(this.lineSoFar)),r||this.segmentPoints.push(this.lineSoFar-this.segmentStart,o)),this.layoutVertexArray.emplaceBack((t<<1)+(a?1:0),(e<<1)+(r?1:0),Math.round(63*n)+128,Math.round(63*i)+128,1+(0===o?0:o<0?-1:1),0,this.lineSoFar-this.segmentStartf32),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const c=s.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,c),s.primitiveLength++),r?this.e2=c:this.e1=c,null!=l&&this.zOffsetVertexArray.emplaceBack(l)}updateScaledDistance(){if(this.lineClips){const t=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=t*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(t,e){this.distance+=t.dist(e),this.updateScaledDistance()}}function Jf(t,e,n){return t.x<e||t.x>n||t.y<e||t.y>n}bs(Qf,"LineBucket",{omit:["layers","patternFeatures","currentVertex","currentVertexIsOutside"]});const tm=new rl({"line-cap":new il(ol.layout_line["line-cap"]),"line-join":new il(ol.layout_line["line-join"]),"line-miter-limit":new nl(ol.layout_line["line-miter-limit"]),"line-round-limit":new nl(ol.layout_line["line-round-limit"]),"line-sort-key":new il(ol.layout_line["line-sort-key"]),"line-z-offset":new il(ol.layout_line["line-z-offset"]),visibility:new nl(ol.layout_line.visibility)});var em={paint:new rl({"line-opacity":new il(ol.paint_line["line-opacity"]),"line-color":new il(ol.paint_line["line-color"]),"line-translate":new nl(ol.paint_line["line-translate"]),"line-translate-anchor":new nl(ol.paint_line["line-translate-anchor"]),"line-width":new il(ol.paint_line["line-width"]),"line-gap-width":new il(ol.paint_line["line-gap-width"]),"line-offset":new il(ol.paint_line["line-offset"]),"line-blur":new il(ol.paint_line["line-blur"]),"line-dasharray":new il(ol.paint_line["line-dasharray"]),"line-pattern":new il(ol.paint_line["line-pattern"]),"line-gradient":new al(ol.paint_line["line-gradient"]),"line-trim-offset":new nl(ol.paint_line["line-trim-offset"]),"line-trim-fade-range":new nl(ol.paint_line["line-trim-fade-range"]),"line-trim-color":new nl(ol.paint_line["line-trim-color"]),"line-emissive-strength":new nl(ol.paint_line["line-emissive-strength"]),"line-border-width":new il(ol.paint_line["line-border-width"]),"line-border-color":new il(ol.paint_line["line-border-color"]),"line-occlusion-opacity":new nl(ol.paint_line["line-occlusion-opacity"])}),layout:tm};function nm(t,e,n){return e*(ur/(t.tileSize*Math.pow(2,n-t.tileID.overscaledZ)))}function im(t,e){return 1/nm(t,1,e.tileZoom)}function am(t,e,n,i){return t.translatePosMatrix(i||e.tileID.projMatrix,e,n.paint.get("line-translate"),n.paint.get("line-translate-anchor"))}const rm=t=>{const e=[];om(t)&&e.push("RENDER_LINE_DASH"),t.paint.get("line-gradient")&&e.push("RENDER_LINE_GRADIENT");const n=t.paint.get("line-trim-offset");0===n[0]&&0===n[1]||e.push("RENDER_LINE_TRIM_OFFSET"),0!==t.paint.get("line-border-width").constantOr(1)&&e.push("RENDER_LINE_BORDER");const i="none"===t.layout.get("line-join").constantOr("miter"),a=!!t.paint.get("line-pattern").constantOr(1);return i&&a&&e.push("LINE_JOIN_NONE"),e};function om(t){const e=t.paint.get("line-dasharray").value;return e.value||"constant"!==e.kind}class sm{constructor(t){this._stringToNumber={},this._numberToString=[];for(let e=0;e<t.length;e++){const n=t[e];this._stringToNumber[n]=e,this._numberToString[e]=n}}encode(t){return this._stringToNumber[t]}decode(t){return this._numberToString[t]}}var lm={read:function(t,e,n,i,a){var r,o,s=8*a-i-1,l=(1<<s)-1,c=l>>1,u=-7,h=n?a-1:0,d=n?-1:1,p=t[e+h];for(h+=d,r=p&(1<<-u)-1,p>>=-u,u+=s;u>0;r=256*r+t[e+h],h+=d,u-=8);for(o=r&(1<<-u)-1,r>>=-u,u+=i;u>0;o=256*o+t[e+h],h+=d,u-=8);if(0===r)r=1-c;else{if(r===l)return o?NaN:1/0*(p?-1:1);o+=Math.pow(2,i),r-=c}return(p?-1:1)*o*Math.pow(2,r-i)},write:function(t,e,n,i,a,r){var o,s,l,c=8*r-a-1,u=(1<<c)-1,h=u>>1,d=23===a?Math.pow(2,-24)-Math.pow(2,-77):0,p=i?0:r-1,f=i?1:-1,m=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(s=isNaN(e)?1:0,o=u):(o=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-o))<1&&(o--,l*=2),(e+=o+h>=1?d/l:d*Math.pow(2,1-h))*l>=2&&(o++,l/=2),o+h>=u?(s=0,o=u):o+h>=1?(s=(e*l-1)*Math.pow(2,a),o+=h):(s=e*Math.pow(2,h-1)*Math.pow(2,a),o=0));a>=8;t[n+p]=255&s,p+=f,s/=256,a-=8);for(o=o<<a|s,c+=a;c>0;t[n+p]=255&o,p+=f,o/=256,c-=8);t[n+p-f]|=128*m}},cm=hm,um=lm;function hm(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length}hm.Varint=0,hm.Fixed64=1,hm.Bytes=2,hm.Fixed32=5;var dm=4294967296,pm=1/dm,fm="undefined"==typeof TextDecoder?null:new TextDecoder("utf8");function mm(t){return t.type===hm.Bytes?t.readVarint()+t.pos:t.pos+1}function gm(t,e,n){return n?4294967296*e+(t>>>0):4294967296*(e>>>0)+(t>>>0)}function _m(t,e,n){var i=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));n.realloc(i);for(var a=n.pos-1;a>=t;a--)n.buf[a+i]=n.buf[a]}function ym(t,e){for(var n=0;n<t.length;n++)e.writeVarint(t[n])}function xm(t,e){for(var n=0;n<t.length;n++)e.writeSVarint(t[n])}function vm(t,e){for(var n=0;n<t.length;n++)e.writeFloat(t[n])}function bm(t,e){for(var n=0;n<t.length;n++)e.writeDouble(t[n])}function wm(t,e){for(var n=0;n<t.length;n++)e.writeBoolean(t[n])}function Am(t,e){for(var n=0;n<t.length;n++)e.writeFixed32(t[n])}function Cm(t,e){for(var n=0;n<t.length;n++)e.writeSFixed32(t[n])}function Em(t,e){for(var n=0;n<t.length;n++)e.writeFixed64(t[n])}function Tm(t,e){for(var n=0;n<t.length;n++)e.writeSFixed64(t[n])}function Sm(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+16777216*t[e+3]}function Mm(t,e,n){t[n]=e,t[n+1]=e>>>8,t[n+2]=e>>>16,t[n+3]=e>>>24}function km(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+(t[e+3]<<24)}hm.prototype={destroy:function(){this.buf=null},readFields:function(t,e,n){for(n=n||this.length;this.pos<n;){var i=this.readVarint(),a=i>>3,r=this.pos;this.type=7&i,t(a,e,this),this.pos===r&&this.skip(i)}return e},readMessage:function(t,e){return this.readFields(t,e,this.readVarint()+this.pos)},readFixed32:function(){var t=Sm(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=km(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=Sm(this.buf,this.pos)+Sm(this.buf,this.pos+4)*dm;return this.pos+=8,t},readSFixed64:function(){var t=Sm(this.buf,this.pos)+km(this.buf,this.pos+4)*dm;return this.pos+=8,t},readFloat:function(){var t=um.read(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=um.read(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var e,n,i=this.buf;return e=127&(n=i[this.pos++]),n<128?e:(e|=(127&(n=i[this.pos++]))<<7,n<128?e:(e|=(127&(n=i[this.pos++]))<<14,n<128?e:(e|=(127&(n=i[this.pos++]))<<21,n<128?e:function(t,e,n){var i,a,r=n.buf;if(i=(112&(a=r[n.pos++]))>>4,a<128)return gm(t,i,e);if(i|=(127&(a=r[n.pos++]))<<3,a<128)return gm(t,i,e);if(i|=(127&(a=r[n.pos++]))<<10,a<128)return gm(t,i,e);if(i|=(127&(a=r[n.pos++]))<<17,a<128)return gm(t,i,e);if(i|=(127&(a=r[n.pos++]))<<24,a<128)return gm(t,i,e);if(i|=(1&(a=r[n.pos++]))<<31,a<128)return gm(t,i,e);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(n=i[this.pos]))<<28,t,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var t=this.readVarint()+this.pos,e=this.pos;return this.pos=t,t-e>=12&&fm?function(t,e,n){return fm.decode(t.subarray(e,n))}(this.buf,e,t):function(t,e,n){for(var i="",a=e;a<n;){var r,o,s,l=t[a],c=null,u=l>239?4:l>223?3:l>191?2:1;if(a+u>n)break;1===u?l<128&&(c=l):2===u?128==(192&(r=t[a+1]))&&(c=(31&l)<<6|63&r)<=127&&(c=null):3===u?(o=t[a+2],128==(192&(r=t[a+1]))&&128==(192&o)&&((c=(15&l)<<12|(63&r)<<6|63&o)<=2047||c>=55296&&c<=57343)&&(c=null)):4===u&&(o=t[a+2],s=t[a+3],128==(192&(r=t[a+1]))&&128==(192&o)&&128==(192&s)&&((c=(15&l)<<18|(63&r)<<12|(63&o)<<6|63&s)<=65535||c>=1114112)&&(c=null)),null===c?(c=65533,u=1):c>65535&&(c-=65536,i+=String.fromCharCode(c>>>10&1023|55296),c=56320|1023&c),i+=String.fromCharCode(c),a+=u}return i}(this.buf,e,t)},readBytes:function(){var t=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,t);return this.pos=t,e},readPackedVarint:function(t,e){if(this.type!==hm.Bytes)return t.push(this.readVarint(e));var n=mm(this);for(t=t||[];this.pos<n;)t.push(this.readVarint(e));return t},readPackedSVarint:function(t){if(this.type!==hm.Bytes)return t.push(this.readSVarint());var e=mm(this);for(t=t||[];this.pos<e;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){if(this.type!==hm.Bytes)return t.push(this.readBoolean());var e=mm(this);for(t=t||[];this.pos<e;)t.push(this.readBoolean());return t},readPackedFloat:function(t){if(this.type!==hm.Bytes)return t.push(this.readFloat());var e=mm(this);for(t=t||[];this.pos<e;)t.push(this.readFloat());return t},readPackedDouble:function(t){if(this.type!==hm.Bytes)return t.push(this.readDouble());var e=mm(this);for(t=t||[];this.pos<e;)t.push(this.readDouble());return t},readPackedFixed32:function(t){if(this.type!==hm.Bytes)return t.push(this.readFixed32());var e=mm(this);for(t=t||[];this.pos<e;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){if(this.type!==hm.Bytes)return t.push(this.readSFixed32());var e=mm(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){if(this.type!==hm.Bytes)return t.push(this.readFixed64());var e=mm(this);for(t=t||[];this.pos<e;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){if(this.type!==hm.Bytes)return t.push(this.readSFixed64());var e=mm(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed64());return t},skip:function(t){var e=7&t;if(e===hm.Varint)for(;this.buf[this.pos++]>127;);else if(e===hm.Bytes)this.pos=this.readVarint()+this.pos;else if(e===hm.Fixed32)this.pos+=4;else{if(e!==hm.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(t,e){this.writeVarint(t<<3|e)},realloc:function(t){for(var e=this.length||16;e<this.pos+t;)e*=2;if(e!==this.length){var n=new Uint8Array(e);n.set(this.buf),this.buf=n,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),Mm(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),Mm(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),Mm(this.buf,-1&t,this.pos),Mm(this.buf,Math.floor(t*pm),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),Mm(this.buf,-1&t,this.pos),Mm(this.buf,Math.floor(t*pm),this.pos+4),this.pos+=8},writeVarint:function(t){(t=+t||0)>268435455||t<0?function(t,e){var n,i;if(t>=0?(n=t%4294967296|0,i=t/4294967296|0):(i=~(-t/4294967296),4294967295^(n=~(-t%4294967296))?n=n+1|0:(n=0,i=i+1|0)),t>=0x10000000000000000||t<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");e.realloc(10),function(t,e,n){n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos++]=127&t|128,n.buf[n.pos]=127&(t>>>=7)}(n,0,e),function(t,e){var n=(7&t)<<4;e.buf[e.pos++]|=n|((t>>>=3)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t)))))}(i,e)}(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))},writeSVarint:function(t){this.writeVarint(t<0?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(Boolean(t))},writeString:function(t){t=String(t),this.realloc(4*t.length),this.pos++;var e=this.pos;this.pos=function(t,e,n){for(var i,a,r=0;r<e.length;r++){if((i=e.charCodeAt(r))>55295&&i<57344){if(!a){i>56319||r+1===e.length?(t[n++]=239,t[n++]=191,t[n++]=189):a=i;continue}if(i<56320){t[n++]=239,t[n++]=191,t[n++]=189,a=i;continue}i=a-55296<<10|i-56320|65536,a=null}else a&&(t[n++]=239,t[n++]=191,t[n++]=189,a=null);i<128?t[n++]=i:(i<2048?t[n++]=i>>6|192:(i<65536?t[n++]=i>>12|224:(t[n++]=i>>18|240,t[n++]=i>>12&63|128),t[n++]=i>>6&63|128),t[n++]=63&i|128)}return n}(this.buf,t,this.pos);var n=this.pos-e;n>=128&&_m(e,n,this),this.pos=e-1,this.writeVarint(n),this.pos+=n},writeFloat:function(t){this.realloc(4),um.write(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),um.write(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var e=t.length;this.writeVarint(e),this.realloc(e);for(var n=0;n<e;n++)this.buf[this.pos++]=t[n]},writeRawMessage:function(t,e){this.pos++;var n=this.pos;t(e,this);var i=this.pos-n;i>=128&&_m(n,i,this),this.pos=n-1,this.writeVarint(i),this.pos+=i},writeMessage:function(t,e,n){this.writeTag(t,hm.Bytes),this.writeRawMessage(e,n)},writePackedVarint:function(t,e){e.length&&this.writeMessage(t,ym,e)},writePackedSVarint:function(t,e){e.length&&this.writeMessage(t,xm,e)},writePackedBoolean:function(t,e){e.length&&this.writeMessage(t,wm,e)},writePackedFloat:function(t,e){e.length&&this.writeMessage(t,vm,e)},writePackedDouble:function(t,e){e.length&&this.writeMessage(t,bm,e)},writePackedFixed32:function(t,e){e.length&&this.writeMessage(t,Am,e)},writePackedSFixed32:function(t,e){e.length&&this.writeMessage(t,Cm,e)},writePackedFixed64:function(t,e){e.length&&this.writeMessage(t,Em,e)},writePackedSFixed64:function(t,e){e.length&&this.writeMessage(t,Tm,e)},writeBytesField:function(t,e){this.writeTag(t,hm.Bytes),this.writeBytes(e)},writeFixed32Field:function(t,e){this.writeTag(t,hm.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(t,e){this.writeTag(t,hm.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(t,e){this.writeTag(t,hm.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(t,e){this.writeTag(t,hm.Fixed64),this.writeSFixed64(e)},writeVarintField:function(t,e){this.writeTag(t,hm.Varint),this.writeVarint(e)},writeSVarintField:function(t,e){this.writeTag(t,hm.Varint),this.writeSVarint(e)},writeStringField:function(t,e){this.writeTag(t,hm.Bytes),this.writeString(e)},writeFloatField:function(t,e){this.writeTag(t,hm.Fixed32),this.writeFloat(e)},writeDoubleField:function(t,e){this.writeTag(t,hm.Fixed64),this.writeDouble(e)},writeBooleanField:function(t,e){this.writeVarintField(t,Boolean(e))}};var Im=d(cm);const Pm=["id","tile","layer","source","sourceLayer","state"];class zm{constructor(t,e,n,i,a){this.type="Feature",this._vectorTileFeature=t,this._z=e,this._x=n,this._y=i,this.properties=t.properties,this.id=a}get geometry(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(t){this._geometry=t}toJSON(){const t={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};for(const e of Pm)void 0!==this[e]&&(t[e]=this[e]);return t}}class Dm{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(t,e,n){const i=String(e);if(this.stateChanges[t]=this.stateChanges[t]||{},this.stateChanges[t][i]=this.stateChanges[t][i]||{},en(this.stateChanges[t][i],n),null===this.deletedStates[t]){this.deletedStates[t]={};for(const e in this.state[t])e!==i&&(this.deletedStates[t][e]=null)}else if(this.deletedStates[t]&&null===this.deletedStates[t][i]){this.deletedStates[t][i]={};for(const e in this.state[t][i])n[e]||(this.deletedStates[t][i][e]=null)}else for(const e in n)this.deletedStates[t]&&this.deletedStates[t][i]&&null===this.deletedStates[t][i][e]&&delete this.deletedStates[t][i][e]}removeFeatureState(t,e,n){if(null===this.deletedStates[t])return;const i=String(e);if(this.deletedStates[t]=this.deletedStates[t]||{},n&&void 0!==e)null!==this.deletedStates[t][i]&&(this.deletedStates[t][i]=this.deletedStates[t][i]||{},this.deletedStates[t][i][n]=null);else if(void 0!==e)if(this.stateChanges[t]&&this.stateChanges[t][i])for(n in this.deletedStates[t][i]={},this.stateChanges[t][i])this.deletedStates[t][i][n]=null;else this.deletedStates[t][i]=null;else this.deletedStates[t]=null}getState(t,e){const n=String(e),i=en({},(this.state[t]||{})[n],(this.stateChanges[t]||{})[n]);if(null===this.deletedStates[t])return{};if(this.deletedStates[t]){const n=this.deletedStates[t][e];if(null===n)return{};for(const t in n)delete i[t]}return i}initializeTileState(t,e){t.setFeatureState(this.state,e)}coalesceChanges(t,e){const n={};for(const t in this.stateChanges){this.state[t]=this.state[t]||{};const e={};for(const n in this.stateChanges[t])this.state[t][n]||(this.state[t][n]={}),en(this.state[t][n],this.stateChanges[t][n]),e[n]=this.state[t][n];n[t]=e}for(const t in this.deletedStates){this.state[t]=this.state[t]||{};const e={};if(null===this.deletedStates[t])for(const n in this.state[t])e[n]={},this.state[t][n]={};else for(const n in this.deletedStates[t]){if(null===this.deletedStates[t][n])this.state[t][n]={};else if(this.state[t][n])for(const e of Object.keys(this.deletedStates[t][n]))delete this.state[t][n][e];e[n]=this.state[t][n]}n[t]=n[t]||{},en(n[t],e)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(n).length)for(const i in t)t[i].setFeatureState(n,e)}}class Lm{constructor(t,e){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new xs(ur,16,0),this.featureIndexArray=new yc,this.promoteId=e,this.is3DTile=!1}insert(t,e,n,i,a,r=0,o=0){const s=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(n,i,a,r);const l=this.grid;for(let t=0;t<e.length;t++){const n=e[t],i=[1/0,1/0,-1/0,-1/0];for(let t=0;t<n.length;t++){const e=n[t];i[0]=Math.min(i[0],e.x),i[1]=Math.min(i[1],e.y),i[2]=Math.max(i[2],e.x),i[3]=Math.max(i[3],e.y)}0!==o&&(i[0]-=o,i[1]-=o,i[2]+=o,i[3]+=o),i[0]<ur&&i[1]<ur&&i[2]>=0&&i[3]>=0&&l.insert(s,i[0],i[1],i[2],i[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new bp(new Im(this.rawTileData)).layers,this.sourceLayerCoder=new sm(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const t in this.vtLayers)this.vtFeatures[t]=[]}return this.vtLayers}query(t,e,n,i){this.loadVTLayers();const a=t.params||{},r=ul(a.filter),o=t.tileResult,s=t.transform,l=o.bufferedTilespaceBounds,c=this.grid.query(l.min.x,l.min.y,l.max.x,l.max.y,((t,e,n,i)=>rh(o.bufferedTilespaceGeometry,t,e,n,i)));c.sort(Om);let u=null;s.elevation&&c.length>0&&(u=Xp.create(s.elevation,this.tileID));const h={};let d;for(let l=0;l<c.length;l++){const p=c[l];if(p===d)continue;d=p;const f=this.featureIndexArray.get(p);let m=null;if(this.is3DTile){const t=this.bucketLayerIDs[0][0],n=e[t];if("model"!==n.type)continue;const{queryFeature:i,intersectionZ:a}=n.queryIntersectsMatchingFeature(o,f.featureIndex,r,s);i&&this.appendToResult(h,t,f.featureIndex,i,a)}else this.loadMatchingFeature(h,f,r,a.layers,a.availableImages,e,n,i,((e,n,i,a=0)=>(m||(m=qu(e,this.tileID.canonical,t.tileTransform)),n.queryIntersectsFeature(o,e,i,m,this.z,t.transform,t.pixelPosMatrix,u,a))))}return h}loadMatchingFeature(t,e,n,i,a,r,o,s,l){const{featureIndex:c,bucketIndex:u,sourceLayerIndex:h,layoutVertexArrayOffset:d}=e,p=this.bucketLayerIDs[u];if(i&&!function(t,e){for(let n=0;n<t.length;n++)if(e.indexOf(t[n])>=0)return!0;return!1}(i,p))return;const f=this.sourceLayerCoder.decode(h),m=this.vtLayers[f].feature(c);if(n.needGeometry){const t=$u(m,!0);if(!n.filter(new Hs(this.tileID.overscaledZ),t,this.tileID.canonical))return}else if(!n.filter(new Hs(this.tileID.overscaledZ),m))return;const g=this.getId(m,f);for(let e=0;e<p.length;e++){const n=p[e];if(i&&i.indexOf(n)<0)continue;const u=r[n];if(!u)continue;let h={};void 0!==g&&s&&(h=s.getState(u.sourceLayer||"_geojsonTileLayer",g));const f=!l||l(m,u,h,d);if(!f)continue;const _=new zm(m,this.z,this.x,this.y,g),y=en({},o[n]);y.paint=Bm(y.paint,u.paint,m,h,a),y.layout=Bm(y.layout,u.layout,m,h,a),_.layer=y,this.appendToResult(t,n,c,_,f)}}appendToResult(t,e,n,i,a){let r=t[e];void 0===r&&(r=t[e]=[]),r.push({featureIndex:n,feature:i,intersectionZ:a})}lookupSymbolFeatures(t,e,n,i,a,r,o,s){const l={};this.loadVTLayers();const c=ul(a);for(const a of t)this.loadMatchingFeature(l,{bucketIndex:n,sourceLayerIndex:i,featureIndex:a,layoutVertexArrayOffset:0},c,r,o,s,e);return l}loadFeature(t){const{featureIndex:e,sourceLayerIndex:n}=t;this.loadVTLayers();const i=this.sourceLayerCoder.decode(n),a=this.vtFeatures[i];if(a[e])return a[e];const r=this.vtLayers[i].feature(e);return a[e]=r,r}hasLayer(t){for(const e of this.bucketLayerIDs)for(const n of e)if(t===n)return!0;return!1}getId(t,e){let n=t.id;if(this.promoteId){const i="string"==typeof this.promoteId?this.promoteId:this.promoteId[e];null!=i&&(n=t.properties[i]),"boolean"==typeof n&&(n=Number(n))}return n}}function Bm(t,e,n,i,a){return un(t,((t,r)=>{const o=e instanceof el?e.get(r):null;return o&&o.evaluate?o.evaluate(n,i,a):o}))}function Om(t,e){return e-t}bs(Lm,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});var Rm=24;const Fm=128;function Nm(t,e){const{expression:n}=e;if("constant"===n.kind)return{kind:"constant",layoutSize:n.evaluate(new Hs(t+1))};if("source"===n.kind)return{kind:"source"};{const{zoomStops:e,interpolationType:i}=n;let a=0;for(;a<e.length&&e[a]<=t;)a++;a=Math.max(0,a-1);let r=a;for(;r<e.length&&e[r]<t+1;)r++;r=Math.min(e.length-1,r);const o=e[a],s=e[r];return"composite"===n.kind?{kind:"composite",minZoom:o,maxZoom:s,interpolationType:i}:{kind:"camera",minZoom:o,maxZoom:s,minSize:n.evaluate(new Hs(o)),maxSize:n.evaluate(new Hs(s)),interpolationType:i}}}function jm(t,{uSize:e,uSizeT:n},{lowerSize:i,upperSize:a}){return"source"===t.kind?i/Fm:"composite"===t.kind?Gi(i/Fm,a/Fm,n):e}function Vm(t,e){let n=0,i=0;if("constant"===t.kind)i=t.layoutSize;else if("source"!==t.kind){const{interpolationType:a,minZoom:r,maxZoom:o}=t,s=a?Xe(xo.interpolationFactor(a,e,r,o),0,1):0;"camera"===t.kind?i=Gi(t.minSize,t.maxSize,s):n=s}return{uSizeT:n,uSize:i}}var Um=Object.freeze({__proto__:null,SIZE_PACK_FACTOR:Fm,evaluateSizeForFeature:jm,evaluateSizeForZoom:Vm,getSizeData:Nm});function Gm(t,e,n){return t.sections.forEach((t=>{t.text=function(t,e,n){const i=e.layout.get("text-transform").evaluate(n,{});return"uppercase"===i?t=t.toLocaleUpperCase():"lowercase"===i&&(t=t.toLocaleLowerCase()),Ws.applyArabicShaping&&(t=Ws.applyArabicShaping(t)),t}(t.text,e,n)})),t}const qm={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂","←":"↑","→":"↓"};function $m(t){return"︶"===t||"﹈"===t||"︸"===t||"﹄"===t||"﹂"===t||"︾"===t||"︼"===t||"︺"===t||"︘"===t||"﹀"===t||"︐"===t||"︓"===t||"︔"===t||"｀"===t||"￣"===t||"︑"===t||"︒"===t}function Wm(t){return"︵"===t||"﹇"===t||"︷"===t||"﹃"===t||"﹁"===t||"︽"===t||"︻"===t||"︹"===t||"︗"===t||"︿"===t}const Hm=3;function Zm(t,e,n){e.glyphs=[],1===t&&n.readMessage(Ym,e)}function Ym(t,e,n){if(3===t){const{id:t,bitmap:i,width:a,height:r,left:o,top:s,advance:l}=n.readMessage(Xm,{});e.glyphs.push({id:t,bitmap:new ud({width:a+2*Hm,height:r+2*Hm},i),metrics:{width:a,height:r,left:o,top:s,advance:l}})}else 4===t?e.ascender=n.readSVarint():5===t&&(e.descender=n.readSVarint())}function Xm(t,e,n){1===t?e.id=n.readVarint():2===t?e.bitmap=n.readBytes():3===t?e.width=n.readVarint():4===t?e.height=n.readVarint():5===t?e.left=n.readSVarint():6===t?e.top=n.readSVarint():7===t&&(e.advance=n.readVarint())}const Km=Hm,Qm={horizontal:1,vertical:2,horizontalOnly:3};class Jm{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(t,e){const n=new Jm;return n.scale=t||1,n.fontStack=e,n}static forImage(t){const e=new Jm;return e.imageName=t,e}}class tg{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(t,e){const n=new tg;for(let i=0;i<t.sections.length;i++){const a=t.sections[i];a.image?n.addImageSection(a):n.addTextSection(a,e)}return n}length(){return this.text.length}getSection(t){return this.sections[this.sectionIndex[t]]}getSections(){return this.sections}getSectionIndex(t){return this.sectionIndex[t]}getCodePoint(t){return this.text.codePointAt(t)}verticalizePunctuation(t){this.text=function(t,e){let n="";for(let i=0;i<t.length;i++){const a=t.charCodeAt(i+1)||null,r=t.charCodeAt(i-1)||null;n+=!e&&(a&&Ps(a)&&!qm[t[i+1]]||r&&Ps(r)&&!qm[t[i-1]])||!qm[t[i]]?t[i]:qm[t[i]]}return n}(this.text,t)}trim(){let t=0;for(let e=0;e<this.text.length&&ng[this.text.charCodeAt(e)];e++)t++;let e=this.text.length;for(let n=this.text.length-1;n>=0&&n>=t&&ng[this.text.charCodeAt(n)];n--)e--;this.text=this.text.substring(t,e),this.sectionIndex=this.sectionIndex.slice(t,e)}substring(t,e){const n=new tg;return n.text=this.text.substring(t,e),n.sectionIndex=this.sectionIndex.slice(t,e),n.sections=this.sections,n}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce(((t,e)=>Math.max(t,this.sections[e].scale)),0)}addTextSection(t,e){this.text+=t.text,this.sections.push(Jm.forText(t.scale,t.fontStack||e));const n=this.sections.length-1;for(let e=0;e<t.text.length;++e)this.sectionIndex.push(n)}addImageSection(t){const e=t.image?t.image.namePrimary:"";if(0===e.length)return void fn("Can't add FormattedSection with an empty image.");const n=this.getNextImageSectionCharCode();n?(this.text+=String.fromCodePoint(n),this.sections.push(Jm.forImage(e)),this.sectionIndex.push(this.sections.length-1)):fn("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function eg(t,e,n,i,a,r,o,s,l,c,u,h,d,p,f){const m=tg.fromFeature(t,a);h===Qm.vertical&&m.verticalizePunctuation(d);let g=[];const _=function(t,e,n,i,a,r){if(!t)return[];const o=[],s=function(t,e,n,i,a,r){let o=0;for(let n=0;n<t.length();n++){const s=t.getSection(n);o+=ag(t.getCodePoint(n),s,i,a,e,r)}return o/Math.max(1,Math.ceil(o/n))}(t,e,n,i,a,r),l=t.text.indexOf("​")>=0;let c=0;for(let n=0;n<t.length();n++){const h=t.getSection(n),d=t.getCodePoint(n);if(ng[d]||(c+=ag(d,h,i,a,e,r)),n<t.length()-1){const e=!((u=d)<11904||!(Ts["Bopomofo Extended"](u)||Ts.Bopomofo(u)||Ts["CJK Compatibility Forms"](u)||Ts["CJK Compatibility Ideographs"](u)||Ts["CJK Compatibility"](u)||Ts["CJK Radicals Supplement"](u)||Ts["CJK Strokes"](u)||Ts["CJK Symbols and Punctuation"](u)||Ts["CJK Unified Ideographs Extension A"](u)||Ts["CJK Unified Ideographs"](u)||Ts["Enclosed CJK Letters and Months"](u)||Ts["Halfwidth and Fullwidth Forms"](u)||Ts.Hiragana(u)||Ts["Ideographic Description Characters"](u)||Ts["Kangxi Radicals"](u)||Ts["Katakana Phonetic Extensions"](u)||Ts.Katakana(u)||Ts["Vertical Forms"](u)||Ts["Yi Radicals"](u)||Ts["Yi Syllables"](u)));(ig[d]||e||h.imageName)&&o.push(sg(n+1,c,s,o,og(d,t.getCodePoint(n+1),e&&l),!1))}}var u;return lg(sg(t.length(),c,s,o,0,!0))}(m,c,r,e,i,p),{processBidirectionalText:y,processStyledBidirectionalText:x}=Ws;if(y&&1===m.sections.length){const t=y(m.toString(),_);for(const e of t){const t=new tg;t.text=e,t.sections=m.sections;for(let n=0;n<e.length;n++)t.sectionIndex.push(0);g.push(t)}}else if(x){const t=x(m.text,m.sectionIndex,_);for(const e of t){const t=new tg;t.text=e[0],t.sectionIndex=e[1],t.sections=m.sections,g.push(t)}}else g=function(t,e){const n=[],i=t.text;let a=0;for(const i of e)n.push(t.substring(a,i)),a=i;return a<i.length&&n.push(t.substring(a,i.length)),n}(m,_);const v=[],b={positionedLines:v,text:m.toString(),top:u[1],bottom:u[1],left:u[0],right:u[0],writingMode:h,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(t,e,n,i,a,r,o,s,l,c,u,h){let d=0,p=0,f=0;const m="right"===s?1:"left"===s?0:.5;let g=!1;for(const t of a){const n=t.getSections();for(const t of n){if(t.imageName)continue;const n=e[t.fontStack];if(n&&(g=void 0!==n.ascender&&void 0!==n.descender,!g))break}if(!g)break}let _=0;for(const o of a){o.trim();const a=o.getMaxScale(),s=(a-1)*Rm,x={positionedGlyphs:[],lineOffset:0};t.positionedLines[_]=x;const v=x.positionedGlyphs;let b=0;if(!o.length()){p+=r,++_;continue}let w=0,A=0;for(let r=0;r<o.length();r++){const s=o.getSection(r),f=o.getSectionIndex(r),m=o.getCodePoint(r);let _=s.scale,x=null,C=null,E=null,T=Rm,S=0;const M=!(l===Qm.horizontal||!u&&!Is(m)||u&&(ng[m]||(y=m,Ts.Arabic(y)||Ts["Arabic Supplement"](y)||Ts["Arabic Extended-A"](y)||Ts["Arabic Presentation Forms-A"](y)||Ts["Arabic Presentation Forms-B"](y))));if(s.imageName){const e=i[s.imageName];if(!e)continue;E=s.imageName,t.iconsInText=t.iconsInText||!0,C=e.paddedRect;const n=e.displaySize;_=_*Rm/h,x={width:n[0],height:n[1],left:0,top:-Km,advance:M?n[1]:n[0],localGlyph:!1},S=g?-x.height*_:a*Rm-17-n[1]*_,T=x.advance;const r=(M?n[0]:n[1])*_-Rm*a;r>0&&r>b&&(b=r)}else{const t=n[s.fontStack];if(!t)continue;t[m]&&(C=t[m]);const i=e[s.fontStack];if(!i)continue;const r=i.glyphs[m];if(!r)continue;if(x=r.metrics,T=8203!==m?Rm:0,g){const t=void 0!==i.ascender?Math.abs(i.ascender):0,e=void 0!==i.descender?Math.abs(i.descender):0,n=(t+e)*_;w<n&&(w=n,A=(t-e)/2*_),S=-t*_}else S=(a-_)*Rm-17}M?(t.verticalizable=!0,v.push({glyph:m,imageName:E,x:d,y:p+S,vertical:M,scale:_,localGlyph:x.localGlyph,fontStack:s.fontStack,sectionIndex:f,metrics:x,rect:C}),d+=T*_+c):(v.push({glyph:m,imageName:E,x:d,y:p+S,vertical:M,scale:_,localGlyph:x.localGlyph,fontStack:s.fontStack,sectionIndex:f,metrics:x,rect:C}),d+=x.advance*_+c)}0!==v.length&&(f=Math.max(d-c,f),g?ug(v,m,b,A,r*a/2):ug(v,m,b,0,r/2)),d=0;const C=r*a+b;x.lineOffset=Math.max(b,s),p+=C,++_}var y;const x=p,{horizontalAlign:v,verticalAlign:b}=cg(o);(function(t,e,n,i,a,r){const o=(e-n)*a,s=-r*i;for(const e of t)for(const t of e.positionedGlyphs)t.x+=o,t.y+=s})(t.positionedLines,m,v,b,f,x),t.top+=-b*x,t.bottom=t.top+x,t.left+=-v*f,t.right=t.left+f,t.hasBaseline=g}(b,e,n,i,g,o,s,l,h,c,d,f),!function(t){for(const e of t)if(0!==e.positionedGlyphs.length)return!1;return!0}(v)&&b}const ng={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},ig={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function ag(t,e,n,i,a,r){if(e.imageName){const t=i[e.imageName];return t?t.displaySize[0]*e.scale*Rm/r+a:0}{const i=n[e.fontStack],r=i&&i.glyphs[t];return r?r.metrics.advance*e.scale+a:0}}function rg(t,e,n,i){const a=Math.pow(t-e,2);return i?t<e?a/2:2*a:a+Math.abs(n)*n}function og(t,e,n){let i=0;return 10===t&&(i-=1e4),n&&(i+=150),40!==t&&65288!==t||(i+=50),41!==e&&65289!==e||(i+=50),i}function sg(t,e,n,i,a,r){let o=null,s=rg(e,n,a,r);for(const t of i){const i=rg(e-t.x,n,a,r)+t.badness;i<=s&&(o=t,s=i)}return{index:t,x:e,priorBreak:o,badness:s}}function lg(t){return t?lg(t.priorBreak).concat(t.index):[]}function cg(t){let e=.5,n=.5;switch(t){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0}switch(t){case"bottom":case"bottom-right":case"bottom-left":n=1;break;case"top":case"top-right":case"top-left":n=0}return{horizontalAlign:e,verticalAlign:n}}function ug(t,e,n,i,a){if(!(e||n||i||a))return;const r=t.length-1,o=t[r],s=(o.x+o.metrics.advance*o.scale)*e;for(let e=0;e<=r;e++)t[e].x-=s,t[e].y+=n+i+a}function hg(t,e,n,i){const{horizontalAlign:a,verticalAlign:r}=cg(i),o=n[0]-t.displaySize[0]*a,s=n[1]-t.displaySize[1]*r;return{imagePrimary:t,imageSecondary:e,top:s,bottom:s+t.displaySize[1],left:o,right:o+t.displaySize[0]}}function dg(t,e,n,i,a,r){const o=t.imagePrimary;let s;if(o.content){const t=o.content,e=o.pixelRatio||1;s=[t[0]/e,t[1]/e,o.displaySize[0]-t[2]/e,o.displaySize[1]-t[3]/e]}const l=e.left*r,c=e.right*r;let u,h,d,p;"width"===n||"both"===n?(p=a[0]+l-i[3],h=a[0]+c+i[1]):(p=a[0]+(l+c-o.displaySize[0])/2,h=p+o.displaySize[0]);const f=e.top*r,m=e.bottom*r;return"height"===n||"both"===n?(u=a[1]+f-i[0],d=a[1]+m+i[2]):(u=a[1]+(f+m-o.displaySize[1])/2,d=u+o.displaySize[1]),{imagePrimary:o,imageSecondary:void 0,top:u,right:h,bottom:d,left:p,collisionPadding:s}}class pg extends Ve{constructor(t,e,n,i,a){super(t,e),this.angle=i,this.z=n,void 0!==a&&(this.segment=a)}clone(){return new pg(this.x,this.y,this.z,this.angle,this.segment)}}function fg(t,e,n,i,a){if(void 0===e.segment)return!0;let r=e,o=e.segment+1,s=0;for(;s>-n/2;){if(o--,o<0)return!1;s-=t[o].dist(r),r=t[o]}s+=t[o].dist(t[o+1]),o++;const l=[];let c=0;for(;s<n/2;){const e=t[o],n=t[o+1];if(!n)return!1;let r=t[o-1].angleTo(e)-e.angleTo(n);for(r=Math.abs((r+3*Math.PI)%(2*Math.PI)-Math.PI),l.push({distance:s,angleDelta:r}),c+=r;s-l[0].distance>i;)c-=l.shift().angleDelta;if(c>a)return!1;o++,s+=e.dist(n)}return!0}function mg(t){let e=0;for(let n=0;n<t.length-1;n++)e+=t[n].dist(t[n+1]);return e}function gg(t,e,n){return t?.6*e*n:0}function _g(t,e){return Math.max(t?t.right-t.left:0,e?e.right-e.left:0)}function yg(t,e,n,i,a,r){const o=gg(n,a,r),s=_g(n,i)*r;let l=0;const c=mg(t)/2;for(let n=0;n<t.length-1;n++){const i=t[n],a=t[n+1],r=i.dist(a);if(l+r>c){const u=(c-l)/r,h=Gi(i.x,a.x,u),d=Gi(i.y,a.y,u),p=new pg(h,d,0,a.angleTo(i),n);return!o||fg(t,p,s,o,e)?p:void 0}l+=r}}function xg(t,e,n,i,a,r,o,s,l){const c=gg(i,r,o),u=_g(i,a),h=u*o,d=0===t[0].x||t[0].x===l||0===t[0].y||t[0].y===l;return e-h<e/4&&(e=h+e/4),vg(t,d?e/2*s%e:(u/2+2*r)*o*s%e,e,c,n,h,d,!1,l)}function vg(t,e,n,i,a,r,o,s,l){const c=r/2,u=mg(t);let h=0,d=e-n,p=[];for(let e=0;e<t.length-1;e++){const o=t[e],s=t[e+1],f=o.dist(s),m=s.angleTo(o);for(;d+n<h+f;){d+=n;const g=(d-h)/f,_=Gi(o.x,s.x,g),y=Gi(o.y,s.y,g);if(_>=0&&_<l&&y>=0&&y<l&&d-c>=0&&d+c<=u){const n=new pg(_,y,0,m,e);i&&!fg(t,n,r,i,a)||p.push(n)}}h+=f}return s||p.length||o||(p=vg(t,h/2,n,i,a,r,o,!0,l)),p}function bg(t,e,n,i,a){const r=[];for(let o=0;o<t.length;o++){const s=t[o];let l;for(let t=0;t<s.length-1;t++){let o=s[t],c=s[t+1];o.x<e&&c.x<e||(o.x<e?o=new Ve(e,o.y+(e-o.x)/(c.x-o.x)*(c.y-o.y))._round():c.x<e&&(c=new Ve(e,o.y+(e-o.x)/(c.x-o.x)*(c.y-o.y))._round()),o.y<n&&c.y<n||(o.y<n?o=new Ve(o.x+(n-o.y)/(c.y-o.y)*(c.x-o.x),n)._round():c.y<n&&(c=new Ve(o.x+(n-o.y)/(c.y-o.y)*(c.x-o.x),n)._round()),o.x>=i&&c.x>=i||(o.x>=i?o=new Ve(i,o.y+(i-o.x)/(c.x-o.x)*(c.y-o.y))._round():c.x>=i&&(c=new Ve(i,o.y+(i-o.x)/(c.x-o.x)*(c.y-o.y))._round()),o.y>=a&&c.y>=a||(o.y>=a?o=new Ve(o.x+(a-o.y)/(c.y-o.y)*(c.x-o.x),a)._round():c.y>=a&&(c=new Ve(o.x+(a-o.y)/(c.y-o.y)*(c.x-o.x),a)._round()),l&&o.equals(l[l.length-1])||(l=[o],r.push(l)),l.push(c)))))}}return r}function wg(t){let e=0,n=0;for(const i of t)e+=i.w*i.h,n=Math.max(n,i.w);t.sort(((t,e)=>e.h-t.h));const i=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),n),h:1/0}];let a=0,r=0;for(const e of t)for(let t=i.length-1;t>=0;t--){const n=i[t];if(!(e.w>n.w||e.h>n.h)){if(e.x=n.x,e.y=n.y,r=Math.max(r,e.y+e.h),a=Math.max(a,e.x+e.w),e.w===n.w&&e.h===n.h){const e=i.pop();t<i.length&&(i[t]=e)}else e.h===n.h?(n.x+=e.w,n.w-=e.w):e.w===n.w?(n.y+=e.h,n.h-=e.h):(i.push({x:n.x+e.w,y:n.y,w:n.w-e.w,h:e.h}),n.y+=e.h,n.h-=e.h);break}}return{w:a,h:r,fill:e/(a*r)||0}}bs(pg,"Anchor");const Ag=1;class Cg{constructor(t,{pixelRatio:e,version:n,stretchX:i,stretchY:a,content:r}){this.paddedRect=t,this.pixelRatio=e,this.stretchX=i,this.stretchY=a,this.content=r,this.version=n}get tl(){return[this.paddedRect.x+Ag,this.paddedRect.y+Ag]}get br(){return[this.paddedRect.x+this.paddedRect.w-Ag,this.paddedRect.y+this.paddedRect.h-Ag]}get displaySize(){return[(this.paddedRect.w-2*Ag)/this.pixelRatio,(this.paddedRect.h-2*Ag)/this.pixelRatio]}}class Eg{constructor(t,e,n){const i={},a={};this.haveRenderCallbacks=[];const r=[];this.addImages(t,i,r),this.addImages(e,a,r);const{w:o,h:s}=wg(r),l=new hd({width:o||1,height:s||1});for(const e in t){const a=t[e],r=i[e].paddedRect;hd.copy(a.data,l,{x:0,y:0},{x:r.x+Ag,y:r.y+Ag},a.data,n,a.sdf)}for(const t in e){const i=e[t],r=a[t].paddedRect,o=r.x+Ag,s=r.y+Ag,c=i.data.width,u=i.data.height;hd.copy(i.data,l,{x:0,y:0},{x:o,y:s},i.data,n),hd.copy(i.data,l,{x:0,y:u-1},{x:o,y:s-1},{width:c,height:1},n),hd.copy(i.data,l,{x:0,y:0},{x:o,y:s+u},{width:c,height:1},n),hd.copy(i.data,l,{x:c-1,y:0},{x:o-1,y:s},{width:1,height:u},n),hd.copy(i.data,l,{x:0,y:0},{x:o+c,y:s},{width:1,height:u},n)}this.image=l,this.iconPositions=i,this.patternPositions=a}addImages(t,e,n){for(const i in t){const a=t[i],r={x:0,y:0,w:a.data.width+2*Ag,h:a.data.height+2*Ag};n.push(r),e[i]=new Cg(r,a),a.hasRenderCallback&&this.haveRenderCallbacks.push(i)}}patchUpdatedImages(t,e,n){this.haveRenderCallbacks=this.haveRenderCallbacks.filter((e=>t.hasImage(e,n))),t.dispatchRenderCallbacks(this.haveRenderCallbacks,n);for(const i in t.getUpdatedImages(n))this.patchUpdatedImage(this.iconPositions[i],t.getImage(i,n),e),this.patchUpdatedImage(this.patternPositions[i],t.getImage(i,n),e)}patchUpdatedImage(t,e,n){if(!t||!e)return;if(t.version===e.version)return;t.version=e.version;const[i,a]=t.tl,r=!!Object.keys(this.patternPositions).length;n.update(e.data,{useMipmap:r},{x:i,y:a})}}bs(Cg,"ImagePosition"),bs(Eg,"ImageAtlas");const Tg=1e20;function Sg(t,e,n,i,a,r,o,s,l){for(let c=e;c<e+i;c++)Mg(t,n*r+c,r,a,o,s,l);for(let c=n;c<n+a;c++)Mg(t,c*r+e,1,i,o,s,l)}function Mg(t,e,n,i,a,r,o){r[0]=0,o[0]=-Tg,o[1]=Tg,a[0]=t[e];for(let s=1,l=0,c=0;s<i;s++){a[s]=t[e+s*n];const i=s*s;do{const t=r[l];c=(a[s]-a[t]+i-t*t)/(s-t)/2}while(c<=o[l]&&--l>-1);l++,r[l]=s,o[l]=c,o[l+1]=Tg}for(let s=0,l=0;s<i;s++){for(;o[l+1]<s;)l++;const i=r[l],c=s-i;t[e+s*n]=a[i]+c*c}}const kg=2,Ig={none:0,ideographs:1,all:2};class Pg{constructor(t,e,n){this.requestManager=t,this.localGlyphMode=e,this.localFontFamily=n,this.urls={},this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(t,e){this.urls[e]=t}getGlyphs(t,e,n){const a=[],r=this.urls[e]||i.GLYPHS_URL;for(const e in t)for(const n of t[e])a.push({stack:e,id:n});Je(a,(({stack:t,id:e},n)=>{let i=this.entries[t];i||(i=this.entries[t]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let a=i.glyphs[e];if(void 0!==a)return void n(null,{stack:t,id:e,glyph:a});if(a=this._tinySDF(i,t,e),a)return i.glyphs[e]=a,void n(null,{stack:t,id:e,glyph:a});const o=Math.floor(e/256);if(256*o>65535)return void n(new Error("glyphs > 65535 not supported"));if(i.ranges[o])return void n(null,{stack:t,id:e,glyph:a});let s=i.requests[o];s||(s=i.requests[o]=[],Pg.loadGlyphRange(t,o,r,this.requestManager,((t,e)=>{if(e){i.ascender=e.ascender,i.descender=e.descender;for(const t in e.glyphs)this._doesCharSupportLocalGlyph(+t)||(i.glyphs[+t]=e.glyphs[+t]);i.ranges[o]=!0}for(const n of s)n(t,e);delete i.requests[o]}))),s.push(((i,a)=>{i?n(i):a&&n(null,{stack:t,id:e,glyph:a.glyphs[e]||null})}))}),((t,e)=>{if(t)n(t);else if(e){const t={};for(const{stack:n,id:i,glyph:a}of e)void 0===t[n]&&(t[n]={}),void 0===t[n].glyphs&&(t[n].glyphs={}),t[n].glyphs[i]=a&&{id:a.id,bitmap:a.bitmap.clone(),metrics:a.metrics},t[n].ascender=this.entries[n].ascender,t[n].descender=this.entries[n].descender;n(null,t)}}))}_doesCharSupportLocalGlyph(t){return this.localGlyphMode!==Ig.none&&(this.localGlyphMode===Ig.all?!!this.localFontFamily:!!this.localFontFamily&&(Ts["CJK Unified Ideographs"](t)||Ts["Hangul Syllables"](t)||Ts.Hiragana(t)||Ts.Katakana(t)||Ts["CJK Symbols and Punctuation"](t)||Ts["CJK Unified Ideographs Extension A"](t)||Ts["CJK Unified Ideographs Extension B"](t)))}_tinySDF(t,e,n){const i=this.localFontFamily;if(!i||!this._doesCharSupportLocalGlyph(n))return;let a=t.tinySDF;if(!a){let n="400";/bold/i.test(e)?n="900":/medium/i.test(e)?n="500":/light/i.test(e)&&(n="200"),a=t.tinySDF=new Pg.TinySDF({fontFamily:i,fontWeight:n,fontSize:24*kg,buffer:3*kg,radius:8*kg}),a.fontWeight=n}if(this.localGlyphs[a.fontWeight][n])return this.localGlyphs[a.fontWeight][n];const r=String.fromCodePoint(n),{data:o,width:s,height:l,glyphWidth:c,glyphHeight:u,glyphLeft:h,glyphTop:d,glyphAdvance:p}=a.draw(r);return this.localGlyphs[a.fontWeight][n]={id:n,bitmap:new ud({width:s,height:l},o),metrics:{width:c/kg,height:u/kg,left:h/kg,top:d/kg-27,advance:p/kg,localGlyph:!0}}}}Pg.loadGlyphRange=function(t,e,n,i,a){const r=256*e,o=r+255,s=i.transformRequest(i.normalizeGlyphsURL(n).replace("{fontstack}",t).replace("{range}",`${r}-${o}`),Qn.Glyphs);ni(s,((t,e)=>{if(t)a(t);else if(e){const t={},n=function(t){return new Im(t).readFields(Zm,{})}(e);for(const e of n.glyphs)t[e.id]=e;a(null,{glyphs:t,ascender:n.ascender,descender:n.descender})}}))},Pg.TinySDF=class{constructor({fontSize:t=24,buffer:e=3,radius:n=8,cutoff:i=.25,fontFamily:a="sans-serif",fontWeight:r="normal",fontStyle:o="normal"}={}){this.buffer=e,this.cutoff=i,this.radius=n;const s=this.size=t+4*e,l=this._createCanvas(s),c=this.ctx=l.getContext("2d",{willReadFrequently:!0});c.font=`${o} ${r} ${t}px ${a}`,c.textBaseline="alphabetic",c.textAlign="left",c.fillStyle="black",this.gridOuter=new Float64Array(s*s),this.gridInner=new Float64Array(s*s),this.f=new Float64Array(s),this.z=new Float64Array(s+1),this.v=new Uint16Array(s)}_createCanvas(t){const e=document.createElement("canvas");return e.width=e.height=t,e}draw(t){const{width:e,actualBoundingBoxAscent:n,actualBoundingBoxDescent:i,actualBoundingBoxLeft:a,actualBoundingBoxRight:r}=this.ctx.measureText(t),o=Math.ceil(n),s=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(r-a))),l=Math.min(this.size-this.buffer,o+Math.ceil(i)),c=s+2*this.buffer,u=l+2*this.buffer,h=Math.max(c*u,0),d=new Uint8ClampedArray(h),p={data:d,width:c,height:u,glyphWidth:s,glyphHeight:l,glyphTop:o,glyphLeft:0,glyphAdvance:e};if(0===s||0===l)return p;const{ctx:f,buffer:m,gridInner:g,gridOuter:_}=this;f.clearRect(m,m,s,l),f.fillText(t,m,m+o);const y=f.getImageData(m,m,s,l);_.fill(Tg,0,h),g.fill(0,0,h);for(let t=0;t<l;t++)for(let e=0;e<s;e++){const n=y.data[4*(t*s+e)+3]/255;if(0===n)continue;const i=(t+m)*c+e+m;if(1===n)_[i]=0,g[i]=Tg;else{const t=.5-n;_[i]=t>0?t*t:0,g[i]=t<0?t*t:0}}Sg(_,0,0,c,u,c,this.f,this.v,this.z),Sg(g,m,m,s,l,c,this.f,this.v,this.z);for(let t=0;t<h;t++){const e=Math.sqrt(_[t])-Math.sqrt(g[t]);d[t]=Math.round(255-255*(e/this.radius+this.cutoff))}return p}};const zg=Ag;function Dg(t,e,n,i){const a=[],r=t.imagePrimary,o=r.pixelRatio,s=r.paddedRect.w-2*zg,l=r.paddedRect.h-2*zg,c=t.right-t.left,u=t.bottom-t.top,h=r.stretchX||[[0,s]],d=r.stretchY||[[0,l]],p=(t,e)=>t+e[1]-e[0],f=h.reduce(p,0),m=d.reduce(p,0),g=s-f,_=l-m;let y=0,x=f,v=0,b=m,w=0,A=g,C=0,E=_;if(r.content&&i){const t=r.content;y=Lg(h,0,t[0]),v=Lg(d,0,t[1]),x=Lg(h,t[0],t[2]),b=Lg(d,t[1],t[3]),w=t[0]-y,C=t[1]-v,A=t[2]-t[0]-x,E=t[3]-t[1]-b}const T=(i,a,s,l)=>{const h=Og(i.stretch-y,x,c,t.left),d=Rg(i.fixed-w,A,i.stretch,f),p=Og(a.stretch-v,b,u,t.top),g=Rg(a.fixed-C,E,a.stretch,m),_=Og(s.stretch-y,x,c,t.left),T=Rg(s.fixed-w,A,s.stretch,f),S=Og(l.stretch-v,b,u,t.top),M=Rg(l.fixed-C,E,l.stretch,m),k=new Ve(h,p),I=new Ve(_,p),P=new Ve(_,S),z=new Ve(h,S),D=new Ve(d/o,g/o),L=new Ve(T/o,M/o),B=e*Math.PI/180;if(B){const t=Math.sin(B),e=Math.cos(B),n=[e,-t,t,e];k._matMult(n),I._matMult(n),z._matMult(n),P._matMult(n)}const O=i.stretch+i.fixed,R=s.stretch+s.fixed,F=a.stretch+a.fixed,N=l.stretch+l.fixed,j=t.imageSecondary;return{tl:k,tr:I,bl:z,br:P,texPrimary:{x:r.paddedRect.x+zg+O,y:r.paddedRect.y+zg+F,w:R-O,h:N-F},texSecondary:j?{x:j.paddedRect.x+zg+O,y:j.paddedRect.y+zg+F,w:R-O,h:N-F}:void 0,writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:D,pixelOffsetBR:L,minFontScaleX:A/o/c,minFontScaleY:E/o/u,isSDF:n}};if(i&&(r.stretchX||r.stretchY)){const t=Bg(h,g,f),e=Bg(d,_,m);for(let n=0;n<t.length-1;n++){const i=t[n],r=t[n+1];for(let t=0;t<e.length-1;t++)a.push(T(i,e[t],r,e[t+1]))}}else a.push(T({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:s+1},{fixed:0,stretch:l+1}));return a}function Lg(t,e,n){let i=0;for(const a of t)i+=Math.max(e,Math.min(n,a[1]))-Math.max(e,Math.min(n,a[0]));return i}function Bg(t,e,n){const i=[{fixed:-zg,stretch:0}];for(const[e,n]of t){const t=i[i.length-1];i.push({fixed:e-t.stretch,stretch:t.stretch}),i.push({fixed:e-t.stretch,stretch:t.stretch+(n-e)})}return i.push({fixed:e+zg,stretch:n}),i}function Og(t,e,n,i){return t/e*n+i}function Rg(t,e,n,i){return t-e*n/i}function Fg(t,e,n,i){const a=e+t.positionedLines[i].lineOffset;return 0===i?n+a/2:n+(a+(e+t.positionedLines[i-1].lineOffset))/2}function Ng(t,e=1,n=!1){let i=1/0,a=1/0,r=-1/0,o=-1/0;const s=t[0];for(let t=0;t<s.length;t++){const e=s[t];(!t||e.x<i)&&(i=e.x),(!t||e.y<a)&&(a=e.y),(!t||e.x>r)&&(r=e.x),(!t||e.y>o)&&(o=e.y)}const l=Math.min(r-i,o-a);let c=l/2;const u=new cr([],jg);if(0===l)return new Ve(i,a);for(let e=i;e<r;e+=l)for(let n=a;n<o;n+=l)u.push(new Vg(e+c,n+c,c,t));let h=function(t){let e=0,n=0,i=0;const a=t[0];for(let t=0,r=a.length,o=r-1;t<r;o=t++){const r=a[t],s=a[o],l=r.x*s.y-s.x*r.y;n+=(r.x+s.x)*l,i+=(r.y+s.y)*l,e+=3*l}return new Vg(n/e,i/e,0,t)}(t),d=u.length;for(;u.length;){const i=u.pop();(i.d>h.d||!h.d)&&(h=i,n&&console.log("found best %d after %d probes",Math.round(1e4*i.d)/1e4,d)),i.max-h.d<=e||(c=i.h/2,u.push(new Vg(i.p.x-c,i.p.y-c,c,t)),u.push(new Vg(i.p.x+c,i.p.y-c,c,t)),u.push(new Vg(i.p.x-c,i.p.y+c,c,t)),u.push(new Vg(i.p.x+c,i.p.y+c,c,t)),d+=4)}return n&&(console.log(`num probes: ${d}`),console.log(`best distance: ${h.d}`)),h.p}function jg(t,e){return e.max-t.max}class Vg{constructor(t,e,n,i){this.p=new Ve(t,e),this.h=n,this.d=function(t,e){let n=!1,i=1/0;for(let a=0;a<e.length;a++){const r=e[a];for(let e=0,a=r.length,o=a-1;e<a;o=e++){const a=r[e],s=r[o];a.y>t.y!=s.y>t.y&&t.x<(s.x-a.x)*(t.y-a.y)/(s.y-a.y)+a.x&&(n=!n),i=Math.min(i,nh(t,a,s))}}return(n?1:-1)*Math.sqrt(i)}(this.p,i),this.max=this.d+this.h*Math.SQRT2}}const Ug=Number.POSITIVE_INFINITY,Gg=Math.sqrt(2);function qg(t,[e,n]){let i=0,a=0;if(n===Ug){e<0&&(e=0);const n=e/Gg;switch(t){case"top-right":case"top-left":a=n-7;break;case"bottom-right":case"bottom-left":a=7-n;break;case"bottom":a=7-e;break;case"top":a=e-7}switch(t){case"top-right":case"bottom-right":i=-n;break;case"top-left":case"bottom-left":i=n;break;case"left":i=e;break;case"right":i=-e}}else{switch(e=Math.abs(e),n=Math.abs(n),t){case"top-right":case"top-left":case"top":a=n-7;break;case"bottom-right":case"bottom-left":case"bottom":a=7-n}switch(t){case"top-right":case"bottom-right":case"right":i=-e;break;case"top-left":case"bottom-left":case"left":i=e}}return[i,a]}function $g(t){switch(t){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Wg(t,e,n,i,a,r,o,s,l,c,u,h,d,p,f){let m=r.textMaxSize.evaluate(e,{},h);void 0===m&&(m=o);const g=t.layers[0].layout,_=g.get("icon-offset").evaluate(e,{},h),y=Xg(n.horizontal)||n.vertical,x="globe"===d.name,v=Rm,b=o/v,w=t.tilePixelRatio*m/v,A=(P=t.overscaling,t.zoom>18&&P>2&&(P>>=1),Math.max(ur/(512*P),1)*g.get("symbol-spacing")),C=g.get("text-padding")*t.tilePixelRatio,E=g.get("icon-padding")*t.tilePixelRatio,T=qe(g.get("text-max-angle")),S="map"===g.get("text-rotation-alignment")&&"point"!==g.get("symbol-placement"),M="map"===g.get("icon-rotation-alignment")&&"point"!==g.get("symbol-placement"),k=g.get("symbol-placement"),I=A/2;var P;const z=g.get("icon-text-fit").evaluate(e,{},h),D=g.get("icon-text-fit-padding").evaluate(e,{},h),L="none"!==z;let B;!1===t.hasAnyIconTextFit&&L&&(t.hasAnyIconTextFit=!0),i&&L&&(t.allowVerticalPlacement&&n.vertical&&(B=dg(i,n.vertical,z,D,_,b)),y&&(i=dg(i,y,z,D,_,b)));const O=(o,s,m)=>{if(s.x<0||s.x>=ur||s.y<0||s.y>=ur)return;let g=null;if(x){const{x:t,y:e,z:n}=d.projectTilePoint(s.x,s.y,m);g={anchor:new pg(t,e,n,0,void 0),up:d.upVector(m,s.x,s.y)}}!function(t,e,n,i,a,r,o,s,l,c,u,h,d,p,f,m,g,_,y,x,v,b,w,A,C,E,T){const S=t.addToLineVertexArray(e,i);let M,k,I,P,z,D,L,B=0,O=0,R=0,F=0,N=-1,j=-1;const V={};let U=Ii("");const G=n?n.anchor:e,q="none"!==l.layout.get("icon-text-fit").evaluate(v,{},C);let $=0,W=0;if(void 0===l._unevaluatedLayout.getValue("text-radial-offset")?[$,W]=l.layout.get("text-offset").evaluate(v,{},C).map((t=>t*Rm)):($=l.layout.get("text-radial-offset").evaluate(v,{},C)*Rm,W=Ug),t.allowVerticalPlacement&&a.vertical){const t=a.vertical;if(f)D=Qg(t),s&&(L=Qg(s));else{const n=l.layout.get("text-rotate").evaluate(v,{},C)+90;I=Kg(c,G,e,u,h,d,t,p,n,m),s&&(P=Kg(c,G,e,u,h,d,s,_,n))}}if(r){const i=l.layout.get("icon-rotate").evaluate(v,{},C),a=Dg(r,i,w,q),o=s?Dg(s,i,w,q):void 0;k=Kg(c,G,e,u,h,d,r,_,i),B=4*a.length;const p=t.iconSizeData;let f=null;"source"===p.kind?(f=[Fm*l.layout.get("icon-size").evaluate(v,{},C)],f[0]>Zg&&fn(`${t.layerIds[0]}: Value for "icon-size" is >= ${Hg}. Reduce your "icon-size".`)):"composite"===p.kind&&(f=[Fm*b.compositeIconSizes[0].evaluate(v,{},C),Fm*b.compositeIconSizes[1].evaluate(v,{},C)],(f[0]>Zg||f[1]>Zg)&&fn(`${t.layerIds[0]}: Value for "icon-size" is >= ${Hg}. Reduce your "icon-size".`)),t.addSymbols(t.icon,a,f,x,y,v,!1,n,e,S.lineStartIndex,S.lineLength,-1,A,C,E,T),N=t.icon.placedSymbolArray.length-1,o&&(O=4*o.length,t.addSymbols(t.icon,o,f,x,y,v,Qm.vertical,n,e,S.lineStartIndex,S.lineLength,-1,A,C,E,T),j=t.icon.placedSymbolArray.length-1)}for(const i in a.horizontal){const r=a.horizontal[i];M||(U=Ii(r.text),f?z=Qg(r):M=Kg(c,G,e,u,h,d,r,p,l.layout.get("text-rotate").evaluate(v,{},C),m));const s=1===r.positionedLines.length;if(R+=Yg(t,n,e,r,o,l,f,v,m,S,a.vertical?Qm.horizontal:Qm.horizontalOnly,s?Object.keys(a.horizontal):[i],V,N,b,A,C,E),s)break}a.vertical&&(F+=Yg(t,n,e,a.vertical,o,l,f,v,m,S,Qm.vertical,["vertical"],V,j,b,A,C,E));let H=-1;const Z=(t,e)=>t?Math.max(t,e):e;H=Z(z,H),H=Z(D,H),H=Z(L,H);const Y=H>-1?1:0;t.glyphOffsetArray.length>=65535&&fn("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==v.sortKey&&t.addToSortKeyRanges(t.symbolInstances.length,v.sortKey),t.symbolInstances.emplaceBack(e.x,e.y,G.x,G.y,G.z,V.right>=0?V.right:-1,V.center>=0?V.center:-1,V.left>=0?V.left:-1,V.vertical>=0?V.vertical:-1,N,j,U,void 0!==M?M:t.collisionBoxArray.length,void 0!==M?M+1:t.collisionBoxArray.length,void 0!==I?I:t.collisionBoxArray.length,void 0!==I?I+1:t.collisionBoxArray.length,void 0!==k?k:t.collisionBoxArray.length,void 0!==k?k+1:t.collisionBoxArray.length,P||t.collisionBoxArray.length,P?P+1:t.collisionBoxArray.length,u,R,F,B,O,Y,0,$,W,H,0,1,1,q?1:0)}(t,s,g,o,n,i,a,B,t.layers[0],t.collisionBoxArray,e.index,e.sourceLayerIndex,t.index,C,S,l,0,E,M,_,e,r,c,u,h,p,f)};if("line"===k)for(const a of bg(e.geometry,0,0,ur,ur)){const e=xg(a,A,T,n.vertical||y,i,v,w,t.overscaling,ur);for(const n of e)y&&Jg(t,y.text,I,n)||O(a,n,h)}else if("line-center"===k){for(const t of e.geometry)if(t.length>1){const e=yg(t,T,n.vertical||y,i,v,w);e&&O(t,e,h)}}else if("Polygon"===e.type)for(const t of $d(e.geometry,0)){const e=Ng(t,16);O(t[0],new pg(e.x,e.y,0,0,void 0),h)}else if("LineString"===e.type)for(const t of e.geometry)O(t,new pg(t[0].x,t[0].y,0,0,void 0),h);else if("Point"===e.type)for(const t of e.geometry)for(const e of t)O([e],new pg(e.x,e.y,0,0,void 0),h)}const Hg=255,Zg=Hg*Fm;function Yg(t,e,n,i,a,r,o,s,l,c,u,h,d,p,f,m,g,_){const y=function(t,e,n,i,a,r,o,s){const l=[];if(0===e.positionedLines.length)return l;const c=i.layout.get("text-rotate").evaluate(r,{})*Math.PI/180,u=function(t){const e=t[0],n=t[1],i=e*n;return i>0?[e,-n]:i<0?[-e,n]:0===e?[n,e]:[n,-e]}(n);let h=Math.abs(e.top-e.bottom);for(const t of e.positionedLines)h-=t.lineOffset;const d=e.positionedLines.length,p=h/d;let f=e.top-n[1];for(let t=0;t<d;++t){const i=e.positionedLines[t];f=Fg(e,p,f,t);for(const t of i.positionedGlyphs){if(!t.rect)continue;const i=t.rect||{};let r=Km+1,h=!0,d=1,p=0;if(t.imageName){const e=o[t.imageName];if(!e)continue;if(e.sdf){fn("SDF images are not supported in formatted text and will be ignored.");continue}h=!1,d=e.pixelRatio,r=Ag/d}const m=(a||s)&&t.vertical,g=t.metrics.advance*t.scale/2,_=t.metrics,y=t.rect;if(null===y)continue;s&&e.verticalizable&&(p=t.imageName?g-t.metrics.width*t.scale/2:0);const x=a?[t.x+g,t.y]:[0,0];let v=[0,0],b=[0,0],w=!1;a||(m?(b=[t.x+g+u[0],t.y+u[1]-p],w=!0):v=[t.x+g+n[0],t.y+n[1]-p]);const A=y.w*t.scale/(d*(t.localGlyph?kg:1)),C=y.h*t.scale/(d*(t.localGlyph?kg:1));let E,T,S,M;if(m){const e=t.y-f,n=new Ve(-g,g-e),i=-Math.PI/2,a=new Ve(...b);E=new Ve(-g+v[0],v[1]),E._rotateAround(i,n)._add(a),E.x+=-e+g,E.y-=(_.left-r)*t.scale;const o=t.imageName?_.advance*t.scale:Rm*t.scale,s=String.fromCodePoint(t.glyph);$m(s)?E.x+=(1-r)*t.scale:Wm(s)?E.x+=o-_.height*t.scale+(-r-1)*t.scale:E.x+=t.imageName||_.width+2*r===y.w&&_.height+2*r===y.h?(o-C)/2:(o-(_.height+2*r)*t.scale)/2,T=new Ve(E.x,E.y-A),S=new Ve(E.x+C,E.y),M=new Ve(E.x+C,E.y-A)}else{const e=(_.left-r)*t.scale-g+v[0],n=(-_.top-r)*t.scale+v[1],i=e+A,a=n+C;E=new Ve(e,n),T=new Ve(i,n),S=new Ve(e,a),M=new Ve(i,a)}if(c){let t;t=a?new Ve(0,0):w?new Ve(u[0],u[1]):new Ve(n[0],n[1]),E._rotateAround(c,t),T._rotateAround(c,t),S._rotateAround(c,t),M._rotateAround(c,t)}const k=new Ve(0,0),I=new Ve(0,0);l.push({tl:E,tr:T,bl:S,br:M,texPrimary:i,texSecondary:void 0,writingMode:e.writingMode,glyphOffset:x,sectionIndex:t.sectionIndex,isSDF:h,pixelOffsetTL:k,pixelOffsetBR:I,minFontScaleX:0,minFontScaleY:0})}}return l}(0,i,l,r,o,s,a,t.allowVerticalPlacement),x=t.textSizeData;let v=null;"source"===x.kind?(v=[Fm*r.layout.get("text-size").evaluate(s,{},g)],v[0]>Zg&&fn(`${t.layerIds[0]}: Value for "text-size" is >= ${Hg}. Reduce your "text-size".`)):"composite"===x.kind&&(v=[Fm*f.compositeTextSizes[0].evaluate(s,{},g),Fm*f.compositeTextSizes[1].evaluate(s,{},g)],(v[0]>Zg||v[1]>Zg)&&fn(`${t.layerIds[0]}: Value for "text-size" is >= ${Hg}. Reduce your "text-size".`)),t.addSymbols(t.text,y,v,l,o,s,u,e,n,c.lineStartIndex,c.lineLength,p,m,g,_,!1);for(const e of h)d[e]=t.text.placedSymbolArray.length-1;return 4*y.length}function Xg(t){for(const e in t)return t[e];return null}function Kg(t,e,n,i,a,r,o,s,l,c){let u=o.top,h=o.bottom,d=o.left,p=o.right;const f=o.collisionPadding;if(f&&(d-=f[0],u-=f[1],p+=f[2],h+=f[3]),l){const t=new Ve(d,u),e=new Ve(p,u),n=new Ve(d,h),i=new Ve(p,h),a=qe(l);let r=new Ve(0,0);c&&(r=new Ve(c[0],c[1])),t._rotateAround(a,r),e._rotateAround(a,r),n._rotateAround(a,r),i._rotateAround(a,r),d=Math.min(t.x,e.x,n.x,i.x),p=Math.max(t.x,e.x,n.x,i.x),u=Math.min(t.y,e.y,n.y,i.y),h=Math.max(t.y,e.y,n.y,i.y)}return t.emplaceBack(e.x,e.y,e.z,n.x,n.y,d,u,p,h,s,i,a,r),t.length-1}function Qg(t){t.collisionPadding&&(t.top-=t.collisionPadding[1],t.bottom+=t.collisionPadding[3]);const e=t.bottom-t.top;return e>0?Math.max(10,e):null}function Jg(t,e,n,i){const a=t.compareText;if(e in a){const t=a[e];for(let e=t.length-1;e>=0;e--)if(i.dist(t[e])<n)return!0}else a[e]=[];return a[e].push(i),!1}function t_(t,e){const n=t.fovAboveCenter,i=t.elevation?t.elevation.getMinElevationBelowMSL()*e:0,a=(t._camera.position[2]*t.worldSize-i)/Math.cos(t._pitch),r=Math.sin(n)*a/Math.sin(Math.max(Math.PI/2-t._pitch-n,.01)),o=Math.sin(t._pitch)*r+a;return Math.min(1.01*o,a*(1/t._horizonShift))}function e_(t,e){if(!e.isReprojectedInTileSpace)return{scale:1<<t.z,x:t.x,y:t.y,x2:t.x+1,y2:t.y+1,projection:e};const n=Math.pow(2,-t.z),i=t.x*n,a=(t.x+1)*n,r=t.y*n,o=(t.y+1)*n,s=Mu(i),l=Mu(a),c=ku(r),u=ku(o),h=e.project(s,c),d=e.project(l,c),p=e.project(l,u),f=e.project(s,u);let m=Math.min(h.x,d.x,p.x,f.x),g=Math.min(h.y,d.y,p.y,f.y),_=Math.max(h.x,d.x,p.x,f.x),y=Math.max(h.y,d.y,p.y,f.y);const x=n/16;function v(t,n,i,a,r,o){const s=(i+r)/2,l=(a+o)/2,c=e.project(Mu(s),ku(l)),u=Math.max(0,m-c.x,g-c.y,c.x-_,c.y-y);m=Math.min(m,c.x),_=Math.max(_,c.x),g=Math.min(g,c.y),y=Math.max(y,c.y),u>x&&(v(t,c,i,a,s,l),v(c,n,s,l,r,o))}v(h,d,i,r,a,r),v(d,p,a,r,a,o),v(p,f,a,o,i,o),v(f,h,i,o,i,r),m-=x,g-=x,_+=x,y+=x;const b=1/Math.max(_-m,y-g);return{scale:b,x:m*b,y:g*b,x2:_*b,y2:y*b,projection:e}}function n_(t,{x:e,y:n},i=0){return new Ve(((e-i)*t.scale-t.x)*ur,(n*t.scale-t.y)*ur)}const i_=t.ad.identity(new Float32Array(16));class a_{constructor(t){this.spec=t,this.name=t.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(t,e){return{x:0,y:0,z:0}}unproject(t,e){return new pu(0,0)}projectTilePoint(t,e,n){return{x:t,y:e,z:0}}locationPoint(t,e,n=!0){return t._coordinatePoint(t.locationCoordinate(e),n)}pixelsPerMeter(t,e){return Su(1,t)*e}pixelSpaceConversion(t,e,n){return 1}farthestPixelDistance(t){return t_(t,t.pixelsPerMeter)}pointCoordinate(t,e,n,i){const a=t.horizonLineFromTop(!1),r=new Ve(e,Math.max(a,n));return t.rayIntersectionCoordinate(t.pointRayIntersection(r,i))}pointCoordinate3D(t,e,n){const i=new Ve(e,n);if(t.elevation)return t.elevation.pointCoordinate(i);{const e=this.pointCoordinate(t,i.x,i.y,0);return[e.x,e.y,e.z]}}isPointAboveHorizon(t,e){if(t.elevation&&t.elevation.visibleDemTiles.length)return!this.pointCoordinate3D(t,e.x,e.y);const n=t.horizonLineFromTop();return e.y<n}createInversionMatrix(t,e){return i_}createTileMatrix(e,n,i){let a,r,o;const s=i.canonical,l=t.ad.identity(new Float64Array(16));if(this.isReprojectedInTileSpace){const c=e_(s,this);a=1,r=c.x+i.wrap*c.scale,o=c.y,t.ad.scale(l,l,[a/c.scale,a/c.scale,e.pixelsPerMeter/n])}else a=n/e.zoomScale(s.z),r=(s.x+Math.pow(2,s.z)*i.wrap)*a,o=s.y*a;return t.ad.translate(l,l,[r,o,0]),t.ad.scale(l,l,[a/ur,a/ur,1]),l}upVector(t,e,n){return[0,0,1]}upVectorScale(t,e,n){return{metersToTile:1}}}class r_ extends a_{constructor(t){super(t),this.range=[4,7],this.center=t.center||[-96,37.5];const[e,n]=this.parallels=t.parallels||[29.5,45.5],i=Math.sin(qe(e));this.n=(i+Math.sin(qe(n)))/2,this.c=1+i*(2*this.n-i),this.r0=Math.sqrt(this.c)/this.n}project(t,e){const{n,c:i,r0:a}=this,r=qe(t-this.center[0]),o=qe(e),s=Math.sqrt(i-2*n*Math.sin(o))/n;return{x:s*Math.sin(r*n),y:s*Math.cos(r*n)-a,z:0}}unproject(t,e){const{n,c:i,r0:a}=this,r=a+e;let o=Math.atan2(t,Math.abs(r))*Math.sign(r);r*n<0&&(o-=Math.PI*Math.sign(t)*Math.sign(r));const s=qe(this.center[0])*n;o=Qe(o,-Math.PI-s,Math.PI-s);const l=Xe($e(o/n)+this.center[0],-180,180),c=Math.asin(Xe((i-(t*t+r*r)*n*n)/(2*n),-1,1)),u=Xe($e(c),-Pu,Pu);return new pu(l,u)}}const o_=1.340264,s_=-.081106,l_=893e-6,c_=.003796,u_=Math.sqrt(3)/2;class h_ extends a_{project(t,e){e=e/180*Math.PI,t=t/180*Math.PI;const n=Math.asin(u_*Math.sin(e)),i=n*n,a=i*i*i;return{x:.5*(t*Math.cos(n)/(u_*(o_+3*s_*i+a*(7*l_+9*c_*i)))/Math.PI+.5),y:1-.5*(n*(o_+s_*i+a*(l_+c_*i))/Math.PI+1),z:0}}unproject(t,e){t=(2*t-.5)*Math.PI;let n=e=(2*(1-e)-1)*Math.PI,i=n*n,a=i*i*i;for(let t,r,o,s=0;s<12&&(r=n*(o_+s_*i+a*(l_+c_*i))-e,o=o_+3*s_*i+a*(7*l_+9*c_*i),t=r/o,n=Xe(n-t,-Math.PI/3,Math.PI/3),i=n*n,a=i*i*i,!(Math.abs(t)<1e-12));++s);const r=u_*t*(o_+3*s_*i+a*(7*l_+9*c_*i))/Math.cos(n),o=Math.asin(Math.sin(n)/u_),s=Xe(180*r/Math.PI,-180,180),l=Xe(180*o/Math.PI,-Pu,Pu);return new pu(s,l)}}class d_ extends a_{constructor(t){super(t),this.wrap=!0,this.supportsWorldCopies=!0}project(t,e){return{x:.5+t/360,y:.5-e/360,z:0}}unproject(t,e){const n=360*(t-.5),i=Xe(360*(.5-e),-Pu,Pu);return new pu(n,i)}}const p_=Math.PI/2;function f_(t){return Math.tan((p_+t)/2)}class m_ extends a_{constructor(t){super(t),this.center=t.center||[0,30];const[e,n]=this.parallels=t.parallels||[30,30];let i=qe(e),a=qe(n);this.southernCenter=i+a<0,this.southernCenter&&(i=-i,a=-a);const r=Math.cos(i),o=f_(i);this.n=i===a?Math.sin(i):Math.log(r/Math.cos(a))/Math.log(f_(a)/o),this.f=r*Math.pow(f_(i),this.n)/this.n}project(t,e){e=qe(e),this.southernCenter&&(e=-e),t=qe(t-this.center[0]);const n=1e-6,{n:i,f:a}=this;a>0?e<-p_+n&&(e=-p_+n):e>p_-n&&(e=p_-n);const r=a/Math.pow(f_(e),i);let o=r*Math.sin(i*t),s=a-r*Math.cos(i*t);return o=.5*(o/Math.PI+.5),s=.5*(s/Math.PI+.5),{x:o,y:this.southernCenter?s:1-s,z:0}}unproject(t,e){t=(2*t-.5)*Math.PI,this.southernCenter&&(e=1-e),e=(2*(1-e)-.5)*Math.PI;const{n,f:i}=this,a=i-e,r=Math.sign(a),o=Math.sign(n)*Math.sqrt(t*t+a*a);let s=Math.atan2(t,Math.abs(a))*r;a*n<0&&(s-=Math.PI*Math.sign(t)*r);const l=Xe($e(s/n)+this.center[0],-180,180),c=Xe($e(2*Math.atan(Math.pow(i/o,1/n))-p_),-Pu,Pu);return new pu(l,this.southernCenter?-c:c)}}class g_ extends a_{constructor(t){super(t),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(t,e){return{x:Eu(t),y:Tu(e),z:0}}unproject(t,e){const n=Mu(t),i=ku(e);return new pu(n,i)}}const __=qe(Pu);class y_ extends a_{project(t,e){const n=(e=qe(e))*e,i=n*n;return{x:.5*((t=qe(t))*(.8707-.131979*n+i*(i*(.003971*n-.001529*i)-.013791))/Math.PI+.5),y:1-.5*(e*(1.007226+n*(.015085+i*(.028874*n-.044475-.005916*i)))/Math.PI+1),z:0}}unproject(t,e){t=(2*t-.5)*Math.PI;let n=e=(2*(1-e)-1)*Math.PI,i=25,a=0,r=n*n;do{r=n*n;const t=r*r;a=(n*(1.007226+r*(.015085+t*(.028874*r-.044475-.005916*t)))-e)/(1.007226+r*(.045255+t*(.259866*r-.311325-.005916*11*t))),n=Xe(n-a,-__,__)}while(Math.abs(a)>1e-6&&--i>0);r=n*n;const o=Xe($e(t/(.8707+r*(r*(r*r*r*(.003971-.001529*r)-.013791)-.131979))),-180,180),s=$e(n);return new pu(o,s)}}const x_=qe(Pu);class v_ extends a_{project(t,e){e=qe(e),t=qe(t);const n=Math.cos(e),i=2/Math.PI,a=Math.acos(n*Math.cos(t/2)),r=Math.sin(a)/a,o=.5*(t*i+2*n*Math.sin(t/2)/r)||0,s=.5*(e+Math.sin(e)/r)||0;return{x:.5*(o/Math.PI+.5),y:1-.5*(s/Math.PI+1),z:0}}unproject(t,e){let n=t=(2*t-.5)*Math.PI,i=e=(2*(1-e)-1)*Math.PI,a=25;const r=1e-6;let o=0,s=0;do{const a=Math.cos(i),r=Math.sin(i),l=2*r*a,c=r*r,u=a*a,h=Math.cos(n/2),d=Math.sin(n/2),p=2*h*d,f=d*d,m=1-u*h*h,g=m?1/m:0,_=m?Math.acos(a*h)*Math.sqrt(1/m):0,y=.5*(2*_*a*d+2*n/Math.PI)-t,x=.5*(_*r+i)-e,v=.5*g*(u*f+_*a*h*c)+1/Math.PI,b=g*(p*l/4-_*r*d),w=.125*g*(l*d-_*r*u*p),A=.5*g*(c*h+_*f*a)+.5,C=b*w-A*v;o=(x*b-y*A)/C,s=(y*w-x*v)/C,n=Xe(n-o,-Math.PI,Math.PI),i=Xe(i-s,-x_,x_)}while((Math.abs(o)>r||Math.abs(s)>r)&&--a>0);return new pu($e(n),$e(i))}}class b_ extends a_{constructor(t){super(t),this.center=t.center||[0,0],this.parallels=t.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(qe(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(t,e){const{scale:n,cosPhi:i}=this;return{x:qe(t)*i*n+.5,y:-Math.sin(qe(e))/i*n+.5,z:0}}unproject(t,e){const{scale:n,cosPhi:i}=this,a=-(e-.5)/n,r=Xe($e((t-.5)/n)/i,-180,180),o=Math.asin(Xe(a*i,-1,1)),s=Xe($e(o),-Pu,Pu);return new pu(r,s)}}class w_ extends g_{constructor(t){super(t),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(e,n,i){const a=Nh(e,n,i),r=Uh(zh(i));return t._.transformMat4(a,a,r),{x:a[0],y:a[1],z:a[2]}}locationPoint(e,n){const i=uu(n.lat,n.lng),a=t._.normalize([],i),r=e.elevation?e.elevation.getAtPointOrZero(e.locationCoordinate(n),e._centerAltitude):e._centerAltitude,o=Su(1,0)*ur*r;t._.scaleAndAdd(i,i,a,o);const s=t.ad.identity(new Float64Array(16));return t.ad.multiply(s,e.pixelMatrix,e.globeMatrix),t._.transformMat4(i,i,s),new Ve(i[0],i[1])}pixelsPerMeter(t,e){return Su(1,0)*e}pixelSpaceConversion(t,e,n){const i=Su(1,t)*e,a=Gi(Su(1,45)*e,i,n);return this.pixelsPerMeter(t,e)/a}createTileMatrix(e,n,i){const a=Gh(zh(i.canonical));return t.ad.multiply(new Float64Array(16),e.globeMatrix,a)}createInversionMatrix(e,n){const{center:i}=e,a=Uh(zh(n));return t.ad.rotateY(a,a,qe(i.lng)),t.ad.rotateX(a,a,qe(i.lat)),t.ad.scale(a,a,[e._pixelsPerMercatorPixel,e._pixelsPerMercatorPixel,1]),Float32Array.from(a)}pointCoordinate(t,e,n,i){return kh(t,e,n,!0)||new Ou(0,0)}pointCoordinate3D(t,e,n){const i=this.pointCoordinate(t,e,n,0);return[i.x,i.y,i.z]}isPointAboveHorizon(t,e){return!kh(t,e.x,e.y,!1)}farthestPixelDistance(e){const n=function(e,n){const i=e.cameraToCenterDistance,a=e._centerAltitude*n,r=e._camera,o=e._camera.forward(),s=t._.add([],t._.scale([],o,-i),[0,0,a]),l=e.worldSize/(2*Math.PI),c=[0,0,-l],u=e.width/e.height,h=Math.tan(e.fovAboveCenter),d=t._.scale([],r.up(),h),p=t._.scale([],r.right(),h*u),f=t._.normalize([],t._.add([],t._.add([],o,d),p)),m=[];let g;if(new mh(s,f).closestPointOnSphere(c,l,m)){const n=t._.add([],m,c),i=t._.sub([],n,s);g=Math.cos(e.fovAboveCenter)*t._.length(i)}else{const e=t._.sub([],s,c),n=t._.sub([],c,s);t._.normalize(n,n);const i=t._.length(e)-l;g=Math.sqrt(i*(i+2*l));const a=Math.acos(g/(l+i))-Math.acos(t._.dot(o,n));g*=Math.cos(a)}return 1.01*g}(e,this.pixelsPerMeter(e.center.lat,e.worldSize)),i=Hh(e.zoom);if(i>0){const t=t_(e,Su(1,e.center.lat)*e.worldSize),a=e.worldSize/(2*Math.PI),r=Math.max(e.width,e.height)/e.worldSize*Math.PI;return Gi(n,t+a*(1-Math.cos(r)),Math.pow(i,10))}return n}upVector(t,e,n){return Nh(e,n,t,1)}upVectorScale(t){return{metersToTile:Sh(jh(zh(t)))}}}function A_(t){const e=t.parallels,n=!!e&&Math.abs(e[0]+e[1])<.01;switch(t.name){case"mercator":return new g_(t);case"equirectangular":return new d_(t);case"naturalEarth":return new y_(t);case"equalEarth":return new h_(t);case"winkelTripel":return new v_(t);case"albers":return n?new b_(t):new r_(t);case"lambertConformalConic":return n?new b_(t):new m_(t);case"globe":return new w_(t)}throw new Error(`Invalid projection name: ${t.name}`)}class C_{constructor(t,e,n,i){this.id=C_.uniqueIdxCounter,C_.uniqueIdxCounter++,this.context=t;const a=t.gl;this.buffer=a.createBuffer(),this.dynamicDraw=Boolean(n),this.context.unbindVAO(),t.bindElementBuffer.set(this.buffer),a.bufferData(a.ELEMENT_ARRAY_BUFFER,e.arrayBuffer,this.dynamicDraw?a.DYNAMIC_DRAW:a.STATIC_DRAW),this.dynamicDraw||i||e.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(t){this.id=C_.uniqueIdxCounter,C_.uniqueIdxCounter++;const e=this.context.gl;this.context.unbindVAO(),this.bind(),e.bufferSubData(e.ELEMENT_ARRAY_BUFFER,0,t.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}C_.uniqueIdxCounter=0;class E_{constructor(t,e,n){this.func=t,this.mask=e,this.range=n}}E_.ReadOnly=!1,E_.ReadWrite=!0,E_.disabled=new E_(519,E_.ReadOnly,[0,1]);const T_=7680;class S_{constructor(t,e,n,i,a,r){this.test=t,this.ref=e,this.mask=n,this.fail=i,this.depthFail=a,this.pass=r}}S_.disabled=new S_({func:519,mask:0},0,0,T_,T_,T_);const M_=771;class k_{constructor(t,e,n,i){this.blendFunction=t,this.blendColor=e,this.mask=n,this.blendEquation=i}}k_.Replace=[1,0,1,0],k_.disabled=new k_(k_.Replace,Vi.transparent,[!1,!1,!1,!1]),k_.unblended=new k_(k_.Replace,Vi.transparent,[!0,!0,!0,!0]),k_.alphaBlended=new k_([1,M_,1,M_],Vi.transparent,[!0,!0,!0,!0]),k_.alphaBlendedNonPremultiplied=new k_([770,M_,770,M_],Vi.transparent,[!0,!0,!0,!0]),k_.multiply=new k_([774,0,774,0],Vi.transparent,[!0,!0,!0,!0]);const I_=1029,P_=2305;class z_{constructor(t,e,n){this.enable=t,this.mode=e,this.frontFace=n}}z_.disabled=new z_(!1,I_,P_),z_.backCCW=new z_(!0,I_,P_),z_.backCW=new z_(!0,I_,2304),z_.frontCW=new z_(!0,1028,2304),z_.frontCCW=new z_(!0,1028,P_);const D_=wp.types,L_=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function B_(t,e,n,i,a,r,o,s,l,c,u,h,d){const p=s?Math.min(Zg,Math.round(s[0])):0,f=s?Math.min(Zg,Math.round(s[1])):0;t.emplaceBack(e,n,Math.round(32*i),Math.round(32*a),r,o,(p<<1)+(l?1:0),f,16*c,16*u,256*h,256*d)}function O_(t,e,n){t.emplaceBack(e,n)}function R_(t,e,n,i,a,r,o){t.emplaceBack(e,n,i,a,r,o)}function F_(t,e,n,i,a){t.emplaceBack(e,n,i,a),t.emplaceBack(e,n,i,a),t.emplaceBack(e,n,i,a),t.emplaceBack(e,n,i,a)}function N_(t){for(const e of t.sections)if(Ls(e.text))return!0;return!1}class j_{constructor(t){this.layoutVertexArray=new Ul,this.indexArray=new Kl,this.programConfigurations=t,this.segments=new wc,this.dynamicLayoutVertexArray=new Rl,this.opacityVertexArray=new ql,this.occlusionQueryOpacityVertexArray=new $l,this.placedSymbolArray=new dc,this.iconTransitioningVertexArray=new Wl,this.globeExtVertexArray=new Gl,this.zOffsetVertexArray=new $l}isEmpty(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length&&0===this.iconTransitioningVertexArray.length}upload(t,e,n,i,a){this.isEmpty()||(n&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Ff.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,e),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,jf.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,L_,!0),this.occlusionQueryOpacityVertexBuffer=t.createVertexBuffer(this.occlusionQueryOpacityVertexArray,Vf.members,!0),this.iconTransitioningVertexArray.length>0&&(this.iconTransitioningVertexBuffer=t.createVertexBuffer(this.iconTransitioningVertexArray,Gf.members,!0)),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=t.createVertexBuffer(this.globeExtVertexArray,Nf.members,!0)),!this.zOffsetVertexBuffer&&(this.zOffsetVertexArray.length>0||a)&&(this.zOffsetVertexBuffer=t.createVertexBuffer(this.zOffsetVertexArray,Uf.members,!0)),this.opacityVertexBuffer.itemSize=1),(n||i)&&this.programConfigurations.upload(t))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.occlusionQueryOpacityVertexBuffer.destroy(),this.iconTransitioningVertexBuffer&&this.iconTransitioningVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy(),this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy())}}bs(j_,"SymbolBuffers");class V_{constructor(t,e,n){this.layoutVertexArray=new t,this.layoutAttributes=e,this.indexArray=new n,this.segments=new wc,this.collisionVertexArray=new Xl,this.collisionVertexArrayExt=new Rl}upload(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,qf.members,!0),this.collisionVertexBufferExt=t.createVertexBuffer(this.collisionVertexArrayExt,$f.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}bs(V_,"CollisionBuffers");class U_{constructor(e){this.queries=new Map,this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.lut=e.lut,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((t=>t.fqid)),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.hasAnyIconTextFit=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=t.ad.identity([]),this.placementViewportMatrix=t.ad.identity([]);const n=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Nm(this.zoom,n["text-size"]),this.iconSizeData=Nm(this.zoom,n["icon-size"]);const i=this.layers[0].layout,a=i.get("symbol-sort-key"),r=i.get("symbol-z-order");this.canOverlap=i.get("text-allow-overlap")||i.get("icon-allow-overlap")||i.get("text-ignore-placement")||i.get("icon-ignore-placement"),this.sortFeaturesByKey="viewport-y"!==r&&void 0!==a.constantOr(1),this.sortFeaturesByY=("viewport-y"===r||"auto"===r&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=i.get("text-writing-mode").map((t=>Qm[t])),this.stateDependentLayerIds=this.layers.filter((t=>t.isStateDependent())).map((t=>t.id)),this.sourceID=e.sourceID,this.projection=e.projection,this.hasAnyZOffset=!1,this.zOffsetSortDirty=!1,this.zOffsetBuffersNeedUpload=i.get("symbol-z-elevate"),this.activeReplacements=[],this.replacementUpdateTime=0}createArrays(){this.text=new j_(new Yc(this.layers,{zoom:this.zoom,lut:this.lut},(t=>/^text/.test(t)))),this.icon=new j_(new Yc(this.layers,{zoom:this.zoom,lut:this.lut},(t=>/^icon/.test(t)))),this.glyphOffsetArray=new mc,this.lineVertexArray=new gc,this.symbolInstances=new fc}calculateGlyphDependencies(t,e,n,i,a){for(let n=0;n<t.length;n++){const r=t.codePointAt(n);if(void 0===r)break;if(e[r]=!0,i&&a&&r<=65535){const i=qm[t.charAt(n)];i&&(e[i.charCodeAt(0)]=!0)}}}updateFootprints(t,e){}updateReplacement(t,e){if(e.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=e.updateTime;const n=e.getReplacementRegionsForTile(t.toUnwrapped(),!0);return!Pp(this.activeReplacements,n)&&(this.activeReplacements=n,!0)}populate(e,n,i,a){const r=this.layers[0],o=r.layout,s="globe"===this.projection.name,l=o.get("text-font"),c=o.get("text-field"),u=o.get("icon-image"),h=("constant"!==c.value.kind||c.value.value instanceof pa&&!c.value.value.isEmpty()||c.value.value.toString().length>0)&&("constant"!==l.value.kind||l.value.value.length>0),d="constant"!==u.value.kind||!!u.value.value||Object.keys(u.parameters).length>0,p=o.get("symbol-sort-key");if(this.features=[],!h&&!d)return;const f=n.iconDependencies,m=n.glyphDependencies,g=n.availableImages,_=new Hs(this.zoom);for(const{feature:n,id:c,index:u,sourceLayerIndex:y}of e){const e=r._featureFilter.needGeometry,x=$u(n,e);if(!r._featureFilter.filter(_,x,i))continue;if(e||(x.geometry=qu(n,i,a)),s&&1!==n.type&&i.z<=5){const e=x.geometry,n=.98078528056,a=(e,a)=>{const r=Nh(e.x,e.y,i,1),o=Nh(a.x,a.y,i,1);return t._.dot(r,o)<n};for(let t=0;t<e.length;t++)e[t]=ju(e[t],a)}let v,b;if(h){const t=r.getValueAndResolveTokens("text-field",x,i,g),e=pa.factory(t);N_(e)&&(this.hasRTLText=!0),(!this.hasRTLText||"unavailable"===qs()||this.hasRTLText&&Ws.isParsed())&&(v=Gm(e,r,x))}if(d){const t=r.getValueAndResolveTokens("icon-image",x,i,g);b=t instanceof fa?t:fa.fromString(t)}if(!v&&!b)continue;const w=this.sortFeaturesByKey?p.evaluate(x,{},i):void 0;if(this.features.push({id:c,text:v,icon:b,index:u,sourceLayerIndex:y,geometry:x.geometry,properties:n.properties,type:D_[n.type],sortKey:w}),b&&(f[b.namePrimary]=!0,b.nameSecondary&&(f[b.nameSecondary]=!0)),v){const t=l.evaluate(x,{},i).join(","),e="map"===o.get("text-rotation-alignment")&&"point"!==o.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Qm.vertical)>=0;for(const n of v.sections)if(n.image)f[n.image.namePrimary]=!0;else{const i=Ss(v.toString()),a=n.fontStack||t,r=m[a]=m[a]||{};this.calculateGlyphDependencies(n.text,r,e,this.allowVerticalPlacement,i)}}}"line"===o.get("symbol-placement")&&(this.features=function(t){const e={},n={},i=[];let a=0;function r(e){i.push(t[e]),a++}function o(t,e,a){const r=n[t];return delete n[t],n[e]=r,i[r].geometry[0].pop(),i[r].geometry[0]=i[r].geometry[0].concat(a[0]),r}function s(t,n,a){const r=e[n];return delete e[n],e[t]=r,i[r].geometry[0].shift(),i[r].geometry[0]=a[0].concat(i[r].geometry[0]),r}function l(t,e,n){const i=n?e[0][e[0].length-1]:e[0][0];return`${t}:${i.x}:${i.y}`}for(let c=0;c<t.length;c++){const u=t[c],h=u.geometry,d=u.text?u.text.toString():null;if(!d){r(c);continue}const p=l(d,h),f=l(d,h,!0);if(p in n&&f in e&&n[p]!==e[f]){const t=s(p,f,h),a=o(p,f,i[t].geometry);delete e[p],delete n[f],n[l(d,i[a].geometry,!0)]=a,i[t].geometry=null}else p in n?o(p,f,h):f in e?s(p,f,h):(r(c),e[p]=a-1,n[f]=a-1)}return i.filter((t=>t.geometry))}(this.features)),this.sortFeaturesByKey&&this.features.sort(((t,e)=>t.sortKey-e.sortKey))}update(t,e,n,i,a){const r=0!==Object.keys(t).length;if(r&&!this.stateDependentLayers.length)return;const o=r?this.stateDependentLayers:this.layers;this.text.programConfigurations.updatePaintArrays(t,e,o,n,i,a),this.icon.programConfigurations.updatePaintArrays(t,e,o,n,i,a)}updateOcclusionOpacities(t,e,n){if(!e.useOcclusionQueries)return!1;const i=this;if("globe"===i.projection.name)return!1;let a=!1;i.hasTextData()&&(a=a||0!==i.text.occlusionQueryOpacityVertexArray.length),i.hasIconData()&&(a=a||0!==i.icon.occlusionQueryOpacityVertexArray.length);const r=i.layers[0].paint,o=r.get("icon-occlusion-opacity").constantOr(0),s=r.get("text-occlusion-opacity").constantOr(0);if(!i.layers[0].hasInitialOcclusionOpacityProperties||1===o&&1===s)return!1;let l=!a;for(let t=0;t<i.symbolInstances.length;t++){const a=i.symbolInstances.get(t),r=a.occlusionOpacity;a.occlusionOpacity+=(a.occlusionState>.5?1:-1)*e.fadeSpeed*n*.001,a.occlusionOpacity=Xe(a.occlusionOpacity,0,1),l=l||a.occlusionOpacity!==r}if(!l)return!1;let c=0,u=0;const h=(t,e,n,i)=>{let a=0,r=0;n?(a=u,u+=i,r=u):(a=c,c+=i,r=c),r>e.occlusionQueryOpacityVertexArray.length&&e.occlusionQueryOpacityVertexArray.resize(r);const o=t.occlusionOpacity;for(let t=0;t<i;t++)e.occlusionQueryOpacityVertexArray.emplace(t+a,o)};for(let t=0;t<i.symbolInstances.length;t++){const e=i.symbolInstances.get(t),{numHorizontalGlyphVertices:n,numVerticalGlyphVertices:a,numIconVertices:r}=e,o=r>0;if((n>0||a>0)&&(h(e,i.text,!1,n),h(e,i.text,!1,a)),o){const{placedIconSymbolIndex:t,verticalPlacedIconSymbolIndex:n}=e;t>=0&&h(e,i.icon,!0,r),n>=0&&h(e,i.icon,!0,e.numVerticalIconVertices)}}return i.hasTextData()&&i.text.occlusionQueryOpacityVertexBuffer&&(i.text.occlusionQueryOpacityVertexBuffer.length<i.text.occlusionQueryOpacityVertexArray.length?i.text.occlusionQueryOpacityVertexBuffer=t.createVertexBuffer(i.text.occlusionQueryOpacityVertexArray,Vf.members,!0):i.text.occlusionQueryOpacityVertexBuffer.updateData(i.text.occlusionQueryOpacityVertexArray)),i.hasIconData()&&i.icon.occlusionQueryOpacityVertexBuffer&&(i.icon.occlusionQueryOpacityVertexBuffer.length<i.icon.occlusionQueryOpacityVertexArray.length?i.icon.occlusionQueryOpacityVertexBuffer=t.createVertexBuffer(i.icon.occlusionQueryOpacityVertexArray,Vf.members,!0):i.icon.occlusionQueryOpacityVertexBuffer.updateData(i.icon.occlusionQueryOpacityVertexArray)),!0}updateZOffset(){const t=(t,e,i)=>{n+=e,n>t.length&&t.resize(n);for(let a=-e;a<0;a++)t.emplace(a+n,i)},e=(t,e,n)=>{i+=e,i>t.length&&t.resize(i);for(let a=-e;a<0;a++)t.emplace(a+i,n)};if(!this.zOffsetBuffersNeedUpload)return;this.zOffsetBuffersNeedUpload=!1;let n=0,i=0;for(let n=0;n<this.symbolInstances.length;n++){const i=this.symbolInstances.get(n),{numHorizontalGlyphVertices:a,numVerticalGlyphVertices:r,numIconVertices:o}=i,s=i.zOffset,l=o>0;if((a>0||r>0)&&(t(this.text.zOffsetVertexArray,a,s),t(this.text.zOffsetVertexArray,r,s)),l){const{placedIconSymbolIndex:t,verticalPlacedIconSymbolIndex:n}=i;t>=0&&e(this.icon.zOffsetVertexArray,o,s),n>=0&&e(this.icon.zOffsetVertexArray,i.numVerticalIconVertices,s)}}this.text.zOffsetVertexBuffer&&this.text.zOffsetVertexBuffer.updateData(this.text.zOffsetVertexArray),this.icon.zOffsetVertexBuffer&&this.icon.zOffsetVertexBuffer.updateData(this.icon.zOffsetVertexArray)}isEmpty(){return 0===this.symbolInstances.length&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(t){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(t),this.iconCollisionBox.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=A_(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData();for(const t of this.queries.values())t.destroy()}addToLineVertexArray(t,e){const n=this.lineVertexArray.length;if(void 0!==t.segment)for(const{x:t,y:n}of e)this.lineVertexArray.emplaceBack(t,n);return{lineStartIndex:n,lineLength:this.lineVertexArray.length-n}}addSymbols(t,e,n,i,a,r,o,s,l,c,u,h,d,p,f,m){const g=t.indexArray,_=t.layoutVertexArray,y=t.globeExtVertexArray,x=t.segments.prepareSegment(4*e.length,_,g,this.canOverlap?r.sortKey:void 0),v=this.glyphOffsetArray.length,b=x.vertexLength,w=this.allowVerticalPlacement&&o===Qm.vertical?Math.PI/2:0,A=r.text&&r.text.sections;for(let i=0;i<e.length;i++){const{tl:a,tr:o,bl:c,br:u,texPrimary:h,texSecondary:v,pixelOffsetTL:b,pixelOffsetBR:C,minFontScaleX:E,minFontScaleY:T,glyphOffset:S,isSDF:M,sectionIndex:k}=e[i],I=x.vertexLength,P=S[1];if(B_(_,l.x,l.y,a.x,P+a.y,h.x,h.y,n,M,b.x,b.y,E,T),B_(_,l.x,l.y,o.x,P+o.y,h.x+h.w,h.y,n,M,C.x,b.y,E,T),B_(_,l.x,l.y,c.x,P+c.y,h.x,h.y+h.h,n,M,b.x,C.y,E,T),B_(_,l.x,l.y,u.x,P+u.y,h.x+h.w,h.y+h.h,n,M,C.x,C.y,E,T),s){const{x:e,y:n,z:i}=s.anchor,[a,r,o]=s.up;R_(y,e,n,i,a,r,o),R_(y,e,n,i,a,r,o),R_(y,e,n,i,a,r,o),R_(y,e,n,i,a,r,o),F_(t.dynamicLayoutVertexArray,e,n,i,w)}else F_(t.dynamicLayoutVertexArray,l.x,l.y,l.z,w);if(m){const e=v||h;O_(t.iconTransitioningVertexArray,e.x,e.y),O_(t.iconTransitioningVertexArray,e.x+e.w,e.y),O_(t.iconTransitioningVertexArray,e.x,e.y+e.h),O_(t.iconTransitioningVertexArray,e.x+e.w,e.y+e.h)}g.emplaceBack(I,I+1,I+2),g.emplaceBack(I+1,I+2,I+3),x.vertexLength+=4,x.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(S[0]),i!==e.length-1&&k===e[i+1].sectionIndex||t.programConfigurations.populatePaintArrays(_.length,r,r.index,{},d,p,f,A&&A[k])}const C=s?s.anchor:l;t.placedSymbolArray.emplaceBack(C.x,C.y,C.z,l.x,l.y,v,this.glyphOffsetArray.length-v,b,c,u,l.segment,n?n[0]:0,n?n[1]:0,i[0],i[1],o,0,!1,0,h,0)}_commitLayoutVertex(t,e,n,i,a,r,o){t.emplaceBack(e,n,i,a,r,Math.round(o.x),Math.round(o.y))}_addCollisionDebugVertices(t,e,n,i,a,r,o){const s=n.segments.prepareSegment(4,n.layoutVertexArray,n.indexArray),l=s.vertexLength,c=o.tileAnchorX,u=o.tileAnchorY;for(let t=0;t<4;t++)n.collisionVertexArray.emplaceBack(0,0,0,0);this._commitDebugCollisionVertexUpdate(n.collisionVertexArrayExt,e,t.padding,o.zOffset),this._commitLayoutVertex(n.layoutVertexArray,i,a,r,c,u,new Ve(t.x1,t.y1)),this._commitLayoutVertex(n.layoutVertexArray,i,a,r,c,u,new Ve(t.x2,t.y1)),this._commitLayoutVertex(n.layoutVertexArray,i,a,r,c,u,new Ve(t.x2,t.y2)),this._commitLayoutVertex(n.layoutVertexArray,i,a,r,c,u,new Ve(t.x1,t.y2)),s.vertexLength+=4;const h=n.indexArray;h.emplaceBack(l,l+1),h.emplaceBack(l+1,l+2),h.emplaceBack(l+2,l+3),h.emplaceBack(l+3,l),s.primitiveLength+=4}_addTextDebugCollisionBoxes(t,e,n,i,a,r){for(let o=i;o<a;o++){const i=n.get(o),a=this.getSymbolInstanceTextSize(t,r,e,o);this._addCollisionDebugVertices(i,a,this.textCollisionBox,i.projectedAnchorX,i.projectedAnchorY,i.projectedAnchorZ,r)}}_addIconDebugCollisionBoxes(t,e,n,i,a,r){for(let o=i;o<a;o++){const i=n.get(o),a=this.getSymbolInstanceIconSize(t,e,r.placedIconSymbolIndex);this._addCollisionDebugVertices(i,a,this.iconCollisionBox,i.projectedAnchorX,i.projectedAnchorY,i.projectedAnchorZ,r)}}generateCollisionDebugBuffers(t,e){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new V_(Zl,Wf.members,Wl),this.iconCollisionBox=new V_(Zl,Wf.members,Wl);const n=Vm(this.iconSizeData,t),i=Vm(this.textSizeData,t);for(let a=0;a<this.symbolInstances.length;a++){const r=this.symbolInstances.get(a);this._addTextDebugCollisionBoxes(i,t,e,r.textBoxStartIndex,r.textBoxEndIndex,r),this._addTextDebugCollisionBoxes(i,t,e,r.verticalTextBoxStartIndex,r.verticalTextBoxEndIndex,r),this._addIconDebugCollisionBoxes(n,t,e,r.iconBoxStartIndex,r.iconBoxEndIndex,r),this._addIconDebugCollisionBoxes(n,t,e,r.verticalIconBoxStartIndex,r.verticalIconBoxEndIndex,r)}}getSymbolInstanceTextSize(t,e,n,i){const a=this.text.placedSymbolArray.get(e.rightJustifiedTextSymbolIndex>=0?e.rightJustifiedTextSymbolIndex:e.centerJustifiedTextSymbolIndex>=0?e.centerJustifiedTextSymbolIndex:e.leftJustifiedTextSymbolIndex>=0?e.leftJustifiedTextSymbolIndex:e.verticalPlacedTextSymbolIndex>=0?e.verticalPlacedTextSymbolIndex:i),r=jm(this.textSizeData,t,a)/Rm;return this.tilePixelRatio*r}getSymbolInstanceIconSize(t,e,n){const i=this.icon.placedSymbolArray.get(n),a=jm(this.iconSizeData,t,i);return this.tilePixelRatio*a}_commitDebugCollisionVertexUpdate(t,e,n,i){t.emplaceBack(e,-n,-n,i),t.emplaceBack(e,n,-n,i),t.emplaceBack(e,n,n,i),t.emplaceBack(e,-n,n,i)}_updateTextDebugCollisionBoxes(t,e,n,i,a,r){for(let o=i;o<a;o++){const i=n.get(o),a=this.getSymbolInstanceTextSize(t,r,e,o);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,a,i.padding,r.zOffset)}}_updateIconDebugCollisionBoxes(t,e,n,i,a,r){for(let o=i;o<a;o++){const i=n.get(o),a=this.getSymbolInstanceIconSize(t,e,r.placedIconSymbolIndex);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,a,i.padding,r.zOffset)}}updateCollisionDebugBuffers(t,e){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const n=Vm(this.iconSizeData,t),i=Vm(this.textSizeData,t);for(let a=0;a<this.symbolInstances.length;a++){const r=this.symbolInstances.get(a);this._updateTextDebugCollisionBoxes(i,t,e,r.textBoxStartIndex,r.textBoxEndIndex,r),this._updateTextDebugCollisionBoxes(i,t,e,r.verticalTextBoxStartIndex,r.verticalTextBoxEndIndex,r),this._updateIconDebugCollisionBoxes(n,t,e,r.iconBoxStartIndex,r.iconBoxEndIndex,r),this._updateIconDebugCollisionBoxes(n,t,e,r.verticalIconBoxStartIndex,r.verticalIconBoxEndIndex,r)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(t,e,n,i,a,r,o,s,l){const c={};if(e<n){const{x1:n,y1:i,x2:a,y2:r,padding:o,projectedAnchorX:s,projectedAnchorY:l,projectedAnchorZ:u,tileAnchorX:h,tileAnchorY:d,featureIndex:p}=t.get(e);c.textBox={x1:n,y1:i,x2:a,y2:r,padding:o,projectedAnchorX:s,projectedAnchorY:l,projectedAnchorZ:u,tileAnchorX:h,tileAnchorY:d},c.textFeatureIndex=p}if(i<a){const{x1:e,y1:n,x2:a,y2:r,padding:o,projectedAnchorX:s,projectedAnchorY:l,projectedAnchorZ:u,tileAnchorX:h,tileAnchorY:d,featureIndex:p}=t.get(i);c.verticalTextBox={x1:e,y1:n,x2:a,y2:r,padding:o,projectedAnchorX:s,projectedAnchorY:l,projectedAnchorZ:u,tileAnchorX:h,tileAnchorY:d},c.verticalTextFeatureIndex=p}if(r<o){const{x1:e,y1:n,x2:i,y2:a,padding:o,projectedAnchorX:s,projectedAnchorY:l,projectedAnchorZ:u,tileAnchorX:h,tileAnchorY:d,featureIndex:p}=t.get(r);c.iconBox={x1:e,y1:n,x2:i,y2:a,padding:o,projectedAnchorX:s,projectedAnchorY:l,projectedAnchorZ:u,tileAnchorX:h,tileAnchorY:d},c.iconFeatureIndex=p}if(s<l){const{x1:e,y1:n,x2:i,y2:a,padding:r,projectedAnchorX:o,projectedAnchorY:l,projectedAnchorZ:u,tileAnchorX:h,tileAnchorY:d,featureIndex:p}=t.get(s);c.verticalIconBox={x1:e,y1:n,x2:i,y2:a,padding:r,projectedAnchorX:o,projectedAnchorY:l,projectedAnchorZ:u,tileAnchorX:h,tileAnchorY:d},c.verticalIconFeatureIndex=p}return c}deserializeCollisionBoxes(t){this.collisionArrays=[];for(let e=0;e<this.symbolInstances.length;e++){const n=this.symbolInstances.get(e);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,n.textBoxStartIndex,n.textBoxEndIndex,n.verticalTextBoxStartIndex,n.verticalTextBoxEndIndex,n.iconBoxStartIndex,n.iconBoxEndIndex,n.verticalIconBoxStartIndex,n.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}hasIconTextFit(){return this.hasAnyIconTextFit}addIndicesForPlacedSymbol(t,e){const n=t.placedSymbolArray.get(e),i=n.vertexStartIndex+4*n.numGlyphs;for(let e=n.vertexStartIndex;e<i;e+=4)t.indexArray.emplaceBack(e,e+1,e+2),t.indexArray.emplaceBack(e+1,e+2,e+3)}getSortedSymbolIndexes(t){if(this.sortedAngle===t&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;const e=Math.sin(t),n=Math.cos(t),i=[],a=[],r=[];for(let t=0;t<this.symbolInstances.length;++t){r.push(t);const o=this.symbolInstances.get(t);i.push(0|Math.round(e*o.tileAnchorX+n*o.tileAnchorY)),a.push(o.featureIndex)}return r.sort(((t,e)=>i[t]-i[e]||a[e]-a[t])),r}getSortedIndexesByZOffset(){if(!this.zOffsetSortDirty)return this.symbolInstanceIndexesSortedZOffset;if(!this.symbolInstanceIndexesSortedZOffset){this.symbolInstanceIndexesSortedZOffset=[];for(let t=0;t<this.symbolInstances.length;++t)this.symbolInstanceIndexesSortedZOffset.push(t)}return this.zOffsetSortDirty=!1,this.symbolInstanceIndexesSortedZOffset.sort(((t,e)=>this.symbolInstances.get(e).zOffset-this.symbolInstances.get(t).zOffset))}addToSortKeyRanges(t,e){const n=this.sortKeyRanges[this.sortKeyRanges.length-1];n&&n.sortKey===e?n.symbolInstanceEnd=t+1:this.sortKeyRanges.push({sortKey:e,symbolInstanceStart:t,symbolInstanceEnd:t+1})}sortFeatures(t){if(this.sortFeaturesByY&&this.sortedAngle!==t&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(t),this.sortedAngle=t,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const t of this.symbolInstanceIndexes){const e=this.symbolInstances.get(t);this.featureSortOrder.push(e.featureIndex);const{rightJustifiedTextSymbolIndex:n,centerJustifiedTextSymbolIndex:i,leftJustifiedTextSymbolIndex:a,verticalPlacedTextSymbolIndex:r,placedIconSymbolIndex:o,verticalPlacedIconSymbolIndex:s}=e;n>=0&&this.addIndicesForPlacedSymbol(this.text,n),i>=0&&i!==n&&this.addIndicesForPlacedSymbol(this.text,i),a>=0&&a!==i&&a!==n&&this.addIndicesForPlacedSymbol(this.text,a),r>=0&&this.addIndicesForPlacedSymbol(this.text,r),o>=0&&this.addIndicesForPlacedSymbol(this.icon,o),s>=0&&this.addIndicesForPlacedSymbol(this.icon,s)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}bs(U_,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),U_.addDynamicAttributes=F_;class G_{constructor(t,e,n,i){this.context=t,this.format=n,this.texture=t.gl.createTexture(),this.update(e,i)}update(t,e,n){const{width:i,height:a}=t,{context:r}=this,{gl:o}=r;if(o.bindTexture(o.TEXTURE_2D,this.texture),r.pixelStoreUnpackFlipY.set(!1),r.pixelStoreUnpack.set(1),r.pixelStoreUnpackPremultiplyAlpha.set(this.format===o.RGBA&&(!e||!1!==e.premultiply)),n||this.size&&this.size[0]===i&&this.size[1]===a){const{x:e,y:r}=n||{x:0,y:0};if(t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement||t instanceof ImageData||ImageBitmap&&t instanceof ImageBitmap)o.texSubImage2D(o.TEXTURE_2D,0,e,r,o.RGBA,o.UNSIGNED_BYTE,t);else{let n=this.format,s=o.UNSIGNED_BYTE;this.format===o.R32F&&(n=o.RED,s=o.FLOAT),o.texSubImage2D(o.TEXTURE_2D,0,e,r,i,a,n,s,t.data)}}else if(this.size=[i,a],t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement||t instanceof ImageData||ImageBitmap&&t instanceof ImageBitmap){let e=this.format;this.format===o.R8&&(e=o.RED),o.texImage2D(o.TEXTURE_2D,0,this.format,e,o.UNSIGNED_BYTE,t)}else{let e=this.format,n=this.format,r=o.UNSIGNED_BYTE;this.format===o.DEPTH_COMPONENT&&(e=o.DEPTH_COMPONENT16,r=o.UNSIGNED_SHORT),this.format===o.R8&&(n=o.RED),this.format===o.R32F&&(r=o.FLOAT,n=o.RED),o.texImage2D(o.TEXTURE_2D,0,e,i,a,0,n,r,t.data)}this.useMipmap=Boolean(e&&e.useMipmap),this.useMipmap&&o.generateMipmap(o.TEXTURE_2D)}bind(t,e,n=!1){const{context:i}=this,{gl:a}=i;a.bindTexture(a.TEXTURE_2D,this.texture),t!==this.minFilter&&(a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,t),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,this.useMipmap&&!n?t===a.NEAREST?a.NEAREST_MIPMAP_NEAREST:a.LINEAR_MIPMAP_LINEAR:t),this.minFilter=t),e!==this.wrapS&&(a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,e),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,e),this.wrapS=e)}bindExtraParam(t,e,n,i){const{context:a}=this,{gl:r}=a;r.bindTexture(r.TEXTURE_2D,this.texture),e!==this.magFilter&&(r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,e),this.magFilter=e),t!==this.minFilter&&(r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,this.useMipmap?t===r.NEAREST?r.NEAREST_MIPMAP_NEAREST:r.LINEAR_MIPMAP_LINEAR:t),this.minFilter=t),n!==this.wrapS&&(r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,n),this.wrapS=n),i!==this.wrapT&&(r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,i),this.wrapT=i)}destroy(){const{gl:t}=this.context;t.deleteTexture(this.texture),this.texture=null}}class q_{constructor(t,e){this.context=t,this.texture=e}bind(t,e){const{context:n}=this,{gl:i}=n;i.bindTexture(i.TEXTURE_2D,this.texture),t!==this.minFilter&&(i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,t),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,t),this.minFilter=t),e!==this.wrapS&&(i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,e),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,e),this.wrapS=e)}}const $_=32,W_=33,H_=new Uint16Array(8184);for(let t=0;t<2046;t++){let e=t+2,n=0,i=0,a=0,r=0,o=0,s=0;for(1&e?a=r=o=$_:n=i=s=$_;(e>>=1)>1;){const t=n+a>>1,l=i+r>>1;1&e?(a=n,r=i,n=o,i=s):(n=a,i=r,a=o,r=s),o=t,s=l}const l=4*t;H_[l+0]=n,H_[l+1]=i,H_[l+2]=a,H_[l+3]=r}const Z_=new Uint16Array(2178),Y_=new Uint8Array(1089),X_=new Uint16Array(1089);function K_(t){return 0===t?-.03125:32===t?.03125:0}var Q_=Il([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),J_=Il([{name:"a_index",type:"Int16",components:1}]);const ty={type:2,extent:ur,loadGeometry:()=>[[new Ve(0,0),new Ve(ur+1,0),new Ve(ur+1,ur+1),new Ve(0,ur+1),new Ve(0,0)]]};class ey{constructor(t,e,n,i,a){this.tileID=t,this.uid=an(),this.uses=0,this.tileSize=e,this.tileZoom=n,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=a,i&&i.style&&(this._lastUpdatedBrightness=i.style.getBrightness()),this.expiredRequestCount=0,this.state="loading",i&&i.transform&&(this.projection=i.transform.projection)}registerFadeDuration(t){const e=t+this.timeAdded;e<Ln.now()||this.fadeEndTime&&e<this.fadeEndTime||(this.fadeEndTime=e)}wasRequested(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state}get tileTransform(){return this._tileTransform||(this._tileTransform=e_(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(t,e,n){if(this.unloadVectorData(),this.state="loaded",t){t.featureIndex&&(this.latestFeatureIndex=t.featureIndex,t.rawTileData?(this.latestRawTileData=t.rawTileData,this.latestFeatureIndex.rawTileData=t.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=t.collisionBoxArray,this.buckets=function(t,e){const n={};if(!e)return n;for(const i of t){const t=i.layerIds.map((t=>e.getLayer(t))).filter(Boolean);if(0!==t.length){i.layers=t,i.stateDependentLayerIds&&(i.stateDependentLayers=i.stateDependentLayerIds.map((e=>t.filter((t=>t.id===e))[0])));for(const e of t)n[e.fqid]=i}}return n}(t.buckets,e.style),this.hasSymbolBuckets=!1;for(const t in this.buckets){const e=this.buckets[t];if(e instanceof U_){if(this.hasSymbolBuckets=!0,!n)break;e.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const t in this.buckets){const e=this.buckets[t];if(e instanceof U_&&e.hasRTLText){this.hasRTLText=!0,Ws.isLoading()||Ws.isLoaded()||"deferred"!==qs()||$s();break}}this.queryPadding=0;for(const t in this.buckets){const n=this.buckets[t],i=e.style.getOwnLayer(t);if(!i)continue;const a=i.queryRadius(n);this.queryPadding=Math.max(this.queryPadding,a)}t.imageAtlas&&(this.imageAtlas=t.imageAtlas),t.glyphAtlasImage&&(this.glyphAtlasImage=t.glyphAtlasImage),t.lineAtlas&&(this.lineAtlas=t.lineAtlas),this._lastUpdatedBrightness=t.brightness}else this.collisionBoxArray=new uc}unloadVectorData(){if(this.hasData()){for(const t in this.buckets)this.buckets[t].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(t){return this.buckets[t.fqid]}upload(t){for(const e in this.buckets){const n=this.buckets[e];n.uploadPending()&&n.upload(t)}const e=t.gl,n=this.imageAtlas;if(n&&!n.uploaded){const i=!!Object.keys(n.patternPositions).length;this.imageAtlasTexture=new G_(t,n.image,e.RGBA,{useMipmap:i}),this.imageAtlas.uploaded=!0}this.glyphAtlasImage&&(this.glyphAtlasTexture=new G_(t,this.glyphAtlasImage,e.R8),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new G_(t,this.lineAtlas.image,e.R8),this.lineAtlas.uploaded=!0)}prepare(t,e,n){if(this.imageAtlas&&this.imageAtlasTexture&&this.imageAtlas.patchUpdatedImages(t,this.imageAtlasTexture,n),!e||!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData)return;const i=e.style.getBrightness();(this._lastUpdatedBrightness||i)&&(this._lastUpdatedBrightness&&i&&Math.abs(this._lastUpdatedBrightness-i)<.001||(this._lastUpdatedBrightness=i,this.updateBuckets(void 0,e)))}queryRenderedFeatures(t,e,n,i,a,r,o,s){return this.latestFeatureIndex&&(this.latestFeatureIndex.rawTileData||this.latestFeatureIndex.is3DTile)?this.latestFeatureIndex.query({tileResult:i,pixelPosMatrix:o,transform:r,params:a,tileTransform:this.tileTransform},t,e,n):{}}querySourceFeatures(t,e){const n=this.latestFeatureIndex;if(!n||!n.rawTileData)return;const i=n.loadVTLayers(),a=e?e.sourceLayer:"",r=i._geojsonTileLayer||i[a];if(!r)return;const o=ul(e&&e.filter),{z:s,x:l,y:c}=this.tileID.canonical,u={z:s,x:l,y:c};for(let e=0;e<r.length;e++){const i=r.feature(e);if(o.needGeometry){const t=$u(i,!0);if(!o.filter(new Hs(this.tileID.overscaledZ),t,this.tileID.canonical))continue}else if(!o.filter(new Hs(this.tileID.overscaledZ),i))continue;const h=n.getId(i,a),d=new zm(i,s,l,c,h);d.tile=u,t.push(d)}}hasData(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state}bucketsLoaded(){for(const t in this.buckets)if(this.buckets[t].uploadPending())return!1;return!0}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(t){const e=this.expirationTime;if(t.cacheControl){const e=xn(t.cacheControl);e["max-age"]&&(this.expirationTime=Date.now()+1e3*e["max-age"])}else t.expires&&(this.expirationTime=new Date(t.expires).getTime());if(this.expirationTime){const t=Date.now();let n=!1;if(this.expirationTime>t)n=!1;else if(e)if(this.expirationTime<e)n=!0;else{const i=this.expirationTime-e;i?this.expirationTime=t+Math.max(i,3e4):n=!0}else n=!0;n?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)}setFeatureState(t,e){this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&0!==Object.keys(t).length&&e&&this.updateBuckets(t,e)}updateBuckets(t,e){if(!this.latestFeatureIndex)return;const n=this.latestFeatureIndex.loadVTLayers(),i=e.style.listImages(),a=e.style.getBrightness();for(const r in this.buckets){if(!e.style.hasLayer(r))continue;const o=this.buckets[r],s=o.layers[0].sourceLayer||"_geojsonTileLayer",l=n[s];let c={};if(t&&(c=t[s],!l||!c||0===Object.keys(c).length))continue;if(o.update(c,l,i,this.imageAtlas&&this.imageAtlas.patternPositions||{},a),o instanceof Qf||o instanceof Yd){const t=e.style.getOwnSourceCache(o.layers[0].source);e._terrain&&e._terrain.enabled&&t&&o.programConfigurations.needsUpload&&e._terrain._clearRenderCacheForTile(t.id,this.tileID)}const u=e&&e.style&&e.style.getOwnLayer(r);u&&(this.queryPadding=Math.max(this.queryPadding,u.queryRadius(o)))}}holdingForFade(){return void 0!==this.symbolFadeHoldUntil}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<Ln.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(t){this.symbolFadeHoldUntil=Ln.now()+t}setTexture(t,e){const n=e.context,i=n.gl;this.texture=this.texture||e.getTileTexture(t.width),this.texture&&this.texture instanceof G_?this.texture.update(t,{useMipmap:!0}):(this.texture=new G_(n,t,i.RGBA,{useMipmap:!0}),this.texture.bind(i.LINEAR,i.CLAMP_TO_EDGE))}setDependencies(t,e){const n={};for(const t of e)n[t]=!0;this.dependencies[t]=n}hasDependency(t,e){for(const n of t){const t=this.dependencies[n];if(t)for(const n of e)if(t[n])return!0}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(t,e){if(!e||"mercator"===e.name||this._tileDebugBuffer)return;const n=qu(ty,this.tileID.canonical,this.tileTransform)[0],i=new zl,a=new ac;for(let t=0;t<n.length;t++){const{x:e,y:r}=n[t];i.emplaceBack(e,r),a.emplaceBack(t)}a.emplaceBack(0),this._tileDebugIndexBuffer=t.createIndexBuffer(a),this._tileDebugBuffer=t.createVertexBuffer(i,Th.members),this._tileDebugSegments=wc.simpleSegment(0,0,i.length,a.length)}_makeTileBoundsBuffers(t,e){if(this._tileBoundsBuffer||!e||"mercator"===e.name)return;const n=qu(ty,this.tileID.canonical,this.tileTransform)[0];let i,a;if(this.isRaster){const t=function(t,e){const n=e_(t,e),i=Math.pow(2,t.z);for(let a=0;a<W_;a++)for(let r=0;r<W_;r++){const o=Mu((t.x+(r+K_(r))/$_)/i),s=ku((t.y+(a+K_(a))/$_)/i),l=e.project(o,s),c=a*W_+r;Z_[2*c+0]=Math.round((l.x*n.scale-n.x)*ur),Z_[2*c+1]=Math.round((l.y*n.scale-n.y)*ur)}Y_.fill(0),X_.fill(0);for(let t=2045;t>=0;t--){const e=4*t,n=H_[e+0],i=H_[e+1],a=H_[e+2],r=H_[e+3],o=n+a>>1,s=i+r>>1,l=o+s-i,c=s+n-o,u=i*W_+n,h=r*W_+a,d=s*W_+o,p=Math.hypot((Z_[2*u+0]+Z_[2*h+0])/2-Z_[2*d+0],(Z_[2*u+1]+Z_[2*h+1])/2-Z_[2*d+1])>=16;Y_[d]=Y_[d]||(p?1:0),t<1022&&(Y_[d]=Y_[d]||Y_[(i+c>>1)*W_+(n+l>>1)]||Y_[(r+c>>1)*W_+(a+l>>1)])}const a=new Ll,r=new Kl;let o=0;function s(t,e){const n=e*W_+t;return 0===X_[n]&&(a.emplaceBack(Z_[2*n+0],Z_[2*n+1],t*ur/$_,e*ur/$_),X_[n]=++o),X_[n]-1}function l(t,e,n,i,a,o){const c=t+n>>1,u=e+i>>1;if(Math.abs(t-a)+Math.abs(e-o)>1&&Y_[u*W_+c])l(a,o,t,e,c,u),l(n,i,a,o,c,u);else{const l=s(t,e),c=s(n,i),u=s(a,o);r.emplaceBack(l,c,u)}}return l(0,0,$_,$_,$_,0),l($_,$_,0,0,0,$_),{vertices:a,indices:r}}(this.tileID.canonical,e);i=t.vertices,a=t.indices}else{i=new Ll,a=new Kl;for(const{x:t,y:e}of n)i.emplaceBack(t,e,0,0);const t=vd(i.int16,void 0,4);for(let e=0;e<t.length;e+=3)a.emplaceBack(t[e],t[e+1],t[e+2])}this._tileBoundsBuffer=t.createVertexBuffer(i,Q_.members),this._tileBoundsIndexBuffer=t.createIndexBuffer(a),this._tileBoundsSegments=wc.simpleSegment(0,0,i.length,a.length)}_makeGlobeTileDebugBuffers(e,n){const i=n.projection;if(!i||"globe"!==i.name||n.freezeTileCoverage)return;const a=this.tileID.canonical,r=Uh(Lh(a,n)),o=Hh(n.zoom);let s;o>0&&(s=t.ad.invert(new Float64Array(16),n.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(e,a,n,r,s,o),this._makeGlobeTileDebugTextBuffer(e,a,n,r,s,o)}_globePoint(e,n,i,a,r,o,s){let l=Nh(e,n,i);if(o){const r=1<<i.z,c=Eu(a.center.lng),u=Tu(a.center.lat),h=(i.x+.5)/r-c;let d=0;h>.5?d=-1:h<-.5&&(d=1);let p=(e/ur+i.x)/r+d,f=(n/ur+i.y)/r;p=(p-c)*a._pixelsPerMercatorPixel+c,f=(f-u)*a._pixelsPerMercatorPixel+u;const m=[p*a.worldSize,f*a.worldSize,0];t._.transformMat4(m,m,o),l=Dh(l,m,s)}return t._.transformMat4(l,l,r)}_makeGlobeTileDebugBorderBuffer(t,e,n,i,a,r){const o=new zl,s=new ac,l=new Dl,c=(t,c,u,h,d)=>{const p=(u-t)/(d-1),f=(h-c)/(d-1),m=o.length;for(let u=0;u<d;u++){const h=t+u*p,d=c+u*f;o.emplaceBack(h,d);const g=this._globePoint(h,d,e,n,i,a,r);l.emplaceBack(g[0],g[1],g[2]),s.emplaceBack(m+u)}},u=ur;c(0,0,u,0,16),c(u,0,u,u,16),c(u,u,0,u,16),c(0,u,0,0,16),this._tileDebugIndexBuffer=t.createIndexBuffer(s),this._tileDebugBuffer=t.createVertexBuffer(o,Th.members),this._globeTileDebugBorderBuffer=t.createVertexBuffer(l,Eh.members),this._tileDebugSegments=wc.simpleSegment(0,0,o.length,s.length)}_makeGlobeTileDebugTextBuffer(t,e,n,i,a,r){const o=ur/4,s=new zl,l=new Kl,c=new Dl,u=25;l.reserve(32),s.reserve(u),c.reserve(u);const h=(t,e)=>u*t+e;for(let t=0;t<u;t++){const l=t*o;for(let t=0;t<u;t++){const u=t*o;s.emplaceBack(u,l);const h=this._globePoint(u,l,e,n,i,a,r);c.emplaceBack(h[0],h[1],h[2])}}for(let t=0;t<4;t++)for(let e=0;e<4;e++){const n=h(t,e),i=h(t,e+1),a=h(t+1,e),r=h(t+1,e+1);l.emplaceBack(n,i,a),l.emplaceBack(a,i,r)}this._tileDebugTextIndexBuffer=t.createIndexBuffer(l),this._tileDebugTextBuffer=t.createVertexBuffer(s,Th.members),this._globeTileDebugTextBuffer=t.createVertexBuffer(c,Eh.members),this._tileDebugTextSegments=wc.simpleSegment(0,0,u,32)}destroy(t=!1){for(const t in this.buckets)this.buckets[t].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&(this.imageAtlasTexture.destroy(),delete this.imageAtlasTexture),this.glyphAtlasTexture&&(this.glyphAtlasTexture.destroy(),delete this.glyphAtlasTexture),this.lineAtlasTexture&&(this.lineAtlasTexture.destroy(),delete this.lineAtlasTexture),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),!t&&this.texture&&this.texture instanceof G_&&(this.texture.destroy(),delete this.texture),this.hillshadeFBO&&(this.hillshadeFBO.destroy(),delete this.hillshadeFBO),this.dem&&delete this.dem,this.neighboringTiles&&delete this.neighboringTiles,this.demTexture&&(this.demTexture.destroy(),delete this.demTexture),this.rasterParticleState&&(this.rasterParticleState.destroy(),delete this.rasterParticleState),this.latestFeatureIndex=null,this.state="unloaded"}}const ny={read:function(t,e){return t.readFields(ny._readField,{header_length:0,x:0,y:0,z:0,layers:[]},e)},_readField:function(t,e,n){1===t?e.header_length=n.readFixed32():2===t?e.x=n.readVarint():3===t?e.y=n.readVarint():4===t?e.z=n.readVarint():5===t&&e.layers.push(ny.Layer.read(n,n.readVarint()+n.pos))},PixelFormat:{PIXEL_FORMAT_UNKNOWN:{value:0,options:{}},PIXEL_FORMAT_UINT32:{value:1,options:{}},PIXEL_FORMAT_UINT16:{value:2,options:{}},PIXEL_FORMAT_UINT8:{value:3,options:{}}},Filter:{}};ny.Filter.read=function(t,e){return t.readFields(ny.Filter._readField,{delta_filter:null,filter:null,zigzag_filter:null,bitshuffle_filter:null,byteshuffle_filter:null},e)},ny.Filter._readField=function(t,e,n){1===t?(e.delta_filter=ny.Filter.Delta.read(n,n.readVarint()+n.pos),e.filter="delta_filter"):2===t?(e.zigzag_filter=ny.Filter.Zigzag.read(n,n.readVarint()+n.pos),e.filter="zigzag_filter"):3===t?(e.bitshuffle_filter=ny.Filter.BitShuffle.read(n,n.readVarint()+n.pos),e.filter="bitshuffle_filter"):4===t&&(e.byteshuffle_filter=ny.Filter.ByteShuffle.read(n,n.readVarint()+n.pos),e.filter="byteshuffle_filter")},ny.Filter.Delta={},ny.Filter.Delta.read=function(t,e){return t.readFields(ny.Filter.Delta._readField,{block_size:0},e)},ny.Filter.Delta._readField=function(t,e,n){1===t&&(e.block_size=n.readVarint())},ny.Filter.Zigzag={},ny.Filter.Zigzag.read=function(t,e){return t.readFields(ny.Filter.Zigzag._readField,{},e)},ny.Filter.Zigzag._readField=function(t,e,n){},ny.Filter.BitShuffle={},ny.Filter.BitShuffle.read=function(t,e){return t.readFields(ny.Filter.BitShuffle._readField,{},e)},ny.Filter.BitShuffle._readField=function(t,e,n){},ny.Filter.ByteShuffle={},ny.Filter.ByteShuffle.read=function(t,e){return t.readFields(ny.Filter.ByteShuffle._readField,{},e)},ny.Filter.ByteShuffle._readField=function(t,e,n){},ny.Codec={},ny.Codec.read=function(t,e){return t.readFields(ny.Codec._readField,{gzip_data:null,codec:null,jpeg_image:null,webp_image:null,png_image:null},e)},ny.Codec._readField=function(t,e,n){1===t?(e.gzip_data=ny.Codec.GzipData.read(n,n.readVarint()+n.pos),e.codec="gzip_data"):2===t?(e.jpeg_image=ny.Codec.JpegImage.read(n,n.readVarint()+n.pos),e.codec="jpeg_image"):3===t?(e.webp_image=ny.Codec.WebpImage.read(n,n.readVarint()+n.pos),e.codec="webp_image"):4===t&&(e.png_image=ny.Codec.PngImage.read(n,n.readVarint()+n.pos),e.codec="png_image")},ny.Codec.GzipData={},ny.Codec.GzipData.read=function(t,e){return t.readFields(ny.Codec.GzipData._readField,{},e)},ny.Codec.GzipData._readField=function(t,e,n){},ny.Codec.JpegImage={},ny.Codec.JpegImage.read=function(t,e){return t.readFields(ny.Codec.JpegImage._readField,{},e)},ny.Codec.JpegImage._readField=function(t,e,n){},ny.Codec.WebpImage={},ny.Codec.WebpImage.read=function(t,e){return t.readFields(ny.Codec.WebpImage._readField,{},e)},ny.Codec.WebpImage._readField=function(t,e,n){},ny.Codec.PngImage={},ny.Codec.PngImage.read=function(t,e){return t.readFields(ny.Codec.PngImage._readField,{},e)},ny.Codec.PngImage._readField=function(t,e,n){},ny.DataIndexEntry={},ny.DataIndexEntry.read=function(t,e){return t.readFields(ny.DataIndexEntry._readField,{first_byte:0,last_byte:0,filters:[],codec:null,offset:0,scale:0,bands:[]},e)},ny.DataIndexEntry._readField=function(t,e,n){1===t?e.first_byte=n.readFixed64():2===t?e.last_byte=n.readFixed64():3===t?e.filters.push(ny.Filter.read(n,n.readVarint()+n.pos)):4===t?e.codec=ny.Codec.read(n,n.readVarint()+n.pos):5===t?e.offset=n.readFloat():6===t?e.scale=n.readFloat():7===t&&e.bands.push(n.readString())},ny.Layer={},ny.Layer.read=function(t,e){return t.readFields(ny.Layer._readField,{version:0,name:"",units:"",tilesize:0,buffer:0,pixel_format:0,data_index:[]},e)},ny.Layer._readField=function(t,e,n){1===t?e.version=n.readVarint():2===t?e.name=n.readString():3===t?e.units=n.readString():4===t?e.tilesize=n.readVarint():5===t?e.buffer=n.readVarint():6===t?e.pixel_format=n.readVarint():7===t&&e.data_index.push(ny.DataIndexEntry.read(n,n.readVarint()+n.pos))};const iy={read:function(t,e){return t.readFields(iy._readField,{uint32_values:null,values:null,fixed32_values:null},e)},_readField:function(t,e,n){2===t?(e.uint32_values=iy.Uint32Values.read(n,n.readVarint()+n.pos),e.values="uint32_values"):3===t&&(e.fixed32_values=iy.Fixed32Values.read(n,n.readVarint()+n.pos),e.values="fixed32_values")},Uint32Values:{}};iy.Uint32Values.read=function(t,e){return t.readFields(iy.Uint32Values._readField,{values:[]},e)},iy.Uint32Values._readField=function(t,e,n){1===t&&(e.readValuesInto=function(t){if(2!==t.type)throw new Error(`Unsupported pbf type "${t.type}"`);const e=function(t){return 2===t.type?t.readVarint()+t.pos:t.pos+1}(t),n=t.pos;return t.pos=e,function(i){t.pos=n;let a=0;for(;t.pos<e;){const e=t.readVarint();i[a++]=e}return i}}(n))},iy.Fixed32Values={},iy.Fixed32Values.read=function(t,e){return t.readFields(iy.Fixed32Values._readField,{values:[]},e)},iy.Fixed32Values._readField=function(t,e,n){throw new Error("Not implemented")};class ay{constructor(t=0,e=0,n=!1){this.first=null,this.items=Object.create(null),this.last=null,this.max=t,this.resetTtl=n,this.size=0,this.ttl=e}clear(){return this.first=null,this.items=Object.create(null),this.last=null,this.size=0,this}delete(t){if(this.has(t)){const e=this.items[t];delete this.items[t],this.size--,null!==e.prev&&(e.prev.next=e.next),null!==e.next&&(e.next.prev=e.prev),this.first===e&&(this.first=e.next),this.last===e&&(this.last=e.prev)}return this}entries(t=this.keys()){return t.map((t=>[t,this.get(t)]))}evict(t=!1){if(t||this.size>0){const t=this.first;delete this.items[t.key],0==--this.size?(this.first=null,this.last=null):(this.first=t.next,this.first.prev=null)}return this}expiresAt(t){let e;return this.has(t)&&(e=this.items[t].expiry),e}get(t){let e;if(this.has(t)){const n=this.items[t];this.ttl>0&&n.expiry<=Date.now()?this.delete(t):(e=n.value,this.set(t,e,!0))}return e}has(t){return t in this.items}keys(){const t=[];let e=this.first;for(;null!==e;)t.push(e.key),e=e.next;return t}set(t,e,n=!1,i=this.resetTtl){let a;if(n||this.has(t)){if(a=this.items[t],a.value=e,!1===n&&i&&(a.expiry=this.ttl>0?Date.now()+this.ttl:this.ttl),this.last!==a){const t=this.last,e=a.next,n=a.prev;this.first===a&&(this.first=a.next),a.next=null,a.prev=this.last,t.next=a,null!==n&&(n.next=e),null!==e&&(e.prev=n)}}else this.max>0&&this.size===this.max&&this.evict(!0),a=this.items[t]={expiry:this.ttl>0?Date.now()+this.ttl:this.ttl,key:t,prev:this.last,next:null,value:e},1==++this.size?this.first=a:this.last.next=a;return this.last=a,this}values(t=this.keys()){return t.map((t=>this.get(t)))}}function ry(t,e){if(4!==e.length)throw new Error(`Expected data of dimension 4 but got ${e.length}.`);let n=e[3];for(let i=2;i>=1;i--){const a=1===i?1:0,r=2===i?1:0;for(let i=0;i<e[0];i++){const o=e[1]*i;for(let i=a;i<e[1];i++){const a=e[2]*(i+o);for(let i=r;i<e[2];i++){const r=e[3]*(i+a);for(let i=0;i<e[3];i++){const e=r+i;t[e]+=t[e-n]}}}}n*=e[i]}return t}function oy(t){for(let e=0,n=t.length;e<n;e++)t[e]=t[e]>>>1^-(1&t[e]);return t}function sy(t,e){switch(e){case"uint32":return t;case"uint16":for(let e=0;e<t.length;e+=2){const n=t[e],i=t[e+1];t[e]=(240&n)>>4|(61440&n)>>8|(240&i)<<4|61440&i,t[e+1]=15&n|(3840&n)>>4|(15&i)<<8|(3840&i)<<4}return t;case"uint8":for(let e=0;e<t.length;e+=4){const n=t[e],i=t[e+1],a=t[e+2],r=t[e+3];t[e+0]=(192&n)>>6|(192&i)>>4|(192&a)>>2|192&r,t[e+1]=(48&n)>>4|(48&i)>>2|48&a|(48&r)<<2,t[e+2]=(12&n)>>2|12&i|(12&a)<<2|(12&r)<<4,t[e+3]=3&n|(3&i)<<2|(3&a)<<4|(3&r)<<6}return t;default:throw new Error(`Invalid pixel format, "${e}"`)}}class ly extends Error{constructor(t){super(t),this.name="MRTError"}}var cy=Uint8Array,uy=Uint16Array,hy=Int32Array,dy=new cy([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),py=new cy([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),fy=new cy([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),my=function(t,e){for(var n=new uy(31),i=0;i<31;++i)n[i]=e+=1<<t[i-1];var a=new hy(n[30]);for(i=1;i<30;++i)for(var r=n[i];r<n[i+1];++r)a[r]=r-n[i]<<5|i;return{b:n,r:a}},gy=my(dy,2),_y=gy.b,yy=gy.r;_y[28]=258,yy[258]=28;for(var xy=my(py,0).b,vy=new uy(32768),by=0;by<32768;++by){var wy=(43690&by)>>1|(21845&by)<<1;vy[by]=((65280&(wy=(61680&(wy=(52428&wy)>>2|(13107&wy)<<2))>>4|(3855&wy)<<4))>>8|(255&wy)<<8)>>1}var Ay=function(t,e,n){for(var i=t.length,a=0,r=new uy(e);a<i;++a)t[a]&&++r[t[a]-1];var o,s=new uy(e);for(a=1;a<e;++a)s[a]=s[a-1]+r[a-1]<<1;if(n){o=new uy(1<<e);var l=15-e;for(a=0;a<i;++a)if(t[a])for(var c=a<<4|t[a],u=e-t[a],h=s[t[a]-1]++<<u,d=h|(1<<u)-1;h<=d;++h)o[vy[h]>>l]=c}else for(o=new uy(i),a=0;a<i;++a)t[a]&&(o[a]=vy[s[t[a]-1]++]>>15-t[a]);return o},Cy=new cy(288);for(by=0;by<144;++by)Cy[by]=8;for(by=144;by<256;++by)Cy[by]=9;for(by=256;by<280;++by)Cy[by]=7;for(by=280;by<288;++by)Cy[by]=8;var Ey=new cy(32);for(by=0;by<32;++by)Ey[by]=5;var Ty=Ay(Cy,9,1),Sy=Ay(Ey,5,1),My=function(t){for(var e=t[0],n=1;n<t.length;++n)t[n]>e&&(e=t[n]);return e},ky=function(t,e,n){var i=e/8|0;return(t[i]|t[i+1]<<8)>>(7&e)&n},Iy=function(t,e){var n=e/8|0;return(t[n]|t[n+1]<<8|t[n+2]<<16)>>(7&e)},Py=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],zy=function(t,e,n){var i=new Error(e||Py[t]);if(i.code=t,Error.captureStackTrace&&Error.captureStackTrace(i,zy),!n)throw i;return i},Dy=new cy(0),Ly="undefined"!=typeof TextDecoder&&new TextDecoder;try{Ly.decode(Dy,{stream:!0})}catch(t){}const By={gzip_data:"gzip"},Oy={0:"uint32",1:"uint32",2:"uint16",3:"uint8"},Ry={uint32:1,uint16:2,uint8:4},Fy={uint32:Uint32Array,uint16:Uint16Array,uint8:Uint8Array};class Ny{constructor(t=1){this.x=NaN,this.y=NaN,this.z=NaN,this.layers={},this._cacheSize=t}getLayer(t){return this.layers[t]}getHeaderLength(t){const e=new Uint8Array(t),n=new DataView(t);if(13!==e[0])throw new ly("File is not a valid MRT.");return n.getUint32(1,!0)}parseHeader(t){const e=new Uint8Array(t),n=this.getHeaderLength(t);if(e.length<n)throw new ly(`Expected header with length >= ${n} but got buffer of length ${e.length}`);const i=new Im(e.subarray(0,n)),a=ny.read(i);if(!isNaN(this.x)&&(this.x!==a.x||this.y!==a.y||this.z!==a.z))throw new ly(`Invalid attempt to parse header ${a.z}/${a.x}/${a.y} for tile ${this.z}/${this.x}/${this.y}`);this.x=a.x,this.y=a.y,this.z=a.z;for(const t of a.layers)this.layers[t.name]=new jy(t,{cacheSize:this._cacheSize});return this}createDecodingTask(t){const e=[],n=this.getLayer(t.layerName);for(let i=0;i<n.dataIndex.length;i++){const a=n.dataIndex[i],r=a.first_byte-t.firstByte,o=a.last_byte+1-t.firstByte;if(i<t.firstBlock||i>t.lastBlock)continue;if(n._blocksInProgress.has(i))continue;const s={layerName:n.name,firstByte:r,lastByte:o,pixelFormat:n.pixelFormat,blockIndex:i,blockShape:[a.bands.length].concat(n.bandShape),buffer:n.buffer,codec:a.codec.codec,filters:a.filters.map((t=>t.filter))};n._blocksInProgress.add(i),e.push(s)}return new Vy(e,(()=>{e.forEach((t=>n._blocksInProgress.delete(t.blockIndex)))}),((t,i)=>{if(e.forEach((t=>n._blocksInProgress.delete(t.blockIndex))),t)throw t;i.forEach((t=>{this.getLayer(t.layerName).processDecodedData(t)}))}))}}class jy{constructor({version:t,name:e,units:n,tilesize:i,pixel_format:a,buffer:r,data_index:o},s){if(this.version=t,1!==this.version)throw new ly(`Cannot parse raster layer encoded with MRT version ${t}`);this.name=e,this.units=n,this.tileSize=i,this.buffer=r,this.pixelFormat=Oy[a],this.dataIndex=o,this.bandShape=[i+2*r,i+2*r,Ry[this.pixelFormat]],this._decodedBlocks=function(t=1e3,e=0,n=!1){if(isNaN(t)||t<0)throw new TypeError("Invalid max value");if(isNaN(e)||e<0)throw new TypeError("Invalid ttl value");if("boolean"!=typeof n)throw new TypeError("Invalid resetTtl value");return new ay(t,e,n)}(s?s.cacheSize:5),this._blocksInProgress=new Set}processDecodedData(t){const e=t.blockIndex.toString();this._decodedBlocks.get(e)||this._decodedBlocks.set(e,t.data)}getBlockForBand(t){let e=0;switch(typeof t){case"string":for(const[n,i]of this.dataIndex.entries()){for(const[a,r]of i.bands.entries())if(r===t)return{bandIndex:e+a,blockIndex:n,blockBandIndex:a};e+=i.bands.length}break;case"number":for(const[n,i]of this.dataIndex.entries()){if(t>=e&&t<e+i.bands.length)return{bandIndex:t,blockIndex:n,blockBandIndex:t-e};e+=i.bands.length}break;default:throw new ly(`Invalid band \`${JSON.stringify(t)}\`. Expected string or integer.`)}throw new ly(`Band not found: ${JSON.stringify(t)}`)}getDataRange(t){let e=1/0,n=-1/0,i=1/0,a=-1/0;for(const r of t){const{blockIndex:t}=this.getBlockForBand(r);if(t<0)throw new ly(`Invalid band: ${JSON.stringify(r)}`);const o=this.dataIndex[t];i=Math.min(i,t),a=Math.max(a,t),e=Math.min(e,o.first_byte),n=Math.max(n,o.last_byte)}return{layerName:this.name,firstByte:e,lastByte:n,firstBlock:i,lastBlock:a}}hasBand(t){const{blockIndex:e}=this.getBlockForBand(t);return e>=0}hasDataForBand(t){const{blockIndex:e}=this.getBlockForBand(t);return e>=0&&!!this._decodedBlocks.get(e.toString())}getBandView(t){const{blockIndex:e,blockBandIndex:n}=this.getBlockForBand(t),i=this._decodedBlocks.get(e.toString());if(!i)throw new ly(`Data for band ${JSON.stringify(t)} of layer "${this.name}" not decoded.`);const a=this.dataIndex[e],r=this.bandShape.reduce(((t,e)=>t*e),1),o=n*r,s=i.subarray(o,o+r);return{data:s,bytes:new Uint8Array(s.buffer).subarray(s.byteOffset,s.byteOffset+s.byteLength),tileSize:this.tileSize,buffer:this.buffer,offset:a.offset,scale:a.scale}}}class Vy{constructor(t,e,n){this.tasks=t,this._onCancel=e,this._onComplete=n,this._finalized=!1}cancel(){this._finalized||(this._onCancel(),this._finalized=!0)}complete(t,e){this._finalized||(this._onComplete(t,e),this._finalized=!0)}}Ny.performDecoding=function(t,e){return Promise.all(e.tasks.map((e=>{const{layerName:n,firstByte:i,lastByte:a,pixelFormat:r,blockShape:o,blockIndex:s,filters:l,codec:c}=e,u=new Uint8Array(t).subarray(i,a+1),h=new Uint32Array(o[0]*o[1]*o[2]);let d;if("gzip_data"!==c)throw new Error(`Unhandled codec: ${c}`);return d=function(t,e){if(!globalThis.DecompressionStream&&"gzip_data"===e)return Promise.resolve(((r=function(t){31==t[0]&&139==t[1]&&8==t[2]||zy(6,"invalid gzip data");var e=t[3],n=10;4&e&&(n+=2+(t[10]|t[11]<<8));for(var i=(e>>3&1)+(e>>4&1);i>0;i-=!t[n++]);return n+(2&e)}(a=t))+8>a.length&&zy(6,"invalid gzip data"),function(t,e,n,i){var a=t.length;if(!a||e.f&&!e.l)return n||new cy(0);var r=!n,o=r||2!=e.i,s=e.i;r&&(n=new cy(3*a));var l,c,u=function(t){var e=n.length;if(t>e){var i=new cy(Math.max(2*e,t));i.set(n),n=i}},h=e.f||0,d=e.p||0,p=e.b||0,f=e.l,m=e.d,g=e.m,_=e.n,y=8*a;do{if(!f){h=ky(t,d,1);var x=ky(t,d+1,3);if(d+=3,!x){var v=t[(P=4+((d+7)/8|0))-4]|t[P-3]<<8,b=P+v;if(b>a){s&&zy(0);break}o&&u(p+v),n.set(t.subarray(P,b),p),e.b=p+=v,e.p=d=8*b,e.f=h;continue}if(1==x)f=Ty,m=Sy,g=9,_=5;else if(2==x){var w=ky(t,d,31)+257,A=ky(t,d+10,15)+4,C=w+ky(t,d+5,31)+1;d+=14;for(var E=new cy(C),T=new cy(19),S=0;S<A;++S)T[fy[S]]=ky(t,d+3*S,7);d+=3*A;var M=My(T),k=(1<<M)-1,I=Ay(T,M,1);for(S=0;S<C;){var P,z=I[ky(t,d,k)];if(d+=15&z,(P=z>>4)<16)E[S++]=P;else{var D=0,L=0;for(16==P?(L=3+ky(t,d,3),d+=2,D=E[S-1]):17==P?(L=3+ky(t,d,7),d+=3):18==P&&(L=11+ky(t,d,127),d+=7);L--;)E[S++]=D}}var B=E.subarray(0,w),O=E.subarray(w);g=My(B),_=My(O),f=Ay(B,g,1),m=Ay(O,_,1)}else zy(1);if(d>y){s&&zy(0);break}}o&&u(p+131072);for(var R=(1<<g)-1,F=(1<<_)-1,N=d;;N=d){var j=(D=f[Iy(t,d)&R])>>4;if((d+=15&D)>y){s&&zy(0);break}if(D||zy(2),j<256)n[p++]=j;else{if(256==j){N=d,f=null;break}var V=j-254;j>264&&(V=ky(t,d,(1<<(q=dy[S=j-257]))-1)+_y[S],d+=q);var U=m[Iy(t,d)&F],G=U>>4;if(U||zy(3),d+=15&U,O=xy[G],G>3){var q=py[G];O+=Iy(t,d)&(1<<q)-1,d+=q}if(d>y){s&&zy(0);break}o&&u(p+131072);var $=p+V;if(p<O){var W=0-O,H=Math.min(O,$);for(W+p<0&&zy(3);p<H;++p)n[p]=(void 0)[W+p]}for(;p<$;++p)n[p]=n[p-O]}}e.l=f,e.p=N,e.b=p,e.f=h,f&&(h=1,e.m=g,e.d=m,e.n=_)}while(!h);return p!=n.length&&r?(l=n,(null==(c=p)||c>l.length)&&(c=l.length),new cy(l.subarray(0,c))):n.subarray(0,p)}(a.subarray(r,-8),{i:2},new cy(((n=a)[(i=n.length)-4]|n[i-3]<<8|n[i-2]<<16|n[i-1]<<24)>>>0))));var n,i,a,r;const o=By[e];if(!o)throw new Error(`Unhandled codec: ${e}`);const s=new globalThis.DecompressionStream(o);return new Response(new Blob([t]).stream().pipeThrough(s)).arrayBuffer().then((t=>new Uint8Array(t)))}(u,c).then((t=>{const e=iy.read(new Im(t));if("uint32_values"===e.values)return e.uint32_values.readValuesInto(h),new(0,Fy[r])(h.buffer);throw new Error(`Unhandled numeric data "${e.values}"`)})),d.then((t=>{for(let e=l.length-1;e>=0;e--)switch(l[e]){case"delta_filter":ry(t,o);break;case"zigzag_filter":oy(t);break;case"bitshuffle_filter":sy(t,r);break;default:throw new Error(`Unhandled filter "${l[e]}"`)}return{layerName:n,blockIndex:s,data:t}})).catch((t=>{throw t}))})))};class Uy extends ey{constructor(t,e,n,i,a){super(t,e,n,i,a),this._workQueue=[],this._fetchQueue=[],this._isHeaderLoaded=!1}setTexture(t,e){const n=e.context,i=n.gl;this.texture=this.texture||e.getTileTexture(t.width),this.texture&&this.texture instanceof G_?this.texture.update(t,{useMipmap:!1,premultiply:!1}):this.texture=new G_(n,t,i.RGBA,{useMipmap:!1,premultiply:!1})}flushQueues(){for(;this._workQueue.length;)this._workQueue.pop()();for(;this._fetchQueue.length;)this._fetchQueue.pop()()}fetchHeader(t=16384,e){const n=this._mrt=new Ny(30),i=Object.assign({},this.requestParams,{headers:{Range:"bytes=0-"+(t-1)}});return this.entireBuffer=null,this.request=ni(i,((i,a,r,o)=>{if(i)e(i);else try{const i=n.getHeaderLength(a);if(i>t)return void(this.request=this.fetchHeader(i,e));n.parseHeader(a),this._isHeaderLoaded=!0;let s=0;for(const t of Object.values(n.layers))s=Math.max(s,t.dataIndex[t.dataIndex.length-1].last_byte);a.byteLength>=s&&(this.entireBuffer=a),e(null,this.entireBuffer||a,r,o)}catch(t){e(t)}})),this.request}fetchBand(t,e,n){const i=this._mrt;if(!this._isHeaderLoaded||!i)return void n(new Error("Tile header is not ready"));const a=this.actor;if(!a)return void n(new Error("Can't fetch tile band without an actor"));let r;const o=(i,a)=>{r.complete(i,a),i?n(i):(this.updateTextureDescriptor(t,e),n(null,this.textureDescriptor&&this.textureDescriptor.img))},s=(t,e)=>{if(t)return n(t);const i=a.send("decodeRasterArray",{buffer:e,task:r},o,void 0,!0);this._workQueue.push((()=>{i&&i.cancel(),r.cancel()}))},l=i.getLayer(t);if(!l)return void n(new Error(`Unknown sourceLayer "${t}"`));if(l.hasDataForBand(e))return this.updateTextureDescriptor(t,e),void n(null,this.textureDescriptor?this.textureDescriptor.img:null);const c=l.getDataRange([e]);if(r=i.createDecodingTask(c),!r||r.tasks.length)if(this.flushQueues(),this.entireBuffer)s(null,this.entireBuffer.slice(c.firstByte,c.lastByte+1));else{const t=Object.assign({},this.requestParams,{headers:{Range:`bytes=${c.firstByte}-${c.lastByte}`}}),e=ni(t,s);this._fetchQueue.push((()=>{e.cancel(),r.cancel()}))}else n(null)}updateNeeded(t,e){return(!this.textureDescriptor||this.textureDescriptor.band!==e||this.textureDescriptor.layer!==t)&&"errored"!==this.state}updateTextureDescriptor(t,e){if(!this._mrt)return;const n=this._mrt.getLayer(t);if(!n||!n.hasBand(e)||!n.hasDataForBand(e))return;const{bytes:i,tileSize:a,buffer:r,offset:o,scale:s}=n.getBandView(e),l=a+2*r,c={data:i,width:l,height:l},u=this.texture;u&&u instanceof G_&&u.update(c,{useMipmap:!1,premultiply:!1}),this.textureDescriptor={layer:t,band:e,img:c,buffer:r,offset:o,tileSize:a,format:n.pixelFormat,mix:[s,256*s,65536*s,16777216*s]}}}class Gy{constructor(t,e){this.max=t,this.onRemove=e,this.reset()}reset(){for(const t in this.data)for(const e of this.data[t])e.timeout&&clearTimeout(e.timeout),this.onRemove(e.value);return this.data={},this.order=[],this}add(t,e,n){const i=t.wrapped().key;void 0===this.data[i]&&(this.data[i]=[]);const a={value:e,timeout:void 0};if(void 0!==n&&(a.timeout=setTimeout((()=>{this.remove(t,a)}),n)),this.data[i].push(a),this.order.push(i),this.order.length>this.max){const t=this._getAndRemoveByKey(this.order[0]);t&&this.onRemove(t)}return this}has(t){return t.wrapped().key in this.data}getAndRemove(t){return this.has(t)?this._getAndRemoveByKey(t.wrapped().key):null}_getAndRemoveByKey(t){const e=this.data[t].shift();return e.timeout&&clearTimeout(e.timeout),0===this.data[t].length&&delete this.data[t],this.order.splice(this.order.indexOf(t),1),e.value}getByKey(t){const e=this.data[t];return e?e[0].value:null}get(t){return this.has(t)?this.data[t.wrapped().key][0].value:null}remove(t,e){if(!this.has(t))return this;const n=t.wrapped().key,i=void 0===e?0:this.data[n].indexOf(e),a=this.data[n][i];return this.data[n].splice(i,1),a.timeout&&clearTimeout(a.timeout),0===this.data[n].length&&delete this.data[n],this.onRemove(a.value),this.order.splice(this.order.indexOf(n),1),this}setMaxSize(t){for(this.max=t;this.order.length>this.max;){const t=this._getAndRemoveByKey(this.order[0]);t&&this.onRemove(t)}return this}filter(t){const e=[];for(const n in this.data)for(const i of this.data[n])t(i.value)||e.push(i);for(const t of e)this.remove(t.value.tileID,t)}}class qy extends Bi{constructor(t,e,n){super(),this.id=t,this._onlySymbols=n,e.on("data",(t=>{"source"===t.dataType&&"metadata"===t.sourceDataType&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&"source"===t.dataType&&"content"===t.sourceDataType&&(this.reload(),this.transform&&this.update(this.transform))})),e.on("error",(()=>{this._sourceErrored=!0})),this._source=e,this._tiles={},this._cache=new Gy(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=e.minTileCacheSize,this._maxTileCacheSize=e.maxTileCacheSize,this._loadedParentTiles={},this.castsShadows=!1,this.tileCoverLift=0,this._coveredTiles={},this._shadowCasterTiles={},this._state=new Dm,this._isRaster="raster"===this._source.type||"raster-dem"===this._source.type||"raster-array"===this._source.type||"custom"===this._source.type&&"raster"===this._source._dataType}onAdd(t){this.map=t,this._minTileCacheSize=void 0===this._minTileCacheSize&&t?t._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=void 0===this._maxTileCacheSize&&t?t._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded)return!1;if(!this._source.loaded())return!1;for(const t in this._tiles){const e=this._tiles[t];if("errored"!==e.state&&("loaded"!==e.state||!e.bucketsLoaded()))return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const t=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,t&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(t,e){return t.isSymbolTile=this._onlySymbols,t.isExtraShadowCaster=this._shadowCasterTiles[t.tileID.key],this._source.loadTile(t,e)}_unloadTile(t){if(this._source.unloadTile)return this._source.unloadTile(t)}_abortTile(t){if(this._source.abortTile)return this._source.abortTile(t)}serialize(){return this._source.serialize()}prepare(t){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const e in this._tiles){const n=this._tiles[e];n.upload(t),n.prepare(this.map.style.imageManager,this.map?this.map.painter:null,this._source.scope)}}getIds(){return tn(this._tiles).map((t=>t.tileID)).sort($y).map((t=>t.key))}getRenderableIds(t,e){const n=[];for(const i in this._tiles)this._isIdRenderable(+i,t,e)&&n.push(this._tiles[i]);return t?n.sort(((t,e)=>{const n=t.tileID,i=e.tileID,a=new Ve(n.canonical.x,n.canonical.y)._rotate(this.transform.angle),r=new Ve(i.canonical.x,i.canonical.y)._rotate(this.transform.angle);return n.overscaledZ-i.overscaledZ||r.y-a.y||r.x-a.x})).map((t=>t.tileID.key)):n.map((t=>t.tileID)).sort($y).map((t=>t.key))}hasRenderableParent(t){const e=this.findLoadedParent(t,0);return!!e&&this._isIdRenderable(e.tileID.key)}_isIdRenderable(t,e,n){return this._tiles[t]&&this._tiles[t].hasData()&&!this._coveredTiles[t]&&(e||!this._tiles[t].holdingForFade())&&(n||!this._shadowCasterTiles[t])}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const t in this._tiles)"errored"!==this._tiles[t].state&&this._reloadTile(+t,"reloading")}}_reloadTile(t,e){const n=this._tiles[t];n&&("loading"!==n.state&&(n.state=e),this._loadTile(n,this._tileLoaded.bind(this,n,t,e)))}_tileLoaded(t,e,n,i){if(i)if(t.state="errored",404!==i.status)this._source.fire(new Li(i,{tile:t}));else{if(!(t.tileID.key in this._loadedParentTiles))return void this._source.fire(new Di("data",{dataType:"source",sourceDataType:"error",sourceId:this._source.id}));if("raster-dem"===this._source.type&&this.usedForTerrain&&this.map.painter.terrain){const t=this.map.painter.terrain;this.update(this.transform,t.getScaledDemTileSize(),!0),t.resetTileLookupCache(this.id)}else this.update(this.transform)}else t.timeAdded=Ln.now(),"expired"===n&&(t.refreshedUponExpiration=!0),this._setTileReloadTimer(e,t),"raster-dem"===this._source.type&&t.dem&&this._backfillDEM(t),this._state.initializeTileState(t,this.map?this.map.painter:null),this._source.fire(new Di("data",{dataType:"source",tile:t,coord:t.tileID,sourceCacheId:this.id}))}_backfillDEM(t){const e=this.getRenderableIds();for(let i=0;i<e.length;i++){const a=e[i];if(t.neighboringTiles&&t.neighboringTiles[a]){const e=this.getTileByID(a);n(t,e),n(e,t)}}function n(t,e){if(!t.dem||t.dem.borderReady)return;t.needsHillshadePrepare=!0,t.needsDEMTextureUpload=!0;let n=e.tileID.canonical.x-t.tileID.canonical.x;const i=e.tileID.canonical.y-t.tileID.canonical.y,a=Math.pow(2,t.tileID.canonical.z),r=e.tileID.key;0===n&&0===i||Math.abs(i)>1||(Math.abs(n)>1&&(1===Math.abs(n+a)?n+=a:1===Math.abs(n-a)&&(n-=a)),e.dem&&t.dem&&(t.dem.backfillBorder(e.dem,n,i),t.neighboringTiles&&t.neighboringTiles[r]&&(t.neighboringTiles[r].backfilled=!0)))}}getTile(t){return this.getTileByID(t.key)}getTileByID(t){return this._tiles[t]}_retainLoadedChildren(t,e,n,i){for(const a in this._tiles){let r=this._tiles[a];if(i[a]||!r.hasData()||r.tileID.overscaledZ<=e||r.tileID.overscaledZ>n)continue;let o=r.tileID;for(;r&&r.tileID.overscaledZ>e+1;){const t=r.tileID.scaledTo(r.tileID.overscaledZ-1);r=this._tiles[t.key],r&&r.hasData()&&(o=t)}let s=o;for(;s.overscaledZ>e;)if(s=s.scaledTo(s.overscaledZ-1),t[s.key]){i[o.key]=o;break}}}findLoadedParent(t,e){if(t.key in this._loadedParentTiles){const n=this._loadedParentTiles[t.key];return n&&n.tileID.overscaledZ>=e?n:null}for(let n=t.overscaledZ-1;n>=e;n--){const e=t.scaledTo(n),i=this._getLoadedTile(e);if(i)return i}}_getLoadedTile(t){const e=this._tiles[t.key];return e&&e.hasData()?e:this._cache.getByKey(this._source.reparseOverscaled?t.wrapped().key:t.canonical.key)}updateCacheSize(t,e){e=e||this._source.tileSize;const n=Math.ceil(t.width/e)+1,i=Math.ceil(t.height/e)+1,a=Math.floor(n*i*5),r="number"==typeof this._minTileCacheSize?Math.max(this._minTileCacheSize,a):a,o="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,r):r;this._cache.setMaxSize(o)}handleWrapJump(t){const e=Math.round((t-(void 0===this._prevLng?t:this._prevLng))/360);if(this._prevLng=t,e){const t={};for(const n in this._tiles){const i=this._tiles[n];i.tileID=i.tileID.unwrapTo(i.tileID.wrap+e),t[i.tileID.key]=i}this._tiles=t;for(const t in this._timers)clearTimeout(this._timers[t]),delete this._timers[t];for(const t in this._tiles)this._setTileReloadTimer(+t,this._tiles[t])}}update(t,e,n,i){if(this.transform=t,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage)return;if(this.usedForTerrain&&!n)return;let a;if(this.updateCacheSize(t,e),"globe"!==this.transform.projection.name&&this.handleWrapJump(this.transform.center.lng),this._shadowCasterTiles={},this._coveredTiles={},this.used||this.usedForTerrain){if(this._source.tileID)a=t.getVisibleUnwrappedCoordinates(this._source.tileID).map((t=>new xu(t.canonical.z,t.wrap,t.canonical.z,t.canonical.x,t.canonical.y)));else if(0!==this.tileCoverLift){const i=t.clone();i.tileCoverLift=this.tileCoverLift,a=i.coveringTiles({tileSize:e||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!n,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.minzoom<=1&&"globe"===t.projection.name&&(a.push(new xu(1,0,1,0,0)),a.push(new xu(1,0,1,1,0)),a.push(new xu(1,0,1,0,1)),a.push(new xu(1,0,1,1,1)))}else if(a=t.coveringTiles({tileSize:e||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!n,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile){const t=this._source.hasTile.bind(this._source);a=a.filter((e=>t(e)))}}else a=[];if(a.length>0&&this.castsShadows&&i&&"globe"!==this.transform.projection.name&&!this.usedForTerrain&&!Wy(this._source.type)){const r=t.coveringZoomLevel({tileSize:e||this._source.tileSize,roundZoom:this._source.roundZoom&&!n}),o=Math.min(r,this._source.maxzoom),s=t.extendTileCoverForShadows(a,i,o);for(const t of s)this._shadowCasterTiles[t.key]=!0,a.push(t)}const r=this._updateRetainedTiles(a);if(Wy(this._source.type)&&0!==a.length){const t={},e={},n=Object.keys(r);for(const i of n){const n=r[i],a=this._tiles[i];if(!a||a.fadeEndTime&&a.fadeEndTime<=Ln.now())continue;const o=this.findLoadedParent(n,Math.max(n.overscaledZ-qy.maxOverzooming,this._source.minzoom));o&&(this._addTile(o.tileID),t[o.tileID.key]=o.tileID),e[i]=n}const i=a[a.length-1].overscaledZ;for(const t in this._tiles){const n=this._tiles[t];if(r[t]||!n.hasData())continue;let a=n.tileID;for(;a.overscaledZ>i;){a=a.scaledTo(a.overscaledZ-1);const i=this._tiles[a.key];if(i&&i.hasData()&&e[a.key]){r[t]=n.tileID;break}}}for(const e in t)r[e]||(this._coveredTiles[e]=!0,r[e]=t[e])}for(const t in r)this._tiles[t].clearFadeHold();const o=function(t,e){const n=[];for(const i in t)i in e||n.push(i);return n}(this._tiles,r);for(const t of o){const e=this._tiles[t];e.hasSymbolBuckets&&!e.holdingForFade()?e.setHoldDuration(this.map._fadeDuration):e.hasSymbolBuckets&&!e.symbolFadeFinished()||this._removeTile(+t)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const t in this._tiles)this._tiles[t].holdingForFade()&&this._removeTile(+t)}_updateRetainedTiles(t){const e={};if(0===t.length)return e;const n={},i=t.reduce(((t,e)=>Math.min(t,e.overscaledZ)),1/0),a=t[0].overscaledZ,r=Math.max(a-qy.maxOverzooming,this._source.minzoom),o=Math.max(a+qy.maxUnderzooming,this._source.minzoom),s={};for(const n of t){const t=this._addTile(n);e[n.key]=n,t.hasData()||i<this._source.maxzoom&&(s[n.key]=n)}this._retainLoadedChildren(s,i,o,e);for(const i of t){let t=this._tiles[i.key];if(t.hasData())continue;if(i.canonical.z>=this._source.maxzoom){const t=i.children(this._source.maxzoom)[0],n=this.getTile(t);if(n&&n.hasData()){e[t.key]=t;continue}}else{const t=i.children(this._source.maxzoom);if(e[t[0].key]&&e[t[1].key]&&e[t[2].key]&&e[t[3].key])continue}let a=t.wasRequested();for(let o=i.overscaledZ-1;o>=r;--o){const r=i.scaledTo(o);if(n[r.key])break;if(n[r.key]=!0,t=this.getTile(r),!t&&a&&(t=this._addTile(r)),t&&(e[r.key]=r,a=t.wasRequested(),t.hasData()))break}}return e}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const t in this._tiles){const e=[];let n,i=this._tiles[t].tileID;for(;i.overscaledZ>0;){if(i.key in this._loadedParentTiles){n=this._loadedParentTiles[i.key];break}e.push(i.key);const t=i.scaledTo(i.overscaledZ-1);if(n=this._getLoadedTile(t),n)break;i=t}for(const t of e)this._loadedParentTiles[t]=n}}_addTile(t){let e=this._tiles[t.key];if(e)return!0!==e.isExtraShadowCaster||!!this._shadowCasterTiles[t.key]||this._reloadTile(t.key,"reloading"),e;e=this._cache.getAndRemove(t),e&&(this._setTileReloadTimer(t.key,e),e.tileID=t,this._state.initializeTileState(e,this.map?this.map.painter:null),this._cacheTimers[t.key]&&(clearTimeout(this._cacheTimers[t.key]),delete this._cacheTimers[t.key],this._setTileReloadTimer(t.key,e)));const n=Boolean(e);if(!n){const n=this.map?this.map.painter:null,i=this._source.tileSize*t.overscaleFactor();e="raster-array"===this._source.type?new Uy(t,i,this.transform.tileZoom,n,this._isRaster):new ey(t,i,this.transform.tileZoom,n,this._isRaster),this._loadTile(e,this._tileLoaded.bind(this,e,t.key,e.state))}return e?(e.uses++,this._tiles[t.key]=e,n||this._source.fire(new Di("dataloading",{tile:e,coord:e.tileID,dataType:"source"})),e):null}_setTileReloadTimer(t,e){t in this._timers&&(clearTimeout(this._timers[t]),delete this._timers[t]);const n=e.getExpiryTimeout();n&&(this._timers[t]=setTimeout((()=>{this._reloadTile(t,"expired"),delete this._timers[t]}),n))}_removeTile(t){const e=this._tiles[t];e&&(e.uses--,delete this._tiles[t],this._timers[t]&&(clearTimeout(this._timers[t]),delete this._timers[t]),e.uses>0||(e.hasData()&&"reloading"!==e.state||"empty"===e.state?this._cache.add(e.tileID,e,e.getExpiryTimeout()):(e.aborted=!0,this._abortTile(e),this._unloadTile(e))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const t in this._tiles)this._removeTile(+t);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(t,e,n){const i=[],a=this.transform;if(!a)return i;const r="globe"===a.projection.name,o=Eu(a.center.lng);for(const s in this._tiles){const l=this._tiles[s];if(n&&l.clearQueryDebugViz(),l.holdingForFade())continue;let c;if(r){const t=l.tileID.canonical;if(0===t.z){const e=[Math.abs(Xe(o,...Hy(t,-1))-o),Math.abs(Xe(o,...Hy(t,1))-o)];c=[0,2*e.indexOf(Math.min(...e))-1]}else{const e=[Math.abs(Xe(o,...Hy(t,-1))-o),Math.abs(Xe(o,...Hy(t,0))-o),Math.abs(Xe(o,...Hy(t,1))-o)];c=[e.indexOf(Math.min(...e))-1]}}else c=[0];for(const n of c){const r=t.containsTile(l,a,e,n);r&&i.push(r)}}return i}getShadowCasterCoordinates(){return this._getRenderableCoordinates(!1,!0)}getVisibleCoordinates(t){return this._getRenderableCoordinates(t)}_getRenderableCoordinates(t,e){const n=this.getRenderableIds(t,e).map((t=>this._tiles[t].tileID)),i="globe"===this.transform.projection.name;for(const t of n)t.projMatrix=this.transform.calculateProjMatrix(t.toUnwrapped()),t.expandedProjMatrix=i?this.transform.calculateProjMatrix(t.toUnwrapped(),!1,!0):t.projMatrix;return n}sortCoordinatesByDistance(t){const e=t.slice(),n=this.transform._camera.position,i=this.transform._camera.forward(),a={};for(const t of e){const e=1/(1<<t.canonical.z);a[t.key]=((t.canonical.x+.5)*e+t.wrap-n[0])*i[0]+((t.canonical.y+.5)*e-n[1])*i[1]-n[2]*i[2]}return e.sort(((t,e)=>a[t.key]-a[e.key])),e}hasTransition(){if(this._source.hasTransition())return!0;if(Wy(this._source.type))for(const t in this._tiles){const e=this._tiles[t];if(void 0!==e.fadeEndTime&&e.fadeEndTime>=Ln.now())return!0}return!1}setFeatureState(t,e,n){this._state.updateState(t=t||"_geojsonTileLayer",e,n)}removeFeatureState(t,e,n){this._state.removeFeatureState(t=t||"_geojsonTileLayer",e,n)}getFeatureState(t,e){return this._state.getState(t=t||"_geojsonTileLayer",e)}setDependencies(t,e,n){const i=this._tiles[t];i&&i.setDependencies(e,n)}reloadTilesForDependencies(t,e){for(const n in this._tiles)this._tiles[n].hasDependency(t,e)&&this._reloadTile(+n,"reloading");this._cache.filter((n=>!n.hasDependency(t,e)))}_preloadTiles(t,e){if(!this._sourceLoaded){const n=()=>{this._sourceLoaded&&(this._source.off("data",n),this._preloadTiles(t,e))};return void this._source.on("data",n)}const n=new Map,i=Array.isArray(t)?t:[t],a=this.map.painter.terrain,r=this.usedForTerrain&&a?a.getScaledDemTileSize():this._source.tileSize;for(const t of i){const e=t.coveringTiles({tileSize:r,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const t of e)n.set(t.key,t);this.usedForTerrain&&t.updateElevation(!1)}Je(Array.from(n.values()),((t,e)=>{const n=new ey(t,this._source.tileSize*t.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(n,(t=>{"raster-dem"===this._source.type&&n.dem&&this._backfillDEM(n),e(t,n)}))}),e)}}function $y(t,e){const n=Math.abs(2*t.wrap)-+(t.wrap<0),i=Math.abs(2*e.wrap)-+(e.wrap<0);return t.overscaledZ-e.overscaledZ||i-n||e.canonical.y-t.canonical.y||e.canonical.x-t.canonical.x}function Wy(t){return"raster"===t||"image"===t||"video"===t||"custom"===t}function Hy(t,e){const n=1<<t.z;return[t.x/n+e,(t.x+1)/n+e]}qy.maxOverzooming=10,qy.maxUnderzooming=3;const Zy=new class extends il{possiblyEvaluate(t,e){return e=new Hs(Math.floor(e.zoom),{now:e.now,fadeDuration:e.fadeDuration,transition:e.transition}),super.possiblyEvaluate(t,e)}evaluate(t,e,n,i){return e=en({},e,{zoom:Math.floor(e.zoom)}),super.evaluate(t,e,n,i)}}(em.paint.properties["line-width"].specification);function Yy(t,e){return e>0?e+2*t:t}Zy.useIntegerZoom=!0;const Xy=new rl({"symbol-placement":new nl(ol.layout_symbol["symbol-placement"]),"symbol-spacing":new nl(ol.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new nl(ol.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new il(ol.layout_symbol["symbol-sort-key"]),"symbol-z-order":new nl(ol.layout_symbol["symbol-z-order"]),"symbol-z-elevate":new nl(ol.layout_symbol["symbol-z-elevate"]),"icon-allow-overlap":new nl(ol.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new nl(ol.layout_symbol["icon-ignore-placement"]),"icon-optional":new nl(ol.layout_symbol["icon-optional"]),"icon-rotation-alignment":new nl(ol.layout_symbol["icon-rotation-alignment"]),"icon-size":new il(ol.layout_symbol["icon-size"]),"icon-text-fit":new il(ol.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new il(ol.layout_symbol["icon-text-fit-padding"]),"icon-image":new il(ol.layout_symbol["icon-image"]),"icon-rotate":new il(ol.layout_symbol["icon-rotate"]),"icon-padding":new nl(ol.layout_symbol["icon-padding"]),"icon-keep-upright":new nl(ol.layout_symbol["icon-keep-upright"]),"icon-offset":new il(ol.layout_symbol["icon-offset"]),"icon-anchor":new il(ol.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new nl(ol.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new nl(ol.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new nl(ol.layout_symbol["text-rotation-alignment"]),"text-field":new il(ol.layout_symbol["text-field"]),"text-font":new il(ol.layout_symbol["text-font"]),"text-size":new il(ol.layout_symbol["text-size"]),"text-max-width":new il(ol.layout_symbol["text-max-width"]),"text-line-height":new il(ol.layout_symbol["text-line-height"]),"text-letter-spacing":new il(ol.layout_symbol["text-letter-spacing"]),"text-justify":new il(ol.layout_symbol["text-justify"]),"text-radial-offset":new il(ol.layout_symbol["text-radial-offset"]),"text-variable-anchor":new nl(ol.layout_symbol["text-variable-anchor"]),"text-anchor":new il(ol.layout_symbol["text-anchor"]),"text-max-angle":new nl(ol.layout_symbol["text-max-angle"]),"text-writing-mode":new nl(ol.layout_symbol["text-writing-mode"]),"text-rotate":new il(ol.layout_symbol["text-rotate"]),"text-padding":new nl(ol.layout_symbol["text-padding"]),"text-keep-upright":new nl(ol.layout_symbol["text-keep-upright"]),"text-transform":new il(ol.layout_symbol["text-transform"]),"text-offset":new il(ol.layout_symbol["text-offset"]),"text-allow-overlap":new nl(ol.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new nl(ol.layout_symbol["text-ignore-placement"]),"text-optional":new nl(ol.layout_symbol["text-optional"]),visibility:new nl(ol.layout_symbol.visibility)});var Ky={paint:new rl({"icon-opacity":new il(ol.paint_symbol["icon-opacity"]),"icon-occlusion-opacity":new il(ol.paint_symbol["icon-occlusion-opacity"]),"icon-emissive-strength":new il(ol.paint_symbol["icon-emissive-strength"]),"text-emissive-strength":new il(ol.paint_symbol["text-emissive-strength"]),"icon-color":new il(ol.paint_symbol["icon-color"]),"icon-halo-color":new il(ol.paint_symbol["icon-halo-color"]),"icon-halo-width":new il(ol.paint_symbol["icon-halo-width"]),"icon-halo-blur":new il(ol.paint_symbol["icon-halo-blur"]),"icon-translate":new nl(ol.paint_symbol["icon-translate"]),"icon-translate-anchor":new nl(ol.paint_symbol["icon-translate-anchor"]),"icon-image-cross-fade":new il(ol.paint_symbol["icon-image-cross-fade"]),"text-opacity":new il(ol.paint_symbol["text-opacity"]),"text-occlusion-opacity":new il(ol.paint_symbol["text-occlusion-opacity"]),"text-color":new il(ol.paint_symbol["text-color"],{runtimeType:Ji,getOverride:t=>t.textColor,hasOverride:t=>!!t.textColor}),"text-halo-color":new il(ol.paint_symbol["text-halo-color"]),"text-halo-width":new il(ol.paint_symbol["text-halo-width"]),"text-halo-blur":new il(ol.paint_symbol["text-halo-blur"]),"text-translate":new nl(ol.paint_symbol["text-translate"]),"text-translate-anchor":new nl(ol.paint_symbol["text-translate-anchor"]),"icon-color-saturation":new nl(ol.paint_symbol["icon-color-saturation"]),"icon-color-contrast":new nl(ol.paint_symbol["icon-color-contrast"]),"icon-color-brightness-min":new nl(ol.paint_symbol["icon-color-brightness-min"]),"icon-color-brightness-max":new nl(ol.paint_symbol["icon-color-brightness-max"])}),layout:Xy};class Qy{constructor(t){this.type=t.property.overrides?t.property.overrides.runtimeType:Yi,this.defaultValue=t}evaluate(t){if(t.formattedSection){const e=this.defaultValue.property.overrides;if(e&&e.hasOverride(t.formattedSection))return e.getOverride(t.formattedSection)}return t.feature&&t.featureState?this.defaultValue.evaluate(t.feature,t.featureState):this.defaultValue.property.specification.default}eachChild(t){this.defaultValue.isConstant()||t(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}bs(Qy,"FormatSectionOverride",{omit:["defaultValue"]});class Jy extends Tl{constructor(e,n,i,a){super(e,Ky,n,i,a),this._colorAdjustmentMatrix=t.ad.identity([]),this.hasInitialOcclusionOpacityProperties=void 0!==e.paint&&("icon-occlusion-opacity"in e.paint||"text-occlusion-opacity"in e.paint)}recalculate(t,e){super.recalculate(t,e),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const n=this.layout.get("text-writing-mode");if(n){const t=[];for(const e of n)t.indexOf(e)<0&&t.push(e);this.layout._values["text-writing-mode"]=t}else this.layout._values["text-writing-mode"]="point"===this.layout.get("symbol-placement")?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getColorAdjustmentMatrix(e,n,i,a){return this._saturation===e&&this._contrast===n&&this._brightnessMin===i&&this._brightnessMax===a||(this._colorAdjustmentMatrix=function(e,n,i,a){e=zn(e),n=Pn(n);const r=t.ad.create(),o=e/3,s=1-2*o,l=[s,o,o,0,o,s,o,0,o,o,s,0,0,0,0,1],c=.5-.5*n,u=a-i;return t.ad.multiply(r,[u,0,0,0,0,u,0,0,0,0,u,0,i,i,i,1],[n,0,0,0,0,n,0,0,0,0,n,0,c,c,c,1]),t.ad.multiply(r,r,l),r}(e,n,i,a),this._saturation=e,this._contrast=n,this._brightnessMin=i,this._brightnessMax=a),this._colorAdjustmentMatrix}getValueAndResolveTokens(t,e,n,i){const a=this.layout.get(t).evaluate(e,{},n,i),r=this._unevaluatedLayout._values[t];return r.isDataDriven()||cs(r.value)||!a?a:function(t,e){return e.replace(/{([^{}]+)}/g,((e,n)=>n in t?String(t[n]):""))}(e.properties,a)}createBucket(t){return new U_(t)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const t of Ky.paint.overridableProperties){if(!Jy.hasPaintOverride(this.layout,t))continue;const e=this.paint.get(t),n=new Qy(e),i=new ls(n,e.property.specification,this.scope,this.options);let a=null;a="constant"===e.value.kind||"source"===e.value.kind?new hs("source",i):new ds("composite",i,e.value.zoomStops,e.value._interpolationType),this.paint._values[t]=new tl(e.property,a,e.parameters)}}_handleOverridablePaintPropertyUpdate(t,e,n){return!(!this.layout||e.isDataDriven()||n.isDataDriven())&&Jy.hasPaintOverride(this.layout,t)}static hasPaintOverride(t,e){const n=t.get("text-field"),i=Ky.paint.properties[e];let a=!1;const r=t=>{for(const e of t)if(i.overrides&&i.overrides.hasOverride(e))return void(a=!0)};if("constant"===n.value.kind&&n.value.value instanceof pa)r(n.value.value.sections);else if("source"===n.value.kind){const t=e=>{a||(e instanceof xa&&_a(e.value)===ia?r(e.value.sections):e instanceof Aa?r(e.sections):e.eachChild(t))},e=n.value;e._styleExpression&&t(e._styleExpression.expression)}return a}getProgramIds(){const t=0!==this.paint.get("icon-opacity").constantOr(1),e=0!==this.paint.get("text-opacity").constantOr(1),n=[];return t&&n.push("symbolIcon"),e&&n.push("symbolSDF"),n}getDefaultProgramParams(t,e,n){return{config:new Zc(this,{zoom:e,lut:n}),overrideFog:!1}}}const tx=new rl({visibility:new nl(ol.layout_background.visibility)});var ex={paint:new rl({"background-color":new nl(ol.paint_background["background-color"]),"background-pattern":new nl(ol.paint_background["background-pattern"]),"background-opacity":new nl(ol.paint_background["background-opacity"]),"background-emissive-strength":new nl(ol.paint_background["background-emissive-strength"])}),layout:tx};const nx=new rl({visibility:new nl(ol.layout_raster.visibility)});var ix={paint:new rl({"raster-opacity":new nl(ol.paint_raster["raster-opacity"]),"raster-color":new al(ol.paint_raster["raster-color"]),"raster-color-mix":new nl(ol.paint_raster["raster-color-mix"]),"raster-color-range":new nl(ol.paint_raster["raster-color-range"]),"raster-hue-rotate":new nl(ol.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new nl(ol.paint_raster["raster-brightness-min"]),"raster-brightness-max":new nl(ol.paint_raster["raster-brightness-max"]),"raster-saturation":new nl(ol.paint_raster["raster-saturation"]),"raster-contrast":new nl(ol.paint_raster["raster-contrast"]),"raster-resampling":new nl(ol.paint_raster["raster-resampling"]),"raster-fade-duration":new nl(ol.paint_raster["raster-fade-duration"]),"raster-emissive-strength":new nl(ol.paint_raster["raster-emissive-strength"]),"raster-array-band":new nl(ol.paint_raster["raster-array-band"]),"raster-elevation":new nl(ol.paint_raster["raster-elevation"])}),layout:nx};function ax(e,n,i,a,r,o,s,l){const c=[e,n,1,i,a,1,r,o,1],u=[s,l,1],h=t.bC.adjoint([],c),[d,p,f]=t._.transformMat3(u,u,h);return t.bC.multiply(c,c,[d,0,0,0,p,0,0,0,f])}function rx(e,n,i,a,r,o,s,l){const c=function(e,n,i,a,r,o,s,l){const c=ax(0,0,1,0,1,1,0,1),u=ax(e,n,i,a,r,o,s,l),h=t.bC.adjoint([],c);return t.bC.multiply(u,u,h)}(e,n,i,a,r,o,s,l);return[c[2]/c[8]/ur,c[5]/c[8]/ur]}function ox(t){return[t[0],Math.min(Math.max(t[1],-Pu),Pu)]}class sx extends Bi{constructor(t,e,n,i){super(),this.id=t,this.dispatcher=n,this.coordinates=e.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.onNorthPole=!1,this.onSouthPole=!1,this.setEventedParent(i),this.options=e,this._dirty=!1}load(t,e){if(this._loaded=e||!1,this.fire(new Di("dataloading",{dataType:"source"})),this.url=this.options.url,!this.url)return t&&(this.coordinates=t),this._loaded=!0,void this._finishLoading();this._imageRequest=si(this.map._requestManager.transformRequest(this.url,Qn.Image),((e,n)=>{this._imageRequest=null,this._loaded=!0,e?this.fire(new Li(e)):n&&(this.image=n instanceof HTMLImageElement?Ln.getImageData(n):n,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,t&&(this.coordinates=t),this._finishLoading())}))}loaded(){return this._loaded}updateImage(t){return t.url?(this._imageRequest&&t.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=t.url,this.load(t.coordinates,this._loaded),this):this}setTexture(t){if(!(t.handle instanceof WebGLTexture))throw new Error("The provided handle is not a WebGLTexture instance");return this.texture=new q_(this.map.painter.context,t.handle),this.width=t.dimensions[0],this.height=t.dimensions[1],this._dirty=!1,this._loaded=!0,this._finishLoading(),this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new Di("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(t){this.map=t,this.load()}onRemove(t){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),!this.texture||this.texture instanceof q_||this.texture.destroy(),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy())}setCoordinates(t){if(this.coordinates=t,this._boundsArray=void 0,this._unsupportedCoords=!1,!t.length)return this;this.onNorthPole=!1,this.onSouthPole=!1;let e=t[0][1],n=t[0][1];for(const i of t)i[1]>n&&(n=i[1]),i[1]<e&&(e=i[1]);const i=(n+e)/2;if(i>Pu?this.onNorthPole=!0:i<-Pu&&(this.onSouthPole=!0),!this.onNorthPole&&!this.onSouthPole){const e=t.map(Ou.fromLngLat);this.tileID=function(t){let e=1/0,n=1/0,i=-1/0,a=-1/0;for(const r of t)e=Math.min(e,r.x),n=Math.min(n,r.y),i=Math.max(i,r.x),a=Math.max(a,r.y);const r=Math.max(i-e,a-n),o=Math.max(0,Math.floor(-Math.log(r)/Math.LN2)),s=Math.pow(2,o);let l=Math.floor((e+i)/2*s);return l>1&&(l-=1),new _u(o,l,Math.floor((n+a)/2*s))}(e),this.minzoom=this.maxzoom=this.tileID.z}return this.fire(new Di("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0,this._unsupportedCoords=!1}_prepareData(e){for(const t in this.tiles){const e=this.tiles[t];"loaded"!==e.state&&(e.state="loaded",e.texture=this.texture)}if(this._boundsArray||this.onNorthPole||this.onSouthPole||this._unsupportedCoords)return;const n=e_(new _u(0,0,0),this.map.transform.projection),i=[n.projection.project(this.coordinates[0][0],this.coordinates[0][1]),n.projection.project(this.coordinates[1][0],this.coordinates[1][1]),n.projection.project(this.coordinates[2][0],this.coordinates[2][1]),n.projection.project(this.coordinates[3][0],this.coordinates[3][1])];if(!function(t){const e=t[1].x-t[0].x,n=t[1].y-t[0].y,i=t[2].x-t[1].x,a=t[2].y-t[1].y,r=t[3].x-t[2].x,o=t[3].y-t[2].y,s=t[0].x-t[3].x,l=t[0].y-t[3].y,c=e*a-i*n,u=i*o-r*a,h=r*l-s*o,d=s*n-e*l;return c>0&&u>0&&h>0&&d>0||c<0&&u<0&&h<0&&d<0}(i))return console.warn("Image source coordinates are defining non-convex area in the Mercator projection"),void(this._unsupportedCoords=!0);const a=e_(this.tileID,this.map.transform.projection),[r,o,s,l]=this.coordinates.map((t=>{const e=a.projection.project(t[0],t[1]);return n_(a,e)._round()}));this.perspectiveTransform=rx(r.x,r.y,o.x,o.y,s.x,s.y,l.x,l.y);const c=this._boundsArray=new Ll;c.emplaceBack(r.x,r.y,0,0),c.emplaceBack(o.x,o.y,ur,0),c.emplaceBack(l.x,l.y,0,ur),c.emplaceBack(s.x,s.y,ur,ur),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy()),this.boundsBuffer=e.createVertexBuffer(c,Q_.members),this.boundsSegments=wc.simpleSegment(0,0,4,2);const u=[],h=function(t){return[ox(t[0]),ox(t[1]),ox(t[2]),ox(t[3])]}(this.coordinates),[d,p,f,m]=function(t){let e=t[0][0],n=e,i=t[0][1],a=i;for(let r=1;r<t.length;r++)t[r][0]<e?e=t[r][0]:t[r][0]>n&&(n=t[r][0]),t[r][1]<i?i=t[r][1]:t[r][1]>a&&(a=t[r][1]);return[e,i,n-e,a-i]}(h);{const a=new Ll,[r,o,s,l]=function(t){let e=t[0].x,n=e,i=t[0].y,a=i;for(let r=1;r<t.length;r++)t[r].x<e?e=t[r].x:t[r].x>n&&(n=t[r].x),t[r].y<i?i=t[r].y:t[r].y>a&&(a=t[r].y);return[e,i,n-e,a-i]}(i),c=t=>[(t.x-r)/s,(t.y-o)/l],[h,g,_,y]=i.map(c),x=function(e,n,i,a,r,o,s,l){const c=ax(0,0,1,0,1,1,0,1),u=ax(e,n,i,a,r,o,s,l),h=t.bC.adjoint([],u);return t.bC.multiply(c,c,h)}(h[0],h[1],g[0],g[1],_[0],_[1],y[0],y[1]);this.elevatedGlobePerspectiveTransform=rx(h[0],h[1],g[0],g[1],_[0],_[1],y[0],y[1]);const v=(e,n)=>{u.push(e.lng);const i=Math.round((e.lng-d)/f*ur),r=Math.round((e.lat-p)/m*ur),o=c(n),s=t._.transformMat3([],[o[0],o[1],1],x),l=Math.round(s[0]/s[2]*ur),h=Math.round(s[1]/s[2]*ur);a.emplaceBack(i,r,l,h)},b=i[3].x-i[0].x,w=i[3].y-i[0].y,A=i[2].x-i[1].x,C=i[2].y-i[1].y;for(let t=0;t<65;t++){const e=t/64,a=[i[0].x+e*b,i[0].y+e*w],r=[i[1].x+e*A,i[1].y+e*C],o=r[0]-a[0],s=r[1]-a[1];for(let t=0;t<65;t++){const e=t/64,i={x:a[0]+o*e,y:a[1]+s*e,z:0};v(n.projection.unproject(i.x,i.y),i)}}this.elevatedGlobeVertexBuffer=e.createVertexBuffer(a,Q_.members)}{this.maxLongitudeTriangleSize=0;let t=[],n=new Kl;const i=(e,i,a)=>{n.emplaceBack(e,i,a);const r=u[e],o=u[i],s=u[a],l=Math.min(Math.min(r,o),s),c=Math.max(Math.max(r,o),s)-l;c>this.maxLongitudeTriangleSize&&(this.maxLongitudeTriangleSize=c),t.push(l+c/2)};for(let t=0;t<64;t++)for(let e=0;e<64;e++){const n=65*t+e,a=n+1,r=n+65,o=r+1;i(n,r,a),i(a,r,o)}[t,n]=function(t,e){const n=Array.from({length:t.length},((t,e)=>e));n.sort(((e,n)=>t[e]-t[n]));const i=[],a=new Kl;for(let r=0;r<n.length;r++){const o=n[r];i.push(t[o]);const s=3*o,l=s+1;a.emplaceBack(e.uint16[s],e.uint16[l],e.uint16[l+1])}return[i,a]}(t,n),this.elevatedGlobeTrianglesCenterLongitudes=t,this.elevatedGlobeIndexBuffer=e.createIndexBuffer(n)}this.elevatedGlobeSegments=wc.simpleSegment(0,0,4225,8192),this.elevatedGlobeGridMatrix=new Float32Array([0,f/ur,0,m/ur,0,0,p,d,0])}prepare(){const t=0!==Object.keys(this.tiles).length;if(this.tileID&&!t)return;const e=this.map.painter.context,n=e.gl;!this._dirty||this.texture instanceof q_||(this.texture?this.texture.update(this.image):(this.texture=new G_(e,this.image,n.RGBA),this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE)),this._dirty=!1),t&&this._prepareData(e)}loadTile(t,e){this.tileID&&this.tileID.equals(t.tileID.canonical)?(this.tiles[String(t.tileID.wrap)]=t,t.buckets={},e(null)):(t.state="errored",e(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}getSegmentsForLongitude(t){const e=this.elevatedGlobeSegments;if(!this.elevatedGlobeTrianglesCenterLongitudes||!e)return null;const n=this.elevatedGlobeTrianglesCenterLongitudes;let i=(a=t+180)+360*Math.round((n[0]-a)/360);var a;const r=new wc,o=(t,n)=>{r.segments.push({vertexOffset:0,primitiveOffset:t,vertexLength:e.segments[0].vertexLength,primitiveLength:n,sortKey:void 0,vaos:{}})},s=.51*this.maxLongitudeTriangleSize;if(Math.abs(n[0]-i)<=s){const t=In(n,0,n.length,i+s);return t===n.length||o(t,kn(n,t+1,n.length,i+360-s)-t),r}i<n[0]&&(i+=360);const l=kn(n,0,n.length,i-s);if(l===n.length)return o(0,n.length),r;o(0,l-0);const c=In(n,l+1,n.length,i+s);return c!==n.length&&o(c,n.length-c),r}}const lx=(Math.pow(256,2)-1)/16907520;class cx extends Tl{constructor(t,e,n,i){super(t,ix,e,n,i),this.updateColorRamp(),this._curRampRange=[NaN,NaN]}getProgramIds(){return["raster"]}hasColorMap(){return!!this._transitionablePaint._values["raster-color"].value.value}tileCoverLift(){return this.paint.get("raster-elevation")}isDraped(t){return!(t&&t._source instanceof sx&&(t._source.onNorthPole||t._source.onSouthPole))&&0===this.paint.get("raster-elevation")}_handleSpecialPaintPropertyUpdate(t){"raster-color"!==t&&"raster-color-range"!==t||(this._curRampRange=[NaN,NaN],this.updateColorRamp())}updateColorRamp(t){if(!this.hasColorMap())return;if(!this._curRampRange)return;const e=this._transitionablePaint._values["raster-color"].value.expression,[n,i]=t||this._transitionablePaint._values["raster-color-range"].value.expression.evaluate({zoom:0})||[NaN,NaN];isNaN(n)&&isNaN(i)||n===this._curRampRange[0]&&i===this._curRampRange[1]||(this.colorRamp=md({expression:e,evaluationKey:"rasterValue",image:this.colorRamp,clips:[{start:n,end:i}],resolution:256}),this.colorRampTexture=null,this._curRampRange=[n,i])}}const ux=new rl({visibility:new nl(ol["layout_raster-particle"].visibility)});var hx={paint:new rl({"raster-particle-array-band":new nl(ol["paint_raster-particle"]["raster-particle-array-band"]),"raster-particle-count":new nl(ol["paint_raster-particle"]["raster-particle-count"]),"raster-particle-color":new al(ol["paint_raster-particle"]["raster-particle-color"]),"raster-particle-max-speed":new nl(ol["paint_raster-particle"]["raster-particle-max-speed"]),"raster-particle-speed-factor":new nl(ol["paint_raster-particle"]["raster-particle-speed-factor"]),"raster-particle-fade-opacity-factor":new nl(ol["paint_raster-particle"]["raster-particle-fade-opacity-factor"]),"raster-particle-reset-rate-factor":new nl(ol["paint_raster-particle"]["raster-particle-reset-rate-factor"])}),layout:ux};class dx extends Tl{constructor(t,e,n,i){super(t,hx,e,n,i),this._updateColorRamp(),this.lastInvalidatedAt=Ln.now()}onRemove(t){this.colorRampTexture&&this.colorRampTexture.destroy(),this.tileFramebuffer&&this.tileFramebuffer.destroy(),this.particleFramebuffer&&this.particleFramebuffer.destroy()}hasColorMap(){return!!this._transitionablePaint._values["raster-particle-color"].value.value}getProgramIds(){return["rasterParticle"]}hasOffscreenPass(){return"none"!==this.visibility}isDraped(t){return!1}_handleSpecialPaintPropertyUpdate(t){"raster-particle-color"!==t&&"raster-particle-max-speed"!==t||(this._updateColorRamp(),this._invalidateAnimationState()),"raster-particle-count"===t&&this._invalidateAnimationState()}_updateColorRamp(){if(!this.hasColorMap())return;const t=this._transitionablePaint._values["raster-particle-color"].value.expression,e=this._transitionablePaint._values["raster-particle-max-speed"].value.expression.evaluate({zoom:0});this.colorRamp=md({expression:t,evaluationKey:"rasterParticleSpeed",image:this.colorRamp,clips:[{start:0,end:e}],resolution:256}),this.colorRampTexture=null}_invalidateAnimationState(){this.lastInvalidatedAt=Ln.now()}}class px extends Tl{constructor(t,e){super(t,{},e,null),this.implementation=t,t.slot&&(this.slot=t.slot)}is3D(){return"3d"===this.implementation.renderingMode}hasOffscreenPass(){return void 0!==this.implementation.prerender}isDraped(t){return void 0!==this.implementation.renderToTile}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(t){this.implementation.onAdd&&this.implementation.onAdd(t,t.painter.context.gl)}onRemove(t){this.implementation.onRemove&&this.implementation.onRemove(t,t.painter.context.gl)}}const fx=new rl({visibility:new nl(ol.layout_sky.visibility)});var mx={paint:new rl({"sky-type":new nl(ol.paint_sky["sky-type"]),"sky-atmosphere-sun":new nl(ol.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new nl(ol.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new nl(ol.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new nl(ol.paint_sky["sky-gradient-radius"]),"sky-gradient":new al(ol.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new nl(ol.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new nl(ol.paint_sky["sky-atmosphere-color"]),"sky-opacity":new nl(ol.paint_sky["sky-opacity"])}),layout:fx};function gx(e,n,i){const a=[0,0,1],r=t.av.identity([]);return t.av.rotateY(r,r,i?-qe(e)+Math.PI:qe(e)),t.av.rotateX(r,r,-qe(n)),t._.transformQuat(a,a,r),t._.normalize(a,a)}var _x={paint:new rl({})};function yx(e,n){const i=vx(e.projection,e.zoom,e.width,e.height),a=function(e,n,i,a,r){const o=new pu(i.lng-180*bx,i.lat),s=new pu(i.lng+180*bx,i.lat),l=e.project(o.lng,o.lat),c=e.project(s.lng,s.lat),u=-Math.atan2(c.y-l.y,c.x-l.x),h=Ou.fromLngLat(i);h.y=Xe(h.y,-1+bx,1-bx);const d=h.toLngLat(),p=e.project(d.lng,d.lat),f=Ou.fromLngLat(d);f.x+=bx;const m=f.toLngLat(),g=e.project(m.lng,m.lat),_=Ax(g.x-p.x,g.y-p.y,u),y=Ou.fromLngLat(d);y.y+=bx;const x=y.toLngLat(),v=e.project(x.lng,x.lat),b=Ax(v.x-p.x,v.y-p.y,u),w=Math.abs(_.x)/Math.abs(b.y),A=t.ad.identity([]);t.ad.rotateZ(A,A,-u*(1-(r?0:a)));const C=t.ad.identity([]);return t.ad.scale(C,C,[1,1-(1-w)*a,1]),C[4]=-b.x/b.y*a,t.ad.rotateZ(C,C,u),t.ad.multiply(C,A,C),C}(e.projection,0,e.center,i,n),r=xx(e);return t.ad.scale(a,a,[r,r,1]),a}function xx(t){const e=t.projection,n=vx(t.projection,t.zoom,t.width,t.height),i=wx(e,t.center),a=wx(e,pu.convert(e.center));return Math.pow(2,i*n+(1-n)*a)}function vx(t,e,n,i,a=1/0){const r=t.range;if(!r)return 0;const o=Math.min(a,Math.max(n,i)),s=Math.log(o/1024)/Math.LN2;return Ke(r[0]+s,r[1]+s,e)}const bx=1/4e4;function wx(t,e){const n=Xe(e.lat,-Pu,Pu),i=new pu(e.lng-180*bx,n),a=new pu(e.lng+180*bx,n),r=t.project(i.lng,n),o=t.project(a.lng,n),s=Ou.fromLngLat(i),l=Ou.fromLngLat(a),c=o.x-r.x,u=o.y-r.y,h=l.x-s.x,d=l.y-s.y,p=Math.sqrt((h*h+d*d)/(c*c+u*u));return Math.log(p)/Math.LN2}function Ax(t,e,n){const i=Math.cos(n),a=Math.sin(n);return{x:t*i-e*a,y:t*a+e*i}}function Cx(e,n,i){t.ad.identity(e),t.ad.rotateZ(e,e,qe(n[2])),t.ad.rotateX(e,e,qe(n[0])),t.ad.rotateY(e,e,qe(n[1])),t.ad.scale(e,e,i),t.ad.multiply(e,e,[1,0,0,0,0,0,1,0,0,1,0,0,0,0,0,1])}function Ex(e,n,i,a,r,o,s,l){const c=[i[0]-n[0],i[1]-n[1],0],u=[a[0]-n[0],a[1]-n[1],0];if(t._.length(c)<1e-12||t._.length(u)<1e-12)return t.av.identity(e);const h=t._.cross([],c,u);t._.normalize(h,h),t._.subtract(u,a,n),c[2]=(o-r)*l,u[2]=(s-r)*l;const d=c;return t._.cross(d,c,u),t._.normalize(d,d),t.av.rotationTo(e,h,d)}function Tx(e,n,i=!1){const a=Hh(n.zoom),r=function(e,n,i){const a=n.worldSize,r=[e[12],e[13],e[14]],o=ku(r[1]/a),s=Mu(r[0]/a),l=t.ad.identity([]),c=Su(1,o)*a,u=Su(1,0)*a*Du(o,n.zoom),h=1/qh(a);let d=u*h;if(i){const t=vx(n.projection,n.zoom,n.width,n.height,1024);d=h*n.projection.pixelSpaceConversion(n.center.lat,a,t)}const p=uu(o,s);t._.add(p,p,t._.scale([],t._.normalize([],p),c*d*r[2]));const f=function(e){const n=[e[0],e[1],e[2]];let i=[0,1,0];const a=t._.cross([],i,n);return t._.cross(i,n,a),0===t._.squaredLength(i)&&(i=[0,1,0],t._.cross(a,n,i)),t._.normalize(a,a),t._.normalize(i,i),t._.normalize(n,n),[a[0],a[1],a[2],0,i[0],i[1],i[2],0,n[0],n[1],n[2],0,e[0],e[1],e[2],1]}(p);t.ad.scale(l,l,[d,d,d*c]),t.ad.translate(l,l,[-r[0],-r[1],-r[2]]);const m=t.ad.multiply([],n.globeMatrix,f);return t.ad.multiply(m,m,l),t.ad.multiply(m,m,e),m}(e,n,i);if(a>0){const i=function(e,n){const i=n.worldSize,a=Su(1,0)*i*Du(n.center.lat,n.zoom)/qh(i),r=Su(1,n.center.lat)*i,o=t.ad.identity([]);return t.ad.rotateY(o,o,qe(n.center.lng)),t.ad.rotateX(o,o,qe(n.center.lat)),t.ad.translate(o,o,[0,0,eu]),t.ad.scale(o,o,[a,a,a*r]),t.ad.translate(o,o,[n.point.x-.5*i,n.point.y-.5*i,0]),t.ad.multiply(o,o,e),t.ad.multiply(o,n.globeMatrix,o)}(e,n);return function(e,n,i){const a=(e,n,i)=>{const a=t._.length(e),r=t._.length(n),o=Dh(e,n,i);return t._.scale(o,o,1/t._.length(o)*Gi(a,r,i))},r=a([e[0],e[1],e[2]],[n[0],n[1],n[2]],i),o=a([e[4],e[5],e[6]],[n[4],n[5],n[6]],i),s=a([e[8],e[9],e[10]],[n[8],n[9],n[10]],i),l=Dh([e[12],e[13],e[14]],[n[12],n[13],n[14]],i);return[r[0],r[1],r[2],0,o[0],o[1],o[2],0,s[0],s[1],s[2],0,l[0],l[1],l[2],1]}(r,i,a)}return r}function Sx(t,e,n,i){const a=wh.projectAabbCorners(i,n);let r=Number.MAX_VALUE,o=-1;for(let t=0;t<a.length;++t){const n=a[t];n[0]=(.5*n[0]+.5)*e.width,n[1]=(.5-.5*n[1])*e.height,n[2]<r&&(o=t,r=n[2])}const s=t=>new Ve(a[t][0],a[t][1]);let l;switch(o){case 0:case 6:l=[s(1),s(5),s(4),s(7),s(3),s(2),s(1)];break;case 1:case 7:l=[s(0),s(4),s(5),s(6),s(2),s(3),s(0)];break;case 3:case 5:l=[s(1),s(0),s(4),s(7),s(6),s(2),s(1)];break;default:l=[s(1),s(5),s(6),s(7),s(3),s(0),s(1)]}if(Yu(t,l))return r}const Mx=Il([{name:"a_pos_3f",components:3,type:"Float32"}]),kx=Il([{name:"a_color_3f",components:3,type:"Float32"}]),Ix=Il([{name:"a_color_4f",components:4,type:"Float32"}]),Px=Il([{name:"a_uv_2f",components:2,type:"Float32"}]),zx=Il([{name:"a_normal_3f",components:3,type:"Float32"}]),Dx=Il([{name:"a_normal_matrix0",components:4,type:"Float32"},{name:"a_normal_matrix1",components:4,type:"Float32"},{name:"a_normal_matrix2",components:4,type:"Float32"},{name:"a_normal_matrix3",components:4,type:"Float32"}]),Lx=Il([{name:"a_pbr",components:4,type:"Uint16"},{name:"a_heightBasedEmissiveStrength",components:3,type:"Float32"}]);class Bx{constructor(t,e,n,i){this.message=(t?`${t}: `:"")+n,i&&(this.identifier=i),null!=e&&e.__line__&&(this.line=e.__line__)}}function Ox(t,e){const n=-1===t.indexOf("://");try{return new URL(t,n&&e?"http://example.com":void 0),!0}catch(t){return!1}}class Rx{constructor(t,e){this.feature=t,this.instancedDataOffset=e,this.instancedDataCount=0,this.rotation=[0,0,0],this.scale=[1,1,1],this.translation=[0,0,0]}}class Fx{constructor(){this.instancedDataArray=new rc,this.instancesEvaluatedElevation=[],this.features=[],this.idToFeaturesIndex={}}}class Nx{constructor(t){this.zoom=t.zoom,this.canonical=t.canonical,this.layers=t.layers,this.layerIds=this.layers.map((t=>t.fqid)),this.projection=t.projection,this.index=t.index,this.hasZoomDependentProperties=this.layers[0].isZoomDependent(),this.stateDependentLayerIds=this.layers.filter((t=>t.isStateDependent())).map((t=>t.id)),this.hasPattern=!1,this.instancesPerModel={},this.validForExaggeration=0,this.maxVerticalOffset=0,this.maxScale=0,this.maxHeight=0,this.lookupDim=this.zoom>this.canonical.z?256:this.zoom>15?75:100,this.instanceCount=0,this.terrainElevationMin=0,this.terrainElevationMax=0,this.validForDEMTile={id:null,timestamp:0},this.modelUris=[],this.modelsRequested=!1,this.activeReplacements=[],this.replacementUpdateTime=0}updateFootprints(t,e){}populate(t,e,n,i){this.tileToMeter=Bu(n);const a=this.layers[0]._featureFilter.needGeometry;this.lookup=new Uint8Array(this.lookupDim*this.lookupDim);for(const{feature:r,id:o,index:s,sourceLayerIndex:l}of t){const t=null!=o?o:r.properties&&r.properties.hasOwnProperty("id")?r.properties.id:void 0,c=$u(r,a);if(!this.layers[0]._featureFilter.filter(new Hs(this.zoom),c,n))continue;const u={id:t,sourceLayerIndex:l,index:s,geometry:a?c.geometry:qu(r,n,i),properties:r.properties,type:r.type,patterns:{}},h=this.addFeature(u,u.geometry,c);h&&e.featureIndex.insert(r,u.geometry,s,l,this.index,this.instancesPerModel[h].instancedDataArray.length,ur/32)}this.lookup=null}update(t,e,n,i){for(const e in this.instancesPerModel){const n=this.instancesPerModel[e];for(const e in t)n.idToFeaturesIndex.hasOwnProperty(e)&&(this.evaluate(n.features[n.idToFeaturesIndex[e]],t[e],n,!0),this.uploaded=!1)}this.maxHeight=0}updateZoomBasedPaintProperties(){if(!this.hasZoomDependentProperties)return!1;let e=!1;for(const n in this.instancesPerModel){const i=this.instancesPerModel[n];for(const n of i.features){const a=this.layers[0],r=n.feature,o=this.canonical,s=a.paint.get("model-rotation").evaluate(r,{},o),l=a.paint.get("model-scale").evaluate(r,{},o),c=a.paint.get("model-translation").evaluate(r,{},o);t._.exactEquals(n.rotation,s)&&t._.exactEquals(n.scale,l)&&t._.exactEquals(n.translation,c)||(this.evaluate(n,n.featureStates,i,!0),e=!0)}}return e}updateReplacement(t,e,n){if(e.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=e.updateTime;const i=e.getReplacementRegionsForTile(t.toUnwrapped(),!0);if(Pp(this.activeReplacements,i))return!1;this.activeReplacements=i;let a=!1;for(const e in this.instancesPerModel){const i=this.instancesPerModel[e],r=i.instancedDataArray;for(const e of i.features){const i=e.instancedDataOffset,o=e.instancedDataCount;for(let e=0;e<o;e++){const o=16*(e+i);let s=r.float32[o+0];s=s>ur?s-ur:s;const l=Math.floor(s),c=r.float32[o+1];let u=!1;for(const e of this.activeReplacements)if(!(e.order<n||e.order===1/0)&&e.clipMask&Kp.Model&&!(e.min.x>l||l>e.max.x||e.min.y>c||c>e.max.y)&&(u=Rp(Op(l,c,t.canonical,e.footprintTileId.canonical),e),u))break;r.float32[o]=u?s+ur:s,a=a||u}}}return a}isEmpty(){for(const t in this.instancesPerModel)if(0!==this.instancesPerModel[t].instancedDataArray.length)return!1;return!0}uploadPending(){return!this.uploaded}upload(t){if(!this.uploaded)for(const e in this.instancesPerModel){const n=this.instancesPerModel[e];n.instancedDataArray.length<0||0===n.instancedDataArray.length||(n.instancedDataBuffer?n.instancedDataBuffer.updateData(n.instancedDataArray):n.instancedDataBuffer=t.createVertexBuffer(n.instancedDataArray,Dx.members,!0,void 0,this.instanceCount))}this.uploaded=!0}destroy(){for(const t in this.instancesPerModel){const e=this.instancesPerModel[t];0!==e.instancedDataArray.length&&e.instancedDataBuffer&&e.instancedDataBuffer.destroy()}const t=this.layers[0].modelManager;if(t&&this.modelUris)for(const e of this.modelUris)t.removeModel(e,"")}addFeature(t,e,n){const i=this.layers[0],a=i.layout.get("model-id").evaluate(n,{},this.canonical);if(!a)return fn(`modelId is not evaluated for layer ${i.id} and it is not going to get rendered.`),a;Ox(a,!1)&&(this.modelUris.includes(a)||this.modelUris.push(a)),this.instancesPerModel[a]||(this.instancesPerModel[a]=new Fx);const r=this.instancesPerModel[a],o=r.instancedDataArray,s=new Rx(n,o.length);for(const t of e)for(const e of t){if(e.x<0||e.x>=ur||e.y<0||e.y>=ur)continue;const t=(this.lookupDim-1)/ur,n=this.lookupDim*(e.y*t|0)+e.x*t|0;if(this.lookup){if(0!==this.lookup[n])continue;this.lookup[n]=1}this.instanceCount++;const i=o.length;o.resize(i+1),r.instancesEvaluatedElevation.push(0),o.float32[16*i]=e.x,o.float32[16*i+1]=e.y}return s.instancedDataCount=r.instancedDataArray.length-s.instancedDataOffset,s.instancedDataCount>0&&(t.id&&(r.idToFeaturesIndex[t.id]=r.features.length),r.features.push(s),this.evaluate(s,{},r,!1)),a}getModelUris(){return this.modelUris}evaluate(t,e,n,i){const a=this.layers[0],r=t.feature,o=this.canonical,s=t.rotation=a.paint.get("model-rotation").evaluate(r,e,o),l=t.scale=a.paint.get("model-scale").evaluate(r,e,o),c=t.translation=a.paint.get("model-translation").evaluate(r,e,o),u=a.paint.get("model-color").evaluate(r,e,o);u.a=a.paint.get("model-color-mix-intensity").evaluate(r,e,o);const h=[];this.maxVerticalOffset<c[2]&&(this.maxVerticalOffset=c[2]),this.maxScale=Math.max(Math.max(this.maxScale,l[0]),Math.max(l[1],l[2])),Cx(h,s,l);const d=Math.round(100*u.a)+u.b/1.05;for(let e=0;e<t.instancedDataCount;++e){const a=t.instancedDataOffset+e,r=16*a,s=n.instancedDataArray.float32;let l=0;i&&(l=s[r+6]-n.instancesEvaluatedElevation[a]);const p=0|s[r+1];s[r]=(0|s[r])+u.r/1.05,s[r+1]=p+u.g/1.05,s[r+2]=d,s[r+3]=1/(o.z>10?this.tileToMeter:Bu(o,p)),s[r+4]=c[0],s[r+5]=c[1],s[r+6]=c[2]+l,s[r+7]=h[0],s[r+8]=h[1],s[r+9]=h[2],s[r+10]=h[4],s[r+11]=h[5],s[r+12]=h[6],s[r+13]=h[8],s[r+14]=h[9],s[r+15]=h[10],n.instancesEvaluatedElevation[a]=c[2]}}}bs(Nx,"ModelBucket",{omit:["layers"]}),bs(Fx,"PerModelAttributes"),bs(Rx,"ModelFeature");const jx=new rl({visibility:new nl(ol.layout_model.visibility),"model-id":new il(ol.layout_model["model-id"])});var Vx={paint:new rl({"model-opacity":new nl(ol.paint_model["model-opacity"]),"model-rotation":new il(ol.paint_model["model-rotation"]),"model-scale":new il(ol.paint_model["model-scale"]),"model-translation":new il(ol.paint_model["model-translation"]),"model-color":new il(ol.paint_model["model-color"]),"model-color-mix-intensity":new il(ol.paint_model["model-color-mix-intensity"]),"model-type":new nl(ol.paint_model["model-type"]),"model-cast-shadows":new nl(ol.paint_model["model-cast-shadows"]),"model-receive-shadows":new nl(ol.paint_model["model-receive-shadows"]),"model-ambient-occlusion-intensity":new nl(ol.paint_model["model-ambient-occlusion-intensity"]),"model-emissive-strength":new il(ol.paint_model["model-emissive-strength"]),"model-roughness":new il(ol.paint_model["model-roughness"]),"model-height-based-emissive-strength-multiplier":new il(ol.paint_model["model-height-based-emissive-strength-multiplier"]),"model-cutoff-fade-range":new nl(ol.paint_model["model-cutoff-fade-range"]),"model-front-cutoff":new nl(ol.paint_model["model-front-cutoff"])}),layout:jx};const Ux=64,Gx={CoordinateSpaceTile:1,CoordinateSpaceYUp:2,HasMapboxMeshFeatures:4,HasMeshoptCompression:8};function qx(e,n,i,a,r,o,s,l,c,u=!1){const h=i.zoom,d=i.project(a),p=Du(a.lat,h),f=1/p;t.ad.identity(e),t.ad.translate(e,e,[d.x+s[0]*f,d.y+s[1]*f,s[2]]);let m=1,g=1;const _=i.worldSize;if(u){if("mercator"===i.projection.name){let e=0;i.elevation&&(e=i.elevation.getAtPointOrZero(new Ou(d.x/_,d.y/_),0));const n=t.aA.transformMat4([],[d.x,d.y,e,1],i.projMatrix)[3]/i.cameraToCenterDistance;m=n,g=n*Du(i.center.lat,h)}else if("globe"===i.projection.name){const n=Tx(e,i),r=t.ad.multiply([],i.projMatrix,n),o=[0,0,0,1];t.aA.transformMat4(o,o,r);const s=o[3]/i.cameraToCenterDistance,l=Hh(h),c=i.projection.pixelsPerMeter(a.lat,_)*Du(a.lat,h),u=i.projection.pixelsPerMeter(i.center.lat,_)*Du(i.center.lat,h);m=s/Gi(c,zu(i.center.lat),l),g=s*p/c,m*=u,g*=u}}else m=f;t.ad.scale(e,e,[m,m,g]);const y=[...e],x=n.orientation,v=[];if(Cx(v,[x[0]+r[0],x[1]+r[1],x[2]+r[2]],o),t.ad.multiply(e,y,v),l&&i.elevation){let r=0;const o=[];if(c&&i.elevation){r=function(e,n,i,a,r){const o=n.elevation;if(!o)return 0;const s=wh.projectAabbCorners(i,a),l=Su(1,r.lat)*n.worldSize,c=function(e,n){const i=[0,0,1],a=[{corners:[0,1,3,2],dotProductWithUp:0},{corners:[1,5,2,6],dotProductWithUp:0},{corners:[0,4,1,5],dotProductWithUp:0},{corners:[2,6,3,7],dotProductWithUp:0},{corners:[4,7,5,6],dotProductWithUp:0},{corners:[0,3,4,7],dotProductWithUp:0}];for(const r of a){const a=e[r.corners[0]],o=e[r.corners[1]],s=e[r.corners[2]],l=[o[0]-a[0],o[1]-a[1],n*(o[2]-a[2])],c=t._.cross(l,l,[s[0]-a[0],s[1]-a[1],n*(s[2]-a[2])]);t._.normalize(c,c),r.dotProductWithUp=t._.dot(c,i)}return a.sort(((t,e)=>t.dotProductWithUp-e.dotProductWithUp)),a[0].corners}(s,l),u=s[c[0]],h=s[c[1]],d=s[c[2]],p=s[c[3]],f=o.getAtPointOrZero(new Ou(u[0]/n.worldSize,u[1]/n.worldSize),0),m=o.getAtPointOrZero(new Ou(h[0]/n.worldSize,h[1]/n.worldSize),0),g=o.getAtPointOrZero(new Ou(d[0]/n.worldSize,d[1]/n.worldSize),0),_=o.getAtPointOrZero(new Ou(p[0]/n.worldSize,p[1]/n.worldSize),0),y=(f+_)/2,x=(m+g)/2;return y>x?m<g?Ex(e,h,p,u,m,_,f,l):Ex(e,d,u,p,g,f,_,l):f<_?Ex(e,u,h,d,f,m,g,l):Ex(e,p,d,h,_,g,m,l),Math.max(y,x)}(o,i,n.aabb,e,a);const s=t.ad.fromQuat([],o),l=t.ad.multiply([],s,v);t.ad.multiply(e,y,l)}else r=i.elevation.getAtPointOrZero(new Ou(d.x/_,d.y/_),0);0!==r&&(e[14]+=r)}}function $x(t,e,n=!1){t.uploaded||(t.gfxTexture=new G_(e,t.image,n?e.gl.R8:e.gl.RGBA,{useMipmap:t.sampler.minFilter>=e.gl.NEAREST_MIPMAP_NEAREST}),t.uploaded=!0,t.image=null)}function Wx(t,e,n){t.indexBuffer=e.createIndexBuffer(t.indexArray,!1,!0),t.vertexBuffer=e.createVertexBuffer(t.vertexArray,Mx.members,!1,!0),t.normalArray&&(t.normalBuffer=e.createVertexBuffer(t.normalArray,zx.members,!1,!0)),t.texcoordArray&&(t.texcoordBuffer=e.createVertexBuffer(t.texcoordArray,Px.members,!1,!0)),t.colorArray&&(t.colorBuffer=e.createVertexBuffer(t.colorArray,(12===t.colorArray.bytesPerElement?kx:Ix).members,!1,!0)),t.featureArray&&(t.pbrBuffer=e.createVertexBuffer(t.featureArray,Lx.members,!0)),t.segments=wc.simpleSegment(0,0,t.vertexArray.length,t.indexArray.length);const i=t.material;i.pbrMetallicRoughness.baseColorTexture&&$x(i.pbrMetallicRoughness.baseColorTexture,e),i.pbrMetallicRoughness.metallicRoughnessTexture&&$x(i.pbrMetallicRoughness.metallicRoughnessTexture,e),i.normalTexture&&$x(i.normalTexture,e),i.occlusionTexture&&$x(i.occlusionTexture,e,n),i.emissionTexture&&$x(i.emissionTexture,e)}function Hx(t,e,n){if(t.meshes)for(const i of t.meshes)Wx(i,e,n);if(t.children)for(const i of t.children)Hx(i,e,n)}function Zx(t){if(t.meshes)for(const e of t.meshes)e.indexArray.destroy(),e.vertexArray.destroy(),e.colorArray&&e.colorArray.destroy(),e.normalArray&&e.normalArray.destroy(),e.texcoordArray&&e.texcoordArray.destroy(),e.featureArray&&e.featureArray.destroy();if(t.children)for(const e of t.children)Zx(e)}function Yx(t){if(t.meshes)for(const n of t.meshes)n.vertexBuffer&&(n.vertexBuffer.destroy(),n.indexBuffer.destroy(),n.normalBuffer&&n.normalBuffer.destroy(),n.texcoordBuffer&&n.texcoordBuffer.destroy(),n.colorBuffer&&n.colorBuffer.destroy(),n.pbrBuffer&&n.pbrBuffer.destroy(),n.segments.destroy(),n.material&&((e=n.material).pbrMetallicRoughness.baseColorTexture&&e.pbrMetallicRoughness.baseColorTexture.gfxTexture&&e.pbrMetallicRoughness.baseColorTexture.gfxTexture.destroy(),e.pbrMetallicRoughness.metallicRoughnessTexture&&e.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture&&e.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture.destroy(),e.normalTexture&&e.normalTexture.gfxTexture&&e.normalTexture.gfxTexture.destroy(),e.emissionTexture&&e.emissionTexture.gfxTexture&&e.emissionTexture.gfxTexture.destroy(),e.occlusionTexture&&e.occlusionTexture.gfxTexture&&e.occlusionTexture.gfxTexture.destroy()));var e;if(t.children)for(const e of t.children)Yx(e)}class Xx{constructor(t){this._callback=t,this._triggered=!1,"undefined"!=typeof MessageChannel&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout((()=>{this._triggered=!1,this._callback()}),0))}remove(){this._channel=void 0,this._callback=()=>{}}}class Kx{constructor(){this.tasks={},this.taskQueue=[],ln(["process"],this),this.invoker=new Xx(this.process),this.nextId=0}add(t,e){const n=this.nextId++,i=function({type:t,isSymbolTile:e,zoom:n}){return n=n||0,"message"===t?0:"maybePrepare"!==t||e?"parseTile"!==t||e?"parseTile"===t&&e?300-n:"maybePrepare"===t&&e?400-n:500:200-n:100-n}(e);if(0===i){try{t()}finally{}return null}return this.tasks[n]={fn:t,metadata:e,priority:i,id:n},this.taskQueue.push(n),this.invoker.trigger(),{cancel:()=>{delete this.tasks[n]}}}process(){try{if(this.taskQueue=this.taskQueue.filter((t=>!!this.tasks[t])),!this.taskQueue.length)return;const t=this.pick();if(null===t)return;const e=this.tasks[t];if(delete this.tasks[t],this.taskQueue.length&&this.invoker.trigger(),!e)return;e.fn()}finally{}}pick(){let t=null,e=1/0;for(let n=0;n<this.taskQueue.length;n++){const i=this.tasks[this.taskQueue[n]];i.priority<e&&(e=i.priority,t=n)}if(null===t)return null;const n=this.taskQueue[t];return this.taskQueue.splice(t,1),n}remove(){this.invoker.remove()}}class Qx{constructor(t,e,n){this.target=t,this.parent=e,this.mapId=n,this.callbacks={},this.cancelCallbacks={},ln(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.scheduler=new Kx}send(t,e,n,i,a=!1,r){const o=Math.round(1e18*Math.random()).toString(36).substring(0,10);n&&(n.metadata=r,this.callbacks[o]=n);const s=new Set;return this.target.postMessage({id:o,type:t,hasCallback:!!n,targetMapId:i,mustQueue:a,sourceMapId:this.mapId,data:Cs(e,s)},s),{cancel:()=>{n&&delete this.callbacks[o],this.target.postMessage({id:o,type:"<cancel>",targetMapId:i,sourceMapId:this.mapId})}}}receive(t){const e=t.data,n=e.id;if(n&&(!e.targetMapId||this.mapId===e.targetMapId))if("<cancel>"===e.type){const t=this.cancelCallbacks[n];delete this.cancelCallbacks[n],t&&t.cancel()}else if(e.mustQueue||yn()){const t=this.callbacks[n],i=this.scheduler.add((()=>this.processTask(n,e)),t&&t.metadata||{type:"message"});i&&(this.cancelCallbacks[n]=i)}else this.processTask(n,e)}processTask(t,e){if(delete this.cancelCallbacks[t],"<response>"===e.type){const n=this.callbacks[t];delete this.callbacks[t],n&&(e.error?n(Es(e.error)):n(null,Es(e.data)))}else{const n=new Set,i=e.hasCallback?(e,i)=>{this.target.postMessage({id:t,type:"<response>",sourceMapId:this.mapId,error:e?Cs(e):null,data:Cs(i,n)},n)}:t=>{},a=Es(e.data);if(this.parent[e.type])this.parent[e.type](e.sourceMapId,a,i);else if(this.parent.getWorkerSource){const t=e.type.split(".");this.parent.getWorkerSource(e.sourceMapId,t[0],a.source,a.scope)[t[1]](a,i)}else i(new Error(`Could not find function ${e.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}}class Jx{constructor(t,e){this.workerPool=t,this.actors=[],this.currentActor=0,this.id=an();const n=this.workerPool.acquire(this.id);for(let t=0;t<n.length;t++){const i=new Jx.Actor(n[t],e,this.id);i.name=`Worker ${t}`,this.actors.push(i)}this.ready=!1,this.broadcast("checkIfReady",null,(()=>{this.ready=!0}))}broadcast(t,e,n){Je(this.actors,((n,i)=>{n.send(t,e,i)}),n=n||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach((t=>{t.remove()})),this.actors=[],this.workerPool.release(this.id)}}Jx.Actor=Qx;var tv={workerUrl:"",workerClass:null,workerParams:void 0};function ev(){return null!=tv.workerClass?new tv.workerClass:new self.Worker(tv.workerUrl,tv.workerParams)}const nv="mapboxgl_preloaded_worker_pool";class iv{constructor(){this.active={}}acquire(t){if(!this.workers)for(this.workers=[];this.workers.length<iv.workerCount;)this.workers.push(new ev);return this.active[t]=!0,this.workers.slice()}release(t){delete this.active[t],this.workers&&0===this.numActive()&&(this.workers.forEach((t=>{t.terminate()})),this.workers=null)}isPreloaded(){return!!this.active[nv]}numActive(){return Object.keys(this.active).length}}let av;function rv(){return av||(av=new iv),av}iv.workerCount=2;let ov,sv,lv,cv,uv,hv=null;function dv(){return yn()&&self.worker&&self.worker.dracoUrl?self.worker.dracoUrl:sv||i.DRACO_URL}function pv(){if(yn()&&self.worker&&self.worker.meshoptUrl)return self.worker.meshoptUrl;if(cv)return cv;const t=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]);if("object"!=typeof WebAssembly)throw new Error("WebAssembly not supported, cannot instantiate meshoptimizer");return cv=WebAssembly.validate(t)?i.MESHOPT_SIMD_URL:i.MESHOPT_URL,cv}const fv={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},mv={5120:"DT_INT8",5121:"DT_UINT8",5122:"DT_INT16",5123:"DT_UINT16",5125:"DT_UINT32",5126:"DT_FLOAT32"},gv={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16};function _v(t,e,n){const i=n.json.bufferViews.length,a=n.buffers.length;e.bufferView=i,n.json.bufferViews[i]={buffer:a,byteLength:t.byteLength},n.buffers[a]=t}const yv="KHR_draco_mesh_compression";function xv(t,e){const n=t.extensions&&t.extensions[yv];if(!n)return;const i=new lv.Decoder,a=Tv(e,n.bufferView),r=new lv.Mesh;if(!i.DecodeArrayToMesh(a,a.byteLength,r))throw new Error("Failed to decode Draco mesh");const o=e.json.accessors[t.indices],s=fv[o.componentType],l=o.count*s.BYTES_PER_ELEMENT,c=lv._malloc(l);s===Uint16Array?i.GetTrianglesUInt16Array(r,l,c):i.GetTrianglesUInt32Array(r,l,c),_v(lv.memory.buffer.slice(c,c+l),o,e),lv._free(c);for(const a of Object.keys(n.attributes)){const o=i.GetAttributeByUniqueId(r,n.attributes[a]),s=e.json.accessors[t.attributes[a]],l=mv[s.componentType],c=s.count*gv[s.type]*fv[s.componentType].BYTES_PER_ELEMENT,u=lv._malloc(c);i.GetAttributeDataArrayForAllPoints(r,o,lv[l],c,u),_v(lv.memory.buffer.slice(u,u+c),s,e),lv._free(u)}i.destroy(),r.destroy(),delete t.extensions[yv]}const vv="EXT_meshopt_compression";function bv(t,e){if(!t.extensions||!t.extensions[vv])return;const n=t.extensions[vv],i=new Uint8Array(e.buffers[n.buffer],n.byteOffset||0,n.byteLength||0),a=new Uint8Array(n.count*n.byteStride);uv.decodeGltfBuffer(a,n.count,n.byteStride,i,n.mode,n.filter),t.buffer=e.buffers.length,t.byteOffset=0,e.buffers[t.buffer]=a.buffer,delete t.extensions[vv]}const wv=1179937895,Av=new TextDecoder("utf8");function Cv(t,e){return new URL(t,e).href}function Ev(t,e,n,i){return fetch(Cv(t.uri,i)).then((t=>t.arrayBuffer())).then((t=>{e.buffers[n]=t}))}function Tv(t,e){const n=t.json.bufferViews[e];return new Uint8Array(t.buffers[n.buffer],n.byteOffset||0,n.byteLength)}function Sv(t,e,n,i){if(t.uri){const a=Cv(t.uri,i);return fetch(a).then((t=>t.blob())).then((t=>createImageBitmap(t))).then((t=>{e.images[n]=t}))}if(void 0!==t.bufferView){const i=Tv(e,t.bufferView),a=new Blob([i],{type:t.mimeType});return createImageBitmap(a).then((t=>{e.images[n]=t}))}}function Mv(t,e=0,n){const i={json:null,images:[],buffers:[]};if(new Uint32Array(t,e,1)[0]===wv){const n=new Uint32Array(t,e);let a=2;const r=(n[a++]>>2)-3,o=n[a++]>>2;if(a++,i.json=JSON.parse(Av.decode(n.subarray(a,a+o))),a+=o,a<r){const r=n[a++];a++;const o=e+(a<<2);i.buffers[0]=t.slice(o,o+r)}}else i.json=JSON.parse(Av.decode(new Uint8Array(t,e)));const{buffers:a,images:r,meshes:o,extensionsUsed:s,bufferViews:l}=i.json;let c=Promise.resolve();if(a){const t=[];for(let e=0;e<a.length;e++){const r=a[e];r.uri?t.push(Ev(r,i,e,n)):i.buffers[e]||(i.buffers[e]=null)}c=Promise.all(t)}return c.then((()=>{const t=[],e=s&&s.includes(yv),a=s&&s.includes(vv);if(e&&t.push(function(){if(!lv)return ov||(ov=function(t){let e,n=null;function i(){e=new Uint8Array(n.buffer)}function a(){throw new Error("Unexpected Draco error.")}const r={a:{a,d:function(t,n,i){return e.copyWithin(t,n,n+i)},c:function(t){const a=e.length,r=Math.max(t>>>0,Math.ceil(1.2*a)),o=Math.ceil((r-a)/65536);try{return n.grow(o),i(),!0}catch(t){return!1}},b:a}};return(WebAssembly.instantiateStreaming?WebAssembly.instantiateStreaming(t,r):t.then((t=>t.arrayBuffer())).then((t=>WebAssembly.instantiate(t,r)))).then((t=>{const{Rb:a,Qb:r,P:o,T:s,X:l,Ja:c,La:u,Qa:h,Va:d,Wa:p,eb:f,jb:m,f:g,e:_,yb:y,zb:x,Ab:v,Bb:b,Db:w,Gb:A}=t.instance.exports;n=_;const C=(()=>{let t=0,n=0,i=0,o=0;return s=>{i&&(a(o),a(t),n+=i,i=t=0),t||(n+=128,t=r(n));const l=s.length+7&-8;let c=t;l>=n&&(i=l,c=o=r(l));for(let t=0;t<s.length;t++)e[c+t]=s[t];return c}})();return i(),g(),{memory:_,_free:a,_malloc:r,Mesh:class{constructor(){this.ptr=o()}destroy(){s(this.ptr)}},Decoder:class{constructor(){this.ptr=c()}destroy(){m(this.ptr)}DecodeArrayToMesh(t,e,n){const i=C(t),a=u(this.ptr,i,e,n.ptr);return!!l(a)}GetAttributeByUniqueId(t,e){return{ptr:h(this.ptr,t.ptr,e)}}GetTrianglesUInt16Array(t,e,n){d(this.ptr,t.ptr,e,n)}GetTrianglesUInt32Array(t,e,n){p(this.ptr,t.ptr,e,n)}GetAttributeDataArrayForAllPoints(t,e,n,i,a){f(this.ptr,t.ptr,e.ptr,n,i,a)}},DT_INT8:y(),DT_UINT8:x(),DT_INT16:v(),DT_UINT16:b(),DT_UINT32:w(),DT_FLOAT32:A()}}))}(fetch(dv())),ov.then((t=>{lv=t,ov=void 0})))}()),a&&t.push(function(){if(uv)return;const t=function(t){let e;const n=WebAssembly.instantiateStreaming(t,{}).then((t=>{e=t.instance,e.exports.__wasm_call_ctors()})),i={NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},a={ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};return{ready:n,supported:!0,decodeGltfBuffer(t,n,r,o,s,l){!function(t,e,n,i,a,r,o){const s=t.exports.sbrk,l=i+3&-4,c=s(l*a),u=s(r.length),h=new Uint8Array(t.exports.memory.buffer);h.set(r,u);const d=e(c,i,a,u,r.length);if(0===d&&o&&o(c,l,a),n.set(h.subarray(c,c+i*a)),s(c-s(0)),0!==d)throw new Error(`Malformed buffer data: ${d}`)}(e,e.exports[a[s]],t,n,r,o,e.exports[i[l]])}}}(fetch(pv()));return t.ready.then((()=>{uv=t}))}()),r)for(let e=0;e<r.length;e++)t.push(Sv(r[e],i,e,n));return(t.length?Promise.all(t):Promise.resolve()).then((()=>{if(e&&o)for(const{primitives:t}of o)for(const e of t)xv(e,i);if(a&&o&&l)for(const t of l)bv(t,i);return i}))}))}function kv(t,e){const n=t.json.bufferViews[e.bufferView],i=fv[e.componentType];return new i(t.buffers[n.buffer],(e.byteOffset||0)+(n.byteOffset||0),e.count*(n.byteStride&&n.byteStride!==gv[e.type]*i.BYTES_PER_ELEMENT?n.byteStride/i.BYTES_PER_ELEMENT:gv[e.type]))}function Iv(t,e,n,i){const a=fv[e.componentType],r=function(t){switch(t){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:return 1}}(a),o=t.json.bufferViews[e.bufferView],s=o.byteStride?o.byteStride/a.BYTES_PER_ELEMENT:gv[e.type],l=n.float32,c=l.length/n.capacity;for(let t=0,n=0;t<e.count*s;t+=s,n+=c)for(let e=0;e<c;e++)l[n+e]=i[t+e]*r;n._trim()}function Pv(t,e,n){const i=t.indices,a=t.attributes,r={};r.indexArray=new Kl;const o=e.json.accessors[i],s=o.count/3;r.indexArray.reserve(s);const l=kv(e,o);for(let t=0;t<s;t++)r.indexArray.emplaceBack(l[3*t],l[3*t+1],l[3*t+2]);r.indexArray._trim(),r.vertexArray=new Fl;const c=e.json.accessors[a.POSITION];r.vertexArray.reserve(c.count);const u=kv(e,c);for(let t=0;t<c.count;t++)r.vertexArray.emplaceBack(u[3*t],u[3*t+1],u[3*t+2]);if(r.vertexArray._trim(),r.aabb=new wh(c.min,c.max),r.centroid=function(t,e){const n=[0,0,0],i=t.length;if(i>0){for(let a=0;a<i;a++){const i=3*t[a];n[0]+=e[i],n[1]+=e[i+1],n[2]+=e[i+2]}n[0]/=i,n[1]/=i,n[2]/=i}return n}(l,u),void 0!==a.COLOR_0){const t=e.json.accessors[a.COLOR_0],n=gv[t.type],i=kv(e,t);r.colorArray=3===n?new Fl:new Rl,r.colorArray.resize(t.count),Iv(e,t,r.colorArray,i)}if(void 0!==a.NORMAL){r.normalArray=new Fl;const t=e.json.accessors[a.NORMAL];r.normalArray.resize(t.count);const n=kv(e,t);Iv(e,t,r.normalArray,n)}if(void 0!==a.TEXCOORD_0&&n.length>0){r.texcoordArray=new nc;const t=e.json.accessors[a.TEXCOORD_0];r.texcoordArray.resize(t.count);const n=kv(e,t);Iv(e,t,r.texcoordArray,n)}if(void 0!==a._FEATURE_ID_RGBA4444){const t=e.json.accessors[a._FEATURE_ID_RGBA4444];e.json.extensionsUsed&&e.json.extensionsUsed.includes("EXT_meshopt_compression")&&(r.featureData=kv(e,t))}void 0!==a._FEATURE_RGBA4444&&(r.featureData=new Uint32Array(kv(e,e.json.accessors[a._FEATURE_RGBA4444]).buffer));const h=t.material;return r.material=function(t,e){const{emissiveFactor:n=[0,0,0],alphaMode:i="OPAQUE",alphaCutoff:a=.5,normalTexture:r,occlusionTexture:o,emissiveTexture:s,doubleSided:l}=t,{baseColorFactor:c=[1,1,1,1],metallicFactor:u=1,roughnessFactor:h=1,baseColorTexture:d,metallicRoughnessTexture:p}=t.pbrMetallicRoughness||{},f=o?e[o.index]:void 0;if(o&&o.extensions&&o.extensions.KHR_texture_transform&&f){const t=o.extensions.KHR_texture_transform;f.offsetScale=[t.offset[0],t.offset[1],t.scale[0],t.scale[1]]}return{pbrMetallicRoughness:{baseColorFactor:new Vi(...c),metallicFactor:u,roughnessFactor:h,baseColorTexture:d?e[d.index]:void 0,metallicRoughnessTexture:p?e[p.index]:void 0},doubleSided:l,emissiveFactor:n,alphaMode:i,alphaCutoff:a,normalTexture:r?e[r.index]:void 0,occlusionTexture:f,emissionTexture:s?e[s.index]:void 0,defined:void 0===t.defined}}(void 0!==h?e.json.materials[h]:{defined:!1},n),r}function zv(e,n,i){const{matrix:a,rotation:r,translation:o,scale:s,mesh:l,extras:c,children:u}=e,h={};if(h.matrix=a||t.ad.fromRotationTranslationScale([],r||[0,0,0,1],o||[0,0,0],s||[1,1,1]),void 0!==l){h.meshes=i[l];const t=h.anchor=[0,0];for(const e of h.meshes){const{min:n,max:i}=e.aabb;t[0]+=n[0]+i[0],t[1]+=n[1]+i[1]}t[0]=Math.floor(t[0]/h.meshes.length/2),t[1]=Math.floor(t[1]/h.meshes.length/2)}if(c&&(c.id&&(h.id=c.id),c.lights&&(h.lights=function(t){if(!t.length)return[];const e=function(t){const e=atob(t),n=new Uint8Array(e.length);for(let t=0;t<e.length;t++)n[t]=e.codePointAt(t);return n}(t),n=[],i=e.length/24,a=new Uint16Array(e.buffer),r=new Float32Array(e.buffer);for(let t=0;t<i;t++){const e=a[2*t*6]/30,i=a[2*t*6+1]/30,o=a[2*t*6+10]/100,s=r[6*t+1],l=r[6*t+2],c=r[6*t+3],u=r[6*t+4],h=c-s,d=u-l,p=Math.hypot(h,d);n.push({pos:[s+.5*h,l+.5*d,i],normal:[d/p,-h/p,0],width:p,height:e,depth:o,points:[s,l,c,u]})}return n}(c.lights))),u){const t=[];for(const e of u)t.push(zv(n.json.nodes[e],n,i));h.children=t}return h}function Dv(t){if(0===t.vertices.length||0===t.indices.length)return null;const e=new Qd(t.vertices,t.indices,8,256),[n,i]=[e.min.clone(),e.max.clone()];return{vertices:t.vertices,indices:t.indices,grid:e,min:n,max:i}}function Lv(t){if(!t.extras||!t.extras.ground)return null;const e=t.extras.ground;if(!e||!Array.isArray(e)||0===e.length)return null;const n=e[0];if(!n||!Array.isArray(n)||0===n.length)return null;const i=[];for(const t of n){if(!Array.isArray(t)||2!==t.length)continue;const e=t[0],n=t[1];"number"==typeof e&&"number"==typeof n&&i.push(new Ve(e,n))}if(i.length<3)return null;i.length>1&&i[i.length-1].equals(i[0])&&i.pop();let a=0;for(let t=0;t<i.length;t++){const e=i[t],n=i[(t+1)%i.length],r=i[(t+2)%i.length];a+=(e.x-n.x)*(r.y-n.y)-(r.x-n.x)*(e.y-n.y)}a>0&&i.reverse();const r=vd(i.flatMap((t=>[t.x,t.y])),[]);return 0===r.length?null:{vertices:i,indices:r}}function Bv(e,n){const i=[],a=[];let r=0;const o=[];for(const s of e){r=i.length;const e=s.vertexArray.float32,l=s.indexArray.uint16;for(let a=0;a<s.vertexArray.length;a++)o[0]=e[3*a+0],o[1]=e[3*a+1],o[2]=e[3*a+2],t._.transformMat4(o,o,n),i.push(new Ve(o[0],o[1]));for(let t=0;t<3*s.indexArray.length;t++)a.push(l[t]+r)}if(a.length%3!=0)return null;for(let t=0;t<a.length;t+=3){const e=i[a[t+0]],n=i[a[t+1]],r=i[a[t+2]];(e.x-n.x)*(r.y-n.y)-(r.x-n.x)*(e.y-n.y)>0&&([a[t+1],a[t+2]]=[a[t+2],a[t+1]])}return{vertices:i,indices:a}}function Ov(t){const e=function(t,e){const n=[],i=WebGL2RenderingContext;if(t.json.textures)for(const a of t.json.textures){const r={magFilter:i.LINEAR,minFilter:i.NEAREST,wrapS:i.REPEAT,wrapT:i.REPEAT};void 0!==a.sampler&&Object.assign(r,t.json.samplers[a.sampler]),n.push({image:e[a.source],sampler:r,uploaded:!1})}return n}(t,t.images),n=function(t,e){const n=[];for(const i of t.json.meshes){const a=[];for(const n of i.primitives)a.push(Pv(n,t,e));n.push(a)}return n}(t,e),{scenes:i,scene:a,nodes:r}=t.json,o=i?i[a||0].nodes:r,s=[];for(const e of o)s.push(zv(r[e],t,n));return function(t,e,n){const i={},a=new Set;for(let r=0;r<t.length;r++){const t=n[e[r]];if(!t.extras)continue;const o=t.extras["mapbox:footprint:version"],s=t.extras["mapbox:footprint:id"];(o||s)&&a.add(r),"1.0.0"===o&&s&&(i[s]=r)}for(let r=0;r<t.length;r++){if(a.has(r))continue;const o=t[r],s=n[e[r]];if(!s.extras)continue;let l=null;o.id in i&&(l=Bv(t[i[o.id]].meshes,o.matrix)),l||(l=Lv(s)),l&&(o.footprint=Dv(l))}if(a.size>0){const e=Array.from(a.values()).sort(((t,e)=>t-e));for(let n=e.length-1;n>=0;n--)t.splice(e[n],1)}}(s,o,t.json.nodes),s}function Rv(t){t.heightmap=new Float32Array(4096),t.heightmap.fill(-1);const e=t.vertexArray.float32,n=t.aabb.min[0]-1,i=t.aabb.min[1]-1,a=Ux/(t.aabb.max[0]-n+2),r=Ux/(t.aabb.max[1]-i+2);for(let o=0;o<e.length;o+=3){const s=e[o+2],l=(e[o+0]-n)*a|0,c=(e[o+1]-i)*r|0;s>t.heightmap[c*Ux+l]&&(t.heightmap[c*Ux+l]=s)}}function Fv(e,n){const i={};i.indexArray=new Kl,i.indexArray.reserve(4*e.length),i.vertexArray=new Fl,i.vertexArray.reserve(10*e.length),i.colorArray=new Rl,i.vertexArray.reserve(10*e.length);let a=0;for(const r of e){const e=Math.min(10,Math.max(4,1.3*r.height))*n,o=[-r.normal[1],r.normal[0],0],s=Math.min(.29,.1*r.width/r.depth),l=r.width-2*r.depth*n*(s+.01),c=t._.scaleAndAdd([],r.pos,o,l/2),u=t._.scaleAndAdd([],r.pos,o,-l/2),h=[c[0],c[1],c[2]+r.height],d=[u[0],u[1],u[2]+r.height],p=t._.scaleAndAdd([],r.normal,o,s);t._.scale(p,p,e);const f=t._.scaleAndAdd([],r.normal,o,-s);t._.scale(f,f,e),t._.add(p,c,p),t._.add(f,u,f),c[2]+=.1,u[2]+=.1,i.vertexArray.emplaceBack(p[0],p[1],p[2]),i.vertexArray.emplaceBack(f[0],f[1],f[2]),i.vertexArray.emplaceBack(c[0],c[1],c[2]),i.vertexArray.emplaceBack(u[0],u[1],u[2]),i.vertexArray.emplaceBack(h[0],h[1],h[2]),i.vertexArray.emplaceBack(d[0],d[1],d[2]),i.vertexArray.emplaceBack(c[0],c[1],c[2]),i.vertexArray.emplaceBack(u[0],u[1],u[2]),i.vertexArray.emplaceBack(p[0],p[1],p[2]),i.vertexArray.emplaceBack(f[0],f[1],f[2]);const m=l/e/2;i.colorArray.emplaceBack(-m-s,-1,m,.8),i.colorArray.emplaceBack(m+s,-1,m,.8),i.colorArray.emplaceBack(-m,0,m,1.3),i.colorArray.emplaceBack(m,0,m,1.3),i.colorArray.emplaceBack(m+s,-.8,m,.7),i.colorArray.emplaceBack(m+s,-.8,m,.7),i.colorArray.emplaceBack(0,0,m,1.3),i.colorArray.emplaceBack(0,0,m,1.3),i.colorArray.emplaceBack(m+s,-1.2,m,.8),i.colorArray.emplaceBack(m+s,-1.2,m,.8),i.indexArray.emplaceBack(6+a,4+a,8+a),i.indexArray.emplaceBack(7+a,9+a,5+a),i.indexArray.emplaceBack(0+a,1+a,2+a),i.indexArray.emplaceBack(1+a,3+a,2+a),a+=10}const r={defined:!0,emissiveFactor:[0,0,0]},o={};return o.baseColorFactor=Vi.white,r.pbrMetallicRoughness=o,i.material=r,i.aabb=new wh([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),i}const Nv=new Float32Array(262144),jv=new Uint8Array(262144);function Vv(t){let e=0;if(t.meshes)for(const n of t.meshes)e=Math.max(e,n.aabb.max[2]);if(t.children)for(const n of t.children)e=Math.max(e,Vv(n));return e}function Uv(t,e,n){if(t.meshes)for(const i of t.meshes)i.aabb.min[0]!==1/0&&n.insert(e,i.aabb.min[0],i.aabb.min[1],i.aabb.max[0],i.aabb.max[1]);if(t.children)for(const i of t.children)Uv(i,e,n)}const Gv=["","wall","door","roof","window","lamp","logo"];class qv{constructor(t){this.node=t,this.evaluatedRMEA=[[1,0,0,1],[1,0,0,1],[1,0,0,1],[1,0,0,1],[.4,1,0,1],[1,0,0,1],[1,0,0,1]],this.hiddenByReplacement=!1,this.evaluatedScale=[1,1,1],this.evaluatedColor=[],this.emissionHeightBasedParams=[],this.feature={type:"Point",id:t.id,geometry:[],properties:{height:Vv(t)}},this.aabb=this._getLocalBounds()}_getLocalBounds(){if(!this.node.meshes)return new wh([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);if(!this.aabb){let t=0;const e=new wh([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);for(const n of this.node.meshes)this.node.lightMeshIndex!==t&&(n.transformedAabb=wh.applyTransform(n.aabb,this.node.matrix),e.encapsulate(n.transformedAabb)),t++;this.aabb=e}return this.aabb}}class $v{constructor(t,e,n,i,a,r){this.id=e,this.modelTraits|=Gx.CoordinateSpaceTile,this.uploaded=!1,this.hasPattern=!1,n&&(this.modelTraits|=Gx.HasMapboxMeshFeatures),i&&(this.modelTraits|=Gx.HasMeshoptCompression),this.zoom=-1,this.terrainExaggeration=1,this.projection={name:"mercator"},this.replacementUpdateTime=0,this.elevationReadFromZ=255,this.brightness=a,this.dirty=!0,this.needsUpload=!1,this.nodesInfo=[];for(const e of t)this.nodesInfo.push(new qv(e)),Uv(e,r.featureIndexArray.length,r.grid),r.featureIndexArray.emplaceBack(this.nodesInfo.length-1,0,r.bucketLayerIDs.length-1,0)}updateFootprints(t,e){for(const n of this.getNodesInfo()){const i=n.node;i.footprint&&e.push({footprint:i.footprint,id:t})}}update(){console.log("Update 3D model bucket")}populate(){console.log("populate 3D model bucket")}uploadPending(){return!this.uploaded||this.needsUpload}upload(t){if(!this.needsUpload)return;const e=this.getNodesInfo();for(const n of e){const e=n.node;this.uploaded?this.updatePbrBuffer(e):Hx(e,t,!0)}for(const t of e)Zx(t.node);this.uploaded=!0,this.needsUpload=!1}updatePbrBuffer(t){let e=!1;if(!t.meshes)return e;for(const n of t.meshes)n.pbrBuffer&&(n.pbrBuffer.updateData(n.featureArray),e=!0);return e}needsReEvaluation(t,e,n){const i=t.transform.projectionOptions,a=t.style.getBrightness(),r=this.brightness!==a;return!!(!this.uploaded||this.dirty||i.name!==this.projection.name||Wv(n.paint.get("model-color").value,r)||Wv(n.paint.get("model-color-mix-intensity").value,r)||Wv(n.paint.get("model-roughness").value,r)||Wv(n.paint.get("model-emissive-strength").value,r)||Wv(n.paint.get("model-height-based-emissive-strength-multiplier").value,r))&&(this.projection=i,this.brightness=a,!0)}evaluateScale(t,e){if(t.transform.zoom===this.zoom)return;this.zoom=t.transform.zoom;const n=this.getNodesInfo(),i=this.id.canonical;for(const t of n){const n=t.feature;t.evaluatedScale=e.paint.get("model-scale").evaluate(n,{},i)}}evaluate(t){const e=this.getNodesInfo();for(const n of e){if(!n.node.meshes)continue;const e=n.feature,i=n.node.meshes&&n.node.meshes[0].featureData,a=n.evaluatedColor[2],r=n.evaluatedRMEA[2],o=this.id.canonical;if(n.hasTranslucentParts=!1,i){for(let i=0;i<Gv.length;i++){const a=Gv[i];a.length&&(e.properties.part=a);const r=t.paint.get("model-color").evaluate(e,{},o).toRenderColor(null),s=t.paint.get("model-color-mix-intensity").evaluate(e,{},o);n.evaluatedColor[i]=[r.r,r.g,r.b,s],n.evaluatedRMEA[i][0]=t.paint.get("model-roughness").evaluate(e,{},o),n.evaluatedRMEA[i][2]=t.paint.get("model-emissive-strength").evaluate(e,{},o),n.evaluatedRMEA[i][3]=r.a,n.emissionHeightBasedParams[i]=t.paint.get("model-height-based-emissive-strength-multiplier").evaluate(e,{},o),!n.hasTranslucentParts&&r.a<1&&(n.hasTranslucentParts=!0)}delete e.properties.part,Zv(n,a!==n.evaluatedColor[2]||r!==n.evaluatedRMEA[2],this.modelTraits)}else n.evaluatedRMEA[0][2]=t.paint.get("model-emissive-strength").evaluate(e,{},o);n.evaluatedScale=t.paint.get("model-scale").evaluate(e,{},o),this.updatePbrBuffer(n.node)||(this.needsUpload=!0)}this.dirty=!1}elevationUpdate(t,e,n,i){const a=t.findDEMTileFor(n);if(a&&(a.tileID.canonical!==this.terrainTile||e!==this.terrainExaggeration)){if(a.dem&&a.tileID.overscaledZ!==this.elevationReadFromZ){this.elevationReadFromZ=a.tileID.overscaledZ;const e=Xp.create(t,n,a);if(!e)return;this.modelTraits&Gx.HasMapboxMeshFeatures&&this.updateDEM(t,e,n,i);for(const t of this.getNodesInfo()){const n=t.node;if(!n.footprint||!n.footprint.vertices||!n.footprint.vertices.length)continue;const i=n.footprint.vertices;let a=e.getElevationAt(i[0].x,i[0].y,!0,!0);for(let t=1;t<i.length;t++)a=Math.min(a,e.getElevationAt(i[t].x,i[t].y,!0,!0));n.elevation=a}}this.terrainTile=a.tileID.canonical,this.terrainExaggeration=e}}updateDEM(t,e,n,i){let a=e._dem._modifiedForSources[i];if(void 0===a&&(e._dem._modifiedForSources[i]=[],a=e._dem._modifiedForSources[i]),a.includes(n.canonical))return;const r=e._dem.dim;a.push(n.canonical);let o=!1;for(const t of this.getNodesInfo()){const n=t.node;if(!n.footprint||!n.footprint.grid)continue;const i=n.footprint.grid,a=e.tileCoordToPixel(i.min.x,i.min.y),s=e.tileCoordToPixel(i.max.x,i.max.y),l=Math.min(Math.min(r-s.y,a.x),Math.min(a.y,r-s.x));if(l<0)continue;const c=Xe(l,2,5);let u=Math.max(0,a.x-c),h=Math.max(0,a.y-c),d=Math.min(s.x+c,r-1),p=Math.min(s.y+c,r-1);for(let t=h;t<=p;++t)for(let e=u;e<=d;++e)jv[t*r+e]=255;let f=0,m=0;for(let t=0;t<i.cellsY;++t)for(let n=0;n<i.cellsX;++n){if(!i.cells[t*i.cellsX+n])continue;const a=e.tileCoordToPixel(i.min.x+n/i.xScale,i.min.y+t/i.yScale),o=e.tileCoordToPixel(i.min.x+(n+1)/i.xScale,i.min.y+(t+1)/i.yScale);for(let t=a.y;t<=Math.min(o.y+1,r-1);++t)for(let n=a.x;n<=Math.min(o.x+1,r-1);++n)255===jv[t*r+n]&&(jv[t*r+n]=0,f+=e.getElevationAtPixel(n,t),m++)}const g=f/m;u=Math.max(1,a.x-c),h=Math.max(1,a.y-c),d=Math.min(s.x+c,r-2),p=Math.min(s.y+c,r-2),o=!0;for(let t=h;t<=p;++t)for(let n=u;n<=d;++n)0===jv[t*r+n]&&(Nv[t*r+n]=e._dem.set(n,t,g));for(let t=1;t<c;++t){u=Math.max(1,a.x-t),h=Math.max(1,a.y-t),d=Math.min(s.x+t,r-2),p=Math.min(s.y+t,r-2);for(let n=h;n<=p;++n)for(let i=u;i<=d;++i){const a=n*r+i;if(255===jv[a]){let o=0,s=0,l=-1,u=-1;for(let e=-1;e<=1;++e)for(let a=-1;a<=1;++a){const c=(n+e)*r+i+a;if(jv[c]>=t)continue;const h=Nv[c],d=Math.abs(h);d>s&&(o=h,s=d,l=a,u=e)}if(s>.1){const r=1-(t+.5*Math.abs(l*u))/c;let s=e._dem.get(i,n)+o*r;const h=e._dem.get(i+l,n+u),d=e._dem.get(i-l,n-u,!0);(s-h)*(s-d)>0&&(s=(h+d)/2),Nv[a]=e._dem.set(i,n,s),jv[a]=t}}}}}o&&(e._demTile.needsDEMTextureUpload=!0,e._dem._timestamp=Ln.now())}getNodesInfo(){return this.nodesInfo}destroy(){const t=this.getNodesInfo();for(const e of t)Zx(e.node),Yx(e.node)}isEmpty(){return!this.nodesInfo.length}updateReplacement(t,e){if(e.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=e.updateTime;const n=e.getReplacementRegionsForTile(t.toUnwrapped()),i=this.getNodesInfo();for(let t=0;t<this.nodesInfo.length;t++){const e=i[t].node;i[t].hiddenByReplacement=!!e.footprint&&!n.find((t=>t.footprint===e.footprint))}}getHeightAtTileCoord(e,n){const i=this.getNodesInfo(),a=[],r=[0,0,0],o=t.ad.identity([]);for(let s=0;s<this.nodesInfo.length;s++){const l=i[s],c=l.node.meshes[0],u=c.transformedAabb;if(e<u.min[0]||n<u.min[1]||e>u.max[0]||n>u.max[1])continue;if(!0===l.node.hidden)return{height:0,maxHeight:l.feature.properties.height,hidden:!1,verticalScale:l.evaluatedScale[2]};t.ad.invert(o,l.node.matrix),r[0]=e,r[1]=n,t._.transformMat4(r,r,o);const h=(r[0]-c.aabb.min[0])/(c.aabb.max[0]-c.aabb.min[0])*Ux|0,d=Math.min(63,(r[1]-c.aabb.min[1])/(c.aabb.max[1]-c.aabb.min[1])*Ux|0)*Ux+Math.min(63,h),p=c.heightmap[d];if(!(p<0&&l.node.footprint)){if(l.hiddenByReplacement)return;return{height:p,maxHeight:l.feature.properties.height,hidden:!1,verticalScale:l.evaluatedScale[2]}}if(l.node.footprint.grid.query(new Ve(e,n),new Ve(e,n),a),a.length>0)return{height:void 0,maxHeight:l.feature.properties.height,hidden:l.hiddenByReplacement,verticalScale:l.evaluatedScale[2]}}}}function Wv(t,e){return!t.isLightConstant&&e}function Hv(t,e,n,i,a,r,o,s){let l=(61440&e|(61440&e)>>4)>>8,c=(3840&e|(3840&e)>>4)>>4,u=240&e|(240&e)>>4;n[3]>0&&(l=Gi(l,255*n[0],n[3]),c=Gi(c,255*n[1],n[3]),u=Gi(u,255*n[2],n[3]));const h=l<<8|c,d=u<<8|Math.floor(255*i[3]),p=function(t){const e=Xe(t,0,2);return Math.min(Math.round(.5*e*255),255)}(i[2])<<8|15*i[0]<<4|15*i[1],f=Xe(a[0],0,1),m=Xe(a[1],0,1),g=Xe(a[2],0,1),_=Xe(a[3],0,1);let y,x,v,b;if(f!==m&&o!==r&&m!==f){const t=o-r;x=1/(t*(m-f)),v=-(r+t*f)/(t*(m-f));const e=Xe(a[4],-1,1);b=Math.pow(10,e),y=255*g<<8|255*_}else y=65535,x=0,v=1,b=1;if(t.emplaceBack(h,d,p,y,x,v,b),s){const t=s.length;s.clear();for(let e=0;e<t;e++)s.emplaceBack(h,d,p,y,x,v,b)}}function Zv(t,e,n){const i=t.node;let a=0;const r=n&Gx.HasMeshoptCompression;for(const n of i.meshes){if(i.lights&&i.lightMeshIndex===a)continue;if(!n.featureData)continue;n.featureArray=new oc,n.featureArray.reserve(n.featureData.length);let o=e;for(const e of n.featureData){const a=r?65535&e:e>>16&65535,s=r?e>>16&65535:65535&e,l=(15&s)<8?15&s:0,c=t.evaluatedRMEA[l],u=t.evaluatedColor[l],h=t.emissionHeightBasedParams[l];let d;if(o&&2===l&&i.lights&&(d=new oc,d.resize(10*i.lights.length)),Hv(n.featureArray,a,u,c,h,n.aabb.min[2],n.aabb.max[2],d),d&&o){o=!1;const t=i.meshes[i.lightMeshIndex];t.featureArray=d,t.featureArray._trim()}}n.featureArray._trim(),a++}}function Yv(t,e,n,i){const a=1<<t.z;e.lat=ku((i/ur+t.y)/a),e.lng=Mu((n/ur+t.x)/a)}bs($v,"Tiled3dModelBucket",{omit:["layers"]}),bs(qv,"Tiled3dModelFeature");const Xv={circle:class extends Tl{constructor(t,e,n,i){super(t,fh,e,n,i)}createBucket(t){return new Zu(t)}queryRadius(t){const e=t;return ch("circle-radius",this,e)+ch("circle-stroke-width",this,e)+uh(this.paint.get("circle-translate"))}queryIntersectsFeature(t,e,n,i,a,r,o,s){const l=dh(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),r.angle,t.pixelToTileUnitsFactor),c=this.paint.get("circle-radius").evaluate(e,n)+this.paint.get("circle-stroke-width").evaluate(e,n);return ed(t,i,r,o,s,"map"===this.paint.get("circle-pitch-alignment"),"map"===this.paint.get("circle-pitch-scale"),l,c)}getProgramIds(){return["circle"]}getDefaultProgramParams(t,e,n){const i=td(this);return{config:new Zc(this,{zoom:e,lut:n}),defines:i,overrideFog:!1}}},heatmap:class extends Tl{createBucket(t){return new od(t)}constructor(t,e,n,i){super(t,fd,e,n,i),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(t){"heatmap-color"===t&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=md({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(t){return ch("heatmap-radius",this,t)}queryIntersectsFeature(t,e,n,i,a,r,o,s){const l=this.paint.get("heatmap-radius").evaluate(e,n);return ed(t,i,r,o,s,!0,!0,new Ve(0,0),l)}hasOffscreenPass(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility}getProgramIds(){return["heatmap","heatmapTexture"]}getDefaultProgramParams(t,e,n){return"heatmap"===t?{config:new Zc(this,{zoom:e,lut:n}),overrideFog:!1}:{}}},hillshade:class extends Tl{constructor(t,e,n,i){super(t,_d,e,n,i)}hasOffscreenPass(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility}getProgramIds(){return["hillshade","hillshadePrepare"]}getDefaultProgramParams(t,e,n){return{overrideFog:!1}}},fill:class extends Tl{constructor(t,e,n,i){super(t,Kd,e,n,i)}getProgramIds(){const t=this.paint.get("fill-pattern"),e=t&&t.constantOr(1),n=[e?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&n.push(e&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),n}getDefaultProgramParams(t,e,n){return{config:new Zc(this,{zoom:e,lut:n}),overrideFog:!1}}recalculate(t,e){super.recalculate(t,e);const n=this.paint._values["fill-outline-color"];"constant"===n.value.kind&&void 0===n.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(t){return new Yd(t)}queryRadius(){return uh(this.paint.get("fill-translate"))}queryIntersectsFeature(t,e,n,i,a,r){return!t.queryGeometry.isAboveHorizon&&Ku(hh(t.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),r.angle,t.pixelToTileUnitsFactor),i)}isTileClipped(){return!0}},"fill-extrusion":class extends Tl{constructor(t,e,n,i){super(t,Mf,e,n,i),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(t){return new gf(t)}queryRadius(){return uh(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}hasShadowPass(){return!0}cutoffRange(){return this.paint.get("fill-extrusion-cutoff-fade-range")}canCastShadows(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}queryIntersectsFeature(e,n,i,a,r,o,s,l,c){const u=dh(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),o.angle,e.pixelToTileUnitsFactor),h=this.paint.get("fill-extrusion-height").evaluate(n,i),d=this.paint.get("fill-extrusion-base").evaluate(n,i),p=[0,0],f=l&&o.elevation,m=o.elevation?o.elevation.exaggeration():1,g=e.tile.getBucket(this);if(f&&g instanceof gf){const t=g.centroidVertexArray,e=c+1;e<t.length&&(p[0]=t.geta_centroid_pos0(e),p[1]=t.geta_centroid_pos1(e))}if(0===p[0]&&1===p[1])return!1;"globe"===o.projection.name&&(a=Ef([a],[new Ve(0,0),new Ve(ur,ur)],e.tileID.canonical).map((t=>t.polygon)).flat());const _=f?l:null,[y,x]=function(e,n,i,a,r,o,s,l,c,u,h){return"globe"===e.projection.name?function(e,n,i,a,r,o,s,l,c,u,h){const d=[],p=[],f=e.projection.upVectorScale(h,e.center.lat,e.worldSize).metersToTile,m=[0,0,0,1],g=[0,0,0,1],_=(t,e,n,i)=>{t[0]=e,t[1]=n,t[2]=i,t[3]=1},y=Cf();i>0&&(i+=y),a+=y;for(const y of n){const n=[],x=[];for(const d of y){const p=d.x+r.x,y=d.y+r.y,v=e.projection.projectTilePoint(p,y,h),b=e.projection.upVector(h,d.x,d.y);let w=i,A=a;if(s){const t=Pf(p,y,i,a,s,l,c,u);w+=t.base,A+=t.top}0!==i?_(m,v.x+b[0]*f*w,v.y+b[1]*f*w,v.z+b[2]*f*w):_(m,v.x,v.y,v.z),_(g,v.x+b[0]*f*A,v.y+b[1]*f*A,v.z+b[2]*f*A),t._.transformMat4(m,m,o),t._.transformMat4(g,g,o),n.push(new Ap(m[0],m[1],m[2])),x.push(new Ap(g[0],g[1],g[2]))}d.push(n),p.push(x)}return[d,p]}(e,n,i,a,r,o,s,l,c,u,h):s?function(e,n,i,a,r,o,s,l,c){const u=[],h=[],d=[0,0,0,1];for(const p of e){const e=[],f=[];for(const u of p){const h=u.x+a.x,p=u.y+a.y,m=Pf(h,p,n,i,o,s,l,c);d[0]=h,d[1]=p,d[2]=m.base,d[3]=1,t.aA.transformMat4(d,d,r),d[3]=Math.max(d[3],1e-5);const g=new Ap(d[0]/d[3],d[1]/d[3],d[2]/d[3]);d[0]=h,d[1]=p,d[2]=m.top,d[3]=1,t.aA.transformMat4(d,d,r),d[3]=Math.max(d[3],1e-5);const _=new Ap(d[0]/d[3],d[1]/d[3],d[2]/d[3]);e.push(g),f.push(_)}u.push(e),h.push(f)}return[u,h]}(n,i,a,r,o,s,l,c,u):function(t,e,n,i,a){const r=[],o=[],s=a[8]*e,l=a[9]*e,c=a[10]*e,u=a[11]*e,h=a[8]*n,d=a[9]*n,p=a[10]*n,f=a[11]*n;for(const e of t){const t=[],n=[];for(const r of e){const e=r.x+i.x,o=r.y+i.y,m=a[0]*e+a[4]*o+a[12],g=a[1]*e+a[5]*o+a[13],_=a[2]*e+a[6]*o+a[14],y=a[3]*e+a[7]*o+a[15],x=m+s,v=g+l,b=_+c,w=Math.max(y+u,1e-5),A=m+h,C=g+d,E=_+p,T=Math.max(y+f,1e-5);t.push(new Ap(x/w,v/w,b/w)),n.push(new Ap(A/T,C/T,E/T))}r.push(t),o.push(n)}return[r,o]}(n,i,a,r,o)}(o,a,d,h,u,s,_,p,m,o.center.lat,e.tileID.canonical),v=e.queryGeometry;return function(t,e,n){let i=1/0;Ku(n,e)&&(i=If(n,e[0]));for(let a=0;a<e.length;a++){const r=e[a],o=t[a];for(let t=0;t<r.length-1;t++){const e=r[t],a=[e,r[t+1],o[t+1],o[t],e];Yu(n,a)&&(i=Math.min(i,If(n,a)))}}return i!==1/0&&i}(y,x,v.isPointQuery()?v.screenBounds:v.screenGeometry)}},line:class extends Tl{constructor(t,e,n,i){super(t,em,e,n,i),em.layout&&(this.layout=new el(em.layout)),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(t){if("line-gradient"===t){const t=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=t._styleExpression&&t._styleExpression.expression instanceof Jr,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(t,e){super.recalculate(t,e),this.paint._values["line-floorwidth"]=Zy.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,t)}createBucket(t){return new Qf(t)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getDefaultProgramParams(t,e,n){const i=rm(this);return{config:new Zc(this,{zoom:e,lut:n}),defines:i,overrideFog:!1}}queryRadius(t){const e=t,n=Yy(ch("line-width",this,e),ch("line-gap-width",this,e)),i=ch("line-offset",this,e);return n/2+Math.abs(i)+uh(this.paint.get("line-translate"))}queryIntersectsFeature(t,e,n,i,a,r){if(t.queryGeometry.isAboveHorizon)return!1;const o=hh(t.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),r.angle,t.pixelToTileUnitsFactor),s=t.pixelToTileUnitsFactor/2*Yy(this.paint.get("line-width").evaluate(e,n),this.paint.get("line-gap-width").evaluate(e,n)),l=this.paint.get("line-offset").evaluate(e,n);return l&&(i=function(t,e){const n=[],i=new Ve(0,0);for(let a=0;a<t.length;a++){const r=t[a],o=[];for(let t=0;t<r.length;t++){const n=r[t],a=r[t+1],s=0===t?i:n.sub(r[t-1])._unit()._perp(),l=t===r.length-1?i:a.sub(n)._unit()._perp(),c=s._add(l)._unit();c._mult(1/(c.x*l.x+c.y*l.y)),o.push(c._mult(e)._add(n))}n.push(o)}return n}(i,l*t.pixelToTileUnitsFactor)),function(t,e,n){for(let i=0;i<e.length;i++){const a=e[i];if(t.length>=3)for(let e=0;e<a.length;e++)if(ah(t,a[e]))return!0;if(Qu(t,a,n))return!0}return!1}(o,i,s)}isTileClipped(){return!0}isDraped(t){const e=this.layout.get("line-z-offset");return e.isConstant()&&!e.constantOr(0)}},symbol:Jy,background:class extends Tl{constructor(t,e,n,i){super(t,ex,e,n,i)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}getDefaultProgramParams(t,e,n){return{overrideFog:!1}}},raster:cx,"raster-particle":dx,sky:class extends Tl{constructor(t,e,n,i){super(t,mx,e,n,i),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(t){"sky-gradient"===t?this._updateColorRamp():"sky-atmosphere-sun"!==t&&"sky-atmosphere-halo-color"!==t&&"sky-atmosphere-color"!==t&&"sky-atmosphere-sun-intensity"!==t||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=md({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(t){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const e=t.style.light.properties.get("position");return this._lightPosition.azimuthal!==e.azimuthal||this._lightPosition.polar!==e.polar}return!1}getCenter(t,e){if("atmosphere"===this.paint.get("sky-type")){const n=this.paint.get("sky-atmosphere-sun"),i=!n,a=t.style.light,r=a.properties.get("position");return i&&"viewport"===a.properties.get("anchor")&&fn("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),i?gx(r.azimuthal,90-r.polar,e):gx(n[0],90-n[1],e)}const n=this.paint.get("sky-gradient-center");return gx(n[0],90-n[1],e)}isSky(){return!0}markSkyboxValid(t){this._skyboxInvalidated=!1,this._lightPosition=t.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const t=this.paint.get("sky-type");return"atmosphere"===t?["skyboxCapture","skybox"]:"gradient"===t?["skyboxGradient"]:null}},slot:class extends Tl{constructor(t,e,n,i){super(t,_x,e,null)}},model:class extends Tl{constructor(t,e,n,i){super(t,Vx,e,n,i),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(t){return new Nx(t)}getProgramIds(){return["model"]}is3D(){return!0}hasShadowPass(){return!0}canCastShadows(){return!0}hasLightBeamPass(){return!0}cutoffRange(){return this.paint.get("model-cutoff-fade-range")}queryRadius(t){return t instanceof $v?ur-1:0}queryIntersectsFeature(e,n,i,a,r,o){if(!this.modelManager)return!1;const s=this.modelManager,l=e.tile.getBucket(this);if(!(l&&l instanceof Nx))return!1;const c=l;for(const i in c.instancesPerModel){const a=c.instancesPerModel[i],r=void 0!==n.id?n.id:n.properties&&n.properties.hasOwnProperty("id")?n.properties.id:void 0;if(a.idToFeaturesIndex.hasOwnProperty(r)){const n=a.features[a.idToFeaturesIndex[r]],l=s.getModel(i,this.scope);if(!l)return!1;let u=t.ad.create();const h=new pu(0,0),d=c.canonical;let p=Number.MAX_VALUE;for(let i=0;i<n.instancedDataCount;++i){const r=16*(n.instancedDataOffset+i),s=a.instancedDataArray.float32,c=[s[r+4],s[r+5],s[r+6]];Yv(d,h,s[r],0|s[r+1]),qx(u,l,o,h,n.rotation,n.scale,c,!1,!1,!1),"globe"===o.projection.name&&(u=Tx(u,o));const f=t.ad.multiply([],o.projMatrix,u),m=e.queryGeometry,g=Sx(m.isPointQuery()?m.screenBounds:m.screenGeometry,o,f,l.aabb);null!=g&&(p=Math.min(g,p))}return p!==Number.MAX_VALUE&&p}}return!1}_handleOverridablePaintPropertyUpdate(t,e,n){return!(!this.layout||e.isDataDriven()||n.isDataDriven()||"model-color"!==t&&"model-color-mix-intensity"!==t&&"model-rotation"!==t&&"model-scale"!==t&&"model-translation"!==t&&"model-emissive-strength"!==t)}_isPropertyZoomDependent(t){const e=this._transitionablePaint._values[t];return null!=e&&null!=e.value&&null!=e.value.expression&&e.value.expression instanceof ds}isZoomDependent(){return this._isPropertyZoomDependent("model-scale")||this._isPropertyZoomDependent("model-rotation")||this._isPropertyZoomDependent("model-translation")}queryIntersectsMatchingFeature(e,n,i,a){const r=e.tile,o=r.getBucket(this);let s=null,l=Number.MAX_VALUE;if(!(o&&o instanceof $v))return{queryFeature:s,intersectionZ:l};const c=o.getNodesInfo()[n];if(c.hiddenByReplacement||!c.node.meshes||!i.filter(new Hs(r.tileID.overscaledZ),c.feature,r.tileID.canonical))return{queryFeature:s,intersectionZ:l};const u=c.node,h=a.calculatePosMatrix(r.tileID.toUnwrapped(),a.worldSize),d=c.evaluatedScale;let p=0;a.elevation&&u.elevation&&(p=u.elevation*a.elevation.exaggeration()),t.ad.translate(h,h,[(u.anchor?u.anchor[0]:0)*(d[0]-1),(u.anchor?u.anchor[1]:0)*(d[1]-1),p]),t.ad.scale(h,h,d),t.ad.multiply(h,h,u.matrix);const f=e.queryGeometry,m=f.isPointQuery()?f.screenBounds:f.screenGeometry,g=function(e){const n=t.ad.multiply([],h,e.matrix),i=t.ad.multiply(n,a.expandedFarZProjMatrix,n);for(let t=0;t<e.meshes.length;++t){const n=e.meshes[t];if(t===e.lightMeshIndex)continue;const r=Sx(m,a,i,n.aabb);null!=r&&(l=Math.min(r,l))}if(e.children)for(const t of e.children)g(t)};if(g(u),l===Number.MAX_VALUE)return{queryFeature:s,intersectionZ:l};const _=new pu(0,0);return Yv(r.tileID.canonical,_,c.node.anchor[0],c.node.anchor[1]),s={type:"Feature",geometry:{type:"Point",coordinates:[_.lng,_.lat]},properties:c.feature.properties,id:c.feature.id,state:{},layer:this.serialize()},{queryFeature:s,intersectionZ:l}}},clip:class extends Tl{constructor(t,e,n,i){super(t,np,e,n,i)}recalculate(t,e){super.recalculate(t,e)}createBucket(t){return new tp(t)}isTileClipped(){return!0}is3D(){return!0}}};bs(Vy,"MRTDecodingBatch",{omit:["_onCancel","_onComplete"]});const Kv=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Qv{static from(t){if(!(t instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[e,n]=new Uint8Array(t,0,2);if(219!==e)throw new Error("Data does not appear to be in a KDBush format.");const i=n>>4;if(1!==i)throw new Error(`Got v${i} data when expected v1.`);const a=Kv[15&n];if(!a)throw new Error("Unrecognized array type.");const[r]=new Uint16Array(t,2,1),[o]=new Uint32Array(t,4,1);return new Qv(o,r,a,t)}constructor(t,e=64,n=Float64Array,i){if(isNaN(t)||t<0)throw new Error(`Unpexpected numItems value: ${t}.`);this.numItems=+t,this.nodeSize=Math.min(Math.max(+e,2),65535),this.ArrayType=n,this.IndexArrayType=t<65536?Uint16Array:Uint32Array;const a=Kv.indexOf(this.ArrayType),r=2*t*this.ArrayType.BYTES_PER_ELEMENT,o=t*this.IndexArrayType.BYTES_PER_ELEMENT,s=(8-o%8)%8;if(a<0)throw new Error(`Unexpected typed array class: ${n}.`);i&&i instanceof ArrayBuffer?(this.data=i,this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+o+s,2*t),this._pos=2*t,this._finished=!0):(this.data=new ArrayBuffer(8+r+o+s),this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+o+s,2*t),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+a]),new Uint16Array(this.data,2,1)[0]=e,new Uint32Array(this.data,4,1)[0]=t)}add(t,e){const n=this._pos>>1;return this.ids[n]=n,this.coords[this._pos++]=t,this.coords[this._pos++]=e,n}finish(){const t=this._pos>>1;if(t!==this.numItems)throw new Error(`Added ${t} items when expected ${this.numItems}.`);return Jv(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(t,e,n,i){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:a,coords:r,nodeSize:o}=this,s=[0,a.length-1,0],l=[];for(;s.length;){const c=s.pop()||0,u=s.pop()||0,h=s.pop()||0;if(u-h<=o){for(let o=h;o<=u;o++){const s=r[2*o],c=r[2*o+1];s>=t&&s<=n&&c>=e&&c<=i&&l.push(a[o])}continue}const d=h+u>>1,p=r[2*d],f=r[2*d+1];p>=t&&p<=n&&f>=e&&f<=i&&l.push(a[d]),(0===c?t<=p:e<=f)&&(s.push(h),s.push(d-1),s.push(1-c)),(0===c?n>=p:i>=f)&&(s.push(d+1),s.push(u),s.push(1-c))}return l}within(t,e,n){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:i,coords:a,nodeSize:r}=this,o=[0,i.length-1,0],s=[],l=n*n;for(;o.length;){const c=o.pop()||0,u=o.pop()||0,h=o.pop()||0;if(u-h<=r){for(let n=h;n<=u;n++)ib(a[2*n],a[2*n+1],t,e)<=l&&s.push(i[n]);continue}const d=h+u>>1,p=a[2*d],f=a[2*d+1];ib(p,f,t,e)<=l&&s.push(i[d]),(0===c?t-n<=p:e-n<=f)&&(o.push(h),o.push(d-1),o.push(1-c)),(0===c?t+n>=p:e+n>=f)&&(o.push(d+1),o.push(u),o.push(1-c))}return s}}function Jv(t,e,n,i,a,r){if(a-i<=n)return;const o=i+a>>1;tb(t,e,o,i,a,r),Jv(t,e,n,i,o-1,1-r),Jv(t,e,n,o+1,a,1-r)}function tb(t,e,n,i,a,r){for(;a>i;){if(a-i>600){const o=a-i+1,s=n-i+1,l=Math.log(o),c=.5*Math.exp(2*l/3),u=.5*Math.sqrt(l*c*(o-c)/o)*(s-o/2<0?-1:1);tb(t,e,n,Math.max(i,Math.floor(n-s*c/o+u)),Math.min(a,Math.floor(n+(o-s)*c/o+u)),r)}const o=e[2*n+r];let s=i,l=a;for(eb(t,e,i,n),e[2*a+r]>o&&eb(t,e,i,a);s<l;){for(eb(t,e,s,l),s++,l--;e[2*s+r]<o;)s++;for(;e[2*l+r]>o;)l--}e[2*i+r]===o?eb(t,e,i,l):(l++,eb(t,e,l,a)),l<=n&&(i=l+1),n<=l&&(a=l-1)}}function eb(t,e,n,i){nb(t,n,i),nb(e,2*n,2*i),nb(e,2*n+1,2*i+1)}function nb(t,e,n){const i=t[e];t[e]=t[n],t[n]=i}function ib(t,e,n,i){const a=t-n,r=e-i;return a*a+r*r}t.$=Ke,t.A=Hr,t.B=qr,t.C=Vi,t.D=Ia,t.E=Bi,t.G=cl,t.H=ts,t.I=C_,t.J=Ko,t.K=function(t){const e=t.value;let n=[];if(!e)return n;const i=Ea(e);return"string"!==i?(n=n.concat([new Bx(t.key,e,`string expected, "${i}" found`)]),n):(Ox(e,!0)||(n=n.concat([new Bx(t.key,e,`invalid url "${e}"`)])),n)},t.L=ol,t.M=class{constructor(t,e,n,i){this.id=t,this.position=null!=e?new pu(e[0],e[1]):new pu(0,0),this.orientation=null!=n?n:[0,0,0],this.nodes=i,this.uploaded=!1,this.aabb=new wh([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),this.matrix=[]}_applyTransformations(e,n){if(t.ad.multiply(e.matrix,n,e.matrix),e.meshes)for(const t of e.meshes){const n=wh.applyTransform(t.aabb,e.matrix);this.aabb.encapsulate(n)}if(e.children)for(const t of e.children)this._applyTransformations(t,e.matrix)}computeBoundsAndApplyParent(){const e=t.ad.identity([]);for(const t of this.nodes)this._applyTransformations(t,e)}computeModelMatrix(t,e,n,i,a,r,o=!1){qx(this.matrix,this,t.transform,this.position,e,n,i,a,r,o)}upload(t){if(!this.uploaded){for(const e of this.nodes)Hx(e,t);for(const t of this.nodes)Zx(t);this.uploaded=!0}}destroy(){for(const t of this.nodes)Yx(t)}},t.N=rl,t.O=nl,t.P=Ve,t.Q=class{constructor(t){this.specification=t}possiblyEvaluate(t,e){return _n(t.expression.evaluate(e))}interpolate(t,e,n){return{x:Gi(t.x,e.x,n),y:Gi(t.y,e.y,n),z:Gi(t.z,e.z,n),azimuthal:Gi(t.azimuthal,e.azimuthal,n),polar:Gi(t.polar,e.polar,n)}}},t.R=Qn,t.S=sc,t.T=G_,t.U=Xs,t.V=Bx,t.W=en,t.X=Hs,t.Y=Ou,t.Z=ds,t.a=k_,t.a$=function(t){const{x:e,y:n}=t.point,{lng:i,lat:a}=t._center;return Wh(e,n,t.worldSize,i,a)},t.a0=el,t.a1=Hh,t.a2=Gi,t.a3=ur,t.a4=qi,t.a5=class{constructor(t){this.specification=t}possiblyEvaluate(t,e){return function([t,e]){const n=_n([1,t,e]);return{x:n.x,y:n.y,z:n.z}}(t.expression.evaluate(e))}interpolate(t,e,n){return{x:Gi(t.x,e.x,n),y:Gi(t.y,e.y,n),z:Gi(t.z,e.z,n)}}},t.a6=Fc,t.a7=Pc,t.a8=Dc,t.a9=Oc,t.aB=function(e,n){const{x:i,y:a}=e.point,r=Wh(i,a,e.worldSize/e._pixelsPerMercatorPixel,0,0);return t.ad.multiply(r,r,Gh(zh(n)))},t.aD=Vm,t.aE=Qm,t.aF=jm,t.aG=function(t,e,n,i,a){const r=5*e+2;t.float32[r+0]=n,t.float32[r+1]=i,t.float32[r+2]=a},t.aH=F_,t.aI=pu,t.aJ=A_,t.aK=yu,t.aL=xu,t.aM=bh,t.aN=xx,t.aO=_u,t.aP=Oh,t.aQ=function(t,e,n,i,a,r,o,s,l){if("globe"===l.name)return Oh(t,e,new _u(n,i,a),!1);const c=e_({z:n,x:i,y:a},l);return new wh([(r+c.x/c.scale)*e,e*(c.y/c.scale),o],[(r+c.x2/c.scale)*e,e*(c.y2/c.scale),s])},t.aR=function(t,e,n){let i=0;for(let n=0;n<2;++n){const a=0;t[n]>a&&(i+=(t[n]-a)*(t[n]-a)),e[n]<a&&(i+=(a-e[n])*(a-e[n]))}return i},t.aS=Pu,t.aT=mh,t.aU=iu,t.aV=function(e){const n=t.ad.identity(new Float64Array(16));t.ad.multiply(n,e.pixelMatrix,e.globeMatrix);const i=[0,su,0],a=[0,lu,0];return t._.transformMat4(i,i,n),t._.transformMat4(a,a,n),[i[0]>0&&i[0]<=e.width&&i[1]>0&&i[1]<=e.height&&!Yh(e,new pu(e.center.lat,90)),a[0]>0&&a[0]<=e.width&&a[1]>0&&a[1]<=e.height&&!Yh(e,new pu(e.center.lat,-90))]},t.aW=function(e,n){const{scale:i}=e.tileTransform,a=i*ur/(e.tileSize*Math.pow(2,n.zoom-e.tileID.overscaledZ+e.tileID.canonical.z));return t.aC.scale(new Float32Array(4),n.inverseAdjustmentMatrix,[a,a])},t.aX=vx,t.aY=yx,t.aZ=function(e){const n=yx(e,!0);return t.aC.invert([],[n[0],n[1],n[4],n[5]])},t.a_=gh,t.aa=zc,t.ab=qe,t.ac=function(t,e,n){const i=Math.sqrt(t*t+e*e+n*n),a=i>0?Math.acos(n/i)*Ge:0;let r=0!==t||0!==e?Math.atan2(-e,-t)*Ge+90:0;return r<0&&(r+=360),[i,r,a]},t.ae=E_,t.af=z_,t.ag=S_,t.ah=function(t,e){const n={};for(let i=0;i<e.length;i++){const a=e[i];a in t&&(n[a]=t[a])}return n},t.ai=fu,t.aj=Eu,t.ak=Tu,t.al=Al,t.am=function(t){qn++,qn>Vn&&(t.getActor().send("enforceCacheSizeLimit",jn),qn=0)},t.an=_i,t.ao=class{constructor(t){this.entries={},this.scheduler=t}request(t,e,n,i){const a=this.entries[t]=this.entries[t]||{callbacks:[]};if(a.result){const[t,n]=a.result;return this.scheduler?this.scheduler.add((()=>{i(t,n)}),e):i(t,n),()=>{}}return a.callbacks.push(i),a.cancel||(a.cancel=n(((n,i)=>{a.result=[n,i];for(const t of a.callbacks)this.scheduler?this.scheduler.add((()=>{t(n,i)}),e):t(n,i);setTimeout((()=>delete this.entries[t]),3e3)}))),()=>{a.result||(a.callbacks=a.callbacks.filter((t=>t!==i)),a.callbacks.length||(a.cancel(),delete this.entries[t]))}}},t.ap=function(t,e,n){const i=JSON.stringify(t.request);return t.data&&(this.deduped.entries[i]={result:[null,t.data]}),this.deduped.request(i,{type:"parseTile",isSymbolTile:t.isSymbolTile,zoom:t.tileZoom},(e=>{const i=ni(t.request,((t,i,a,r)=>{t?e(t):i&&e(null,{vectorTile:n?void 0:new bp(new Im(i)),rawData:i,cacheControl:a,expires:r})}));return()=>{i.cancel(),e()}}),e)},t.aq=Lc,t.ar=class extends Ic{constructor(t){super(t),this.current=Nc}set(t,e,n){if(this.fetchUniformLocation(t,e))for(let t=0;t<9;t++)if(n[t]!==this.current[t]){this.current=n,this.gl.uniformMatrix3fv(this.location,!1,n);break}}},t.as=Bc,t.at=Xe,t.au=Qe,t.aw=Mn,t.ax=Su,t.ay=ku,t.az=function(t,e,n){t[4*e+0]=n[0],t[4*e+1]=n[1],t[4*e+2]=n[2],t[4*e+3]=n[3]},t.b=wc,t.b$=rf,t.b0=$e,t.b1=nu,t.b2=function(t){const e=Math.round((t+45+360)%360/90)%4;return We[e]},t.b3=45,t.b4=Cu,t.b5=Bu,t.b6=wh,t.b7=_n,t.b8=function(t){return[Math.pow(t[0],1/2.2),Math.pow(t[1],1/2.2),Math.pow(t[2],1/2.2)]},t.b9=He,t.bA=function(t,e){return[Math.pow(t[0],2.2)*e,Math.pow(t[1],2.2)*e,Math.pow(t[2],2.2)*e]},t.bB=nm,t.bD=$h,t.bE=zn,t.bF=Pn,t.bG=256,t.bH=function(e,n){const i=[0,0,0],a=Uh(zh(n.canonical));return t._.transformMat4(i,i,a),t._.transformMat4(i,i,e),i},t.bI=t=>({u_camera_to_center_distance:new zc(t),u_extrude_scale:new Vc(t),u_device_pixel_ratio:new zc(t),u_matrix:new Fc(t),u_inv_rot_matrix:new Fc(t),u_merc_center:new Dc(t),u_tile_id:new Lc(t),u_zoom_transition:new zc(t),u_up_dir:new Lc(t),u_emissive_strength:new zc(t)}),t.bJ=t=>({u_matrix:new Fc(t),u_pixels_to_tile_units:new Vc(t),u_device_pixel_ratio:new zc(t),u_units_to_pixels:new Dc(t),u_dash_image:new Pc(t),u_gradient_image:new Pc(t),u_image_height:new zc(t),u_texsize:new Dc(t),u_tile_units_to_pixels:new zc(t),u_alpha_discard_threshold:new zc(t),u_trim_offset:new Dc(t),u_trim_fade_range:new Dc(t),u_trim_color:new Bc(t),u_emissive_strength:new zc(t)}),t.bK=t=>({u_matrix:new Fc(t),u_texsize:new Dc(t),u_pixels_to_tile_units:new Vc(t),u_device_pixel_ratio:new zc(t),u_image:new Pc(t),u_units_to_pixels:new Dc(t),u_tile_units_to_pixels:new zc(t),u_alpha_discard_threshold:new zc(t),u_trim_offset:new Dc(t)}),t.bL=Yl,t.bM=Hf,t.bN=Rm,t.bO=Um,t.bP=qg,t.bQ=cg,t.bR=td,t.bS=(t,e,n,i,a,r)=>{const o=t.transform,s="globe"===o.projection.name;let l;if("map"===r.paint.get("circle-pitch-alignment"))if(s){const t=$h(o.zoom,e.canonical)*o._pixelsPerMercatorPixel;l=Float32Array.from([t,0,0,t])}else l=o.calculatePixelsToTileUnitsMatrix(n);else l=new Float32Array([o.pixelsToGLUnits[0],0,0,o.pixelsToGLUnits[1]]);const c={u_camera_to_center_distance:t.transform.getCameraToCenterDistance(o.projection),u_matrix:t.translatePosMatrix(e.projMatrix,n,r.paint.get("circle-translate"),r.paint.get("circle-translate-anchor")),u_device_pixel_ratio:Ln.devicePixelRatio,u_extrude_scale:l,u_inv_rot_matrix:Jh,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0],u_emissive_strength:r.paint.get("circle-emissive-strength")};if(s){c.u_inv_rot_matrix=i,c.u_merc_center=a,c.u_tile_id=[e.canonical.x,e.canonical.y,1<<e.canonical.z],c.u_zoom_transition=Hh(o.zoom);const t=a[0]*ur,n=a[1]*ur;c.u_up_dir=o.projection.upVector(new _u(0,0,0),t,n)}return c},t.bT=rm,t.bU=(t,e,n,i,a,r)=>{const o=t.transform;return{u_matrix:am(t,e,n,i),u_texsize:e.imageAtlasTexture?e.imageAtlasTexture.size:[0,0],u_pixels_to_tile_units:o.calculatePixelsToTileUnitsMatrix(e),u_device_pixel_ratio:a,u_image:0,u_tile_units_to_pixels:im(e,o),u_units_to_pixels:[1/o.pixelsToGLUnits[0],1/o.pixelsToGLUnits[1]],u_alpha_discard_threshold:0,u_trim_offset:r}},t.bV=(t,e,n,i,a,r,o)=>{const s=t.transform,l=s.calculatePixelsToTileUnitsMatrix(e);return{u_matrix:am(t,e,n,i),u_pixels_to_tile_units:l,u_device_pixel_ratio:r,u_units_to_pixels:[1/s.pixelsToGLUnits[0],1/s.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:a,u_texsize:om(n)&&e.lineAtlasTexture?e.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:im(e,t.transform),u_alpha_discard_threshold:0,u_trim_offset:o,u_trim_fade_range:n.paint.get("line-trim-fade-range"),u_trim_color:n.paint.get("line-trim-color").toRenderColor(n.lut).toArray01(),u_emissive_strength:n.paint.get("line-emissive-strength")}},t.bW=on,t.bX=md,t.bY=Cf,t.bZ=bu,t.b_=gf,t.ba=function(t,e,n){const i=Hh(n.zoom),a=t.style.map._antialias,r=e.options.extStandardDerivativesForceOff||t.terrain&&t.terrain.exaggeration()>0;return 0===i&&!a&&!r},t.bb=function(e){const n=e.pixelsPerMeter,i=n/Su(1,e.center.lat),a=t.ad.identity(new Float64Array(16));return t.ad.translate(a,a,[e.point.x,e.point.y,0]),t.ad.scale(a,a,[i,i,n]),Float32Array.from(a)},t.bc=Rh,t.bd=function(t){const e=Pu-5;t=Xe(t,-e,e)/e*90;const n=Math.pow(Math.abs(Math.sin(qe(t))),3);return Math.round(n*(ou.length-1))},t.be=function(e,n,i,a){const r=n.getNorth(),o=n.getSouth(),s=n.getWest(),l=n.getEast(),c=1<<e.z,u=l-s,h=r-o,d=u/ru,p=-h/ou[i],f=[0,d,0,p,0,0,r,s,0];if(e.z>0){const e=180/a;t.bC.multiply(f,f,[e/u+1,0,0,0,e/h+1,0,-.5*e/d,.5*e/p,1])}return f[2]=c,f[5]=e.x,f[8]=e.y,f},t.bf=Uh,t.bg=zh,t.bh=function(e,n,i){const a=t.ad.identity(new Float64Array(16)),r=(n/(1<<e)-.5)*Math.PI*2;return t.ad.rotateY(a,i.globeMatrix,r),Float32Array.from(a)},t.bi=Dn,t.bj=function(t){return t<=1?1:Math.pow(2,Math.floor(Math.log(t)/Math.LN2))},t.bk=cx,t.bl=dx,t.bm=sx,t.bn=function(t,e){const n=document.createElement("video");n.muted=!0,n.onloadstart=function(){e(null,n)};for(let e=0;e<t.length;e++){const i=document.createElement("source");ii(t[e])||(n.crossOrigin="Anonymous"),i.src=t[e],n.appendChild(i)}return{cancel:()=>{}}},t.bo=q_,t.bp=ln,t.bq=class{isDataAvailableAtPoint(t){const e=this._source();if(this.isUsingMockSource()||!e||t.y<0||t.y>1)return!1;const n=e.getSource().maxzoom,i=1<<n,a=Math.floor(t.x),r=Math.floor((t.x-a)*i),o=Math.floor(t.y*i),s=this.findDEMTileFor(new xu(n,a,n,r,o));return!(!s||!s.dem)}getAtPointOrZero(t,e=0){return this.getAtPoint(t,e)||0}getAtPoint(t,e,n=!0){if(this.isUsingMockSource())return null;null==e&&(e=null);const i=this._source();if(!i)return e;if(t.y<0||t.y>1)return e;const a=i.getSource().maxzoom,r=1<<a,o=Math.floor(t.x),s=t.x-o,l=new xu(a,o,a,Math.floor(s*r),Math.floor(t.y*r)),c=this.findDEMTileFor(l);if(!c||!c.dem)return e;const u=c.dem,h=1<<c.tileID.canonical.z,d=(s*h-c.tileID.canonical.x)*u.dim,p=(t.y*h-c.tileID.canonical.y)*u.dim,f=Math.floor(d),m=Math.floor(p);return(n?this.exaggeration():1)*Gi(Gi(u.get(f,m),u.get(f,m+1),p-m),Gi(u.get(f+1,m),u.get(f+1,m+1),p-m),d-f)}getAtTileOffset(t,e,n){const i=1<<t.canonical.z;return this.getAtPointOrZero(new Ou(t.wrap+(t.canonical.x+e/ur)/i,(t.canonical.y+n/ur)/i))}getAtTileOffsetFunc(e,n,i,a){return r=>{const o=this.getAtTileOffset(e,r.x,r.y),s=a.upVector(e.canonical,r.x,r.y),l=a.upVectorScale(e.canonical,n,i).metersToTile;return t._.scale(s,s,o*l),s}}getForTilePoints(t,e,n,i){if(this.isUsingMockSource())return!1;const a=Xp.create(this,t,i);return!!a&&(e.forEach((t=>{t[2]=this.exaggeration()*a.getElevationAt(t[0],t[1],n)})),!0)}getMinMaxForTile(t){if(this.isUsingMockSource())return null;const e=this.findDEMTileFor(t);if(!e||!e.dem)return null;const n=e.dem.tree,i=e.tileID,a=1<<t.canonical.z-i.canonical.z;let r=t.canonical.x/a-i.canonical.x,o=t.canonical.y/a-i.canonical.y,s=0;for(let e=0;e<t.canonical.z-i.canonical.z&&!n.leaves[s];e++){r*=2,o*=2;const t=2*Math.floor(o)+Math.floor(r);s=n.childOffsets[s]+t,r%=1,o%=1}return{min:this.exaggeration()*n.minimums[s],max:this.exaggeration()*n.maximums[s]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(t,e,n){throw new Error("Pure virtual method called.")}pointCoordinate(t){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(t){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}getMinMaxForVisibleTiles(){const t=this.visibleDemTiles;if(0===t.length)return null;let e=!1,n=Number.MAX_VALUE,i=Number.MIN_VALUE;for(const a of t){const t=this.getMinMaxForTile(a.tileID);t&&(n=Math.min(n,t.min),i=Math.max(i,t.max),e=!0)}return e?{min:n,max:i}:null}},t.br=Th,t.bs=Sh,t.bt=zl,t.bu=Kl,t.bv=qy,t.bw=Jx,t.bx=rv,t.by=ey,t.bz=dd,t.c=Ov,t.c$=ei,t.c0=450,t.c1=7,t.c2=lx,t.c3=Uy,t.c4=256,t.c5=Lh,t.c6=Gh,t.c7=Il,t.c8=Fl,t.c9=tc,t.cA=function(t){let e=1/0,n=1/0,i=-1/0,a=-1/0;for(const r of t)e=Math.min(e,r.x),n=Math.min(n,r.y),i=Math.max(i,r.x),a=Math.max(a,r.y);return{min:new Ve(e,n),max:new Ve(i,a)}},t.cB=ah,t.cC=Fu,t.cD=eu,t.cE=["type","source","source-layer","minzoom","maxzoom","filter","layout"],t.cF=bg,t.cG=Yu,t.cH=Op,t.cI=Rp,t.cJ=$g,t.cK=Qv,t.cL=function(t){return t({pluginStatus:Ns,pluginURL:js}),Gs.on("pluginStateChange",t),t},t.cM=Pg,t.cN=Ig,t.cO=ti,t.cP=Vs,t.cQ=r,t.cR=On,t.cS=Ii,t.cT=dn,t.cU=function(t){const e=t.indexOf(wl);return e>=0?t.slice(0,e):t},t.cV=function(t){return t.indexOf(wl)>=0},t.cW=function(t){const e=t.indexOf(wl);return e>=0?t.slice(e+1):""},t.cX=function(t){const e=[],n=t.id;return void 0===n&&e.push({message:`layers.${n}: missing required property "id"`}),void 0===t.render&&e.push({message:`layers.${n}: missing required method "render"`}),t.renderingMode&&"2d"!==t.renderingMode&&"3d"!==t.renderingMode&&e.push({message:`layers.${n}: property "renderingMode" must be either "2d" or "3d"`}),e},t.cY=function(t,e,n,i){return"custom"===t.type?new px(t,e):new Xv[t.type](t,e,n,i)},t.cZ=hn,t.c_=Gs,t.ca=1,t.cb=M_,t.cc=0,t.cd=ec,t.ce=function(t,e,n,i,a){return Xe((t-e)/(n-e)*(a-i)+i,i,a)},t.cf=jo,t.cg=Du,t.ch=class{constructor(t,e,n,i){this.context=t,this.format=i,this.size=n,this.texture=t.gl.createTexture();const[a,r,o]=this.size,{gl:s}=t;s.bindTexture(s.TEXTURE_3D,this.texture),t.pixelStoreUnpackFlipY.set(!1),t.pixelStoreUnpack.set(1),t.pixelStoreUnpackPremultiplyAlpha.set(!1);let l=this.format,c=s.UNSIGNED_BYTE;this.format===s.DEPTH_COMPONENT&&(l=s.DEPTH_COMPONENT16,c=s.UNSIGNED_SHORT),this.format===s.R8&&(i=s.RED),this.format===s.R32F&&(c=s.FLOAT,i=s.RED),s.texImage3D(s.TEXTURE_3D,0,l,a,r,o,0,i,c,e.data)}bind(t,e){const{context:n}=this,{gl:i}=n;i.bindTexture(i.TEXTURE_3D,this.texture),t!==this.minFilter&&(i.texParameteri(i.TEXTURE_3D,i.TEXTURE_MAG_FILTER,t),i.texParameteri(i.TEXTURE_3D,i.TEXTURE_MIN_FILTER,t),this.minFilter=t),e!==this.wrapS&&(i.texParameteri(i.TEXTURE_3D,i.TEXTURE_WRAP_S,e),i.texParameteri(i.TEXTURE_3D,i.TEXTURE_WRAP_T,e),this.wrapS=e)}destroy(){const{gl:t}=this.context;t.deleteTexture(this.texture),this.texture=null}},t.ci=Tx,t.cj=[1,1,1],t.ck=Xp,t.cl=Gx,t.cm=Wl,t.cn=nc,t.co=class{constructor(){this._updateTime=0,this._sourceIds=[],this._activeRegions=[],this._prevRegions=[],this._globalClipBounds={min:new Ve(1/0,1/0),max:new Ve(-1/0,-1/0)}}clear(){this._activeRegions.length>0&&++this._updateTime,this._activeRegions=[],this._prevRegions=[]}get updateTime(){return this._updateTime}getReplacementRegionsForTile(t,e=!1){const n=zp(new Ve(0,0),new Ve(ur,ur),t),i=[];if(e&&!Ip(n,this._globalClipBounds))return i;for(const e of this._activeRegions){if(e.hiddenByOverlap)continue;if(!Ip(n,e))continue;const a=Dp(e.min,e.max,t);i.push({min:a.min,max:a.max,sourceId:this._sourceIds[e.priority],footprint:e.footprint,footprintTileId:e.tileId,order:e.order,clipMask:e.clipMask})}return i}setSources(t){this._setSources(t.map((t=>({getSourceId:()=>t.cache.id,getFootprints:()=>{const e=[];for(const n of t.cache.getVisibleCoordinates()){const i=t.cache.getTile(n).buckets[t.layer];i&&i.updateFootprints(n.toUnwrapped(),e)}return e},getOrder:()=>t.order,getClipMask:()=>t.clipMask}))))}_addSource(t){const e=t.getFootprints();if(0===e.length)return;const n=t.getOrder(),i=t.getClipMask();for(const t of e){if(!t.footprint)continue;const e=zp(t.footprint.min,t.footprint.max,t.id);this._activeRegions.push({min:e.min,max:e.max,hiddenByOverlap:!1,priority:this._sourceIds.length,tileId:t.id,footprint:t.footprint,order:n,clipMask:i})}this._sourceIds.push(t.getSourceId())}_computeReplacement(){this._activeRegions.sort(((t,e)=>t.priority-e.priority||Mp(t.min,e.min)||Mp(t.max,e.max)));let t=this._activeRegions.length!==this._prevRegions.length;if(!t){let e=0;for(;!t&&e!==this._activeRegions.length;){const n=this._activeRegions[e],i=this._prevRegions[e];t=n.priority!==i.priority||!kp(n,i)||n.order!==i.order||n.clipMask!==i.clipMask,++e}}if(t){++this._updateTime;for(const t of this._activeRegions)t.order!==1/0&&(this._globalClipBounds.min.x=Math.min(this._globalClipBounds.min.x,t.min.x),this._globalClipBounds.min.y=Math.min(this._globalClipBounds.min.y,t.min.y),this._globalClipBounds.max.x=Math.max(this._globalClipBounds.max.x,t.max.x),this._globalClipBounds.max.y=Math.max(this._globalClipBounds.max.y,t.max.y));const t=t=>{const e=this._activeRegions;if(t>=e.length)return t;const n=e[t].priority;for(;t<e.length&&e[t].priority===n;)++t;return t};if(this._sourceIds.length>1){let e=0,n=t(e);for(;e!==n;){let i=e;const a=e;for(;i!==n;){const t=this._activeRegions[i];t.hiddenByOverlap=!1;for(let e=0;e<a;e++){const n=this._activeRegions[e];if(!n.hiddenByOverlap&&t.order===1/0&&Ip(t,n)&&(t.hiddenByOverlap=Bp(t.footprint,t.tileId,n.footprint,n.tileId),t.hiddenByOverlap))break}++i}e=n,n=t(e)}}}}_setSources(t){[this._prevRegions,this._activeRegions]=[this._activeRegions,[]],this._sourceIds=[];for(let e=t.length-1;e>=0;e--)this._addSource(t[e]);this._computeReplacement()}},t.cp=Ll,t.cq=Q_,t.cr=ac,t.cs=class{constructor(t){this._createGrid(t),this._createPoles(t)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const t of this._poleSegments)t.destroy();for(const t of this._gridSegments)t.withSkirts.destroy(),t.withoutSkirts.destroy()}_fillGridMeshWithLods(t,e){const n=new zl,i=new Kl,a=[],r=t+1+2,o=e[0]+1,s=e[0]+1+(1+e.length),l=(t,e,n)=>{let i=t===r-1?t-2:0===t?t:t-1;return i+=n?24575:0,[i,e]};for(let t=0;t<r;++t)n.emplaceBack(...l(t,0,!0));for(let t=0;t<o;++t)for(let e=0;e<r;++e)n.emplaceBack(...l(e,t,(0===e||e===r-1)&&!0));for(let t=0;t<e.length;++t){const i=e[t];for(let t=0;t<r;++t)n.emplaceBack(...l(t,i,!0))}for(let t=0;t<e.length;++t){const o=i.length,l=e[t]+1+2,c=new Kl;for(let n=0;n<l-1;n++){const a=n===l-2,o=a?r*(s-e.length+t-n):r;for(let t=0;t<r-1;t++){const e=n*r+t;0===n||a||0===t||t===r-2?(c.emplaceBack(e+1,e,e+o),c.emplaceBack(e+o,e+o+1,e+1)):(i.emplaceBack(e+1,e,e+o),i.emplaceBack(e+o,e+o+1,e+1))}}const u=wc.simpleSegment(0,o,n.length,i.length-o);for(let t=0;t<c.uint16.length;t+=3)i.emplaceBack(c.uint16[t],c.uint16[t+1],c.uint16[t+2]);const h=wc.simpleSegment(0,o,n.length,i.length-o);a.push({withoutSkirts:u,withSkirts:h})}return{vertices:n,indices:i,segments:a}}_createGrid(t){const e=this._fillGridMeshWithLods(ru,ou);this._gridSegments=e.segments,this._gridBuffer=t.createVertexBuffer(e.vertices,Th.members),this._gridIndexBuffer=t.createIndexBuffer(e.indices,!0)}_createPoles(t){const e=new Kl;for(let t=0;t<=ru;t++)e.emplaceBack(0,t+1,t+2);this._poleIndexBuffer=t.createIndexBuffer(e,!0);const n=new tc,i=new tc,a=new tc,r=new tc;this._poleSegments=[];for(let t=0,e=0;t<nu;t++){const o=360/(1<<t);n.emplaceBack(0,-eu,0,.5,0),i.emplaceBack(0,-eu,0,.5,1),a.emplaceBack(0,-eu,0,.5,.5),r.emplaceBack(0,-eu,0,.5,.5);for(let t=0;t<=ru;t++){let e=t/ru,s=0;const l=Gi(0,o,e),[c,u,h]=cu(Kh,Qh,l,eu);n.emplaceBack(c,u,h,e,s),i.emplaceBack(c,u,h,e,1-s);const d=qe(l);e=.5+.5*Math.sin(d),s=.5+.5*Math.cos(d),a.emplaceBack(c,u,h,e,s),r.emplaceBack(c,u,h,e,1-s)}this._poleSegments.push(wc.simpleSegment(e,0,66,64)),e+=66}this._poleNorthVertexBuffer=t.createVertexBuffer(n,Ch,!1),this._poleSouthVertexBuffer=t.createVertexBuffer(i,Ch,!1),this._texturedPoleNorthVertexBuffer=t.createVertexBuffer(a,Ch,!1),this._texturedPoleSouthVertexBuffer=t.createVertexBuffer(r,Ch,!1)}getGridBuffers(t,e){return[this._gridBuffer,this._gridIndexBuffer,e?this._gridSegments[t].withSkirts:this._gridSegments[t].withoutSkirts]}getPoleBuffers(t,e){return[e?this._texturedPoleNorthVertexBuffer:this._poleNorthVertexBuffer,e?this._texturedPoleSouthVertexBuffer:this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[t]]}},t.ct=function(t){return Ti.has(t)},t.cu=Kp,t.cv=function(t,e,n=0,i=!0){const a=new Ve(n,n),r=t.sub(a),o=e.add(a),s=[r,new Ve(o.x,r.y),o,new Ve(r.x,o.y)];return i&&s.push(r.clone()),s},t.cw=function(t,e){const n=[];for(let i=0;i<t.length;i++){const a=Qe(i-1,-1,t.length-1),r=Qe(i+1,-1,t.length-1),o=t[i],s=t[r],l=t[a].sub(o).unit(),c=s.sub(o).unit(),u=c.angleWithSep(l.x,l.y),h=l.add(c).unit().mult(-1*e/Math.sin(u/2));n.push(o.add(h))}return n},t.cx=n_,t.cy=rh,t.cz=function(e,n,i=0){return t._.fromValues(((n.x-i)*e.scale-e.x)*ur,(n.y*e.scale-e.y)*ur,Iu(n.z,n.y))},t.d=Li,t.d$=Ne,t.d0=Ze,t.d1=function(){return!!document.fullscreenElement||!!document.webkitFullscreenElement},t.d2=Ye,t.d3=Lu,t.d4=uu,t.d5=function([t,e,n]){const i=Math.hypot(t,e,n),a=Math.atan2(t,n),r=.5*Math.PI-Math.acos(-e/i);return new pu($e(a),$e(r))},t.d6=Mu,t.d7=hu,t.d8=i,t.d9=Yh,t.dA=function(t){const e=Un();if(!e)return;const n=e.delete(Rn);t&&n.catch(t).then((()=>t()))},t.dB=tv,t.dC=dv,t.dD=function(t){sv=Ln.resolveURL(t),hv||(hv=new Jx(rv(),new Bi)),hv.broadcast("setDracoUrl",sv)},t.dE=pv,t.dF=function(t){cv=Ln.resolveURL(t),hv||(hv=new Jx(rv(),new Bi)),hv.broadcast("setMeshoptUrl",cv)},t.dG=tn,t.dH=bs,t.dI=ud,t.dJ=kg,t.dK=e_,t.dL=uc,t.dM=sm,t.dN=Lm,t.dO=Zf,t.dP=un,t.dQ=Eg,t.dR=U_,t.dS=function(t,e,n,i,a,r,o,s,l,c,u){t.createArrays(),t.tilePixelRatio=ur/(512*t.overscaling),t.compareText={},t.iconsNeedLinear=!1;const h=t.layers[0].layout,d=t.layers[0]._unevaluatedLayout._values,p={};if("composite"===t.textSizeData.kind){const{minZoom:e,maxZoom:n}=t.textSizeData;p.compositeTextSizes=[d["text-size"].possiblyEvaluate(new Hs(e),s),d["text-size"].possiblyEvaluate(new Hs(n),s)]}if("composite"===t.iconSizeData.kind){const{minZoom:e,maxZoom:n}=t.iconSizeData;p.compositeIconSizes=[d["icon-size"].possiblyEvaluate(new Hs(e),s),d["icon-size"].possiblyEvaluate(new Hs(n),s)]}p.layoutTextSize=d["text-size"].possiblyEvaluate(new Hs(l+1),s),p.layoutIconSize=d["icon-size"].possiblyEvaluate(new Hs(l+1),s),p.textMaxSize=d["text-size"].possiblyEvaluate(new Hs(18),s);const f="map"===h.get("text-rotation-alignment")&&"point"!==h.get("symbol-placement"),m=h.get("text-size");let g=!1;for(const e of t.features)if(e.icon&&e.icon.nameSecondary){g=!0;break}for(const r of t.features){const l=h.get("text-font").evaluate(r,{},s).join(","),d=m.evaluate(r,{},s),_=p.layoutTextSize.evaluate(r,{},s),y=(p.layoutIconSize.evaluate(r,{},s),{horizontal:{},vertical:void 0}),x=r.text;let v,b=[0,0];if(x){const i=x.toString(),o=h.get("text-letter-spacing").evaluate(r,{},s)*Rm,c=h.get("text-line-height").evaluate(r,{},s)*Rm,u=Ms(i)?o:0,p=h.get("text-anchor").evaluate(r,{},s),m=h.get("text-variable-anchor");if(!m){const t=h.get("text-radial-offset").evaluate(r,{},s);b=t?qg(p,[t*Rm,Ug]):h.get("text-offset").evaluate(r,{},s).map((t=>t*Rm))}let g=f?"center":h.get("text-justify").evaluate(r,{},s);const v="point"===h.get("symbol-placement"),w=v?h.get("text-max-width").evaluate(r,{},s)*Rm:1/0,A=r=>{t.allowVerticalPlacement&&Ss(i)&&(y.vertical=eg(x,e,n,a,l,w,c,p,r,u,b,Qm.vertical,!0,_,d))};if(!f&&m){const t="auto"===g?m.map((t=>$g(t))):[g];let i=!1;for(let r=0;r<t.length;r++){const o=t[r];if(!y.horizontal[o])if(i)y.horizontal[o]=y.horizontal[0];else{const t=eg(x,e,n,a,l,w,c,"center",o,u,b,Qm.horizontal,!1,_,d);t&&(y.horizontal[o]=t,i=1===t.positionedLines.length)}}A("left")}else{if("auto"===g&&(g=$g(p)),v||h.get("text-writing-mode").indexOf("horizontal")>=0||!Ss(i)){const t=eg(x,e,n,a,l,w,c,p,g,u,b,Qm.horizontal,!1,_,d);t&&(y.horizontal[g]=t)}A(v?"left":g)}}let w=!1;if(r.icon&&r.icon.namePrimary){const e=i[r.icon.namePrimary];e&&(v=hg(a[r.icon.namePrimary],r.icon.nameSecondary?a[r.icon.nameSecondary]:void 0,h.get("icon-offset").evaluate(r,{},s),h.get("icon-anchor").evaluate(r,{},s)),w=e.sdf,void 0===t.sdfIcons?t.sdfIcons=e.sdf:t.sdfIcons!==e.sdf&&fn("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(e.pixelRatio!==t.pixelRatio||0!==h.get("icon-rotate").constantOr(1))&&(t.iconsNeedLinear=!0))}const A=Xg(y.horizontal)||y.vertical;t.iconsInText||(t.iconsInText=!!A&&A.iconsInText),(A||v)&&Wg(t,r,y,v,i,p,_,0,b,w,o,s,c,u,g)}r&&t.generateCollisionDebugBuffers(l,t.collisionBoxArray)},t.dT=Qf,t.dU=Yd,t.dV=bp,t.dW=Im,t.dX=Yp,t.dY=Ny,t.dZ=wp,t.d_=cp,t.da=Zh,t.db=function(e){const n=[0,0,0],i=t.ad.identity(new Float64Array(16));return t.ad.multiply(i,e.pixelMatrix,e.globeMatrix),t._.transformMat4(n,n,i),new Ve(n[0],n[1])},t.dc=u,t.dd=c,t.de=function(t){const e=t.navigator?t.navigator.userAgent:null;return!!function(t){if(null==Tn){const e=t.navigator?t.navigator.userAgent:null;Tn=!!t.safari||!(!e||!(/\b(iPad|iPhone|iPod)\b/.test(e)||e.match("Safari")&&!e.match("Chrome")))}return Tn}(t)&&e&&(e.match("Version/15.4")||e.match("Version/15.5")||e.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},t.df=an,t.dg=class{constructor(t,e,n){this._transformRequestFn=t,this._customAccessToken=e,this._silenceAuthErrors=!!n,this._createSkuToken()}_createSkuToken(){const t=function(){let t="";for(let e=0;e<10;e++)t+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",li,t].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=t.token,this._skuTokenExpiresAt=t.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(t,e){return this._transformRequestFn&&this._transformRequestFn(t,e)||{url:t}}normalizeStyleURL(t,n){if(!r(t))return t;const i=hi(t);return i.params.push(`sdk=js-${e}`),i.path=`/styles/v1${i.path}`,this._makeAPIURL(i,this._customAccessToken||n)}normalizeGlyphsURL(t,e){if(!r(t))return t;const n=hi(t);return n.path=`/fonts/v1${n.path}`,this._makeAPIURL(n,this._customAccessToken||e)}normalizeModelURL(t,e){if(!r(t))return t;const n=hi(t);return n.path=`/models/v1${n.path}`,this._makeAPIURL(n,this._customAccessToken||e)}normalizeSourceURL(t,e,n,i){if(!r(t))return t;const a=hi(t);return a.path=`/v4/${a.authority}.json`,a.params.push("secure"),n&&a.params.push(`language=${n}`),i&&a.params.push(`worldview=${i}`),this._makeAPIURL(a,this._customAccessToken||e)}normalizeSpriteURL(t,e,n,i){const a=hi(t);return r(t)?(a.path=`/styles/v1${a.path}/sprite${e}${n}`,this._makeAPIURL(a,this._customAccessToken||i)):(a.path+=`${e}${n}`,di(a))}normalizeTileURL(t,e,n){if(this._isSkuTokenExpired()&&this._createSkuToken(),t&&!r(t))return t;const a=hi(t);a.path=a.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${e||n&&"raster"!==a.authority&&512===n?"@2x":""}${$n.supported?".webp":"$1"}`),"raster"===a.authority?a.path=`/${i.RASTER_URL_PREFIX}${a.path}`:"rasterarrays"===a.authority?a.path=`/${i.RASTERARRAYS_URL_PREFIX}${a.path}`:"3dtiles"===a.authority?a.path=`/${i.TILES3D_URL_PREFIX}${a.path}`:(a.path=a.path.replace(/^.+\/v4\//,"/"),a.path=`/${i.TILE_URL_VERSION}${a.path}`);const o=this._customAccessToken||function(t){for(const e of t){const t=e.match(/^access_token=(.*)$/);if(t)return t[1]}return null}(a.params)||i.ACCESS_TOKEN;return i.REQUIRE_ACCESS_TOKEN&&o&&this._skuToken&&a.params.push(`sku=${this._skuToken}`),this._makeAPIURL(a,o)}canonicalizeTileURL(t,e){const n=hi(t);if(!n.path.match(/^(\/v4\/|\/(raster|rasterarrays)\/v1\/)/)||!n.path.match(/\.[\w]+$/))return t;let a="mapbox://";n.path.match(/^\/raster\/v1\//)?a+=`raster/${n.path.replace(`/${i.RASTER_URL_PREFIX}/`,"")}`:n.path.match(/^\/rasterarrays\/v1\//)?a+=`rasterarrays/${n.path.replace(`/${i.RASTERARRAYS_URL_PREFIX}/`,"")}`:a+=`tiles/${n.path.replace(`/${i.TILE_URL_VERSION}/`,"")}`;let r=n.params;return e&&(r=r.filter((t=>!t.match(/^access_token=/)))),r.length&&(a+=`?${r.join("&")}`),a}canonicalizeTileset(t,e){const n=!!e&&r(e),i=[];for(const e of t.tiles||[])a(e)?i.push(this.canonicalizeTileURL(e,n)):i.push(e);return i}_makeAPIURL(t,e){const n="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",a=hi(i.API_URL);if(t.protocol=a.protocol,t.authority=a.authority,"http"===t.protocol){const e=t.params.indexOf("secure");e>=0&&t.params.splice(e,1)}if("/"!==a.path&&(t.path=`${a.path}${t.path}`),!i.REQUIRE_ACCESS_TOKEN)return di(t);if(e=e||i.ACCESS_TOKEN,!this._silenceAuthErrors){if(!e)throw new Error(`An API access token is required to use Mapbox GL. ${n}`);if("s"===e[0])throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${n}`)}return t.params=t.params.filter((t=>-1===t.indexOf("access_token"))),t.params.push(`access_token=${e||""}`),di(t)}},t.dh=function(t,e){e?Ti.add(t):Ti.delete(t)},t.di=$n,t.dj=Ai,t.dk=Ei,t.dl=ci,t.dm=xi,t.dn=bi,t.dp=function(t){Ti.delete(t)},t.dq=Ci,t.dr=yi,t.ds=Je,t.dt=e,t.du=function(t,e){jn=t,Vn=e},t.dv=function(t,e,n=!1){if(Ns===Bs||Ns===Os||Ns===Rs)throw new Error("setRTLTextPlugin cannot be called multiple times.");js=Ln.resolveURL(t),Ns=Bs,Fs=e,Us(),n||$s()},t.dw=qs,t.dx=function(){rv().acquire(nv)},t.dy=function(){const t=av;t&&(t.isPreloaded()&&1===t.numActive()?(t.release(nv),av=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},t.dz=iv,t.e=Ln,t.e0=cm,t.e1=d,t.e2=ni,t.e3=function(t){let e=0;if(new Uint32Array(t,0,1)[0]!==wv){const n=new Uint32Array(t,0,7),[,,i,a,r,o]=n;e=n.byteLength+a+r+o+r,(i!==t.byteLength||e>=t.byteLength)&&fn("Invalid b3dm header information.")}return Mv(t,e)},t.e4=function(t,e){const n=Ov(t);for(const t of n){for(const e of t.meshes)Rv(e);t.lights&&(t.lightMeshIndex=t.meshes.length,t.meshes.push(Fv(t.lights,e)))}return n},t.e5=$v,t.e6=Qx,t.e7=Ws,t.e8=function(t){Gn(),Fn&&Fn.then((e=>{e.keys().then((n=>{for(let i=0;i<n.length-t;i++)e.delete(n[i])}))}))},t.f=Di,t.g=function(t,e){return ei(en(t,{type:"json"}),e)},t.h=si,t.i=hd,t.j=wg,t.k=Cg,t.l=function(t){return fetch(t).then((t=>t.arrayBuffer())).then((e=>Mv(e,0,t)))},t.m=class extends Bx{},t.n=Ea,t.o=Wi,t.p=J_,t.q=Xo,t.r=Qo,t.s=Jo,t.t=cs,t.u=sl,t.v=ll,t.w=fn,t.x=ps,t.y=us,t.z=$r})),i(0,(function(t){function e(t){const e=t?t.url.toString():void 0;return e?performance.getEntriesByName(e):[]}function n(t){if("number"==typeof t||"boolean"==typeof t||"string"==typeof t||null==t)return JSON.stringify(t);if(Array.isArray(t)){let e="[";for(const i of t)e+=`${n(i)},`;return`${e}]`}let e="{";for(const i of Object.keys(t).sort())e+=`${i}:${n(t[i])},`;return`${e}}`}function i(e){let i="";for(const a of t.cE)i+=`/${n(e[a])}`;return i}class a{constructor(t){this.keyCache={},this._layers={},this._layerConfigs={},t&&this.replace(t)}replace(t,e){this._layerConfigs={},this._layers={},this.update(t,[],e)}update(e,n,a){this._options=a;for(const n of e)this._layerConfigs[n.id]=n,(this._layers[n.id]=t.cY(n,this.scope,null,this._options)).compileFilter(),this.keyCache[n.id]&&delete this.keyCache[n.id];for(const t of n)delete this.keyCache[t],delete this._layerConfigs[t],delete this._layers[t];this.familiesBySource={};const r=function(t,e){const n={};for(let a=0;a<t.length;a++){const r=e&&e[t[a].id]||i(t[a]);e&&(e[t[a].id]=r);let o=n[r];o||(o=n[r]=[]),o.push(t[a])}const a=[];for(const t in n)a.push(n[t]);return a}(t.dG(this._layerConfigs),this.keyCache);for(const t of r){const e=t.map((t=>this._layers[t.id])),n=e[0];if("none"===n.visibility)continue;const i=n.source||"";let a=this.familiesBySource[i];a||(a=this.familiesBySource[i]={});const r=n.sourceLayer||"_geojsonTileLayer";let o=a[r];o||(o=a[r]=[]),o.push(e)}}}const r=1*t.dJ;class o{constructor(e){const n={},i=[];for(const t in e){const a=e[t],o=n[t]={};for(const t in a.glyphs){const e=a.glyphs[+t];if(!e||0===e.bitmap.width||0===e.bitmap.height)continue;const n=e.metrics.localGlyph?r:1,s={x:0,y:0,w:e.bitmap.width+2*n,h:e.bitmap.height+2*n};i.push(s),o[t]=s}}const{w:a,h:o}=t.j(i),s=new t.dI({width:a||1,height:o||1});for(const i in e){const a=e[i];for(const e in a.glyphs){const o=a.glyphs[+e];if(!o||0===o.bitmap.width||0===o.bitmap.height)continue;const l=n[i][e],c=o.metrics.localGlyph?r:1;t.dI.copy(o.bitmap,s,{x:0,y:0},{x:l.x+c,y:l.y+c},o.bitmap)}}this.image=s,this.positions=n}}t.dH(o,"GlyphAtlas");class s{constructor(e){this.tileID=new t.aL(e.tileID.overscaledZ,e.tileID.wrap,e.tileID.canonical.z,e.tileID.canonical.x,e.tileID.canonical.y),this.tileZoom=e.tileZoom,this.uid=e.uid,this.zoom=e.zoom,this.lut=e.lut,this.canonical=e.tileID.canonical,this.pixelRatio=e.pixelRatio,this.tileSize=e.tileSize,this.source=e.source,this.scope=e.scope,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=e.showCollisionBoxes,this.collectResourceTiming=!!e.collectResourceTiming,this.promoteId=e.promoteId,this.isSymbolTile=e.isSymbolTile,this.tileTransform=t.dK(e.tileID.canonical,e.projection),this.projection=e.projection,this.brightness=e.brightness,this.extraShadowCaster=!!e.extraShadowCaster,this.tessellationStep=e.tessellationStep}parse(e,n,i,a,r){this.status="parsing",this.data=e,this.collisionBoxArray=new t.dL;const s=new t.dM(Object.keys(e.layers).sort()),c=new t.dN(this.tileID,this.promoteId);c.bucketLayerIDs=[];const u={},h=new t.dO(256,256),d={featureIndex:c,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:h,availableImages:i,brightness:this.brightness},p=n.familiesBySource[this.source];for(const n in p){const a=e.layers[n];if(!a)continue;let r=!1,o=!1,h=!1;for(const t of p[n])"symbol"===t[0].type?r=!0:o=!0,t[0].is3D()&&"model"!==t[0].type&&(h=!0);if(this.extraShadowCaster&&!h)continue;if(!0===this.isSymbolTile&&!r)continue;if(!1===this.isSymbolTile&&!o)continue;1===a.version&&t.w(`Vector tile source "${this.source}" layer "${n}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const f=s.encode(n),m=[];for(let t=0;t<a.length;t++){const e=a.feature(t),i=c.getId(e,n);m.push({feature:e,id:i,index:t,sourceLayerIndex:f})}for(const t of p[n]){const e=t[0];(!this.extraShadowCaster||e.is3D()&&"model"!==e.type)&&(void 0!==this.isSymbolTile&&"symbol"===e.type!==this.isSymbolTile||e.minzoom&&this.zoom<Math.floor(e.minzoom)||e.maxzoom&&this.zoom>=e.maxzoom||"none"!==e.visibility&&(l(t,this.zoom,d.brightness,i),(u[e.id]=e.createBucket({index:c.bucketLayerIDs.length,layers:t,zoom:this.zoom,lut:this.lut,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:f,sourceID:this.source,projection:this.projection.spec,tessellationStep:this.tessellationStep})).populate(m,d,this.tileID.canonical,this.tileTransform),c.bucketLayerIDs.push(t.map((t=>t.id)))))}}let f,m,g,_;h.trim();const y={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},x=()=>{if(f)return this.status="done",r(f);if(this.extraShadowCaster)this.status="done",r(null,{buckets:t.dG(u).filter((t=>!t.isEmpty())),featureIndex:c,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:d.brightness,glyphMap:null,iconMap:null,glyphPositions:null});else if(m&&g&&_){const e=new o(m),n=new t.dQ(g,_,this.lut);for(const a in u){const r=u[a];r instanceof t.dR?(l(r.layers,this.zoom,d.brightness,i),t.dS(r,m,e.positions,g,n.iconPositions,this.showCollisionBoxes,i,this.tileID.canonical,this.tileZoom,this.projection,this.brightness)):r.hasPattern&&(r instanceof t.dT||r instanceof t.dU||r instanceof t.b_)&&(l(r.layers,this.zoom,d.brightness,i),r.addFeatures(d,this.tileID.canonical,n.patternPositions,i,this.tileTransform,this.brightness))}this.status="done",r(null,{buckets:t.dG(u).filter((t=>!t.isEmpty())),featureIndex:c,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:e.image,lineAtlas:h,imageAtlas:n,brightness:d.brightness})}};if(!this.extraShadowCaster){const e=t.dP(d.glyphDependencies,(t=>Object.keys(t).map(Number)));Object.keys(e).length?a.send("getGlyphs",{uid:this.uid,stacks:e,scope:this.scope},((t,e)=>{f||(f=t,m=e,x())}),void 0,!1,y):m={};const n=Object.keys(d.iconDependencies);n.length?a.send("getImages",{icons:n,source:this.source,scope:this.scope,tileID:this.tileID,type:"icons"},((t,e)=>{f||(f=t,g=e,x())}),void 0,!1,y):g={};const i=Object.keys(d.patternDependencies);i.length?a.send("getImages",{icons:i,source:this.source,scope:this.scope,tileID:this.tileID,type:"patterns"},((t,e)=>{f||(f=t,_=e,x())}),void 0,!1,y):_={}}x()}}function l(e,n,i,a){const r=new t.X(n,{brightness:i});for(const t of e)t.recalculate(r,a)}class c extends t.E{constructor(e,n,i,a,r,o){super(),this.actor=e,this.layerIndex=n,this.availableImages=i,this.loadVectorData=r||t.ap,this.loading={},this.loaded={},this.deduped=new t.ao(e.scheduler),this.isSpriteLoaded=a,this.scheduler=e.scheduler,this.brightness=o}loadTile(n,i){const a=n.uid,r=n&&n.request,o=r&&r.collectResourceTiming,l=this.loading[a]=new s(n);l.abort=this.loadVectorData(n,((s,c)=>{const u=!this.loading[a];if(delete this.loading[a],u||s||!c)return l.status="done",u||(this.loaded[a]=l),i(s);const h=c.rawData,d={};c.expires&&(d.expires=c.expires),c.cacheControl&&(d.cacheControl=c.cacheControl),l.vectorTile=c.vectorTile||new t.dV(new t.dW(h));const p=()=>{l.parse(l.vectorTile,this.layerIndex,this.availableImages,this.actor,((n,a)=>{if(n||!a)return i(n);const s={};if(o){const t=e(r);t.length>0&&(s.resourceTiming=JSON.parse(JSON.stringify(t)))}i(null,t.W({rawTileData:h.slice(0)},a,d,s))}))};this.isSpriteLoaded?p():this.once("isSpriteLoaded",(()=>{this.scheduler?this.scheduler.add(p,{type:"parseTile",isSymbolTile:n.isSymbolTile,zoom:n.tileZoom}):p()})),this.loaded=this.loaded||{},this.loaded[a]=l}))}reloadTile(e,n){const i=this.loaded,a=e.uid;if(i&&i[a]){const r=i[a];r.showCollisionBoxes=e.showCollisionBoxes,r.projection=e.projection,r.brightness=e.brightness,r.tileTransform=t.dK(e.tileID.canonical,e.projection),r.extraShadowCaster=e.extraShadowCaster,r.lut=e.lut;const o=(t,e)=>{const i=r.reloadCallback;i&&(delete r.reloadCallback,r.parse(r.vectorTile,this.layerIndex,this.availableImages,this.actor,i)),n(t,e)};"parsing"===r.status?r.reloadCallback=o:"done"===r.status&&(r.vectorTile?r.parse(r.vectorTile,this.layerIndex,this.availableImages,this.actor,o):o())}else n(null,void 0)}abortTile(t,e){const n=t.uid,i=this.loading[n];i&&(i.abort&&i.abort(),delete this.loading[n]),e()}removeTile(t,e){const n=this.loaded,i=t.uid;n&&n[i]&&delete n[i],e()}}class u{loadTile(e,n){const{uid:i,encoding:a,rawImageData:r,padding:o}=e,s=ImageBitmap&&r instanceof ImageBitmap?this.getImageData(r,o):r;n(null,new t.dX(i,s,a,o<1))}getImageData(t,e){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(t.width,t.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=t.width,this.offscreenCanvas.height=t.height,this.offscreenCanvasContext.drawImage(t,0,0,t.width,t.height);const n=this.offscreenCanvasContext.getImageData(-e,-e,t.width+2*e,t.height+2*e);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),n}}class h{decodeRasterArray({task:e,buffer:n},i){t.dY.performDecoding(n,e).then((t=>{i(null,t)}),(t=>{i(t)}))}}const d=t.dZ.prototype.toGeoJSON;let p=class{constructor(e){this._feature=e,this.extent=t.a3,this.type=e.type,this.properties=e.tags,"id"in e&&!isNaN(e.id)&&(this.id=parseInt(e.id,10))}loadGeometry(){if(1===this._feature.type){const e=[];for(const n of this._feature.geometry)e.push([new t.P(n[0],n[1])]);return e}{const e=[];for(const n of this._feature.geometry){const i=[];for(const e of n)i.push(new t.P(e[0],e[1]));e.push(i)}return e}}toGeoJSON(t,e,n){return d.call(this,t,e,n)}},f=class{constructor(e){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=t.a3,this.length=e.length,this._features=e}feature(t){return new p(this._features[t])}};const m=64/4096;class g{constructor(){this.features=new Map}clear(){this.features.clear()}load(t=[],e){for(const n of t){const t=n.id;if(null==t)continue;let i=this.features.get(t);i&&this.updateCache(i,e),n.geometry?(i=y(n),this.updateCache(i,e),this.features.set(t,i)):this.features.delete(t),this.updateCache(i,e)}}updateCache(t,e){for(const{canonical:n,uid:i}of Object.values(e)){const{z:a,x:r,y:o}=n;_(t,Math.pow(2,a),r,o)&&delete e[i]}}getTile(t,e,n){const i=Math.pow(2,t),a=[];for(const t of this.features.values())_(t,i,e,n)&&a.push(w(t,i,e,n));return{features:a}}getFeatures(){return[...this.features.values()]}}function _({minX:t,minY:e,maxX:n,maxY:i},a,r,o){return t<(r+1+m)/a&&e<(o+1+m)/a&&n>(r-m)/a&&i>(o-m)/a}function y(t){const{id:e,geometry:n,properties:i}=t;if(!n)return;if("GeometryCollection"===n.type)throw new Error("GeometryCollection not supported in dynamic mode.");const{type:a,coordinates:r}=n,o={id:e,type:1,geometry:[],tags:i,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0},s=o.geometry;if("Point"===a)x(r,s,o);else if("MultiPoint"===a)for(const t of r)x(t,s,o);else if("LineString"===a)o.type=2,v(r,s,o);else if("MultiLineString"===a)o.type=2,b(r,s,o);else if("Polygon"===a)o.type=3,b(r,s,o,!0);else{if("MultiPolygon"!==a)throw new Error("Input data is not a valid GeoJSON object.");o.type=3;for(const t of r)b(t,s,o,!0)}return o}function x([e,n],i,a){const r=t.aj(e);let o=t.ak(n);o=o<0?0:o>1?1:o,i.push(r,o),a.minX=Math.min(a.minX,r),a.minY=Math.min(a.minY,o),a.maxX=Math.max(a.maxX,r),a.maxY=Math.max(a.maxY,o)}function v(t,e,n,i=!1,a=!1){const r=[];for(const e of t)x(e,r,n);e.push(r),i&&function(t,e){let n=0;for(let e=0,i=t.length,a=i-2;e<i;a=e,e+=2)n+=(t[e]-t[a])*(t[e+1]+t[a+1]);if(n>0===e)for(let e=0,n=t.length;e<n/2;e+=2){const i=t[e],a=t[e+1];t[e]=t[n-2-e],t[e+1]=t[n-1-e],t[n-2-e]=i,t[n-1-e]=a}}(r,a)}function b(t,e,n,i=!1){for(let a=0;a<t.length;a++)v(t[a],e,n,i,0===a)}function w(t,e,n,i){const{id:a,type:r,geometry:o,tags:s}=t,l=[];if(1===r)A(o,e,n,i,l);else for(const t of o)l.push(A(t,e,n,i));return{id:a,type:r,geometry:l,tags:s}}function A(t,e,n,i,a=[]){for(let r=0;r<t.length;r+=2)a.push(C(t[r],t[r+1],e,n,i));return a}function C(e,n,i,a,r){return[Math.round(t.a3*(e*i-a)),Math.round(t.a3*(n*i-r))]}var E={exports:{}},T=t.d$,S=t.d_.VectorTileFeature,M=k;function k(t,e){this.options=e||{},this.features=t,this.length=t.length}function I(t,e){this.id="number"==typeof t.id?t.id:void 0,this.type=t.type,this.rawGeometry=1===t.type?[t.geometry]:t.geometry,this.properties=t.tags,this.extent=e||4096}k.prototype.feature=function(t){return new I(this.features[t],this.options.extent)},I.prototype.loadGeometry=function(){var t=this.rawGeometry;this.geometry=[];for(var e=0;e<t.length;e++){for(var n=t[e],i=[],a=0;a<n.length;a++)i.push(new T(n[a][0],n[a][1]));this.geometry.push(i)}return this.geometry},I.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var t=this.geometry,e=1/0,n=-1/0,i=1/0,a=-1/0,r=0;r<t.length;r++)for(var o=t[r],s=0;s<o.length;s++){var l=o[s];e=Math.min(e,l.x),n=Math.max(n,l.x),i=Math.min(i,l.y),a=Math.max(a,l.y)}return[e,i,n,a]},I.prototype.toGeoJSON=S.prototype.toGeoJSON;var P=t.e0,z=M;function D(t){var e=new P;return function(t,e){for(var n in t.layers)e.writeMessage(3,L,t.layers[n])}(t,e),e.finish()}function L(t,e){var n;e.writeVarintField(15,t.version||1),e.writeStringField(1,t.name||""),e.writeVarintField(5,t.extent||4096);var i={keys:[],values:[],keycache:{},valuecache:{}};for(n=0;n<t.length;n++)i.feature=t.feature(n),e.writeMessage(2,B,i);var a=i.keys;for(n=0;n<a.length;n++)e.writeStringField(3,a[n]);var r=i.values;for(n=0;n<r.length;n++)e.writeMessage(4,j,r[n])}function B(t,e){var n=t.feature;void 0!==n.id&&e.writeVarintField(1,n.id),e.writeMessage(2,O,t),e.writeVarintField(3,n.type),e.writeMessage(4,N,n)}function O(t,e){var n=t.feature,i=t.keys,a=t.values,r=t.keycache,o=t.valuecache;for(var s in n.properties){var l=n.properties[s],c=r[s];if(null!==l){void 0===c&&(i.push(s),r[s]=c=i.length-1),e.writeVarint(c);var u=typeof l;"string"!==u&&"boolean"!==u&&"number"!==u&&(l=JSON.stringify(l));var h=u+":"+l,d=o[h];void 0===d&&(a.push(l),o[h]=d=a.length-1),e.writeVarint(d)}}}function R(t,e){return(e<<3)+(7&t)}function F(t){return t<<1^t>>31}function N(t,e){for(var n=t.loadGeometry(),i=t.type,a=0,r=0,o=n.length,s=0;s<o;s++){var l=n[s],c=1;1===i&&(c=l.length),e.writeVarint(R(1,c));for(var u=3===i?l.length-1:l.length,h=0;h<u;h++){1===h&&1!==i&&e.writeVarint(R(2,u-1));var d=l[h].x-a,p=l[h].y-r;e.writeVarint(F(d)),e.writeVarint(F(p)),a+=d,r+=p}3===i&&e.writeVarint(R(7,1))}}function j(t,e){var n=typeof t;"string"===n?e.writeStringField(1,t):"boolean"===n?e.writeBooleanField(7,t):"number"===n&&(t%1!=0?e.writeDoubleField(3,t):t<0?e.writeSVarintField(6,t):e.writeVarintField(5,t))}E.exports=D,E.exports.fromVectorTileJs=D,E.exports.fromGeojsonVt=function(t,e){e=e||{};var n={};for(var i in t)n[i]=new z(t[i].features,e),n[i].name=i,n[i].version=e.version,n[i].extent=e.extent;return D({layers:n})},E.exports.GeoJSONWrapper=z;var V=t.e1(E.exports);const U={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:t=>t},G=Math.fround||(q=new Float32Array(1),t=>(q[0]=+t,q[0]));var q;const $=3,W=5,H=6;class Z{constructor(t){this.options=Object.assign(Object.create(U),t),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(t){const{log:e,minZoom:n,maxZoom:i}=this.options;e&&console.time("total time");const a=`prepare ${t.length} points`;e&&console.time(a),this.points=t;const r=[];for(let e=0;e<t.length;e++){const n=t[e];if(!n.geometry)continue;const[i,a]=n.geometry.coordinates,o=G(K(i)),s=G(Q(a));r.push(o,s,1/0,e,-1,1),this.options.reduce&&r.push(0)}let o=this.trees[i+1]=this._createTree(r);e&&console.timeEnd(a);for(let t=i;t>=n;t--){const n=+Date.now();o=this.trees[t]=this._createTree(this._cluster(o,t)),e&&console.log("z%d: %d clusters in %dms",t,o.numItems,+Date.now()-n)}return e&&console.timeEnd("total time"),this}getClusters(t,e){let n=((t[0]+180)%360+360)%360-180;const i=Math.max(-90,Math.min(90,t[1]));let a=180===t[2]?180:((t[2]+180)%360+360)%360-180;const r=Math.max(-90,Math.min(90,t[3]));if(t[2]-t[0]>=360)n=-180,a=180;else if(n>a){const t=this.getClusters([n,i,180,r],e),o=this.getClusters([-180,i,a,r],e);return t.concat(o)}const o=this.trees[this._limitZoom(e)],s=o.range(K(n),Q(r),K(a),Q(i)),l=o.data,c=[];for(const t of s){const e=this.stride*t;c.push(l[e+W]>1?Y(l,e,this.clusterProps):this.points[l[e+$]])}return c}getChildren(t){const e=this._getOriginId(t),n=this._getOriginZoom(t),i="No cluster with the specified id.",a=this.trees[n];if(!a)throw new Error(i);const r=a.data;if(e*this.stride>=r.length)throw new Error(i);const o=this.options.radius/(this.options.extent*Math.pow(2,n-1)),s=a.within(r[e*this.stride],r[e*this.stride+1],o),l=[];for(const e of s){const n=e*this.stride;r[n+4]===t&&l.push(r[n+W]>1?Y(r,n,this.clusterProps):this.points[r[n+$]])}if(0===l.length)throw new Error(i);return l}getLeaves(t,e,n){const i=[];return this._appendLeaves(i,t,e=e||10,n=n||0,0),i}getTile(t,e,n){const i=this.trees[this._limitZoom(t)],a=Math.pow(2,t),{extent:r,radius:o}=this.options,s=o/r,l=(n-s)/a,c=(n+1+s)/a,u={features:[]};return this._addTileFeatures(i.range((e-s)/a,l,(e+1+s)/a,c),i.data,e,n,a,u),0===e&&this._addTileFeatures(i.range(1-s/a,l,1,c),i.data,a,n,a,u),e===a-1&&this._addTileFeatures(i.range(0,l,s/a,c),i.data,-1,n,a,u),u.features.length?u:null}getClusterExpansionZoom(t){let e=this._getOriginZoom(t)-1;for(;e<=this.options.maxZoom;){const n=this.getChildren(t);if(e++,1!==n.length)break;t=n[0].properties.cluster_id}return e}_appendLeaves(t,e,n,i,a){const r=this.getChildren(e);for(const e of r){const r=e.properties;if(r&&r.cluster?a+r.point_count<=i?a+=r.point_count:a=this._appendLeaves(t,r.cluster_id,n,i,a):a<i?a++:t.push(e),t.length===n)break}return a}_createTree(e){const n=new t.cK(e.length/this.stride|0,this.options.nodeSize,Float32Array);for(let t=0;t<e.length;t+=this.stride)n.add(e[t],e[t+1]);return n.finish(),n.data=e,n}_addTileFeatures(t,e,n,i,a,r){for(const o of t){const t=o*this.stride,s=e[t+W]>1;let l,c,u;if(s)l=X(e,t,this.clusterProps),c=e[t],u=e[t+1];else{const n=this.points[e[t+$]];l=n.properties;const[i,a]=n.geometry.coordinates;c=K(i),u=Q(a)}const h={type:1,geometry:[[Math.round(this.options.extent*(c*a-n)),Math.round(this.options.extent*(u*a-i))]],tags:l};let d;d=s||this.options.generateId?e[t+$]:this.points[e[t+$]].id,void 0!==d&&(h.id=d),r.features.push(h)}}_limitZoom(t){return Math.max(this.options.minZoom,Math.min(Math.floor(+t),this.options.maxZoom+1))}_cluster(t,e){const{radius:n,extent:i,reduce:a,minPoints:r}=this.options,o=n/(i*Math.pow(2,e)),s=t.data,l=[],c=this.stride;for(let n=0;n<s.length;n+=c){if(s[n+2]<=e)continue;s[n+2]=e;const i=s[n],u=s[n+1],h=t.within(s[n],s[n+1],o),d=s[n+W];let p=d;for(const t of h){const n=t*c;s[n+2]>e&&(p+=s[n+W])}if(p>d&&p>=r){let t,r=i*d,o=u*d,f=-1;const m=(n/c<<5)+(e+1)+this.points.length;for(const i of h){const l=i*c;if(s[l+2]<=e)continue;s[l+2]=e;const u=s[l+W];r+=s[l]*u,o+=s[l+1]*u,s[l+4]=m,a&&(t||(t=this._map(s,n,!0),f=this.clusterProps.length,this.clusterProps.push(t)),a(t,this._map(s,l)))}s[n+4]=m,l.push(r/p,o/p,1/0,m,-1,p),a&&l.push(f)}else{for(let t=0;t<c;t++)l.push(s[n+t]);if(p>1)for(const t of h){const n=t*c;if(!(s[n+2]<=e)){s[n+2]=e;for(let t=0;t<c;t++)l.push(s[n+t])}}}}return l}_getOriginId(t){return t-this.points.length>>5}_getOriginZoom(t){return(t-this.points.length)%32}_map(t,e,n){if(t[e+W]>1){const i=this.clusterProps[t[e+H]];return n?Object.assign({},i):i}const i=this.points[t[e+$]].properties,a=this.options.map(i);return n&&a===i?Object.assign({},a):a}}function Y(t,e,n){return{type:"Feature",id:t[e+$],properties:X(t,e,n),geometry:{type:"Point",coordinates:[(i=t[e],360*(i-.5)),J(t[e+1])]}};var i}function X(t,e,n){const i=t[e+W],a=i>=1e4?`${Math.round(i/1e3)}k`:i>=1e3?Math.round(i/100)/10+"k":i,r=t[e+H],o=-1===r?{}:Object.assign({},n[r]);return Object.assign(o,{cluster:!0,cluster_id:t[e+$],point_count:i,point_count_abbreviated:a})}function K(t){return t/360+.5}function Q(t){const e=Math.sin(t*Math.PI/180),n=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return n<0?0:n>1?1:n}function J(t){const e=(180-360*t)*Math.PI/180;return 360*Math.atan(Math.exp(e))/Math.PI-90}function tt(t,e,n,i){let a=i;const r=e+(n-e>>1);let o,s=n-e;const l=t[e],c=t[e+1],u=t[n],h=t[n+1];for(let i=e+3;i<n;i+=3){const e=et(t[i],t[i+1],l,c,u,h);if(e>a)o=i,a=e;else if(e===a){const t=Math.abs(i-r);t<s&&(o=i,s=t)}}a>i&&(o-e>3&&tt(t,e,o,i),t[o+2]=a,n-o>3&&tt(t,o,n,i))}function et(t,e,n,i,a,r){let o=a-n,s=r-i;if(0!==o||0!==s){const l=((t-n)*o+(e-i)*s)/(o*o+s*s);l>1?(n=a,i=r):l>0&&(n+=o*l,i+=s*l)}return o=t-n,s=e-i,o*o+s*s}function nt(t,e,n,i){const a={id:t??null,type:e,geometry:n,tags:i,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if("Point"===e||"MultiPoint"===e||"LineString"===e)it(a,n);else if("Polygon"===e)it(a,n[0]);else if("MultiLineString"===e)for(const t of n)it(a,t);else if("MultiPolygon"===e)for(const t of n)it(a,t[0]);return a}function it(t,e){for(let n=0;n<e.length;n+=3)t.minX=Math.min(t.minX,e[n]),t.minY=Math.min(t.minY,e[n+1]),t.maxX=Math.max(t.maxX,e[n]),t.maxY=Math.max(t.maxY,e[n+1])}function at(t,e,n,i){if(!e.geometry)return;const a=e.geometry.coordinates;if(a&&0===a.length)return;const r=e.geometry.type,o=Math.pow(n.tolerance/((1<<n.maxZoom)*n.extent),2);let s=[],l=e.id;if(n.promoteId?l=e.properties[n.promoteId]:n.generateId&&(l=i||0),"Point"===r)rt(a,s);else if("MultiPoint"===r)for(const t of a)rt(t,s);else if("LineString"===r)ot(a,s,o,!1);else if("MultiLineString"===r){if(n.lineMetrics){for(const n of a)s=[],ot(n,s,o,!1),t.push(nt(l,"LineString",s,e.properties));return}st(a,s,o,!1)}else if("Polygon"===r)st(a,s,o,!0);else{if("MultiPolygon"!==r){if("GeometryCollection"===r){for(const a of e.geometry.geometries)at(t,{id:l,geometry:a,properties:e.properties},n,i);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const t of a){const e=[];st(t,e,o,!0),s.push(e)}}t.push(nt(l,r,s,e.properties))}function rt(t,e){e.push(lt(t[0]),ct(t[1]),0)}function ot(t,e,n,i){let a,r,o=0;for(let n=0;n<t.length;n++){const s=lt(t[n][0]),l=ct(t[n][1]);e.push(s,l,0),n>0&&(o+=i?(a*l-s*r)/2:Math.sqrt(Math.pow(s-a,2)+Math.pow(l-r,2))),a=s,r=l}const s=e.length-3;e[2]=1,tt(e,0,s,n),e[s+2]=1,e.size=Math.abs(o),e.start=0,e.end=e.size}function st(t,e,n,i){for(let a=0;a<t.length;a++){const r=[];ot(t[a],r,n,i),e.push(r)}}function lt(t){return t/360+.5}function ct(t){const e=Math.sin(t*Math.PI/180),n=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return n<0?0:n>1?1:n}function ut(t,e,n,i,a,r,o,s){if(i/=e,r>=(n/=e)&&o<i)return t;if(o<n||r>=i)return null;const l=[];for(const e of t){const t=e.geometry;let r=e.type;const o=0===a?e.minX:e.minY,c=0===a?e.maxX:e.maxY;if(o>=n&&c<i){l.push(e);continue}if(c<n||o>=i)continue;let u=[];if("Point"===r||"MultiPoint"===r)ht(t,u,n,i,a);else if("LineString"===r)dt(t,u,n,i,a,!1,s.lineMetrics);else if("MultiLineString"===r)ft(t,u,n,i,a,!1);else if("Polygon"===r)ft(t,u,n,i,a,!0);else if("MultiPolygon"===r)for(const e of t){const t=[];ft(e,t,n,i,a,!0),t.length&&u.push(t)}if(u.length){if(s.lineMetrics&&"LineString"===r){for(const t of u)l.push(nt(e.id,r,t,e.tags));continue}"LineString"!==r&&"MultiLineString"!==r||(1===u.length?(r="LineString",u=u[0]):r="MultiLineString"),"Point"!==r&&"MultiPoint"!==r||(r=3===u.length?"Point":"MultiPoint"),l.push(nt(e.id,r,u,e.tags))}}return l.length?l:null}function ht(t,e,n,i,a){for(let r=0;r<t.length;r+=3){const o=t[r+a];o>=n&&o<=i&&mt(e,t[r],t[r+1],t[r+2])}}function dt(t,e,n,i,a,r,o){let s=pt(t);const l=0===a?gt:_t;let c,u,h=t.start;for(let d=0;d<t.length-3;d+=3){const p=t[d],f=t[d+1],m=t[d+2],g=t[d+3],_=t[d+4],y=0===a?p:f,x=0===a?g:_;let v=!1;o&&(c=Math.sqrt(Math.pow(p-g,2)+Math.pow(f-_,2))),y<n?x>n&&(u=l(s,p,f,g,_,n),o&&(s.start=h+c*u)):y>i?x<i&&(u=l(s,p,f,g,_,i),o&&(s.start=h+c*u)):mt(s,p,f,m),x<n&&y>=n&&(u=l(s,p,f,g,_,n),v=!0),x>i&&y<=i&&(u=l(s,p,f,g,_,i),v=!0),!r&&v&&(o&&(s.end=h+c*u),e.push(s),s=pt(t)),o&&(h+=c)}let d=t.length-3;const p=t[d],f=t[d+1],m=0===a?p:f;m>=n&&m<=i&&mt(s,p,f,t[d+2]),d=s.length-3,r&&d>=3&&(s[d]!==s[0]||s[d+1]!==s[1])&&mt(s,s[0],s[1],s[2]),s.length&&e.push(s)}function pt(t){const e=[];return e.size=t.size,e.start=t.start,e.end=t.end,e}function ft(t,e,n,i,a,r){for(const o of t)dt(o,e,n,i,a,r,!1)}function mt(t,e,n,i){t.push(e,n,i)}function gt(t,e,n,i,a,r){const o=(r-e)/(i-e);return mt(t,r,n+(a-n)*o,1),o}function _t(t,e,n,i,a,r){const o=(r-n)/(a-n);return mt(t,e+(i-e)*o,r,1),o}function yt(t,e){const n=[];for(let i=0;i<t.length;i++){const a=t[i],r=a.type;let o;if("Point"===r||"MultiPoint"===r||"LineString"===r)o=xt(a.geometry,e);else if("MultiLineString"===r||"Polygon"===r){o=[];for(const t of a.geometry)o.push(xt(t,e))}else if("MultiPolygon"===r){o=[];for(const t of a.geometry){const n=[];for(const i of t)n.push(xt(i,e));o.push(n)}}n.push(nt(a.id,r,o,a.tags))}return n}function xt(t,e){const n=[];n.size=t.size,void 0!==t.start&&(n.start=t.start,n.end=t.end);for(let i=0;i<t.length;i+=3)n.push(t[i]+e,t[i+1],t[i+2]);return n}function vt(t,e){if(t.transformed)return t;const n=1<<t.z,i=t.x,a=t.y;for(const r of t.features){const t=r.geometry,o=r.type;if(r.geometry=[],1===o)for(let o=0;o<t.length;o+=2)r.geometry.push(bt(t[o],t[o+1],e,n,i,a));else for(let o=0;o<t.length;o++){const s=[];for(let r=0;r<t[o].length;r+=2)s.push(bt(t[o][r],t[o][r+1],e,n,i,a));r.geometry.push(s)}}return t.transformed=!0,t}function bt(t,e,n,i,a,r){return[Math.round(n*(t*i-a)),Math.round(n*(e*i-r))]}function wt(t,e,n,i,a){const r=e===a.maxZoom?0:a.tolerance/((1<<e)*a.extent),o={features:[],numPoints:0,numSimplified:0,numFeatures:t.length,source:null,x:n,y:i,z:e,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const e of t)At(o,e,r,a);return o}function At(t,e,n,i){const a=e.geometry,r=e.type,o=[];if(t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),"Point"===r||"MultiPoint"===r)for(let e=0;e<a.length;e+=3)o.push(a[e],a[e+1]),t.numPoints++,t.numSimplified++;else if("LineString"===r)Ct(o,a,t,n,!1,!1);else if("MultiLineString"===r||"Polygon"===r)for(let e=0;e<a.length;e++)Ct(o,a[e],t,n,"Polygon"===r,0===e);else if("MultiPolygon"===r)for(let e=0;e<a.length;e++){const i=a[e];for(let e=0;e<i.length;e++)Ct(o,i[e],t,n,!0,0===e)}if(o.length){let n=e.tags||null;if("LineString"===r&&i.lineMetrics){n={};for(const t in e.tags)n[t]=e.tags[t];n.mapbox_clip_start=a.start/a.size,n.mapbox_clip_end=a.end/a.size}const s={geometry:o,type:"Polygon"===r||"MultiPolygon"===r?3:"LineString"===r||"MultiLineString"===r?2:1,tags:n};null!==e.id&&(s.id=e.id),t.features.push(s)}}function Ct(t,e,n,i,a,r){const o=i*i;if(i>0&&e.size<(a?o:i))return void(n.numPoints+=e.length/3);const s=[];for(let t=0;t<e.length;t+=3)(0===i||e[t+2]>o)&&(n.numSimplified++,s.push(e[t],e[t+1])),n.numPoints++;a&&function(t,e){let n=0;for(let e=0,i=t.length,a=i-2;e<i;a=e,e+=2)n+=(t[e]-t[a])*(t[e+1]+t[a+1]);if(n>0===e)for(let e=0,n=t.length;e<n/2;e+=2){const i=t[e],a=t[e+1];t[e]=t[n-2-e],t[e+1]=t[n-1-e],t[n-2-e]=i,t[n-1-e]=a}}(s,r),t.push(s)}const Et={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class Tt{constructor(t,e){const n=(e=this.options=function(t,e){for(const n in e)t[n]=e[n];return t}(Object.create(Et),e)).debug;if(n&&console.time("preprocess data"),e.maxZoom<0||e.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(e.promoteId&&e.generateId)throw new Error("promoteId and generateId cannot be used together.");let i=function(t,e){const n=[];if("FeatureCollection"===t.type)for(let i=0;i<t.features.length;i++)at(n,t.features[i],e,i);else at(n,"Feature"===t.type?t:{geometry:t},e);return n}(t,e);this.tiles={},this.tileCoords=[],n&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",e.indexMaxZoom,e.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),i=function(t,e){const n=e.buffer/e.extent;let i=t;const a=ut(t,1,-1-n,n,0,-1,2,e),r=ut(t,1,1-n,2+n,0,-1,2,e);return(a||r)&&(i=ut(t,1,-n,1+n,0,-1,2,e)||[],a&&(i=yt(a,1).concat(i)),r&&(i=i.concat(yt(r,-1)))),i}(i,e),i.length&&this.splitTile(i,0,0,0),n&&(i.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(t,e,n,i,a,r,o){const s=[t,e,n,i],l=this.options,c=l.debug;for(;s.length;){i=s.pop(),n=s.pop(),e=s.pop(),t=s.pop();const u=1<<e,h=St(e,n,i);let d=this.tiles[h];if(!d&&(c>1&&console.time("creation"),d=this.tiles[h]=wt(t,e,n,i,l),this.tileCoords.push({z:e,x:n,y:i}),c)){c>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",e,n,i,d.numFeatures,d.numPoints,d.numSimplified),console.timeEnd("creation"));const t=`z${e}`;this.stats[t]=(this.stats[t]||0)+1,this.total++}if(d.source=t,null==a){if(e===l.indexMaxZoom||d.numPoints<=l.indexMaxPoints)continue}else{if(e===l.maxZoom||e===a)continue;if(null!=a){const t=a-e;if(n!==r>>t||i!==o>>t)continue}}if(d.source=null,0===t.length)continue;c>1&&console.time("clipping");const p=.5*l.buffer/l.extent,f=.5-p,m=.5+p,g=1+p;let _=null,y=null,x=null,v=null,b=ut(t,u,n-p,n+m,0,d.minX,d.maxX,l),w=ut(t,u,n+f,n+g,0,d.minX,d.maxX,l);t=null,b&&(_=ut(b,u,i-p,i+m,1,d.minY,d.maxY,l),y=ut(b,u,i+f,i+g,1,d.minY,d.maxY,l),b=null),w&&(x=ut(w,u,i-p,i+m,1,d.minY,d.maxY,l),v=ut(w,u,i+f,i+g,1,d.minY,d.maxY,l),w=null),c>1&&console.timeEnd("clipping"),s.push(_||[],e+1,2*n,2*i),s.push(y||[],e+1,2*n,2*i+1),s.push(x||[],e+1,2*n+1,2*i),s.push(v||[],e+1,2*n+1,2*i+1)}}getTile(t,e,n){t=+t,e=+e,n=+n;const i=this.options,{extent:a,debug:r}=i;if(t<0||t>24)return null;const o=1<<t,s=St(t,e=e+o&o-1,n);if(this.tiles[s])return vt(this.tiles[s],a);r>1&&console.log("drilling down to z%d-%d-%d",t,e,n);let l,c=t,u=e,h=n;for(;!l&&c>0;)c--,u>>=1,h>>=1,l=this.tiles[St(c,u,h)];return l&&l.source?(r>1&&(console.log("found parent tile z%d-%d-%d",c,u,h),console.time("drilling down")),this.splitTile(l.source,c,u,h,t,e,n),r>1&&console.timeEnd("drilling down"),this.tiles[s]?vt(this.tiles[s],a):null):null}}function St(t,e,n){return 32*((1<<t)*n+e)+t}function Mt(t,e){const n=t.tileID.canonical;if(!this._geoJSONIndex)return e(null,null);const i=this._geoJSONIndex.getTile(n.z,n.x,n.y);if(!i)return e(null,null);const a=new f(i.features);let r=V(a);0===r.byteOffset&&r.byteLength===r.buffer.byteLength||(r=new Uint8Array(r)),e(null,{vectorTile:a,rawData:r.buffer})}class kt extends c{constructor(t,e,n,i,a,r){super(t,e,n,i,Mt,r),a&&(this.loadGeoJSON=a),this._dynamicIndex=new g}loadData(n,i){const a=n&&n.request,r=a&&a.collectResourceTiming;this.loadGeoJSON(n,((o,s)=>{if(o||!s)return i(o);if("object"!=typeof s)return i(new Error(`Input data given to '${n.source}' is not a valid GeoJSON object.`));{try{if(n.filter){const e=t.y(n.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if("error"===e.result)throw new Error(e.value.map((t=>`${t.key}: ${t.message}`)).join(", "));s.features=s.features.filter((t=>e.value.evaluate({zoom:0},t)))}n.dynamic?("Feature"===s.type&&(s={type:"FeatureCollection",features:[s]}),n.append||(this._dynamicIndex.clear(),this.loaded={}),this._dynamicIndex.load(s.features,this.loaded),n.cluster&&(s.features=this._dynamicIndex.getFeatures())):this.loaded={},this._geoJSONIndex=n.cluster?new Z(function({superclusterOptions:e,clusterProperties:n}){if(!n||!e)return e;const i={},a={},r={accumulated:null,zoom:0},o={properties:null},s=Object.keys(n);for(const e of s){const[r,o]=n[e],s=t.y(o),l=t.y("string"==typeof r?[r,["accumulated"],["get",e]]:r);i[e]=s.value,a[e]=l.value}return e.map=t=>{o.properties=t;const e={};for(const t of s)e[t]=i[t].evaluate(r,o);return e},e.reduce=(t,e)=>{o.properties=e;for(const e of s)r.accumulated=t[e],t[e]=a[e].evaluate(r,o)},e}(n)).load(s.features):n.dynamic?this._dynamicIndex:function(t,e){return new Tt(t,e)}(s,n.geojsonVtOptions)}catch(t){return i(t)}const o={};if(r){const t=e(a);t&&(o.resourceTiming={},o.resourceTiming[n.source]=JSON.parse(JSON.stringify(t)))}i(null,o)}}))}reloadTile(t,e){const n=this.loaded;return n&&n[t.uid]?t.partial?e(null,void 0):super.reloadTile(t,e):this.loadTile(t,e)}loadGeoJSON(e,n){if(e.request)t.g(e.request,n);else{if("string"!=typeof e.data)return n(new Error(`Input data given to '${e.source}' is not a valid GeoJSON object.`));try{return n(null,JSON.parse(e.data))}catch(t){return n(new Error(`Input data given to '${e.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(t,e){try{e(null,this._geoJSONIndex.getClusterExpansionZoom(t.clusterId))}catch(t){e(t)}}getClusterChildren(t,e){try{e(null,this._geoJSONIndex.getChildren(t.clusterId))}catch(t){e(t)}}getClusterLeaves(t,e){try{e(null,this._geoJSONIndex.getLeaves(t.clusterId,t.limit,t.offset))}catch(t){e(t)}}}class It{constructor(e,n){this.tileID=new t.aL(e.tileID.overscaledZ,e.tileID.wrap,e.tileID.canonical.z,e.tileID.canonical.x,e.tileID.canonical.y),this.tileZoom=e.tileZoom,this.uid=e.uid,this.zoom=e.zoom,this.canonical=e.tileID.canonical,this.pixelRatio=e.pixelRatio,this.tileSize=e.tileSize,this.source=e.source,this.overscaling=this.tileID.overscaleFactor(),this.projection=e.projection,this.brightness=n}parse(e,n,i,a){this.status="parsing";const r=new t.aL(i.tileID.overscaledZ,i.tileID.wrap,i.tileID.canonical.z,i.tileID.canonical.x,i.tileID.canonical.y),o={},s=n.familiesBySource[i.source],l=new t.dN(r,i.promoteId);return l.bucketLayerIDs=[],l.is3DTile=!0,t.e3(e).then((e=>{if(!e)return a(new Error("Could not parse tile"));const n=t.e4(e,1/t.b5(i.tileID.canonical)),c=e.json.extensionsUsed&&e.json.extensionsUsed.includes("MAPBOX_mesh_features")||e.json.asset.extras&&e.json.asset.extras.MAPBOX_mesh_features,u=e.json.extensionsUsed&&e.json.extensionsUsed.includes("EXT_meshopt_compression"),h=new t.X(this.zoom,{brightness:this.brightness});for(const e in s)for(const i of s[e]){const e=i[0];l.bucketLayerIDs.push(i.map((t=>t.id))),e.recalculate(h,[]);const a=new t.e5(n,r,c,u,this.brightness,l);c||(a.needsUpload=!0),o[e.fqid]=a,a.evaluate(e)}this.status="done",a(null,{buckets:o,featureIndex:l})})).catch((t=>a(new Error(t.message))))}}class Pt{constructor(t,e,n,i,a,r){this.actor=t,this.layerIndex=e,this.brightness=r,this.loading={},this.loaded={}}loadTile(e,n){const i=e.uid,a=this.loading[i]=new It(e,this.brightness);t.e2(e.request,((t,r)=>{const o=!this.loading[i];return delete this.loading[i],o||t?(a.status="done",o||(this.loaded[i]=a),n(t)):r&&0!==r.byteLength?void a.parse(r,this.layerIndex,e,((t,e)=>{a.status="done",this.loaded=this.loaded||{},this.loaded[i]=a,t||!e?n(t):n(null,e)})):(a.status="done",this.loaded[i]=a,n())}))}reloadTile(t,e){const n=this.loaded,i=t.uid;if(n&&n[i]){const a=n[i];a.projection=t.projection,a.brightness=t.brightness;const r=(n,i)=>{a.reloadCallback&&(delete a.reloadCallback,this.loadTile(t,e)),e(n,i)};"parsing"===a.status?a.reloadCallback=r:"done"===a.status&&this.loadTile(t,e)}}abortTile(t,e){const n=t.uid;this.loading[n]&&delete this.loading[n],e()}removeTile(t,e){const n=this.loaded,i=t.uid;n&&n[i]&&delete n[i],e()}}class zt{constructor(e){this.self=e,this.actor=new t.e6(e,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=t.aJ({name:"mercator"}),this.workerSourceTypes={vector:c,geojson:kt,"batched-model":Pt},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(t,e)=>{if(this.workerSourceTypes[t])throw new Error(`Worker source with name "${t}" already registered.`);this.workerSourceTypes[t]=e},this.self.registerRTLTextPlugin=e=>{if(t.e7.isParsed())throw new Error("RTL text plugin already registered.");t.e7.applyArabicShaping=e.applyArabicShaping,t.e7.processBidirectionalText=e.processBidirectionalText,t.e7.processStyledBidirectionalText=e.processStyledBidirectionalText}}clearCaches(t,e,n){delete this.layerIndexes[t],delete this.availableImages[t],delete this.workerSources[t],delete this.demWorkerSources[t],delete this.rasterArrayWorkerSource,n()}checkIfReady(t,e,n){n()}setReferrer(t,e){this.referrer=e}spriteLoaded(e,{scope:n,isLoaded:i}){if(this.isSpriteLoaded[e]||(this.isSpriteLoaded[e]={}),this.isSpriteLoaded[e][n]=i,this.workerSources[e]&&this.workerSources[e][n])for(const a in this.workerSources[e][n]){const r=this.workerSources[e][n][a];for(const e in r){const n=r[e];n instanceof c&&(n.isSpriteLoaded=i,n.fire(new t.f("isSpriteLoaded")))}}}setImages(t,{scope:e,images:n},i){if(this.availableImages[t]||(this.availableImages[t]={}),this.availableImages[t][e]=n,this.workerSources[t]&&this.workerSources[t][e]){for(const i in this.workerSources[t][e]){const a=this.workerSources[t][e][i];for(const t in a)a[t].availableImages=n}i()}else i()}setProjection(e,n){this.projections[e]=t.aJ(n)}setBrightness(t,e,n){this.brightness=e,n()}setLayers(t,e,n){this.getLayerIndex(t,e.scope).replace(e.layers,e.options),n()}updateLayers(t,e,n){this.getLayerIndex(t,e.scope).update(e.layers,e.removedIds,e.options),n()}loadTile(t,e,n){e.projection=this.projections[t]||this.defaultProjection,this.getWorkerSource(t,e.type,e.source,e.scope).loadTile(e,n)}loadDEMTile(t,e,n){this.getDEMWorkerSource(t,e.source,e.scope).loadTile(e,n)}decodeRasterArray(t,e,n){this.getRasterArrayWorkerSource().decodeRasterArray(e,n)}reloadTile(t,e,n){e.projection=this.projections[t]||this.defaultProjection,this.getWorkerSource(t,e.type,e.source,e.scope).reloadTile(e,n)}abortTile(t,e,n){this.getWorkerSource(t,e.type,e.source,e.scope).abortTile(e,n)}removeTile(t,e,n){this.getWorkerSource(t,e.type,e.source,e.scope).removeTile(e,n)}removeSource(t,e,n){if(!(this.workerSources[t]&&this.workerSources[t][e.scope]&&this.workerSources[t][e.scope][e.type]&&this.workerSources[t][e.scope][e.type][e.source]))return;const i=this.workerSources[t][e.scope][e.type][e.source];delete this.workerSources[t][e.scope][e.type][e.source],void 0!==i.removeSource?i.removeSource(e,n):n()}loadWorkerSource(t,e,n){try{this.self.importScripts(e.url),n()}catch(t){n(t.toString())}}syncRTLPluginState(e,n,i){try{t.e7.setState(n);const e=t.e7.getPluginURL();if(t.e7.isLoaded()&&!t.e7.isParsed()&&null!=e){this.self.importScripts(e);const n=t.e7.isParsed();i(n?void 0:new Error(`RTL Text Plugin failed to import scripts from ${e}`),n)}}catch(t){i(t.toString())}}setDracoUrl(t,e){this.dracoUrl=e}getAvailableImages(t,e){this.availableImages[t]||(this.availableImages[t]={});let n=this.availableImages[t][e];return n||(n=[]),n}getLayerIndex(t,e){this.layerIndexes[t]||(this.layerIndexes[t]={});let n=this.layerIndexes[t][e];return n||(n=this.layerIndexes[t][e]=new a,n.scope=e),n}getWorkerSource(t,e,n,i){return this.workerSources[t]||(this.workerSources[t]={}),this.workerSources[t][i]||(this.workerSources[t][i]={}),this.workerSources[t][i][e]||(this.workerSources[t][i][e]={}),this.isSpriteLoaded[t]||(this.isSpriteLoaded[t]={}),this.workerSources[t][i][e][n]||(this.workerSources[t][i][e][n]=new this.workerSourceTypes[e]({send:(e,n,i,a,r,o)=>{this.actor.send(e,n,i,t,r,o)},scheduler:this.actor.scheduler},this.getLayerIndex(t,i),this.getAvailableImages(t,i),this.isSpriteLoaded[t][i],void 0,this.brightness)),this.workerSources[t][i][e][n]}getDEMWorkerSource(t,e,n){return this.demWorkerSources[t]||(this.demWorkerSources[t]={}),this.demWorkerSources[t][n]||(this.demWorkerSources[t][n]={}),this.demWorkerSources[t][n][e]||(this.demWorkerSources[t][n][e]=new u),this.demWorkerSources[t][n][e]}getRasterArrayWorkerSource(){return this.rasterArrayWorkerSource||(this.rasterArrayWorkerSource=new h),this.rasterArrayWorkerSource}enforceCacheSizeLimit(e,n){t.e8(n)}getWorkerPerformanceMetrics(t,e,n){n(void 0,void 0)}}return"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope&&(self.worker=new zt(self)),zt})),i(0,(function(t){function e(t,n){if(Array.isArray(t)){if(!Array.isArray(n)||t.length!==n.length)return!1;for(let i=0;i<t.length;i++)if(!e(t[i],n[i]))return!1;return!0}if("object"==typeof t&&null!==t&&null!==n){if("object"!=typeof n)return!1;if(Object.keys(t).length!==Object.keys(n).length)return!1;for(const i in t)if(!e(t[i],n[i]))return!1;return!0}return t===n}var n=i;function i(t){return!function(t){return"undefined"==typeof window||"undefined"==typeof document?"not a browser":function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var t,e,n=new Blob([""],{type:"text/javascript"}),i=URL.createObjectURL(n);try{e=new Worker(i),t=!0}catch(e){t=!1}return e&&e.terminate(),URL.revokeObjectURL(i),t}()?function(){var t=document.createElement("canvas");t.width=t.height=1;var e=t.getContext("2d");if(!e)return!1;var n=e.getImageData(0,0,1,1);return n&&n.width===t.width}()?(void 0===a[e=t&&t.failIfMajorPerformanceCaveat]&&(a[e]=function(t){var e,n=function(t){var e=document.createElement("canvas"),n=Object.create(i.webGLContextAttributes);return n.failIfMajorPerformanceCaveat=t,e.getContext("webgl2",n)}(t);if(!n)return!1;try{e=n.createShader(n.VERTEX_SHADER)}catch(t){return!1}return!(!e||n.isContextLost())&&(n.shaderSource(e,"void main() {}"),n.compileShader(e),!0===n.getShaderParameter(e,n.COMPILE_STATUS))}(e)),a[e]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL2 support"):"insufficient Canvas/getImageData support":"insufficient worker support";var e}(t)}var a={};function r(t,e,n){const i=document.createElement(t);return null!=e&&(i.className=e),n&&n.appendChild(i),i}function o(t,e,n){const i=document.createElementNS("http://www.w3.org/2000/svg",t);for(const t of Object.keys(e))i.setAttributeNS(null,t,String(e[t]));return n&&n.appendChild(i),i}i.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const s="undefined"!=typeof document?document.documentElement&&document.documentElement.style:null,l=s&&void 0!==s.userSelect?"userSelect":"WebkitUserSelect";let c;function u(){s&&l&&(c=s[l],s[l]="none")}function h(){s&&l&&(s[l]=c)}function d(t){t.preventDefault(),t.stopPropagation(),window.removeEventListener("click",d,!0)}function p(){window.addEventListener("click",d,!0),window.setTimeout((()=>{window.removeEventListener("click",d,!0)}),0)}function f(t,e){const n=t.getBoundingClientRect();return _(t,n,e)}function m(t,e){const n=t.getBoundingClientRect(),i=[];for(let a=0;a<e.length;a++)i.push(_(t,n,e[a]));return i}function g(t){return void 0!==window.InstallTrigger&&2===t.button&&t.ctrlKey&&window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:t.button}function _(e,n,i){const a=e.offsetWidth===n.width?1:e.offsetWidth/n.width;return new t.P((i.clientX-n.left)*a,(i.clientY-n.top)*a)}class y{constructor(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps=new Set,this._updatedImages=new Set}isDirty(){return this._changed}setDirty(){this._changed=!0}getUpdatedSourceCaches(){return this._updatedSourceCaches}updateSourceCache(t,e){this._updatedSourceCaches[t]=e,this.setDirty()}discardSourceCacheUpdate(t){delete this._updatedSourceCaches[t]}updateLayer(t){const e=t.scope;this._updatedLayers[e]=this._updatedLayers[e]||new Set,this._updatedLayers[e].add(t.id),this.setDirty()}removeLayer(t){const e=t.scope;this._removedLayers[e]=this._removedLayers[e]||{},this._updatedLayers[e]=this._updatedLayers[e]||new Set,this._removedLayers[e][t.id]=t,this._updatedLayers[e].delete(t.id),this._updatedPaintProps.delete(t.fqid),this.setDirty()}getRemovedLayer(t){return this._removedLayers[t.scope]?this._removedLayers[t.scope][t.id]:null}discardLayerRemoval(t){this._removedLayers[t.scope]&&delete this._removedLayers[t.scope][t.id]}getLayerUpdatesByScope(){const t={};for(const e in this._updatedLayers)t[e]=t[e]||{},t[e].updatedIds=Array.from(this._updatedLayers[e].values());for(const e in this._removedLayers)t[e]=t[e]||{},t[e].removedIds=Object.keys(this._removedLayers[e]);return t}getUpdatedPaintProperties(){return this._updatedPaintProps}updatePaintProperties(t){this._updatedPaintProps.add(t.fqid),this.setDirty()}getUpdatedImages(){return Array.from(this._updatedImages.values())}updateImage(t){this._updatedImages.add(t),this.setDirty()}resetUpdatedImages(){this._updatedImages.clear()}reset(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps.clear(),this._updatedImages.clear()}}const x={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class v{constructor(t,e,n,i,a,r){this.length=e.length,this.attributes=n,this.itemSize=e.bytesPerElement,this.dynamicDraw=i,this.instanceCount=r,this.context=t;const o=t.gl;this.buffer=o.createBuffer(),t.bindVertexBuffer.set(this.buffer),o.bufferData(o.ARRAY_BUFFER,e.arrayBuffer,this.dynamicDraw?o.DYNAMIC_DRAW:o.STATIC_DRAW),this.dynamicDraw||a||e.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(t){const e=this.context.gl;this.bind(),e.bufferSubData(e.ARRAY_BUFFER,0,t.arrayBuffer)}enableAttributes(t,e){for(let n=0;n<this.attributes.length;n++){const i=e.attributes[this.attributes[n].name];void 0!==i&&t.enableVertexAttribArray(i)}}setVertexAttribPointers(t,e,n){for(let i=0;i<this.attributes.length;i++){const a=this.attributes[i],r=e.attributes[a.name];void 0!==r&&t.vertexAttribPointer(r,a.components,t[x[a.type]],!1,this.itemSize,a.offset+this.itemSize*(n||0))}}setVertexAttribDivisor(t,e,n){for(let i=0;i<this.attributes.length;i++){const a=e.attributes[this.attributes[i].name];void 0!==a&&this.instanceCount&&this.instanceCount>0&&t.vertexAttribDivisor(a,n)}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class b{constructor(t){this.gl=t.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(t){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class w extends b{getDefault(){return t.C.transparent}set(t){const e=this.current;(t.r!==e.r||t.g!==e.g||t.b!==e.b||t.a!==e.a||this.dirty)&&(this.gl.clearColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class A extends b{getDefault(){return 1}set(t){(t!==this.current||this.dirty)&&(this.gl.clearDepth(t),this.current=t,this.dirty=!1)}}class C extends b{getDefault(){return 0}set(t){(t!==this.current||this.dirty)&&(this.gl.clearStencil(t),this.current=t,this.dirty=!1)}}class E extends b{getDefault(){return[!0,!0,!0,!0]}set(t){const e=this.current;(t[0]!==e[0]||t[1]!==e[1]||t[2]!==e[2]||t[3]!==e[3]||this.dirty)&&(this.gl.colorMask(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class T extends b{getDefault(){return!0}set(t){(t!==this.current||this.dirty)&&(this.gl.depthMask(t),this.current=t,this.dirty=!1)}}class S extends b{getDefault(){return 255}set(t){(t!==this.current||this.dirty)&&(this.gl.stencilMask(t),this.current=t,this.dirty=!1)}}class M extends b{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(t){const e=this.current;(t.func!==e.func||t.ref!==e.ref||t.mask!==e.mask||this.dirty)&&(this.gl.stencilFunc(t.func,t.ref,t.mask),this.current=t,this.dirty=!1)}}class k extends b{getDefault(){const t=this.gl;return[t.KEEP,t.KEEP,t.KEEP]}set(t){const e=this.current;(t[0]!==e[0]||t[1]!==e[1]||t[2]!==e[2]||this.dirty)&&(this.gl.stencilOp(t[0],t[1],t[2]),this.current=t,this.dirty=!1)}}class I extends b{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;t?e.enable(e.STENCIL_TEST):e.disable(e.STENCIL_TEST),this.current=t,this.dirty=!1}}class P extends b{getDefault(){return[0,1]}set(t){const e=this.current;(t[0]!==e[0]||t[1]!==e[1]||this.dirty)&&(this.gl.depthRange(t[0],t[1]),this.current=t,this.dirty=!1)}}class z extends b{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;t?e.enable(e.DEPTH_TEST):e.disable(e.DEPTH_TEST),this.current=t,this.dirty=!1}}class D extends b{getDefault(){return this.gl.LESS}set(t){(t!==this.current||this.dirty)&&(this.gl.depthFunc(t),this.current=t,this.dirty=!1)}}class L extends b{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;t?e.enable(e.BLEND):e.disable(e.BLEND),this.current=t,this.dirty=!1}}class B extends b{getDefault(){const t=this.gl;return[t.ONE,t.ZERO,t.ONE,t.ZERO]}set(t){const e=this.current;(t[0]!==e[0]||t[1]!==e[1]||t[2]!==e[2]||t[3]!==e[3]||this.dirty)&&(this.gl.blendFuncSeparate(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class O extends b{getDefault(){return t.C.transparent}set(t){const e=this.current;(t.r!==e.r||t.g!==e.g||t.b!==e.b||t.a!==e.a||this.dirty)&&(this.gl.blendColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class R extends b{getDefault(){return this.gl.FUNC_ADD}set(t){(t!==this.current||this.dirty)&&(this.gl.blendEquationSeparate(t,t),this.current=t,this.dirty=!1)}}class F extends b{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;t?e.enable(e.CULL_FACE):e.disable(e.CULL_FACE),this.current=t,this.dirty=!1}}class N extends b{getDefault(){return this.gl.BACK}set(t){(t!==this.current||this.dirty)&&(this.gl.cullFace(t),this.current=t,this.dirty=!1)}}class j extends b{getDefault(){return this.gl.CCW}set(t){(t!==this.current||this.dirty)&&(this.gl.frontFace(t),this.current=t,this.dirty=!1)}}let V=class extends b{getDefault(){return null}set(t){(t!==this.current||this.dirty)&&(this.gl.useProgram(t),this.current=t,this.dirty=!1)}};class U extends b{getDefault(){return this.gl.TEXTURE0}set(t){(t!==this.current||this.dirty)&&(this.gl.activeTexture(t),this.current=t,this.dirty=!1)}}class G extends b{getDefault(){const t=this.gl;return[0,0,t.drawingBufferWidth,t.drawingBufferHeight]}set(t){const e=this.current;(t[0]!==e[0]||t[1]!==e[1]||t[2]!==e[2]||t[3]!==e[3]||this.dirty)&&(this.gl.viewport(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class q extends b{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;e.bindFramebuffer(e.FRAMEBUFFER,t),this.current=t,this.dirty=!1}}class $ extends b{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;e.bindRenderbuffer(e.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class W extends b{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;e.bindTexture(e.TEXTURE_2D,t),this.current=t,this.dirty=!1}}class H extends b{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;e.bindBuffer(e.ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class Z extends b{getDefault(){return null}set(t){const e=this.gl;e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class Y extends b{getDefault(){return null}set(t){this.gl&&(t!==this.current||this.dirty)&&(this.gl.bindVertexArray(t),this.current=t,this.dirty=!1)}}class X extends b{getDefault(){return 4}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;e.pixelStorei(e.UNPACK_ALIGNMENT,t),this.current=t,this.dirty=!1}}class K extends b{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t),this.current=t,this.dirty=!1}}class Q extends b{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,t),this.current=t,this.dirty=!1}}class J extends b{constructor(t,e){super(t),this.context=t,this.parent=e}getDefault(){return null}}class tt extends J{setDirty(){this.dirty=!0}set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const e=this.gl;e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0),this.current=t,this.dirty=!1}}class et extends J{attachment(){return this.gl.DEPTH_ATTACHMENT}set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const e=this.gl;e.framebufferRenderbuffer(e.FRAMEBUFFER,this.attachment(),e.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class nt extends J{attachment(){return this.gl.DEPTH_ATTACHMENT}set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const e=this.gl;e.framebufferTexture2D(e.FRAMEBUFFER,this.attachment(),e.TEXTURE_2D,t,0),this.current=t,this.dirty=!1}}class it extends et{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class at{constructor(t,e,n,i,a){this.context=t,this.width=e,this.height=n;const r=this.framebuffer=t.gl.createFramebuffer();i&&(this.colorAttachment=new tt(t,r)),a&&(this.depthAttachmentType=a,this.depthAttachment="renderbuffer"===a?new et(t,r):new nt(t,r))}destroy(){const t=this.context.gl;if(this.colorAttachment){const e=this.colorAttachment.get();e&&t.deleteTexture(e)}if(this.depthAttachment&&this.depthAttachmentType)if("renderbuffer"===this.depthAttachmentType){const e=this.depthAttachment.get();e&&t.deleteRenderbuffer(e)}else{const e=this.depthAttachment.get();e&&t.deleteTexture(e)}t.deleteFramebuffer(this.framebuffer)}}class rt{constructor(t,e){this.gl=t,this.clearColor=new w(this),this.clearDepth=new A(this),this.clearStencil=new C(this),this.colorMask=new E(this),this.depthMask=new T(this),this.stencilMask=new S(this),this.stencilFunc=new M(this),this.stencilOp=new k(this),this.stencilTest=new I(this),this.depthRange=new P(this),this.depthTest=new z(this),this.depthFunc=new D(this),this.blend=new L(this),this.blendFunc=new B(this),this.blendColor=new O(this),this.blendEquation=new R(this),this.cullFace=new F(this),this.cullFaceSide=new N(this),this.frontFace=new j(this),this.program=new V(this),this.activeTexture=new U(this),this.viewport=new G(this),this.bindFramebuffer=new q(this),this.bindRenderbuffer=new $(this),this.bindTexture=new W(this),this.bindVertexBuffer=new H(this),this.bindElementBuffer=new Z(this),this.bindVertexArrayOES=new Y(this),this.pixelStoreUnpack=new X(this),this.pixelStoreUnpackPremultiplyAlpha=new K(this),this.pixelStoreUnpackFlipY=new Q(this),this.options=e?{...e}:{},this.options.extTextureFilterAnisotropicForceOff||(this.extTextureFilterAnisotropic=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=t.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT))),this.extDebugRendererInfo=t.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=t.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=t.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),this.options.extTextureFloatLinearForceOff||(this.extTextureFloatLinear=t.getExtension("OES_texture_float_linear")),this.extRenderToTextureHalfFloat=t.getExtension("EXT_color_buffer_half_float"),this.extTimerQuery=t.getExtension("EXT_disjoint_timer_query_webgl2"),this.maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE),this.maxPointSize=t.getParameter(t.ALIASED_POINT_SIZE_RANGE)[1]}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArrayOES.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(e,n,i){return new t.I(this,e,n,i)}createVertexBuffer(t,e,n,i,a){return new v(this,t,e,n,i,a)}createRenderbuffer(t,e,n){const i=this.gl,a=i.createRenderbuffer();return this.bindRenderbuffer.set(a),i.renderbufferStorage(i.RENDERBUFFER,t,e,n),this.bindRenderbuffer.set(null),a}createFramebuffer(t,e,n,i){return new at(this,t,e,n,i)}clear({color:t,depth:e,stencil:n,colorMask:i}){const a=this.gl;let r=0;t&&(r|=a.COLOR_BUFFER_BIT,this.clearColor.set(t),this.colorMask.set(i||[!0,!0,!0,!0])),void 0!==e&&(r|=a.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(e),this.depthMask.set(!0)),void 0!==n&&(r|=a.STENCIL_BUFFER_BIT,this.clearStencil.set(n),this.stencilMask.set(255)),a.clear(r)}setCullFace(t){!1===t.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(t.mode),this.frontFace.set(t.frontFace))}setDepthMode(t){t.func!==this.gl.ALWAYS||t.mask?(this.depthTest.set(!0),this.depthFunc.set(t.func),this.depthMask.set(t.mask),this.depthRange.set(t.range)):this.depthTest.set(!1)}setStencilMode(t){t.test.func!==this.gl.ALWAYS||t.mask?(this.stencilTest.set(!0),this.stencilMask.set(t.mask),this.stencilOp.set([t.fail,t.depthFail,t.pass]),this.stencilFunc.set({func:t.test.func,ref:t.ref,mask:t.test.mask})):this.stencilTest.set(!1)}setColorMode(n){e(n.blendFunction,t.a.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(n.blendFunction),this.blendColor.set(n.blendColor),n.blendEquation?this.blendEquation.set(n.blendEquation):this.blendEquation.setDefault()),this.colorMask.set(n.mask)}unbindVAO(){this.bindVertexArrayOES.set(null)}}class ot{constructor(t){this._gl=t.gl,this._query=this._gl.createQuery(),this._isFree=!0}begin(){this._gl.beginQuery(this._gl.ANY_SAMPLES_PASSED,this._query),this._isFree=!1}end(){this._gl.endQuery(this._gl.ANY_SAMPLES_PASSED)}isResultAvailable(){return this._gl.getQueryParameter(this._query,this._gl.QUERY_RESULT_AVAILABLE)}consumeResult(){const t=this._gl.getQueryParameter(this._query,this._gl.QUERY_RESULT);return this._isFree=!0,t}isFree(){return this._isFree}destroy(){this._gl.deleteQuery(this._query)}}class st{constructor(t){this.useOcclusionQueries=!0,this.visualizeOcclusions="none",this.occlusionQueryFrameWindow=5,this.occluderSize=32,this.fadeSpeed=7,this.depthOffset=-1e-4,t.registerParameter(this,["Symbols"],"useOcclusionQueries"),t.registerParameter(this,["Symbols"],"visualizeOcclusions",{options:{none:"none",zPass:"zPass",zTest:"zTest"}}),t.registerParameter(this,["Symbols"],"occlusionQueryFrameWindow",{min:1,max:30,step:1}),t.registerParameter(this,["Symbols"],"occluderSize",{min:1,max:100,step:1}),t.registerParameter(this,["Symbols"],"fadeSpeed",{min:.1,max:50,step:.1}),t.registerParameter(this,["Symbols"],"depthOffset",{min:-.001,max:0,step:1e-4})}}class lt{constructor(e,n,i,a){const r={width:i[0],height:i[1],data:null},o=e.gl;this.targetColorTexture=new t.T(e,r,o.RGBA,{useMipmap:!1}),this.backgroundColorTexture=new t.T(e,r,o.RGBA,{useMipmap:!1}),this.context=e,this.updateParticleTexture(n,a),this.lastInvalidatedAt=0}updateParticleTexture(e,n){if(this.particleTextureDimension===n.width)return;(this.particleTexture0||this.particleTexture1||this.particleIndexBuffer||this.particleSegment)&&(this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleIndexBuffer.destroy(),this.particleSegment.destroy());const i=this.context.gl,a=n.width*n.height;this.particleTexture0=new t.T(this.context,n,i.RGBA,{premultiply:!1,useMipmap:!1}),this.particleTexture1=new t.T(this.context,n,i.RGBA,{premultiply:!1,useMipmap:!1});const r=new t.S;r.reserve(a);for(let t=0;t<a;t++)r.emplaceBack(t);this.particleIndexBuffer=this.context.createVertexBuffer(r,t.p.members,!0),this.particleSegment=t.b.simpleSegment(0,0,this.particleIndexBuffer.length,0),this.particleTextureDimension=n.width}update(e){return!(this.lastInvalidatedAt<e&&(this.lastInvalidatedAt=t.e.now(),1))}destroy(){this.targetColorTexture.destroy(),this.backgroundColorTexture.destroy(),this.particleIndexBuffer.destroy(),this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleSegment.destroy()}}class ct extends t.E{constructor(t){super(),this.requestManager=t,this.models={"":{}},this.numModelsLoading={}}loadModel(e,n){return t.l(this.requestManager.transformRequest(n,t.R.Model).url).then((n=>{if(!n)return;const i=t.c(n),a=new t.M(e,void 0,void 0,i);return a.computeBoundsAndApplyParent(),a})).catch((i=>{if(i&&404===i.status)return null;this.fire(new t.d(new Error(`Could not load model ${e} from ${n}: ${i.message}`)))}))}load(e,n){this.models[n]||(this.models[n]={});const i=Object.keys(e);this.numModelsLoading[n]=(this.numModelsLoading[n]||0)+i.length;const a=[];for(const t of i)a.push(this.loadModel(t,e[t]));Promise.allSettled(a).then((e=>{for(let t=0;t<e.length;t++){const{status:a,value:r}=e[t];"fulfilled"===a&&r&&(this.models[n][i[t]]={model:r,numReferences:1})}this.numModelsLoading[n]-=i.length,this.fire(new t.f("data",{dataType:"style"}))})).catch((e=>{this.fire(new t.d(new Error(`Could not load models: ${e.message}`)))}))}isLoaded(){for(const t in this.numModelsLoading)if(this.numModelsLoading[t]>0)return!1;return!0}hasModel(t,e){return!!this.getModel(t,e)}getModel(t,e){return this.models[e]||(this.models[e]={}),this.models[e][t]?this.models[e][t].model:void 0}addModel(t,e,n){this.models[n]||(this.models[n]={}),this.hasModel(t,n)&&this.models[n][t].numReferences++,this.load({[t]:this.requestManager.normalizeModelURL(e)},n)}addModels(t,e){this.models[e]||(this.models[e]={});const n={};for(const i in t)this.models[e][i]={},n[i]=this.requestManager.normalizeModelURL(t[i]);this.load(n,e)}addModelsFromBucket(t,e){this.models[e]||(this.models[e]={});const n={};for(const i of t)this.hasModel(i,e)?this.models[e][i].numReferences++:n[i]=this.requestManager.normalizeModelURL(i);this.load(n,e)}removeModel(t,e){if(this.models[e]&&this.models[e][t]&&(this.models[e][t].numReferences--,0===this.models[e][t].numReferences)){const n=this.models[e][t].model;delete this.models[e][t],n.destroy()}}listModels(t){return this.models[t]||(this.models[t]={}),Object.keys(this.models[t])}upload(t,e){this.models[e]||(this.models[e]={});for(const n in this.models[e])this.models[e][n].model&&this.models[e][n].model.upload(t.context)}}function ut(t){const{userImage:e}=t;return!!(e&&e.render&&e.render())&&(t.data.replace(new Uint8Array(e.data.buffer)),!0)}class ht extends t.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded={},this.requestors=[],this.patterns={},this.atlasImage={},this.atlasTexture={},this.dirty=!0}createScope(e){this.images[e]={},this.loaded[e]=!1,this.updatedImages[e]={},this.patterns[e]={},this.callbackDispatchedThisFrame[e]={},this.atlasImage[e]=new t.i({width:1,height:1})}isLoaded(){for(const t in this.loaded)if(!this.loaded[t])return!1;return!0}setLoaded(t,e){if(this.loaded[e]!==t&&(this.loaded[e]=t,t)){for(const{ids:t,callback:n}of this.requestors)this._notify(t,e,n);this.requestors=[]}}hasImage(t,e){return!!this.getImage(t,e)}getImage(t,e){return this.images[e][t]}addImage(t,e,n){this._validate(t,n)&&(this.images[e][t]=n)}_validate(e,n){let i=!0;return this._validateStretch(n.stretchX,n.data&&n.data.width)||(this.fire(new t.d(new Error(`Image "${e}" has invalid "stretchX" value`))),i=!1),this._validateStretch(n.stretchY,n.data&&n.data.height)||(this.fire(new t.d(new Error(`Image "${e}" has invalid "stretchY" value`))),i=!1),this._validateContent(n.content,n)||(this.fire(new t.d(new Error(`Image "${e}" has invalid "content" value`))),i=!1),i}_validateStretch(t,e){if(!t)return!0;let n=0;for(const i of t){if(i[0]<n||i[1]<i[0]||e<i[1])return!1;n=i[1]}return!0}_validateContent(t,e){return!(t&&(4!==t.length||t[0]<0||e.data.width<t[0]||t[1]<0||e.data.height<t[1]||t[2]<0||e.data.width<t[2]||t[3]<0||e.data.height<t[3]||t[2]<t[0]||t[3]<t[1]))}updateImage(t,e,n){n.version=this.images[e][t].version+1,this.images[e][t]=n,this.updatedImages[e][t]=!0}removeImage(t,e){const n=this.images[e][t];delete this.images[e][t],delete this.patterns[e][t],n.userImage&&n.userImage.onRemove&&n.userImage.onRemove()}listImages(t){return Object.keys(this.images[t])}getImages(t,e,n){let i=!0;const a=!!this.loaded[e];if(!a)for(const n of t)this.images[e][n]||(i=!1);a||i?this._notify(t,e,n):this.requestors.push({ids:t,scope:e,callback:n})}getUpdatedImages(t){return this.updatedImages[t]}_notify(e,n,i){const a={};for(const i of e){this.images[n][i]||this.fire(new t.f("styleimagemissing",{id:i}));const e=this.images[n][i];e?a[i]={data:e.data.clone(),pixelRatio:e.pixelRatio,sdf:e.sdf,version:e.version,stretchX:e.stretchX,stretchY:e.stretchY,content:e.content,hasRenderCallback:Boolean(e.userImage&&e.userImage.render)}:t.w(`Image "${i}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}i(null,a)}getPixelSize(t){const{width:e,height:n}=this.atlasImage[t];return{width:e,height:n}}getPattern(e,n,i){const a=this.patterns[n][e],r=this.getImage(e,n);if(!r)return null;if(a&&a.position.version===r.version)return a.position;if(a)a.position.version=r.version;else{const i={w:r.data.width+2,h:r.data.height+2,x:0,y:0},a=new t.k(i,r);this.patterns[n][e]={bin:i,position:a}}return this._updatePatternAtlas(n,i),this.patterns[n][e].position}bind(e,n){const i=e.gl;let a=this.atlasTexture[n];a?this.dirty&&(a.update(this.atlasImage[n]),this.dirty=!1):(a=new t.T(e,this.atlasImage[n],i.RGBA),this.atlasTexture[n]=a),a.bind(i.LINEAR,i.CLAMP_TO_EDGE)}_updatePatternAtlas(e,n){const i=[];for(const t in this.patterns[e])i.push(this.patterns[e][t].bin);const{w:a,h:r}=t.j(i),o=this.atlasImage[e];o.resize({width:a||1,height:r||1});for(const i in this.patterns[e]){const{bin:a}=this.patterns[e][i],r=a.x+1,s=a.y+1,l=this.images[e][i].data,c=l.width,u=l.height;t.i.copy(l,o,{x:0,y:0},{x:r,y:s},{width:c,height:u},n),t.i.copy(l,o,{x:0,y:u-1},{x:r,y:s-1},{width:c,height:1},n),t.i.copy(l,o,{x:0,y:0},{x:r,y:s+u},{width:c,height:1},n),t.i.copy(l,o,{x:c-1,y:0},{x:r-1,y:s},{width:1,height:u},n),t.i.copy(l,o,{x:0,y:0},{x:r+c,y:s},{width:1,height:u},n)}this.dirty=!0}beginFrame(){for(const t in this.images)this.callbackDispatchedThisFrame[t]={}}dispatchRenderCallbacks(t,e){for(const n of t){if(this.callbackDispatchedThisFrame[e][n])continue;this.callbackDispatchedThisFrame[e][n]=!0;const t=this.images[e][n];ut(t)&&this.updateImage(n,e,t)}}}function dt(e){const n=e.key,i=e.value,a=e.valueSpec||{},r=e.objectElementValidators||{},o=e.style,s=e.styleSpec;let l=[];const c=t.n(i);if("object"!==c)return[new t.V(n,i,`object expected, ${c} found`)];for(const e in i){const c=e.split(".")[0];let u;r[c]?u=r[c]:a[c]?u=Lt:r["*"]?u=r["*"]:a["*"]&&(u=Lt),u?l=l.concat(u({key:(n?`${n}.`:n)+e,value:i[e],valueSpec:a[c]||a["*"],style:o,styleSpec:s,object:i,objectKey:e},i)):l.push(new t.m(n,i[e],`unknown property "${e}"`))}for(const e in a)r[e]||a[e].required&&void 0===a[e].default&&void 0===i[e]&&l.push(new t.V(n,i,`missing required property "${e}"`));return l}function pt(e){const n=e.value,i=e.valueSpec,a=e.style,r=e.styleSpec,o=e.key,s=e.arrayElementValidator||Lt;if("array"!==t.n(n))return[new t.V(o,n,`array expected, ${t.n(n)} found`)];if(i.length&&n.length!==i.length)return[new t.V(o,n,`array length ${i.length} expected, length ${n.length} found`)];if(i["min-length"]&&n.length<i["min-length"])return[new t.V(o,n,`array length at least ${i["min-length"]} expected, length ${n.length} found`)];let l={type:i.value,values:i.values,minimum:i.minimum,maximum:i.maximum,function:void 0};r.$version<7&&(l.function=i.function),"object"===t.n(i.value)&&(l=i.value);let c=[];for(let t=0;t<n.length;t++)c=c.concat(s({array:n,arrayIndex:t,value:n[t],valueSpec:l,style:a,styleSpec:r,key:`${o}[${t}]`},!0));return c}function ft(e){const n=e.key,i=e.value,a=e.valueSpec;let r=t.n(i);if("number"===r&&i!=i&&(r="NaN"),"number"!==r)return[new t.V(n,i,`number expected, ${r} found`)];if("minimum"in a){let r=a.minimum;if("array"===t.n(a.minimum)&&(r=a.minimum[e.arrayIndex]),i<r)return[new t.V(n,i,`${i} is less than the minimum value ${r}`)]}if("maximum"in a){let r=a.maximum;if("array"===t.n(a.maximum)&&(r=a.maximum[e.arrayIndex]),i>r)return[new t.V(n,i,`${i} is greater than the maximum value ${r}`)]}return[]}function mt(e){const n=e.valueSpec,i=t.u(e.value.type);let a,r,o,s={};const l="categorical"!==i&&void 0===e.value.property,c=!l,u="array"===t.n(e.value.stops)&&"array"===t.n(e.value.stops[0])&&"object"===t.n(e.value.stops[0][0]),h=dt({key:e.key,value:e.value,valueSpec:e.styleSpec.function,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{stops:function(e){if("identity"===i)return[new t.V(e.key,e.value,'identity function may not have a "stops" property')];let n=[];const a=e.value;return n=n.concat(pt({key:e.key,value:a,valueSpec:e.valueSpec,style:e.style,styleSpec:e.styleSpec,arrayElementValidator:d})),"array"===t.n(a)&&0===a.length&&n.push(new t.V(e.key,a,"array must have at least one stop")),n},default:function(t){return Lt({key:t.key,value:t.value,valueSpec:n,style:t.style,styleSpec:t.styleSpec})}}});return"identity"===i&&l&&h.push(new t.V(e.key,e.value,'missing required property "property"')),"identity"===i||e.value.stops||h.push(new t.V(e.key,e.value,'missing required property "stops"')),"exponential"===i&&e.valueSpec.expression&&!t.s(e.valueSpec)&&h.push(new t.V(e.key,e.value,"exponential functions not supported")),e.styleSpec.$version>=8&&(c&&!t.q(e.valueSpec)?h.push(new t.V(e.key,e.value,"property functions not supported")):l&&!t.r(e.valueSpec)&&h.push(new t.V(e.key,e.value,"zoom functions not supported"))),"categorical"!==i&&!u||void 0!==e.value.property||h.push(new t.V(e.key,e.value,'"property" property is required')),h;function d(e){let i=[];const a=e.value,l=e.key;if("array"!==t.n(a))return[new t.V(l,a,`array expected, ${t.n(a)} found`)];if(2!==a.length)return[new t.V(l,a,`array length 2 expected, length ${a.length} found`)];if(u){if("object"!==t.n(a[0]))return[new t.V(l,a,`object expected, ${t.n(a[0])} found`)];if(void 0===a[0].zoom)return[new t.V(l,a,"object stop key must have zoom")];if(void 0===a[0].value)return[new t.V(l,a,"object stop key must have value")];const n=t.u(a[0].zoom);if("number"!=typeof n)return[new t.V(l,a[0].zoom,"stop zoom values must be numbers")];if(o&&o>n)return[new t.V(l,a[0].zoom,"stop zoom values must appear in ascending order")];n!==o&&(o=n,r=void 0,s={}),i=i.concat(dt({key:`${l}[0]`,value:a[0],valueSpec:{zoom:{}},style:e.style,styleSpec:e.styleSpec,objectElementValidators:{zoom:ft,value:p}}))}else i=i.concat(p({key:`${l}[0]`,value:a[0],valueSpec:{},style:e.style,styleSpec:e.styleSpec},a));return t.t(t.v(a[1]))?i.concat([new t.V(`${l}[1]`,a[1],"expressions are not allowed in function stops.")]):i.concat(Lt({key:`${l}[1]`,value:a[1],valueSpec:n,style:e.style,styleSpec:e.styleSpec}))}function p(e,o){const l=t.n(e.value),c=t.u(e.value),u=null!==e.value?e.value:o;if(a){if(l!==a)return[new t.V(e.key,u,`${l} stop domain type must match previous stop domain type ${a}`)]}else a=l;if("number"!==l&&"string"!==l&&"boolean"!==l&&"number"!=typeof c&&"string"!=typeof c&&"boolean"!=typeof c)return[new t.V(e.key,u,"stop domain value must be a number, string, or boolean")];if("number"!==l&&"categorical"!==i){let a=`number expected, ${l} found`;return t.q(n)&&void 0===i&&(a+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new t.V(e.key,u,a)]}return"categorical"!==i||"number"!==l||"number"==typeof c&&isFinite(c)&&Math.floor(c)===c?"categorical"!==i&&"number"===l&&"number"==typeof c&&"number"==typeof r&&void 0!==r&&c<r?[new t.V(e.key,u,"stop domain values must appear in ascending order")]:(r=c,"categorical"===i&&c in s?[new t.V(e.key,u,"stop domain values must be unique")]:(s[c]=!0,[])):[new t.V(e.key,u,`integer expected, found ${String(c)}`)]}}function gt(e){const n=("property"===e.expressionContext?t.x:t.y)(t.v(e.value),e.valueSpec);if("error"===n.result)return n.value.map((n=>new t.V(`${e.key}${n.key}`,e.value,n.message)));const i=n.value.expression||n.value._styleExpression.expression;if("property"===e.expressionContext&&"text-font"===e.propertyKey&&!i.outputDefined())return[new t.V(e.key,e.value,`Invalid data expression for "${e.propertyKey}". Output values must be contained as literals within the expression.`)];if("property"===e.expressionContext&&"layout"===e.propertyType&&!t.z(i))return[new t.V(e.key,e.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===e.expressionContext)return _t(i,e);if(e.expressionContext&&0===e.expressionContext.indexOf("cluster")){if(!t.A(i,["zoom","feature-state"]))return[new t.V(e.key,e.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===e.expressionContext&&!t.B(i))return[new t.V(e.key,e.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function _t(e,n){const i=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(n.valueSpec&&n.valueSpec.expression)for(const t of n.valueSpec.expression.parameters)i.delete(t);if(0===i.size)return[];const a=[];return e instanceof t.D&&i.has(e.name)?[new t.V(n.key,n.value,`["${e.name}"] expression is not supported in a filter for a ${n.object.type} layer with id: ${n.object.id}`)]:(e.eachChild((t=>{a.push(..._t(t,n))})),a)}function yt(e){const n=e.key,i=e.value,a=e.valueSpec,r=[];return Array.isArray(a.values)?-1===a.values.indexOf(t.u(i))&&r.push(new t.V(n,i,`expected one of [${a.values.join(", ")}], ${JSON.stringify(i)} found`)):-1===Object.keys(a.values).indexOf(t.u(i))&&r.push(new t.V(n,i,`expected one of [${Object.keys(a.values).join(", ")}], ${JSON.stringify(i)} found`)),r}function xt(e){return t.G(t.v(e.value))?gt(t.o({},e,{expressionContext:"filter",valueSpec:e.styleSpec[`filter_${e.layerType||"fill"}`]})):vt(e)}function vt(e){const n=e.value,i=e.key;if("array"!==t.n(n))return[new t.V(i,n,`array expected, ${t.n(n)} found`)];const a=e.styleSpec;let r,o=[];if(n.length<1)return[new t.V(i,n,"filter array must have at least 1 element")];switch(o=o.concat(yt({key:`${i}[0]`,value:n[0],valueSpec:a.filter_operator,style:e.style,styleSpec:e.styleSpec})),t.u(n[0])){case"<":case"<=":case">":case">=":n.length>=2&&"$type"===t.u(n[1])&&o.push(new t.V(i,n,`"$type" cannot be use with operator "${n[0]}"`));case"==":case"!=":3!==n.length&&o.push(new t.V(i,n,`filter array for operator "${n[0]}" must have 3 elements`));case"in":case"!in":n.length>=2&&(r=t.n(n[1]),"string"!==r&&o.push(new t.V(`${i}[1]`,n[1],`string expected, ${r} found`)));for(let s=2;s<n.length;s++)r=t.n(n[s]),"$type"===t.u(n[1])?o=o.concat(yt({key:`${i}[${s}]`,value:n[s],valueSpec:a.geometry_type,style:e.style,styleSpec:e.styleSpec})):"string"!==r&&"number"!==r&&"boolean"!==r&&o.push(new t.V(`${i}[${s}]`,n[s],`string, number, or boolean expected, ${r} found`));break;case"any":case"all":case"none":for(let t=1;t<n.length;t++)o=o.concat(vt({key:`${i}[${t}]`,value:n[t],style:e.style,styleSpec:e.styleSpec}));break;case"has":case"!has":r=t.n(n[1]),2!==n.length?o.push(new t.V(i,n,`filter array for "${n[0]}" operator must have 2 elements`)):"string"!==r&&o.push(new t.V(`${i}[1]`,n[1],`string expected, ${r} found`))}return o}function bt(e,n){const i=e.key,a=e.style,r=e.layer,o=e.styleSpec,s=e.value,l=e.objectKey,c=o[`${n}_${e.layerType}`];if(!c)return[];const u=l.match(/^(.*)-transition$/);if("paint"===n&&u&&c[u[1]]&&c[u[1]].transition)return Lt({key:i,value:s,valueSpec:o.transition,style:a,styleSpec:o});const h=e.valueSpec||c[l];if(!h)return[new t.m(i,s,`unknown property "${l}"`)];let d;if("string"===t.n(s)&&t.q(h)&&!h.tokens&&(d=/^{([^}]+)}$/.exec(s))){const e=`\`{ "type": "identity", "property": ${d?JSON.stringify(d[1]):'"_"'} }\``;return[new t.V(i,s,`"${l}" does not support interpolation syntax\nUse an identity property function instead: ${e}.`)]}const p=[];if("symbol"===e.layerType)"text-field"!==l||!a||a.glyphs||a.imports||p.push(new t.V(i,s,'use of "text-field" requires a style "glyphs" property')),"text-font"===l&&t.H(t.v(s))&&"identity"===t.u(s.type)&&p.push(new t.V(i,s,'"text-font" does not support identity functions'));else if("model"===e.layerType&&"paint"===n&&r&&r.layout&&r.layout.hasOwnProperty("model-id")&&t.q(h)&&(t.J(h)||t.r(h))){const e=t.x(t.v(s),h),n=e.value.expression||e.value._styleExpression.expression;n&&!t.A(n,["measure-light"])&&("model-emissive-strength"===l&&t.B(n)&&t.z(n)||p.push(new t.V(i,s,`${l} does not support measure-light expressions when the model layer source is vector tile or GeoJSON.`)))}return p.concat(Lt({key:e.key,value:s,valueSpec:h,style:a,styleSpec:o,expressionContext:"property",propertyType:n,propertyKey:l}))}function wt(t){return bt(t,"paint")}function At(t){return bt(t,"layout")}function Ct(e){let n=[];const i=e.value,a=e.key,r=e.style,o=e.styleSpec;i.type||i.ref||n.push(new t.V(a,i,'either "type" or "ref" is required'));let s=t.u(i.type);const l=t.u(i.ref);if(i.id){const o=t.u(i.id);for(let s=0;s<e.arrayIndex;s++){const e=r.layers[s];t.u(e.id)===o&&n.push(new t.V(a,i.id,`duplicate layer id "${i.id}", previously used at line ${e.id.__line__}`))}}if("ref"in i){let e;["type","source","source-layer","filter","layout"].forEach((e=>{e in i&&n.push(new t.V(a,i[e],`"${e}" is prohibited for ref layers`))})),r.layers.forEach((n=>{t.u(n.id)===l&&(e=n)})),e?e.ref?n.push(new t.V(a,i.ref,"ref cannot reference another ref layer")):s=t.u(e.type):"string"==typeof l&&n.push(new t.V(a,i.ref,`ref layer "${l}" not found`))}else if("background"!==s&&"sky"!==s&&"slot"!==s)if(i.source){const e=r.sources&&r.sources[i.source],o=e&&t.u(e.type);e?"vector"===o&&"raster"===s?n.push(new t.V(a,i.source,`layer "${i.id}" requires a raster source`)):"raster"===o&&"raster"!==s?n.push(new t.V(a,i.source,`layer "${i.id}" requires a vector source`)):"vector"!==o||i["source-layer"]?"raster-dem"===o&&"hillshade"!==s?n.push(new t.V(a,i.source,"raster-dem source can only be used with layer type 'hillshade'.")):"raster-array"!==o||["raster","raster-particle"].includes(s)?"line"!==s||!i.paint||!i.paint["line-gradient"]&&!i.paint["line-trim-offset"]||"geojson"===o&&e.lineMetrics?"raster-particle"===s&&"raster-array"!==o&&n.push(new t.V(a,i.source,`layer "${i.id}" requires a 'raster-array' source.`)):n.push(new t.V(a,i,`layer "${i.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):n.push(new t.V(a,i.source,"raster-array source can only be used with layer type 'raster'.")):n.push(new t.V(a,i,`layer "${i.id}" must specify a "source-layer"`)):n.push(new t.V(a,i.source,`source "${i.source}" not found`))}else n.push(new t.V(a,i,'missing required property "source"'));return n=n.concat(dt({key:a,value:i,valueSpec:o.layer,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{"*":()=>[],type:()=>Lt({key:`${a}.type`,value:i.type,valueSpec:o.layer.type,style:e.style,styleSpec:e.styleSpec,object:i,objectKey:"type"}),filter:e=>xt(t.o({layerType:s},e)),layout:e=>dt({layer:i,key:e.key,value:e.value,valueSpec:{},style:e.style,styleSpec:e.styleSpec,objectElementValidators:{"*":e=>At(t.o({layerType:s},e))}}),paint:e=>dt({layer:i,key:e.key,value:e.value,valueSpec:{},style:e.style,styleSpec:e.styleSpec,objectElementValidators:{"*":e=>wt(t.o({layerType:s,layer:i},e))}})}})),n}function Et(e){const n=e.value,i=e.key,a=t.n(n);return"string"!==a?[new t.V(i,n,`string expected, ${a} found`)]:[]}const Tt={promoteId:function({key:e,value:n}){if("string"===t.n(n))return Et({key:e,value:n});{const t=[];for(const i in n)t.push(...Et({key:`${e}.${i}`,value:n[i]}));return t}}};function St(e){const n=e.value,i=e.key,a=e.styleSpec,r=e.style;if(!n.type)return[new t.V(i,n,'"type" is required')];const o=t.u(n.type);let s=[];switch(["vector","raster","raster-dem","raster-array"].includes(o)&&(n.url||n.tiles||s.push(new t.m(i,n,'Either "url" or "tiles" is required.'))),o){case"vector":case"raster":case"raster-dem":case"raster-array":return s=s.concat(dt({key:i,value:n,valueSpec:a[`source_${o.replace("-","_")}`],style:e.style,styleSpec:a,objectElementValidators:Tt})),s;case"geojson":if(s=dt({key:i,value:n,valueSpec:a.source_geojson,style:r,styleSpec:a,objectElementValidators:Tt}),n.cluster)for(const t in n.clusterProperties){const[e,a]=n.clusterProperties[t],r="string"==typeof e?[e,["accumulated"],["get",t]]:e;s.push(...gt({key:`${i}.${t}.map`,value:a,expressionContext:"cluster-map"})),s.push(...gt({key:`${i}.${t}.reduce`,value:r,expressionContext:"cluster-reduce"}))}return s;case"video":return dt({key:i,value:n,valueSpec:a.source_video,style:r,styleSpec:a});case"image":return dt({key:i,value:n,valueSpec:a.source_image,style:r,styleSpec:a});case"canvas":return[new t.V(i,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return yt({key:`${i}.type`,value:n.type,valueSpec:{values:Mt(a)},style:r,styleSpec:a})}}function Mt(t){return t.source.reduce(((e,n)=>{const i=t[n];return"enum"===i.type.type&&(e=e.concat(Object.keys(i.type.values))),e}),[])}function kt(e){const n=e.value,i=e.styleSpec,a=i.light,r=e.style;let o=[];const s=t.n(n);if(void 0===n)return o;if("object"!==s)return o=o.concat([new t.V("light",n,`object expected, ${s} found`)]),o;for(const e in n){const s=e.match(/^(.*)-transition$/);o=o.concat(s&&a[s[1]]&&a[s[1]].transition?Lt({key:e,value:n[e],valueSpec:i.transition,style:r,styleSpec:i}):a[e]?Lt({key:e,value:n[e],valueSpec:a[e],style:r,styleSpec:i}):[new t.V(e,n[e],`unknown property "${e}"`)])}return o}function It(e){const n=e.value;let i=[];if(!n)return i;const a=t.n(n);if("object"!==a)return i=i.concat([new t.V("light-3d",n,`object expected, ${a} found`)]),i;const r=e.styleSpec,o=r["light-3d"],s=e.key,l=e.style,c=e.style.lights;for(const e of["type","id"])if(!(e in n))return i=i.concat([new t.V("light-3d",n,`missing property ${e} on light`)]),i;if(n.type&&c)for(let a=0;a<e.arrayIndex;a++){const e=t.u(n.type),r=c[a];t.u(r.type)===e&&i.push(new t.V(s,n.id,`duplicate light type "${n.type}", previously defined at line ${r.id.__line__}`))}const u=`properties_light_${n.type}`;if(!(u in r))return i=i.concat([new t.V("light-3d",n,`Invalid light type ${n.type}`)]),i;const h=r[u];for(const a in n)if("properties"===a){const o=n[a],s=t.n(o);if("object"!==s)return i=i.concat([new t.V("properties",o,`object expected, ${s} found`)]),i;for(const n in o)i=i.concat(h[n]?Lt({key:n,value:o[n],valueSpec:h[n],style:l,styleSpec:r}):[new t.m(e.key,o[n],`unknown property "${n}"`)])}else{const e=a.match(/^(.*)-transition$/);i=i.concat(e&&o[e[1]]&&o[e[1]].transition?Lt({key:a,value:n[a],valueSpec:r.transition,style:l,styleSpec:r}):o[a]?Lt({key:a,value:n[a],valueSpec:o[a],style:l,styleSpec:r}):[new t.m(a,n[a],`unknown property "${a}"`)])}return i}function Pt(e){const n=e.value,i=e.key,a=e.style,r=e.styleSpec,o=r.terrain;let s=[];const l=t.n(n);if(void 0===n)return s;if("null"===l)return s;if("object"!==l)return s=s.concat([new t.V("terrain",n,`object expected, ${l} found`)]),s;for(const e in n){const i=e.match(/^(.*)-transition$/);s=s.concat(i&&o[i[1]]&&o[i[1]].transition?Lt({key:e,value:n[e],valueSpec:r.transition,style:a,styleSpec:r}):o[e]?Lt({key:e,value:n[e],valueSpec:o[e],style:a,styleSpec:r}):[new t.m(e,n[e],`unknown property "${e}"`)])}if(n.source){const e=a.sources&&a.sources[n.source],r=e&&t.u(e.type);e?"raster-dem"!==r&&s.push(new t.V(i,n.source,`terrain cannot be used with a source of type ${String(r)}, it only be used with a "raster-dem" source type`)):s.push(new t.V(i,n.source,`source "${n.source}" not found`))}else s.push(new t.V(i,n,'terrain is missing required property "source"'));return s}function zt(e){const n=e.value,i=e.style,a=e.styleSpec,r=a.fog;let o=[];const s=t.n(n);if(void 0===n)return o;if("object"!==s)return o=o.concat([new t.V("fog",n,`object expected, ${s} found`)]),o;for(const e in n){const s=e.match(/^(.*)-transition$/);o=o.concat(s&&r[s[1]]&&r[s[1]].transition?Lt({key:e,value:n[e],valueSpec:a.transition,style:i,styleSpec:a}):r[e]?Lt({key:e,value:n[e],valueSpec:r[e],style:i,styleSpec:a}):[new t.m(e,n[e],`unknown property "${e}"`)])}return o}const Dt={"*":()=>[],array:pt,boolean:function(e){const n=e.value,i=e.key,a=t.n(n);return"boolean"!==a?[new t.V(i,n,`boolean expected, ${a} found`)]:[]},number:ft,color:function(e){const n=e.key,i=e.value,a=t.n(i);return"string"!==a?[new t.V(n,i,`color expected, ${a} found`)]:null===t.F(i)?[new t.V(n,i,`color expected, "${i}" found`)]:[]},enum:yt,filter:xt,function:mt,layer:Ct,object:dt,source:St,model:t.K,light:kt,"light-3d":It,terrain:Pt,fog:zt,string:Et,formatted:function(t){return 0===Et(t).length?[]:gt(t)},resolvedImage:function(t){return 0===Et(t).length?[]:gt(t)},projection:function(e){const n=e.value,i=e.styleSpec,a=i.projection,r=e.style;let o=[];const s=t.n(n);if("object"===s)for(const t in n)o=o.concat(Lt({key:t,value:n[t],valueSpec:a[t],style:r,styleSpec:i}));else"string"!==s&&(o=o.concat([new t.V("projection",n,`object or string expected, ${s} found`)]));return o},import:function(e){const{value:n,styleSpec:i}=e,{data:a,...r}=n;Object.defineProperty(r,"__line__",{value:n.__line__,enumerable:!1});let o=dt(t.o({},e,{value:r,valueSpec:i.import}));return""===t.u(r.id)&&o.push(new t.V(`${e.key}.id`,r,"import id can't be an empty string")),a&&(o=o.concat(Ot(a,i,{key:`${e.key}.data`}))),o}};function Lt(e,n=!1){const i=e.value,a=e.valueSpec,r=e.styleSpec;if(a.expression&&t.H(t.u(i)))return mt(e);if(a.expression&&t.t(t.v(i)))return gt(e);if(a.type&&Dt[a.type]){const i=Dt[a.type](e);return!0===n&&i.length>0&&"array"===t.n(e.value)?gt(e):i}return dt(t.o({},e,{valueSpec:a.type?r[a.type]:a}))}function Bt(e){const n=e.value,i=e.key,a=Et(e);return a.length||(-1===n.indexOf("{fontstack}")&&a.push(new t.V(i,n,'"glyphs" url must include a "{fontstack}" token')),-1===n.indexOf("{range}")&&a.push(new t.V(i,n,'"glyphs" url must include a "{range}" token'))),a}function Ot(e,n=t.L,i={}){return Lt({key:i.key||"",value:e,valueSpec:n.$root,styleSpec:n,style:e,objectElementValidators:{glyphs:Bt,"*":()=>[]}})}function Rt(e,n=t.L){return Zt(Ot(e,n))}const Ft=t=>Zt(St(t)),Nt=t=>Zt(kt(t)),jt=t=>Zt(It(t)),Vt=t=>Zt(Pt(t)),Ut=t=>Zt(zt(t)),Gt=t=>Zt(Ct(t)),qt=t=>Zt(xt(t)),$t=t=>Zt(wt(t)),Wt=t=>Zt(At(t)),Ht=e=>Zt(t.K(e));function Zt(t){return t.slice().sort(((t,e)=>t.line&&e.line?t.line-e.line:0))}function Yt(e,n){let i=!1;if(n&&n.length)for(const a of n)a instanceof t.m?t.w(a.message):(e.fire(new t.d(new Error(a.message))),i=!0);return i}const Xt=new t.N({anchor:new t.O(t.L.light.anchor),position:new t.Q(t.L.light.position),color:new t.O(t.L.light.color),intensity:new t.O(t.L.light.intensity)});class Kt extends t.E{constructor(e,n="flat"){super(),this._transitionable=new t.U(Xt),this.setLight(e,n),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(t,e,n={}){this._validate(Nt,t,n)||(this._transitionable.setTransitionOrValue(t),this.id=e)}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}_validate(e,n,i){return(!i||!1!==i.validate)&&Yt(this,e.call(Rt,t.W({value:n,style:{glyphs:!0,sprite:!0},styleSpec:t.L})))}}const Qt=new t.N({source:new t.O(t.L.terrain.source),exaggeration:new t.O(t.L.terrain.exaggeration)});let Jt=class extends t.E{constructor(e,n,i,a){super(),this.scope=i,this._transitionable=new t.U(Qt,i,a),this._transitionable.setTransitionOrValue(e,a),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=n}get(){return this._transitionable.serialize()}set(t,e){this._transitionable.setTransitionOrValue(t,e)}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}getExaggeration(e){return this._transitioning.possiblyEvaluate(new t.X(e)).get("exaggeration")}isZoomDependent(){const e=this._transitionable._values.exaggeration;return null!=e&&null!=e.value&&null!=e.value.expression&&e.value.expression instanceof t.Z}};const te=45,ee=65,ne=.05;function ie(e,n,i,a){const r=t.$(te,ee,i),[o,s]=ae(e,a);let l=1-Math.min(1,Math.exp((n-o)/(s-o)*-6));return l*=l*l,l=Math.min(1,1.00747*l),l*r*e.alpha}function ae(t,e){const n=.5/Math.tan(.5*e);return[t.range[0]+n,t.range[1]+n]}function re(e,n,i,a,r){const o=t._.transformMat4([],[n,i,a],r.mercatorFogMatrix);return ie(e,t._.length(o),r.pitch,r._fov)}function oe(e,n,i,a,r,o,s){const l=[[i,a,0],[r,a,0],[r,o,0],[i,o,0]];let c=Number.MAX_VALUE,u=-Number.MAX_VALUE;for(const e of l){const i=t._.transformMat4([],e,n),a=t._.length(i);c=Math.min(c,a),u=Math.max(u,a)}return[ie(e,c,s.pitch,s._fov),ie(e,u,s.pitch,s._fov)]}const se=new t.N({range:new t.O(t.L.fog.range),color:new t.O(t.L.fog.color),"high-color":new t.O(t.L.fog["high-color"]),"space-color":new t.O(t.L.fog["space-color"]),"horizon-blend":new t.O(t.L.fog["horizon-blend"]),"star-intensity":new t.O(t.L.fog["star-intensity"]),"vertical-range":new t.O(t.L.fog["vertical-range"])});class le extends t.E{constructor(e,n,i,a){super(),this._transitionable=new t.U(se,i,new Map(a)),this.set(e,a),this._transitioning=this._transitionable.untransitioned(),this._transform=n,this.properties=new t.a0(se),this.scope=i}get state(){const e=this._transform,n="globe"===e.projection.name,i=t.a1(e.zoom),a=this.properties.get("range"),r=[.5,3];return{range:n?[t.a2(r[0],a[0],i),t.a2(r[1],a[1],i)]:a,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(e,n,i={}){if(this._validate(Ut,e,i))return;const a=t.W({},e);for(const e of Object.keys(t.L.fog))void 0===a[e]&&(a[e]=t.L.fog[e].default);this._options=a,this._transitionable.setTransitionOrValue(this._options,n)}getOpacity(e){if(!this._transform.projection.supportsFog)return 0;const n=this.properties&&this.properties.get("color")||1;return("globe"===this._transform.projection.name?1:t.$(te,ee,e))*n.a}getOpacityAtLatLng(e,n){return this._transform.projection.supportsFog?function(e,n,i){const a=t.Y.fromLngLat(n),r=i.elevation?i.elevation.getAtPointOrZero(a):0;return re(e,a.x,a.y,r,i)}(this.state,e,n):0}getOpacityForTile(e){if(!this._transform.projection.supportsFog)return[1,1];const n=this._transform.calculateFogTileMatrix(e.toUnwrapped());return oe(this.state,n,0,0,t.a3,t.a3,this._transform)}getOpacityForBounds(t,e,n,i,a){return this._transform.projection.supportsFog?oe(this.state,t,e,n,i,a,this._transform):[1,1]}getFovAdjustedRange(t){return this._transform.projection.supportsFog?ae(this.state,t):[0,1]}isVisibleOnFrustum(e){if(!this._transform.projection.supportsFog)return!1;const n=[4,5,6,7];for(const i of n){const n=e.points[i];let a;if(n[2]>=0)a=n;else{const r=e.points[i-4];a=t.a4(r,n,r[2]/(r[2]-n[2]))}if(re(this.state,a[0],a[1],0,this._transform)>=ne)return!0}return!1}updateConfig(t){this._transitionable.setTransitionOrValue(this._options,new Map(t))}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}_validate(e,n,i){return(!i||!1!==i.validate)&&Yt(this,e.call(Rt,t.W({value:n,style:{glyphs:!0,sprite:!0},styleSpec:t.L})))}}class ce extends t.E{constructor(e,n,i,a){super(),this.scope=i,this._options=e,this.properties=new t.a0(n),this._transitionable=new t.U(n,i,new Map(a)),this._transitionable.setTransitionOrValue(e.properties),this._transitioning=this._transitionable.untransitioned()}updateConfig(t){this._transitionable.setTransitionOrValue(this._options.properties,new Map(t))}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}get(){return this._options.properties=this._transitionable.serialize(),this._options}set(t,e){this._options=t,this._transitionable.setTransitionOrValue(t.properties,e)}shadowsEnabled(){return!!this.properties&&!0===this.properties.get("cast-shadows")}}const ue=new t.N({color:new t.O(t.L.properties_light_ambient.color),intensity:new t.O(t.L.properties_light_ambient.intensity)}),he=new t.N({direction:new t.a5(t.L.properties_light_directional.direction),color:new t.O(t.L.properties_light_directional.color),intensity:new t.O(t.L.properties_light_directional.intensity),"cast-shadows":new t.O(t.L.properties_light_directional["cast-shadows"]),"shadow-intensity":new t.O(t.L.properties_light_directional["shadow-intensity"])});var de="\n#define EPSILON 0.0000001\n#define PI 3.141592653589793\n#ifdef RENDER_CUTOFF\nfloat cutoff_opacity(vec4 cutoff_params,float depth) {float near=cutoff_params.x;float far=cutoff_params.y;float cutoffStart=cutoff_params.z;float cutoffEnd=cutoff_params.w;float linearDepth=(depth-near)/(far-near);return clamp((linearDepth-cutoffStart)/(cutoffEnd-cutoffStart),0.0,1.0);}\n#endif",pe="\nout vec4 glFragColor;highp float unpack_depth(highp vec4 rgba_depth)\n{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}\n#ifdef INDICATOR_CUTOUT\nuniform vec2 u_indicator_cutout_centers;uniform vec4 u_indicator_cutout_params;\n#endif\nvec4 applyCutout(vec4 color) {\n#ifdef INDICATOR_CUTOUT\nfloat holeMinOpacity=u_indicator_cutout_params.x;float holeRadius=max(u_indicator_cutout_params.y,0.0);float holeAspectRatio=u_indicator_cutout_params.z;float fadeStart=u_indicator_cutout_params.w;float distA=distance(vec2(gl_FragCoord.x,gl_FragCoord.y*holeAspectRatio),vec2(u_indicator_cutout_centers[0],u_indicator_cutout_centers[1]*holeAspectRatio));return color*min(smoothstep(fadeStart,holeRadius,distA)+holeMinOpacity,1.0);\n#else\nreturn color;\n#endif\n}\n#ifdef DEBUG_WIREFRAME\n#define HANDLE_WIREFRAME_DEBUG \\\nglFragColor=vec4(0.7,0.0,0.0,0.7); \\\ngl_FragDepth=gl_FragCoord.z-0.0001;\n#else\n#define HANDLE_WIREFRAME_DEBUG\n#endif\n#ifdef RENDER_CUTOFF\nuniform highp vec4 u_cutoff_params;in float v_cutoff_opacity;\n#endif\nvec4 textureLodCustom(sampler2D image,vec2 pos,vec2 lod_coord) {vec2 size=vec2(textureSize(image,0));vec2 dx=dFdx(lod_coord.xy*size);vec2 dy=dFdy(lod_coord.xy*size);float delta_max_sqr=max(dot(dx,dx),dot(dy,dy));float lod=0.5*log2(delta_max_sqr);return textureLod(image,pos,lod);}vec4 applyLUT(highp sampler3D lut,vec4 col) {vec3 size=vec3(textureSize(lut,0));vec3 uvw=(col.rbg*float(size-1.0)+0.5)/size;return vec4(texture(lut,uvw).rgb,col.a);}vec3 applyLUT(highp sampler3D lut,vec3 col) {return applyLUT(lut,vec4(col,1.0)).rgb;}",fe="\n#define EXTENT 8192.0\n#define RAD_TO_DEG 180.0/PI\n#define DEG_TO_RAD PI/180.0\n#define GLOBE_RADIUS EXTENT/PI/2.0\nfloat wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {\n#ifndef PROJECTED_POS_ON_VIEWPORT\nfloat tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;\n#else\nreturn vec3(0.0);\n#endif\n}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(\nunpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(PI/4.0+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}\n#ifdef RENDER_CUTOFF\nuniform vec4 u_cutoff_params;out float v_cutoff_opacity;\n#endif\nconst vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);const float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)\n{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}",me="in highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;out highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",ge="\n#define ELEVATION_SCALE 7.0\n#define ELEVATION_OFFSET 450.0\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(\nmix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}\n#else\nvec3 elevationVector(vec2 pos) { return vec3(0,0,1); }\n#endif\n#ifdef TERRAIN\nuniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float currentElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem,pos).r;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(dd,0)).r;float bl=texture(u_dem,pos+vec2(0,dd)).r;float br=texture(u_dem,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}float prevElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem_prev,pos).r;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem_prev,pos).r;float tr=texture(u_dem_prev,pos+vec2(dd,0)).r;float bl=texture(u_dem_prev,pos+vec2(0,dd)).r;float br=texture(u_dem_prev,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}\n#ifdef TERRAIN_VERTEX_MORPHING\nfloat elevation(vec2 apos) {\n#ifdef ZERO_EXAGGERATION\nreturn 0.0;\n#endif\nfloat nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}\n#else\nfloat elevation(vec2 apos) {\n#ifdef ZERO_EXAGGERATION\nreturn 0.0;\n#endif\nreturn currentElevation(apos);}\n#endif\nhighp float unpack_depth(highp vec4 rgba_depth)\n{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(\nunpack_depth(texture(u_depth,uv-df.xz)),unpack_depth(texture(u_depth,uv+df.xz)),unpack_depth(texture(u_depth,uv-df.zy)),unpack_depth(texture(u_depth,uv+df.zy))\n);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(off.x,0.0)).r;float bl=texture(u_dem,pos+vec2(0.0,off.y)).r;float br=texture(u_dem,pos+off).r;return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}\n#else\nfloat elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }\n#endif",_e="#ifdef FOG\nuniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;out vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}\n#endif",ye="highp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}\n#ifdef FOG\nuniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump vec2 u_fog_vertical_limit;uniform mediump float u_fog_temporal_offset;in vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos,float opacity_limit) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,min(opacity,opacity_limit));}vec3 fog_apply(vec3 color,vec3 pos) {return fog_apply(color,pos,1.0);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec4 fog_apply_premultiplied(vec4 color,vec3 pos,float heightMeters) {float verticalProgress=(u_fog_vertical_limit.x > 0.0 || u_fog_vertical_limit.y > 0.0) ? smoothstep(u_fog_vertical_limit.x,u_fog_vertical_limit.y,heightMeters) : 0.0;float opacityLimit=1.0-smoothstep(0.9,1.0,fog_opacity(pos));return mix(fog_apply_premultiplied(color,pos),color,min(verticalProgress,opacityLimit));}vec3 fog_dither(vec3 color) {\n#ifdef FOG_DITHERING\nvec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);\n#else\nreturn color;\n#endif\n}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}\n#endif",xe="#ifdef RASTER_ARRAY\nuniform sampler2D u_image0;uniform sampler2D u_image1;const vec4 NODATA=vec4(1);ivec4 _raTexLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}vec2 _raTexLinearMix(highp vec2 fxy,highp vec4 colorMix,highp float colorOffset,highp vec4 t00,highp vec4 t10,highp vec4 t01,highp vec4 t11) {vec2 c00=t00==NODATA ? vec2(0) : vec2(colorOffset+dot(t00,colorMix),1);vec2 c10=t10==NODATA ? vec2(0) : vec2(colorOffset+dot(t10,colorMix),1);vec2 c01=t01==NODATA ? vec2(0) : vec2(colorOffset+dot(t01,colorMix),1);vec2 c11=t11==NODATA ? vec2(0) : vec2(colorOffset+dot(t11,colorMix),1);return mix(mix(c01,c11,fxy.x),mix(c00,c10,fxy.x),fxy.y);}vec2 raTexture2D_image0_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image0,c.yz,0),texelFetch(u_image0,c.xz,0),texelFetch(u_image0,c.yw,0),texelFetch(u_image0,c.xw,0)\n);}vec2 raTexture2D_image1_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image1,c.yz,0),texelFetch(u_image1,c.xz,0),texelFetch(u_image1,c.yw,0),texelFetch(u_image1,c.xw,0)\n);}vec2 raTexture2D_image0_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image0,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}vec2 raTexture2D_image1_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image1,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}\n#endif",ve="#ifdef RASTER_ARRAY\nuniform sampler2D u_velocity;uniform mediump vec2 u_velocity_res;uniform mediump float u_max_speed;const vec4 NO_DATA=vec4(1);const vec2 INVALID_VELOCITY=vec2(-1);uniform highp vec2 u_uv_offset;uniform highp float u_data_offset;uniform highp vec4 u_data_scale;ivec4 rasterArrayLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}highp vec2 lookup_velocity(highp vec2 uv) {uv=u_uv_offset.x+u_uv_offset.y*uv;highp vec2 fxy;ivec4 c=rasterArrayLinearCoord(uv,u_velocity_res,fxy);highp vec4 tl=texelFetch(u_velocity,c.yz,0);highp vec4 tr=texelFetch(u_velocity,c.xz,0);highp vec4 bl=texelFetch(u_velocity,c.yw,0);highp vec4 br=texelFetch(u_velocity,c.xw,0);if (tl==NO_DATA) {return INVALID_VELOCITY;}if (tr==NO_DATA) {return INVALID_VELOCITY;}if (bl==NO_DATA) {return INVALID_VELOCITY;}if (br==NO_DATA) {return INVALID_VELOCITY;}highp vec4 t=mix(mix(bl,br,fxy.x),mix(tl,tr,fxy.x),fxy.y);highp vec2 velocity=vec2(u_data_offset+dot(t.rg,u_data_scale.yx),-(u_data_offset+dot(t.ba,u_data_scale.yx)));velocity/=max(u_max_speed,length(velocity));return velocity;}\n#endif\nuniform highp float u_particle_pos_scale;uniform highp vec2 u_particle_pos_offset;highp vec4 pack_pos_to_rgba(highp vec2 p) {highp vec2 v=(p+u_particle_pos_offset)/u_particle_pos_scale;highp vec4 r=vec4(v.x,fract(v.x*255.0),v.y,fract(v.y*255.0));return vec4(r.x-r.y/255.0,r.y,r.z-r.w/255.0,r.w);}highp vec2 unpack_pos_from_rgba(highp vec4 v) {v=floor(v*255.0+0.5)/255.0;highp vec2 p=vec2(v.x+(v.y/255.0),v.z+(v.w/255.0));return u_particle_pos_scale*p-u_particle_pos_offset;}",be="#ifdef RENDER_SHADOWS\nuniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_normal_offset;vec3 shadow_normal_offset(vec3 normal) {float tileInMeters=u_shadow_normal_offset[0];vec3 n=vec3(-normal.xy,tileInMeters*normal.z);float dotScale=min(1.0-dot(normal,u_shadow_direction),1.0)*0.5+0.5;return n*dotScale;}vec3 shadow_normal_offset_model(vec3 normal) {float dotScale=min(1.0-dot(normal,u_shadow_direction),1.0)*0.5+0.5;return normal*dotScale;}float shadow_normal_offset_multiplier0() {return u_shadow_normal_offset[1];}float shadow_normal_offset_multiplier1() {return u_shadow_normal_offset[2];}\n#endif//RENDER_SHADOWS",we="#ifdef RENDER_SHADOWS\n#ifdef DEPTH_TEXTURE\nuniform highp sampler2D u_shadowmap_0;uniform highp sampler2D u_shadowmap_1;\n#else\nuniform sampler2D u_shadowmap_0;uniform sampler2D u_shadowmap_1;\n#endif\nuniform float u_shadow_intensity;uniform float u_shadow_map_resolution;uniform float u_shadow_texel_size;uniform highp vec3 u_shadow_normal_offset;uniform vec2 u_fade_range;uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_bias;highp float shadow_sample_1(highp vec2 uv,highp float compare) {highp float shadow_depth;\n#ifdef DEPTH_TEXTURE\nshadow_depth=texture(u_shadowmap_1,uv).r;\n#else\nshadow_depth=unpack_depth(texture(u_shadowmap_1,uv))*0.5+0.5;\n#endif\nreturn step(shadow_depth,compare);}highp float shadow_sample_0(highp vec2 uv,highp float compare) {highp float shadow_depth;\n#ifdef DEPTH_TEXTURE\nshadow_depth=texture(u_shadowmap_0,uv).r;\n#else\nshadow_depth=unpack_depth(texture(u_shadowmap_0,uv))*0.5+0.5;\n#endif\nreturn step(shadow_depth,compare);}float shadow_occlusion_1(highp vec4 pos,highp float bias) {highp vec2 uv=pos.xy;return shadow_sample_1(uv,pos.z-bias);}float shadow_occlusion_0(highp vec4 pos,highp float bias) {highp float compare0=pos.z-bias;\n#ifdef NATIVE\nhighp vec2 uv=pos.xy;highp vec4 samples=textureGather(u_shadowmap_0,uv,0);lowp vec4 stepSamples=step(samples,vec4(compare0));\n#else\nhighp vec2 uv00=pos.xy-vec2(0.5*u_shadow_texel_size);highp vec2 uv10=uv00+vec2(u_shadow_texel_size,0.0);highp vec2 uv01=uv00+vec2(0.0,u_shadow_texel_size);highp vec2 uv11=uv01+vec2(u_shadow_texel_size,0.0);lowp vec4 stepSamples=vec4(\nshadow_sample_0(uv01,compare0),shadow_sample_0(uv11,compare0),shadow_sample_0(uv10,compare0),shadow_sample_0(uv00,compare0)\n);\n#endif\nvec2 f=fract(pos.xy*u_shadow_map_resolution-vec2(0.5));lowp vec2 lerpx=mix(stepSamples.wx,stepSamples.zy,f.xx);return mix(lerpx.x,lerpx.y,f.y);}float shadow_occlusion(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,highp float bias) {\n#ifdef SHADOWS_SINGLE_CASCADE\nlight_view_pos0.xyz=light_view_pos0.xyz/light_view_pos0.w*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);\n#else\nlight_view_pos0.xyz/=light_view_pos0.w;light_view_pos1.xyz/=light_view_pos1.w;vec4 uv=vec4(light_view_pos0.xy,light_view_pos1.xy);vec4 abs_bounds=abs(uv);if (abs_bounds.x < 1.0 && abs_bounds.y < 1.0) {light_view_pos0.xyz=light_view_pos0.xyz*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);}if (abs_bounds.z >=1.0 || abs_bounds.w >=1.0) {return 0.0;}light_view_pos1.xyz=light_view_pos1.xyz*0.5+0.5;float occlusion1=shadow_occlusion_1(light_view_pos1,bias);return mix(occlusion1,0.0,smoothstep(u_fade_range.x,u_fade_range.y,view_depth));\n#endif\n}highp float calculate_shadow_bias(float NDotL) {\n#ifdef NORMAL_OFFSET\nreturn 0.5*u_shadow_bias.x;\n#else\nreturn 0.5*(u_shadow_bias.x+clamp(u_shadow_bias.y*tan(acos(NDotL)),0.0,u_shadow_bias.z));\n#endif\n}float shadowed_light_factor_normal(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_unbiased(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadow_occlusion(float ndotl,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=calculate_shadow_bias(ndotl);return shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);}\n#endif";const Ae=[];ke(de,Ae),ke(fe,Ae),ke(pe,Ae);const Ce={"_prelude_fog.vertex.glsl":_e,"_prelude_terrain.vertex.glsl":ge,"_prelude_shadow.vertex.glsl":be,"_prelude_fog.fragment.glsl":ye,"_prelude_shadow.fragment.glsl":we,"_prelude_lighting.glsl":"\n#ifdef LIGHTING_3D_MODE\nuniform mediump vec3 u_lighting_ambient_color;uniform mediump vec3 u_lighting_directional_dir;uniform mediump vec3 u_lighting_directional_color;uniform mediump vec3 u_ground_radiance;float calculate_ambient_directional_factor(vec3 normal) {float NdotL=dot(normal,u_lighting_directional_dir);const float factor_reduction_max=0.3;float dir_luminance=dot(u_lighting_directional_color,vec3(0.2126,0.7152,0.0722));float directional_factor_min=1.0-factor_reduction_max*min(dir_luminance,1.0);float ambient_directional_factor=mix(directional_factor_min,1.0,min((NdotL+1.0),1.0));const float vertical_factor_min=0.92;float vertical_factor=mix(vertical_factor_min,1.0,normal.z*0.5+0.5);return vertical_factor*ambient_directional_factor;}vec3 linearProduct(vec3 srgbIn,vec3 k) {return srgbIn*pow(k,vec3(1./2.2));}vec3 apply_lighting(vec3 color,vec3 normal,float dir_factor) {float ambient_directional_factor=calculate_ambient_directional_factor(normal);vec3 ambient_contrib=ambient_directional_factor*u_lighting_ambient_color;vec3 directional_contrib=u_lighting_directional_color*dir_factor;return linearProduct(color,ambient_contrib+directional_contrib);}vec4 apply_lighting(vec4 color,vec3 normal,float dir_factor) {return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting(vec3 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return apply_lighting(color.rgb,normal,dir_factor);}vec4 apply_lighting(vec4 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting_ground(vec3 color) {return color*u_ground_radiance;}vec4 apply_lighting_ground(vec4 color) {return vec4(apply_lighting_ground(color.rgb),color.a);}float calculate_NdotL(vec3 normal) {const float ext=0.70710678118;return (clamp(dot(normal,u_lighting_directional_dir),-ext,1.0)+ext)/(1.0+ext);}vec4 apply_lighting_with_emission_ground(vec4 color,float emissive_strength) {return mix(apply_lighting_ground(color),color,emissive_strength);}vec3 compute_flood_lighting(vec3 flood_light_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=flood_light_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);float occlusion_ramp=smoothstep(0.0,0.2,1.0-occlusion);return mix(fully_occluded_color,flood_light_color,occlusion_ramp);}vec3 compute_emissive_draped(vec3 unlit_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=unlit_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);return mix(fully_occluded_color,unlit_color,1.0-occlusion);}\n#endif//LIGHTING_3D_MODE","_prelude_raster_array.glsl":xe,"_prelude_raster_particle.glsl":ve},Ee={};Ie("",ge),Ie(ye,_e),Ie(we,be),Ie(xe,""),Ie(ve,"");const Te=Ie(pe,fe),Se=de;var Me={background:Ie('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform vec4 u_color;uniform float u_opacity;\n#ifdef LIGHTING_3D_MODE\nin vec4 v_color;\n#endif\nvoid main() {vec4 out_color;\n#ifdef LIGHTING_3D_MODE\nout_color=v_color;\n#else\nout_color=u_color;\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\nglFragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\n#include "_prelude_lighting.glsl"\nin vec2 a_pos;uniform mat4 u_matrix;\n#ifdef LIGHTING_3D_MODE\nuniform mediump vec4 u_color;out vec4 v_color;uniform float u_emissive_strength;\n#endif\nvoid main() {gl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef LIGHTING_3D_MODE\nv_color=apply_lighting_with_emission_ground(u_color,u_emissive_strength);\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}'),backgroundPattern:Ie('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform float u_emissive_strength;uniform sampler2D u_image;in vec2 v_pos;void main() {vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=textureLodCustom(u_image,pos,v_pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\nglFragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\nuniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_tile_units_to_pixels,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}'),circle:Ie('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nin vec3 v_data;in float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nuniform float u_emissive_strength;void main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(\nantialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)\n);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);\n#endif\n#ifdef FOG\nout_color=fog_apply_premultiplied(out_color,v_fog_pos);\n#endif\nglFragColor=out_color*(v_visibility*opacity_t);\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\n}','#include "_prelude_fog.vertex.glsl"\n#include "_prelude_terrain.vertex.glsl"\n#define NUM_VISIBILITY_RINGS 2\n#define INV_SQRT2 0.70710678\n#define ELEVATION_BIAS 0.0001\n#define NUM_SAMPLES_PER_RING 16\nuniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;in vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nin vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;\n#endif\nout vec3 v_data;out float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {\n#if defined(TERRAIN)\nreturn elevation(pos)+ELEVATION_BIAS;\n#else\nreturn 0.0;\n#endif\n}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);\n#ifdef PITCH_WITH_MAP\n#ifdef PROJECTION_GLOBE_VIEW\nreturn u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );\n#else\nreturn u_matrix*( world_center+vec4(sample_offset,0,0) );\n#endif\n#else\nreturn projected_center+vec4(sample_offset,0,0);\n#endif\n}float get_sample_step() {\n#ifdef PITCH_WITH_MAP\nreturn 2.0*PI/float(NUM_SAMPLES_PER_RING);\n#else\nreturn PI/float(NUM_SAMPLES_PER_RING);\n#endif\n}void main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);\n#else \nsurface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);\n#endif\nvec4 projected_center=u_matrix*world_center;float view_scale=0.0;\n#ifdef PITCH_WITH_MAP\n#ifdef SCALE_WITH_MAP\nview_scale=1.0;\n#else\nview_scale=projected_center.w/u_camera_to_center_distance;\n#endif\n#else\n#ifdef SCALE_WITH_MAP\nview_scale=u_camera_to_center_distance;\n#else\nview_scale=projected_center.w;\n#endif\n#endif\ngl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;\n#ifdef TERRAIN\nfloat step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;\n#ifdef PITCH_WITH_MAP\nfloat cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;\n#else\nocclusion_world_center=world_center;occlusion_projected_center=projected_center;\n#endif\nfor(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);\n#else\nvisibility=1.0;\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nvisibility=1.0;\n#endif\nv_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);\n#ifdef FOG\nv_fog_pos=fog_position(world_center.xyz);\n#endif\n}'),clippingMask:Ie("void main() {glFragColor=vec4(1.0);}","in vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Ie('#include "_prelude_fog.fragment.glsl"\nuniform highp float u_intensity;in vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);glFragColor=vec4(val,1.0,1.0,1.0);\n#ifdef FOG\nif (u_is_globe==0) {glFragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}\n#endif\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_terrain.vertex.glsl"\n#include "_prelude_fog.vertex.glsl"\nuniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;in vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nin vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;\n#endif\nout vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#else\npos=vec3(tilePos+extrude,elevation(tilePos));\n#endif\ngl_Position=u_matrix*vec4(pos,1);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}'),heatmapTexture:Ie("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));glFragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(0.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}","in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:Ie("in float v_placed;in float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);glFragColor =mix(red,blue,step(0.5,v_placed))*0.5;glFragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",'#include "_prelude_terrain.vertex.glsl"\nin vec3 a_pos;in vec2 a_anchor_pos;in vec2 a_extrude;in vec2 a_placed;in vec2 a_shift;in float a_size_scale;in vec2 a_padding;in float a_z_offset;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;out float v_placed;out float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*(a_z_offset+elevation(a_anchor_pos)),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}'),collisionCircle:Ie("in float v_radius;in vec2 v_extrude;in float v_perspective_ratio;in float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);glFragColor=color*alpha*opacity_t;}","in vec2 a_pos_2f;in float a_radius;in vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;out float v_radius;out vec2 v_extrude;out float v_perspective_ratio;out float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(\nmix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:Ie("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);glFragColor=mix(u_color,overlay_color,overlay_color.a);}",'#include "_prelude_terrain.vertex.glsl"\nin vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nin vec3 a_pos_3;\n#endif\nout vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;\n#ifdef PROJECTION_GLOBE_VIEW\ngl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);\n#else\ngl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);\n#endif\n}'),fill:Ie('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nuniform float u_emissive_strength;void main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\nvec4 out_color=color;\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\nglFragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\nin vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}'),fillOutline:Ie('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nin highp vec2 v_pos;uniform float u_emissive_strength;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\nglFragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\nin vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;out highp vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}'),fillOutlinePattern:Ie('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_emissive_strength;in highp vec2 v_pos;in highp vec2 v_pos_world;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\nglFragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\nuniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;out highp vec2 v_pos;out highp vec2 v_pos_world;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}'),fillPattern:Ie('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform vec2 u_texsize;uniform sampler2D u_image;in vec2 v_pos;uniform float u_emissive_strength;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\nglFragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\nuniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}'),fillExtrusion:Ie('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_shadow.fragment.glsl"\n#include "_prelude_lighting.glsl"\nin vec4 v_color;in vec4 v_flat;\n#ifdef RENDER_SHADOWS\nin highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;\n#endif\nuniform lowp float u_opacity;\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;in vec2 v_ao;\n#endif\n#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)\nin vec4 v_roof_color;\n#endif\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)\nin highp vec3 v_normal;\n#endif\nuniform vec3 u_flood_light_color;uniform highp float u_vertical_scale;uniform float u_flood_light_intensity;uniform vec3 u_ground_shadow_factor;\n#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)\nin float v_flood_radius;in float v_has_floodlight;\n#endif\nuniform float u_emissive_strength;in float v_height;void main() {\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)\nvec3 normal=normalize(v_normal);\n#endif\nfloat z;vec4 color=v_color;\n#ifdef ZERO_ROOF_RADIUS\nz=float(normal.z > 0.00001);\n#ifdef LIGHTING_3D_MODE\nnormal=mix(normal,vec3(0.0,0.0,1.0),z);\n#else\ncolor=mix(v_color,v_roof_color,z);\n#endif\n#endif\nfloat h=max(0.0,v_height);float ao_shade=1.0;\n#ifdef FAUX_AO\nfloat intensity=u_ao[0];float h_floors=h/(u_ao[1]*u_vertical_scale);float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);ao_shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;\n#ifdef ZERO_ROOF_RADIUS\nconcave*=(1.0-z);\n#endif\nfloat x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);ao_shade*=mix(1.0,x_shade*x_shade*x_shade,concave);\n#ifdef LIGHTING_3D_MODE\n#ifdef FLOOD_LIGHT\ncolor.rgb*=mix(ao_shade,1.0,v_has_floodlight);\n#else\ncolor.rgb*=ao_shade;\n#endif\n#else\ncolor.rgb*=ao_shade;\n#endif\n#endif\n#ifdef LIGHTING_3D_MODE\nfloat flood_radiance=0.0;\n#ifdef FLOOD_LIGHT\nflood_radiance=(1.0-min(h/v_flood_radius,1.0))*u_flood_light_intensity*v_has_floodlight;\n#endif\n#ifdef RENDER_SHADOWS\n#ifdef FLOOD_LIGHT\nfloat ndotl_unclamped=dot(normal,u_shadow_direction);float ndotl=max(0.0,ndotl_unclamped);float occlusion=ndotl_unclamped < 0.0 ? 1.0 : shadow_occlusion(ndotl,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 litColor=apply_lighting(color.rgb,normal,(1.0-u_shadow_intensity*occlusion)*ndotl);vec3 floodLitColor=compute_flood_lighting(u_flood_light_color*u_opacity,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=mix(litColor,floodLitColor,flood_radiance);\n#else\nfloat shadowed_lighting_factor=shadowed_light_factor_normal(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);color.rgb=apply_lighting(color.rgb,normal,shadowed_lighting_factor);\n#endif\n#else\ncolor.rgb=apply_lighting(color.rgb,normal);\n#ifdef FLOOD_LIGHT\ncolor.rgb=mix(color.rgb,u_flood_light_color*u_opacity,flood_radiance);\n#endif\n#endif\ncolor.rgb=mix(color.rgb,v_flat.rgb,u_emissive_strength);color*=u_opacity;\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos,h));\n#endif\n#ifdef INDICATOR_CUTOUT\ncolor=applyCutout(color);\n#endif\nglFragColor=color;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\n#include "_prelude_terrain.vertex.glsl"\n#include "_prelude_shadow.vertex.glsl"\n#include "_prelude_lighting.glsl"\nuniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nin vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;\n#endif\nuniform highp float u_vertical_scale;out vec4 v_color;out vec4 v_flat;\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;\n#endif\n#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)\nout vec4 v_roof_color;\n#endif\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)\nout highp vec3 v_normal;\n#endif\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;out vec2 v_ao;\n#endif\n#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)\nout float v_flood_radius;out float v_has_floodlight;\n#endif\nout float v_height;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define highp float flood_light_wall_radius\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize highp float flood_light_wall_radius\nbase*=u_vertical_scale;height*=u_vertical_scale;vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)\nv_normal=normal;\n#endif\nbase=max(0.0,base);float attr_height=height;height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\nfloat ele=0.0;float h=0.0;float c_ele=0.0;vec3 pos;\n#ifdef TERRAIN\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);pos=vec3(pos_nx.xy,h);\n#else\nh=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nfloat lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#endif\nfloat cutoff=1.0;vec3 scaled_pos=pos;\n#ifdef RENDER_CUTOFF\nvec3 centroid_random=vec3(centroid_pos.xy,centroid_pos.x+centroid_pos.y+1.0);vec3 ground_pos=centroid_pos.x==0.0 ? pos.xyz : (centroid_random/8.0);vec4 ground=u_matrix*vec4(ground_pos.xy,ele,1.0);cutoff=max(0.01,cutoff_opacity(u_cutoff_params,ground.z));if (centroid_pos.y !=0.0 && centroid_pos.x !=0.0) {vec3 g=floor(ground_pos);vec3 mod_=centroid_random-g*8.0;float seed=min(1.0,0.1*(min(3.5,max(mod_.x+mod_.y,0.2*attr_height))*0.35+mod_.z));if (cutoff < 0.8-seed) {cutoff=0.0;}}float cutoff_scale=cutoff;scaled_pos.z=mix(c_ele,h,cutoff_scale);\n#endif\nfloat hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (cutoff < 0.01 && centroid_pos.x !=0.0));gl_Position=mix(u_matrix*vec4(scaled_pos,1),AWAY,hidden);h=h-ele;v_height=h;\n#ifdef RENDER_SHADOWS\nvec3 shd_pos0=pos;vec3 shd_pos1=pos;\n#ifdef NORMAL_OFFSET\nvec3 offset=shadow_normal_offset(normal);shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();\n#endif\nv_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);\n#endif\nfloat NdotL=0.0;float colorvalue=0.0;\n#ifndef LIGHTING_3D_MODE\ncolorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);if (normal.y !=0.0) {float r=0.84;r=mix(0.7,0.98,1.0-u_lightintensity);NdotL*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}\n#endif\n#ifdef FAUX_AO\nfloat concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;\n#ifdef TERRAIN\ntop_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);\n#endif\nv_ao=vec2(mix(concave,-concave,start),y_ground);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);\n#ifdef PROJECTION_GLOBE_VIEW\ntop_height+=u_height_lift;\n#endif\ngl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;\n#endif\n#ifdef LIGHTING_3D_MODE\n#ifdef FLOOD_LIGHT\nfloat is_wall=1.0-float(t > 0.0 && top_up_ny.y > 0.0);v_has_floodlight=float(flood_light_wall_radius > 0.0 && is_wall > 0.0);v_flood_radius=flood_light_wall_radius*u_vertical_scale;\n#endif\nv_color=vec4(color.rgb,1.0);v_flat=vec4(linearProduct(color.rgb,vec3(calculate_NdotL(normal))),1.0);\n#else\nv_color=vec4(0.0,0.0,0.0,1.0);v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_color*=u_opacity;\n#endif\n#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)\nfloat roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color=vec4(0.0,0.0,0.0,1.0);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_roof_color*=u_opacity;\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}'),fillExtrusionDepth:Ie("in highp float v_depth;void main() {\n#ifndef DEPTH_TEXTURE\nglFragColor=pack_depth(v_depth);\n#endif\n}",'#include "_prelude_terrain.vertex.glsl"\nuniform mat4 u_matrix;uniform float u_edge_radius;uniform float u_vertical_scale;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\nout highp float v_depth;void main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\nbase*=u_vertical_scale;height*=u_vertical_scale;vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\nvec3 pos;\n#ifdef TERRAIN\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;float ele=elevation(pos_nx.xy);float c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;float h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base);pos=vec3(pos_nx.xy,h);\n#else\npos=vec3(pos_nx.xy,t > 0.0 ? height : base);\n#endif\nfloat hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);v_depth=gl_Position.z/gl_Position.w;}'),fillExtrusionPattern:Ie('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform vec2 u_texsize;uniform sampler2D u_image;\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;in vec3 v_ao;\n#endif\n#ifdef LIGHTING_3D_MODE\nin vec3 v_normal;\n#endif\nin vec2 v_pos;in vec4 v_lighting;uniform lowp float u_opacity;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define mediump vec4 pattern\n#pragma mapbox: define highp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize highp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color,normalize(v_normal))*u_opacity;\n#else\nout_color=out_color*v_lighting;\n#endif\n#ifdef FAUX_AO\nfloat intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\n#ifdef INDICATOR_CUTOUT\nout_color=applyCutout(out_color);\n#endif\nglFragColor=out_color;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\n#include "_prelude_terrain.vertex.glsl"\n#include "_prelude_lighting.glsl"\nuniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nin vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;\n#endif\nout vec2 v_pos;out vec4 v_lighting;\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;out vec3 v_ao;\n#endif\n#ifdef LIGHTING_3D_MODE\nout vec3 v_normal;\n#endif\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define mediump vec4 pattern\n#pragma mapbox: define highp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize highp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\nfloat ele=0.0;float h=z;vec3 p;float c_ele;\n#ifdef TERRAIN\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);p=vec3(pos_nx.xy,h);\n#else\np=vec3(pos_nx.xy,z);\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nfloat lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#endif\nfloat hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0\n? pos_nx.xy\n: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;\n#ifdef LIGHTING_3D_MODE\nNdotL=calculate_NdotL(normal);\n#else\nNdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);\n#endif\nif (normal.y !=0.0) {float r=0.84;\n#ifndef LIGHTING_3D_MODE\nr=mix(0.7,0.98,1.0-u_lightintensity);\n#endif\nNdotL*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}\n#ifdef FAUX_AO\nfloat concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;\n#ifdef TERRAIN\ntop_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);\n#endif\nv_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);\n#ifdef PROJECTION_GLOBE_VIEW\ntop_height+=u_height_lift;\n#endif\ngl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;\n#endif\n#ifdef LIGHTING_3D_MODE\nv_normal=normal;\n#else\nv_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;\n#endif \n#ifdef FOG\nv_fog_pos=fog_position(p);\n#endif\n}'),groundShadow:Ie('#include "_prelude_shadow.fragment.glsl"\nprecision highp float;uniform vec3 u_ground_shadow_factor;in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;\n#ifdef FOG\nin float v_fog_opacity;\n#endif\nvoid main() {float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 shadow=mix(u_ground_shadow_factor,vec3(1.0),light);\n#ifdef RENDER_CUTOFF\nshadow=mix(vec3(1.0),shadow,cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w));\n#endif\n#ifdef FOG\nshadow=mix(shadow,vec3(1.0),v_fog_opacity);\n#endif\n#ifdef INDICATOR_CUTOUT\nshadow=mix(shadow,vec3(1.0),1.0-applyCutout(vec4(1.0)).r);\n#endif\nglFragColor=vec4(shadow,1.0);}','#include "_prelude_fog.vertex.glsl"\nuniform mat4 u_matrix;uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;in vec2 a_pos;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;\n#ifdef FOG\nout float v_fog_opacity;\n#endif\nvoid main() {gl_Position=u_matrix*vec4(a_pos,0.0,1.0);v_pos_light_view_0=u_light_matrix_0*vec4(a_pos,0.0,1.0);v_pos_light_view_1=u_light_matrix_1*vec4(a_pos,0.0,1.0);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);v_fog_opacity=fog(v_fog_pos);\n#endif\n}'),fillExtrusionGroundEffect:Ie("uniform highp float u_ao_pass;uniform highp float u_opacity;uniform highp float u_flood_light_intensity;uniform highp vec3 u_flood_light_color;uniform highp float u_attenuation;uniform sampler2D u_fb;uniform float u_fb_size;\n#ifdef SDF_SUBPASS\nin highp vec2 v_pos;in highp vec4 v_line_segment;in highp float v_flood_light_radius_tile;in highp vec2 v_ao;float line_df(highp vec2 a,highp vec2 b,highp vec2 p) {highp vec2 ba=b-a;highp vec2 pa=p-a;highp float r=clamp(dot(pa,ba)/dot(ba,ba),0.0,1.0);return length(pa-r*ba);}\n#ifdef FOG\nin highp float v_fog;\n#endif\n#endif\nvoid main() {\n#ifdef CLEAR_SUBPASS\nvec4 color=vec4(1.0);\n#ifdef CLEAR_FROM_TEXTURE\ncolor=texture(u_fb,gl_FragCoord.xy/vec2(u_fb_size));\n#endif\nglFragColor=color;\n#else\n#ifdef SDF_SUBPASS\nhighp float d=line_df(v_line_segment.xy,v_line_segment.zw,v_pos);highp float effect_radius=mix(v_flood_light_radius_tile,v_ao.y,u_ao_pass);d/=effect_radius;d=min(d,1.0);d=1.0-pow(1.0-d,u_attenuation);highp float effect_intensity=mix(u_flood_light_intensity,v_ao.x,u_ao_pass);highp float fog=1.0;\n#ifdef FOG\nfog=v_fog;\n#endif\n#ifdef RENDER_CUTOFF\nfog*=v_cutoff_opacity;\n#endif\nglFragColor=vec4(vec3(0.0),mix(1.0,d,effect_intensity*u_opacity*fog));\n#else\nvec4 color=mix(vec4(u_flood_light_color,1.0),vec4(vec3(0.0),1.0),u_ao_pass);\n#ifdef OVERDRAW_INSPECTOR\ncolor=vec4(1.0);\n#endif\nglFragColor=color;\n#endif\nHANDLE_WIREFRAME_DEBUG;\n#endif\n}",'#include "_prelude_fog.vertex.glsl"\nin highp vec4 a_pos_end;in highp float a_angular_offset_factor;in highp float a_hidden_by_landmark;\n#ifdef SDF_SUBPASS\nout highp vec2 v_pos;out highp vec4 v_line_segment;out highp float v_flood_light_radius_tile;out highp vec2 v_ao;\n#ifdef FOG\nout highp float v_fog;\n#endif\n#endif\nuniform highp float u_flood_light_intensity;uniform highp mat4 u_matrix;uniform highp float u_ao_pass;uniform highp float u_meter_to_tile;uniform highp float u_edge_radius;uniform highp vec2 u_ao;\n#pragma mapbox: define highp float flood_light_ground_radius\nconst float TANGENT_CUTOFF=4.0;const float NORM=32767.0;void main() {\n#pragma mapbox: initialize highp float flood_light_ground_radius\nvec2 p=a_pos_end.xy;vec2 q=floor(a_pos_end.zw*0.5);vec2 start_bottom=a_pos_end.zw-q*2.0;float fl_ground_radius=flood_light_ground_radius;fl_ground_radius=abs(flood_light_ground_radius);float direction=flood_light_ground_radius < 0.0 ?-1.0 : 1.0;float flood_radius_tile=fl_ground_radius*u_meter_to_tile;vec2 v=normalize(q-p);float ao_radius=u_ao.y/3.5;float effect_radius=mix(flood_radius_tile,ao_radius,u_ao_pass)+u_edge_radius;float angular_offset_factor=a_angular_offset_factor/NORM*TANGENT_CUTOFF;float angular_offset=direction*angular_offset_factor*effect_radius;float top=1.0-start_bottom.y;float side=(0.5-start_bottom.x)*2.0;vec2 extrusion_parallel=v*side*mix(1.0,angular_offset,top);vec2 perp=vec2(v.y,-v.x);vec2 extrusion_perp=direction*perp*effect_radius*top;vec3 pos=vec3(mix(q,p,start_bottom.x),0.0);pos.xy+=extrusion_parallel+extrusion_perp;\n#ifdef SDF_SUBPASS\nv_pos=pos.xy;v_line_segment=vec4(p,q)+perp.xyxy*u_edge_radius;v_flood_light_radius_tile=flood_radius_tile;v_ao=vec2(u_ao.x,ao_radius);\n#ifdef FOG\nv_fog_pos=fog_position(pos);v_fog=1.0-fog(v_fog_pos);\n#endif\n#endif\nfloat hidden_by_landmark=0.0;\n#ifdef HAS_CENTROID\nhidden_by_landmark=a_hidden_by_landmark;\n#endif\nfloat isFloodlit=float(fl_ground_radius > 0.0 && u_flood_light_intensity > 0.0);float hidden=mix(1.0-isFloodlit,isFloodlit,u_ao_pass);hidden+=hidden_by_landmark;gl_Position=mix(u_matrix*vec4(pos,1.0),AWAY,float(hidden > 0.0));\n#ifdef RENDER_CUTOFF\nv_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);\n#endif\n}'),hillshadePrepare:Ie("precision highp float;uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;float getElevation(vec2 coord) {return texture(u_image,coord).r/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(\n(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)\n)/pow(2.0,exaggeration+(19.2562-u_zoom));glFragColor=clamp(vec4(\nderiv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);}","uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Ie('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;uniform float u_emissive_strength;void main() {vec4 pixel=texture(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);glFragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef LIGHTING_3D_MODE\nglFragColor=apply_lighting_with_emission_ground(glFragColor,u_emissive_strength);\n#endif\n#ifdef FOG\nglFragColor=fog_dither(fog_apply_premultiplied(glFragColor,v_fog_pos));\n#endif\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\nuniform mat4 u_matrix;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}'),line:Ie('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;uniform lowp vec2 u_trim_fade_range;uniform lowp vec4 u_trim_color;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec4 v_uv;\n#ifdef RENDER_LINE_DASH\nuniform sampler2D u_dash_image;in vec2 v_tex;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nuniform sampler2D u_gradient_image;\n#endif\nfloat luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}uniform float u_emissive_strength;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float border_width\n#pragma mapbox: define lowp vec4 border_color\nfloat linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize lowp vec4 dash\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float border_width\n#pragma mapbox: initialize lowp vec4 border_color\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);\n#ifdef RENDER_LINE_DASH\nfloat sdfdist=texture(u_dash_image,v_tex).r;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;alpha*=linearstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);\n#endif\nhighp vec4 out_color;\n#ifdef RENDER_LINE_GRADIENT\nout_color=texture(u_gradient_image,v_uv.xy);\n#else\nout_color=color;\n#endif\nfloat trim_alpha=1.0;\n#ifdef RENDER_LINE_TRIM_OFFSET\nhighp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {float start_transition=max(0.0,min(1.0,(line_progress-trim_start)/clamp(u_trim_fade_range[0],1e-4,1.0)));float end_transition=max(0.0,min(1.0,(trim_end-line_progress)/clamp(u_trim_fade_range[1],1e-4,1.0)));float transition_factor=min(start_transition,end_transition);out_color=mix(out_color,u_trim_color,transition_factor);trim_alpha=out_color.a;}\n#endif\nif (u_alpha_discard_threshold !=0.0) {if (alpha < u_alpha_discard_threshold) {discard;}}\n#ifdef RENDER_LINE_BORDER\nfloat edgeBlur=(border_width+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);if (border_color.a==0.0) {    \nfloat Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}} else {out_color.rgb=mix(border_color.rgb*border_color.a*trim_alpha,out_color.rgb,smoothAlpha);}}\n#endif\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\nout_color*=(alpha*opacity);\n#ifdef INDICATOR_CUTOUT\nout_color=applyCutout(out_color);\n#endif\nglFragColor=out_color;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\n#include "_prelude_terrain.vertex.glsl"\n#define EXTRUDE_SCALE 0.015873016\nin vec2 a_pos_normal;in vec4 a_data;\n#if defined(ELEVATED)\nin float a_z_offset;\n#endif\n#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)\nin highp vec4 a_packed;\n#endif\n#ifdef RENDER_LINE_DASH\nin float a_linesofar;\n#endif\nuniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec4 v_uv;\n#ifdef RENDER_LINE_DASH\nuniform vec2 u_texsize;uniform float u_tile_units_to_pixels;out vec2 v_tex;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nuniform float u_image_height;\n#endif\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float border_width\n#pragma mapbox: define lowp vec4 border_color\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize lowp vec4 dash\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float border_width\n#pragma mapbox: initialize lowp vec4 border_color\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);\n#if defined(ELEVATED)\nvec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 halfCellProgress=normal.yx*32.0;float ele0=elevation(pos);float ele_line=max(ele0,max(elevation(pos+halfCellProgress),elevation(pos-halfCellProgress)));float ele1=elevation(pos+offsetTile);float ele2=elevation(pos-offsetTile);float ele_max=max(ele_line,0.5*(ele1+ele2));float ele=ele_max-ele0+ele1+a_z_offset ;gl_Position=u_matrix*vec4(pos+offsetTile,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*0.1*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);\n#else\ngl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;\n#endif\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\n#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)\nfloat a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];\n#ifdef RENDER_LINE_GRADIENT\nhighp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);\n#else\nv_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);\n#endif\n#endif\n#ifdef RENDER_LINE_DASH\nfloat scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/floorwidth,(-normal.y*height+dash.x+0.5)/u_texsize.y);\n#endif\nv_width2=vec2(outset,inset);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}'),linePattern:Ie('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform highp float u_device_pixel_ratio;uniform highp float u_alpha_discard_threshold;uniform highp vec2 u_texsize;uniform highp float u_tile_units_to_pixels;uniform highp vec2 u_trim_offset;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in highp float v_linesofar;in float v_gamma_scale;in float v_width;\n#ifdef RENDER_LINE_TRIM_OFFSET\nin highp vec4 v_uv;\n#endif\n#ifdef LINE_JOIN_NONE\nin vec2 v_pattern_data;\n#endif\n#pragma mapbox: define mediump vec4 pattern\n#pragma mapbox: define mediump float pixel_ratio\n#pragma mapbox: define mediump float blur\n#pragma mapbox: define mediump float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize mediump float pixel_ratio\n#pragma mapbox: initialize mediump float blur\n#pragma mapbox: initialize mediump float opacity\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;float pattern_size=display_size.x/u_tile_units_to_pixels;float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);highp float pattern_x=v_linesofar/pattern_size*aspect;float x=mod(pattern_x,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));vec2 lod_pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(pattern_x,y));vec4 color=textureLodCustom(u_image,pos,lod_pos);\n#ifdef RENDER_LINE_TRIM_OFFSET\nhighp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {color=vec4(0,0,0,0);}}\n#endif\n#ifdef LINE_JOIN_NONE\nfloat pattern_len=pattern_size/aspect;float segment_phase=pattern_len-mod(v_linesofar-v_pattern_data.x+pattern_len,pattern_len);float visible_start=segment_phase-step(pattern_len*0.5,segment_phase)*pattern_len;float visible_end=floor((v_pattern_data.y-segment_phase)/pattern_len)*pattern_len+segment_phase;visible_end+=step(pattern_len*0.5,v_pattern_data.y-visible_end)*pattern_len;if (v_pattern_data.x < visible_start || v_pattern_data.x >=visible_end) {color=vec4(0.0);}\n#endif\n#ifdef LIGHTING_3D_MODE\ncolor=apply_lighting_ground(color);\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ncolor*=(alpha*opacity);if (u_alpha_discard_threshold !=0.0) {if (color.a < u_alpha_discard_threshold) {discard;}}\n#ifdef INDICATOR_CUTOUT\ncolor=applyCutout(color);\n#endif\nglFragColor=color;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\n#include "_prelude_terrain.vertex.glsl"\n#define scale 0.015873016\nin vec2 a_pos_normal;in vec4 a_data;\n#if defined(ELEVATED)\nin float a_z_offset;\n#endif\n#ifdef RENDER_LINE_TRIM_OFFSET\nin highp vec4 a_packed;\n#endif\nin highp float a_linesofar;\n#ifdef LINE_JOIN_NONE\nin highp vec3 a_pattern_data;out vec2 v_pattern_data;\n#endif\nuniform mat4 u_matrix;uniform float u_tile_units_to_pixels;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out highp float v_linesofar;out float v_gamma_scale;out float v_width;\n#ifdef RENDER_LINE_TRIM_OFFSET\nout highp vec4 v_uv;\n#endif\n#pragma mapbox: define mediump float blur\n#pragma mapbox: define mediump float opacity\n#pragma mapbox: define mediump float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define mediump float floorwidth\n#pragma mapbox: define mediump vec4 pattern\n#pragma mapbox: define mediump float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize mediump float blur\n#pragma mapbox: initialize mediump float opacity\n#pragma mapbox: initialize mediump float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize mediump float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize mediump float pixel_ratio\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);vec2 dist=outset*a_extrude*scale;float u=0.5*a_direction;float t=1.0-abs(u);vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);\n#if defined(ELEVATED)\nvec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 halfCellProgress=normal.yx*32.0;float ele0=elevation(pos);float ele_line=max(ele0,max(elevation(pos+halfCellProgress),elevation(pos-halfCellProgress)));float ele1=elevation(pos+offsetTile);float ele2=elevation(pos-offsetTile);float ele_max=max(ele_line,0.5*(ele1+ele2));float ele=ele_max-ele0+ele1+a_z_offset ;gl_Position=u_matrix*vec4(pos+offsetTile,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*0.1*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);\n#else\ngl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;\n#endif\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\n#ifdef RENDER_LINE_TRIM_OFFSET\nfloat a_uv_x=a_packed[0];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];v_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);\n#endif\nv_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;\n#ifdef LINE_JOIN_NONE\nv_width=floorwidth+ANTIALIASING;mediump float pixels_to_tile_units=1.0/u_tile_units_to_pixels;mediump float pixel_ratio_inverse=1.0/pixel_ratio;mediump float aspect=v_width/((pattern.w-pattern.y)*pixel_ratio_inverse);highp float subt_multiple=(pattern.z-pattern.x)*pixel_ratio_inverse*pixels_to_tile_units*aspect*32.0;highp float subt=floor(a_pattern_data.z/subt_multiple)*subt_multiple;float offset_sign=(fract(a_pattern_data.x)-0.5)*4.0;float line_progress_offset=offset_sign*v_width*0.5*pixels_to_tile_units;v_linesofar=(a_pattern_data.z-subt)+a_linesofar+line_progress_offset;v_pattern_data=vec2(a_pattern_data.x+line_progress_offset,a_pattern_data.y);\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}'),raster:Ie('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\n#include "_prelude_raster_array.glsl"\nuniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;uniform highp float u_zoom_transition;in vec2 v_pos0;in vec2 v_pos1;in float v_depth;\n#ifdef PROJECTION_GLOBE_VIEW\nin float v_split_fade;\n#endif\nuniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;uniform float u_emissive_strength;\n#ifndef RASTER_ARRAY\nuniform sampler2D u_image0;uniform sampler2D u_image1;\n#endif\n#ifdef RASTER_COLOR\nuniform sampler2D u_color_ramp;uniform highp vec4 u_colorization_mix;uniform highp float u_colorization_offset;uniform vec2 u_texture_res;\n#endif\nvoid main() {vec4 color0,color1,color;vec2 value;\n#ifdef RASTER_COLOR\n#ifdef RASTER_ARRAY\n#ifdef RASTER_ARRAY_LINEAR\nvalue=mix(\nraTexture2D_image0_linear(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_linear(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t\n);\n#else\nvalue=mix(\nraTexture2D_image0_nearest(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_nearest(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t\n);\n#endif\nif (value.y > 0.0) value.x/=value.y;\n#else\ncolor=mix(texture(u_image0,v_pos0),texture(u_image1,v_pos1),u_fade_t);value=vec2(u_colorization_offset+dot(color.rgb,u_colorization_mix.rgb),color.a);\n#endif\ncolor=texture(u_color_ramp,vec2(value.x,0.5));if (color.a > 0.0) color.rgb/=color.a;color.a*=value.y;\n#else\ncolor0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);\n#endif\ncolor.a*=u_opacity;\n#ifdef GLOBE_POLES\ncolor.a*=1.0-smoothstep(0.0,0.05,u_zoom_transition);\n#endif\nvec3 rgb=color.rgb;rgb=vec3(\ndot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),u_emissive_strength).rgb;\n#endif\n#ifdef FOG\nhighp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));\n#endif\nglFragColor=vec4(out_color*color.a,color.a);\n#ifdef PROJECTION_GLOBE_VIEW\nglFragColor*=mix(1.0,1.0-smoothstep(0.0,0.05,u_zoom_transition),smoothstep(0.8,0.9,v_split_fade));\n#endif\n#ifdef RENDER_CUTOFF\nglFragColor=glFragColor*cutoff_opacity(u_cutoff_params,v_depth);\n#endif\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\nuniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;uniform vec2 u_texture_offset;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;\n#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8\n#ifdef GLOBE_POLES\nin vec3 a_globe_pos;in vec2 a_uv;\n#else\nin vec2 a_pos;in vec2 a_texture_pos;\n#endif\nout vec2 v_pos0;out vec2 v_pos1;out float v_depth;\n#ifdef PROJECTION_GLOBE_VIEW\nout float v_split_fade;\n#endif\nvoid main() {vec2 uv;\n#ifdef GLOBE_POLES\nvec3 globe_pos=a_globe_pos;globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;gl_Position=u_matrix*u_globe_matrix*vec4(globe_pos   ,1.0);uv=a_uv;\n#ifdef FOG\nv_fog_pos=fog_position((u_normalize_matrix*vec4(a_globe_pos,1.0)).xyz);\n#endif\n#else\nfloat w=1.0+dot(a_texture_pos,u_perspective_transform);uv=a_texture_pos/8192.0;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);    \nv_split_fade=0.0;if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;float opposite_merc_center=mod(u_merc_center.x+0.5,1.0);float dist_from_poles=(abs(mercatorY-0.5)*2.0);float range=0.1;v_split_fade=abs(opposite_merc_center-mercatorX);v_split_fade=clamp(1.0-v_split_fade,0.0,1.0);v_split_fade=max(smoothstep(1.0-range,1.0,dist_from_poles),max(smoothstep(1.0-range,1.0,v_split_fade),smoothstep(1.0-range,1.0,1.0-v_split_fade)));}float tiles=u_grid_matrix[0][2];if (tiles > 0.0) {float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvY=mercatorY*tiles-idy;float uvX=mercatorX*tiles-idx;uv=vec2(uvX,uvY);}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;\n#ifdef FOG\nv_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);\n#endif\n#else\ngl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n#endif\n#endif\nv_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;v_pos0=u_texture_offset.x+u_texture_offset.y*v_pos0;v_pos1=u_texture_offset.x+u_texture_offset.y*v_pos1;\n#ifdef RENDER_CUTOFF\nv_depth=gl_Position.z;\n#endif\n}'),rasterParticle:Ie('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;in vec2 v_pos0;in vec2 v_pos1;uniform sampler2D u_image0;uniform sampler2D u_image1;void main() {vec4 color0,color1,color;color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 out_color=color.rgb;\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),0.0).rgb;\n#endif\n#ifdef FOG\nhighp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));\n#endif\nglFragColor=vec4(out_color*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\nuniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;\n#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8\nin vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {float w=1.0;vec2 uv;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvX=mercatorX*tiles-idx;float uvY=mercatorY*tiles-idy;uv=vec2(uvX,uvY);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;\n#ifdef FOG\nv_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);\n#endif\n#else\nuv=a_texture_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n#endif\nv_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}'),rasterParticleDraw:Ie("uniform sampler2D u_color_ramp;in float v_particle_speed;void main() {glFragColor=texture(u_color_ramp,vec2(v_particle_speed,0.5));}",'#include "_prelude_raster_particle.glsl"\nin float a_index;uniform sampler2D u_particle_texture;uniform float u_particle_texture_side_len;uniform vec2 u_tile_offset;out float v_particle_speed;void main() {ivec2 pixel_coord=ivec2(\nmod(a_index,u_particle_texture_side_len),a_index/u_particle_texture_side_len);vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);vec2 pos=unpack_pos_from_rgba(pixel)+u_tile_offset;vec2 tex_coord=fract(pos);vec2 velocity=lookup_velocity(tex_coord);if (velocity==INVALID_VELOCITY) {gl_Position=AWAY;v_particle_speed=0.0;} else {gl_Position=vec4(2.0*pos-vec2(1.0),0.0,1.0);v_particle_speed=length(velocity);}gl_PointSize=1.0;}'),rasterParticleTexture:Ie("uniform sampler2D u_texture;uniform float u_opacity;in vec2 v_tex_pos;void main() {vec4 color=texture(u_texture,v_tex_pos);glFragColor=vec4(floor(255.0*color*u_opacity)/255.0);}","in vec2 a_pos;out vec2 v_tex_pos;void main() {vec2 uv=0.5*a_pos+vec2(0.5);v_tex_pos=uv;gl_Position=vec4(a_pos,0.0,1.0);}"),rasterParticleUpdate:Ie('#include "_prelude_raster_particle.glsl"\nuniform sampler2D u_particle_texture;uniform mediump float u_particle_texture_side_len;uniform mediump float u_speed_factor;uniform highp float u_reset_rate;uniform highp float u_rand_seed;in highp vec2 v_tex_coord;const highp vec3 rand_constants=vec3(12.9898,78.233,4375.85453);highp float rand(const highp vec2 co) {highp float t=dot(rand_constants.xy,co);return fract(sin(t)*(rand_constants.z+t));}void main() {ivec2 pixel_coord=ivec2(v_tex_coord*u_particle_texture_side_len);highp vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);highp vec2 pos=unpack_pos_from_rgba(pixel);highp vec2 velocity=lookup_velocity(clamp(pos,0.0,1.0));highp vec2 dp=velocity==INVALID_VELOCITY ? vec2(0) : velocity*u_speed_factor;pos=pos+dp;highp vec2 seed=(pos+v_tex_coord)*u_rand_seed;highp vec2 random_pos=vec2(rand(seed+1.3),rand(seed+2.1));highp float speed=velocity==INVALID_VELOCITY ? 0.0 : length(velocity);highp float reset_rate_bump=speed*u_reset_rate;highp vec2 particle_pos_min=-u_particle_pos_offset;highp vec2 particle_pos_max=vec2(1.0)+u_particle_pos_offset;highp vec2 pos_drop_rate=vec2(1.0)-step(particle_pos_min,pos)+step(particle_pos_max,pos);highp float drop_rate=max(u_reset_rate+reset_rate_bump,length(pos_drop_rate));highp float drop=step(1.0-drop_rate,rand(seed));highp vec2 next_pos=mix(pos,random_pos,drop);glFragColor=pack_pos_to_rgba(next_pos);}',"in vec2 a_pos;out vec2 v_tex_coord;void main() {v_tex_coord=0.5*(a_pos+vec2(1.0));gl_Position=vec4(a_pos,0.0,1.0);}"),symbolIcon:Ie('#include "_prelude_lighting.glsl"\nuniform sampler2D u_texture;\n#ifdef ICON_TRANSITION\nuniform float u_icon_transition;\n#endif\nin float v_fade_opacity;in vec2 v_tex_a;\n#ifdef ICON_TRANSITION\nin vec2 v_tex_b;\n#endif\n#ifdef COLOR_ADJUSTMENT\nuniform mat4 u_color_adj_mat;\n#endif\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float emissive_strength\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float emissive_strength\nlowp float alpha=opacity*v_fade_opacity;vec4 out_color;\n#ifdef ICON_TRANSITION\nvec4 a=texture(u_texture,v_tex_a)*(1.0-u_icon_transition);vec4 b=texture(u_texture,v_tex_b)*u_icon_transition;out_color=(a+b);\n#else\nout_color=texture(u_texture,v_tex_a);\n#endif\n#ifdef COLOR_ADJUSTMENT\nout_color=u_color_adj_mat*out_color;\n#endif\nout_color*=alpha;\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(out_color,emissive_strength);\n#endif\nglFragColor=out_color;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_terrain.vertex.glsl"\nin vec4 a_pos_offset;in vec4 a_tex_size;in vec4 a_pixeloffset;in vec4 a_projected_pos;in float a_fade_opacity;\n#ifdef OCCLUSION_QUERIES\nin float a_occlusion_query_opacity;\n#endif\n#ifdef Z_OFFSET\nin float a_z_offset;\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nin vec3 a_globe_anchor;in vec3 a_globe_normal;\n#endif\n#ifdef ICON_TRANSITION\nin vec2 a_texb;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform vec3 u_up_vector;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nout vec2 v_tex_a;\n#ifdef ICON_TRANSITION\nout vec2 v_tex_b;\n#endif\nout float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float emissive_strength\n#pragma mapbox: define lowp float occlusion_opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float emissive_strength\n#pragma mapbox: initialize lowp float occlusion_opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=elevation(tile_anchor);\n#ifdef Z_OFFSET\ne+=a_z_offset;\n#endif\nvec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;vec3 world_pos_globe;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos_globe=a_globe_anchor+h;world_pos=mix_globe_mercator(world_pos_globe,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjected_point;vec2 a;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetProjected_point=u_matrix*vec4(a_globe_anchor+displacement,1);vec4 projected_point_globe=u_matrix*vec4(world_pos_globe,1);a=projected_point_globe.xy/projected_point_globe.w;\n#else\noffsetProjected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);a=projected_point.xy/projected_point.w;\n#endif\nvec2 b=offsetProjected_point.xy/offsetProjected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=globe_occlusion_fade;\n#ifdef SYMBOL_OCCLUSION_BY_TERRAIN_DEPTH\nocclusion_fade*=occlusionFade(projected_point);\n#endif\nfloat projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nvec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float out_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,hidden);\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,hidden);\n#endif\nv_tex_a=a_tex/u_texsize;\n#ifdef ICON_TRANSITION\nv_tex_b=a_texb/u_texsize;\n#endif\nv_fade_opacity=out_fade_opacity;\n#ifdef OCCLUSION_QUERIES\nfloat occludedFadeMultiplier=mix(occlusion_opacity,1.0,a_occlusion_query_opacity);v_fade_opacity*=occludedFadeMultiplier;\n#endif\n}'),symbolSDF:Ie('#include "_prelude_lighting.glsl"\n#define SDF_PX 8.0\nuniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;uniform bool u_is_halo;in float v_draw_halo;in vec2 v_data0;in vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\n#pragma mapbox: define lowp float emissive_strength\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\n#pragma mapbox: initialize lowp float emissive_strength\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;bool draw_halo=v_draw_halo > 0.0;if (draw_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).r;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);vec4 out_color=color*(alpha*opacity*fade_opacity);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(out_color,emissive_strength);\n#endif\nglFragColor=out_color;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_terrain.vertex.glsl"\nin vec4 a_pos_offset;in vec4 a_tex_size;in vec4 a_pixeloffset;in vec4 a_projected_pos;in float a_fade_opacity;\n#ifdef Z_OFFSET\nin float a_z_offset;\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nin vec3 a_globe_anchor;in vec3 a_globe_normal;\n#endif\n#ifdef OCCLUSION_QUERIES\nin float a_occlusion_query_opacity;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform bool u_is_halo;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nout float v_draw_halo;out vec2 v_data0;out vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\n#pragma mapbox: define lowp float emissive_strength\n#pragma mapbox: define lowp float occlusion_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\n#pragma mapbox: initialize lowp float emissive_strength\n#pragma mapbox: initialize lowp float occlusion_opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=elevation(tile_anchor);\n#ifdef Z_OFFSET\ne+=a_z_offset;\n#endif\nvec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;vec3 world_pos_globe;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos_globe=a_globe_anchor+h;world_pos=mix_globe_mercator(world_pos_globe,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;vec2 a;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);vec4 projected_point_globe=u_matrix*vec4(world_pos_globe,1);a=projected_point_globe.xy/projected_point_globe.w;\n#else\noffsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);a=projected_point.xy/projected_point.w;\n#endif\nvec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=globe_occlusion_fade;\n#ifdef SYMBOL_OCCLUSION_BY_TERRAIN_DEPTH\nocclusion_fade*=occlusionFade(projected_point);\n#endif\nfloat projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nvec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float out_fade_opacity=interpolated_fade_opacity*projection_transition_fade;\n#ifdef OCCLUSION_QUERIES\nfloat occludedFadeMultiplier=mix(occlusion_opacity,1.0,a_occlusion_query_opacity);out_fade_opacity*=occludedFadeMultiplier;\n#endif\nfloat alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,hidden);\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,hidden);\n#endif\nfloat gamma_scale=gl_Position.w;v_draw_halo=(u_is_halo && float(gl_InstanceID)==0.0) ? 1.0 : 0.0;v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,out_fade_opacity);}'),symbolTextAndIcon:Ie('#include "_prelude_lighting.glsl"\n#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_halo;in float v_draw_halo;in vec4 v_data0;in vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\n#pragma mapbox: define lowp float emissive_strength\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\n#pragma mapbox: initialize lowp float emissive_strength\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;glFragColor=texture(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;bool draw_halo=v_draw_halo > 0.0;if (draw_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).r;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);vec4 out_color=color*(alpha*opacity*fade_opacity);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(out_color,emissive_strength);\n#endif\nglFragColor=out_color;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_terrain.vertex.glsl"\nin vec4 a_pos_offset;in vec4 a_tex_size;in vec4 a_projected_pos;in float a_fade_opacity;\n#ifdef OCCLUSION_QUERIES\nin float a_occlusion_query_opacity;\n#endif\n#ifdef Z_OFFSET\nin float a_z_offset;\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nin vec3 a_globe_anchor;in vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;uniform bool u_is_halo;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nout float v_draw_halo;out vec4 v_data0;out vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\n#pragma mapbox: define lowp float emissive_strength\n#pragma mapbox: define lowp float occlusion_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\n#pragma mapbox: initialize lowp float emissive_strength\n#pragma mapbox: initialize lowp float occlusion_opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=elevation(tile_anchor);\n#ifdef Z_OFFSET\ne+=a_z_offset;\n#endif\nvec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offset_projected_point=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offset_projected_point.xy/offset_projected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*font_scale);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=globe_occlusion_fade;\n#ifdef SYMBOL_OCCLUSION_BY_TERRAIN_DEPTH\nocclusion_fade*=occlusionFade(projected_point);\n#endif\nvec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nfloat out_fade_opacity=interpolated_fade_opacity*projection_transition_fade;\n#ifdef OCCLUSION_QUERIES\nfloat occludedFadeMultiplier=mix(occlusion_opacity,1.0,a_occlusion_query_opacity);out_fade_opacity*=occludedFadeMultiplier;\n#endif\nfloat alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+ xAxis*offset.x+yAxis*offset.y,1.0),AWAY,hidden);\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,hidden);\n#endif\nfloat gamma_scale=gl_Position.w;v_draw_halo=(u_is_halo && float(gl_InstanceID)==0.0) ? 1.0 : 0.0;v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,out_fade_opacity,is_sdf);}'),terrainRaster:Ie('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_shadow.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform sampler2D u_image0;in vec2 v_pos0;\n#ifdef FOG\nin float v_fog_opacity;\n#endif\n#ifdef RENDER_SHADOWS\nin vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;\n#endif\nuniform vec3 u_ground_shadow_factor;void main() {vec4 image_color=texture(u_image0,v_pos0);vec4 color;\n#ifdef LIGHTING_3D_MODE\nconst vec3 normal=vec3(0.0,0.0,1.0);\n#ifdef RENDER_SHADOWS\nfloat cutoffOpacity=1.0;\n#ifdef RENDER_CUTOFF\ncutoffOpacity=cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w);\n#endif\n#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS\nvec3 unlit_base=image_color.rgb*(1.0-image_color.a);vec3 emissive_base=image_color.rgb*image_color.a;float ndotl=u_shadow_direction.z;float occlusion=ndotl < 0.0 ? 1.0 : shadow_occlusion(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,0.0);ndotl=max(0.0,ndotl);vec3 lit=apply_lighting(unlit_base,normal,mix(1.0,(1.0-(u_shadow_intensity*occlusion))*ndotl,cutoffOpacity));vec3 emissive=compute_emissive_draped(emissive_base,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=lit+emissive;color.a=1.0;\n#else\nfloat lighting_factor=shadowed_light_factor_normal_unbiased(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);color=apply_lighting(image_color,normal,mix(1.0,lighting_factor,cutoffOpacity));\n#endif\n#else\nfloat lighting_factor=u_lighting_directional_dir.z;color=apply_lighting(image_color,normal,lighting_factor);\n#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS\ncolor.rgb=mix(color.rgb,image_color.rgb,image_color.a);color.a=1.0;\n#endif\n#endif\n#else\ncolor=image_color;\n#endif\n#ifdef FOG\n#ifdef ZERO_EXAGGERATION\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#else\ncolor=fog_dither(fog_apply_from_vert(color,v_fog_opacity));\n#endif\n#endif\nglFragColor=color;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\n#include "_prelude_terrain.vertex.glsl"\nuniform mat4 u_matrix;uniform float u_skirt_height;in vec2 a_pos;out vec2 v_pos0;\n#ifdef FOG\nout float v_fog_opacity;\n#endif\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;out float v_depth;\n#endif\nvoid main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;v_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);\n#ifdef FOG\n#ifdef ZERO_EXAGGERATION\nv_fog_pos=fog_position(decodedPos);\n#else\nv_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));\n#endif\n#endif\n#ifdef RENDER_SHADOWS\nvec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);\n#endif\n}'),terrainDepth:Ie("precision highp float;in float v_depth;void main() {glFragColor=pack_depth(v_depth);}",'#include "_prelude_terrain.vertex.glsl"\nuniform mat4 u_matrix;in vec2 a_pos;out float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}'),skybox:Ie('#include "_prelude_fog.fragment.glsl"\nin lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(\ncos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=texture(u_cubemap,uv).rgb;\n#ifdef FOG\nsky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);\n#endif\nsky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);glFragColor=vec4(sky_color*u_opacity,u_opacity);\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\n}',me),skyboxGradient:Ie('#include "_prelude_fog.fragment.glsl"\nin highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture(u_color_ramp,vec2(progress,0.5));\n#ifdef FOG\ncolor.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;\n#endif\ncolor*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);glFragColor=color;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\n}',me),skyboxCapture:Ie("\nin highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;precision highp float;\n#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)\n#define BETA_M                  vec3(21e-6,21e-6,21e-6)\n#define MIE_G                   0.76\n#define DENSITY_HEIGHT_SCALE_R  8000.0\n#define DENSITY_HEIGHT_SCALE_M  1200.0\n#define PLANET_RADIUS           6360e3\n#define ATMOSPHERE_RADIUS       6420e3\n#define SAMPLE_STEPS            10\n#define DENSITY_STEPS           4\nfloat ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;glFragColor=vec4(color,1.0);}","in highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;out highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:Ie('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform sampler2D u_image0;uniform float u_far_z_cutoff;in vec2 v_pos0;\n#ifndef FOG\nuniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;\n#endif\nvoid main() {vec4 color;\n#ifdef CUSTOM_ANTIALIASING\nvec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture(u_image0,v_pos0);\n#ifdef LIGHTING_3D_MODE\n#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS\nraster=apply_lighting_with_emission_ground(raster,raster.a);color=vec4(raster.rgb*antialias,antialias);\n#else\nraster=apply_lighting_ground(raster);color=vec4(raster.rgb*antialias,raster.a*antialias);\n#endif\n#else\ncolor=vec4(raster.rgb*antialias,raster.a*antialias);\n#endif\n#else\ncolor=texture(u_image0,v_pos0);\n#ifdef LIGHTING_3D_MODE\n#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS\ncolor=apply_lighting_with_emission_ground(color,color.a);color.a=1.0;\n#else\ncolor=apply_lighting_ground(color);\n#endif\n#endif\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ncolor*=1.0-step(u_far_z_cutoff,1.0/gl_FragCoord.w);glFragColor=color;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\n#include "_prelude_terrain.vertex.glsl"\nuniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;\n#ifdef GLOBE_POLES\nin vec3 a_globe_pos;in vec2 a_uv;\n#else\nin vec2 a_pos;\n#endif\nout vec2 v_pos0;void main() {\n#ifdef GLOBE_POLES\nvec3 globe_pos=a_globe_pos;vec2 uv=a_uv;\n#else\nfloat tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);\n#endif\nv_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;\n#ifdef GLOBE_POLES\nvec3 up_vector=globe_derived_up_vector;\n#else\nvec3 up_vector=elevationVector(tile_pos);\n#endif\nfloat height=elevation(tile_pos);globe_pos+=up_vector*height;\n#ifndef GLOBE_POLES\nglobe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;\n#endif\n#ifdef GLOBE_POLES\nvec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);\n#else\nvec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);\n#endif\ngl_Position=u_proj_matrix*interpolated_pos;\n#ifdef FOG\nv_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);\n#endif\n}'),globeAtmosphere:Ie('#include "_prelude_fog.fragment.glsl"\nuniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec4 u_color;uniform vec4 u_high_color;uniform vec4 u_space_color;uniform float u_horizon_angle;in highp vec3 v_ray_dir;in highp vec3 v_horizon_dir;void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;\n#ifdef PROJECTION_GLOBE_VIEW\nglobe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {\n#ifdef ALPHA_PASS\nglFragColor=vec4(0,0,0,0);return;\n#else\n#ifdef NATIVE\nglFragColor=vec4(1,1,1,1);\n#else\nglFragColor=vec4(0,0,0,1);\n#endif\nreturn;\n#endif\n}\n#endif\nhighp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?\n0.0 : max(acos(clamp(dot(dir,horizon_dir),-1.0,1.0)),0.0);float horizon_angle;\n#ifdef PROJECTION_GLOBE_VIEW\nhighp vec3 closest_point=globe_pos_dot_dir*dir;highp float closest_point_to_center=length(closest_point-u_globe_pos);highp float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?\nPI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);\n#else\nhorizon_angle=horizon_angle_mercator;\n#endif\nhorizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;\n#ifdef ALPHA_PASS\nfloat a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);glFragColor=vec4(1.0,1.0,1.0,a);\n#else\nvec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c=c2;\n#ifndef NATIVE\nc=dither(c,gl_FragCoord.xy+u_temporal_offset);\n#endif\nglFragColor=vec4(c*t,t);\n#endif\n}',"in vec3 a_pos;in vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;out highp vec3 v_ray_dir;out highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(\nmix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}"),model:Ie('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_shadow.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform float u_opacity;uniform vec3 u_lightcolor;uniform vec3 u_lightpos;uniform float u_lightintensity;uniform vec4 u_baseColorFactor;uniform vec4 u_emissiveFactor;uniform float u_metallicFactor;uniform float u_roughnessFactor;uniform float u_emissive_strength;in highp vec4 v_position_height;in lowp vec4 v_color_mix;\n#ifdef RENDER_SHADOWS\nin vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;in float v_depth_shadows;\n#endif\n#ifdef OCCLUSION_TEXTURE_TRANSFORM\nuniform vec4 u_occlusionTextureTransform;\n#endif\n#pragma mapbox: define-attribute highp vec3 normal_3f\n#pragma mapbox: define-attribute highp vec3 color_3f\n#pragma mapbox: define-attribute highp vec4 color_4f\n#pragma mapbox: define-attribute highp vec2 uv_2f\n#pragma mapbox: initialize-attribute highp vec3 normal_3f\n#pragma mapbox: initialize-attribute highp vec3 color_3f\n#pragma mapbox: initialize-attribute highp vec4 color_4f\n#pragma mapbox: initialize-attribute highp vec2 uv_2f\n#ifdef HAS_ATTRIBUTE_a_pbr\nin lowp vec4 v_roughness_metallic_emissive_alpha;in mediump vec4 v_height_based_emission_params;\n#endif\n#ifdef HAS_TEXTURE_u_baseColorTexture\nuniform sampler2D u_baseColorTexture;uniform bool u_baseTextureIsAlpha;uniform bool u_alphaMask;uniform float u_alphaCutoff;\n#endif\n#ifdef HAS_TEXTURE_u_metallicRoughnessTexture\nuniform sampler2D u_metallicRoughnessTexture;\n#endif\n#ifdef HAS_TEXTURE_u_occlusionTexture\nuniform sampler2D u_occlusionTexture;uniform float u_aoIntensity;\n#endif\n#ifdef HAS_TEXTURE_u_normalTexture\nuniform sampler2D u_normalTexture;\n#endif\n#ifdef HAS_TEXTURE_u_emissionTexture\nuniform sampler2D u_emissionTexture;\n#endif\n#ifdef APPLY_LUT_ON_GPU\nuniform highp sampler3D u_lutTexture;\n#endif\n#ifdef TERRAIN_FRAGMENT_OCCLUSION\nin highp float v_depth;uniform sampler2D u_depthTexture;uniform vec2 u_inv_depth_size;bool isOccluded() {vec2 coord=gl_FragCoord.xy*u_inv_depth_size;highp float depth=unpack_depth(texture(u_depthTexture,coord));return v_depth > depth+0.0005;}\n#endif\n#define saturate(_x) clamp(_x,0.,1.)\nvec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}float calculate_NdotL(vec3 normal,vec3 lightDir) {const float ext=0.70710678118;return (clamp(dot(normal,lightDir),-ext,1.0)+ext)/(1.0+ext);}vec3 getDiffuseShadedColor(vec3 albedo,vec3 normal,vec3 lightDir,vec3 lightColor)\n{\n#ifdef LIGHTING_3D_MODE\nvec3 transformed_normal=vec3(-normal.xy,normal.z);float lighting_factor;\n#ifdef RENDER_SHADOWS\nlighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);\n#else\nlighting_factor=saturate(dot(transformed_normal,u_lighting_directional_dir));\n#endif\nreturn apply_lighting(albedo,transformed_normal,lighting_factor);\n#else\nvec3 n=normal;float colorvalue=((albedo.x*0.2126)+(albedo.y*0.7152))+(albedo.z*0.0722);vec3 c=vec3(0.03,0.03,0.03);float directional=clamp(dot(n,vec3(lightDir)),0.0,1.0);directional=mix(1.0-u_lightintensity,max((1.0-colorvalue)+u_lightintensity,1.0),directional);vec3 c3=c+clamp((albedo*directional)*lightColor,mix(vec3(0.0),vec3(0.3),vec3(1.0)-lightColor),vec3(1.0));return c3;\n#endif\n}vec4 getBaseColor() {vec4 albedo=u_baseColorFactor;\n#ifdef HAS_ATTRIBUTE_a_color_3f\nalbedo*=vec4(color_3f,1.0);\n#endif\n#ifdef HAS_ATTRIBUTE_a_pbr\n#else\n#ifdef HAS_ATTRIBUTE_a_color_4f\nalbedo*=color_4f;\n#endif\n#endif\n#if defined (HAS_TEXTURE_u_baseColorTexture) && defined (HAS_ATTRIBUTE_a_uv_2f)\nvec4 texColor=texture(u_baseColorTexture,uv_2f);if(u_alphaMask) {if (texColor.w < u_alphaCutoff) {discard;}}\n#ifdef UNPREMULT_TEXTURE_IN_SHADER\nif(texColor.w > 0.0) {texColor.rgb/=texColor.w;}texColor.w=1.0;\n#endif\nif(u_baseTextureIsAlpha) {if (texColor.r < 0.5) {discard;}} else {texColor.rgb=sRGBToLinear(texColor.rgb);albedo*=texColor;}\n#endif\nvec4 color=vec4(mix(albedo.rgb,v_color_mix.rgb,v_color_mix.a),albedo.a);\n#ifdef APPLY_LUT_ON_GPU\ncolor=applyLUT(u_lutTexture,color);\n#endif\nreturn color;}highp mat3 cotangentFrame(highp vec3 N,highp vec3 p,highp vec2 uv ) {\n#ifdef HAS_TEXTURE_u_normalTexture\nhighp vec3 dp1=vec3(dFdx(p.x),dFdx(p.y),dFdx(p.z));highp vec3 dp2=vec3(dFdy(p.x),dFdy(p.y),dFdy(p.z));highp vec2 duv1=vec2(dFdx(uv.x),dFdx(uv.y));highp vec2 duv2=vec2(dFdy(uv.x),dFdy(uv.y));highp vec3 dp2perp=cross( dp2,N );highp vec3 dp1perp=cross( N,dp1 );highp vec3 T=dp2perp*duv1.x+dp1perp*duv2.x;highp vec3 B=dp2perp*duv1.y+dp1perp*duv2.y;highp float lengthT=dot(T,T);highp float lengthB=dot(B,B);highp float maxLength=max(lengthT,lengthB);highp float invmax=inversesqrt( maxLength );highp mat3 res=mat3( T*invmax,B*invmax,N );return res;\n#else\nreturn mat3(1.0);\n#endif\n}highp vec3 getNormal(){highp vec3 n;\n#ifdef HAS_ATTRIBUTE_a_normal_3f\nn=normalize(normal_3f);\n#else\nhighp vec3 fdx=vec3(dFdx(v_position_height.x),dFdx(v_position_height.y),dFdx(v_position_height.z));highp vec3 fdy=vec3(dFdy(v_position_height.x),dFdy(v_position_height.y),dFdy(v_position_height.z));n=normalize(cross(fdx,fdy))*-1.0;\n#endif\n#if defined(HAS_TEXTURE_u_normalTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)\nvec3 nMap=texture( u_normalTexture,uv_2f).xyz;nMap=normalize(2.0*nMap-vec3(1.0));highp vec3 v=normalize(-v_position_height.xyz);highp mat3 TBN=cotangentFrame(n,v,uv_2f);n=normalize(TBN*nMap);\n#endif\nreturn n;}struct Material {float perceptualRoughness;float alphaRoughness;float metallic;vec3 f90;vec4 baseColor;vec3 diffuseColor;vec3 specularColor;highp vec3 normal;};Material getPBRMaterial() {Material mat;mat.baseColor=getBaseColor();mat.perceptualRoughness=u_roughnessFactor;mat.metallic=u_metallicFactor;\n#ifdef HAS_ATTRIBUTE_a_pbr\nmat.perceptualRoughness=v_roughness_metallic_emissive_alpha.x;mat.metallic=v_roughness_metallic_emissive_alpha.y;mat.baseColor.w*=v_roughness_metallic_emissive_alpha.w;\n#endif\n#if defined(HAS_TEXTURE_u_metallicRoughnessTexture) && defined(HAS_ATTRIBUTE_a_uv_2f) \nvec4 mrSample=texture(u_metallicRoughnessTexture,uv_2f);mat.perceptualRoughness*=mrSample.g;mat.metallic*=mrSample.b;\n#endif\nconst float c_minRoughness=0.04;mat.perceptualRoughness=clamp(mat.perceptualRoughness,c_minRoughness,1.0);mat.metallic=saturate(mat.metallic);mat.alphaRoughness=mat.perceptualRoughness*mat.perceptualRoughness;const vec3 f0=vec3(0.04);mat.diffuseColor=mat.baseColor.rgb*(vec3(1.0)-f0);mat.diffuseColor*=1.0-mat.metallic;mat.specularColor=mix(f0,mat.baseColor.rgb,mat.metallic);highp float reflectance=max(max(mat.specularColor.r,mat.specularColor.g),mat.specularColor.b);highp float reflectance90=saturate(reflectance*25.0);mat.f90=vec3(reflectance90);mat.normal=getNormal();return mat;}float V_GGX(float NdotL,float NdotV,float roughness)\n{float a2=roughness*roughness;float GGXV=NdotL*sqrt(NdotV*NdotV*(1.0-a2)+a2);float GGXL=NdotV*sqrt(NdotL*NdotL*(1.0-a2)+a2);return 0.5/(GGXV+GGXL);}float V_GGXFast(float NdotL,float NdotV,float roughness) {float a=roughness;float GGXV=NdotL*(NdotV*(1.0-a)+a);float GGXL=NdotV*(NdotL*(1.0-a)+a);return 0.5/(GGXV+GGXL);}vec3 F_Schlick(vec3 specularColor,vec3 f90,float VdotH)\n{return specularColor+(f90-specularColor)*pow(clamp(1.0-VdotH,0.0,1.0),5.0);}vec3 F_SchlickFast(vec3 specularColor,float VdotH)\n{float x=1.0-VdotH;float x4=x*x*x*x;return specularColor+(1.0-specularColor)*x4*x;}float D_GGX(highp float NdotH,float alphaRoughness)\n{highp float a4=alphaRoughness*alphaRoughness;highp float f=(NdotH*a4-NdotH)*NdotH+1.0;return a4/(PI*f*f);}vec3 diffuseBurley(Material mat,float LdotH,float NdotL,float NdotV)\n{float f90=2.0*LdotH*LdotH*mat.alphaRoughness-0.5;return (mat.diffuseColor/PI)*(1.0+f90*pow((1.0-NdotL),5.0))*(1.0+f90*pow((1.0-NdotV),5.0));}vec3 diffuseLambertian(Material mat)\n{\n#ifdef LIGHTING_3D_MODE\nreturn mat.diffuseColor;\n#else\nreturn mat.diffuseColor/PI;\n#endif\n}vec3 EnvBRDFApprox(vec3 specularColor,float roughness,highp float NdotV)\n{vec4 c0=vec4(-1,-0.0275,-0.572,0.022);vec4 c1=vec4(1,0.0425,1.04,-0.04);highp vec4 r=roughness*c0+c1;highp float a004=min(r.x*r.x,exp2(-9.28*NdotV))*r.x+r.y;vec2 AB=vec2(-1.04,1.04)*a004+r.zw;return specularColor*AB.x+AB.y;}vec3 computeIndirectLightContribution(Material mat,float NdotV,vec3 normal)\n{vec3 env_light=vec3(0.65,0.65,0.65);\n#ifdef LIGHTING_3D_MODE\nfloat ambient_factor=calculate_ambient_directional_factor(normal);env_light=u_lighting_ambient_color*ambient_factor;\n#endif\nvec3 envBRDF=EnvBRDFApprox(mat.specularColor,mat.perceptualRoughness,NdotV);vec3 indirectSpecular= envBRDF*env_light;vec3 indirectDiffuse=mat.diffuseColor*env_light;return indirectSpecular+indirectDiffuse;}vec3 computeLightContribution(Material mat,vec3 lightPosition,vec3 lightColor)\n{highp vec3 n=mat.normal;highp vec3 v=normalize(-v_position_height.xyz);highp vec3 l=normalize(lightPosition);highp vec3 h=normalize(v+l);float NdotV=clamp(abs(dot(n,v)),0.001,1.0);float NdotL=saturate(dot(n,l));highp float NdotH=saturate(dot(n,h));float VdotH=saturate(dot(v,h));vec3 f=F_SchlickFast(mat.specularColor,VdotH);float g=V_GGXFast(NdotL,NdotV,mat.alphaRoughness);float d=D_GGX(NdotH,mat.alphaRoughness);vec3 diffuseTerm=(1.0-f)*diffuseLambertian(mat);vec3 specularTerm=f*g*d;vec3 transformed_normal=vec3(-n.xy,n.z);float lighting_factor;\n#ifdef RENDER_SHADOWS\nlighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);\n#else\nlighting_factor=NdotL;\n#endif\nvec3 directLightColor=(specularTerm+diffuseTerm)*lighting_factor*lightColor;vec3 indirectLightColor=computeIndirectLightContribution(mat,NdotV,transformed_normal);vec3 color=(saturate(directLightColor)+indirectLightColor);float intensityFactor=1.0;\n#if !defined(LIGHTING_3D_MODE)\nconst vec3 luminosityFactor=vec3(0.2126,0.7152,0.0722);float luminance=dot(diffuseTerm,luminosityFactor);intensityFactor=mix((1.0-u_lightintensity),max((1.0-luminance+u_lightintensity),1.0),NdotL);\n#endif\ncolor*=intensityFactor;return color;}void main() {\n#ifdef TERRAIN_FRAGMENT_OCCLUSION\nif (isOccluded()) {discard;}\n#endif\nvec3 lightDir=u_lightpos;vec3 lightColor=u_lightcolor;\n#ifdef LIGHTING_3D_MODE\nlightDir=u_lighting_directional_dir;lightDir.xy=-lightDir.xy;lightColor=u_lighting_directional_color;\n#endif\nvec4 finalColor;\n#ifdef DIFFUSE_SHADED\nvec3 N=getNormal();vec3 baseColor=getBaseColor().rgb;vec3 diffuse=getDiffuseShadedColor(baseColor,N,lightDir,lightColor);\n#ifdef HAS_TEXTURE_u_occlusionTexture\nfloat ao=(texture(u_occlusionTexture,uv_2f).r-1.0)*u_aoIntensity+1.0;diffuse*=ao;\n#endif\nfinalColor=vec4(mix(diffuse,baseColor,u_emissive_strength),1.0)*u_opacity;\n#else\nMaterial mat=getPBRMaterial();vec3 color=computeLightContribution(mat,lightDir,lightColor);float ao=1.0;\n#if defined (HAS_TEXTURE_u_occlusionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)\n#ifdef OCCLUSION_TEXTURE_TRANSFORM\nvec2 uv=uv_2f.xy*u_occlusionTextureTransform.zw+u_occlusionTextureTransform.xy;\n#else\nvec2 uv=uv_2f;\n#endif\nao=(texture(u_occlusionTexture,uv).x-1.0)*u_aoIntensity+1.0;color*=ao;\n#endif\nvec4 emissive=u_emissiveFactor;\n#if defined(HAS_TEXTURE_u_emissionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)\nemissive.rgb*=sRGBToLinear(texture(u_emissionTexture,uv_2f).rgb);\n#endif\ncolor+=emissive.rgb;float opacity=mat.baseColor.w*u_opacity;\n#ifdef HAS_ATTRIBUTE_a_pbr\nfloat resEmission=v_roughness_metallic_emissive_alpha.z;resEmission*=v_height_based_emission_params.z+v_height_based_emission_params.w*pow(clamp(v_height_based_emission_params.x,0.0,1.0),v_height_based_emission_params.y);vec3 color_mix=v_color_mix.rgb;\n#ifdef APPLY_LUT_ON_GPU\ncolor_mix=applyLUT(u_lutTexture,color_mix);\n#endif\ncolor=mix(color,color_mix,min(1.0,resEmission));\n#ifdef HAS_ATTRIBUTE_a_color_4f\nfloat distance=length(vec2(1.3*max(0.0,abs(color_4f.x)-color_4f.z),color_4f.y));distance+= mix(0.5,0.0,clamp(resEmission-1.0,0.0,1.0));opacity*=v_roughness_metallic_emissive_alpha.w*saturate(1.0-distance*distance);\n#endif\n#else\n#ifdef APPLY_LUT_ON_GPU\ncolor=applyLUT(u_lutTexture,color);\n#endif\n#endif\nvec3 unlitColor=mat.baseColor.rgb*ao+emissive.rgb;color=mix(color,unlitColor,u_emissive_strength);color=linearTosRGB(color);color*=opacity;finalColor=vec4(color,opacity);\n#endif\n#ifdef FOG\nfinalColor=fog_dither(fog_apply_premultiplied(finalColor,v_fog_pos,v_position_height.w));\n#endif\n#ifdef RENDER_CUTOFF\nfinalColor*=v_cutoff_opacity;\n#endif\n#ifdef INDICATOR_CUTOUT\nfinalColor=applyCutout(finalColor);\n#endif\nglFragColor=finalColor;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\n#include "_prelude_shadow.vertex.glsl"\nin vec3 a_pos_3f;\n#pragma mapbox: define-attribute highp vec3 normal_3f\n#pragma mapbox: define-attribute highp vec2 uv_2f\n#pragma mapbox: define-attribute highp vec3 color_3f\n#pragma mapbox: define-attribute highp vec4 color_4f\n#pragma mapbox: define-attribute-vertex-shader-only highp vec4 pbr\n#pragma mapbox: define-attribute-vertex-shader-only highp vec3 heightBasedEmissiveStrength\nuniform mat4 u_matrix;uniform mat4 u_node_matrix;uniform mat4 u_lighting_matrix;uniform vec3 u_camera_pos;uniform vec4 u_color_mix;\n#ifdef INSTANCED_ARRAYS\nin vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;\n#else\nuniform highp mat4 u_normal_matrix;\n#endif\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;out float v_depth_shadows;\n#endif\nout vec4 v_position_height;out lowp vec4 v_color_mix;\n#ifdef TERRAIN_FRAGMENT_OCCLUSION\nout highp float v_depth;\n#endif\n#ifdef HAS_ATTRIBUTE_a_pbr\nout lowp vec4 v_roughness_metallic_emissive_alpha;out mediump vec4 v_height_based_emission_params;\n#endif\nvec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}void main() {\n#pragma mapbox: initialize-attribute highp vec3 normal_3f\n#pragma mapbox: initialize-attribute highp vec2 uv_2f\n#pragma mapbox: initialize-attribute highp vec3 color_3f\n#pragma mapbox: initialize-attribute highp vec4 color_4f\n#pragma mapbox: initialize-attribute-custom highp vec4 pbr\n#pragma mapbox: initialize-attribute-custom highp vec3 heightBasedEmissiveStrength\nhighp mat4 normal_matrix;\n#ifdef INSTANCED_ARRAYS\nnormal_matrix=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);\n#else\nnormal_matrix=u_normal_matrix;\n#endif\nvec3 local_pos;mat3 rs;\n#ifdef MODEL_POSITION_ON_GPU\nvec3 pos_color=normal_matrix[0].xyz;vec4 translate=normal_matrix[1];vec3 pos_a=floor(pos_color);vec3 rgb=1.05*(pos_color-pos_a);float hidden=float(pos_a.x > EXTENT);float color_mix=pos_a.z/100.0;v_color_mix=vec4(sRGBToLinear(rgb),color_mix);float meter_to_tile=normal_matrix[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);rs[0].x=normal_matrix[1].w;rs[0].yz=normal_matrix[2].xy;rs[1].xy=normal_matrix[2].zw;rs[1].z=normal_matrix[3].x;rs[2].xyz=normal_matrix[3].yzw;vec4 pos_node=u_lighting_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;local_pos=pos.xyz;gl_Position=mix(u_matrix*pos,AWAY,hidden);pos.z*=meter_to_tile;v_position_height.xyz=pos.xyz-u_camera_pos;\n#else\nlocal_pos=a_pos_3f;gl_Position=u_matrix*vec4(a_pos_3f,1);v_position_height.xyz=vec3(u_lighting_matrix*vec4(a_pos_3f,1));v_color_mix=vec4(sRGBToLinear(u_color_mix.rgb),u_color_mix.a);\n#endif\nv_position_height.w=a_pos_3f.z;\n#ifdef HAS_ATTRIBUTE_a_pbr\nvec4 albedo_c=decode_color(pbr.xy);vec2 e_r_m=unpack_float(pbr.z);vec2 r_m= unpack_float(e_r_m.y*16.0);r_m.r=r_m.r*16.0;v_color_mix=vec4(albedo_c.rgb,1.0);v_roughness_metallic_emissive_alpha=vec4(vec3(r_m,e_r_m.x)/255.0,albedo_c.a);v_roughness_metallic_emissive_alpha.z*=2.0;float heightBasedRelativeIntepolation=a_pos_3f.z*heightBasedEmissiveStrength.x+heightBasedEmissiveStrength.y;v_height_based_emission_params.x=heightBasedRelativeIntepolation;v_height_based_emission_params.y=heightBasedEmissiveStrength.z;vec2 emissionMultiplierValues=unpack_float(pbr.w)/256.0;v_height_based_emission_params.z=emissionMultiplierValues.x;v_height_based_emission_params.w=emissionMultiplierValues.y-emissionMultiplierValues.x;\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(local_pos);\n#endif\n#ifdef RENDER_CUTOFF\nv_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);\n#endif\n#ifdef TERRAIN_FRAGMENT_OCCLUSION\nv_depth=gl_Position.z/gl_Position.w;\n#endif\n#ifdef HAS_ATTRIBUTE_a_normal_3f\n#ifdef MODEL_POSITION_ON_GPU\nfloat x_squared_scale=dot(rs[0],rs[0]);float y_squared_scale=dot(rs[1],rs[1]);float z_squared_scale=dot(rs[2],rs[2]);vec3 squared_scale=vec3(x_squared_scale,y_squared_scale,z_squared_scale);normal_3f=rs*((u_lighting_matrix*vec4(normal_3f,0.0)).xyz/squared_scale);normal_3f=normalize(normal_3f);\n#else\nnormal_3f=vec3(normal_matrix*vec4(normal_3f,0));\n#endif\n#endif\n#ifdef HAS_ATTRIBUTE_a_pbr\n#ifdef HAS_ATTRIBUTE_a_color_4f\nv_roughness_metallic_emissive_alpha.w=clamp(color_4f.a*v_roughness_metallic_emissive_alpha.w*(v_roughness_metallic_emissive_alpha.z-1.0),0.0,1.0);\n#endif\n#endif\n#ifdef RENDER_SHADOWS\nvec4 shadow_pos=u_node_matrix*vec4(local_pos,1.0);\n#ifdef NORMAL_OFFSET\n#ifdef HAS_ATTRIBUTE_a_normal_3f\n#ifdef MODEL_POSITION_ON_GPU\nvec3 offset=shadow_normal_offset(vec3(-normal_3f.xy,normal_3f.z));shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();\n#else\nvec3 offset=shadow_normal_offset_model(normalize(normal_3f));shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();\n#endif\n#endif\n#endif\nv_pos_light_view_0=u_light_matrix_0*shadow_pos;v_pos_light_view_1=u_light_matrix_1*shadow_pos;v_depth_shadows=gl_Position.w;\n#endif\n}'),modelDepth:Ie("in highp float v_depth;void main() {\n#ifndef DEPTH_TEXTURE\nglFragColor=pack_depth(v_depth);\n#endif\n}","in vec3 a_pos_3f;uniform mat4 u_matrix;out highp float v_depth;\n#ifdef MODEL_POSITION_ON_GPU\n#ifdef INSTANCED_ARRAYS\nin vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;\n#else\nuniform highp mat4 u_instance;\n#endif\nuniform highp mat4 u_node_matrix;\n#endif\nvoid main() {\n#ifdef MODEL_POSITION_ON_GPU\nhighp mat4 instance;\n#ifdef INSTANCED_ARRAYS\ninstance=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);\n#else\ninstance=u_instance;\n#endif\nvec3 pos_color=instance[0].xyz;vec4 translate=instance[1];vec3 pos_a=floor(pos_color);float hidden=float(pos_a.x > EXTENT);float meter_to_tile=instance[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);mat3 rs;rs[0].x=instance[1].w;rs[0].yz=instance[2].xy;rs[1].xy=instance[2].zw;rs[1].z=instance[3].x;rs[2].xyz=instance[3].yzw;vec4 pos_node=u_node_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;gl_Position=mix(u_matrix*pos,AWAY,hidden);\n#else\ngl_Position=u_matrix*vec4(a_pos_3f,1);\n#endif\nv_depth=gl_Position.z/gl_Position.w;}"),stars:Ie("in highp vec2 v_uv;in mediump float v_intensity;float shapeCircle(in vec2 uv)\n{float beginFade=0.6;float lengthFromCenter=length(v_uv);return 1.0-clamp((lengthFromCenter-beginFade)/(1.0-beginFade),0.0,1.0);}void main() {float alpha=shapeCircle(v_uv);vec3 color=vec3(1.0,1.0,1.0);alpha*=v_intensity;glFragColor=vec4(color*alpha,alpha);HANDLE_WIREFRAME_DEBUG;}","\nin vec3 a_pos_3f;in vec2 a_uv;in float a_size_scale;in float a_fade_opacity;uniform mat4 u_matrix;uniform vec3 u_up;uniform vec3 u_right;uniform float u_intensity_multiplier;out highp vec2 v_uv;out mediump float v_intensity;void main() {v_uv=a_uv;v_intensity=a_fade_opacity*u_intensity_multiplier;vec3 pos=a_pos_3f;pos+=a_uv.x*u_right*a_size_scale;pos+=a_uv.y*u_up*a_size_scale;gl_Position=u_matrix*vec4(pos,1.0);}"),occlusion:Ie("uniform vec4 u_color;void main() {glFragColor=u_color;}",'#include "_prelude_terrain.vertex.glsl"\nin highp vec2 a_offset_xy;uniform highp vec3 u_anchorPos;uniform mat4 u_matrix;uniform vec2 u_screenSizePx;uniform vec2 u_occluderSizePx;void main() {vec3 world_pos=u_anchorPos;\n#ifdef TERRAIN\nfloat e=elevation(world_pos.xy);world_pos.z+=e;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1.0);projected_point.xy+=projected_point.w*a_offset_xy*0.5*u_occluderSizePx/u_screenSizePx;gl_Position=projected_point;}')};function ke(t,e){const n=t.replace(/\s*\/\/[^\n]*\n/g,"\n").split("\n");for(let t of n)if(t=t.trim(),"#"===t[0]&&t.includes("if")&&!t.includes("endif")){t=t.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const n=t.split(" ");for(const t of n)e.includes(t)||e.push(t)}}function Ie(t,e){const n=/#include\s+"([^"]+)"/g,i=/#pragma mapbox: ([\w\-]+) ([\w]+) ([\w]+) ([\w]+)/g;let a=e.match(/(attribute(\S*)|(^\s*|;)in) (highp |mediump |lowp )?([\w]+) ([\w]+)/gm);a&&(a=a.map((t=>{const e=t.split(" ");return e[e.length-1]})),a=[...new Set(a)]);const r={},o=[],s=[];if(t=t.replace(n,((t,e)=>(s.push(e),""))),(e=e.replace(n,((t,e)=>(o.push(e),"")))).includes("flat out"))return void console.error('The usage of "flat" qualifier is disallowed, see: https://bugs.webkit.org/show_bug.cgi?id=268071');let l=[...Ae];ke(t,l),ke(e,l);for(const t of[...o,...s])Ce[t]||console.error(`Undefined include: ${t}`),Ee[t]||(Ee[t]=[],ke(Ce[t],Ee[t])),l=[...l,...Ee[t]];return{fragmentSource:t=t.replace(i,((t,e,n,i,a)=>(r[a]=!0,"define"===e?`\n#ifndef HAS_UNIFORM_u_${a}\nin ${n} ${i} ${a};\n#else\nuniform ${n} ${i} u_${a};\n#endif\n`:"initialize"===e?`\n#ifdef HAS_UNIFORM_u_${a}\n    ${n} ${i} ${a} = u_${a};\n#endif\n`:"define-attribute"===e?`\n#ifdef HAS_ATTRIBUTE_a_${a}\n    in ${n} ${i} ${a};\n#endif\n`:"initialize-attribute"===e?"":void 0))),vertexSource:e=e.replace(i,((t,e,n,i,a)=>{const o="float"===i?"vec2":i,s=a.match(/color/)?"color":o;return"define-attribute-vertex-shader-only"===e?`\n#ifdef HAS_ATTRIBUTE_a_${a}\nin ${n} ${i} a_${a};\n#endif\n`:r[a]?"define"===e?`\n#ifndef HAS_UNIFORM_u_${a}\nuniform lowp float u_${a}_t;\nin ${n} ${o} a_${a};\nout ${n} ${i} ${a};\n#else\nuniform ${n} ${i} u_${a};\n#endif\n`:"initialize"===e?"vec4"===s?`\n#ifndef HAS_UNIFORM_u_${a}\n    ${a} = a_${a};\n#else\n    ${n} ${i} ${a} = u_${a};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${a}\n    ${a} = unpack_mix_${s}(a_${a}, u_${a}_t);\n#else\n    ${n} ${i} ${a} = u_${a};\n#endif\n`:"define-attribute"===e?`\n#ifdef HAS_ATTRIBUTE_a_${a}\n    in ${n} ${i} a_${a};\n    out ${n} ${i} ${a};\n#endif\n`:"initialize-attribute"===e?`\n#ifdef HAS_ATTRIBUTE_a_${a}\n    ${a} = a_${a};\n#endif\n`:void 0:"define"===e?`\n#ifndef HAS_UNIFORM_u_${a}\nuniform lowp float u_${a}_t;\nin ${n} ${o} a_${a};\n#else\nuniform ${n} ${i} u_${a};\n#endif\n`:"define-instanced"===e?"mat4"===s?`\n#ifdef INSTANCED_ARRAYS\nin vec4 a_${a}0;\nin vec4 a_${a}1;\nin vec4 a_${a}2;\nin vec4 a_${a}3;\n#else\nuniform ${n} ${i} u_${a};\n#endif\n`:`\n#ifdef INSTANCED_ARRAYS\nin ${n} ${o} a_${a};\n#else\nuniform ${n} ${i} u_${a};\n#endif\n`:"initialize-attribute-custom"===e?`\n#ifdef HAS_ATTRIBUTE_a_${a}\n    ${n} ${i} ${a} = a_${a};\n#endif\n`:"vec4"===s?`\n#ifndef HAS_UNIFORM_u_${a}\n    ${n} ${i} ${a} = a_${a};\n#else\n    ${n} ${i} ${a} = u_${a};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${a}\n    ${n} ${i} ${a} = unpack_mix_${s}(a_${a}, u_${a}_t);\n#else\n    ${n} ${i} ${a} = u_${a};\n#endif\n`})),staticAttributes:a,usedDefines:l,vertexIncludes:o,fragmentIncludes:s}}class Pe{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(t,e,n,i,a,r,o,s){this.context=t;let l=this.boundPaintVertexBuffers.length!==i.length;for(let t=0;!l&&t<i.length;t++)this.boundPaintVertexBuffers[t]!==i[t]&&(l=!0);let c=this.boundDynamicVertexBuffers.length!==o.length;for(let t=0;!c&&t<o.length;t++)this.boundDynamicVertexBuffers[t]!==o[t]&&(c=!0);if(!this.vao||this.boundProgram!==e||this.boundLayoutVertexBuffer!==n||l||c||this.boundIndexBuffer!==a||this.boundVertexOffset!==r)this.freshBind(e,n,i,a,r,o,s);else{t.bindVertexArrayOES.set(this.vao);for(const n of o)n&&(n.bind(),s&&n.instanceCount&&n.setVertexAttribDivisor(t.gl,e,s));a&&a.dynamicDraw&&a.bind()}}freshBind(t,e,n,i,a,r,o){const s=t.numAttributes,l=this.context,c=l.gl;this.vao&&this.destroy(),this.vao=l.gl.createVertexArray(),l.bindVertexArrayOES.set(this.vao),this.boundProgram=t,this.boundLayoutVertexBuffer=e,this.boundPaintVertexBuffers=n,this.boundIndexBuffer=i,this.boundVertexOffset=a,this.boundDynamicVertexBuffers=r,e.enableAttributes(c,t),e.bind(),e.setVertexAttribPointers(c,t,a);for(const e of n)e.enableAttributes(c,t),e.bind(),e.setVertexAttribPointers(c,t,a);for(const e of r)e&&(e.enableAttributes(c,t),e.bind(),e.setVertexAttribPointers(c,t,a),o&&e.instanceCount&&e.setVertexAttribDivisor(c,t,o));i&&i.bind(),l.currentNumAttributes=s}destroy(){this.vao&&(this.context.gl.deleteVertexArray(this.vao),this.vao=null)}}function ze(e,n){const i=Math.pow(2,n.canonical.z),a=n.canonical.y;return[new t.Y(0,a/i).toLngLat().lat,new t.Y(0,(a+1)/i).toLngLat().lat]}function De(e,n,i,a,r,o,s){const l=e.context,c=l.gl,u=i.hillshadeFBO;if(!u)return;e.prepareDrawTile();const h=e.isTileAffectedByFog(n),d=e.getOrCreateProgram("hillshade",{overrideFog:h});l.activeTexture.set(c.TEXTURE0),c.bindTexture(c.TEXTURE_2D,u.colorAttachment.get());const p=((e,n,i,a)=>{const r=i.paint.get("hillshade-shadow-color"),o=i.paint.get("hillshade-highlight-color"),s=i.paint.get("hillshade-accent-color"),l=i.paint.get("hillshade-emissive-strength");let c=t.ab(i.paint.get("hillshade-illumination-direction"));if("viewport"===i.paint.get("hillshade-illumination-anchor"))c-=e.transform.angle;else if(e.style&&e.style.enable3dLights()&&e.style.directionalLight){const n=e.style.directionalLight.properties.get("direction"),i=t.ac(n.x,n.y,n.z);c=t.ab(i[1])}const u=!e.options.moving;return{u_matrix:a||e.transform.calculateProjMatrix(n.tileID.toUnwrapped(),u),u_image:0,u_latrange:ze(0,n.tileID),u_light:[i.paint.get("hillshade-exaggeration"),c],u_shadow:r.toRenderColor(i.lut),u_highlight:o.toRenderColor(i.lut),u_emissive_strength:l,u_accent:s.toRenderColor(i.lut)}})(e,i,a,e.terrain?n.projMatrix:null);e.uploadCommonUniforms(l,d,n.toUnwrapped());const{tileBoundsBuffer:f,tileBoundsIndexBuffer:m,tileBoundsSegments:g}=e.getTileBoundsBuffers(i);d.draw(e,c.TRIANGLES,r,o,s,t.af.disabled,p,a.id,f,m,g)}function Le(e,n,i){if(!n.needsDEMTextureUpload)return;const a=e.context,r=a.gl;a.pixelStoreUnpackPremultiplyAlpha.set(!1),n.demTexture=n.demTexture||e.getTileTexture(i.stride);const o=i.getPixels();n.demTexture?n.demTexture.update(o,{premultiply:!1}):n.demTexture=new t.T(a,o,r.R32F,{premultiply:!1}),n.needsDEMTextureUpload=!1}function Be(e,n,i){const a=e.context,r=a.gl;if(!n.dem)return;const o=n.dem;if(a.activeTexture.set(r.TEXTURE1),Le(e,n,o),!n.demTexture)return;n.demTexture.bind(r.NEAREST,r.CLAMP_TO_EDGE);const s=o.dim;a.activeTexture.set(r.TEXTURE0);let l=n.hillshadeFBO;if(!l){const e=new t.T(a,{width:s,height:s,data:null},r.RGBA);e.bind(r.LINEAR,r.CLAMP_TO_EDGE),l=n.hillshadeFBO=a.createFramebuffer(s,s,!0,"renderbuffer"),l.colorAttachment.set(e.texture)}a.bindFramebuffer.set(l.framebuffer),a.viewport.set([0,0,s,s]);const{tileBoundsBuffer:c,tileBoundsIndexBuffer:u,tileBoundsSegments:h}=e.getMercatorTileBoundsBuffers(),d=[];e.linearFloatFilteringSupported()&&d.push("TERRAIN_DEM_FLOAT_FORMAT"),e.getOrCreateProgram("hillshadePrepare",{defines:d}).draw(e,r.TRIANGLES,t.ae.disabled,t.ag.disabled,t.a.unblended,t.af.disabled,((e,n)=>{const i=n.stride,a=t.ad.create();return t.ad.ortho(a,0,t.a3,-t.a3,0,0,1),t.ad.translate(a,a,[0,-t.a3,0]),{u_matrix:a,u_image:1,u_dimension:[i,i],u_zoom:e.overscaledZ}})(n.tileID,o),i.id,c,u,h),n.needsHillshadePrepare=!1}function Oe(e,n,i,a,r){const o=function(i,a){if(i)return r(i);if(a){if(e.url&&a.tiles&&e.tiles&&delete e.tiles,a.variants){if(!Array.isArray(a.variants))return r(new Error("variants must be an array"));for(const e of a.variants){if(null==e||"object"!=typeof e||e.constructor!==Object)return r(new Error("variant must be an object"));if(!Array.isArray(e.capabilities))return r(new Error("capabilities must be an array"));if(1===e.capabilities.length&&"meshopt"===e.capabilities[0]){a=t.W(a,e);break}}}const i=t.ah(t.W(a,e),["tilejson","tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);a.vector_layers&&(i.vectorLayers=a.vector_layers,i.vectorLayerIds=i.vectorLayers.map((t=>t.id))),a.raster_layers&&(i.rasterLayers=a.raster_layers,i.rasterLayerIds=i.rasterLayers.map((t=>t.id))),i.tiles=n.canonicalizeTileset(i,e.url),r(null,i)}};return e.url?t.g(n.transformRequest(n.normalizeSourceURL(e.url,null,i,a),t.R.Source),o):t.e.frame((()=>o(null,e)))}class Re{constructor(e,n,i){this.bounds=t.ai.convert(this.validateBounds(e)),this.minzoom=n||0,this.maxzoom=i||24}validateBounds(t){return Array.isArray(t)&&4===t.length?[Math.max(-180,t[0]),Math.max(-90,t[1]),Math.min(180,t[2]),Math.min(90,t[3])]:[-180,-90,180,90]}contains(e){const n=Math.pow(2,e.z),i=Math.floor(t.aj(this.bounds.getWest())*n),a=Math.floor(t.ak(this.bounds.getNorth())*n),r=Math.ceil(t.aj(this.bounds.getEast())*n),o=Math.ceil(t.ak(this.bounds.getSouth())*n);return e.x>=i&&e.x<r&&e.y>=a&&e.y<o}}class Fe extends t.E{constructor(e,n,i,a){super(),this.id=e,this.dispatcher=i,this.setEventedParent(a),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=t.W({type:"raster"},n),t.W(this,t.ah(n,["url","scheme","tileSize"]))}load(e){this._loaded=!1,this.fire(new t.f("dataloading",{dataType:"source"})),this._tileJSONRequest=Oe(this._options,this.map._requestManager,null,null,((n,i)=>{this._tileJSONRequest=null,this._loaded=!0,n?this.fire(new t.d(n)):i&&(t.W(this,i),i.bounds&&(this.tileBounds=new Re(i.bounds,this.minzoom,this.maxzoom)),t.an(i.tiles),this.fire(new t.f("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new t.f("data",{dataType:"source",sourceDataType:"content"}))),e&&e(n)}))}loaded(){return this._loaded}onAdd(t){this.map=t,this.load()}reload(){this.cancelTileJSONRequest();const e=t.al(this.id,this.scope);this.load((()=>this.map.style.clearSource(e)))}setTiles(t){return this._options.tiles=t,this.reload(),this}setUrl(t){return this.url=t,this._options.url=t,this.reload(),this}onRemove(t){this.cancelTileJSONRequest()}serialize(){return t.W({},this._options)}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}loadTile(e,n){const i=t.e.devicePixelRatio>=2,a=this.map._requestManager.normalizeTileURL(e.tileID.canonical.url(this.tiles,this.scheme),i,this.tileSize);e.request=t.h(this.map._requestManager.transformRequest(a,t.R.Tile),((i,a,r,o)=>(delete e.request,e.aborted?(e.state="unloaded",n(null)):i?(e.state="errored",n(i)):a?(this.map._refreshExpiredTiles&&e.setExpiryData({cacheControl:r,expires:o}),e.setTexture(a,this.map.painter),e.state="loaded",t.am(this.dispatcher),void n(null)):n(null))))}abortTile(t,e){t.request&&(t.request.cancel(),delete t.request),e&&e()}unloadTile(e,n){e.texture&&e.texture instanceof t.T?(e.destroy(!0),e.texture&&e.texture instanceof t.T&&this.map.painter.saveTileTexture(e.texture)):e.destroy(),n&&n()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class Ne extends t.E{constructor(e,n,i,a){if(super(),this.id=e,this.dispatcher=i,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,t.W(this,t.ah(n,["url","scheme","tileSize","promoteId"])),this._options=t.W({type:"vector"},n),this._collectResourceTiming=!!n.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(a),this._tileWorkers={},this._deduped=new t.ao}load(e){this._loaded=!1,this.fire(new t.f("dataloading",{dataType:"source"}));const n=Array.isArray(this.map._language)?this.map._language.join():this.map._language,i=this.map._worldview;this._tileJSONRequest=Oe(this._options,this.map._requestManager,n,i,((a,r)=>{this._tileJSONRequest=null,this._loaded=!0,a?(n&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${n}`),i&&2!==i.length&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${i}`),this.fire(new t.d(a))):r&&(t.W(this,r),r.bounds&&(this.tileBounds=new Re(r.bounds,this.minzoom,this.maxzoom)),t.an(r.tiles,this.map._requestManager._customAccessToken),this.fire(new t.f("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new t.f("data",{dataType:"source",sourceDataType:"content"}))),e&&e(a)}))}loaded(){return this._loaded}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}onAdd(t){this.map=t,this.load()}reload(){this.cancelTileJSONRequest();const e=t.al(this.id,this.scope);this.load((()=>this.map.style.clearSource(e)))}setTiles(t){return this._options.tiles=t,this.reload(),this}setUrl(t){return this.url=t,this._options.url=t,this.reload(),this}onRemove(t){this.cancelTileJSONRequest()}serialize(){return t.W({},this._options)}loadTile(e,n){const i=this.map._requestManager.normalizeTileURL(e.tileID.canonical.url(this.tiles,this.scheme)),a=this.map._requestManager.transformRequest(i,t.R.Tile),r=this.map.style?this.map.style.getLut(this.scope):null,o={request:a,data:void 0,uid:e.uid,tileID:e.tileID,tileZoom:e.tileZoom,zoom:e.tileID.overscaledZ,lut:r?{image:r.image.clone()}:null,tileSize:this.tileSize*e.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,pixelRatio:t.e.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:e.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,extraShadowCaster:e.isExtraShadowCaster,tessellationStep:this.map._tessellationStep};if(o.request.collectResourceTiming=this._collectResourceTiming,e.actor&&"expired"!==e.state)"loading"===e.state?e.reloadCallback=n:e.request=e.actor.send("reloadTile",o,s.bind(this));else if(e.actor=this._tileWorkers[i]=this._tileWorkers[i]||this.dispatcher.getActor(),this.dispatcher.ready)e.request=e.actor.send("loadTile",o,s.bind(this),void 0,!0);else{const n=t.ap.call({deduped:this._deduped},o,((t,n)=>{t||!n?s.call(this,t):(o.data={cacheControl:n.cacheControl,expires:n.expires,rawData:n.rawData.slice(0)},e.actor&&e.actor.send("loadTile",o,s.bind(this),void 0,!0))}),!0);e.request={cancel:n}}function s(i,a){return delete e.request,e.aborted?n(null):i&&404!==i.status?n(i):(a&&a.resourceTiming&&(e.resourceTiming=a.resourceTiming),this.map._refreshExpiredTiles&&a&&e.setExpiryData(a),e.loadVectorData(a,this.map.painter),t.am(this.dispatcher),n(null),void(e.reloadCallback&&(this.loadTile(e,e.reloadCallback),e.reloadCallback=null)))}}abortTile(t){t.request&&(t.request.cancel(),delete t.request),t.actor&&t.actor.send("abortTile",{uid:t.uid,type:this.type,source:this.id,scope:this.scope})}unloadTile(t,e){t.actor&&t.actor.send("removeTile",{uid:t.uid,type:this.type,source:this.id,scope:this.scope}),t.destroy()}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}const je=e=>({u_matrix:new t.a6(e),u_image0:new t.a7(e),u_skirt_height:new t.aa(e),u_ground_shadow_factor:new t.aq(e)}),Ve=(t,e,n)=>({u_matrix:t,u_image0:0,u_skirt_height:e,u_ground_shadow_factor:n}),Ue=(t,e,n,i,a,r,o,s,l,c,u,h,d,p,f,m)=>({u_proj_matrix:Float32Array.from(t),u_globe_matrix:e,u_normalize_matrix:Float32Array.from(i),u_merc_matrix:n,u_zoom_transition:a,u_merc_center:r,u_image0:0,u_frustum_tl:o,u_frustum_tr:s,u_frustum_br:l,u_frustum_bl:c,u_globe_pos:u,u_globe_radius:h,u_viewport:d,u_grid_matrix:m?Float32Array.from(m):new Float32Array(9),u_skirt_height:p,u_far_z_cutoff:f});class Ge{constructor(t=0,e=0,n=0,i=0){if(isNaN(t)||t<0||isNaN(e)||e<0||isNaN(n)||n<0||isNaN(i)||i<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=t,this.bottom=e,this.left=n,this.right=i}interpolate(e,n,i){return null!=n.top&&null!=e.top&&(this.top=t.a2(e.top,n.top,i)),null!=n.bottom&&null!=e.bottom&&(this.bottom=t.a2(e.bottom,n.bottom,i)),null!=n.left&&null!=e.left&&(this.left=t.a2(e.left,n.left,i)),null!=n.right&&null!=e.right&&(this.right=t.a2(e.right,n.right,i)),this}getCenter(e,n){const i=t.at((this.left+e-this.right)/2,0,e),a=t.at((this.top+n-this.bottom)/2,0,n);return new t.P(i,a)}equals(t){return this.top===t.top&&this.bottom===t.bottom&&this.left===t.left&&this.right===t.right}clone(){return new Ge(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function qe(e,n){const i=t.aw(e,3);t.ad.fromQuat(e,n),t.az(e,3,i)}function $e(e,n){const i=t.av.identity([]);return t.av.rotateZ(i,i,-n),t.av.rotateX(i,i,-e),i}function We(e,n){const i=[e[0],e[1],0],a=[n[0],n[1],0];if(t._.length(i)>=1e-15){const e=t._.normalize([],i);t._.scale(a,e,t._.dot(a,e)),n[0]=a[0],n[1]=a[1]}const r=t._.cross([],n,e);if(t._.len(r)<1e-15)return null;const o=Math.atan2(-r[1],r[0]);return $e(Math.atan2(Math.sqrt(e[0]*e[0]+e[1]*e[1]),-e[2]),o)}class He{constructor(t,e){this.position=t,this.orientation=e}get position(){return this._position}set position(e){if(e){const n=e instanceof t.Y?e:new t.Y(e[0],e[1],e[2]);this._renderWorldCopies&&(n.x=t.au(n.x,0,1)),this._position=n}else this._position=null}lookAtPoint(e,n){if(this.orientation=null,!this.position)return;const i=this.position,a=this._elevation?this._elevation.getAtPointOrZero(t.Y.fromLngLat(e)):0,r=t.Y.fromLngLat(e,a),o=[r.x-i.x,r.y-i.y,r.z-i.z];n||(n=[0,0,1]),n[2]=Math.abs(n[2]),this.orientation=We(o,n)}setPitchBearing(e,n){this.orientation=$e(t.ab(e),t.ab(-n))}}class Ze{constructor(e,n){this._transform=t.ad.identity([]),this.orientation=n,this.position=e}get mercatorPosition(){const e=this.position;return new t.Y(e[0],e[1],e[2])}get position(){const e=t.aw(this._transform,3);return[e[0],e[1],e[2]]}set position(e){var n;e&&t.az(this._transform,3,[(n=e)[0],n[1],n[2],1])}get orientation(){return this._orientation}set orientation(e){this._orientation=e||t.av.identity([]),e&&qe(this._transform,this._orientation)}getPitchBearing(){const t=this.forward(),e=this.right();return{bearing:Math.atan2(-e[1],e[0]),pitch:Math.atan2(Math.sqrt(t[0]*t[0]+t[1]*t[1]),-t[2])}}setPitchBearing(t,e){this._orientation=$e(t,e),qe(this._transform,this._orientation)}forward(){const e=t.aw(this._transform,2);return[-e[0],-e[1],-e[2]]}up(){const e=t.aw(this._transform,1);return[-e[0],-e[1],-e[2]]}right(){const e=t.aw(this._transform,0);return[e[0],e[1],e[2]]}getCameraToWorld(e,n){const i=new Float64Array(16);return t.ad.invert(i,this.getWorldToCamera(e,n)),i}getCameraToWorldMercator(){return this._transform}getWorldToCameraPosition(e,n,i){const a=this.position;t._.scale(a,a,-e);const r=new Float64Array(16);return t.ad.fromScaling(r,[i,i,i]),t.ad.translate(r,r,a),r[10]*=n,r}getWorldToCamera(e,n){const i=new Float64Array(16),a=new Float64Array(4),r=this.position;return t.av.conjugate(a,this._orientation),t._.scale(r,r,-e),t.ad.fromQuat(i,a),t.ad.translate(i,i,r),i[1]*=-1,i[5]*=-1,i[9]*=-1,i[13]*=-1,i[8]*=n,i[9]*=n,i[10]*=n,i[11]*=n,i}getCameraToClipPerspective(e,n,i,a){const r=new Float64Array(16);return t.ad.perspective(r,e,n,i,a),r}getCameraToClipOrthographic(e,n,i,a,r,o){const s=new Float64Array(16);return t.ad.ortho(s,e,n,i,a,r,o),s}getDistanceToElevation(e,n=!1){const i=0===e?0:t.ax(e,n?t.ay(this.position[1]):this.position[1]),a=this.forward();return(i-this.position[2])/a[2]}clone(){return new Ze([...this.position],[...this.orientation])}}const Ye={unknown:0,flipRequired:1,flipNotRequired:2},Xe=Math.tan(85*Math.PI/180);function Ke(e,n,i,a,r,o,s){const l=t.ad.create();if(i)if("globe"===o.name){const e=t.aB(r,n);t.ad.multiply(l,l,e)}else{const e=t.aC.invert([],s);l[0]=e[0],l[1]=e[1],l[4]=e[2],l[5]=e[3],a||t.ad.rotateZ(l,l,r.angle)}else t.ad.multiply(l,r.labelPlaneMatrix,e);return l}function Qe(t,e,n,i,a,r,o){const s=Ke(t,e,n,i,a,r,o);return"globe"===r.name&&n||(s[2]=s[6]=s[10]=s[14]=0),s}function Je(e,n,i,a,r,o,s){if(i){if("globe"===o.name){const l=Ke(e,n,i,a,r,o,s);return t.ad.invert(l,l),t.ad.multiply(l,e,l),l}{const n=t.ad.clone(e),i=t.ad.identity([]);return i[0]=s[0],i[1]=s[1],i[4]=s[2],i[5]=s[3],t.ad.multiply(n,n,i),a||t.ad.rotateZ(n,n,-r.angle),n}}return r.glCoordMatrix}function tn(e,n,i,a){const r=[e,n,i,1];i?t.aA.transformMat4(r,r,a):dn(r,r,a);const o=r[3];return r[0]/=o,r[1]/=o,r[2]/=o,r}function en(t,e){return Math.min(.5+t/e*.5,1.5)}function nn(t,e){const n=t[0]/t[3],i=t[1]/t[3];return n>=-e[0]&&n<=e[0]&&i>=-e[1]&&i<=e[1]}function an(e,n,i,a,r,o,s,l,c,u){const h=i.transform,d=a?e.textSizeData:e.iconSizeData,p=t.aD(d,i.transform.zoom),f="globe"===h.projection.name,m=[256/i.width*2+1,256/i.height*2+1],g=a?e.text.dynamicLayoutVertexArray:e.icon.dynamicLayoutVertexArray;g.clear();let _=null;f&&(_=a?e.text.globeExtVertexArray:e.icon.globeExtVertexArray);const y=e.lineVertexArray,x=a?e.text.placedSymbolArray:e.icon.placedSymbolArray,v=i.transform.width/i.transform.height;let b,w=!1;for(let a=0;a<x.length;a++){const f=x.get(a),{numGlyphs:A,writingMode:C}=f;if(C!==t.aE.vertical||w||b===t.aE.horizontal||(w=!0),b=C,(f.hidden||C===t.aE.vertical)&&!w){hn(A,g);continue}w=!1;const E=new t.P(f.tileAnchorX,f.tileAnchorY);let{x:T,y:S,z:M}=h.projection.projectTilePoint(E.x,E.y,u.canonical);if(c){const[t,e,n]=c(E);T+=t,S+=e,M+=n}const k=[T,S,M,1];if(t.aA.transformMat4(k,k,n),!nn(k,m)){hn(A,g);continue}const I=k[3],P=en(i.transform.getCameraToCenterDistance(h.projection),I),z=t.aF(d,p,f),D=s?z/P:z*P,L=tn(T,S,M,r);if(L[3]<=0){hn(A,g);continue}let B={};const O=s?null:c,R=sn(f,D,!1,l,n,r,o,e.glyphOffsetArray,y,g,_,L,E,B,v,O,h.projection,u,s);w=R.useVertical,O&&R.needsFlipping&&(B={}),(R.notEnoughRoom||w||R.needsFlipping&&sn(f,D,!0,l,n,r,o,e.glyphOffsetArray,y,g,_,L,E,B,v,O,h.projection,u,s).notEnoughRoom)&&hn(A,g)}a?(e.text.dynamicLayoutVertexBuffer.updateData(g),_&&e.text.globeExtVertexBuffer&&e.text.globeExtVertexBuffer.updateData(_)):(e.icon.dynamicLayoutVertexBuffer.updateData(g),_&&e.icon.globeExtVertexBuffer&&e.icon.globeExtVertexBuffer.updateData(_))}function rn(t,e,n,i,a,r,o,s,l,c,u,h,d,p,f,m){const{lineStartIndex:g,glyphStartIndex:_,segment:y}=s,x=_+s.numGlyphs,v=g+s.lineLength,b=e.getoffsetX(_),w=e.getoffsetX(x-1),A=un(t*b,n,i,a,r,o,y,g,v,l,c,u,h,d,!0,p,f,m);if(!A)return null;const C=un(t*w,n,i,a,r,o,y,g,v,l,c,u,h,d,!0,p,f,m);return C?{first:A,last:C}:null}function on(e,n,i,a){return e===t.aE.horizontal&&Math.abs(a)>Math.abs(i)?{useVertical:!0}:e===t.aE.vertical?a>0?{needsFlipping:!0}:null:n!==Ye.unknown&&function(t,e){return 0===t||Math.abs(e/t)>Xe}(i,a)?n===Ye.flipRequired?{needsFlipping:!0}:null:i<0?{needsFlipping:!0}:null}function sn(e,n,i,a,r,o,s,l,c,u,h,d,p,f,m,g,_,y,x){const v=n/24,b=e.lineOffsetX*v,w=e.lineOffsetY*v,{lineStartIndex:A,glyphStartIndex:C,numGlyphs:E,segment:T,writingMode:S,flipState:M}=e,k=A+e.lineLength,I=e=>{if(h){const[n,i,a]=e.up,r=u.length;t.aG(h,r+0,n,i,a),t.aG(h,r+1,n,i,a),t.aG(h,r+2,n,i,a),t.aG(h,r+3,n,i,a)}const[n,i,a]=e.point;t.aH(u,n,i,a,e.angle)};if(E>1){const t=rn(v,l,b,w,i,d,p,e,c,o,f,g,!1,_,y,x);if(!t)return{notEnoughRoom:!0};if(a&&!i){let[n,i,a]=t.first.point,[r,o,l]=t.last.point;[n,i]=tn(n,i,a,s),[r,o]=tn(r,o,l,s);const c=on(S,M,(r-n)*m,o-i);if(e.flipState=c&&c.needsFlipping?Ye.flipRequired:Ye.flipNotRequired,c)return c}I(t.first);for(let t=C+1;t<C+E-1;t++){const e=un(v*l.getoffsetX(t),b,w,i,d,p,T,A,k,c,o,f,g,!1,!1,_,y,x);if(!e)return u.length-=4*(t-C),{notEnoughRoom:!0};I(e)}I(t.last)}else{if(a&&!i){const n=tn(p.x,p.y,0,r),i=A+T+1,a=new t.P(c.getx(i),c.gety(i)),o=tn(a.x,a.y,0,r),s=o[3]>0?o:cn(p,a,n,1,r,void 0,_,y.canonical),l=on(S,M,(s[0]-n[0])*m,s[1]-n[1]);if(e.flipState=l&&l.needsFlipping?Ye.flipRequired:Ye.flipNotRequired,l)return l}const n=un(v*l.getoffsetX(C),b,w,i,d,p,T,A,k,c,o,f,g,!1,!1,_,y,x);if(!n)return{notEnoughRoom:!0};I(n)}return{}}function ln(t,e,n,i,a){const{x:r,y:o,z:s}=i.projectTilePoint(t.x,t.y,e);if(!a)return tn(r,o,s,n);const[l,c,u]=a(t);return tn(r+l,o+c,s+u,n)}function cn(e,n,i,a,r,o,s,l){const c=ln(e.sub(n)._unit()._add(e),l,r,s,o);return t._.sub(c,i,c),t._.normalize(c,c),t._.scaleAndAdd(c,i,c,a)}function un(e,n,i,a,r,o,s,l,c,u,h,d,p,f,m,g,_,y){const x=a?e-n:e+n;let v=x>0?1:-1,b=0;a&&(v*=-1,b=Math.PI),v<0&&(b+=Math.PI);let w=l+s+(v>0?0:1)|0,A=r,C=r,E=0,T=0;const S=Math.abs(x),M=[],k=[];let I=o,P=I;const z=()=>cn(P,I,C,S-E+1,h,p,g,_.canonical);for(;E+T<=S;){if(w+=v,w<l||w>=c)return null;if(C=A,P=I,M.push(C),f&&k.push(P),I=new t.P(u.getx(w),u.gety(w)),A=d[w],!A){const t=ln(I,_.canonical,h,g,p);A=t[3]>0?d[w]=t:z()}E+=T,T=t._.distance(C,A)}m&&p&&(d[w]&&(A=z(),T=t._.distance(C,A)),d[w]=A);const D=(S-E)/T,L=I.sub(P)._mult(D)._add(P),B=t._.sub([],A,C),O=t._.scaleAndAdd([],C,B,D);let R=[0,0,1],F=B[0],N=B[1];if(y&&(R=g.upVector(_.canonical,L.x,L.y),0!==R[0]||0!==R[1]||1!==R[2])){const e=[R[2],0,-R[0]],n=t._.cross([],R,e);t._.normalize(e,e),t._.normalize(n,n),F=t._.dot(B,e),N=t._.dot(B,n)}if(i){const e=t._.cross([],R,B);t._.normalize(e,e),t._.scaleAndAdd(O,O,e,i*v)}const j=b+Math.atan2(N,F);return M.push(O),f&&k.push(L),{point:O,angle:j,path:M,tilePath:k,up:R}}function hn(t,e){const n=e.length,i=n+4*t;e.resize(i),e.float32.fill(-1/0,4*n,4*i)}function dn(t,e,n){const i=e[0],a=e[1];return t[0]=n[0]*i+n[4]*a+n[12],t[1]=n[1]*i+n[5]*a+n[13],t[3]=n[3]*i+n[7]*a+n[15],t}const pn=(t,e,n)=>(1-n)*t+n*e,fn=t=>t*t*t*t*t;class mn{constructor(e,n,i,a,r,o,s){this.tileSize=512,this._renderWorldCopies=void 0===r||r,this._minZoom=e||0,this._maxZoom=n||22,this._minPitch=i??0,this._maxPitch=a??60,this.setProjection(o),this.setMaxBounds(s),this.width=0,this.height=0,this._center=new t.aI(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new Ge,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._expandedProjMatrixCache={},this._distanceTileDataCache={},this._camera=new Ze,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._tileCoverLift=0,this.freezeTileCoverage=!1,this._horizonShift=.1,this._orthographicProjectionAtLowPitch=!1}clone(){const t=new mn(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return t._elevation=this._elevation,t._centerAltitude=this._centerAltitude,t._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,t.tileSize=this.tileSize,t.mercatorFromTransition=this.mercatorFromTransition,t.width=this.width,t.height=this.height,t.cameraElevationReference=this.cameraElevationReference,t._center=this._center,t._setZoom(this.zoom),t._seaLevelZoom=this._seaLevelZoom,t.angle=this.angle,t._fov=this._fov,t._pitch=this._pitch,t._nearZ=this._nearZ,t._farZ=this._farZ,t._averageElevation=this._averageElevation,t._orthographicProjectionAtLowPitch=this._orthographicProjectionAtLowPitch,t._unmodified=this._unmodified,t._edgeInsets=this._edgeInsets.clone(),t._camera=this._camera.clone(),t._calcMatrices(),t.freezeTileCoverage=this.freezeTileCoverage,t.frustumCorners=this.frustumCorners,t}get isOrthographic(){return"globe"!==this.projection.name&&this._orthographicProjectionAtLowPitch&&this.pitch<15}get elevation(){return this._elevation}set elevation(t){this._elevation!==t&&(this._elevation=t,this._updateCameraOnTerrain(),this._calcMatrices())}get depthOcclusionForSymbolsAndCircles(){return"globe"!==this.projection.name&&!this.isOrthographic}updateElevation(t,e=!1){const n=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(null==this._seaLevelZoom||n)&&this._updateCameraOnTerrain(),(t||n)&&this._constrainCamera(e),this._calcMatrices()}getProjection(){return t.ah(this.projection,["name","center","parallels"])}setProjection(n){this.projectionOptions=n||{name:"mercator"};const i=this.projection?this.getProjection():void 0;this.projection=t.aJ(this.projectionOptions);const a=!e(i,this.getProjection());return a&&this._calcMatrices(),this.mercatorFromTransition=!1,a}setOrthographicProjectionAtLowPitch(t){return this._orthographicProjectionAtLowPitch!==t&&(this._orthographicProjectionAtLowPitch=t,this._calcMatrices(),!0)}setMercatorFromTransition(){const e=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=t.aJ({name:"mercator"});const n=e!==this.projection.name;return n&&this._calcMatrices(),n}get minZoom(){return this._minZoom}set minZoom(t){this._minZoom!==t&&(this._minZoom=t,this.zoom=Math.max(this.zoom,t))}get maxZoom(){return this._maxZoom}set maxZoom(t){this._maxZoom!==t&&(this._maxZoom=t,this.zoom=Math.min(this.zoom,t))}get minPitch(){return this._minPitch}set minPitch(t){this._minPitch!==t&&(this._minPitch=t,this.pitch=Math.max(this.pitch,t))}get maxPitch(){return this._maxPitch}set maxPitch(t){this._maxPitch!==t&&(this._maxPitch=t,this.pitch=Math.min(this.pitch,t))}get renderWorldCopies(){return this._renderWorldCopies&&!0===this.projection.supportsWorldCopies}set renderWorldCopies(t){void 0===t?t=!0:null===t&&(t=!1),this._renderWorldCopies=t}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const t=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(t))}get cameraWorldSize(){const t=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(t))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return t.ax(1,this.center.lat)*this.cameraWorldSizeForFog}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new t.P(this.width,this.height)}get bearing(){return t.au(this.rotation,-180,180)}set bearing(t){this.rotation=t}get rotation(){return-this.angle/Math.PI*180}set rotation(e){const n=-e*Math.PI/180;this.angle!==n&&(this._unmodified=!1,this.angle=n,this._calcMatrices(),this.rotationMatrix=t.aC.create(),t.aC.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(e){const n=t.at(e,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==n&&(this._unmodified=!1,this._pitch=n,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}get fovX(){return this._fov}get fovY(){const t=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/t)}set fov(e){e=Math.max(.01,Math.min(60,e)),this._fov!==e&&(this._unmodified=!1,this._fov=t.ab(e),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(t){this._averageElevation=t,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(t){const e=Math.min(Math.max(t,this.minZoom),this.maxZoom);this._zoom!==e&&(this._unmodified=!1,this._setZoom(e),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(t){this._zoom=t,this.scale=this.zoomScale(t),this.tileZoom=Math.floor(t),this.zoomFraction=t-this.tileZoom}get tileCoverLift(){return this._tileCoverLift}set tileCoverLift(t){this._tileCoverLift!==t&&(this._tileCoverLift=t)}_updateCameraOnTerrain(){const t=this.elevation?this.elevation.getAtPoint(this.locationCoordinate(this.center),Number.NEGATIVE_INFINITY):Number.NEGATIVE_INFINITY,e=this.elevation&&t===Number.NEGATIVE_INFINITY&&this.elevation.visibleDemTiles.length>0&&this.elevation.exaggeration()>0&&this._centerAltitudeValidForExaggeration;if(!this._elevation||t===Number.NEGATIVE_INFINITY&&(!e||!this._centerAltitude))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const n=this._elevation;e||this._centerAltitude&&this._centerAltitudeValidForExaggeration&&n.exaggeration()&&this._centerAltitudeValidForExaggeration!==n.exaggeration()?(this._centerAltitude=this._centerAltitude/this._centerAltitudeValidForExaggeration*n.exaggeration(),this._centerAltitudeValidForExaggeration=n.exaggeration()):(this._centerAltitude=t||0,this._centerAltitudeValidForExaggeration=n.exaggeration()),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){void 0!==this._centerAltitudeValidForExaggeration&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const e=this._elevation,n=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],i=this.horizonLineFromTop();let a=0,r=0;for(let o=0;o<n.length;o++){const s=new t.P(n[o][0]*this.width,i+n[o][1]*(this.height-i)),l=e.pointCoordinate(s);if(!l)continue;const c=1/Math.hypot(l[0]-this._camera.position[0],l[1]-this._camera.position[1]);a+=l[3]*c,r+=c}return 0===r?NaN:a/r}get center(){return this._center}set center(t){t.lat===this._center.lat&&t.lng===this._center.lng||(this._unmodified=!1,this._center=t,this._terrainEnabled()&&("ground"===this.cameraElevationReference?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(null==this._seaLevelZoom||!this._elevation)return;const t=this._seaLevelZoom,e=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),n=this.pixelsPerMeter/this.worldSize*e,i=this._mercatorZfromZoom(t),a=this._mercatorZfromZoom(this._maxZoom),r=Math.max(i-n,a);this._setZoom(this._zoomFromMercatorZ(r))}get padding(){return this._edgeInsets.toJSON()}set padding(t){this._edgeInsets.equals(t)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,t,1),this._calcMatrices())}computeZoomRelativeTo(e){const n=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,e.toAltitude()));let i;i=e.z<this._camera.position[2]?[n.x,n.y,n.z]:[e.x,e.y,e.z];const a=t._.length(t._.sub([],this._camera.position,i));return t.at(this._zoomFromMercatorZ(a),this._minZoom,this._maxZoom)}setFreeCameraOptions(e){if(!this.height)return;if(!e.position&&!e.orientation)return;this._updateCameraState();let n=!1;if(e.orientation&&!t.av.exactEquals(e.orientation,this._camera.orientation)&&(n=this._setCameraOrientation(e.orientation)),e.position){const i=[e.position.x,e.position.y,e.position.z];t._.exactEquals(i,this._camera.position)||(this._setCameraPosition(i),n=!0)}n&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const e=this._camera.position,n=new He;return n.position=new t.Y(e[0],e[1],e[2]),n.orientation=this._camera.orientation,n._elevation=this.elevation,n._renderWorldCopies=this.renderWorldCopies,n}_setCameraOrientation(e){if(!t.av.length(e))return!1;t.av.normalize(e,e);const n=t._.transformQuat([],[0,0,-1],e),i=t._.transformQuat([],[0,-1,0],e);if(i[2]<0)return!1;const a=We(n,i);return!!a&&(this._camera.orientation=a,!0)}_setCameraPosition(e){const n=this.zoomScale(this.minZoom)*this.tileSize,i=this.zoomScale(this.maxZoom)*this.tileSize,a=this.cameraToCenterDistance;e[2]=t.at(e[2],a/i,a/n),this._camera.position=e}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(t){return this._edgeInsets.equals(t)}interpolatePadding(t,e,n){this._unmodified=!1,this._edgeInsets.interpolate(t,e,n),this._constrain(),this._calcMatrices()}coveringZoomLevel(t){const e=(t.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/t.tileSize));return Math.max(0,e)}getVisibleUnwrappedCoordinates(e){const n=[new t.aK(0,e)];if(this.renderWorldCopies){const i=this.pointCoordinate(new t.P(0,0)),a=this.pointCoordinate(new t.P(this.width,0)),r=this.pointCoordinate(new t.P(this.width,this.height)),o=this.pointCoordinate(new t.P(0,this.height)),s=Math.floor(Math.min(i.x,a.x,r.x,o.x)),l=Math.floor(Math.max(i.x,a.x,r.x,o.x)),c=1;for(let i=s-c;i<=l+c;i++)0!==i&&n.push(new t.aK(i,e))}return n}isLODDisabled(t){return(!t||this.pitch<=60)&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace}extendTileCoverForShadows(e,n,i){let a=[];if(0===n[0]&&0===n[1])return a;for(const i of e){const e=i.canonical,r=i.overscaledZ,o=i.wrap,s=1<<e.z,l=e.x+1<s,c=e.x>0,u=e.y+1<s,h=e.y>0,d=i.wrap-(c?0:1),p=i.wrap+(l?0:1),f=c?e.x-1:s-1,m=l?e.x+1:0;n[0]<0?(a.push(new t.aL(r,p,e.z,m,e.y)),n[1]<0&&u&&(a.push(new t.aL(r,o,e.z,e.x,e.y+1)),a.push(new t.aL(r,p,e.z,m,e.y+1))),n[1]>0&&h&&(a.push(new t.aL(r,o,e.z,e.x,e.y-1)),a.push(new t.aL(r,p,e.z,m,e.y-1)))):n[0]>0?(a.push(new t.aL(r,d,e.z,f,e.y)),n[1]<0&&u&&(a.push(new t.aL(r,o,e.z,e.x,e.y+1)),a.push(new t.aL(r,d,e.z,f,e.y+1))),n[1]>0&&h&&(a.push(new t.aL(r,o,e.z,e.x,e.y-1)),a.push(new t.aL(r,d,e.z,f,e.y-1)))):n[1]<0&&u?a.push(new t.aL(r,o,e.z,e.x,e.y+1)):h&&a.push(new t.aL(r,o,e.z,e.x,e.y-1))}if(a.length>1){a.sort(((t,e)=>t.overscaledZ-e.overscaledZ||t.wrap-e.wrap||t.canonical.z-e.canonical.z||t.canonical.x-e.canonical.x||t.canonical.y-e.canonical.y));let t=0,e=0;for(;e<a.length;)a[e].equals(a[t])?++e:a[++t]=a[e++];a.length=t+1}const r=[];for(const t of a)a.some((e=>t.isChildOf(e)))||r.push(t);return a=r.filter((t=>!e.some((e=>!!(t.overscaledZ<i&&e.isChildOf(t))||t.equals(e)||t.isChildOf(e))))),a}coveringTiles(e){let n=this.coveringZoomLevel(e);const i=n,a=this.elevation&&this.elevation.exaggeration(),r=a&&!e.isTerrainDEM,o="mercator"===this.projection.name;if(void 0!==e.minzoom&&n<e.minzoom)return[];void 0!==e.maxzoom&&n>e.maxzoom&&(n=e.maxzoom);const s=this.locationCoordinate(this.center),l=this.center.lat,c=1<<n,u=[c*s.x,c*s.y,0],h="globe"===this.projection.name,d=!h,p=t.aM.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,n,d),f=h?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),m=c*t.ax(1,this.center.lat),g=this._camera.position[2]/t.ax(1,this.center.lat),_=[c*f.x,c*f.y,g*(d?1:m)],y=h||a,x=this.cameraToCenterDistance/e.tileSize*(e.roundZoom?1:.502),v=this.isLODDisabled(!0)?n:0;let b;if(this._elevation&&e.isTerrainDEM)b=1e4*this._elevation.exaggeration();else if(this._elevation){const t=this._elevation.getMinMaxForVisibleTiles();b=t?t.max:this._centerAltitude}else b=this._centerAltitude;const w=e.isTerrainDEM?-b:this._elevation?this._elevation.getMinElevationBelowMSL():0,A=this.projection.isReprojectedInTileSpace?t.aN(this):1,C=e=>{const n=1/4e4,i=new t.Y(e.x+n,e.y,e.z),a=new t.Y(e.x,e.y+n,e.z),r=e.toLngLat(),o=i.toLngLat(),s=a.toLngLat(),l=this.locationCoordinate(r),c=this.locationCoordinate(o),u=this.locationCoordinate(s),h=Math.hypot(c.x-l.x,c.y-l.y),d=Math.hypot(u.x-l.x,u.y-l.y);return Math.sqrt(h*d)*A/n},E=e=>{const n=b,i=w;return{aabb:t.aQ(this,c,0,0,0,e,i,n,this.projection),zoom:0,x:0,y:0,minZ:i,maxZ:n,wrap:e,fullyVisible:!1}},T=[];let S=[];const M=n,k=e.reparseOverscaled?i:n,I=t=>t*t,P=I((g-this._centerAltitude)*m),z=t=>{if(!this._elevation||!t.tileID||!o)return;const e=this._elevation.getMinMaxForTile(t.tileID),n=t.aabb;e?(n.min[2]=e.min,n.max[2]=e.max,n.center[2]=(n.min[2]+n.max[2])/2):(t.shouldSplit=D(t),t.shouldSplit||(n.min[2]=n.max[2]=n.center[2]=this._centerAltitude))},D=e=>{if(e.zoom<v)return!0;if(e.zoom===M)return!1;if(null!=e.shouldSplit)return e.shouldSplit;const n=e.aabb.distanceX(_),a=e.aabb.distanceY(_);let o=P,s=1;if(h){o=I(e.aabb.distanceZ(_));const n=Math.pow(2,e.zoom),i=t.ay((e.y+1)/n),a=t.ay(e.y/n),r=Math.min(Math.max(l,i),a),c=t.b4(r)/t.b4(l);if(s=r===l?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,c/this._mercatorScaleRatio),this.zoom<=t.b1&&e.zoom===M-1&&c>=.9)return!0}else if(r&&(o=I(e.aabb.distanceZ(_)*m)),this.projection.isReprojectedInTileSpace&&i<=5){const n=Math.pow(2,e.zoom),i=C(new t.Y((e.x+.5)/n,(e.y+.5)/n));s=i>.85?1:i}const c=n*n+a*a+o,u=I((1<<M-e.zoom)*x*s*((t,e)=>{if(e*I(.707)<t)return 1;const n=Math.sqrt(e/t);return n/(1.4144271570014144+(Math.pow(1.1,n-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(o,P),c));return c<u};if(this.renderWorldCopies)for(let t=1;t<=3;t++)T.push(E(-t)),T.push(E(t));for(T.push(E(0));T.length>0;){const i=T.pop(),a=i.x,s=i.y;let l=i.fullyVisible;const d=()=>"globe"===this.projection.name&&(0===i.y||i.y===(1<<i.zoom)-1);if(!l){let e=y?i.aabb.intersects(p):i.aabb.intersectsFlat(p);if(0===e&&d()){const n=new t.aO(i.zoom,a,s);e=t.aP(this,c,n,!0).intersects(p)}if(0===e)continue;l=2===e}if(i.zoom!==M&&D(i))for(let e=0;e<4;e++){const n=(a<<1)+e%2,u=(s<<1)+(e>>1),d={aabb:o?i.aabb.quadrant(e):t.aQ(this,c,i.zoom+1,n,u,i.wrap,i.minZ,i.maxZ,this.projection),zoom:i.zoom+1,x:n,y:u,wrap:i.wrap,fullyVisible:l,tileID:void 0,shouldSplit:void 0,minZ:i.minZ,maxZ:i.maxZ};r&&!h&&(d.tileID=new t.aL(i.zoom+1===M?k:i.zoom+1,i.wrap,i.zoom+1,n,u),z(d)),T.push(d)}else{const r=i.zoom===M?k:i.zoom;if(e.minzoom&&e.minzoom>r)continue;if(!l){let e=y?i.aabb.intersectsPrecise(p):i.aabb.intersectsPreciseFlat(p);if(0===e&&d()){const n=new t.aO(i.zoom,a,s);e=t.aP(this,c,n,!0).intersectsPrecise(p)}if(0===e)continue}const o=u[0]-(.5+a+(i.wrap<<i.zoom))*(1<<n-i.zoom),h=u[1]-.5-s,f=i.tileID?i.tileID:new t.aL(r,i.wrap,i.zoom,a,s);S.push({tileID:f,distanceSq:o*o+h*h})}}if(this.fogCullDistSq){const n=this.fogCullDistSq,i=this.horizonLineFromTop();S=S.filter((a=>{const r=[0,0,0,1],o=[t.a3,t.a3,0,1],s=this.calculateFogTileMatrix(a.tileID.toUnwrapped());t.aA.transformMat4(r,r,s),t.aA.transformMat4(o,o,s);const l=t.aA.min([],r,o),c=t.aA.max([],r,o),u=t.aR(l,c);if(0===u)return!0;let h=!1;const d=this._elevation;if(d&&u>n&&0!==i){const n=this.calculateProjMatrix(a.tileID.toUnwrapped());let r;e.isTerrainDEM||(r=d.getMinMaxForTile(a.tileID)),r||(r={min:w,max:b});const o=t.b2(this.rotation),s=[o[0]*t.a3,o[1]*t.a3,r.max];t._.transformMat4(s,s,n),h=(1-s[1])*this.height*.5<i}return u<n||h}))}return S.sort(((t,e)=>t.distanceSq-e.distanceSq)).map((t=>t.tileID))}resize(t,e){this.width=t,this.height=e,this.pixelsToGLUnits=[2/t,-2/e],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(t){return Math.pow(2,t)}scaleZoom(t){return Math.log(t)/Math.LN2}project(e){const n=t.at(e.lat,-t.aS,t.aS),i=this.projection.project(e.lng,n);return new t.P(i.x*this.worldSize,i.y*this.worldSize)}unproject(t){return this.projection.unproject(t.x/this.worldSize,t.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/t.ax(1,this.center.lat)/this.worldSize}setLocationAtPoint(e,n){let i,a;const r=this.centerPoint;if("globe"===this.projection.name){const t=this.worldSize;i=(n.x-r.x)/t,a=(n.y-r.y)/t}else{const t=this.pointCoordinate(n),e=this.pointCoordinate(r);i=t.x-e.x,a=t.y-e.y}const o=this.locationCoordinate(e);this.setLocation(new t.Y(o.x-i,o.y-a))}setLocation(t){this.center=this.coordinateLocation(t),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(t){return this.projection.locationPoint(this,t)}locationPoint3D(t){return this.projection.locationPoint(this,t,!0)}pointLocation(t){return this.coordinateLocation(this.pointCoordinate(t))}pointLocation3D(t){return this.coordinateLocation(this.pointCoordinate3D(t))}locationCoordinate(e,n){const i=n?t.ax(n,e.lat):void 0,a=this.projection.project(e.lng,e.lat);return new t.Y(a.x,a.y,i)}coordinateLocation(t){return this.projection.unproject(t.x,t.y)}pointRayIntersection(e,n){const i=null!=n?n:this._centerAltitude,a=[e.x,e.y,0,1],r=[e.x,e.y,1,1];t.aA.transformMat4(a,a,this.pixelMatrixInverse),t.aA.transformMat4(r,r,this.pixelMatrixInverse);const o=r[3];t.aA.scale(a,a,1/a[3]),t.aA.scale(r,r,1/o);const s=a[2],l=r[2];return{p0:a,p1:r,t:s===l?0:(i-s)/(l-s)}}screenPointToMercatorRay(e){const n=[e.x,e.y,0,1],i=[e.x,e.y,1,1];return t.aA.transformMat4(n,n,this.pixelMatrixInverse),t.aA.transformMat4(i,i,this.pixelMatrixInverse),t.aA.scale(n,n,1/n[3]),t.aA.scale(i,i,1/i[3]),n[2]=t.ax(n[2],this._center.lat)*this.worldSize,i[2]=t.ax(i[2],this._center.lat)*this.worldSize,t.aA.scale(n,n,1/this.worldSize),t.aA.scale(i,i,1/this.worldSize),new t.aT([n[0],n[1],n[2]],t._.normalize([],t._.sub([],i,n)))}rayIntersectionCoordinate(e){const{p0:n,p1:i,t:a}=e,r=t.ax(n[2],this._center.lat),o=t.ax(i[2],this._center.lat);return new t.Y(t.a2(n[0],i[0],a)/this.worldSize,t.a2(n[1],i[1],a)/this.worldSize,t.a2(r,o,a))}pointCoordinate(t,e=this._centerAltitude){return this.projection.pointCoordinate(this,t.x,t.y,e)}pointCoordinate3D(e){if(!this.elevation)return this.pointCoordinate(e);let n=this.projection.pointCoordinate3D(this,e.x,e.y);if(n)return new t.Y(n[0],n[1],n[2]);let i=0,a=this.horizonLineFromTop();if(e.y>a)return this.pointCoordinate(e);const r=.02*a,o=e.clone();for(let e=0;e<10&&a-i>r;e++){o.y=t.a2(i,a,.66);const e=this.projection.pointCoordinate3D(this,o.x,o.y);e?(a=o.y,n=e):i=o.y}return n?new t.Y(n[0],n[1],n[2]):this.pointCoordinate(e)}isPointAboveHorizon(t){return this.projection.isPointAboveHorizon(this,t)}isPointOnSurface(e){if(e.y<0||e.y>this.height||e.x<0||e.x>this.width)return!1;if(this.elevation||this.zoom>=t.aU)return!this.isPointAboveHorizon(e);const n=this.pointCoordinate(e);return n.y>=0&&n.y<=1}_coordinatePoint(e,n){const i=n&&this.elevation?this.elevation.getAtPointOrZero(e,this._centerAltitude):this._centerAltitude,a=[e.x*this.worldSize,e.y*this.worldSize,i+e.toAltitude(),1];return t.aA.transformMat4(a,a,this.pixelMatrix),a[3]>0?new t.P(a[0]/a[3],a[1]/a[3]):new t.P(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:e,left:n}=this._edgeInsets,i=this.height-this._edgeInsets.bottom,a=this.width-this._edgeInsets.right,r=this.pointLocation3D(new t.P(n,e)),o=this.pointLocation3D(new t.P(a,e)),s=this.pointLocation3D(new t.P(a,i)),l=this.pointLocation3D(new t.P(n,i));let c=Math.min(r.lng,o.lng,s.lng,l.lng),u=Math.max(r.lng,o.lng,s.lng,l.lng),h=Math.min(r.lat,o.lat,s.lat,l.lat),d=Math.max(r.lat,o.lat,s.lat,l.lat);const p=Math.pow(2,-this.zoom)/16*270,f="globe"===this.projection.name?1:4,m=(e,n,i,a,r)=>{const o=(e+i)/2,s=(n+a)/2,l=new t.P(o,s),{lng:g,lat:_}=this.pointLocation3D(l),y=Math.max(0,c-g,h-_,g-u,_-d);c=Math.min(c,g),u=Math.max(u,g),h=Math.min(h,_),d=Math.max(d,_),(r<f||y>p)&&(m(e,n,o,s,r+1),m(o,s,i,a,r+1))};if(m(n,e,a,e,1),m(a,e,a,i,1),m(a,i,n,i,1),m(n,i,n,e,1),"globe"===this.projection.name){const[e,n]=t.aV(this);e?(d=90,u=180,c=-180):n&&(h=-90,u=180,c=-180)}return new t.ai(new t.aI(c,h),new t.aI(u,d))}_getBoundsRectangular(e,n){const{top:i,left:a}=this._edgeInsets,r=this.height-this._edgeInsets.bottom,o=this.width-this._edgeInsets.right,s=new t.P(a,i),l=new t.P(o,i),c=new t.P(o,r),u=new t.P(a,r);let h=this.pointCoordinate(s,e),d=this.pointCoordinate(l,e);const p=this.pointCoordinate(c,n),f=this.pointCoordinate(u,n),m=(t,e)=>(e.y-t.y)/(e.x-t.x);return h.y>1&&d.y>=0?h=new t.Y((1-f.y)/m(f,h)+f.x,1):h.y<0&&d.y<=1&&(h=new t.Y(-f.y/m(f,h)+f.x,0)),d.y>1&&h.y>=0?d=new t.Y((1-p.y)/m(p,d)+p.x,1):d.y<0&&h.y<=1&&(d=new t.Y(-p.y/m(p,d)+p.x,0)),(new t.ai).extend(this.coordinateLocation(h)).extend(this.coordinateLocation(d)).extend(this.coordinateLocation(f)).extend(this.coordinateLocation(p))}_getBoundsRectangularTerrain(){const t=this.elevation;if(!t.visibleDemTiles.length||t.isUsingMockSource())return this._getBoundsRectangular(0,0);const e=t.visibleDemTiles.reduce(((t,e)=>{if(e.dem){const n=e.dem.tree;t.min=Math.min(t.min,n.minimums[0]),t.max=Math.max(t.max,n.maximums[0])}return t}),{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(e.min*t.exaggeration(),e.max*t.exaggeration())}getBounds(){return"mercator"===this.projection.name||"equirectangular"===this.projection.name?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(t=!0){const e=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))-this.centerOffset.y,n=this.height/2-e*(1-this._horizonShift);return t?Math.max(0,n):n}getMaxBounds(){return this.maxBounds}setMaxBounds(e){this.maxBounds=e,this.minLat=-t.aS,this.maxLat=t.aS,this.minLng=-180,this.maxLng=180,e&&(this.minLat=e.getSouth(),this.maxLat=e.getNorth(),this.minLng=e.getWest(),this.maxLng=e.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=t.aj(this.minLng)*this.tileSize,this.worldMaxX=t.aj(this.maxLng)*this.tileSize,this.worldMinY=t.ak(this.maxLat)*this.tileSize,this.worldMaxY=t.ak(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(t,e){return this.projection.createTileMatrix(this,e,t)}calculateDistanceTileData(e){const n=e.key,i=this._distanceTileDataCache;if(i[n])return i[n];const a=e.canonical,r=1/this.height,o=this.cameraWorldSize,s=o/this.zoomScale(a.z),l=(a.x+Math.pow(2,a.z)*e.wrap)*s,c=a.y*s,u=this.point;u.x*=o/this.worldSize,u.y*=o/this.worldSize;const h=this.angle,d=Math.sin(-h),p=-Math.cos(-h);return i[n]={bearing:[d,p],center:[(u.x-l)*r,(u.y-c)*r],scale:s/t.a3*r},i[n]}calculateFogTileMatrix(e){const n=e.key,i=this._fogTileMatrixCache;if(i[n])return i[n];const a=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,e);return t.ad.multiply(a,this.worldToFogMatrix,a),i[n]=new Float32Array(a),i[n]}calculateProjMatrix(e,n=!1,i=!1){const a=e.key;let r;if(r=i?this._expandedProjMatrixCache:n?this._alignedProjMatrixCache:this._projMatrixCache,r[a])return r[a];const o=this.calculatePosMatrix(e,this.worldSize);let s;return s=this.projection.isReprojectedInTileSpace?this.mercatorMatrix:i?this.expandedFarZProjMatrix:n?this.alignedProjMatrix:this.projMatrix,t.ad.multiply(o,s,o),r[a]=new Float32Array(o),r[a]}calculatePixelsToTileUnitsMatrix(e){const n=e.tileID.key,i=this._pixelsToTileUnitsCache;if(i[n])return i[n];const a=t.aW(e,this);return i[n]=a,i[n]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if("globe"===this.projection.name){const e=1/this.worldSize,n=t.ad.fromScaling([],[e,e,e]);return t.ad.multiply(n,n,this.globeMatrix),n}}recenterOnTerrain(){if(!this._elevation||"globe"===this.projection.name)return;const e=this._elevation;this._updateCameraState();const n=t.ax(1,this._center.lat)*this.worldSize,i=this._computeCameraPosition(n),a=this._camera.forward(),r=t.ax(1,this._center.lat);i[2]/=r,a[2]/=r,t._.normalize(a,a);const o=e.raycast(i,a,e.exaggeration());if(o){const e=t._.scaleAndAdd([],i,a,o),n=new t.Y(e[0],e[1],t.ax(e[2],t.ay(e[1]))),s=(n.z+t._.length([n.x-i[0],n.y-i[1],n.z-i[2]*r]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(s),this._centerAltitude=n.toAltitude(),this._center=this.coordinateLocation(n),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(e=!1){if(!this._elevation)return;const n=this._elevation,i=t.ax(1,this._center.lat)*this.worldSize,a=this._computeCameraPosition(i),r=n.getAtPointOrZero(new t.Y(...a)),o=this.pixelsPerMeter/this.worldSize*r,s=this._minimumHeightOverTerrain(),l=a[2]-o;if(l<=s)if(l<0||e){const e=this.locationCoordinate(this._center,this._centerAltitude),n=[a[0],a[1],e.z-a[2]],i=t._.length(n);n[2]-=(s-l)/this._pixelsPerMercatorPixel;const r=t._.length(n);if(0===r)return;t._.scale(n,n,i/r*this._pixelsPerMercatorPixel),this._camera.position=[a[0],a[1],e.z*this._pixelsPerMercatorPixel-n[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const e="globe"===this.projection.name||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||e){const n=this.center;return n.lat=t.at(n.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!e)&&(n.lng=t.at(n.lng,this.minLng,this.maxLng)),this.center=n,void(this._constraining=!1)}const n=this._unmodified,{x:i,y:a}=this.point;let r=0,o=i,s=a;const l=this.width/2,c=this.height/2,u=this.worldMinY*this.scale,h=this.worldMaxY*this.scale;if(a-c<u&&(s=u+c),a+c>h&&(s=h-c),h-u<this.height&&(r=Math.max(r,this.height/(h-u)),s=(h+u)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const t=this.worldMinX*this.scale,e=this.worldMaxX*this.scale,n=this.worldSize/2-(t+e)/2;o=(i+n+this.worldSize)%this.worldSize-n,o-l<t&&(o=t+l),o+l>e&&(o=e-l),e-t<this.width&&(r=Math.max(r,this.width/(e-t)),o=(e+t)/2)}o===i&&s===a||(this.center=this.unproject(new t.P(o,s))),r&&(this.zoom+=this.scaleZoom(r)),this._constrainCamera(),this._unmodified=n,this._constraining=!1}_minZoomForBounds(){let t=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(t=Math.max(t,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),t}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const e=this.centerOffset,n="globe"===this.projection.name,i=this.pixelsPerMeter;"globe"===this.projection.name&&(this._mercatorScaleRatio=t.ax(1,this.center.lat)/t.ax(1,t.b3));const a=t.aX(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,a),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const r="meters"===this.projection.zAxisUnit?i:1,o=this._camera.getWorldToCamera(this.worldSize,r);let s;const l=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);if(l[8]=2*-e.x/this.width,l[9]=2*e.y/this.height,this.isOrthographic){let t=.5*this.height/Math.tan(this._fov/2)*1*Math.tan(.5*this._fov),n=t*this.aspect,i=-n,a=-t;n-=e.x,i-=e.x,t+=e.y,a+=e.y,s=this._camera.getCameraToClipOrthographic(i,n,a,t,this._nearZ,this._farZ),((t,e,n,i)=>{for(let a=0;a<16;a++)t[a]=pn(e[a],n[a],i)})(s,s,l,fn(this.pitch>=15?1:this.pitch/15))}else s=l;const c=t.ad.mul([],l,o);let u=t.ad.mul([],s,o);if(this.projection.isReprojectedInTileSpace){const e=this.locationCoordinate(this.center),n=t.ad.identity([]);t.ad.translate(n,n,[e.x*this.worldSize,e.y*this.worldSize,0]),t.ad.multiply(n,n,t.aY(this)),t.ad.translate(n,n,[-e.x*this.worldSize,-e.y*this.worldSize,0]),t.ad.multiply(u,u,n),t.ad.multiply(c,c,n),this.inverseAdjustmentMatrix=t.aZ(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];if(this.mercatorMatrix=t.ad.scale([],u,[this.worldSize,this.worldSize,this.worldSize/r,1]),this.projMatrix=u,this.invProjMatrix=t.ad.invert(new Float64Array(16),this.projMatrix),n){const n=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,1/0);n[8]=2*-e.x/this.width,n[9]=2*e.y/this.height,this.expandedFarZProjMatrix=t.ad.mul([],n,o)}else this.expandedFarZProjMatrix=this.projMatrix;const h=t.ad.invert([],s);this.frustumCorners=t.a_.fromInvProjectionMatrix(h,this.horizonLineFromTop(),this.height),this.cameraFrustum=t.aM.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,0,!n);const d=new Float32Array(16);t.ad.identity(d),t.ad.scale(d,d,[1,-1,1]),t.ad.rotateX(d,d,this._pitch),t.ad.rotateZ(d,d,this.angle);const p=t.ad.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ);this.starsProjMatrix=t.ad.clone(p);const f=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;p[8]=2*-e.x/this.width,p[9]=2*(e.y+f)/this.height,this.skyboxMatrix=t.ad.multiply(d,p,d);const m=this.point,g=m.x,_=m.y,y=this.width%2/2,x=this.height%2/2,v=Math.cos(this.angle),b=Math.sin(this.angle),w=g-Math.round(g)+v*y+b*x,A=_-Math.round(_)+v*x+b*y,C=new Float64Array(u);if(t.ad.translate(C,C,[w>.5?w-1:w,A>.5?A-1:A,0]),this.alignedProjMatrix=C,u=t.ad.create(),t.ad.scale(u,u,[this.width/2,-this.height/2,1]),t.ad.translate(u,u,[1,-1,0]),this.labelPlaneMatrix=u,u=t.ad.create(),t.ad.scale(u,u,[1,-1,1]),t.ad.translate(u,u,[-1,-1,0]),t.ad.scale(u,u,[2/this.width,2/this.height,1]),this.glCoordMatrix=u,this.pixelMatrix=t.ad.multiply(new Float64Array(16),this.labelPlaneMatrix,c),this._calcFogMatrices(),this._distanceTileDataCache={},u=t.ad.invert(new Float64Array(16),this.pixelMatrix),!u)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=u,"globe"===this.projection.name||this.mercatorFromTransition){this.globeMatrix=t.a$(this);const e=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=t._.transformMat4(e,e,o),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=u;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={},this._expandedProjMatrixCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const e=this.cameraWorldSizeForFog,n=this.cameraPixelsPerMeter,i=this._camera.position,a=1/this.height/this._pixelsPerMercatorPixel,r=[e,e,n];t._.scale(r,r,a),t._.scale(i,i,-1),t._.multiply(i,i,r);const o=t.ad.create();t.ad.translate(o,o,i),t.ad.scale(o,o,r),this.mercatorFogMatrix=o,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(e,n,a)}_computeCameraPosition(t){const e=(t=t||this.pixelsPerMeter)/this.pixelsPerMeter,n=this._camera.forward(),i=this.point,a=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*e-t/this.worldSize*this._centerAltitude;return[i.x/this.worldSize-n[0]*a,i.y/this.worldSize-n[1]*a,t/this.worldSize*this._centerAltitude-n[2]*a]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(e){const n=this._maxCameraBoundsDistance()*Math.cos(this._pitch),i=this._camera.position[2],a=e[2];let r=1;this.projection.wrap&&(this.center=this.center.wrap()),a>0&&(r=Math.min((n-i)/a,1)),this._camera.position=t._.scaleAndAdd([],this._camera.position,e,r),this._updateStateFromCamera()}_updateStateFromCamera(){const e=this._camera.position,n=this._camera.forward(),{pitch:i,bearing:a}=this._camera.getPitchBearing(),r=t.ax(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,o=this._mercatorZfromZoom(this._maxZoom)*Math.cos(t.ab(this._maxPitch)),s=Math.max((e[2]-r)/Math.cos(i),o),l=this._zoomFromMercatorZ(s);t._.scaleAndAdd(e,e,n,s),this._pitch=t.at(i,t.ab(this.minPitch),t.ab(this.maxPitch)),this.angle=t.au(a,-Math.PI,Math.PI),this._setZoom(t.at(l,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new t.Y(e[0],e[1],e[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(t){return Math.pow(2,t)*this.tileSize}_mercatorZfromZoom(t){return this.cameraToCenterDistance/this._worldSizeFromZoom(t)}_minimumHeightOverTerrain(){const t=Math.min(null!=this._seaLevelZoom?this._seaLevelZoom:this._zoom,this._maxZoom)+4;return this._mercatorZfromZoom(t)}_zoomFromMercatorZ(t){return this.scaleZoom(this.cameraToCenterDistance/(t*this.tileSize))}zoomFromMercatorZAdjusted(e){let n=0,i=t.aU,a=0,r=1/0;for(;i-n>1e-6&&i>n;){const t=n+.5*(i-n),o=this.tileSize*Math.pow(2,t),s=this.getCameraToCenterDistance(this.projection,t,o),l=this.scaleZoom(s/(e*this.tileSize)),c=Math.abs(t-l);c<r&&(r=c,a=t),t<l?n=t:i=t}return a}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(t.w("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(e,n){const i=Math.min(e.x,n.x),a=Math.max(e.x,n.x),r=Math.min(e.y,n.y),o=Math.max(e.y,n.y);if(r<this.horizonLineFromTop(!1))return!0;if("mercator"!==this.projection.name)return!1;const s=[new t.P(i,r),new t.P(a,o),new t.P(i,o),new t.P(a,r)],l=this.renderWorldCopies?-3:0,c=this.renderWorldCopies?4:1;for(const t of s){const e=this.pointRayIntersection(t);if(e.t<0)return!0;const n=this.rayIntersectionCoordinate(e);if(n.x<l||n.y<0||n.x>c||n.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+t.b0(this.fovAboveCenter)>88||this.anyCornerOffEdge(new t.P(0,0),new t.P(this.width,this.height))}zoomDeltaToMovement(e,n){const i=t._.length(t._.sub([],this._camera.position,e)),a=this._zoomFromMercatorZ(i)+n;return i-this._mercatorZfromZoom(a)}getCameraPoint(){if("globe"===this.projection.name){const e=function([e,n,i],a){const r=[e,n,i,1];t.aA.transformMat4(r,r,a);const o=r[3]=Math.max(r[3],1e-6);return r[0]/=o,r[1]/=o,r[2]/=o,r}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new t.P(e[0],e[1])}{const e=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new t.P(0,e))}}getCameraToCenterDistance(e,n=this.zoom,i=this.worldSize){const a=t.aX(e,n,this.width,this.height,1024),r=e.pixelSpaceConversion(this.center.lat,i,a);let o=.5/Math.tan(.5*this._fov)*this.height*r;return this.isOrthographic&&(o=pn(1,o,fn(this.pitch>=15?1:this.pitch/15))),o}getWorldToCameraMatrix(){const e=this._camera.getWorldToCamera(this.worldSize,"meters"===this.projection.zAxisUnit?this.pixelsPerMeter:1);return"globe"===this.projection.name&&t.ad.multiply(e,e,this.globeMatrix),e}getFrustum(e){return t.aM.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,e,"meters"===this.projection.zAxisUnit)}}const gn={BaseColor:5,MetallicRoughness:6,Normal:7,Occlusion:8,Emission:9,LUT:10,ShadowMap0:11},_n=(e,n)=>{if(n>0&&e.terrain&&t.w("Cutoff is currently disabled on terrain"),n<=0||e.terrain)return{shouldRenderCutoff:!1,uniformValues:{u_cutoff_params:[0,0,0,1]}};const i=e.transform,a=Math.max(Math.abs(i._zoom-(e.minCutoffZoom-1)),1),r=i.isLODDisabled(!1)?t.$(60,45,i.pitch):t.$(30,15,i.pitch),o=i._farZ-i._nearZ,s=n*i.height,l=((1-(c=r))*i.cameraToCenterDistance+c*(i._farZ+s))*a;var c;return{shouldRenderCutoff:r<1,uniformValues:{u_cutoff_params:[i._nearZ,i._farZ,(l-i._nearZ)/o,(l-s-i._nearZ)/o]}}},yn={cascadeCount:2,shadowMapResolution:2048};class xn{constructor(t,e){this.aabb=t,this.lastCascade=e}}class vn{add(t,e){const n=this.receivers[t.key];void 0!==n?(n.aabb.min[0]=Math.min(n.aabb.min[0],e.min[0]),n.aabb.min[1]=Math.min(n.aabb.min[1],e.min[1]),n.aabb.min[2]=Math.min(n.aabb.min[2],e.min[2]),n.aabb.max[0]=Math.max(n.aabb.max[0],e.max[0]),n.aabb.max[1]=Math.max(n.aabb.max[1],e.max[1]),n.aabb.max[2]=Math.max(n.aabb.max[2],e.max[2])):this.receivers[t.key]=new xn(e,null)}clear(){this.receivers={}}get(t){return this.receivers[t.key]}computeRequiredCascades(e,n,i){const a=t.b6.fromPoints(e.points);let r=0;for(const e in this.receivers){const o=this.receivers[e];if(!o)continue;if(!a.intersectsAabb(o.aabb))continue;o.aabb.min=a.closestPoint(o.aabb.min),o.aabb.max=a.closestPoint(o.aabb.max);const s=o.aabb.getCorners();for(let e=0;e<i.length;e++){let a=!0;for(const r of s){const o=[r[0]*n,r[1]*n,r[2]];if(t._.transformMat4(o,o,i[e].matrix),o[0]<-1||o[0]>1||o[1]<-1||o[1]>1){a=!1;break}}if(o.lastCascade=e,r=Math.max(r,e),a)break}}return r+1}}class bn{constructor(e){this.painter=e,this._enabled=!1,this._shadowLayerCount=0,this._numCascadesToRender=0,this._cascades=[],this._groundShadowTiles=[],this._receivers=new vn,this._depthMode=new t.ae(e.context.gl.LEQUAL,t.ae.ReadWrite,[0,1]),this._uniformValues={u_light_matrix_0:new Float32Array(16),u_light_matrix_1:new Float32Array(16),u_shadow_intensity:0,u_fade_range:[0,0],u_shadow_normal_offset:[1,1,1],u_shadow_texel_size:1,u_shadow_map_resolution:1,u_shadow_direction:[0,0,1],u_shadow_bias:[36e-5,.0012,.012],u_shadowmap_0:0,u_shadowmap_1:0},this._forceDisable=!1,this.useNormalOffset=!1,e.tp.registerParameter(this,["Shadows"],"_forceDisable",{label:"forceDisable"},(()=>{this.painter.style.map.triggerRepaint()})),e.tp.registerParameter(yn,["Shadows"],"cascadeCount",{min:1,max:2,step:1}),e.tp.registerParameter(yn,["Shadows"],"shadowMapResolution",{min:32,max:2048,step:32}),e.tp.registerBinding(this,["Shadows"],"_numCascadesToRender",{readonly:!0,label:"numCascadesToRender"})}destroy(){for(const t of this._cascades)t.texture.destroy(),t.framebuffer.destroy();this._cascades=[]}updateShadowParameters(e,n){const i=this.painter;if(this._enabled=!1,this._shadowLayerCount=0,this._receivers.clear(),!n||!n.properties)return;const a=n.properties.get("shadow-intensity");if(!n.shadowsEnabled()||a<=0)return;if(this._shadowLayerCount=i.style.order.reduce(((t,n)=>{const a=i.style._mergedLayers[n];return t+(a.hasShadowPass()&&!a.isHidden(e.zoom)?1:0)}),0),this._enabled=this._shadowLayerCount>0,!this.enabled)return;const r=i.context,o=yn.shadowMapResolution,s=yn.shadowMapResolution;if(0===this._cascades.length||yn.shadowMapResolution!==this._cascades[0].texture.size[0]){this._cascades=[];for(let e=0;e<yn.cascadeCount;++e){const e=i._shadowMapDebug,n=r.gl,a=r.createFramebuffer(o,s,e,"texture"),l=new t.T(r,{width:o,height:s,data:null},n.DEPTH_COMPONENT);if(a.depthAttachment.set(l.texture),e){const e=new t.T(r,{width:o,height:s,data:null},n.RGBA);a.colorAttachment.set(e.texture)}this._cascades.push({framebuffer:a,texture:l,matrix:[],far:0,boundingSphereRadius:0,frustum:new t.aM,scale:0})}}this.shadowDirection=An(n);let l=0;if(e.elevation){const t=e.elevation,n=[1e4,-1e4];t.visibleDemTiles.filter((t=>t.dem)).forEach((t=>{const e=t.dem.tree;n[0]=Math.min(n[0],e.minimums[0]),n[1]=Math.max(n[1],e.maximums[0])})),1e4!==n[0]&&(l=(n[1]-n[0])*t.exaggeration())}const c=1.5*e.cameraToCenterDistance,u=3*c,h=new Float64Array(16);for(let n=0;n<this._cascades.length;++n){const i=this._cascades[n];let a=e.height/50,r=1;1===yn.cascadeCount?r=u:0===n?r=c:(a=c,r=u);const[o,s]=En(e,this.shadowDirection,a,r,yn.shadowMapResolution,l);i.scale=e.scale,i.matrix=o,i.boundingSphereRadius=s,t.ad.invert(h,i.matrix),i.frustum=t.aM.fromInvProjectionMatrix(h,1,0,!0),i.far=r}const d=this._cascades.length-1;this._uniformValues.u_fade_range=[.75*this._cascades[d].far,this._cascades[d].far],this._uniformValues.u_shadow_intensity=a,this._uniformValues.u_shadow_direction=[this.shadowDirection[0],this.shadowDirection[1],this.shadowDirection[2]],this._uniformValues.u_shadow_texel_size=1/yn.shadowMapResolution,this._uniformValues.u_shadow_map_resolution=yn.shadowMapResolution,this._uniformValues.u_shadowmap_0=gn.ShadowMap0,this._uniformValues.u_shadowmap_1=gn.ShadowMap0+1,this._groundShadowTiles=i.transform.coveringTiles({tileSize:512,renderWorldCopies:!0});const p=i.transform.elevation;for(const t of this._groundShadowTiles){let e={min:0,max:0};if(p){const n=p.getMinMaxForTile(t);n&&(e=n)}this.addShadowReceiver(t.toUnwrapped(),e.min,e.max)}}get enabled(){return this._enabled&&!this._forceDisable}set enabled(t){this._enabled=t}drawShadowPass(e,n){if(!this.enabled)return;const i=this.painter,a=i.context;this._numCascadesToRender=this._receivers.computeRequiredCascades(i.transform.getFrustum(0),i.transform.worldSize,this._cascades),a.viewport.set([0,0,yn.shadowMapResolution,yn.shadowMapResolution]);for(let r=0;r<this._numCascadesToRender;++r){i.currentShadowCascade=r,a.bindFramebuffer.set(this._cascades[r].framebuffer.framebuffer),a.clear({color:t.C.white,depth:1});for(const t of e.order){const a=e._mergedLayers[t];if(!a.hasShadowPass()||a.isHidden(i.transform.zoom))continue;const r=e.getLayerSourceCache(a),o=r?n[r.id]:void 0;("model"===a.type||o&&o.length)&&i.renderLayer(i,r,a,o)}}i.currentShadowCascade=0}drawGroundShadows(){if(!this.enabled)return;const e=this.painter,n=e.style,i=e.context,a=n.directionalLight,r=n.ambientLight;if(!a||!r)return;const o=[],s=_n(e,e.longestCutoffRange);s.shouldRenderCutoff&&o.push("RENDER_CUTOFF");const l=Cn(n,a,r),c=new t.ae(i.gl.LEQUAL,t.ae.ReadOnly,e.depthRangeFor3D);for(const n of this._groundShadowTiles){const a=n.toUnwrapped(),r=e.isTileAffectedByFog(n),u=e.getOrCreateProgram("groundShadow",{defines:o,overrideFog:r});this.setupShadows(a,u),e.uploadCommonUniforms(i,u,a,null,s);const h={u_matrix:e.transform.calculateProjMatrix(a),u_ground_shadow_factor:l};u.draw(e,i.gl.TRIANGLES,c,t.ag.disabled,t.a.multiply,t.af.disabled,h,"ground_shadow",e.tileExtentBuffer,e.quadTriangleIndexBuffer,e.tileExtentSegments,{},e.transform.zoom,null,null)}}getShadowPassColorMode(){return this.painter._shadowMapDebug?t.a.unblended:t.a.disabled}getShadowPassDepthMode(){return this._depthMode}getShadowCastingLayerCount(){return this._shadowLayerCount}calculateShadowPassMatrixFromTile(e){const n=this.painter.transform,i=n.calculatePosMatrix(e,n.worldSize);return t.ad.multiply(i,this._cascades[this.painter.currentShadowCascade].matrix,i),Float32Array.from(i)}calculateShadowPassMatrixFromMatrix(e){return t.ad.multiply(e,this._cascades[this.painter.currentShadowCascade].matrix,e),Float32Array.from(e)}setupShadows(e,n,i,a=0){if(!this.enabled)return;const r=this.painter.transform,o=this.painter.context,s=o.gl,l=this._uniformValues,c=new Float64Array(16),u=r.calculatePosMatrix(e,r.worldSize);for(let e=0;e<this._cascades.length;e++)t.ad.multiply(c,this._cascades[e].matrix,u),l[0===e?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(c),o.activeTexture.set(s.TEXTURE0+gn.ShadowMap0+e),this._cascades[e].texture.bind(s.NEAREST,s.CLAMP_TO_EDGE);if(this.useNormalOffset=!!i,this.useNormalOffset){const n=t.b5(e.canonical),o=2/r.tileSize*t.a3/yn.shadowMapResolution,s=o*this._cascades[0].boundingSphereRadius,c=o*this._cascades[this._cascades.length-1].boundingSphereRadius,u=("vector-tile"===i?1:3)/Math.pow(2,a-e.canonical.z-(1-r.zoom+Math.floor(r.zoom)));l.u_shadow_normal_offset=[n,s*u,c*u],l.u_shadow_bias=[6e-5,.0012,.012]}else l.u_shadow_bias=[36e-5,.0012,.012];n.setShadowUniformValues(o,l)}setupShadowsFromMatrix(e,n,i=!1){if(!this.enabled)return;const a=this.painter.context,r=a.gl,o=this._uniformValues,s=new Float64Array(16);for(let n=0;n<yn.cascadeCount;n++)t.ad.multiply(s,this._cascades[n].matrix,e),o[0===n?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(s),a.activeTexture.set(r.TEXTURE0+gn.ShadowMap0+n),this._cascades[n].texture.bind(r.NEAREST,r.CLAMP_TO_EDGE);if(this.useNormalOffset=i,i){const t=5;o.u_shadow_normal_offset=[1,t,t],o.u_shadow_bias=[6e-5,.0012,.012]}else o.u_shadow_bias=[36e-5,.0012,.012];n.setShadowUniformValues(a,o)}getShadowUniformValues(){return this._uniformValues}getCurrentCascadeFrustum(){return this._cascades[this.painter.currentShadowCascade].frustum}computeSimplifiedTileShadowVolume(e,n,i,a){if(a[2]>=0)return{};const r=function(e,n,i){const a=i/(1<<e.canonical.z);return new t.b6([e.canonical.x*a+e.wrap*i,e.canonical.y*a+e.wrap*i,0],[(e.canonical.x+1)*a+e.wrap*i,(e.canonical.y+1)*a+e.wrap*i,n])}(e,n,i).getCorners(),o=n/-a[2];a[0]<0?(t._.add(r[0],r[0],[a[0]*o,0,0]),t._.add(r[3],r[3],[a[0]*o,0,0])):a[0]>0&&(t._.add(r[1],r[1],[a[0]*o,0,0]),t._.add(r[2],r[2],[a[0]*o,0,0])),a[1]<0?(t._.add(r[0],r[0],[0,a[1]*o,0]),t._.add(r[1],r[1],[0,a[1]*o,0])):a[1]>0&&(t._.add(r[2],r[2],[0,a[1]*o,0]),t._.add(r[3],r[3],[0,a[1]*o,0]));const s={};return s.vertices=r,s.planes=[wn(r[1],r[0],r[4]),wn(r[2],r[1],r[5]),wn(r[3],r[2],r[6]),wn(r[0],r[3],r[7])],s}addShadowReceiver(e,n,i){this._receivers.add(e,t.b6.fromTileIdAndHeight(e,n,i))}getMaxCascadeForTile(t){const e=this._receivers.get(t);return e&&e.lastCascade?e.lastCascade:0}}function wn(e,n,i){const a=t._.sub([],i,n),r=t._.sub([],e,n),o=t._.cross([],a,r),s=t._.length(o);return 0===s?[0,0,1,0]:(t._.scale(o,o,1/s),[o[0],o[1],o[2],-t._.dot(o,n)])}function An(e){const n=e.properties.get("direction"),i=t.ac(n.x,n.y,n.z);i[2]=t.at(i[2],0,75);const a=t.b7([i[0],i[1],i[2]]);return t._.fromValues(a.x,a.y,a.z)}function Cn(e,n,i){const a=n.properties.get("color"),r=n.properties.get("intensity"),o=n.properties.get("direction"),s=[o.x,o.y,o.z],l=i.properties.get("color"),c=i.properties.get("intensity"),u=Math.max(t._.dot([0,0,1],s),0),h=[0,0,0];t._.scale(h,l.toRenderColor(e.getLut(n.scope)).toArray01Linear().slice(0,3),c);const d=[0,0,0];return t._.scale(d,a.toRenderColor(e.getLut(i.scope)).toArray01Linear().slice(0,3),u*r),t.b8([h[0]>0?h[0]/(h[0]+d[0]):0,h[1]>0?h[1]/(h[1]+d[1]):0,h[2]>0?h[2]/(h[2]+d[2]):0])}function En(e,n,i,a,r,o){const s=e.zoom,l=e.scale,c=e.worldSize,u=1/c,h=e.aspect,d=Math.sqrt(1+h*h)*Math.tan(.5*e.fovX),p=d*d,f=a-i,m=a+i;let g,_;p>f/m?(g=a,_=a*d):(g=.5*m*(1+p),_=.5*Math.sqrt(f*f+2*(a*a+i*i)*p+m*m*p*p));const y=e.projection.pixelsPerMeter(e.center.lat,c),x=e._camera.getCameraToWorldMercator(),v=[0,0,-g*u];t._.transformMat4(v,v,x);let b=_*u;const w=e._edgeInsets;if(!(0===w.left&&0===w.top&&0===w.right&&0===w.bottom||w.left===w.right&&w.top===w.bottom)){const n=e._camera.getWorldToCamera(e.worldSize,"meters"===e.projection.zAxisUnit?y:1),r=e._camera.getCameraToClipPerspective(e._fov,e.width/e.height,i,a);r[8]=2*-e.centerOffset.x/e.width,r[9]=2*e.centerOffset.y/e.height;const o=new Float64Array(16);t.ad.mul(o,r,n);const u=new Float64Array(16);t.ad.invert(u,o);const h=t.aM.fromInvProjectionMatrix(u,c,s,!0);for(const n of h.points){const i=((A=n)[0]/=l,A[1]/=l,A[2]=t.ax(A[2],e._center.lat),A);b=Math.max(b,t._.len(t._.subtract([],v,i)))}}var A;b*=r/(r-1);const C=Math.acos(n[2]),E=Math.atan2(-n[0],-n[1]),T=new Ze;T.position=v,T.setPitchBearing(C,E);const S=T.getWorldToCamera(c,y),M=b*c,k=Math.min(e._mercatorZfromZoom(17)*c*-2,-2*M),I=T.getCameraToClipOrthographic(-M,M,-M,M,k,(M+o*y)/n[2]),P=new Float64Array(16);t.ad.multiply(P,I,S);const z=t._.fromValues(Math.floor(1e6*v[0])/1e6*c,Math.floor(1e6*v[1])/1e6*c,0),D=.5*r,L=[0,0,0];t._.transformMat4(L,z,P),t._.scale(L,L,D);const B=[Math.floor(L[0]),Math.floor(L[1]),Math.floor(L[2])],O=[0,0,0];t._.sub(O,L,B),t._.scale(O,O,-1/D);const R=new Float64Array(16);return t.ad.identity(R),t.ad.translate(R,R,O),t.ad.multiply(P,R,P),[P,M]}function Tn(t,e){return null!=t&&null!=e&&!(!t.hasData()||!e.hasData())&&null!=t.demTexture&&null!=e.demTexture&&t.tileID.key!==e.tileID.key}const Sn=new class{constructor(){this.operations={}}newMorphing(t,e,n,i,a){if(t in this.operations){const e=this.operations[t];e.to.tileID.key!==n.tileID.key&&(e.queued=n)}else this.operations[t]={startTime:i,phase:0,duration:a,from:e,to:n,queued:null}}getMorphValuesForProxy(t){if(!(t in this.operations))return null;const e=this.operations[t];return{from:e.from,to:e.to,phase:e.phase}}update(t){for(const e in this.operations){const n=this.operations[e];for(n.phase=(t-n.startTime)/n.duration;n.phase>=1||!this._validOp(n);)if(!this._nextOp(n,t)){delete this.operations[e];break}}}_nextOp(t,e){return!!t.queued&&(t.from=t.to,t.to=t.queued,t.queued=null,t.phase=0,t.startTime=e,!0)}_validOp(t){return t.from.hasData()&&t.to.hasData()}},Mn={0:null,1:"TERRAIN_VERTEX_MORPHING"};function kn(t,e,n){if(0===e)return 0;const i=e<1&&514===n?.25/e:1;return 6*Math.pow(1.5,22-t)*Math.max(e,1)*i}function In(t,e){const n=1<<t.z;return!e&&(0===t.x||t.x===n-1)||0===t.y||t.y===n-1}const Pn=t=>({u_matrix:t});function zn(e,n,i,a,r){if(r>0){const o=t.e.now(),s=(o-e.timeAdded)/r,l=n?(o-n.timeAdded)/r:-1,c=i.getSource(),u=a.coveringZoomLevel({tileSize:c.tileSize,roundZoom:c.roundZoom}),h=!n||Math.abs(n.tileID.overscaledZ-u)>Math.abs(e.tileID.overscaledZ-u),d=h&&e.refreshedUponExpiration?1:t.at(h?s:1-l,0,1);return e.refreshedUponExpiration&&s>=1&&(e.refreshedUponExpiration=!1),n?{opacity:1,mix:1-d}:{opacity:d,mix:0}}return{opacity:1,mix:0}}class Dn extends Fe{constructor(e,n,i,a){super(e,n,i,a),this.type="raster-array",this.maxzoom=22,this._options=t.W({type:"raster-array"},n)}triggerRepaint(t){const e=this.map.painter._terrain,n=this.map.style.getSourceCache(this.id);e&&e.enabled&&n&&e._clearRenderCacheForTile(n.id,t.tileID),this.map.triggerRepaint()}loadTile(e,n){const i=this.map._requestManager.normalizeTileURL(e.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize),a=this.map._requestManager.transformRequest(i,t.R.Tile);e.requestParams=a,e.actor||(e.actor=this.dispatcher.getActor()),e.request=e.fetchHeader(void 0,((t,i,a,r)=>{if(delete e.request,e.aborted)return e.state="unloaded",n(null);if(t){if(20===t.code)return;return e.state="errored",n(t)}this.map._refreshExpiredTiles&&e.setExpiryData({cacheControl:a,expires:r}),e.state="empty",n(null)}))}unloadTile(e,n){const i=e.texture;i&&i instanceof t.T?(e.destroy(!0),this.map.painter.saveTileTexture(i)):(e.destroy(),e.flushQueues(),e._isHeaderLoaded=!1,delete e._mrt,delete e.textureDescriptor),e.fbo&&(e.fbo.destroy(),delete e.fbo),delete e.request,delete e.requestParams,delete e.neighboringTiles,e.state="unloaded"}prepareTile(e,n,i){e._isHeaderLoaded&&("empty"!==e.state&&(e.state="reloading"),e.fetchBand(n,i,((n,i)=>{if(n)return e.state="errored",this.fire(new t.d(n)),void this.triggerRepaint(e);i&&(e.setTexture(i,this.map.painter),e.state="loaded",this.triggerRepaint(e))})))}getInitialBand(t){if(!this.rasterLayers)return 0;const e=this.rasterLayers.find((({id:e})=>e===t)),n=e&&e.fields,i=n&&n.bands&&n.bands;return i?i[0]:0}getTextureDescriptor(e,n,i){if(!e)return;const a=n.sourceLayer||this.rasterLayerIds&&this.rasterLayerIds[0];if(!a)return;let r=null;n instanceof t.bk?r=n.paint.get("raster-array-band"):n instanceof t.bl&&(r=n.paint.get("raster-particle-array-band"));const o=r||this.getInitialBand(a);if(null!=o)if(e.textureDescriptor){if(!e.updateNeeded(a,o)||i)return Object.assign({},e.textureDescriptor,{texture:e.texture})}else this.prepareTile(e,a,o)}}const Ln={vector:Ne,raster:Fe,"raster-dem":class extends Fe{constructor(e,n,i,a){super(e,n,i,a),this.type="raster-dem",this.maxzoom=22,this._options=t.W({type:"raster-dem"},n),this.encoding=n.encoding||"mapbox"}loadTile(e,n){const i=this.map._requestManager.normalizeTileURL(e.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function a(t,i){t&&(e.state="errored",n(t)),i&&(e.dem=i,e.dem.onDeserialize(),e.needsHillshadePrepare=!0,e.needsDEMTextureUpload=!0,e.state="loaded",n(null))}e.request=t.h(this.map._requestManager.transformRequest(i,t.R.Tile),function(i,r,o,s){if(delete e.request,e.aborted)e.state="unloaded",n(null);else if(i)e.state="errored",n(i);else if(r){this.map._refreshExpiredTiles&&e.setExpiryData({cacheControl:o,expires:s});const n=ImageBitmap&&r instanceof ImageBitmap&&t.bi(),i=1-(r.width-t.bj(r.width))/2;i<1||e.neighboringTiles||(e.neighboringTiles=this._getNeighboringTiles(e.tileID));const l=n?r:t.e.getImageData(r,i),c={uid:e.uid,coord:e.tileID,source:this.id,scope:this.scope,rawImageData:l,encoding:this.encoding,padding:i};e.actor&&"expired"!==e.state||(e.actor=this.dispatcher.getActor(),e.actor.send("loadDEMTile",c,a.bind(this),void 0,!0))}}.bind(this))}_getNeighboringTiles(e){const n=e.canonical,i=Math.pow(2,n.z),a=(n.x-1+i)%i,r=0===n.x?e.wrap-1:e.wrap,o=(n.x+1+i)%i,s=n.x+1===i?e.wrap+1:e.wrap,l={};return l[new t.aL(e.overscaledZ,r,n.z,a,n.y).key]={backfilled:!1},l[new t.aL(e.overscaledZ,s,n.z,o,n.y).key]={backfilled:!1},n.y>0&&(l[new t.aL(e.overscaledZ,r,n.z,a,n.y-1).key]={backfilled:!1},l[new t.aL(e.overscaledZ,e.wrap,n.z,n.x,n.y-1).key]={backfilled:!1},l[new t.aL(e.overscaledZ,s,n.z,o,n.y-1).key]={backfilled:!1}),n.y+1<i&&(l[new t.aL(e.overscaledZ,r,n.z,a,n.y+1).key]={backfilled:!1},l[new t.aL(e.overscaledZ,e.wrap,n.z,n.x,n.y+1).key]={backfilled:!1},l[new t.aL(e.overscaledZ,s,n.z,o,n.y+1).key]={backfilled:!1}),l}},"raster-array":Dn,geojson:class extends t.E{constructor(e,n,i,a){super(),this.id=e,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=i.getActor(),this.setEventedParent(a),this._data=n.data,this._options=t.W({},n),this._collectResourceTiming=n.collectResourceTiming,void 0!==n.maxzoom&&(this.maxzoom=n.maxzoom),void 0!==n.minzoom&&(this.minzoom=n.minzoom),n.type&&(this.type=n.type),n.attribution&&(this.attribution=n.attribution),this.promoteId=n.promoteId;const r=t.a3/this.tileSize;this.workerOptions=t.W({source:this.id,scope:this.scope,cluster:n.cluster||!1,geojsonVtOptions:{buffer:(void 0!==n.buffer?n.buffer:128)*r,tolerance:(void 0!==n.tolerance?n.tolerance:.375)*r,extent:t.a3,maxZoom:this.maxzoom,lineMetrics:n.lineMetrics||!1,generateId:n.generateId||!1},superclusterOptions:{maxZoom:void 0!==n.clusterMaxZoom?n.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,n.clusterMinPoints||2),extent:t.a3,radius:(void 0!==n.clusterRadius?n.clusterRadius:50)*r,log:!1,generateId:n.generateId||!1},clusterProperties:n.clusterProperties,filter:n.filter,dynamic:n.dynamic},n.workerOptions)}onAdd(t){this.map=t,this.setData(this._data)}setData(t){return this._data=t,this._updateWorkerData(),this}updateData(e){return this._options.dynamic?"string"!=typeof e&&("Feature"===e.type&&(e={type:"FeatureCollection",features:[e]}),"FeatureCollection"!==e.type)?this.fire(new t.d(new Error("Data to update should be a feature or a feature collection."))):(this._coalesce&&"string"!=typeof e&&"string"!=typeof this._data&&"FeatureCollection"===this._data.type?this._data.features.push(...e.features):this._data=e,this._updateWorkerData(!0),this):this.fire(new t.d(new Error("Can't call updateData on a GeoJSON source with dynamic set to false.")))}getClusterExpansionZoom(t,e){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:t,source:this.id,scope:this.scope},e),this}getClusterChildren(t,e){return this.actor.send("geojson.getClusterChildren",{clusterId:t,source:this.id,scope:this.scope},e),this}getClusterLeaves(t,e,n,i){return this.actor.send("geojson.getClusterLeaves",{source:this.id,scope:this.scope,clusterId:t,limit:e,offset:n},i),this}_updateWorkerData(e=!1){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new t.f("dataloading",{dataType:"source"})),this._loaded=!1;const n=t.W({append:e},this.workerOptions);n.scope=this.scope;const i=this._data;"string"==typeof i?(n.request=this.map._requestManager.transformRequest(t.e.resolveURL(i),t.R.Source),n.request.collectResourceTiming=this._collectResourceTiming):n.data=JSON.stringify(i),this._pendingLoad=this.actor.send(`${this.type}.loadData`,n,((n,i)=>{if(this._loaded=!0,this._pendingLoad=null,n)this.fire(new t.d(n));else{const n={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&i&&i.resourceTiming&&i.resourceTiming[this.id]&&(n.resourceTiming=i.resourceTiming[this.id]),e&&(this._partialReload=!0),this.fire(new t.f("data",n)),this._partialReload=!1,this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(e),this._coalesce=!1)}))}loaded(){return this._loaded}loadTile(e,n){const i=e.actor?"reloadTile":"loadTile";e.actor=this.actor;const a=this.map.style?this.map.style.getLut(this.scope):null,r=this._partialReload,o={type:this.type,uid:e.uid,tileID:e.tileID,tileZoom:e.tileZoom,zoom:e.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,lut:a?{image:a.image.clone()}:null,scope:this.scope,pixelRatio:t.e.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,brightness:this.map.style&&this.map.style.getBrightness()||0,partial:r};e.request=this.actor.send(i,o,((t,a)=>r&&!a?(e.state="loaded",n(null)):(delete e.request,e.destroy(),e.aborted?n(null):t?n(t):(e.loadVectorData(a,this.map.painter,"reloadTile"===i),n(null)))),void 0,"loadTile"===i)}abortTile(t){t.request&&(t.request.cancel(),delete t.request),t.aborted=!0}unloadTile(t,e){this.actor.send("removeTile",{uid:t.uid,type:this.type,source:this.id,scope:this.scope}),t.destroy()}onRemove(t){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return t.W({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends t.bm{constructor(t,e,n,i){super(t,e,n,i),this.roundZoom=!0,this.type="video",this.options=e}load(){this._loaded=!1;const e=this.options;this.urls=[];for(const n of e.urls)this.urls.push(this.map._requestManager.transformRequest(n,t.R.Source).url);t.bn(this.urls,((e,n)=>{this._loaded=!0,e?this.fire(new t.d(e)):n&&(this.video=n,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",(()=>{this.map.triggerRepaint()})),this.map&&this.video.play(),this._finishLoading())}))}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(e){if(this.video){const n=this.video.seekable;e<n.start(0)||e>n.end(0)?this.fire(new t.d(new t.V(`sources.${this.id}`,null,`Playback for this video can be set only between the ${n.start(0)} and ${n.end(0)}-second mark.`))):this.video.currentTime=e}}getVideo(){return this.video}onAdd(t){this.map||(this.map=t,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(0===Object.keys(this.tiles).length||this.video.readyState<2)return;const e=this.map.painter.context,n=e.gl;this.texture?this.video.paused||(this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE),n.texSubImage2D(n.TEXTURE_2D,0,0,0,n.RGBA,n.UNSIGNED_BYTE,this.video)):(this.texture=new t.T(e,this.video,n.RGBA),this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(e)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:t.bm,model:class extends t.E{constructor(t,e,n,i){super(),this.id=t,this.type="model",this.models=[],this._loaded=!1,this._options=e}load(){const e=[];for(const n in this._options.models){const i=this._options.models[n],a=t.l(this.map._requestManager.transformRequest(i.uri,t.R.Model).url).then((e=>{if(!e)return;const a=t.c(e),r=new t.M(n,i.position,i.orientation,a);r.computeBoundsAndApplyParent(),this.models.push(r)})).catch((e=>{this.fire(new t.d(new Error(`Could not load model ${n} from ${i.uri}: ${e.message}`)))}));e.push(a)}return Promise.allSettled(e).then((()=>{this._loaded=!0,this.fire(new t.f("data",{dataType:"source",sourceDataType:"metadata"}))})).catch((e=>{this.fire(new t.d(new Error(`Could not load models: ${e.message}`)))}))}onAdd(t){this.map=t,this.load()}hasTransition(){return!1}loaded(){return this._loaded}getModels(){return this.models}loadTile(t,e){}serialize(){return{type:"model"}}},"batched-model":class extends t.E{constructor(t,e,n,i){super(),this.type="batched-model",this.id=t,this.tileSize=512,this._options=e,this.tiles=this._options.tiles,this.maxzoom=e.maxzoom||19,this.minzoom=e.minzoom||0,this.roundZoom=!0,this.usedInConflation=!0,this.dispatcher=n,this.reparseOverscaled=!1,this.scheme="xyz",this._loaded=!1,this.setEventedParent(i)}onAdd(t){this.map=t,this.load()}load(e){this._loaded=!1,this.fire(new t.f("dataloading",{dataType:"source"}));const n=Array.isArray(this.map._language)?this.map._language.join():this.map._language,i=this.map._worldview;this._tileJSONRequest=Oe(this._options,this.map._requestManager,n,i,((a,r)=>{this._tileJSONRequest=null,this._loaded=!0,a?(n&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${n}`),i&&2!==i.length&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${i}`),this.fire(new t.d(a))):r&&(t.W(this,r),r.bounds&&(this.tileBounds=new Re(r.bounds,this.minzoom,this.maxzoom)),t.an(r.tiles,this.map._requestManager._customAccessToken),this.fire(new t.f("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new t.f("data",{dataType:"source",sourceDataType:"content"}))),e&&e(a)}))}hasTransition(){return!1}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}loaded(){return this._loaded}loadTile(e,n){const i=this.map._requestManager.normalizeTileURL(e.tileID.canonical.url(this.tiles,this.scheme)),a={request:this.map._requestManager.transformRequest(i,t.R.Tile),data:void 0,uid:e.uid,tileID:e.tileID,tileZoom:e.tileZoom,zoom:e.tileID.overscaledZ,tileSize:this.tileSize*e.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,showCollisionBoxes:this.map.showCollisionBoxes,isSymbolTile:e.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0};if(e.actor&&"expired"!==e.state)if("loading"===e.state)e.reloadCallback=n;else{if(e.buckets){const t=Object.values(e.buckets);for(const e of t)e.dirty=!0;return void(e.state="loaded")}e.request=e.actor.send("reloadTile",a,r.bind(this))}else e.actor=this.dispatcher.getActor(),e.request=e.actor.send("loadTile",a,r.bind(this),void 0,!0);function r(t,i){return e.aborted?n(null):t&&404!==t.status?n(t):(i&&(i.resourceTiming&&(e.resourceTiming=i.resourceTiming),this.map._refreshExpiredTiles&&e.setExpiryData(i),e.buckets={...e.buckets,...i.buckets},i.featureIndex&&(e.latestFeatureIndex=i.featureIndex)),e.state="loaded",void n(null))}}serialize(){return t.W({},this._options)}},canvas:class extends t.bm{constructor(e,n,i,a){super(e,n,i,a),n.coordinates?Array.isArray(n.coordinates)&&4===n.coordinates.length&&!n.coordinates.some((t=>!Array.isArray(t)||2!==t.length||t.some((t=>"number"!=typeof t))))||this.fire(new t.d(new t.V(`sources.${e}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new t.d(new t.V(`sources.${e}`,null,'missing required property "coordinates"'))),n.animate&&"boolean"!=typeof n.animate&&this.fire(new t.d(new t.V(`sources.${e}`,null,'optional "animate" property must be a boolean value'))),n.canvas?"string"==typeof n.canvas||n.canvas instanceof HTMLCanvasElement||this.fire(new t.d(new t.V(`sources.${e}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new t.d(new t.V(`sources.${e}`,null,'missing required property "canvas"'))),this.options=n,this.animate=void 0===n.animate||n.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new t.d(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(t){this.map=t,this.load(),this.canvas&&this.animate&&this.play()}onRemove(t){this.pause()}prepare(){let e=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,e=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,e=!0),this._hasInvalidDimensions())return;if(0===Object.keys(this.tiles).length)return;const n=this.map.painter.context;this.texture?!e&&!this._playing||this.texture instanceof t.bo||this.texture.update(this.canvas,{premultiply:!0}):this.texture=new t.T(n,this.canvas,n.gl.RGBA,{premultiply:!0}),this._prepareData(n)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const t of[this.canvas.width,this.canvas.height])if(isNaN(t)||t<=0)return!0;return!1}},custom:class extends t.E{constructor(e,n,i,a){super(),this.id=e,this.type="custom",this._dataType="raster",this._dispatcher=i,this._implementation=n,this.setEventedParent(a),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new t.d(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new t.d(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new Re(this._implementation.bounds,this.minzoom,this.maxzoom)),n.update=this._update.bind(this),n.clearTiles=this._clearTiles.bind(this),n.coveringTiles=this._coveringTiles.bind(this),t.W(this,t.ah(n,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return t.ah(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new t.f("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new t.f("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(e){this._map=e,this._loaded=!1,this.fire(new t.f("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(e),this.load()}onRemove(t){this._implementation.onRemove&&this._implementation.onRemove(t)}hasTile(t){if(this._implementation.hasTile){const{x:e,y:n,z:i}=t.canonical;return this._implementation.hasTile({x:e,y:n,z:i})}return!this.tileBounds||this.tileBounds.contains(t.canonical)}loadTile(t,e){const{x:n,y:i,z:a}=t.tileID.canonical,r=new AbortController;t.request=Promise.resolve(this._implementation.loadTile({x:n,y:i,z:a},{signal:r.signal})).then(function(n){return delete t.request,t.aborted?(t.state="unloaded",e(null)):void 0===n?(t.state="errored",e(null)):null===n?(this.loadTileData(t,{width:this.tileSize,height:this.tileSize,data:null}),t.state="loaded",e(null)):function(t){return t instanceof ImageData||t instanceof HTMLCanvasElement||t instanceof ImageBitmap||t instanceof HTMLImageElement}(n)?(this.loadTileData(t,n),t.state="loaded",void e(null)):(t.state="errored",e(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)))}.bind(this)).catch((n=>{20!==n.code&&(t.state="errored",e(n))})),t.request.cancel=()=>r.abort()}loadTileData(t,e){t.setTexture(e,this._map.painter)}unloadTile(e,n){if(e.texture&&e.texture instanceof t.T?(e.destroy(!0),e.texture&&e.texture instanceof t.T&&this._map.painter.saveTileTexture(e.texture)):e.destroy(),this._implementation.unloadTile){const{x:t,y:n,z:i}=e.tileID.canonical;this._implementation.unloadTile({x:t,y:n,z:i})}n&&n()}abortTile(t,e){t.request&&t.request.cancel&&(t.request.cancel(),delete t.request),e&&e()}hasTransition(){return!1}_coveringTiles(){return this._map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map((t=>({x:t.canonical.x,y:t.canonical.y,z:t.canonical.z})))}_clearTiles(){const e=t.al(this.id,this.scope);this._map.style.clearSource(e)}_update(){this.fire(new t.f("data",{dataType:"source",sourceDataType:"content"}))}}},Bn=function(e,n,i,a){const r=new Ln[n.type](e,n,i,a);if(r.id!==e)throw new Error(`Expected Source id to be ${e} instead of ${r.id}`);return t.bp(["load","abort","unload","serialize","prepare"],r),r};class On extends t.bv{constructor(e){const n={type:"raster-dem",maxzoom:e.transform.maxZoom},i=new t.bw(t.bx(),null),a=Bn("mock-dem",n,i,e.style);super("mock-dem",a,!1),a.setEventedParent(this),this._sourceLoaded=!0}_loadTile(t,e){t.state="loaded",e(null)}}class Rn extends t.bv{constructor(e){const n=Bn("proxy",{type:"geojson",maxzoom:e.transform.maxZoom},new t.bw(t.bx(),null),e.style);super("proxy",n,!1),n.setEventedParent(this),this.map=this.getSource().map=e,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(e,n,i){if(e.freezeTileCoverage)return;this.transform=e;const a=e.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce(((n,i)=>{if(n[i.key]="",!this._tiles[i.key]){const n=new t.by(i,this._source.tileSize*i.overscaleFactor(),e.tileZoom);n.state="loaded",this._tiles[i.key]=n}return n}),{});for(const t in this._tiles)t in a||(this.freeFBO(t),this._tiles[t].unloadVectorData(),delete this._tiles[t])}freeFBO(t){const e=this.proxyCachedFBO[t];if(void 0!==e){const n=Object.values(e);this.renderCachePool.push(...n),delete this.proxyCachedFBO[t]}}deallocRenderCache(){this.renderCache.forEach((t=>t.fb.destroy())),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class Fn extends t.aL{constructor(t,e,n){super(t.overscaledZ,t.wrap,t.canonical.z,t.canonical.x,t.canonical.y),this.proxyTileKey=e,this.projMatrix=n}}class Nn extends t.bq{constructor(e,n){super(),this._debugParams={sortTilesHiZFirst:!0,disableRenderCache:!1},e.tp.registerParameter(this._debugParams,["Terrain"],"sortTilesHiZFirst",{},(()=>{this._style.map.triggerRepaint()})),e.tp.registerParameter(this._debugParams,["Terrain"],"disableRenderCache",{},(()=>{this._style.map.triggerRepaint()})),e.tp.registerButton(["Terrain"],"Invalidate Render Cache",(()=>{this.invalidateRenderCache=!0,this._style.map.triggerRepaint()})),this.painter=e,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[i,a,r]=function(e){const n=new t.bt,i=new t.bu,a=131;n.reserve(17161),i.reserve(33800);const r=t.a3/128,o=t.a3+r/2,s=o+r;for(let e=-r;e<s;e+=r)for(let i=-r;i<s;i+=r){const a=i<0||i>o||e<0||e>o?24575:0,r=t.at(Math.round(i),0,t.a3),s=t.at(Math.round(e),0,t.a3);n.emplaceBack(r+a,s)}const l=(t,e)=>{const n=e*a+t;i.emplaceBack(n+1,n,n+a),i.emplaceBack(n+a,n+a+1,n+1)};for(let t=1;t<129;t++)for(let e=1;e<129;e++)l(e,t);return[0,129].forEach((t=>{for(let e=0;e<130;e++)l(e,t),l(t,e)})),[n,i,32768]}(),o=e.context;this.gridBuffer=o.createVertexBuffer(i,t.br.members),this.gridIndexBuffer=o.createIndexBuffer(a),this.gridSegments=t.b.simpleSegment(0,0,i.length,a.length),this.gridNoSkirtSegments=t.b.simpleSegment(0,0,i.length,r),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new Rn(n.map),this.orthoMatrix=t.ad.create(),t.ad.ortho(this.orthoMatrix,"globe"===this.painter.transform.projection.name?.015:0,t.a3,0,t.a3,0,1);const s=o.gl;this._overlapStencilMode=new t.ag({func:s.GEQUAL,mask:255},0,255,s.KEEP,s.KEEP,s.REPLACE),this._previousZoom=e.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=n,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new On(n.map),this._pendingGroundEffectLayers=[]}set style(t){t.on("data",this._onStyleDataEvent.bind(this)),this._style=t,this._style.map.on("moveend",(()=>{this._clearLineLayersFromRenderCache()}))}update(e,n,i){if(e&&e.terrain){this._style!==e&&(this.style=e,this._evaluationZoom=void 0);const a=e.terrain.properties,r=0===e.terrain.drapeRenderMode,o=e.terrain.isZoomDependent();this._previousUpdateTimestamp=this.enabled?this._updateTimestamp:void 0,this._updateTimestamp=t.e.now();const s=e.terrain&&e.terrain.scope,l=a.get("source"),c=r?this._mockSourceCache:e.getSourceCache(l,s);if(!c)return void t.w(`Couldn't find terrain source "${l}".`);if(this.sourceCache=c,this._exaggeration=o?this.calculateExaggeration(n):a.get("exaggeration"),!n.projection.requiresDraping&&o&&0===this._exaggeration)return void this._disable();this.enabled=!0;const u=()=>{this.sourceCache.used&&t.w(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.\nThis leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const e=this.getScaledDemTileSize();this.sourceCache.update(n,e,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,u(),this._initializing=!0),u(),n.updateElevation(!0,i),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(n),this._emptyDEMTextureDirty=!0,this._previousZoom=n.zoom}else this._disable()}calculateExaggeration(e){const n=this._previousCameraAltitude,i=e.getFreeCameraOptions().position.z/e.pixelsPerMeter*e.worldSize;this._previousCameraAltitude=i;const a=null!=n?i-n:Number.MAX_VALUE;if(Math.abs(a)<2)return this._exaggeration;const r=e.zoom,o=this._style.terrain;if(!this._previousUpdateTimestamp)return o.getExaggeration(r);let s=r-this._previousZoom;const l=this._previousUpdateTimestamp;let c=r;null!=this._evaluationZoom&&(c=this._evaluationZoom,Math.abs(r-c)>.5&&(s=.5*(r-c+s)),s*a<0&&(c+=s)),this._evaluationZoom=c;const u=o.getExaggeration(c),h=u===o.getExaggeration(Math.max(0,c-.1));if(h&&Math.abs(u-this._exaggeration)<.01)return u;let d=Math.min(.1,.00375*(this._updateTimestamp-l));return(h||u<.1||Math.abs(s)<1e-4)&&(d=Math.min(.2,4*d)),t.a2(this._exaggeration,u,d)}resetTileLookupCache(t){this._findCoveringTileCache[t]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_onStyleDataEvent(t){t.coord&&"source"===t.dataType?this._clearRenderCacheForTile(t.sourceCacheId,t.coord):"style"===t.dataType&&(this.invalidateRenderCache=!0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this._previousCameraAltitude=void 0)}_disable(){if(this.enabled&&(this.enabled=!1,this._emptyDEMTextureDirty=!0,this._sharedDepthStencil=void 0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const t in this._style._mergedSourceCaches)this._style._mergedSourceCaches[t].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this._emptyDepthBufferTexture&&this._emptyDepthBufferTexture.destroy(),this.pool.forEach((t=>t.fb.destroy())),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),this.framebufferCopyTexture&&this.framebufferCopyTexture.destroy()}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this.enabled?this._exaggeration:0}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const t=2*this.proxySourceCache.getSource().tileSize;return[t,t]}set useVertexMorphing(t){this._useVertexMorphing=t}updateTileBinding(e){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const n=this.proxySourceCache,i=this.painter.transform;this._initializing&&(this._initializing=0===i._centerAltitude&&-1===this.getAtPointOrZero(t.Y.fromLngLat(i.center),-1),this._emptyDEMTextureDirty=!this._initializing);const a=this.proxyCoords=n.getIds().map((t=>{const e=n.getTileByID(t).tileID;return e.projMatrix=i.calculateProjMatrix(e.toUnwrapped()),e}));!function(e,n){const i=n.transform.pointCoordinate(n.transform.getCameraPoint()),a=new t.P(i.x,i.y);e.sort(((e,n)=>{if(n.overscaledZ-e.overscaledZ)return n.overscaledZ-e.overscaledZ;const i=new t.P(e.canonical.x+(1<<e.canonical.z)*e.wrap,e.canonical.y),r=new t.P(n.canonical.x+(1<<n.canonical.z)*n.wrap,n.canonical.y),o=a.mult(1<<e.canonical.z);return o.x-=.5,o.y-=.5,o.distSqr(i)-o.distSqr(r)}))}(a,this.painter);const r=this.proxyToSource||{};this.proxyToSource={},a.forEach((t=>{this.proxyToSource[t.key]={}})),this.terrainTileForTile={};const o=this._style._mergedSourceCaches;for(const t in o){const n=o[t];if(!n.used)continue;if(n!==this.sourceCache&&this.resetTileLookupCache(n.id),this._setupProxiedCoordsForOrtho(n,e[t],r),n.usedForTerrain)continue;const i=e[t];n.getSource().reparseOverscaled&&this._assignTerrainTiles(i)}this.proxiedCoords[n.id]=a.map((t=>new Fn(t,t.key,this.orthoMatrix))),this._assignTerrainTiles(a),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(r),this.renderingToTexture=!1;const s={};this._visibleDemTiles=[];for(const t of this.proxyCoords){const e=this.terrainTileForTile[t.key];if(!e)continue;const n=e.tileID.key;n in s||(this._visibleDemTiles.push(e),s[n]=n)}}_assignTerrainTiles(t){this._initializing||t.forEach((t=>{if(this.terrainTileForTile[t.key])return;const e=this._findTileCoveringTileID(t,this.sourceCache);e&&(this.terrainTileForTile[t.key]=e)}))}_prepareDEMTextures(){const t=this.painter.context,e=t.gl;for(const n in this.terrainTileForTile){const i=this.terrainTileForTile[n],a=i.dem;!a||i.demTexture&&!i.needsDEMTextureUpload||(t.activeTexture.set(e.TEXTURE1),Le(this.painter,i,a))}}_prepareDemTileUniforms(t,e,n,i){if(!e||null==e.demTexture)return!1;const a=t.tileID.canonical,r=Math.pow(2,e.tileID.canonical.z-a.z),o=i||"";return n[`u_dem_tl${o}`]=[a.x*r%1,a.y*r%1],n[`u_dem_scale${o}`]=r,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}get emptyDepthBufferTexture(){const e=this.painter.context,n=e.gl;if(!this._emptyDepthBufferTexture){const i=new t.i({width:1,height:1},Uint8Array.of(255,255,255,255));this._emptyDepthBufferTexture=new t.T(e,i,n.RGBA,{premultiply:!1})}return this._emptyDepthBufferTexture}_getLoadedAreaMinimum(){if(!this.enabled)return 0;let t=0;const e=this._visibleDemTiles.reduce(((e,n)=>{if(!n.dem)return e;const i=n.dem.tree.minimums[0];return i>0&&t++,e+i}),0);return t?e/t:0}_updateEmptyDEMTexture(){const e=this.painter.context,n=e.gl;e.activeTexture.set(n.TEXTURE2);const i=this._getLoadedAreaMinimum(),[a,r]=(()=>{const e=new t.bz({width:1,height:1},new Float32Array([i]));return[n.R32F,e]})();this._emptyDEMTextureDirty=!1;let o=this._emptyDEMTexture;return o?o.update(r,{premultiply:!1}):o=this._emptyDEMTexture=new t.T(e,r,a,{premultiply:!1}),o}setupElevationDraw(e,n,i){const a=this.painter.context,r=a.gl,o={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0};o.u_exaggeration=this.exaggeration();let s=null,l=null,c=1;if(i&&i.morphing&&this._useVertexMorphing){const t=i.morphing.srcDemTile,n=i.morphing.dstDemTile;c=i.morphing.phase,t&&n&&(this._prepareDemTileUniforms(e,t,o,"_prev")&&(l=t),this._prepareDemTileUniforms(e,n,o)&&(s=n))}const u=t=>t&&t.demTexture&&this.painter.linearFloatFilteringSupported()?r.LINEAR:r.NEAREST;let h=null;var d;if(this.enabled?l&&s?(h=s.demTexture,a.activeTexture.set(r.TEXTURE4),l.demTexture.bind(u(l),r.CLAMP_TO_EDGE),o.u_dem_lerp=c):(s=this.terrainTileForTile[e.tileID.key],h=this._prepareDemTileUniforms(e,s,o)?s.demTexture:this.emptyDEMTexture):h=this.emptyDEMTexture,a.activeTexture.set(r.TEXTURE2),h&&(o.u_dem_size=1===(d=h).size[0]?1:d.size[0]-2,h.bind(u(s),r.CLAMP_TO_EDGE)),a.activeTexture.set(r.TEXTURE3),i&&i.useDepthForOcclusion?(this._depthTexture&&this._depthTexture.bind(r.NEAREST,r.CLAMP_TO_EDGE),this._depthFBO&&(o.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height])):(this.emptyDepthBufferTexture.bind(r.NEAREST,r.CLAMP_TO_EDGE),o.u_depth_size_inv=[1,1]),i&&i.useMeterToDem&&s){const e=(1<<s.tileID.canonical.z)*t.ax(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;o.u_meter_to_dem=e}if(i&&i.labelPlaneMatrixInv&&(o.u_label_plane_matrix_inv=i.labelPlaneMatrixInv),n.setTerrainUniformValues(a,o),"globe"===this.painter.transform.projection.name){const t=this.globeUniformValues(this.painter.transform,e.tileID.canonical,i&&i.useDenormalizedUpVectorScale);n.setGlobeUniformValues(a,t)}}globeUniformValues(e,n,i){const a=e.projection;return{u_tile_tl_up:a.upVector(n,0,0),u_tile_tr_up:a.upVector(n,t.a3,0),u_tile_br_up:a.upVector(n,t.a3,t.a3),u_tile_bl_up:a.upVector(n,0,t.a3),u_tile_up_scale:i?t.bs(1):a.upVectorScale(n,e.center.lat,e.worldSize).metersToTile}}renderToBackBuffer(e){const n=this.painter,i=this.painter.context;0!==e.length&&(i.bindFramebuffer.set(null),i.viewport.set([0,0,n.width,n.height]),n.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(e,n,i,a,r){if("globe"===e.transform.projection.name)!function(e,n,i,a,r){const o=e.context,s=o.gl;let l,c;const u=e.transform,h=t.ba(e,o,u),d=(t,n)=>{if(c===n)return;const i=[Mn[n],"PROJECTION_GLOBE_VIEW"];h&&i.push("CUSTOM_ANTIALIASING");const a=e.isTileAffectedByFog(t);l=e.getOrCreateProgram("globeRaster",{defines:i,overrideFog:a}),c=n},p=e.colorModeForRenderPass(),f=new t.ae(s.LEQUAL,t.ae.ReadWrite,e.depthRangeFor3D);Sn.update(r);const m=t.bb(u),g=[t.aj(u.center.lng),t.ak(u.center.lat)],_=e.globeSharedBuffers,y=[u.width*t.e.devicePixelRatio,u.height*t.e.devicePixelRatio],x=Float32Array.from(u.globeMatrix),v={useDenormalizedUpVectorScale:!0};{const u=e.transform,h=kn(u.zoom,n.exaggeration(),n.sourceCache._source.tileSize);c=-1;const b=s.TRIANGLES;for(const c of a){const a=i.getTile(c),w=t.ag.disabled,A=n.prevTerrainTileForTile[c.key],C=n.terrainTileForTile[c.key];Tn(A,C)&&Sn.newMorphing(c.key,A,C,r,250),o.activeTexture.set(s.TEXTURE0),a.texture&&a.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE);const E=Sn.getMorphValuesForProxy(c.key),T=E?1:0;E&&t.o(v,{morphing:{srcDemTile:E.from,dstDemTile:E.to,phase:t.b9(E.phase)}});const S=t.bc(c.canonical),M=t.bd(S.getCenter().lat),k=t.be(c.canonical,S,M,u.worldSize/u._pixelsPerMercatorPixel),I=t.bf(t.bg(c.canonical)),P=Ue(u.expandedFarZProjMatrix,x,m,I,t.a1(u.zoom),g,u.frustumCorners.TL,u.frustumCorners.TR,u.frustumCorners.BR,u.frustumCorners.BL,u.globeCenterInViewSpace,u.globeRadius,y,h,u._farZ,k);if(d(c,T),l&&(n.setupElevationDraw(a,l,v),e.uploadCommonUniforms(o,l,c.toUnwrapped()),_)){const[n,i,a]=_.getGridBuffers(M,0!==h);l.draw(e,b,f,w,p,t.af.backCCW,P,"globe_raster",n,i,a)}}}if(_&&(e.renderDefaultNorthPole||e.renderDefaultSouthPole)){const r=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];h&&r.push("CUSTOM_ANTIALIASING"),l=e.getOrCreateProgram("globeRaster",{defines:r});for(const r of a){const{x:a,y:c,z:h}=r.canonical,d=0===c,m=c===(1<<h)-1,[x,b,w,A]=_.getPoleBuffers(h,!1);if(A&&(d||m)){const c=i.getTile(r);o.activeTexture.set(s.TEXTURE0),c.texture&&c.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE);let _=t.bh(h,a,u);const C=t.bf(t.bg(r.canonical)),E=(n,i)=>n.draw(e,s.TRIANGLES,f,t.ag.disabled,p,t.af.disabled,Ue(u.expandedFarZProjMatrix,_,_,C,0,g,u.frustumCorners.TL,u.frustumCorners.TR,u.frustumCorners.BR,u.frustumCorners.BL,u.globeCenterInViewSpace,u.globeRadius,y,0,u._farZ),"globe_pole_raster",i,w,A);n.setupElevationDraw(c,l,v),e.uploadCommonUniforms(o,l,r.toUnwrapped()),d&&e.renderDefaultNorthPole&&E(l,x),m&&e.renderDefaultSouthPole&&(_=t.ad.scale(t.ad.create(),_,[1,-1,1]),E(l,b))}}}}(e,n,i,a,r);else{const o=e.context,s=o.gl;let l,c;const u=e.shadowRenderer,h=_n(e,e.longestCutoffRange),d=t=>{if(c===t)return;const n=[];n.push(Mn[t]),h.shouldRenderCutoff&&n.push("RENDER_CUTOFF"),l=e.getOrCreateProgram("terrainRaster",{defines:n}),c=t},p=e.colorModeForRenderPass(),f=new t.ae(s.LEQUAL,t.ae.ReadWrite,e.depthRangeFor3D);Sn.update(r);const m=e.transform,g=kn(m.zoom,n.exaggeration(),n.sourceCache._source.tileSize);let _=[0,0,0];if(u){const t=e.style.directionalLight,n=e.style.ambientLight;t&&n&&(_=Cn(e.style,t,n))}{c=-1;const y=s.TRIANGLES,[x,v]=[n.gridIndexBuffer,n.gridSegments];for(const c of a){const a=i.getTile(c),b=t.ag.disabled,w=n.prevTerrainTileForTile[c.key],A=n.terrainTileForTile[c.key];Tn(w,A)&&Sn.newMorphing(c.key,w,A,r,250),o.activeTexture.set(s.TEXTURE0),a.texture&&a.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE);const C=Sn.getMorphValuesForProxy(c.key),E=C?1:0;let T;C&&(T={morphing:{srcDemTile:C.from,dstDemTile:C.to,phase:t.b9(C.phase)}});const S=Ve(c.projMatrix,In(c.canonical,m.renderWorldCopies)?g/10:g,_);if(d(E),!l)continue;n.setupElevationDraw(a,l,T);const M=c.toUnwrapped();u&&u.setupShadows(M,l),e.uploadCommonUniforms(o,l,M,null,h),l.draw(e,y,f,b,p,t.af.backCCW,S,"terrain_raster",n.gridBuffer,x,v)}}}}(n,this,this.proxySourceCache,e,this._updateTimestamp),this.renderingToTexture=!0,n.gpuTimingDeferredRenderEnd(),e.splice(0,e.length))}renderBatch(e){if(0===this._drapedRenderBatches.length)return e+1;this.renderingToTexture=!0;const n=this.painter,i=this.painter.context,a=this.proxySourceCache,r=this.proxiedCoords[a.id],o=this._drapedRenderBatches.shift(),s=n.style.order,l=[];let c=0;for(const u of r){const r=a.getTileByID(u.proxyTileKey),h=a.proxyCachedFBO[u.key]?a.proxyCachedFBO[u.key][e]:void 0,d=void 0!==h?a.renderCache[h]:this.pool[c++],p=void 0!==h;if(r.texture=d.tex,p&&!d.dirty){l.push(r.tileID);continue}let f;i.bindFramebuffer.set(d.fb.framebuffer),this.renderedToTile=!1,d.dirty&&(i.clear({color:t.C.transparent,stencil:0}),d.dirty=!1);for(let t=o.start;t<=o.end;++t){const e=n.style._mergedLayers[s[t]];if(e.isHidden(n.transform.zoom))continue;const a=n.style.getLayerSourceCache(e),r=a?this.proxyToSource[u.key][a.id]:[u];if(!r)continue;const o=r;i.viewport.set([0,0,d.fb.width,d.fb.height]),f!==(a?a.id:null)&&(this._setupStencil(d,r,e,a),f=a?a.id:null),n.renderLayer(n,a,e,o)}if(0===this._drapedRenderBatches.length)for(const t of this._pendingGroundEffectLayers){const e=n.style._mergedLayers[s[t]];if(e.isHidden(n.transform.zoom))continue;const a=n.style.getLayerSourceCache(e),r=a?this.proxyToSource[u.key][a.id]:[u];if(!r)continue;const o=r;i.viewport.set([0,0,d.fb.width,d.fb.height]),f!==(a?a.id:null)&&(this._setupStencil(d,r,e,a),f=a?a.id:null),n.renderLayer(n,a,e,o)}this.renderedToTile?(d.dirty=!0,l.push(r.tileID)):p||--c,5===c&&(c=0,this.renderToBackBuffer(l))}return this.renderToBackBuffer(l),this.renderingToTexture=!1,i.bindFramebuffer.set(null),i.viewport.set([0,0,n.width,n.height]),o.end+1}postRender(){}isLayerOrderingCorrect(t){const e=t.order.length;let n=-1,i=e;for(let a=0;a<e;++a)this._style.isLayerDraped(t._mergedLayers[t.order[a]])?n=Math.max(n,a):i=Math.min(i,a);return i>n}getMinElevationBelowMSL(){let t=0;return this._visibleDemTiles.filter((t=>t.dem)).forEach((e=>{t=Math.min(t,e.dem.tree.minimums[0])})),0===t?t:(t-30)*this._exaggeration}raycast(t,e,n){if(!this._visibleDemTiles)return null;const i=this._visibleDemTiles.filter((t=>t.dem)).map((i=>{const a=i.tileID,r=1<<a.overscaledZ,{x:o,y:s}=a.canonical,l=o/r,c=(o+1)/r,u=s/r,h=(s+1)/r;return{minx:l,miny:u,maxx:c,maxy:h,t:i.dem.tree.raycastRoot(l,u,c,h,t,e,n),tile:i}}));i.sort(((t,e)=>(null!==t.t?t.t:Number.MAX_VALUE)-(null!==e.t?e.t:Number.MAX_VALUE)));for(const a of i){if(null==a.t)return null;const i=a.tile.dem.tree.raycast(a.minx,a.miny,a.maxx,a.maxy,t,e,n);if(null!=i)return i}return null}_createFBO(){const e=this.painter.context,n=e.gl,i=this.drapeBufferSize;e.activeTexture.set(n.TEXTURE0);const a=new t.T(e,{width:i[0],height:i[1],data:null},n.RGBA);a.bind(n.LINEAR,n.CLAMP_TO_EDGE);const r=e.createFramebuffer(i[0],i[1],!0,null);return r.colorAttachment.set(a.texture),r.depthAttachment=new it(e,r.framebuffer),void 0===this._sharedDepthStencil?(this._sharedDepthStencil=e.createRenderbuffer(e.gl.DEPTH_STENCIL,i[0],i[1]),this._stencilRef=0,r.depthAttachment.set(this._sharedDepthStencil),e.clear({stencil:0})):r.depthAttachment.set(this._sharedDepthStencil),e.extTextureFilterAnisotropic&&n.texParameterf(n.TEXTURE_2D,e.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,e.extTextureFilterAnisotropicMax),{fb:r,tex:a,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._debugParams.disableRenderCache)return!0;if(this._style.hasLightTransitions())return!0;for(const t in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[t].hasTransition())return!0;return this._style.order.some((t=>{const e=this._style._mergedLayers[t],n=e.isHidden(this.painter.transform.zoom);return"custom"===e.type?!n&&e.shouldRedrape():!n&&e.hasTransition()}))}_clearLineLayersFromRenderCache(){let e=!1;for(const t of this._style.getSources())if(t instanceof Ne){e=!0;break}if(!e)return;const n={};for(let e=0;e<this._style.order.length;++e){const i=this._style._mergedLayers[this._style.order[e]],a=this._style.getLayerSourceCache(i);if(a&&!n[a.id]&&!i.isHidden(this.painter.transform.zoom)&&"line"===i.type&&i.widthExpression()instanceof t.Z){n[a.id]=!0;for(const t of this.proxyCoords){const e=this.proxyToSource[t.key][a.id];if(e)for(const t of e)this._clearRenderCacheForTile(a.id,t)}}}}_clearRasterLayersFromRenderCache(){let t=!1;for(const e in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[e]._source instanceof Fe){t=!0;break}if(!t)return;const e={};for(let t=0;t<this._style.order.length;++t){const n=this._style._mergedLayers[this._style.order[t]],i=this._style.getLayerSourceCache(n);if(!i||e[i.id])continue;if(n.isHidden(this.painter.transform.zoom)||"raster"!==n.type)continue;const a=n.paint.get("raster-fade-duration");for(const t of this.proxyCoords){const e=this.proxyToSource[t.key][i.id];if(e)for(const t of e){const e=zn(i.getTile(t),i.findLoadedParent(t,0),i,this.painter.transform,a);(1!==e.opacity||0!==e.mix)&&this._clearRenderCacheForTile(i.id,t)}}}}_setupDrapedRenderBatches(){const e=this._style.order,n=e.length;if(0===n)return;const i=[];this._pendingGroundEffectLayers=[];let a,r=0,o=this._style._mergedLayers[e[r]];for(;!this._style.isLayerDraped(o)&&o.isHidden(this.painter.transform.zoom)&&++r<n;)o=this._style._mergedLayers[e[r]];for(;r<n;++r){const t=this._style._mergedLayers[e[r]];t.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(t)?void 0===a&&(a=r):("fill-extrusion"===t.type&&this._pendingGroundEffectLayers.push(r),void 0!==a&&(i.push({start:a,end:r-1}),a=void 0)))}if(void 0!==a&&i.push({start:a,end:r-1}),0!==i.length){const e=i[i.length-1];this._pendingGroundEffectLayers.every((t=>t>e.end))||t.w("fill-extrusion with flood lighting and/or ground ambient occlusion should be moved to be on top of all draped layers.")}this._drapedRenderBatches=i}_setupRenderCache(t){const e=this.proxySourceCache;if(this._shouldDisableRenderCache()||this.invalidateRenderCache){if(this.invalidateRenderCache=!1,e.renderCache.length>e.renderCachePool.length){const t=Object.values(e.proxyCachedFBO);e.proxyCachedFBO={};for(let n=0;n<t.length;++n){const i=Object.values(t[n]);e.renderCachePool.push(...i)}}return}this._clearRasterLayersFromRenderCache();const n=this.proxyCoords,i=this._tilesDirty;for(let a=n.length-1;a>=0;a--){const r=n[a];if(e.getTileByID(r.key),void 0!==e.proxyCachedFBO[r.key]){const n=t[r.key],a=this.proxyToSource[r.key];let o=0;for(const t in a){const e=a[t],r=n[t];if(!r||r.length!==e.length||e.some(((e,n)=>e!==r[n]||i[t]&&i[t].hasOwnProperty(e.key)))){o=-1;break}++o}for(const t in e.proxyCachedFBO[r.key])e.renderCache[e.proxyCachedFBO[r.key][t]].dirty=o<0||o!==Object.values(n).length}}const a=[...this._drapedRenderBatches];a.sort(((t,e)=>e.end-e.start-(t.end-t.start)));for(const t of a)for(const i of n){if(e.proxyCachedFBO[i.key])continue;let n=e.renderCachePool.pop();void 0===n&&e.renderCache.length<50&&(n=e.renderCache.length,e.renderCache.push(this._createFBO())),void 0!==n&&(e.proxyCachedFBO[i.key]={},e.proxyCachedFBO[i.key][t.start]=n,e.renderCache[n].dirty=!0)}this._tilesDirty={}}_setupStencil(t,e,n,i){if(!i||!this._sourceTilesOverlap[i.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const a=this.painter.context,r=a.gl;if(e.length<=1)return void(this._overlapStencilType=!1);let o;if(n.isTileClipped())o=e.length,this._overlapStencilMode.test={func:r.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(e[0].overscaledZ>e[e.length-1].overscaledZ))return void(this._overlapStencilType=!1);o=1,this._overlapStencilMode.test={func:r.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+o>255&&(a.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=o,this._overlapStencilMode.ref=this._stencilRef,n.isTileClipped()&&this._renderTileClippingMasks(e,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return"Clip"===this._overlapStencilType||"Mask"===this._overlapStencilType}stencilModeForRTTOverlap(e){return this.renderingToTexture&&this._overlapStencilType?("Clip"===this._overlapStencilType&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[e.key]),this._overlapStencilMode):t.ag.disabled}_renderTileClippingMasks(e,n){const i=this.painter,a=this.painter.context,r=a.gl;i._tileClippingMaskIDs={},a.setColorMode(t.a.disabled),a.setDepthMode(t.ae.disabled);const o=i.getOrCreateProgram("clippingMask");for(const a of e){const e=i._tileClippingMaskIDs[a.key]=--n;o.draw(i,r.TRIANGLES,t.ae.disabled,new t.ag({func:r.ALWAYS,mask:0},e,255,r.KEEP,r.KEEP,r.REPLACE),t.a.disabled,t.af.disabled,Pn(a.projMatrix),"$clipping",i.tileExtentBuffer,i.quadTriangleIndexBuffer,i.tileExtentSegments)}}pointCoordinate(e){const n=this.painter.transform;if(e.x<0||e.x>n.width||e.y<0||e.y>n.height)return null;const i=[e.x,e.y,1,1];t.aA.transformMat4(i,i,n.pixelMatrixInverse),t.aA.scale(i,i,1/i[3]),i[0]/=n.worldSize,i[1]/=n.worldSize;const a=n._camera.position,r=t.ax(1,n.center.lat),o=[a[0],a[1],a[2]/r,0],s=t._.subtract([],i.slice(0,3),o);t._.normalize(s,s);const l=this.raycast(o,s,this._exaggeration);return null!==l&&l?(t._.scaleAndAdd(o,o,s,l),o[3]=o[2],o[2]*=r,o):null}drawDepth(){const e=this.painter,n=e.context,i=this.proxySourceCache,a=Math.ceil(e.width),r=Math.ceil(e.height);if(!this._depthFBO||this._depthFBO.width===a&&this._depthFBO.height===r||(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),!this._depthFBO){const e=n.gl,i=n.createFramebuffer(a,r,!0,"renderbuffer");n.activeTexture.set(e.TEXTURE0);const o=new t.T(n,{width:a,height:r,data:null},e.RGBA);o.bind(e.NEAREST,e.CLAMP_TO_EDGE),i.colorAttachment.set(o.texture);const s=n.createRenderbuffer(n.gl.DEPTH_COMPONENT16,a,r);i.depthAttachment.set(s),this._depthFBO=i,this._depthTexture=o}n.bindFramebuffer.set(this._depthFBO.framebuffer),n.viewport.set([0,0,a,r]),function(e,n,i,a){if("globe"===e.transform.projection.name)return;const r=e.context,o=r.gl;r.clear({depth:1});const s=e.getOrCreateProgram("terrainDepth"),l=new t.ae(o.LESS,t.ae.ReadWrite,e.depthRangeFor3D);for(const r of a){const a=i.getTile(r),c=Ve(r.projMatrix,0,[0,0,0]);n.setupElevationDraw(a,s),s.draw(e,o.TRIANGLES,l,t.ag.disabled,t.a.unblended,t.af.backCCW,c,"terrain_depth",n.gridBuffer,n.gridIndexBuffer,n.gridNoSkirtSegments)}}(e,this,i,this.proxyCoords)}_setupProxiedCoordsForOrtho(e,n,i){if(e.getSource()instanceof t.bm)return this._setupProxiedCoordsForImageSource(e,n,i);this._findCoveringTileCache[e.id]=this._findCoveringTileCache[e.id]||{};const a=this.proxiedCoords[e.id]=[],r=this.proxyCoords;for(let t=0;t<r.length;t++){const n=r[t],o=this._findTileCoveringTileID(n,e);if(o){const t=this._createProxiedId(n,o,i[n.key]&&i[n.key][e.id]);a.push(t),this.proxyToSource[n.key][e.id]=[t]}}let o=!1;const s=new Set;for(let t=0;t<n.length;t++){const r=e.getTile(n[t]);if(!r||!r.hasData())continue;const l=this._findTileCoveringTileID(r.tileID,this.proxySourceCache);if(l&&l.tileID.canonical.z!==r.tileID.canonical.z){const t=this.proxyToSource[l.tileID.key][e.id],n=this._createProxiedId(l.tileID,r,i[l.tileID.key]&&i[l.tileID.key][e.id]);t?t.splice(t.length-1,0,n):this.proxyToSource[l.tileID.key][e.id]=[n];const c=this.proxyToSource[l.tileID.key][e.id];s.has(c)||s.add(c),a.push(n),o=!0}}if(this._sourceTilesOverlap[e.id]=o,o&&this._debugParams.sortTilesHiZFirst)for(const t of s)t.sort(((t,e)=>e.overscaledZ-t.overscaledZ))}_setupProxiedCoordsForImageSource(e,n,i){if(!e.getSource().loaded())return;const a=this.proxiedCoords[e.id]=[],r=this.proxyCoords,o=e.getSource(),s=o.tileID;if(!s)return;const l=new t.P(s.x,s.y)._div(1<<s.z),c=o.coordinates.map(t.Y.fromLngLat).reduce(((t,e)=>(t.min.x=Math.min(t.min.x,e.x-l.x),t.min.y=Math.min(t.min.y,e.y-l.y),t.max.x=Math.max(t.max.x,e.x-l.x),t.max.y=Math.max(t.max.y,e.y-l.y),t)),{min:new t.P(Number.MAX_VALUE,Number.MAX_VALUE),max:new t.P(-Number.MAX_VALUE,-Number.MAX_VALUE)}),u=(e,n)=>{const i=e.wrap+e.canonical.x/(1<<e.canonical.z),a=e.canonical.y/(1<<e.canonical.z),r=t.a3/(1<<e.canonical.z),o=n.wrap+n.canonical.x/(1<<n.canonical.z),s=n.canonical.y/(1<<n.canonical.z);return i+r<o+c.min.x||i>o+c.max.x||a+r<s+c.min.y||a>s+c.max.y};for(let t=0;t<r.length;t++){const o=r[t];for(let t=0;t<n.length;t++){const r=e.getTile(n[t]);if(!r||!r.hasData())continue;if(u(o,r.tileID))continue;const s=this._createProxiedId(o,r,i[o.key]&&i[o.key][e.id]),l=this.proxyToSource[o.key][e.id];l?l.push(s):this.proxyToSource[o.key][e.id]=[s],a.push(s)}}}_createProxiedId(e,n,i){let a=this.orthoMatrix;if(i){const t=i.find((t=>t.key===n.tileID.key));if(t)return t}if(n.tileID.key!==e.key){const i=e.canonical.z-n.tileID.canonical.z;let r,o,s;a=t.ad.create();const l=n.tileID.wrap-e.wrap<<e.overscaledZ;i>0?(r=t.a3>>i,o=r*((n.tileID.canonical.x<<i)-e.canonical.x+l),s=r*((n.tileID.canonical.y<<i)-e.canonical.y)):(r=t.a3<<-i,o=t.a3*(n.tileID.canonical.x-(e.canonical.x+l<<-i)),s=t.a3*(n.tileID.canonical.y-(e.canonical.y<<-i))),t.ad.ortho(a,0,r,0,r,0,1),t.ad.translate(a,a,[o,s,0])}return new Fn(n.tileID,e.key,a)}_findTileCoveringTileID(e,n){let i=n.getTile(e);if(i&&i.hasData())return i;const a=this._findCoveringTileCache[n.id],r=a[e.key];if(i=r?n.getTileByID(r):null,i&&i.hasData()||null===r)return i;let o=i?i.tileID:e,s=o.overscaledZ;const l=n.getSource().minzoom,c=[];if(!r){const a=n.getSource().maxzoom;if(e.canonical.z>=a){const i=e.canonical.z-a;n.getSource().reparseOverscaled?(s=Math.max(e.canonical.z+2,n.transform.tileZoom),o=new t.aL(s,e.wrap,a,e.canonical.x>>i,e.canonical.y>>i)):0!==i&&(s=a,o=new t.aL(s,e.wrap,a,e.canonical.x>>i,e.canonical.y>>i))}o.key!==e.key&&(c.push(o.key),i=n.getTile(o))}const u=t=>{c.forEach((e=>{a[e]=t})),c.length=0};for(s-=1;s>=l&&(!i||!i.hasData());s--){i&&u(i.tileID.key);const t=o.calculateScaledKey(s);if(i=n.getTileByID(t),i&&i.hasData())break;const e=a[t];if(null===e)break;void 0===e?c.push(t):i=n.getTileByID(e)}return u(i?i.tileID.key:null),i&&i.hasData()?i:null}findDEMTileFor(t){return this.enabled?this._findTileCoveringTileID(t,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(t,e){let n=this._tilesDirty[t];n||(n=this._tilesDirty[t]={}),n[e.key]=!0}}function jn(e,n,i){const a=function(e,n,i){const a=t._.dot(n,e),r=t._.dot(i,[.2126,.7152,.0722]),o=(t,e,n)=>(1-n)*t+n*e,s=o(1-.3*Math.min(r,1),1,Math.min(a+1,1));return o(.92,1,Math.asin(t.at(n[2],-1,1))/Math.PI+.5)*s}(e,[0,0,1],n),r=[0,0,0];t._.scale(r,i.slice(0,3),a);const o=[0,0,0];t._.scale(o,n.slice(0,3),e[2]);const s=[0,0,0];return t._.add(s,r,o),t.b8(s)}const Vn=["fill","fillOutline","fillPattern","line","linePattern","background","backgroundPattern","hillshade","raster"],Un=["stars","fillExtrusion","fillExtrusionGroundEffect","model","symbolSDF","symbolIcon","symbolTextAndIcon"];class Gn{static cacheKey(t,e,n,i){let a=`${e}${i?i.cacheKey:""}`;for(const e of n)t.usedDefines.includes(e)&&(a+=`/${e}`);return a}constructor(e,n,i,a,r,o){const s=e.gl;this.program=s.createProgram(),this.configuration=a,this.name=n,this.fixedDefines=[...o];const l=a?a.getBinderAttributes():[],c=(i.staticAttributes||[]).concat(l);let u=a?a.defines():[];u=u.concat(o.map((t=>`#define ${t}`)));const h="#version 300 es\n";let d=h+u.concat("precision mediump float;",Se,Te.fragmentSource).join("\n");for(const t of i.fragmentIncludes)d+=`\n${Ce[t]}`;d+=`\n${i.fragmentSource}`;let p=h+u.concat("precision highp float;",Se,Te.vertexSource).join("\n");for(const t of i.vertexIncludes)p+=`\n${Ce[t]}`;p+=`\n${i.vertexSource}`;const f=s.createShader(s.FRAGMENT_SHADER);if(s.isContextLost())return void(this.failedToCreate=!0);s.shaderSource(f,d),s.compileShader(f),s.attachShader(this.program,f);const m=s.createShader(s.VERTEX_SHADER);if(s.isContextLost())this.failedToCreate=!0;else{s.shaderSource(m,p),s.compileShader(m),s.attachShader(this.program,m),this.attributes={},this.numAttributes=c.length;for(let t=0;t<this.numAttributes;t++)if(c[t]){const e=c[t].startsWith("a_")?c[t]:`a_${c[t]}`;s.bindAttribLocation(this.program,t,e),this.attributes[e]=t}s.linkProgram(this.program),s.deleteShader(m),s.deleteShader(f),this.fixedUniforms=r(e),this.binderUniforms=a?a.getUniforms(e):[],o.includes("TERRAIN")&&(this.terrainUniforms=(e=>({u_dem:new t.a7(e),u_dem_prev:new t.a7(e),u_dem_tl:new t.a8(e),u_dem_scale:new t.aa(e),u_dem_tl_prev:new t.a8(e),u_dem_scale_prev:new t.aa(e),u_dem_size:new t.aa(e),u_dem_lerp:new t.aa(e),u_exaggeration:new t.aa(e),u_depth:new t.a7(e),u_depth_size_inv:new t.a8(e),u_meter_to_dem:new t.aa(e),u_label_plane_matrix_inv:new t.a6(e)}))(e)),o.includes("GLOBE")&&(this.globeUniforms=(e=>({u_tile_tl_up:new t.aq(e),u_tile_tr_up:new t.aq(e),u_tile_br_up:new t.aq(e),u_tile_bl_up:new t.aq(e),u_tile_up_scale:new t.aa(e)}))(e)),o.includes("FOG")&&(this.fogUniforms=(e=>({u_fog_matrix:new t.a6(e),u_fog_range:new t.a8(e),u_fog_color:new t.as(e),u_fog_horizon_blend:new t.aa(e),u_fog_vertical_limit:new t.a8(e),u_fog_temporal_offset:new t.aa(e),u_frustum_tl:new t.aq(e),u_frustum_tr:new t.aq(e),u_frustum_br:new t.aq(e),u_frustum_bl:new t.aq(e),u_globe_pos:new t.aq(e),u_globe_radius:new t.aa(e),u_globe_transition:new t.aa(e),u_is_globe:new t.a7(e),u_viewport:new t.a8(e)}))(e)),o.includes("RENDER_CUTOFF")&&(this.cutoffUniforms=(e=>({u_cutoff_params:new t.as(e)}))(e)),o.includes("LIGHTING_3D_MODE")&&(this.lightsUniforms=(e=>({u_lighting_ambient_color:new t.aq(e),u_lighting_directional_dir:new t.aq(e),u_lighting_directional_color:new t.aq(e),u_ground_radiance:new t.aq(e)}))(e)),o.includes("RENDER_SHADOWS")&&(this.shadowUniforms=(e=>({u_light_matrix_0:new t.a6(e),u_light_matrix_1:new t.a6(e),u_fade_range:new t.a8(e),u_shadow_normal_offset:new t.aq(e),u_shadow_intensity:new t.aa(e),u_shadow_texel_size:new t.aa(e),u_shadow_map_resolution:new t.aa(e),u_shadow_direction:new t.aq(e),u_shadow_bias:new t.aq(e),u_shadowmap_0:new t.a7(e),u_shadowmap_1:new t.a7(e)}))(e))}}setTerrainUniformValues(t,e){if(!this.terrainUniforms)return;const n=this.terrainUniforms;if(!this.failedToCreate){t.program.set(this.program);for(const t in e)n[t]&&n[t].set(this.program,t,e[t])}}setGlobeUniformValues(t,e){if(!this.globeUniforms)return;const n=this.globeUniforms;if(!this.failedToCreate){t.program.set(this.program);for(const t in e)n[t]&&n[t].set(this.program,t,e[t])}}setFogUniformValues(t,e){if(!this.fogUniforms)return;const n=this.fogUniforms;if(!this.failedToCreate){t.program.set(this.program);for(const t in e)n[t].set(this.program,t,e[t])}}setCutoffUniformValues(t,e){if(!this.cutoffUniforms)return;const n=this.cutoffUniforms;if(!this.failedToCreate){t.program.set(this.program);for(const t in e)n[t].set(this.program,t,e[t])}}setLightsUniformValues(t,e){if(!this.lightsUniforms)return;const n=this.lightsUniforms;if(!this.failedToCreate){t.program.set(this.program);for(const t in e)n[t].set(this.program,t,e[t])}}setShadowUniformValues(t,e){if(this.failedToCreate||!this.shadowUniforms)return;const n=this.shadowUniforms;t.program.set(this.program);for(const t in e)n[t].set(this.program,t,e[t])}_drawDebugWireframe(e,n,i,a,r,o,s,l,c,u){const h=e.options.wireframe;if(!1===h.terrain&&!1===h.layers2D&&!1===h.layers3D)return;const d=e.context;if(!(()=>!(!h.terrain||"terrainRaster"!==this.name&&"globeRaster"!==this.name)||!(!h.layers2D||e._terrain&&e._terrain.renderingToTexture||!Vn.includes(this.name))||!(!h.layers3D||!Un.includes(this.name)))())return;const p=d.gl,f=e.wireframeDebugCache.getLinesFromTrianglesBuffer(e.frameCounter,r,d);if(!f)return;const m=[...this.fixedDefines];m.push("DEBUG_WIREFRAME");const g=e.getOrCreateProgram(this.name,{config:this.configuration,defines:m});d.program.set(g.program);const _=(t,e,n)=>{if(e[t]&&n[t])for(const i in e[t])n[t][i]&&n[t][i].set(n.program,i,e[t][i].current)};c&&c.setUniforms(g.program,d,g.binderUniforms,s,{zoom:l}),_("fixedUniforms",this,g),_("terrainUniforms",this,g),_("globeUniforms",this,g),_("fogUniforms",this,g),_("lightsUniforms",this,g),_("shadowUniforms",this,g),f.bind(),d.setColorMode(new t.a([p.ONE,p.ONE_MINUS_SRC_ALPHA,p.ZERO,p.ONE],t.C.transparent,[!0,!0,!0,!1])),d.setDepthMode(new t.ae(n.func===p.LESS?p.LEQUAL:n.func,t.ae.ReadOnly,n.range)),d.setStencilMode(t.ag.disabled);const y=3*o.primitiveLength*2,x=3*o.primitiveOffset*2*2;u&&u>1?p.drawElementsInstanced(p.LINES,y,p.UNSIGNED_SHORT,x,u):p.drawElements(p.LINES,y,p.UNSIGNED_SHORT,x),r.bind(),d.program.set(this.program),d.setDepthMode(n),d.setStencilMode(i),d.setColorMode(a)}draw(t,e,n,i,a,r,o,s,l,c,u,h,d,p,f,m){const g=t.context,_=g.gl;if(this.failedToCreate)return;g.program.set(this.program),g.setDepthMode(n),g.setStencilMode(i),g.setColorMode(a),g.setCullFace(r);for(const t of Object.keys(this.fixedUniforms))this.fixedUniforms[t].set(this.program,t,o[t]);p&&p.setUniforms(this.program,g,this.binderUniforms,h,{zoom:d});const y={[_.POINTS]:1,[_.LINES]:2,[_.TRIANGLES]:3,[_.LINE_STRIP]:1}[e],x=m&&m>0?1:void 0;for(const r of u.get()){const o=r.vaos||(r.vaos={});(o[s]||(o[s]=new Pe)).bind(g,this,l,p?p.getPaintVertexBuffers():[],c,r.vertexOffset,f||[],x),m&&m>1?_.drawElementsInstanced(e,r.primitiveLength*y,_.UNSIGNED_SHORT,r.primitiveOffset*y*2,m):c?_.drawElements(e,r.primitiveLength*y,_.UNSIGNED_SHORT,r.primitiveOffset*y*2):_.drawArrays(e,r.vertexOffset,r.vertexLength),e===_.TRIANGLES&&c&&this._drawDebugWireframe(t,n,i,a,c,r,h,d,p,m)}}}function qn(e,n){const i=Math.pow(2,n.tileID.overscaledZ),a=n.tileSize*Math.pow(2,e.transform.tileZoom)/i,r=a*(n.tileID.canonical.x+n.tileID.wrap*i),o=a*n.tileID.canonical.y;return{u_image:0,u_texsize:n.imageAtlasTexture?n.imageAtlasTexture.size:[0,0],u_tile_units_to_pixels:1/t.bB(n,1,e.transform.tileZoom),u_pixel_coord_upper:[r>>16,o>>16],u_pixel_coord_lower:[65535&r,65535&o]}}const $n=t.ad.create(),Wn=(e,n,i,a,r,o,s,l,c,u,h,d,p,f,m,g)=>{const _=n.style.light,y=_.properties.get("position"),x=[y.x,y.y,y.z],v=t.bC.create();"viewport"===_.properties.get("anchor")&&(t.bC.fromRotation(v,-n.transform.angle),t._.transformMat3(x,x,v));const b=_.properties.get("color"),w=n.transform,A={u_matrix:e,u_lightpos:x,u_lightintensity:_.properties.get("intensity"),u_lightcolor:[b.r,b.g,b.b],u_vertical_gradient:+i,u_opacity:a,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:$n,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_ao:r,u_edge_radius:o,u_flood_light_color:d,u_vertical_scale:p,u_flood_light_intensity:f,u_ground_shadow_factor:m,u_emissive_strength:g};return"globe"===w.projection.name&&(A.u_tile_id=[s.canonical.x,s.canonical.y,1<<s.canonical.z],A.u_zoom_transition=c,A.u_inv_rot_matrix=h,A.u_merc_center=u,A.u_up_dir=w.projection.upVector(new t.aO(0,0,0),u[0]*t.a3,u[1]*t.a3),A.u_height_lift=l),A},Hn=(t,e,n)=>({u_matrix:t,u_edge_radius:e,u_vertical_scale:n}),Zn=(e,n,i,a,r,o,s,l,c,u,h,d,p,f)=>{const m=Wn(e,n,i,a,r,o,s,c,u,h,d,p,f,1,[0,0,0],0),g={u_height_factor:-Math.pow(2,s.overscaledZ)/l.tileSize/8};return t.W(m,qn(n,l),g)},Yn=(t,e)=>({u_matrix:t,u_emissive_strength:e}),Xn=(e,n,i,a)=>t.W(Yn(e,n),qn(i,a)),Kn=(t,e,n)=>({u_matrix:t,u_world:n,u_emissive_strength:e}),Qn=(e,n,i,a,r)=>t.W(Xn(e,n,i,a),{u_world:r}),Jn=(e,n,i,a)=>{const r=t.a3/i.tileSize;return{u_matrix:e,u_camera_to_center_distance:n.getCameraToCenterDistance(a),u_extrude_scale:[n.pixelsToGLUnits[0]/r,n.pixelsToGLUnits[1]/r]}},ti=(t,e,n=1)=>({u_matrix:t,u_color:e.toRenderColor(null),u_overlay:0,u_overlay_scale:n}),ei=t.ad.create(),ni=(e,n,i,a,r,o,s)=>{const l=e.transform,c="globe"===l.projection.name,u=c?t.bD(l.zoom,n.canonical)*l._pixelsPerMercatorPixel:t.bB(i,1,o),h={u_matrix:n.projMatrix,u_extrude_scale:u,u_intensity:s,u_inv_rot_matrix:ei,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(c){h.u_inv_rot_matrix=a,h.u_merc_center=r,h.u_tile_id=[n.canonical.x,n.canonical.y,1<<n.canonical.z],h.u_zoom_transition=t.a1(l.zoom);const e=r[0]*t.a3,i=r[1]*t.a3;h.u_up_dir=l.projection.upVector(new t.aO(0,0,0),e,i)}return h};function ii(t,[e,n,i,a],[r,o]){if(r===o)return[0,0,0,0];const s=255*(t-1)/(t*(o-r));return[e*s,n*s,i*s,a*s]}function ai(t,e,[n,i]){return n===i?0:.5/t+(e-n)*(t-1)/(t*(i-n))}const ri=(e,n,i,a,r,o,s,l,c,u,h,d,p,f,m,g,_,y,x,v,b)=>({u_matrix:e,u_normalize_matrix:n,u_globe_matrix:i,u_merc_matrix:a,u_grid_matrix:r,u_tl_parent:o,u_scale_parent:u,u_fade_t:h.mix,u_opacity:h.opacity*d.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:d.paint.get("raster-brightness-min"),u_brightness_high:d.paint.get("raster-brightness-max"),u_saturation_factor:t.bE(d.paint.get("raster-saturation")),u_contrast_factor:t.bF(d.paint.get("raster-contrast")),u_spin_weights:oi(d.paint.get("raster-hue-rotate")),u_perspective_transform:p,u_raster_elevation:f,u_zoom_transition:s,u_merc_center:l,u_cutoff_params:c,u_colorization_mix:ii(t.bG,g,y),u_colorization_offset:ai(t.bG,_,y),u_color_ramp:m,u_texture_offset:[v/(x+2*v),x/(x+2*v)],u_texture_res:[x+2*v,x+2*v],u_emissive_strength:b});function oi(t){t*=Math.PI/180;const e=Math.sin(t),n=Math.cos(t);return[(2*n+1)/3,(-Math.sqrt(3)*e-n+1)/3,(Math.sqrt(3)*e-n+1)/3]}const si=.15,li=(t,e,n,i,a,r,o,s,l,c,u,h)=>({u_matrix:t,u_normalize_matrix:e,u_globe_matrix:n,u_merc_matrix:i,u_grid_matrix:a,u_tl_parent:r,u_scale_parent:c,u_fade_t:u.mix,u_opacity:u.opacity,u_image0:0,u_image1:1,u_raster_elevation:h,u_zoom_transition:o,u_merc_center:s,u_cutoff_params:l}),ci=(t,e,n,i,a,r,o,s,l,c)=>({u_particle_texture:t,u_particle_texture_side_len:e,u_tile_offset:n,u_velocity:i,u_color_ramp:r,u_velocity_res:a,u_max_speed:o,u_uv_offset:s,u_data_scale:l,u_data_offset:c,u_particle_pos_scale:1.3,u_particle_pos_offset:[si,si]}),ui=(t,e,n,i,a,r,o,s,l,c)=>({u_particle_texture:t,u_particle_texture_side_len:e,u_velocity:n,u_velocity_res:i,u_max_speed:a,u_speed_factor:r,u_reset_rate:o,u_rand_seed:Math.random(),u_uv_offset:s,u_data_scale:l,u_data_offset:c,u_particle_pos_scale:1.3,u_particle_pos_offset:[si,si]}),hi=t.ad.create(),di=(e,n,i,a,r,o,s,l,c,u,h,d,p,f,m,g,_,y)=>{const x=r.transform,v={u_is_size_zoom_constant:+("constant"===e||"source"===e),u_is_size_feature_constant:+("constant"===e||"camera"===e),u_size_t:n?n.uSizeT:0,u_size:n?n.uSize:0,u_camera_to_center_distance:x.getCameraToCenterDistance(g),u_rotate_symbol:+i,u_aspect_ratio:x.width/x.height,u_fade_change:r.options.fadeDuration?r.symbolFadeChange:1,u_matrix:o,u_label_plane_matrix:s,u_coord_matrix:l,u_is_text:+c,u_pitch_with_map:+a,u_texsize:u,u_texture:0,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:hi,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:hi,u_up_vector:[0,-1,0],u_color_adj_mat:_,u_icon_transition:y||0};return"globe"===g.name&&(v.u_tile_id=[h.canonical.x,h.canonical.y,1<<h.canonical.z],v.u_zoom_transition=d,v.u_inv_rot_matrix=f,v.u_merc_center=p,v.u_camera_forward=x._camera.forward(),v.u_ecef_origin=t.bH(x.globeMatrix,h.toUnwrapped()),v.u_tile_matrix=Float32Array.from(x.globeMatrix),v.u_up_vector=m),v},pi=(e,n,i,a,r,o,s,l,c,u,h,d,p,f,m,g,_)=>t.W(di(e,n,i,a,r,o,s,l,c,u,d,p,f,m,g,_),{u_gamma_scale:a?r.transform.getCameraToCenterDistance(_)*Math.cos(r.terrain?0:r.transform._pitch):1,u_device_pixel_ratio:t.e.devicePixelRatio,u_is_halo:+h,undefined:void 0}),fi=(e,n,i,a,r,o,s,l,c,u,h,d,p,f,m,g)=>t.W(pi(e,n,i,a,r,o,s,l,!0,c,!0,h,d,p,f,m,g),{u_texsize_icon:u,u_texture_icon:1}),mi=(t,e,n,i)=>({u_matrix:t,u_emissive_strength:e,u_opacity:n,u_color:i}),gi=(e,n,i,a,r,o,s,l)=>t.W(function(e,n,i,a,r){const{width:o,height:s}=a.imageManager.getPixelSize(n),l=Math.pow(2,r.tileID.overscaledZ),c=r.tileSize*Math.pow(2,a.transform.tileZoom)/l,u=c*(r.tileID.canonical.x+r.tileID.wrap*l),h=c*r.tileID.canonical.y;return{u_image:0,u_pattern_tl:i.tl,u_pattern_br:i.br,u_texsize:[o,s],u_pattern_size:i.displaySize,u_tile_units_to_pixels:1/t.bB(r,1,a.transform.tileZoom),u_pixel_coord_upper:[u>>16,h>>16],u_pixel_coord_lower:[65535&u,65535&h]}}(0,o,s,a,l),{u_matrix:e,u_emissive_strength:n,u_opacity:i}),_i=new Float32Array(t.ad.identity([])),yi=(e,n,i,a,r,o,s,l,c,u,h,d,p,f=[0,0,0],m)=>{const g=r.style.light,_=g.properties.get("position"),y=[-_.x,-_.y,_.z],x=t.bC.create();"viewport"===g.properties.get("anchor")&&(t.bC.fromRotation(x,-r.transform.angle),t._.transformMat3(y,y,x));const v="MASK"===h.alphaMode,b=g.properties.get("color").toRenderColor(null),w=p.paint.get("model-ambient-occlusion-intensity"),A=p.paint.get("model-color").constantOr(t.C.white).toRenderColor(null),C=p.paint.get("model-color-mix-intensity").constantOr(0);return{u_matrix:e,u_lighting_matrix:n,u_normal_matrix:i,u_node_matrix:a||_i,u_lightpos:y,u_lightintensity:g.properties.get("intensity"),u_lightcolor:[b.r,b.g,b.b],u_camera_pos:f,u_opacity:o,u_baseTextureIsAlpha:0,u_alphaMask:+v,u_alphaCutoff:h.alphaCutoff,u_baseColorFactor:[s.r,s.g,s.b,s.a],u_emissiveFactor:[l[0],l[1],l[2],1],u_metallicFactor:c,u_roughnessFactor:u,u_baseColorTexture:gn.BaseColor,u_metallicRoughnessTexture:gn.MetallicRoughness,u_normalTexture:gn.Normal,u_occlusionTexture:gn.Occlusion,u_emissionTexture:gn.Emission,u_lutTexture:gn.LUT,u_color_mix:[A.r,A.g,A.b,C],u_aoIntensity:w,u_emissive_strength:d,u_occlusionTextureTransform:m||[0,0,0,0]}},xi=(t,e=_i,n=_i)=>({u_matrix:t,u_instance:e,u_node_matrix:n}),vi=(t,e,n,i,a)=>({u_matrix:Float32Array.from(t),u_anchorPos:e,u_screenSizePx:n,u_occluderSizePx:i,u_color:a}),bi={fillExtrusion:e=>({u_matrix:new t.a6(e),u_lightpos:new t.aq(e),u_lightintensity:new t.aa(e),u_lightcolor:new t.aq(e),u_vertical_gradient:new t.aa(e),u_opacity:new t.aa(e),u_edge_radius:new t.aa(e),u_ao:new t.a8(e),u_tile_id:new t.aq(e),u_zoom_transition:new t.aa(e),u_inv_rot_matrix:new t.a6(e),u_merc_center:new t.a8(e),u_up_dir:new t.aq(e),u_height_lift:new t.aa(e),u_flood_light_color:new t.aq(e),u_vertical_scale:new t.aa(e),u_flood_light_intensity:new t.aa(e),u_ground_shadow_factor:new t.aq(e),u_emissive_strength:new t.aa(e)}),fillExtrusionDepth:e=>({u_matrix:new t.a6(e),u_edge_radius:new t.aa(e),u_vertical_scale:new t.aa(e)}),fillExtrusionPattern:e=>({u_matrix:new t.a6(e),u_lightpos:new t.aq(e),u_lightintensity:new t.aa(e),u_lightcolor:new t.aq(e),u_vertical_gradient:new t.aa(e),u_height_factor:new t.aa(e),u_edge_radius:new t.aa(e),u_ao:new t.a8(e),u_tile_id:new t.aq(e),u_zoom_transition:new t.aa(e),u_inv_rot_matrix:new t.a6(e),u_merc_center:new t.a8(e),u_up_dir:new t.aq(e),u_height_lift:new t.aa(e),u_image:new t.a7(e),u_texsize:new t.a8(e),u_pixel_coord_upper:new t.a8(e),u_pixel_coord_lower:new t.a8(e),u_tile_units_to_pixels:new t.aa(e),u_opacity:new t.aa(e)}),fillExtrusionGroundEffect:e=>({u_matrix:new t.a6(e),u_opacity:new t.aa(e),u_ao_pass:new t.aa(e),u_meter_to_tile:new t.aa(e),u_ao:new t.a8(e),u_flood_light_intensity:new t.aa(e),u_flood_light_color:new t.aq(e),u_attenuation:new t.aa(e),u_edge_radius:new t.aa(e),u_fb:new t.a7(e),u_fb_size:new t.aa(e)}),fill:e=>({u_matrix:new t.a6(e),u_emissive_strength:new t.aa(e)}),fillPattern:e=>({u_matrix:new t.a6(e),u_emissive_strength:new t.aa(e),u_image:new t.a7(e),u_texsize:new t.a8(e),u_pixel_coord_upper:new t.a8(e),u_pixel_coord_lower:new t.a8(e),u_tile_units_to_pixels:new t.aa(e)}),fillOutline:e=>({u_matrix:new t.a6(e),u_emissive_strength:new t.aa(e),u_world:new t.a8(e)}),fillOutlinePattern:e=>({u_matrix:new t.a6(e),u_emissive_strength:new t.aa(e),u_world:new t.a8(e),u_image:new t.a7(e),u_texsize:new t.a8(e),u_pixel_coord_upper:new t.a8(e),u_pixel_coord_lower:new t.a8(e),u_tile_units_to_pixels:new t.aa(e)}),circle:t.bI,collisionBox:e=>({u_matrix:new t.a6(e),u_camera_to_center_distance:new t.aa(e),u_extrude_scale:new t.a8(e)}),collisionCircle:e=>({u_matrix:new t.a6(e),u_inv_matrix:new t.a6(e),u_camera_to_center_distance:new t.aa(e),u_viewport_size:new t.a8(e)}),debug:e=>({u_color:new t.a9(e),u_matrix:new t.a6(e),u_overlay:new t.a7(e),u_overlay_scale:new t.aa(e)}),clippingMask:e=>({u_matrix:new t.a6(e)}),heatmap:e=>({u_extrude_scale:new t.aa(e),u_intensity:new t.aa(e),u_matrix:new t.a6(e),u_inv_rot_matrix:new t.a6(e),u_merc_center:new t.a8(e),u_tile_id:new t.aq(e),u_zoom_transition:new t.aa(e),u_up_dir:new t.aq(e)}),heatmapTexture:e=>({u_image:new t.a7(e),u_color_ramp:new t.a7(e),u_opacity:new t.aa(e)}),hillshade:e=>({u_matrix:new t.a6(e),u_image:new t.a7(e),u_latrange:new t.a8(e),u_light:new t.a8(e),u_shadow:new t.a9(e),u_highlight:new t.a9(e),u_emissive_strength:new t.aa(e),u_accent:new t.a9(e)}),hillshadePrepare:e=>({u_matrix:new t.a6(e),u_image:new t.a7(e),u_dimension:new t.a8(e),u_zoom:new t.aa(e)}),line:t.bJ,linePattern:t.bK,raster:e=>({u_matrix:new t.a6(e),u_normalize_matrix:new t.a6(e),u_globe_matrix:new t.a6(e),u_merc_matrix:new t.a6(e),u_grid_matrix:new t.ar(e),u_tl_parent:new t.a8(e),u_scale_parent:new t.aa(e),u_fade_t:new t.aa(e),u_opacity:new t.aa(e),u_image0:new t.a7(e),u_image1:new t.a7(e),u_brightness_low:new t.aa(e),u_brightness_high:new t.aa(e),u_saturation_factor:new t.aa(e),u_contrast_factor:new t.aa(e),u_spin_weights:new t.aq(e),u_perspective_transform:new t.a8(e),u_raster_elevation:new t.aa(e),u_zoom_transition:new t.aa(e),u_merc_center:new t.a8(e),u_cutoff_params:new t.as(e),u_colorization_mix:new t.as(e),u_colorization_offset:new t.aa(e),u_color_ramp:new t.a7(e),u_texture_offset:new t.a8(e),u_texture_res:new t.a8(e),u_emissive_strength:new t.aa(e)}),rasterParticle:e=>({u_matrix:new t.a6(e),u_normalize_matrix:new t.a6(e),u_globe_matrix:new t.a6(e),u_merc_matrix:new t.a6(e),u_grid_matrix:new t.ar(e),u_tl_parent:new t.a8(e),u_scale_parent:new t.aa(e),u_fade_t:new t.aa(e),u_opacity:new t.aa(e),u_image0:new t.a7(e),u_image1:new t.a7(e),u_raster_elevation:new t.aa(e),u_zoom_transition:new t.aa(e),u_merc_center:new t.a8(e),u_cutoff_params:new t.as(e)}),rasterParticleTexture:e=>({u_texture:new t.a7(e),u_opacity:new t.aa(e)}),rasterParticleDraw:e=>({u_particle_texture:new t.a7(e),u_particle_texture_side_len:new t.aa(e),u_tile_offset:new t.a8(e),u_velocity:new t.a7(e),u_color_ramp:new t.a7(e),u_velocity_res:new t.a8(e),u_max_speed:new t.aa(e),u_uv_offset:new t.a8(e),u_data_scale:new t.as(e),u_data_offset:new t.aa(e),u_particle_pos_scale:new t.aa(e),u_particle_pos_offset:new t.a8(e)}),rasterParticleUpdate:e=>({u_particle_texture:new t.a7(e),u_particle_texture_side_len:new t.aa(e),u_velocity:new t.a7(e),u_velocity_res:new t.a8(e),u_max_speed:new t.aa(e),u_speed_factor:new t.aa(e),u_reset_rate:new t.aa(e),u_rand_seed:new t.aa(e),u_uv_offset:new t.a8(e),u_data_scale:new t.as(e),u_data_offset:new t.aa(e),u_particle_pos_scale:new t.aa(e),u_particle_pos_offset:new t.a8(e)}),symbolIcon:e=>({u_is_size_zoom_constant:new t.a7(e),u_is_size_feature_constant:new t.a7(e),u_size_t:new t.aa(e),u_size:new t.aa(e),u_camera_to_center_distance:new t.aa(e),u_rotate_symbol:new t.a7(e),u_aspect_ratio:new t.aa(e),u_fade_change:new t.aa(e),u_matrix:new t.a6(e),u_label_plane_matrix:new t.a6(e),u_coord_matrix:new t.a6(e),u_is_text:new t.a7(e),u_pitch_with_map:new t.a7(e),u_texsize:new t.a8(e),u_tile_id:new t.aq(e),u_zoom_transition:new t.aa(e),u_inv_rot_matrix:new t.a6(e),u_merc_center:new t.a8(e),u_camera_forward:new t.aq(e),u_tile_matrix:new t.a6(e),u_up_vector:new t.aq(e),u_ecef_origin:new t.aq(e),u_texture:new t.a7(e),u_icon_transition:new t.aa(e),u_color_adj_mat:new t.a6(e)}),symbolSDF:e=>({u_is_size_zoom_constant:new t.a7(e),u_is_size_feature_constant:new t.a7(e),u_size_t:new t.aa(e),u_size:new t.aa(e),u_camera_to_center_distance:new t.aa(e),u_rotate_symbol:new t.a7(e),u_aspect_ratio:new t.aa(e),u_fade_change:new t.aa(e),u_matrix:new t.a6(e),u_label_plane_matrix:new t.a6(e),u_coord_matrix:new t.a6(e),u_is_text:new t.a7(e),u_pitch_with_map:new t.a7(e),u_texsize:new t.a8(e),u_texture:new t.a7(e),u_gamma_scale:new t.aa(e),u_device_pixel_ratio:new t.aa(e),u_tile_id:new t.aq(e),u_zoom_transition:new t.aa(e),u_inv_rot_matrix:new t.a6(e),u_merc_center:new t.a8(e),u_camera_forward:new t.aq(e),u_tile_matrix:new t.a6(e),u_up_vector:new t.aq(e),u_ecef_origin:new t.aq(e),u_is_halo:new t.a7(e)}),symbolTextAndIcon:e=>({u_is_size_zoom_constant:new t.a7(e),u_is_size_feature_constant:new t.a7(e),u_size_t:new t.aa(e),u_size:new t.aa(e),u_camera_to_center_distance:new t.aa(e),u_rotate_symbol:new t.a7(e),u_aspect_ratio:new t.aa(e),u_fade_change:new t.aa(e),u_matrix:new t.a6(e),u_label_plane_matrix:new t.a6(e),u_coord_matrix:new t.a6(e),u_is_text:new t.a7(e),u_pitch_with_map:new t.a7(e),u_texsize:new t.a8(e),u_texsize_icon:new t.a8(e),u_texture:new t.a7(e),u_texture_icon:new t.a7(e),u_gamma_scale:new t.aa(e),u_device_pixel_ratio:new t.aa(e),u_is_halo:new t.a7(e)}),background:e=>({u_matrix:new t.a6(e),u_emissive_strength:new t.aa(e),u_opacity:new t.aa(e),u_color:new t.a9(e)}),backgroundPattern:e=>({u_matrix:new t.a6(e),u_emissive_strength:new t.aa(e),u_opacity:new t.aa(e),u_image:new t.a7(e),u_pattern_tl:new t.a8(e),u_pattern_br:new t.a8(e),u_texsize:new t.a8(e),u_pattern_size:new t.a8(e),u_pixel_coord_upper:new t.a8(e),u_pixel_coord_lower:new t.a8(e),u_tile_units_to_pixels:new t.aa(e)}),terrainRaster:je,terrainDepth:je,skybox:e=>({u_matrix:new t.a6(e),u_sun_direction:new t.aq(e),u_cubemap:new t.a7(e),u_opacity:new t.aa(e),u_temporal_offset:new t.aa(e)}),skyboxGradient:e=>({u_matrix:new t.a6(e),u_color_ramp:new t.a7(e),u_center_direction:new t.aq(e),u_radius:new t.aa(e),u_opacity:new t.aa(e),u_temporal_offset:new t.aa(e)}),skyboxCapture:e=>({u_matrix_3f:new t.ar(e),u_sun_direction:new t.aq(e),u_sun_intensity:new t.aa(e),u_color_tint_r:new t.as(e),u_color_tint_m:new t.as(e),u_luminance:new t.aa(e)}),globeRaster:e=>({u_proj_matrix:new t.a6(e),u_globe_matrix:new t.a6(e),u_normalize_matrix:new t.a6(e),u_merc_matrix:new t.a6(e),u_zoom_transition:new t.aa(e),u_merc_center:new t.a8(e),u_image0:new t.a7(e),u_grid_matrix:new t.ar(e),u_skirt_height:new t.aa(e),u_far_z_cutoff:new t.aa(e),u_frustum_tl:new t.aq(e),u_frustum_tr:new t.aq(e),u_frustum_br:new t.aq(e),u_frustum_bl:new t.aq(e),u_globe_pos:new t.aq(e),u_globe_radius:new t.aa(e),u_viewport:new t.a8(e)}),globeAtmosphere:e=>({u_frustum_tl:new t.aq(e),u_frustum_tr:new t.aq(e),u_frustum_br:new t.aq(e),u_frustum_bl:new t.aq(e),u_horizon:new t.aa(e),u_transition:new t.aa(e),u_fadeout_range:new t.aa(e),u_color:new t.as(e),u_high_color:new t.as(e),u_space_color:new t.as(e),u_temporal_offset:new t.aa(e),u_horizon_angle:new t.aa(e)}),model:e=>({u_matrix:new t.a6(e),u_lighting_matrix:new t.a6(e),u_normal_matrix:new t.a6(e),u_node_matrix:new t.a6(e),u_lightpos:new t.aq(e),u_lightintensity:new t.aa(e),u_lightcolor:new t.aq(e),u_camera_pos:new t.aq(e),u_opacity:new t.aa(e),u_baseColorFactor:new t.as(e),u_emissiveFactor:new t.as(e),u_metallicFactor:new t.aa(e),u_roughnessFactor:new t.aa(e),u_baseTextureIsAlpha:new t.a7(e),u_alphaMask:new t.a7(e),u_alphaCutoff:new t.aa(e),u_baseColorTexture:new t.a7(e),u_metallicRoughnessTexture:new t.a7(e),u_normalTexture:new t.a7(e),u_occlusionTexture:new t.a7(e),u_emissionTexture:new t.a7(e),u_lutTexture:new t.a7(e),u_color_mix:new t.as(e),u_aoIntensity:new t.aa(e),u_emissive_strength:new t.aa(e),u_occlusionTextureTransform:new t.as(e)}),modelDepth:e=>({u_matrix:new t.a6(e),u_instance:new t.a6(e),u_node_matrix:new t.a6(e)}),groundShadow:e=>({u_matrix:new t.a6(e),u_ground_shadow_factor:new t.aq(e)}),stars:e=>({u_matrix:new t.a6(e),u_up:new t.aq(e),u_right:new t.aq(e),u_intensity_multiplier:new t.aa(e)}),occlusion:e=>({u_matrix:new t.a6(e),u_anchorPos:new t.aq(e),u_screenSizePx:new t.a8(e),u_occluderSizePx:new t.a8(e),u_color:new t.as(e)})};function wi(e,n,i){const a=n.createTileMatrix(e,e.worldSize,i.toUnwrapped());return t.ad.multiply(new Float32Array(16),e.projMatrix,a)}function Ai(t,e,n){if(e.projection.name===n.projection.name)return t.projMatrix;const i=n.clone();return i.setProjection(e.projection),wi(i,e.getProjection(),t)}function Ci(t,e,n){return e.name===n.projection.name?t.projMatrix:wi(n,e,t)}let Ei;function Ti(e,n,i,a,r,o,s){const l=e.context,c=l.gl,u=e.transform,h=e.getOrCreateProgram("collisionBox"),d=[];let p=0,f=0;for(let l=0;l<a.length;l++){const m=a[l],g=n.getTile(m),_=g.getBucket(i);if(!_)continue;const y=Ai(m,_,u);let x=y;0===r[0]&&0===r[1]||(x=e.translatePosMatrix(y,g,r,o));const v=s?_.textCollisionBox:_.iconCollisionBox,b=_.collisionCircleArray;if(b.length>0){const e=t.ad.create(),n=x;t.ad.mul(e,_.placementInvProjMatrix,u.glCoordMatrix),t.ad.mul(e,e,_.placementViewportMatrix),d.push({circleArray:b,circleOffset:f,transform:n,invTransform:e,projection:_.getProjection()}),p+=b.length/4,f=p}v&&(e.terrain&&e.terrain.setupElevationDraw(g,h),h.draw(e,c.LINES,t.ae.disabled,t.ag.disabled,e.colorModeForRenderPass(),t.af.disabled,Jn(x,u,g,_.getProjection()),i.id,v.layoutVertexBuffer,v.indexBuffer,v.segments,null,u.zoom,null,[v.collisionVertexBuffer,v.collisionVertexBufferExt]))}if(!s||!d.length)return;const m=e.getOrCreateProgram("collisionCircle"),g=new t.bL;g.resize(4*p),g._trim();let _=0;for(const t of d)for(let e=0;e<t.circleArray.length/4;e++){const n=4*e,i=t.circleArray[n+0],a=t.circleArray[n+1],r=t.circleArray[n+2],o=t.circleArray[n+3];g.emplace(_++,i,a,r,o,0),g.emplace(_++,i,a,r,o,1),g.emplace(_++,i,a,r,o,2),g.emplace(_++,i,a,r,o,3)}(!Ei||Ei.length<2*p)&&(Ei=function(e){const n=2*e,i=new t.bu;i.resize(n),i._trim();for(let t=0;t<n;t++){const e=6*t;i.uint16[e+0]=4*t+0,i.uint16[e+1]=4*t+1,i.uint16[e+2]=4*t+2,i.uint16[e+3]=4*t+2,i.uint16[e+4]=4*t+3,i.uint16[e+5]=4*t+0}return i}(p));const y=l.createIndexBuffer(Ei,!0),x=l.createVertexBuffer(g,t.bM.members,!0);for(const n of d){const a={u_matrix:n.transform,u_inv_matrix:n.invTransform,u_camera_to_center_distance:(v=u).getCameraToCenterDistance(n.projection),u_viewport_size:[v.width,v.height]};m.draw(e,c.TRIANGLES,t.ae.disabled,t.ag.disabled,e.colorModeForRenderPass(),t.af.disabled,a,i.id,x,y,t.b.simpleSegment(0,2*n.circleOffset,n.circleArray.length,n.circleArray.length/2),null,u.zoom)}var v;x.destroy(),y.destroy()}const Si=t.ad.create();function Mi(e){const n=e._camera.getWorldToCamera(e.worldSize,1),i=t.ad.multiply([],n,e.globeMatrix);t.ad.invert(i,i);const a=[0,0,0],r=[0,1,0,0];return t.aA.transformMat4(r,r,i),a[0]=r[0],a[1]=r[1],a[2]=r[2],t._.normalize(a,a),a}function ki({width:e,height:n,anchor:i,textOffset:a,textScale:r},o){const{horizontalAlign:s,verticalAlign:l}=t.bQ(i),c=-(s-.5)*e,u=-(l-.5)*n,h=t.bP(i,a);return new t.P((c/r+h[0])*o,(u/r+h[1])*o)}function Ii(e,n,i,a,r,o,s,l,c,u,h){const d=e.text.placedSymbolArray,p=e.text.dynamicLayoutVertexArray,f=e.icon.dynamicLayoutVertexArray,m={},g=e.getProjection(),_=Ci(l,g,o),y=o.elevation,x=g.upVectorScale(l.canonical,o.center.lat,o.worldSize).metersToTile;p.clear();for(let f=0;f<d.length;f++){const v=d.get(f),{tileAnchorX:b,tileAnchorY:w,numGlyphs:A}=v,C=v.hidden||!v.crossTileID||e.allowVerticalPlacement&&!v.placedOrientation?null:a[v.crossTileID];if(C){let a=0,d=0,f=0;if(y){const t=y?y.getAtTileOffset(l,b,w):0,[e,n,i]=g.upVector(l.canonical,b,w);a=t*e*x,d=t*n*x,f=t*i*x}let[E,T,S,M]=tn(v.projectedAnchorX+a,v.projectedAnchorY+d,v.projectedAnchorZ+f,i?_:s);const k=en(o.getCameraToCenterDistance(g),M);let I=r.evaluateSizeForFeature(e.textSizeData,u,v)*k/t.bN;i&&(I*=e.tilePixelRatio/c);const P=ki(C,I);i?(({x:E,y:T,z:S}=g.projectTilePoint(b+P.x,w+P.y,l.canonical)),[E,T,S]=tn(E+a,T+d,S+f,s)):(n&&P._rotate(-o.angle),E+=P.x,T+=P.y,S=0);const z=e.allowVerticalPlacement&&v.placedOrientation===t.aE.vertical?Math.PI/2:0;for(let e=0;e<A;e++)t.aH(p,E,T,S,z);h&&v.associatedIconIndex>=0&&(m[v.associatedIconIndex]={x:E,y:T,z:S,angle:z})}else hn(A,p)}if(h){f.clear();const n=e.icon.placedSymbolArray;for(let e=0;e<n.length;e++){const i=n.get(e),{numGlyphs:a}=i,r=m[e];if(i.hidden||!r)hn(a,f);else{const{x:e,y:n,z:i,angle:o}=r;for(let r=0;r<a;r++)t.aH(f,e,n,i,o)}}e.icon.dynamicLayoutVertexBuffer.updateData(f)}e.text.dynamicLayoutVertexBuffer.updateData(p)}function Pi(e,n,i,a,r,o,s={}){const l=i.paint.get("icon-translate"),c=i.paint.get("text-translate"),u=i.paint.get("icon-translate-anchor"),h=i.paint.get("text-translate-anchor"),d=i.layout.get("icon-rotation-alignment"),p=i.layout.get("text-rotation-alignment"),f=i.layout.get("icon-pitch-alignment"),m=i.layout.get("text-pitch-alignment"),g=i.layout.get("icon-keep-upright"),_=i.layout.get("text-keep-upright"),y=i.paint.get("icon-color-saturation"),x=i.paint.get("icon-color-contrast"),v=i.paint.get("icon-color-brightness-min"),b=i.paint.get("icon-color-brightness-max"),w=i.paint.get("icon-occlusion-opacity").constantOr(0),A=i.paint.get("text-occlusion-opacity").constantOr(0),C=e.context,E=C.gl,T=e.transform,S="map"===d,M="map"===p,k="map"===f,I="map"===m,P=1!==w,z=1!==A,D=void 0!==i.layout.get("symbol-sort-key").constantOr(1);let L=!1;const B=e.depthModeForSublayer(0,t.ae.ReadOnly),O=[t.aj(T.center.lng),t.ak(T.center.lat)],R=i.layout.get("text-variable-anchor"),F="globe"===T.projection.name,N=[],j=[0,-1,0];for(const r of a){const a=n.getTile(r),o=a.getBucket(i);if(!o)continue;if("mercator"===o.projection.name&&F)continue;if(o.fullyClipped)continue;const d="globe"===o.projection.name,p=d?t.a1(T.zoom):0,f=Ci(r,o.getProjection(),T),m=T.calculatePixelsToTileUnitsMatrix(a),w=R&&o.hasTextData(),A=o.hasIconTextFit()&&w&&o.hasIconData(),C=o.getProjection().createInversionMatrix(T,r.canonical),B=()=>{const n=S&&"point"!==i.layout.get("symbol-placement"),s=[];i.hasInitialOcclusionOpacityProperties&&P&&e.symbolParams.useOcclusionQueries&&!d&&!F&&s.push("OCCLUSION_QUERIES"),i.hasInitialOcclusionOpacityProperties||s.push("SYMBOL_OCCLUSION_BY_TERRAIN_DEPTH");const c=n||A,h=i.paint.get("icon-image-cross-fade").constantOr(0);e.terrainRenderModeElevated()&&k&&s.push("PITCH_WITH_MAP_TERRAIN"),d&&(s.push("PROJECTION_GLOBE_VIEW"),c&&s.push("PROJECTED_POS_ON_VIEWPORT")),h>0&&s.push("ICON_TRANSITION"),o.icon.zOffsetVertexBuffer&&s.push("Z_OFFSET"),0===y&&0===x&&0===v&&1===b||s.push("COLOR_ADJUSTMENT");const _=o.icon.programConfigurations.get(i.id),w=e.getOrCreateProgram(o.sdfIcons?"symbolSDF":"symbolIcon",{config:_,defines:s});let M;const I=a.imageAtlasTexture?a.imageAtlasTexture.size:[0,0],z=o.iconSizeData,D=t.aD(z,T.zoom),L=k||0!==T.pitch,B=Ke(f,a.tileID.canonical,k,S,T,o.getProjection(),m),R=Je(f,a.tileID.canonical,k,S,T,o.getProjection(),m),N=e.translatePosMatrix(R,a,l,u,!0),V=e.translatePosMatrix(f,a,l,u),U=c?Si:B,G=S&&!k&&!n;let q=j;!F&&!T.mercatorFromTransition||S||(q=Mi(T));const $=d?q:j;if(o.sdfIcons&&!o.iconsInText)M=pi(z.kind,D,G,k,e,V,U,N,!1,I,!0,r,p,O,C,$,o.getProjection());else{const t=i.getColorAdjustmentMatrix(y,x,v,b);M=di(z.kind,D,G,k,e,V,U,N,!1,I,r,p,O,C,$,o.getProjection(),t,h)}const W=a.imageAtlasTexture?a.imageAtlasTexture:null,H=1!==i.layout.get("icon-size").constantOr(0)||o.iconsNeedLinear,Z=o.sdfIcons||e.options.rotating||e.options.zooming||H||L?E.LINEAR:E.NEAREST,Y=o.sdfIcons&&0!==i.paint.get("icon-halo-width").constantOr(1),X=e.terrain&&k&&n?t.ad.invert(t.ad.create(),B):Si;if(n&&o.icon){const t=T.elevation,n=t?t.getAtTileOffsetFunc(r,T.center.lat,T.worldSize,o.getProjection()):null,i=Qe(f,a.tileID.canonical,k,S,T,o.getProjection(),m);an(o,f,e,!1,i,R,k,g,n,r)}return{program:w,buffers:o.icon,uniformValues:M,atlasTexture:W,atlasTextureIcon:null,atlasInterpolation:Z,atlasInterpolationIcon:null,isSDF:o.sdfIcons,hasHalo:Y,tile:a,labelPlaneMatrixInv:X}},V=()=>{const n=M&&"point"!==i.layout.get("symbol-placement"),s=[],l=n||R||A;i.hasInitialOcclusionOpacityProperties&&z&&e.symbolParams.useOcclusionQueries&&!d&&!F&&s.push("OCCLUSION_QUERIES"),i.hasInitialOcclusionOpacityProperties||s.push("SYMBOL_OCCLUSION_BY_TERRAIN_DEPTH"),e.terrainRenderModeElevated()&&I&&s.push("PITCH_WITH_MAP_TERRAIN"),d&&(s.push("PROJECTION_GLOBE_VIEW"),l&&s.push("PROJECTED_POS_ON_VIEWPORT")),o.text.zOffsetVertexBuffer&&s.push("Z_OFFSET");const u=o.text.programConfigurations.get(i.id),g=e.getOrCreateProgram(o.iconsInText?"symbolTextAndIcon":"symbolSDF",{config:u,defines:s});let y,x=[0,0],v=null;const b=o.textSizeData;o.iconsInText&&(x=a.imageAtlasTexture?a.imageAtlasTexture.size:[0,0],v=a.imageAtlasTexture?a.imageAtlasTexture:null,y=I||0!==T.pitch||e.options.rotating||e.options.zooming||"composite"===b.kind||"camera"===b.kind?E.LINEAR:E.NEAREST);const w=a.glyphAtlasTexture?a.glyphAtlasTexture.size:[0,0],S=t.aD(b,T.zoom),k=Ke(f,a.tileID.canonical,I,M,T,o.getProjection(),m),P=Je(f,a.tileID.canonical,I,M,T,o.getProjection(),m),D=e.translatePosMatrix(P,a,c,h,!0),L=e.translatePosMatrix(f,a,c,h),B=l?Si:k,N=M&&!I&&!n;let V=j;!F&&!T.mercatorFromTransition||M||(V=Mi(T));const U=d?V:j;let G;G=o.iconsInText?fi(b.kind,S,N,I,e,L,B,D,w,x,r,p,O,C,U,o.getProjection()):pi(b.kind,S,N,I,e,L,B,D,!0,w,!0,r,p,O,C,U,o.getProjection());const q=a.glyphAtlasTexture?a.glyphAtlasTexture:null,$=E.LINEAR,W=0!==i.paint.get("text-halo-width").constantOr(1),H=e.terrain&&I&&n?t.ad.invert(t.ad.create(),k):Si;if(n&&o.text){const t=T.elevation,n=t?t.getAtTileOffsetFunc(r,T.center.lat,T.worldSize,o.getProjection()):null,i=Qe(f,a.tileID.canonical,I,M,T,o.getProjection(),m);an(o,f,e,!0,i,P,I,_,n,r)}return{program:g,buffers:o.text,uniformValues:G,atlasTexture:q,atlasTextureIcon:v,atlasInterpolation:$,atlasInterpolationIcon:y,isSDF:!0,hasHalo:W,tile:a,labelPlaneMatrixInv:H}},U=o.icon.segments.get().length,G=o.text.segments.get().length,q=U&&!s.onlyText?B():null,$=G&&!s.onlyIcons?V():null,W=i.paint.get("icon-opacity").constantOr(1),H=i.paint.get("text-opacity").constantOr(1);if(D&&o.canOverlap){L=!0;const e=W&&!s.onlyText?o.icon.segments.get():[],n=H&&!s.onlyIcons?o.text.segments.get():[];for(const n of e)N.push({segments:new t.b([n]),sortKey:n.sortKey,state:q});for(const e of n)N.push({segments:new t.b([e]),sortKey:e.sortKey,state:$})}else s.onlyText||N.push({segments:W?o.icon.segments:new t.b([]),sortKey:0,state:q}),s.onlyIcons||N.push({segments:H?o.text.segments:new t.b([]),sortKey:0,state:$})}L&&N.sort(((t,e)=>t.sortKey-e.sortKey));for(const t of N){const n=t.state;if(n)if(e.terrain&&e.terrain.setupElevationDraw(n.tile,n.program,{useDepthForOcclusion:!i.hasInitialOcclusionOpacityProperties&&T.depthOcclusionForSymbolsAndCircles,labelPlaneMatrixInv:n.labelPlaneMatrixInv}),C.activeTexture.set(E.TEXTURE0),n.atlasTexture&&n.atlasTexture.bind(n.atlasInterpolation,E.CLAMP_TO_EDGE,!0),n.atlasTextureIcon&&(C.activeTexture.set(E.TEXTURE1),n.atlasTextureIcon&&n.atlasTextureIcon.bind(n.atlasInterpolationIcon,E.CLAMP_TO_EDGE,!0)),e.uploadCommonLightUniforms(e.context,n.program),n.hasHalo){const a=n.uniformValues;a.u_is_halo=1,zi(n.buffers,t.segments,i,e,n.program,B,r,o,a,2),a.u_is_halo=0}else{if(n.isSDF){const a=n.uniformValues;n.hasHalo&&(a.u_is_halo=1,zi(n.buffers,t.segments,i,e,n.program,B,r,o,a,1)),a.u_is_halo=0}zi(n.buffers,t.segments,i,e,n.program,B,r,o,n.uniformValues,1)}}}function zi(e,n,i,a,r,o,s,l,c,u){const h=a.context.gl,d=[e.dynamicLayoutVertexBuffer,e.opacityVertexBuffer,e.iconTransitioningVertexBuffer,e.globeExtVertexBuffer,e.zOffsetVertexBuffer];e.occlusionQueryOpacityVertexBuffer.length>0&&d.push(e.occlusionQueryOpacityVertexBuffer),r.draw(a,h.TRIANGLES,o,s,l,t.af.disabled,c,i.id,e.layoutVertexBuffer,e.indexBuffer,n,i.paint,a.transform.zoom,e.programConfigurations.get(i.id),d,u)}function Di(e,n,i,a,r,o,s){const l=e.context.gl,c=i.paint.get("fill-pattern"),u=c&&c.constantOr(1);let h,d,p,f,m;s?(d=u&&!i.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",h=l.LINES):(d=u?"fillPattern":"fill",h=l.TRIANGLES);for(const g of a){const a=n.getTile(g);if(u&&!a.patternsLoaded())continue;const _=a.getBucket(i);if(!_)continue;e.prepareDrawTile();const y=_.programConfigurations.get(i.id),x=e.isTileAffectedByFog(g),v=e.getOrCreateProgram(d,{config:y,overrideFog:x});u&&(e.context.activeTexture.set(l.TEXTURE0),a.imageAtlasTexture&&a.imageAtlasTexture.bind(l.LINEAR,l.CLAMP_TO_EDGE),y.updatePaintBuffers());const b=c.constantOr(null);if(b&&a.imageAtlas){const t=a.imageAtlas.patternPositions[b.toString()];t&&y.setConstantPatternPositions(t)}const w=e.translatePosMatrix(g.projMatrix,a,i.paint.get("fill-translate"),i.paint.get("fill-translate-anchor")),A=i.paint.get("fill-emissive-strength");if(s){f=_.indexBuffer2,m=_.segments2;const t=e.terrain&&e.terrain.renderingToTexture?e.terrain.drapeBufferSize:[l.drawingBufferWidth,l.drawingBufferHeight];p="fillOutlinePattern"===d&&u?Qn(w,A,e,a,t):Kn(w,A,t)}else f=_.indexBuffer,m=_.segments,p=u?Xn(w,A,e,a):Yn(w,A);e.uploadCommonUniforms(e.context,v,g.toUnwrapped()),v.draw(e,h,r,e.stencilModeForClipping(g),o,t.af.disabled,p,i.id,_.layoutVertexBuffer,f,m,i.paint,e.transform.zoom,y,void 0)}}function Li(e,n,i,a,r,o,s,l){i.resetLayerRenderingStats(e);const c=e.context,u=c.gl,h=e.transform,d=i.paint.get("fill-extrusion-pattern"),p=d.constantOr(1),f=i.paint.get("fill-extrusion-opacity"),m=e.style.enable3dLights(),g=i.paint.get(m&&!p?"fill-extrusion-ambient-occlusion-wall-radius":"fill-extrusion-ambient-occlusion-radius"),_=[i.paint.get("fill-extrusion-ambient-occlusion-intensity"),g],y=i.layout.get("fill-extrusion-edge-radius"),x=y>0&&!i.paint.get("fill-extrusion-rounded-roof"),v=x?0:y,b="globe"===h.projection.name?t.bY():0,w="globe"===h.projection.name,A=w?t.a1(h.zoom):0,C=[t.aj(h.center.lng),t.ak(h.center.lat)],E=i.paint.get("fill-extrusion-flood-light-color").toRenderColor(i.lut).toArray01().slice(0,3),T=i.paint.get("fill-extrusion-flood-light-intensity"),S=i.paint.get("fill-extrusion-vertical-scale"),M=_n(e,i.paint.get("fill-extrusion-cutoff-fade-range")),k=i.paint.get("fill-extrusion-emissive-strength"),I=[];let P;w&&I.push("PROJECTION_GLOBE_VIEW"),_[0]>0&&I.push("FAUX_AO"),x&&I.push("ZERO_ROOF_RADIUS"),l&&I.push("HAS_CENTROID"),T>0&&I.push("FLOOD_LIGHT"),M.shouldRenderCutoff&&I.push("RENDER_CUTOFF");const z="shadow"===e.renderPass,D=e.shadowRenderer,L=z&&!!D;e.shadowRenderer&&(e.shadowRenderer.useNormalOffset=!0);let B=[0,0,0];if(D){const t=e.style.directionalLight,n=e.style.ambientLight;t&&n&&(B=Cn(e.style,t,n)),P=I.concat(["SHADOWS_SINGLE_CASCADE"])}const O=L?"fillExtrusionDepth":p?"fillExtrusionPattern":"fillExtrusion",R=i.getLayerRenderingStats();for(const m of a){const a=n.getTile(m),g=a.getBucket(i);if(!g||g.projection.name!==h.projection.name)continue;let y=!1;D&&(y=0===D.getMaxCascadeForTile(m.toUnwrapped()));const x=e.isTileAffectedByFog(m),L=g.programConfigurations.get(i.id),F=e.getOrCreateProgram(O,{config:L,defines:y?P:I,overrideFog:x});if(e.terrain&&e.terrain.setupElevationDraw(a,F,{useMeterToDem:!0}),!g.centroidVertexBuffer){const t=F.attributes.a_centroid_pos;void 0!==t&&u.vertexAttrib2f(t,0,0)}!z&&D&&D.setupShadows(a.tileID.toUnwrapped(),F,"vector-tile",a.tileID.overscaledZ),p&&(e.context.activeTexture.set(u.TEXTURE0),a.imageAtlasTexture&&a.imageAtlasTexture.bind(u.LINEAR,u.CLAMP_TO_EDGE),L.updatePaintBuffers());const N=d.constantOr(null);if(N&&a.imageAtlas){const t=a.imageAtlas.patternPositions[N.toString()];t&&L.setConstantPatternPositions(t)}const j=i.paint.get("fill-extrusion-vertical-gradient");let V;if(z&&D){if(ji(a.tileID,g,e))continue;const t=D.calculateShadowPassMatrixFromTile(a.tileID.toUnwrapped());V=Hn(t,v,S)}else{const t=e.translatePosMatrix(m.expandedProjMatrix,a,i.paint.get("fill-extrusion-translate"),i.paint.get("fill-extrusion-translate-anchor")),n=h.projection.createInversionMatrix(h,m.canonical);V=p?Zn(t,e,j,f,_,v,m,a,b,A,C,n,E,S):Wn(t,e,j,f,_,v,m,b,A,C,n,E,S,T,B,k)}e.uploadCommonUniforms(c,F,m.toUnwrapped(),null,M);let U=g.segments;if("mercator"===h.projection.name&&!z&&(U=g.getVisibleSegments(a.tileID,e.terrain,e.transform.getFrustum(0)),!U.get().length))continue;if(R)if(z)for(const t of U.get())R.numRenderedVerticesInShadowPass+=t.primitiveLength;else for(const t of U.get())R.numRenderedVerticesInTransparentPass+=t.primitiveLength;const G=[];(e.terrain||l)&&G.push(g.centroidVertexBuffer),w&&G.push(g.layoutVertexExtBuffer),F.draw(e,c.gl.TRIANGLES,r,o,s,t.af.backCCW,V,i.id,g.layoutVertexBuffer,g.indexBuffer,U,i.paint,e.transform.zoom,L,G)}e.shadowRenderer&&(e.shadowRenderer.useNormalOffset=!1)}function Bi(e,n,i,a,r,o,s,l,c,u,h,d,p,f,m,g,_,y,x){const v=e.context,b=v.gl,w=e.transform,A=e.transform.zoom,C=[],E=_n(e,i.paint.get("fill-extrusion-cutoff-fade-range"));"clear"===u?(C.push("CLEAR_SUBPASS"),x&&(C.push("CLEAR_FROM_TEXTURE"),v.activeTexture.set(b.TEXTURE0),x.bind(b.LINEAR,b.CLAMP_TO_EDGE))):"sdf"===u&&C.push("SDF_SUBPASS"),_&&C.push("HAS_CENTROID"),E.shouldRenderCutoff&&C.push("RENDER_CUTOFF");const T=i.layout.get("fill-extrusion-edge-radius"),S=(t,n,a,u,y)=>{const b=n.programConfigurations.get(i.id),w=e.isTileAffectedByFog(t),S=e.getOrCreateProgram("fillExtrusionGroundEffect",{config:b,defines:C,overrideFog:w}),M=((t,e,n,i,a,r,o,s,l,c,u)=>({u_matrix:e,u_opacity:n,u_ao_pass:i?1:0,u_meter_to_tile:a,u_ao:r,u_flood_light_intensity:o,u_flood_light_color:s,u_attenuation:l,u_edge_radius:c,u_fb:0,u_fb_size:u}))(0,u,h,c,y,[d,p*y],f,m,g,A>=17?0:T*y,x?x.size[0]:0),k=[];_&&k.push(n.hiddenByLandmarkVertexBuffer),e.uploadCommonUniforms(v,S,t.toUnwrapped(),null,E),S.draw(e,v.gl.TRIANGLES,r,o,s,l,M,i.id,n.vertexBuffer,n.indexBuffer,a,i.paint,A,b,k)};for(const r of a){const a=n.getTile(r),o=a.getBucket(i);if(!o||o.projection.name!==w.projection.name||!o.groundEffect||o.groundEffect&&!o.groundEffect.hasData())continue;const s=o.groundEffect,l=1/o.tileToMeter;{const t=e.translatePosMatrix(r.projMatrix,a,i.paint.get("fill-extrusion-translate"),i.paint.get("fill-extrusion-translate-anchor")),n=s.getDefaultSegment();S(r,s,n,t,l)}if(y)for(let o=0;o<4;o++){const s=t.bZ[o](r),c=n.getTile(s);if(!c)continue;const u=c.getBucket(i);if(!u||u.projection.name!==w.projection.name||!u.groundEffect||u.groundEffect&&!u.groundEffect.hasData())continue;const h=u.groundEffect;let d,p;0===o?(d=[-t.a3,0,0],p=1):1===o?(d=[t.a3,0,0],p=0):2===o?(d=[0,-t.a3,0],p=3):(d=[0,t.a3,0],p=2);const f=h.regionSegments[p];if(!f)continue;const m=new Float32Array(16);t.ad.translate(m,r.projMatrix,d),S(r,h,f,e.translatePosMatrix(m,a,i.paint.get("fill-extrusion-translate"),i.paint.get("fill-extrusion-translate-anchor")),l)}}}function Oi(e,n,i,a,r,o,s){0===a.centroidVertexArray.length&&a.createCentroidsBuffer();const l=o?o.findDEMTileFor(i):null;if(!(l&&l.dem||s))return;const c=e=>new t.P(Math.ceil((e+t.c0)*t.c1),0),u=t=>{const e=n.getSource().minzoom,i=t=>{const e=n.getTileByID(t);if(e&&e.hasData())return e.getBucket(r)},a=[0,-1,1];for(const n of a){if(t.overscaledZ+n<e)continue;const a=i(t.calculateScaledKey(t.overscaledZ+n));if(a)return a}},h=[0,0,0],d=(e,n)=>(h[0]=Math.min(e.min.y,n.min.y),h[1]=Math.max(e.max.y,n.max.y),h[2]=t.a3-n.min.x>e.max.x?n.min.x-t.a3:e.max.x,h),p=(e,n)=>(h[0]=Math.min(e.min.x,n.min.x),h[1]=Math.max(e.max.x,n.max.x),h[2]=t.a3-n.min.y>e.max.y?n.min.y-t.a3:e.max.y,h),f=[(t,e)=>d(t,e),(t,e)=>d(e,t),(t,e)=>p(t,e),(t,e)=>p(e,t)],m=(e,n,a,r,s,c,u)=>{if(!o)return 0;const h=[[c?a:e,c?e:a,0],[c?a:n,c?n:a,0]],d=u<0?t.a3+u:u,p=[c?d:(e+n)/2,c?(e+n)/2:d,0];return 0===a&&u<0||0!==a&&u>0?o.getForTilePoints(s,[p],!0,r):h.push(p),o.getForTilePoints(i,h,!0,l),Math.max(h[0][2],h[1][2],p[2])/o.exaggeration()};for(let e=0;e<4;e++){const n=a.borderFeatureIndices[e];if(0===n.length)continue;const r=t.bZ[e](i),l=u(r);if(!(l&&l instanceof t.b_))continue;if(a.borderDoneWithNeighborZ[e]===l.canonical.z)continue;0===l.centroidVertexArray.length&&l.createCentroidsBuffer();const h=o?o.findDEMTileFor(r):null;if(!(h&&h.dem||s))continue;const d=(e<2?1:5)-e,p=l.borderDoneWithNeighborZ[d]!==a.canonical.z,y=l.borderFeatureIndices[d];let x=0;if(a.canonical.z!==l.canonical.z){for(const t of n)a.showCentroid(a.featuresOnBorder[t]);if(p)for(const t of y)l.showCentroid(l.featuresOnBorder[t]);a.borderDoneWithNeighborZ[e]=l.canonical.z,l.borderDoneWithNeighborZ[d]=a.canonical.z}for(const i of n){const n=a.featuresOnBorder[i],o=a.centroidData[n.centroidDataIndex],u=n.borders[e];let p;for(;x<y.length;){p=l.featuresOnBorder[y[x]];const t=p.borders[d];if(t[1]>u[0]+3||t[0]>u[0]-3)break;l.showCentroid(p),x++}if(p&&x<y.length){const i=x;let v=0;for(;!(p.borders[d][0]>u[1]-3)&&(v++,++x!==y.length);)p=l.featuresOnBorder[y[x]];if(p=l.featuresOnBorder[y[i]],v>1){const t=p.borders[d];Math.abs(u[0]-t[0])<3&&Math.abs(u[1]-t[1])<3&&(v=1,x=i+1)}else if(0===v){a.showCentroid(n);continue}const b=l.centroidData[p.centroidDataIndex];s&&1===v&&(((g=o).flags|(_=b).flags)&t.b$?(g.flags|=t.b$,_.flags|=t.b$):(g.flags&=~t.b$,_.flags&=~t.b$));const w=n.intersectsCount()>1||p.intersectsCount()>1;if(v>1)x=i,o.centroidXY=b.centroidXY=new t.P(0,0);else if(h&&h.dem&&!w){const n=f[e](o,b),i=e%2?t.a3-1:0,a=m(n[0],Math.min(t.a3-1,n[1]),i,h,r,e<2,n[2]);o.centroidXY=b.centroidXY=c(a)}else w?o.centroidXY=b.centroidXY=new t.P(0,0):(o.centroidXY=a.encodeBorderCentroid(n),b.centroidXY=l.encodeBorderCentroid(p));a.writeCentroidToBuffer(o),l.writeCentroidToBuffer(b)}else a.showCentroid(n)}a.borderDoneWithNeighborZ[e]=l.canonical.z,l.borderDoneWithNeighborZ[d]=a.canonical.z}var g,_;(a.needsCentroidUpdate||!a.centroidVertexBuffer&&0!==a.centroidVertexArray.length)&&a.uploadCentroid(e)}const Ri=[1,0,0],Fi=[0,1,0],Ni=[0,0,1];function ji(e,n,i){const a=i.transform,r=i.shadowRenderer;if(!r)return!0;const o=e.toUnwrapped(),s=a.tileSize*r._cascades[i.currentShadowCascade].scale;let l=n.maxHeight;if(a.elevation){const t=a.elevation.getMinMaxForTile(e);t&&(l+=t.max)}const c=[...r.shadowDirection];c[2]=-c[2];const u=r.computeSimplifiedTileShadowVolume(o,l,s,c);if(!u)return!1;const h=[Ri,Fi,Ni,c,[c[0],0,c[2]],[0,c[1],c[2]]],d="globe"===a.projection.name,p=a.scaleZoom(s),f=t.aM.fromInvProjectionMatrix(a.invProjMatrix,a.worldSize,p,!d),m=r.getCurrentCascadeFrustum();return 0===f.intersectsPrecise(u.vertices,u.planes,h)||0===m.intersectsPrecise(u.vertices,u.planes,h)}function Vi(e){return[e[0]*t.c2,e[1]*t.c2,e[2]*t.c2,0]}function Ui(e,n,i,a,r,o,s,l,c){const u=a.getSource(),h=i.globeSharedBuffers;if(!h)return;let d,p,f;if(n&&(d=a.getTile(n)),u instanceof t.bm?(p=u.texture,f=t.bh(0,0,i.transform)):d&&n&&(p=d.texture,f=t.bh(n.canonical.z,n.canonical.x,i.transform)),!p||!f)return;e||(f=t.ad.scale(t.ad.create(),f,[1,-1,1]));const m=i.context,g=m.gl,_="nearest"===r.paint.get("raster-resampling")?g.NEAREST:g.LINEAR,y=i.colorModeForDrapableLayerRenderPass(o),x=s.defines;x.push("GLOBE_POLES");const v=new t.ae(g.LEQUAL,t.ae.ReadWrite,i.depthRangeFor3D),b=Float32Array.from(i.transform.expandedFarZProjMatrix),w=Float32Array.from(t.bf(t.bg(new t.aO(0,0,0))));i.terrain&&i.terrain.prepareDrawTile(),m.activeTexture.set(g.TEXTURE0),p.bind(_,g.CLAMP_TO_EDGE),m.activeTexture.set(g.TEXTURE1),p.bind(_,g.CLAMP_TO_EDGE),p.useMipmap&&m.extTextureFilterAnisotropic&&i.transform.pitch>20&&g.texParameterf(g.TEXTURE_2D,m.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,m.extTextureFilterAnisotropicMax);const[A,C,E,T]=n?h.getPoleBuffers(n.canonical.z,!1):h.getPoleBuffers(0,!0),S=r.paint.get("raster-elevation");let M;e?(M=A,i.renderDefaultNorthPole=0!==S):(M=C,i.renderDefaultSouthPole=0!==S);const k=Vi(s.mix),I=((t,e,n,i,a,r,o,s,l,c,u,h,d)=>ri(t,e,n,new Float32Array(16),new Float32Array(9),[0,0],i,[0,0],[0,0,0,0],1,{opacity:1,mix:0},r,[0,0]||0,s,2,c,u,h,1,0,d))(b,w,f,t.a1(i.transform.zoom),0,r,0,S,0,k,s.offset,s.range,o),P=i.getOrCreateProgram("raster",{defines:x});i.uploadCommonUniforms(m,P,null),P.draw(i,g.TRIANGLES,v,c,y,l,I,r.id,M,E,T)}function Gi(t){const e=t._nearZ,n=t.projection.farthestPixelDistance(t),i=n-e,a=.2*t.height,r=e+a;return[e,n,(r-a-e)/i,(r-e)/i]}function qi(e,n,i,a){if(e)return n instanceof Dn&&e instanceof t.c3?n.getTextureDescriptor(e,i,!0):{texture:e.texture,mix:Vi(a.mix),offset:a.offset,buffer:0,tileSize:1}}function $i(e,n,i){if(!e)return null;const a=n.getTextureDescriptor(e,i,!0);if(!a)return null;let{texture:r,mix:o,offset:s,tileSize:l,buffer:c,format:u}=a;if(!r||!u)return null;let h=!1;return"uint32"===u&&(h=!0,o[3]=0,o=ii(t.c4,o,[0,i.paint.get("raster-particle-max-speed")]),s=ai(t.c4,s,[0,i.paint.get("raster-particle-max-speed")])),{texture:r,textureOffset:[c/(l+2*c),l/(l+2*c)],tileSize:l,scalarData:h,scale:o,offset:s,defines:["RASTER_ARRAY",{uint8:"DATA_FORMAT_UINT8",uint16:"DATA_FORMAT_UINT16",uint32:"DATA_FORMAT_UINT32"}[u]]}}function Wi(t){const e=t._nearZ,n=t.projection.farthestPixelDistance(t),i=n-e,a=.2*t.height,r=e+a;return[e,n,(r-a-e)/i,(r-e)/i]}const Hi=new t.C(1,0,0,1),Zi=new t.C(0,1,0,1),Yi=new t.C(0,0,1,1),Xi=new t.C(1,0,1,1),Ki=new t.C(0,1,1,1);function Qi(e,n,i,a,r,o,s){const l=e.context,c=e.transform,u=l.gl,h="globe"===c.projection.name,d=h?["PROJECTION_GLOBE_VIEW"]:[];let p=t.ad.clone(i.projMatrix);if(h&&t.a1(c.zoom)>0){const e=t.c5(i.canonical,c),n=t.c6(e);p=t.ad.multiply(new Float32Array(16),c.globeMatrix,n),t.ad.multiply(p,c.projMatrix,p)}const f=t.ad.create();f[12]+=2*r/(t.e.devicePixelRatio*c.width),f[13]+=2*o/(t.e.devicePixelRatio*c.height),t.ad.multiply(p,f,p);const m=e.getOrCreateProgram("debug",{defines:d}),g=n.getTileByID(i.key);e.terrain&&e.terrain.setupElevationDraw(g,m);const _=t.ae.disabled,y=t.ag.disabled,x=e.colorModeForRenderPass(),v="$debug";l.activeTexture.set(u.TEXTURE0),e.emptyTexture.bind(u.LINEAR,u.CLAMP_TO_EDGE),h?g._makeGlobeTileDebugBuffers(e.context,c):g._makeDebugTileBoundsBuffers(e.context,c.projection);const b=g._tileDebugBuffer||e.debugBuffer,w=g._tileDebugIndexBuffer||e.debugIndexBuffer,A=g._tileDebugSegments||e.debugSegments;if(m.draw(e,u.LINE_STRIP,_,y,x,t.af.disabled,ti(p,a),v,b,w,A,null,null,null,[g._globeTileDebugBorderBuffer]),s){const t=g.latestRawTileData,n=Math.floor((t&&t.byteLength||0)/1024);let a=i.canonical.toString();i.overscaledZ!==i.canonical.z&&(a+=` => ${i.overscaledZ}`),a+=` ${g.state}`,a+=` ${n}kb`,function(t,e){t.initDebugOverlayCanvas();const n=t.debugOverlayCanvas,i=t.context.gl,a=t.debugOverlayCanvas.getContext("2d");a.clearRect(0,0,n.width,n.height),a.shadowColor="white",a.shadowBlur=2,a.lineWidth=1.5,a.strokeStyle="white",a.textBaseline="top",a.font="bold 36px Open Sans, sans-serif",a.fillText(e,5,5),a.strokeText(e,5,5),t.debugOverlayTexture.update(n),t.debugOverlayTexture.bind(i.LINEAR,i.CLAMP_TO_EDGE)}(e,a)}const C=n.getTile(i).tileSize,E=512/Math.min(C,512)*(i.overscaledZ/c.zoom)*.5,T=g._tileDebugTextBuffer||e.debugBuffer,S=g._tileDebugTextIndexBuffer||e.quadTriangleIndexBuffer,M=g._tileDebugTextSegments||e.debugSegments;m.draw(e,u.TRIANGLES,_,y,t.a.alphaBlended,t.af.disabled,ti(p,t.C.transparent,E),v,T,S,M,null,null,null,[g._globeTileDebugTextBuffer])}function Ji(t,e,n,i){ea(t,0,e+n/2,t.transform.width,n,i)}function ta(t,e,n,i){ea(t,e-n/2,0,n,t.transform.height,i)}function ea(e,n,i,a,r,o){const s=e.context,l=s.gl;l.enable(l.SCISSOR_TEST),l.scissor(n*t.e.devicePixelRatio,i*t.e.devicePixelRatio,a*t.e.devicePixelRatio,r*t.e.devicePixelRatio),s.clear({color:o}),l.disable(l.SCISSOR_TEST)}const na=t.c7([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:ia}=na;function aa(t,e,n,i){t.emplaceBack(e,n,i)}class ra{constructor(e){this.vertexArray=new t.c8,this.indices=new t.bu,aa(this.vertexArray,-1,-1,1),aa(this.vertexArray,1,-1,1),aa(this.vertexArray,-1,1,1),aa(this.vertexArray,1,1,1),aa(this.vertexArray,-1,-1,-1),aa(this.vertexArray,1,-1,-1),aa(this.vertexArray,-1,1,-1),aa(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=e.createVertexBuffer(this.vertexArray,ia),this.indexBuffer=e.createIndexBuffer(this.indices),this.segment=t.b.simpleSegment(0,0,36,12)}}function oa(e,n,i,a,r,o){const s=e.context.gl,l=n.paint.get("sky-atmosphere-color"),c=n.paint.get("sky-atmosphere-halo-color"),u=n.paint.get("sky-atmosphere-sun-intensity"),h=((t,e,n,i,a)=>({u_matrix_3f:t,u_sun_direction:e,u_sun_intensity:n,u_color_tint_r:[i.r,i.g,i.b,i.a],u_color_tint_m:[a.r,a.g,a.b,a.a],u_luminance:5e-5}))(t.bC.fromMat4(t.bC.create(),a),r,u,l,c);s.framebufferTexture2D(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.TEXTURE_CUBE_MAP_POSITIVE_X+o,n.skyboxTexture,0),i.draw(e,s.TRIANGLES,t.ae.disabled,t.ag.disabled,t.a.unblended,t.af.frontCW,h,"skyboxCapture",n.skyboxGeometry.vertexBuffer,n.skyboxGeometry.indexBuffer,n.skyboxGeometry.segment)}const sa=t.c7([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class la{constructor(e){const n=new t.c9;n.emplaceBack(-1,1,1,0,0),n.emplaceBack(1,1,1,1,0),n.emplaceBack(1,-1,1,1,1),n.emplaceBack(-1,-1,1,0,1);const i=new t.bu;i.emplaceBack(0,1,2),i.emplaceBack(2,3,0),this.vertexBuffer=e.createVertexBuffer(n,sa.members),this.indexBuffer=e.createIndexBuffer(i),this.segments=t.b.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const ca=t.c7([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_size_scale",components:1},{type:"Float32",name:"a_fade_opacity",components:1}]);class ua{constructor(){this.starsCount=16e3,this.sizeMultiplier=.15,this.sizeRange=100,this.intensityRange=200}}class ha{constructor(e){this.colorModeAlphaBlendedWriteRGB=new t.a([t.ca,t.cb,t.ca,t.cb],t.C.transparent,[!0,!0,!0,!1]),this.colorModeWriteAlpha=new t.a([t.ca,t.cc,t.ca,t.cc],t.C.transparent,[!1,!1,!1,!0]),this.params=new ua,this.updateNeeded=!0,e.tp.registerParameter(this.params,["Stars"],"starsCount",{min:100,max:16e3,step:1},(()=>{this.updateNeeded=!0})),e.tp.registerParameter(this.params,["Stars"],"sizeMultiplier",{min:.01,max:2,step:.01}),e.tp.registerParameter(this.params,["Stars"],"sizeRange",{min:0,max:200,step:1},(()=>{this.updateNeeded=!0})),e.tp.registerParameter(this.params,["Stars"],"intensityRange",{min:0,max:200,step:1},(()=>{this.updateNeeded=!0}))}update(e){const n=e.context;if(!this.atmosphereBuffer||this.updateNeeded){this.updateNeeded=!1,this.atmosphereBuffer=new la(n);const e=this.params.sizeRange,i=this.params.intensityRange,a=function(e){const n=t.cf(30),i=[];for(let a=0;a<e;++a){const e=2*Math.PI*n(),a=Math.acos(1-2*n())-.5*Math.PI;i.push(t._.fromValues(Math.cos(a)*Math.cos(e),Math.cos(a)*Math.sin(e),Math.sin(a)))}return i}(this.params.starsCount),r=t.cf(300),o=new t.cd,s=new t.bu;let l=0;for(let n=0;n<a.length;++n){const c=t._.scale([],a[n],200),u=Math.max(0,1+.01*e*(1*r()-.5)),h=Math.max(0,1+.01*i*(1*r()-.5));o.emplaceBack(c[0],c[1],c[2],-1,-1,u,h),o.emplaceBack(c[0],c[1],c[2],1,-1,u,h),o.emplaceBack(c[0],c[1],c[2],1,1,u,h),o.emplaceBack(c[0],c[1],c[2],-1,1,u,h),s.emplaceBack(l+0,l+1,l+2),s.emplaceBack(l+0,l+2,l+3),l+=4}this.starsVx=n.createVertexBuffer(o,ca.members),this.starsIdx=n.createIndexBuffer(s),this.starsSegments=t.b.simpleSegment(0,0,o.length,s.length)}}destroy(){this.atmosphereBuffer&&this.atmosphereBuffer.destroy(),this.starsVx&&this.starsVx.destroy(),this.starsIdx&&this.starsIdx.destroy()}drawAtmosphereGlow(e,n){const i=e.context,a=i.gl,r=e.transform,o=new t.ae(a.LEQUAL,t.ae.ReadOnly,[0,1]),s=t.a1(r.zoom),l=e.style.getLut(n.scope),c=n.properties.get("color").toRenderColor(l).toArray01(),u=n.properties.get("high-color").toRenderColor(l).toArray01(),h=n.properties.get("space-color").toRenderColor(l).toArray01PremultipliedAlpha(),d=5e-4,p=t.ce(n.properties.get("horizon-blend"),0,1,d,.25),f=t.ba(e,i,r)&&p===d?r.worldSize/(2*Math.PI*1.025)-1:r.globeRadius,m=e.frameCounter/1e3%1,g=t._.length(r.globeCenterInViewSpace),_=Math.sqrt(Math.pow(g,2)-Math.pow(f,2)),y=Math.acos(_/g),x=n=>{const l="globe"===r.projection.name?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"];n&&l.push("ALPHA_PASS");const d=e.getOrCreateProgram("globeAtmosphere",{defines:l}),f=((t,e,n,i,a,r,o,s,l,c,u,h)=>({u_frustum_tl:t,u_frustum_tr:e,u_frustum_br:n,u_frustum_bl:i,u_horizon:a,u_transition:r,u_fadeout_range:o,u_color:s,u_high_color:l,u_space_color:c,u_temporal_offset:u,u_horizon_angle:h}))(r.frustumCorners.TL,r.frustumCorners.TR,r.frustumCorners.BR,r.frustumCorners.BL,r.frustumCorners.horizon,s,p,c,u,h,m,y);e.uploadCommonUniforms(i,d);const g=this.atmosphereBuffer;g&&d.draw(e,a.TRIANGLES,o,t.ag.disabled,n?this.colorModeWriteAlpha:this.colorModeAlphaBlendedWriteRGB,t.af.backCW,f,n?"atmosphere_glow_alpha":"atmosphere_glow",g.vertexBuffer,g.indexBuffer,g.segments)};x(!1),x(!0)}drawStars(e,n){const i=t.at(n.properties.get("star-intensity"),0,1);if(0===i)return;const a=e.context,r=a.gl,o=e.transform,s=e.getOrCreateProgram("stars"),l=t.av.identity([]);t.av.rotateX(l,l,-o._pitch),t.av.rotateZ(l,l,-o.angle),t.av.rotateX(l,l,t.ab(o._center.lat)),t.av.rotateY(l,l,-t.ab(o._center.lng));const c=t.ad.fromQuat(new Float32Array(16),l),u=t.ad.multiply([],o.starsProjMatrix,c),h=t.bC.fromMat4([],c),d=t.bC.invert([],h),p=[0,1,0];t._.transformMat3(p,p,d),t._.scale(p,p,this.params.sizeMultiplier);const f=[1,0,0];t._.transformMat3(f,f,d),t._.scale(f,f,this.params.sizeMultiplier);const m=(g=p,_=f,y=i,{u_matrix:Float32Array.from(u),u_up:g,u_right:_,u_intensity_multiplier:y});var g,_,y;e.uploadCommonUniforms(a,s),this.starsVx&&this.starsIdx&&s.draw(e,r.TRIANGLES,t.ae.disabled,t.ag.disabled,this.colorModeAlphaBlendedWriteRGB,t.af.disabled,m,"atmosphere_stars",this.starsVx,this.starsIdx,this.starsSegments)}}function da(e,n){const i=[...e],a=n.cameraWorldSizeForFog/n.worldSize,r=t.ad.identity([]);return t.ad.scale(r,r,[a,a,1]),t.ad.multiply(i,r,i),t.ad.multiply(i,n.worldToFogMatrix,i),i}function pa(e,n,i,a,r){const o=i.material,s=a.context,{baseColorTexture:l,metallicRoughnessTexture:c}=o.pbrMetallicRoughness,{normalTexture:u,occlusionTexture:h,emissionTexture:d}=o;function p(t,n,i){if(t&&(e.push(n),s.activeTexture.set(s.gl.TEXTURE0+i),t.gfxTexture)){const{minFilter:e,magFilter:n,wrapS:i,wrapT:a}=t.sampler;t.gfxTexture.bindExtraParam(e,n,i,a)}}p(l,"HAS_TEXTURE_u_baseColorTexture",gn.BaseColor),p(c,"HAS_TEXTURE_u_metallicRoughnessTexture",gn.MetallicRoughness),p(u,"HAS_TEXTURE_u_normalTexture",gn.Normal),p(h,"HAS_TEXTURE_u_occlusionTexture",gn.Occlusion),p(d,"HAS_TEXTURE_u_emissionTexture",gn.Emission),r&&(r.texture||(r.texture=new t.ch(a.context,r.image,[r.image.height,r.image.height,r.image.height],s.gl.RGBA)),s.activeTexture.set(s.gl.TEXTURE0+gn.LUT),r.texture&&r.texture.bind(s.gl.LINEAR,s.gl.CLAMP_TO_EDGE),e.push("APPLY_LUT_ON_GPU")),i.texcoordBuffer&&(e.push("HAS_ATTRIBUTE_a_uv_2f"),n.push(i.texcoordBuffer)),i.colorBuffer&&(e.push(12===i.colorBuffer.itemSize?"HAS_ATTRIBUTE_a_color_3f":"HAS_ATTRIBUTE_a_color_4f"),n.push(i.colorBuffer)),i.normalBuffer&&(e.push("HAS_ATTRIBUTE_a_normal_3f"),n.push(i.normalBuffer)),i.pbrBuffer&&(e.push("HAS_ATTRIBUTE_a_pbr"),e.push("HAS_ATTRIBUTE_a_heightBasedEmissiveStrength"),n.push(i.pbrBuffer)),"OPAQUE"!==o.alphaMode&&"MASK"!==o.alphaMode||e.push("UNPREMULT_TEXTURE_IN_SHADER"),o.defined||e.push("DIFFUSE_SHADED"),e.push("USE_STANDARD_DERIVATIVES")}function fa(e,n,i,a,r,o){const s=i.paint.get("model-opacity"),l=n.context,c=new t.ae(n.context.gl.LEQUAL,t.ae.ReadWrite,n.depthRangeFor3D),u=n.transform,h=e.mesh,d=h.material,p=d.pbrMetallicRoughness,f=n.style.fog;let m;m="pixels"===n.transform.projection.zAxisUnit?[...e.nodeModelMatrix]:t.ad.multiply([],a.zScaleMatrix,e.nodeModelMatrix),t.ad.multiply(m,a.negCameraPosMatrix,m);const g=t.ad.invert([],m);t.ad.transpose(g,g);const _=i.paint.get("model-emissive-strength").constantOr(0),y=yi(new Float32Array(e.worldViewProjection),new Float32Array(m),new Float32Array(g),null,n,s,p.baseColorFactor.toRenderColor(null),d.emissiveFactor,p.metallicFactor,p.roughnessFactor,d,_,i),x={defines:[]},v=[];pa(x.defines,v,h,n,i.lut);const b=n.shadowRenderer;b&&(b.useNormalOffset=!1);let w=null;if(f){const t=da(e.nodeModelMatrix,n.transform);if(w=new Float32Array(t),"globe"!==u.projection.name){const e=h.aabb.min,n=h.aabb.max,[i,a]=f.getOpacityForBounds(t,e[0],e[1],n[0],n[1]);x.overrideFog=i>=ne||a>=ne}}const A=_n(n,i.paint.get("model-cutoff-fade-range"));A.shouldRenderCutoff&&x.defines.push("RENDER_CUTOFF");const C=n.getOrCreateProgram("model",x);n.uploadCommonUniforms(l,C,null,w,A),"shadow"!==n.renderPass&&b&&b.setupShadowsFromMatrix(e.nodeModelMatrix,C),C.draw(n,l.gl.TRIANGLES,c,r,o,h.material.doubleSided?t.af.disabled:t.af.backCCW,y,i.id,h.vertexBuffer,h.indexBuffer,h.segments,i.paint,n.transform.zoom,void 0,v)}function ma(e,n,i,a,r,o,s){let l;l="globe"===e.projection.name?t.ci(i,e):[...i],t.ad.multiply(l,l,n.matrix);const c=t.ad.multiply([],a,l);if(n.meshes)for(const e of n.meshes){if("BLEND"!==e.material.alphaMode){s.push({mesh:e,depth:0,modelIndex:r,worldViewProjection:c,nodeModelMatrix:l});continue}const n=t._.transformMat4([],e.centroid,c);n[2]>0&&o.push({mesh:e,depth:n[2],modelIndex:r,worldViewProjection:c,nodeModelMatrix:l})}if(n.children)for(const t of n.children)ma(e,t,i,a,r,o,s)}function ga(e,n,i,a){const r=i.shadowRenderer;if(!r)return;const o=r.getShadowPassDepthMode(),s=r.getShadowPassColorMode(),l=r.calculateShadowPassMatrixFromMatrix(n),c=xi(l);i.getOrCreateProgram("modelDepth",{defines:i._shadowMapDebug?[]:["DEPTH_TEXTURE"]}).draw(i,i.context.gl.TRIANGLES,o,t.ag.disabled,s,t.af.backCCW,c,a.id,e.vertexBuffer,e.indexBuffer,e.segments,a.paint,i.transform.zoom,void 0,void 0)}function _a(e,n,i){const a=n.updateZoomBasedPaintProperties(),r=function(e,n,i){let a,r,o,s=e.terrain?e.terrain.exaggeration():0;if(e.terrain&&s>0){const n=e.terrain,r=n.findDEMTileFor(i);r&&r.dem?a=t.ck.create(n,i,r):s=0}if(0===s&&(n.terrainElevationMin=0,n.terrainElevationMax=0),s===n.validForExaggeration&&(0===s||a&&a._demTile&&a._demTile.tileID===n.validForDEMTile.id&&a._dem._timestamp===n.validForDEMTile.timestamp))return!1;for(const t in n.instancesPerModel){const e=n.instancesPerModel[t];for(let t=0;t<e.instancedDataArray.length;++t){const i=(a?s*a.getElevationAt(0|e.instancedDataArray.float32[16*t],0|e.instancedDataArray.float32[16*t+1],!0,!0):0)+e.instancesEvaluatedElevation[t];e.instancedDataArray.float32[16*t+6]=i,r=r?Math.min(n.terrainElevationMin,i):i,o=o?Math.max(n.terrainElevationMax,i):i}}return n.terrainElevationMin=r||0,n.terrainElevationMax=o||0,n.validForExaggeration=s,n.validForDEMTile=a&&a._demTile?{id:a._demTile.tileID,timestamp:a._dem._timestamp}:{id:void 0,timestamp:0},!0}(e,n,i);(a||r)&&(n.uploaded=!1,n.upload(e.context))}const ya={shadowUniformsInitialized:!1,useSingleShadowCascade:!1,tileMatrix:new Float64Array(16),shadowTileMatrix:new Float32Array(16),aabb:new t.b6([0,0,0],[t.a3,t.a3,0])};function xa(e,n){const i=1<<e.canonical.z,a=n.getFreeCameraOptions().position,r=n.elevation,o=e.canonical.x/i,s=(e.canonical.x+1)/i,l=e.canonical.y/i,c=(e.canonical.y+1)/i;let u=n._centerAltitude;if(r){const t=r.getMinMaxForTile(e);t&&t.max>u&&(u=t.max)}const h=t.at(a.x,o,s)-a.x,d=t.at(a.y,l,c)-a.y,p=t.ax(u,n.center.lat)-a.z;return n._zoomFromMercatorZ(Math.sqrt(h*h+d*d+p*p))}function va(e,n,i,a,r,o,s){const l=e.context,c="shadow"===e.renderPass,u=e.shadowRenderer,h=c&&u?u.getShadowPassDepthMode():new t.ae(l.gl.LEQUAL,t.ae.ReadWrite,e.depthRangeFor3D),d=e.isTileAffectedByFog(o);if(i.meshes)for(const p of i.meshes){const f=["MODEL_POSITION_ON_GPU"],m=[];let g,_,y;a.instancedDataArray.length>20&&f.push("INSTANCED_ARRAYS");const x=_n(e,n.paint.get("model-cutoff-fade-range"));if(x.shouldRenderCutoff&&f.push("RENDER_CUTOFF"),c&&u)g=e.getOrCreateProgram("modelDepth",{defines:f}),_=xi(s.shadowTileMatrix,s.shadowTileMatrix,Float32Array.from(i.matrix)),y=u.getShadowPassColorMode();else{pa(f,m,p,e,n.lut),g=e.getOrCreateProgram("model",{defines:f,overrideFog:d});const a=p.material,c=a.pbrMetallicRoughness,h=n.paint.get("model-opacity"),v=n.paint.get("model-emissive-strength").constantOr(0);_=yi(o.expandedProjMatrix,Float32Array.from(i.matrix),new Float32Array(16),null,e,h,c.baseColorFactor.toRenderColor(null),a.emissiveFactor,c.metallicFactor,c.roughnessFactor,a,v,n,r),u&&(s.shadowUniformsInitialized?g.setShadowUniformValues(l,u.getShadowUniformValues()):(u.setupShadows(o.toUnwrapped(),g,"model-tile",o.overscaledZ),s.shadowUniformsInitialized=!0)),y=x.shouldRenderCutoff||h<1||"OPAQUE"!==a.alphaMode?t.a.alphaBlended:t.a.unblended}e.uploadCommonUniforms(l,g,o.toUnwrapped(),null,x);const v=p.material.doubleSided?t.af.disabled:t.af.backCCW;if(a.instancedDataArray.length>20)m.push(a.instancedDataBuffer),g.draw(e,l.gl.TRIANGLES,h,t.ag.disabled,y,v,_,n.id,p.vertexBuffer,p.indexBuffer,p.segments,n.paint,e.transform.zoom,void 0,m,a.instancedDataArray.length);else{const i=c?"u_instance":"u_normal_matrix";for(let r=0;r<a.instancedDataArray.length;++r)_[i]=new Float32Array(a.instancedDataArray.arrayBuffer,64*r,16),g.draw(e,l.gl.TRIANGLES,h,t.ag.disabled,y,v,_,n.id,p.vertexBuffer,p.indexBuffer,p.segments,n.paint,e.transform.zoom,void 0,m)}}if(i.children)for(const t of i.children)va(e,n,t,a,r,o,s)}const ba=[1,-1,1];function wa(e,n,i,a){if(!i.modelManager)return!0;const r=i.modelManager;if(!i.shadowRenderer)return!0;const o=i.shadowRenderer,s=n.aabb;let l=!0,c=e.maxHeight;if(0===c){let t=0;for(const n in e.instancesPerModel){const e=r.getModel(n,a);e?t=Math.max(t,Math.max(Math.max(e.aabb.max[0],e.aabb.max[1]),e.aabb.max[2])):l=!1}c=e.maxScale*t*1.41+e.maxVerticalOffset,l&&(e.maxHeight=c)}s.max[2]=c,s.min[2]+=e.terrainElevationMin,s.max[2]+=e.terrainElevationMax,t._.transformMat4(s.min,s.min,n.tileMatrix),t._.transformMat4(s.max,s.max,n.tileMatrix);const u=s.intersects(o.getCurrentCascadeFrustum());return 0===i.currentShadowCascade&&(e.isInsideFirstShadowMapFrustum=2===u),0===u}function Aa(e,n){const i=e.uniformValues.u_cutoff_params[0],a=e.uniformValues.u_cutoff_params[1],r=e.uniformValues.u_cutoff_params[2],o=e.uniformValues.u_cutoff_params[3];return a===i||o===r?1:t.at(((n-i)/(a-i)-r)/(o-r),0,1)}function Ca(e,n,i,a){if(n.pitch<20)return 1;const r=n.getWorldToCameraMatrix(),o=t.ad.multiply([],r,e),s=[...i.min,1];let l=t.aA.transformMat4([],s,o),c=l,u=l;s[1]=i.max[1],l=t.aA.transformMat4([],s,o),c=l[1]<c[1]?l:c,u=l[1]>u[1]?l:u,s[0]=i.max[0],l=t.aA.transformMat4([],s,o),c=l[1]<c[1]?l:c,u=l[1]>u[1]?l:u,s[1]=i.min[1],l=t.aA.transformMat4([],s,o),c=l[1]<c[1]?l:c,u=l[1]>u[1]?l:u;const h=t.at(a[0],0,1),d=100*n.pixelsPerMeter*t.at(a[1],0,1),p=t.at(a[2],0,1),f=t._.lerp([],c,u,h),m=Math.tan(.5*n.fovX),g=-f[2]*m;if(0===d)return f[1]<-Math.abs(g)?p:1;const _=(-Math.abs(g)-f[1])/d,y=(t,e,n)=>(1-n)*t+n*e,x=t.at(y(1,p,_),p,1);return y(1,x,t.at((n.pitch-20)/20,0,1))}class Ea{}class Ta{constructor(){this._storage=new Map}getLinesFromTrianglesBuffer(e,n,i){{const t=this._storage.get(n.id);if(t)return t.lastUsedFrameIdx=e,t.buf}const a=i.gl,r=a.getBufferParameter(a.ELEMENT_ARRAY_BUFFER,a.BUFFER_SIZE),o=new ArrayBuffer(r),s=new Int16Array(o);a.getBufferSubData(a.ELEMENT_ARRAY_BUFFER,0,new Int16Array(o));const l=new t.cm;for(let t=0;t<r/2;t+=3){const e=s[t],n=s[t+1],i=s[t+2];l.emplaceBack(e,n),l.emplaceBack(n,i),l.emplaceBack(i,e)}const c=i.bindVertexArrayOES.current,u=new Ea;return u.buf=new t.I(i,l),u.lastUsedFrameIdx=e,this._storage.set(n.id,u),i.bindVertexArrayOES.set(c),u.buf}update(t){for(const[e,n]of this._storage)t-n.lastUsedFrameIdx>30&&(n.buf.destroy(),this._storage.delete(e))}destroy(){for(const[t,e]of this._storage)e.buf.destroy(),this._storage.delete(t)}}const Sa=t.c7([{type:"Float32",name:"a_offset_xy",components:2}]);class Ma{constructor(e){const n=new t.cn,i=new t.bu;n.emplaceBack(-1,-1),n.emplaceBack(1,-1),n.emplaceBack(1,1),n.emplaceBack(-1,1),i.emplaceBack(0,1,2),i.emplaceBack(0,2,3),this.segments=t.b.simpleSegment(0,0,n.length,i.length),this.vx=e.createVertexBuffer(n,Sa.members),this.idx=e.createIndexBuffer(i)}destroy(){this.vx.destroy(),this.idx.destroy()}}const ka={symbol:function(e,n,i,a,r){if("translucent"!==e.renderPass)return;const o=t.ag.disabled,s=e.colorModeForRenderPass();i.layout.get("text-variable-anchor")&&function(e,n,i,a,r,o,s){const l=n.transform,c="map"===r,u="map"===o;for(const n of e){const e=a.getTile(n),r=e.getBucket(i);if(!r||!r.text||!r.text.segments.get().length)continue;const o=t.aD(r.textSizeData,l.zoom),h=Ci(n,r.getProjection(),l),d=l.calculatePixelsToTileUnitsMatrix(e),p=Ke(h,e.tileID.canonical,u,c,l,r.getProjection(),d),f=r.hasIconTextFit()&&r.hasIconData();if(o){const i=Math.pow(2,l.zoom-e.tileID.overscaledZ);Ii(r,c,u,s,t.bO,l,p,n,i,o,f)}}}(a,e,i,n,i.layout.get("text-rotation-alignment"),i.layout.get("text-pitch-alignment"),r);const l=0!==i.paint.get("icon-opacity").constantOr(1),c=0!==i.paint.get("text-opacity").constantOr(1);void 0!==i.layout.get("symbol-sort-key").constantOr(1)&&(l||c)?Pi(e,n,i,a,o,s):(l&&Pi(e,n,i,a,o,s,{onlyIcons:!0}),c&&Pi(e,n,i,a,o,s,{onlyText:!0}),function(e,n,i,a){if(!e.symbolParams.useOcclusionQueries)return;const r=e.context.gl,o=e.transform,s=i.paint,l=s.get("icon-occlusion-opacity").constantOr(0),c=s.get("text-occlusion-opacity").constantOr(0);if(!i.hasInitialOcclusionOpacityProperties||1===l&&1===c)return;const u="globe"===o.projection.name;for(const s of a){const a=n.getTile(s),l=a.getBucket(i);if(!l)continue;if("mercator"===l.projection.name&&u)continue;if(l.fullyClipped)continue;if("globe"===l.projection.name){t.w(`Occlusion not supported for globe mode. Layer: ${i.type}`);continue}const c=Ci(s,l.getProjection(),o),h=t.ad.fromValues(1,0,0,0,0,1,0,0,0,0,1,0,0,0,e.symbolParams.depthOffset,1),d=t.ad.multiply([],h,c),p="none"!==e.symbolParams.visualizeOcclusions?1:e.symbolParams.occlusionQueryFrameWindow;for(let n=0;n<l.symbolInstances.length;n++){const i=l.symbolInstances.get(n),s=e.style.placement.opacities[i.crossTileID];if(s&&s.isHidden())continue;if((e.frameCounter+n)%p!=0)continue;const c=i.tileAnchorX,u=i.tileAnchorY,h=i.zOffset;let f;if("none"===e.symbolParams.visualizeOcclusions){const t=l.queries.get(n);if(t){if(!t.isFree()){if(!t.isResultAvailable())continue;const e=t.consumeResult();i.occlusionState=0===e?0:1;continue}f=t}else f=new ot(e.context),l.queries.set(n,f)}const m=e.getOrCreateProgram("occlusion"),g=e.symbolParams.occluderSize,_=vi(d,[c,u,h],[o.width,o.height],[g,g],"zPass"===e.symbolParams.visualizeOcclusions?[1,0,0,.8]:[1,.4,.2,.9]);e.terrain&&e.terrain.setupElevationDraw(a,m,{useDepthForOcclusion:!1,labelPlaneMatrixInv:void 0}),"none"===e.symbolParams.visualizeOcclusions&&f&&f.begin();const y=new t.ae("zPass"===e.symbolParams.visualizeOcclusions?e.context.gl.ALWAYS:e.context.gl.LEQUAL,t.ae.ReadOnly,e.depthRangeFor3D);m.draw(e,r.TRIANGLES,y,t.ag.disabled,"none"!==e.symbolParams.visualizeOcclusions?t.a.alphaBlendedNonPremultiplied:t.a.disabled,t.af.disabled,_,"occlusion",e.occlusionBuffers.vx,e.occlusionBuffers.idx,e.occlusionBuffers.segments),"none"===e.symbolParams.visualizeOcclusions&&f&&f.end()}}}(e,n,i,a)),n.map.showCollisionBoxes&&(Ti(e,n,i,a,i.paint.get("text-translate"),i.paint.get("text-translate-anchor"),!0),Ti(e,n,i,a,i.paint.get("icon-translate"),i.paint.get("icon-translate-anchor"),!1))},circle:function(e,n,i,a){if("translucent"!==e.renderPass)return;const r=i.paint.get("circle-opacity"),o=i.paint.get("circle-stroke-width"),s=i.paint.get("circle-stroke-opacity"),l=void 0!==i.layout.get("circle-sort-key").constantOr(1),c=i.paint.get("circle-emissive-strength");if(0===r.constantOr(1)&&(0===o.constantOr(1)||0===s.constantOr(1)))return;const u=e.context,h=u.gl,d=e.transform,p=e.depthModeForSublayer(0,t.ae.ReadOnly),f=t.ag.disabled,m=e.colorModeForDrapableLayerRenderPass(c),g="globe"===d.projection.name,_=[t.aj(d.center.lng),t.ak(d.center.lat)],y=[];for(let r=0;r<a.length;r++){const o=a[r],s=n.getTile(o),c=s.getBucket(i);if(!c||c.projection.name!==d.projection.name)continue;const u=c.programConfigurations.get(i.id),h=t.bR(i),p=e.isTileAffectedByFog(o);g&&h.push("PROJECTION_GLOBE_VIEW");const f=e.getOrCreateProgram("circle",{config:u,defines:h,overrideFog:p}),m=c.layoutVertexBuffer,x=c.globeExtVertexBuffer,v=c.indexBuffer,b=d.projection.createInversionMatrix(d,o.canonical),w={programConfiguration:u,program:f,layoutVertexBuffer:m,globeExtVertexBuffer:x,indexBuffer:v,uniformValues:t.bS(e,o,s,b,_,i),tile:s};if(l){const e=c.segments.get();for(const n of e)y.push({segments:new t.b([n]),sortKey:n.sortKey,state:w})}else y.push({segments:c.segments,sortKey:0,state:w})}l&&y.sort(((t,e)=>t.sortKey-e.sortKey));const x={useDepthForOcclusion:d.depthOcclusionForSymbolsAndCircles};for(const n of y){const{programConfiguration:a,program:r,layoutVertexBuffer:o,globeExtVertexBuffer:s,indexBuffer:l,uniformValues:c,tile:g}=n.state,_=n.segments;e.terrain&&e.terrain.setupElevationDraw(g,r,x),e.uploadCommonUniforms(u,r,g.tileID.toUnwrapped()),r.draw(e,h.TRIANGLES,p,f,m,t.af.disabled,c,i.id,o,l,_,i.paint,d.zoom,a,[s])}},heatmap:function(e,n,i,a){if(0!==i.paint.get("heatmap-opacity"))if("offscreen"===e.renderPass){const r=e.context,o=r.gl,s=t.ag.disabled,l=new t.a([o.ONE,o.ONE,o.ONE,o.ONE],t.C.transparent,[!0,!0,!0,!0]);!function(t,e,n,i){const a=t.gl,r=e.width*i,o=e.height*i;t.activeTexture.set(a.TEXTURE1),t.viewport.set([0,0,r,o]);let s=n.heatmapFbo;if(!s||s&&(s.width!==r||s.height!==o)){s&&s.destroy();const e=a.createTexture();a.bindTexture(a.TEXTURE_2D,e),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR),s=n.heatmapFbo=t.createFramebuffer(r,o,!0,null),function(t,e,n,i,a,r){const o=t.gl;o.texImage2D(o.TEXTURE_2D,0,t.extRenderToTextureHalfFloat?o.RGBA16F:o.RGBA,a,r,0,o.RGBA,t.extRenderToTextureHalfFloat?o.HALF_FLOAT:o.UNSIGNED_BYTE,null),i.colorAttachment.set(n)}(t,0,e,s,r,o)}else a.bindTexture(a.TEXTURE_2D,s.colorAttachment.get()),t.bindFramebuffer.set(s.framebuffer)}(r,e,i,"globe"===e.transform.projection.name?.5:.25),r.clear({color:t.C.transparent});const c=e.transform,u="globe"===c.projection.name,h=u?["PROJECTION_GLOBE_VIEW"]:[],d=u?t.af.frontCCW:t.af.disabled,p=[t.aj(c.center.lng),t.ak(c.center.lat)];for(let f=0;f<a.length;f++){const m=a[f];if(n.hasRenderableParent(m))continue;const g=n.getTile(m),_=g.getBucket(i);if(!_||_.projection.name!==c.projection.name)continue;const y=e.isTileAffectedByFog(m),x=_.programConfigurations.get(i.id),v=e.getOrCreateProgram("heatmap",{config:x,defines:h,overrideFog:y}),{zoom:b}=e.transform;e.terrain&&e.terrain.setupElevationDraw(g,v),e.uploadCommonUniforms(r,v,m.toUnwrapped());const w=c.projection.createInversionMatrix(c,m.canonical);v.draw(e,o.TRIANGLES,t.ae.disabled,s,l,d,ni(e,m,g,w,p,b,i.paint.get("heatmap-intensity")),i.id,_.layoutVertexBuffer,_.indexBuffer,_.segments,i.paint,e.transform.zoom,x,u?[_.globeExtVertexBuffer]:null)}r.viewport.set([0,0,e.width,e.height])}else"translucent"===e.renderPass&&(e.context.setColorMode(e.colorModeForRenderPass()),function(e,n){const i=e.context,a=i.gl,r=n.heatmapFbo;if(!r)return;i.activeTexture.set(a.TEXTURE0),a.bindTexture(a.TEXTURE_2D,r.colorAttachment.get()),i.activeTexture.set(a.TEXTURE1);let o=n.colorRampTexture;o||(o=n.colorRampTexture=new t.T(i,n.colorRamp,a.RGBA)),o.bind(a.LINEAR,a.CLAMP_TO_EDGE),e.getOrCreateProgram("heatmapTexture").draw(e,a.TRIANGLES,t.ae.disabled,t.ag.disabled,e.colorModeForRenderPass(),t.af.disabled,((t,e,n,i)=>({u_image:0,u_color_ramp:1,u_opacity:e.paint.get("heatmap-opacity")}))(0,n),n.id,e.viewportBuffer,e.quadTriangleIndexBuffer,e.viewportSegments,n.paint,e.transform.zoom)}(e,i))},line:function(e,n,i,a){if("translucent"!==e.renderPass)return;const r=i.paint.get("line-opacity"),o=i.paint.get("line-width");if(0===r.constantOr(1)||0===o.constantOr(1))return;const s=i.paint.get("line-emissive-strength"),l=i.paint.get("line-occlusion-opacity"),c=e.context,u=c.gl,h=i.layout.get("line-z-offset"),d=!h.isConstant()||!!h.constantOr(0),p=d?new t.ae(e.depthOcclusion?u.GREATER:u.LEQUAL,t.ae.ReadOnly,e.depthRangeFor3D):e.depthModeForSublayer(0,t.ae.ReadOnly),f=e.colorModeForDrapableLayerRenderPass(s),m=e.terrain&&e.terrain.renderingToTexture,g=m?1:t.e.devicePixelRatio,_=i.paint.get("line-dasharray"),y=_.constantOr(1),x=i.layout.get("line-cap"),v=_.constantOr(null),b=x.constantOr(null),w=i.paint.get("line-pattern"),A=w.constantOr(1),C=w.constantOr(null),E=i.paint.get("line-opacity").constantOr(1);let T=!A&&1!==E||e.depthOcclusion&&l>0&&l<1;const S=i.paint.get("line-gradient"),M=A?"linePattern":"line",k=t.bT(i);let I;if(m&&e.terrain&&e.terrain.clipOrMaskOverlapStencilType()&&(T=!1),0!==l&&e.depthOcclusion){const e=i.paint._values["line-opacity"];e&&e.value&&"constant"===e.value.kind?I=e.value:t.w(`Occlusion opacity for layer ${i.id} is supported only when line-opacity isn't data-driven.`)}if(d&&(e.forceTerrainMode=!0),!d&&0!==l&&e.terrain&&!m)return void t.w(`Occlusion opacity for layer ${i.id} is supported on terrain only if the layer has non-zero line-z-offset.`);const P=T&&d?e.stencilModeFor3D():t.ag.disabled;for(const r of a){const a=n.getTile(r);if(A&&!a.patternsLoaded())continue;const o=a.getBucket(i);if(!o)continue;e.prepareDrawTile();const s=o.programConfigurations.get(i.id),h=e.isTileAffectedByFog(r),_=e.getOrCreateProgram(M,{config:s,defines:d?[...k,"ELEVATED"]:k,overrideFog:h});if(C&&a.imageAtlas){const t=a.imageAtlas.patternPositions[C.toString()];t&&s.setConstantPatternPositions(t)}if(!A&&v&&b&&a.lineAtlas){const t=a.lineAtlas.getDash(v,b);t&&s.setConstantPatternPositions(t)}let[x,w]=i.paint.get("line-trim-offset");if("round"===b||"square"===b){const t=1;x!==w&&(0===x&&(x-=t),1===w&&(w+=t))}const z=m?r.projMatrix:null,D=A?t.bU(e,a,i,z,g,[x,w]):t.bV(e,a,i,z,o.lineClipsArray.length,g,[x,w]);if(S){const a=o.gradients[i.id];let s=a.texture;if(i.gradientVersion!==a.version){let l=256;if(i.stepInterpolant){const i=n.getSource().maxzoom,a=r.canonical.z===i?Math.ceil(1<<e.transform.maxZoom-r.canonical.z):1;l=t.at(t.bW(o.maxLineLength/t.a3*1024*a),256,c.maxTextureSize)}a.gradient=t.bX({expression:i.gradientExpression(),evaluationKey:"lineProgress",resolution:l,image:a.gradient||void 0,clips:o.lineClipsArray}),a.texture?a.texture.update(a.gradient):a.texture=new t.T(c,a.gradient,u.RGBA),a.version=i.gradientVersion,s=a.texture}c.activeTexture.set(u.TEXTURE1),s.bind(i.stepInterpolant?u.NEAREST:u.LINEAR,u.CLAMP_TO_EDGE)}y&&(c.activeTexture.set(u.TEXTURE0),a.lineAtlasTexture&&a.lineAtlasTexture.bind(u.LINEAR,u.REPEAT),s.updatePaintBuffers()),A&&(c.activeTexture.set(u.TEXTURE0),a.imageAtlasTexture&&a.imageAtlasTexture.bind(u.LINEAR,u.CLAMP_TO_EDGE),s.updatePaintBuffers()),d&&e.terrain.setupElevationDraw(a,_),e.uploadCommonUniforms(c,_,r.toUnwrapped());const L=n=>{null!=I&&(I.value=E*l),_.draw(e,u.TRIANGLES,p,n,f,t.af.disabled,D,i.id,o.layoutVertexBuffer,o.indexBuffer,o.segments,i.paint,e.transform.zoom,s,[o.layoutVertexBuffer2,o.patternVertexBuffer,o.zOffsetVertexBuffer]),null!=I&&(I.value=E)};if(T&&!d){const n=e.stencilModeForClipping(r).ref;0===n&&m&&c.clear({stencil:0});const i={func:u.EQUAL,mask:255};D.u_alpha_discard_threshold=.8,L(new t.ag(i,n,255,u.KEEP,u.KEEP,u.INVERT)),D.u_alpha_discard_threshold=0,L(new t.ag(i,n,255,u.KEEP,u.KEEP,u.KEEP))}else T&&d&&(D.u_alpha_discard_threshold=.001),L(d?P:e.stencilModeForClipping(r))}T&&(e.resetStencilClippingMasks(),m&&c.clear({stencil:0})),0===l||e.depthOcclusion||m||e.layersWithOcclusionOpacity.push(e.currentLayer),d&&(e.forceTerrainMode=!1)},fill:function(e,n,i,a){const r=i.paint.get("fill-color"),o=i.paint.get("fill-opacity");if(0===o.constantOr(1))return;const s=i.paint.get("fill-emissive-strength"),l=e.colorModeForDrapableLayerRenderPass(s),c=i.paint.get("fill-pattern"),u=e.opaquePassEnabledForLayer()&&!c.constantOr(1)&&1===r.constantOr(t.C.transparent).a&&1===o.constantOr(0)?"opaque":"translucent";if(e.renderPass===u){const r=e.depthModeForSublayer(1,"opaque"===e.renderPass?t.ae.ReadWrite:t.ae.ReadOnly);Di(e,n,i,a,r,l,!1)}if("translucent"===e.renderPass&&i.paint.get("fill-antialias")){const r=e.depthModeForSublayer(i.getPaintProperty("fill-outline-color")?2:0,t.ae.ReadOnly);Di(e,n,i,a,r,l,!0)}},"fill-extrusion":function(e,n,i,a){const r=i.paint.get("fill-extrusion-opacity"),o=e.context,s=o.gl,l=e.terrain,c=l&&l.renderingToTexture;if(0===r)return;const u=e.conflationActive&&e.style.isLayerClipped(i,n.getSource()),h=e.style.order.indexOf(i.fqid);if(u&&function(t,e,n,i,a){for(const r of i){const i=e.getTile(r).getBucket(n);i&&(i.updateReplacement(r,t.replacementSource,a),i.uploadCentroid(t.context))}}(e,n,i,a,h),l||u)for(const t of a){const a=n.getTile(t).getBucket(i);a&&Oi(e.context,n,t,a,i,l,u)}if("shadow"===e.renderPass&&e.shadowRenderer){const o=e.shadowRenderer;if(l&&r<.65&&i._transitionablePaint._values["fill-extrusion-opacity"].value.expression instanceof t.Z)return;const s=o.getShadowPassDepthMode(),c=o.getShadowPassColorMode();Li(e,n,i,a,s,t.ag.disabled,c,u)}else if("translucent"===e.renderPass){const h=!i.paint.get("fill-extrusion-pattern").constantOr(1),d=i.paint.get("fill-extrusion-color").constantOr(t.C.white);if(!c&&0!==d.a){const o=new t.ae(e.context.gl.LEQUAL,t.ae.ReadWrite,e.depthRangeFor3D);1===r&&h?Li(e,n,i,a,o,t.ag.disabled,t.a.unblended,u):(Li(e,n,i,a,o,t.ag.disabled,t.a.disabled,u),Li(e,n,i,a,o,e.stencilModeFor3D(),e.colorModeForRenderPass(),u),e.resetStencilClippingMasks())}if(e.style.enable3dLights()&&h&&(!l&&"globe"!==e.transform.projection.name||c)){const r=i.paint.get("fill-extrusion-opacity"),h=i.paint.get("fill-extrusion-ambient-occlusion-intensity"),d=i.paint.get("fill-extrusion-ambient-occlusion-ground-radius"),p=i.paint.get("fill-extrusion-flood-light-intensity"),f=i.paint.get("fill-extrusion-flood-light-color").toRenderColor(i.lut).toArray01().slice(0,3),m=h>0&&d>0,g=p>0,_=(t,e,n)=>(1-n)*t+n*e,y=o=>{const l=e.depthModeForSublayer(1,t.ae.ReadOnly,s.LEQUAL,!0),c=i.paint.get(o?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),m=_(.1,3,c),g=e._showOverdrawInspector;if(!g){const c=new t.ag({func:s.ALWAYS,mask:255},255,255,s.KEEP,s.KEEP,s.REPLACE),g=new t.a([s.ONE,s.ONE,s.ONE,s.ONE],t.C.transparent,[!1,!1,!1,!0],s.MIN);Bi(e,n,i,a,l,c,g,t.af.disabled,o,"sdf",r,h,d,p,f,m,u,!1)}{const c=g?t.ag.disabled:new t.ag({func:s.EQUAL,mask:255},255,255,s.KEEP,s.DECR,s.DECR),_=g?e.colorModeForRenderPass():new t.a([s.ONE_MINUS_DST_ALPHA,s.DST_ALPHA,s.ONE,s.ONE],t.C.transparent,[!0,!0,!0,!0]);Bi(e,n,i,a,l,c,_,t.af.disabled,o,"color",r,h,d,p,f,m,u,!1)}};if(c){const c=(o,l,c)=>{const m=e.depthModeForSublayer(1,t.ae.ReadOnly,s.LEQUAL,!1),g=i.paint.get(o?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),y=_(.1,3,g);{const c=new t.a([s.ONE,s.ONE,s.ONE,s.ONE],t.C.transparent,[!1,!1,!1,!0]);Bi(e,n,i,a,m,t.ag.disabled,c,t.af.disabled,o,"clear",r,h,d,p,f,y,u,l)}{const c=new t.ag({func:s.ALWAYS,mask:255},255,255,s.KEEP,s.KEEP,s.REPLACE),g=new t.a([s.ONE,s.ONE,s.ONE,s.ONE],t.C.transparent,[!1,!1,!1,!0],s.MIN);Bi(e,n,i,a,m,c,g,t.af.disabled,o,"sdf",r,h,d,p,f,y,u,l)}{const c=o?s.ZERO:s.ONE_MINUS_DST_ALPHA,g=new t.ag({func:s.EQUAL,mask:255},255,255,s.KEEP,s.DECR,s.DECR),_=new t.a([c,s.DST_ALPHA,s.ONE_MINUS_DST_ALPHA,s.ZERO],t.C.transparent,[!0,!0,!0,!0]);Bi(e,n,i,a,m,g,_,t.af.disabled,o,"color",r,h,d,p,f,y,u,l)}{const g=new t.a([s.ONE,s.ONE,s.ONE,o?s.ZERO:s.ONE],t.C.transparent,[!1,!1,!1,!0],o?s.FUNC_ADD:s.MAX);Bi(e,n,i,a,m,t.ag.disabled,g,t.af.disabled,o,"clear",r,h,d,p,f,y,u,l,c)}};if(m||g){let n;if(e.prepareDrawTile(),l){const e=l.drapeBufferSize[0],i=l.drapeBufferSize[1];n=l.framebufferCopyTexture,n&&(!n||n.size[0]===e&&n.size[1]===i)||(n&&n.destroy(),n=l.framebufferCopyTexture=new t.T(o,new t.i({width:e,height:i}),s.RGBA)),n.bind(s.LINEAR,s.CLAMP_TO_EDGE),s.copyTexImage2D(s.TEXTURE_2D,0,s.RGBA,0,0,e,i,0)}m&&c(!0,!1,n),g&&c(!1,!0,n)}}else m&&y(!0),g&&y(!1)}}},hillshade:function(e,n,i,a){if("offscreen"!==e.renderPass&&"translucent"!==e.renderPass)return;if(e.style.disableElevatedTerrain)return;const r=e.context,o=e.terrain&&e.terrain.renderingToTexture,[s,l]="translucent"!==e.renderPass||o?[{},a]:e.stencilConfigForOverlap(a);for(const a of l){const r=n.getTile(a);if(r.needsHillshadePrepare&&"offscreen"===e.renderPass)Be(e,r,i);else if("translucent"===e.renderPass){const n=e.depthModeForSublayer(0,t.ae.ReadOnly),l=i.paint.get("hillshade-emissive-strength"),c=e.colorModeForDrapableLayerRenderPass(l),u=o&&e.terrain?e.terrain.stencilModeForRTTOverlap(a):s[a.overscaledZ];De(e,a,r,i,n,u,c)}}r.viewport.set([0,0,e.width,e.height]),e.resetStencilClippingMasks()},raster:function(e,n,i,a,r,o){if("translucent"!==e.renderPass)return;if(0===i.paint.get("raster-opacity"))return;const s="globe"===e.transform.projection.name,l=0!==i.paint.get("raster-elevation"),c=l&&s;if(e.renderElevatedRasterBackface&&!c)return;const u=e.context,h=u.gl,d=n.getSource(),p=function(e,n,i,a){const r=n.paint.get("raster-color"),o="raster-array"===e.type,s=[],l=n.paint.get("raster-resampling"),c=n.paint.get("raster-color-mix");let u=n.paint.get("raster-color-range");const h=[c[0],c[1],c[2],0],d=c[3];let p="nearest"===l?a.NEAREST:a.LINEAR;if(o&&(s.push("RASTER_ARRAY"),r||s.push("RASTER_COLOR"),"linear"===l&&s.push("RASTER_ARRAY_LINEAR"),p=a.NEAREST,!u&&e.rasterLayers)){const t=e.rasterLayers.find((({id:t})=>t===n.sourceLayer));t&&t.fields&&t.fields.range&&(u=t.fields.range)}if(u=u||[0,1],r){s.push("RASTER_COLOR"),i.activeTexture.set(a.TEXTURE2),n.updateColorRamp(u);let e=n.colorRampTexture;e||(e=n.colorRampTexture=new t.T(i,n.colorRamp,a.RGBA)),e.bind(a.LINEAR,a.CLAMP_TO_EDGE)}return{mix:h,range:u,offset:d,defines:s,resampling:p}}(d,i,u,h);if(d instanceof t.bm&&!a.length&&!s)return;const f=i.paint.get("raster-emissive-strength"),m=e.colorModeForDrapableLayerRenderPass(f),g=e.terrain&&e.terrain.renderingToTexture,_=!e.options.moving,y="nearest"===i.paint.get("raster-resampling")?h.NEAREST:h.LINEAR;if(d instanceof t.bm&&!a.length&&(d.onNorthPole||d.onSouthPole)){const a=l?e.stencilModeFor3D():t.ag.disabled;return void Ui(!!d.onNorthPole,null,e,n,i,f,p,t.af.disabled,a)}if(!a.length)return;const[x,v]=d instanceof t.bm||g?[{},a]:e.stencilConfigForOverlap(a),b=v[v.length-1].overscaledZ;c&&p.defines.push("PROJECTION_GLOBE_VIEW"),l&&p.defines.push("RENDER_CUTOFF");const w=(a,r,v)=>{for(const w of a){const a=w.toUnwrapped(),A=n.getTile(w);if(g&&(!A||!A.hasData()))continue;u.activeTexture.set(h.TEXTURE0);const C=qi(A,d,i,p);if(!C||!C.texture)continue;const{texture:E,mix:T,offset:S,tileSize:M,buffer:k}=C;let I,P;g?(I=t.ae.disabled,P=w.projMatrix):l?(I=new t.ae(h.LEQUAL,t.ae.ReadWrite,e.depthRangeFor3D),P=s?Float32Array.from(e.transform.expandedFarZProjMatrix):e.transform.calculateProjMatrix(a,_)):(I=e.depthModeForSublayer(w.overscaledZ-b,1===i.paint.get("raster-opacity")?t.ae.ReadWrite:t.ae.ReadOnly,h.LESS),P=e.transform.calculateProjMatrix(a,_));const z=e.terrain&&g?e.terrain.stencilModeForRTTOverlap(w):x[w.overscaledZ],D=o?0:i.paint.get("raster-fade-duration");A.registerFadeDuration(D);const L=n.findLoadedParent(w,0),B=zn(A,L,n,e.transform,D);let O,R;e.terrain&&e.terrain.prepareDrawTile(),u.activeTexture.set(h.TEXTURE0),E.bind(y,h.CLAMP_TO_EDGE),u.activeTexture.set(h.TEXTURE1),L?(L.texture&&L.texture.bind(y,h.CLAMP_TO_EDGE),O=Math.pow(2,L.tileID.overscaledZ-A.tileID.overscaledZ),R=[A.tileID.canonical.x*O%1,A.tileID.canonical.y*O%1]):E.bind(y,h.CLAMP_TO_EDGE),E.useMipmap&&u.extTextureFilterAnisotropic&&e.transform.pitch>20&&h.texParameterf(h.TEXTURE_2D,u.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,u.extTextureFilterAnisotropicMax);const F=e.transform;let N;const j=l?Gi(F):[0,0,0,0];let V,U,G,q,$,W=0;if(c&&d instanceof t.bm&&d.coordinates.length>3)V=Float32Array.from(t.bf(t.bg(new t.aO(0,0,0)))),U=Float32Array.from(F.globeMatrix),G=Float32Array.from(t.bb(F)),q=[t.aj(F.center.lng),t.ak(F.center.lat)],N=d.elevatedGlobePerspectiveTransform,$=d.elevatedGlobeGridMatrix||new Float32Array(9);else if(c){const e=t.bc(w.canonical);W=t.bd(e.getCenter().lat),V=Float32Array.from(t.bf(t.bg(w.canonical))),U=Float32Array.from(F.globeMatrix),G=Float32Array.from(t.bb(F)),q=[t.aj(F.center.lng),t.ak(F.center.lat)],N=[0,0],$=Float32Array.from(t.be(w.canonical,e,W,F.worldSize/F._pixelsPerMercatorPixel))}else N=d instanceof t.bm?d.perspectiveTransform:[0,0],V=new Float32Array(16),U=new Float32Array(9),G=new Float32Array(16),q=[0,0],$=new Float32Array(9);const H=ri(P,V,U,G,$,R||[0,0],t.a1(e.transform.zoom),q,j,O||1,B,i,N,l?i.paint.get("raster-elevation"):0,2,T,S,p.range,M,k,f),Z=e.isTileAffectedByFog(w),Y=e.getOrCreateProgram("raster",{defines:p.defines,overrideFog:Z});if(e.uploadCommonUniforms(u,Y,a),d instanceof t.bm){const n=d.elevatedGlobeVertexBuffer,a=d.elevatedGlobeIndexBuffer;if(g||!s)d.boundsBuffer&&d.boundsSegments&&Y.draw(e,h.TRIANGLES,I,t.ag.disabled,m,t.af.disabled,H,i.id,d.boundsBuffer,e.quadTriangleIndexBuffer,d.boundsSegments);else if(n&&a){const o=F.zoom<=t.b1?d.elevatedGlobeSegments:d.getSegmentsForLongitude(F.center.lng);o&&Y.draw(e,h.TRIANGLES,I,t.ag.disabled,m,r,H,i.id,n,a,o)}}else if(c){I=new t.ae(h.LEQUAL,t.ae.ReadOnly,e.depthRangeFor3D);const n=e.globeSharedBuffers;if(n){const[t,a,o]=n.getGridBuffers(W,!1);Y.draw(e,h.TRIANGLES,I,v||z,e.colorModeForRenderPass(),r,H,i.id,t,a,o)}}else{const{tileBoundsBuffer:n,tileBoundsIndexBuffer:a,tileBoundsSegments:r}=e.getTileBoundsBuffers(A);Y.draw(e,h.TRIANGLES,I,z,m,t.af.disabled,H,i.id,n,a,r)}}if(!(d instanceof t.bm)&&c)for(const o of a){const a=o.canonical.y===(1<<o.canonical.z)-1;0===o.canonical.y&&Ui(!0,o,e,n,i,f,p,r,v||t.ag.disabled),a&&Ui(!1,o,e,n,i,f,p,r===t.af.frontCW?t.af.backCW:t.af.frontCW,v||t.ag.disabled)}};c?w(v,e.renderElevatedRasterBackface?t.af.backCW:t.af.frontCW,e.stencilModeFor3D()):w(v,t.af.disabled,void 0),e.resetStencilClippingMasks()},"raster-particle":function(e,n,i,a,r,o){"offscreen"===e.renderPass&&function(e,n,i,a){if(!a.length)return;const r=e.context,o=r.gl,s=n.getSource();if(!(s instanceof Dn))return;const l=Math.ceil(Math.sqrt(i.paint.get("raster-particle-count")));let c=i.particlePositionRGBAImage;if(!c||c.width!==l){const e=function(t){const e=t*t,n=new Uint8Array(4*e),i=function(t){return t|=0,t=Math.imul(2747636419^t,2654435769),t=Math.imul(t^t>>>16,2654435769),((t=Math.imul(t^t>>>16,2654435769))>>>0)/4294967296},a=1/1.3;for(let t=0;t<e;t++){const e=a*(i(2*t+0)+si),r=a*(i(2*t+1)+si),o=255*e%1,s=255*r%1,l=o,c=r-s/255,u=s;n[4*t+0]=255*(e-o/255),n[4*t+1]=255*l,n[4*t+2]=255*c,n[4*t+3]=255*u}return n}(l);c=i.particlePositionRGBAImage=new t.i({width:l,height:l},e)}let u=i.particleFramebuffer;u?u.width!==l&&(u.destroy(),u=i.particleFramebuffer=r.createFramebuffer(l,l,!0,null)):u=i.particleFramebuffer=r.createFramebuffer(l,l,!0,null);const h=[];for(const e of a){const a=n.getTile(e);if(!(a instanceof t.c3))continue;const o=$i(a,s,i);if(!o)continue;const u=[a.tileSize,a.tileSize];let d=i.tileFramebuffer;d||(d=i.tileFramebuffer=r.createFramebuffer(u[0],u[1],!0,null));let p=a.rasterParticleState;p||(p=a.rasterParticleState=new lt(r,e,u,c));const f=p.update(i.lastInvalidatedAt);p.particleTextureDimension!==l&&p.updateParticleTexture(e,c);const m=p.targetColorTexture;p.targetColorTexture=p.backgroundColorTexture,p.backgroundColorTexture=m;const g=p.particleTexture0;p.particleTexture0=p.particleTexture1,p.particleTexture1=g,h.push([e,o,p,f])}if(0===h.length)return;const d=t.e.now(),p=i.previousDrawTimestamp?.001*(d-i.previousDrawTimestamp):.0167;if(i.previousDrawTimestamp=d,i.hasColorMap()){r.activeTexture.set(o.TEXTURE0+2);let e=i.colorRampTexture;e||(e=i.colorRampTexture=new t.T(r,i.colorRamp,o.RGBA)),e.bind(o.LINEAR,o.CLAMP_TO_EDGE)}r.bindFramebuffer.set(i.tileFramebuffer.framebuffer),function(e,n,i){const a=e.context,r=a.gl,o=n.tileFramebuffer;a.activeTexture.set(r.TEXTURE0);const s={u_texture:0,u_opacity:1.05*(c=n.paint.get("raster-particle-fade-opacity-factor"))/(c+.05)},l=e.getOrCreateProgram("rasterParticleTexture",{defines:[],overrideFog:!1});var c;for(const c of i){const[,,i,u]=c;o.colorAttachment.set(i.targetColorTexture.texture),a.viewport.set([0,0,o.width,o.height]),a.clear({color:t.C.transparent}),u&&(i.backgroundColorTexture.bind(r.NEAREST,r.CLAMP_TO_EDGE),l.draw(e,r.TRIANGLES,t.ae.disabled,t.ag.disabled,t.a.alphaBlended,t.af.disabled,s,n.id,e.viewportBuffer,e.quadTriangleIndexBuffer,e.viewportSegments))}}(e,i,h),function(e,n,i,a){const r=e.context,o=r.gl,s=i.tileFramebuffer,l="globe"===e.transform.projection.name,c=i.paint.get("raster-particle-max-speed");for(const u of a){const[a,h,d]=u;r.activeTexture.set(o.TEXTURE0+0),h.texture.bind(o.LINEAR,o.CLAMP_TO_EDGE),s.colorAttachment.set(d.targetColorTexture.texture);const p=e.getOrCreateProgram("rasterParticleDraw",{defines:h.defines,overrideFog:!1});r.activeTexture.set(o.TEXTURE0+1);const f=h.scalarData?[]:[0,1,2,3].map((e=>t.bZ[e](a)));f.push(a);const m=a.canonical.x,g=a.canonical.y;for(const r of f){const s=n.getTile(l?r.wrapped():r);if(!s)continue;const u=s.rasterParticleState;if(!u)continue;const d=r.canonical.x+(1<<r.canonical.z)*(r.wrap-a.wrap),f=r.canonical.y;u.particleTexture0.bind(o.NEAREST,o.CLAMP_TO_EDGE);const _=ci(1,u.particleTexture0.size[0],[d-m,f-g],0,h.texture.size,2,c,h.textureOffset,h.scale,h.offset);p.draw(e,o.POINTS,t.ae.disabled,t.ag.disabled,t.a.alphaBlended,t.af.disabled,_,i.id,u.particleIndexBuffer,void 0,u.particleSegment)}}}(e,n,i,h),r.bindFramebuffer.set(i.particleFramebuffer.framebuffer),function(e,n,i,a){const r=e.context,o=r.gl,s=n.paint.get("raster-particle-max-speed"),l=a*n.paint.get("raster-particle-speed-factor")*.15,c=function(t){return Math.pow(t,6)}(.01+1*n.paint.get("raster-particle-reset-rate-factor")),u=n.particleFramebuffer;r.viewport.set([0,0,u.width,u.height]);for(const a of i){const[,i,h]=a;r.activeTexture.set(o.TEXTURE0+0),i.texture.bind(o.LINEAR,o.CLAMP_TO_EDGE),r.activeTexture.set(o.TEXTURE0+1);const d=h.particleTexture0;d.bind(o.NEAREST,o.CLAMP_TO_EDGE);const p=ui(1,d.size[0],0,i.texture.size,s,l,c,i.textureOffset,i.scale,i.offset);u.colorAttachment.set(h.particleTexture1.texture),r.clear({color:t.C.transparent}),e.getOrCreateProgram("rasterParticleUpdate",{defines:i.defines}).draw(e,o.TRIANGLES,t.ae.disabled,t.ag.disabled,t.a.unblended,t.af.disabled,p,n.id,e.viewportBuffer,e.quadTriangleIndexBuffer,e.viewportSegments)}}(e,i,h,p)}(e,n,i,a),"translucent"===e.renderPass&&(function(e,n,i,a,r){const o=e.context,s=o.gl,l=!e.options.moving,c="globe"===e.transform.projection.name;if(!a.length)return;const[u,h]=e.stencilConfigForOverlap(a),d=[];c&&d.push("PROJECTION_GLOBE_VIEW");const p=e.stencilModeFor3D();for(const a of h){const r=a.toUnwrapped(),h=n.getTile(a);if(!h.rasterParticleState)continue;const f=h.rasterParticleState,m=100;h.registerFadeDuration(m);const g=n.findLoadedParent(a,0),_=zn(h,g,n,e.transform,m);let y,x;e.terrain&&e.terrain.prepareDrawTile(),o.activeTexture.set(s.TEXTURE0),f.targetColorTexture.bind(s.LINEAR,s.CLAMP_TO_EDGE),o.activeTexture.set(s.TEXTURE1),g&&g.rasterParticleState?(g.rasterParticleState.targetColorTexture.bind(s.LINEAR,s.CLAMP_TO_EDGE),y=Math.pow(2,g.tileID.overscaledZ-h.tileID.overscaledZ),x=[h.tileID.canonical.x*y%1,h.tileID.canonical.y*y%1]):f.targetColorTexture.bind(s.LINEAR,s.CLAMP_TO_EDGE);const v=c?Float32Array.from(e.transform.expandedFarZProjMatrix):e.transform.calculateProjMatrix(r,l),b=e.transform,w=Wi(b),A=t.bc(a.canonical),C=t.bd(A.getCenter().lat);let E,T,S,M,k;c?(E=Float32Array.from(t.bf(t.bg(a.canonical))),T=Float32Array.from(b.globeMatrix),S=Float32Array.from(t.bb(b)),M=[t.aj(b.center.lng),t.ak(b.center.lat)],k=Float32Array.from(t.be(a.canonical,A,C,b.worldSize/b._pixelsPerMercatorPixel))):(E=new Float32Array(16),T=new Float32Array(9),S=new Float32Array(16),M=[0,0],k=new Float32Array(9));const I=li(v,E,T,S,k,x||[0,0],t.a1(e.transform.zoom),M,w,y||1,_,250),P=e.isTileAffectedByFog(a),z=e.getOrCreateProgram("rasterParticle",{defines:d,overrideFog:P});if(e.uploadCommonUniforms(o,z,r),c){const n=new t.ae(s.LEQUAL,t.ae.ReadWrite,e.depthRangeFor3D),a=0,r=e.globeSharedBuffers;if(r){const[o,l,c]=r.getGridBuffers(C,0!==a);z.draw(e,s.TRIANGLES,n,p,t.a.alphaBlended,t.af.backCCW,I,i.id,o,l,c)}}else{const n=e.depthModeForSublayer(0,t.ae.ReadOnly),r=u[a.overscaledZ],{tileBoundsBuffer:o,tileBoundsIndexBuffer:l,tileBoundsSegments:c}=e.getTileBoundsBuffers(h);z.draw(e,s.TRIANGLES,n,r,t.a.alphaBlended,t.af.disabled,I,i.id,o,l,c)}}e.resetStencilClippingMasks()}(e,n,i,a),e.style.map.triggerRepaint())},background:function(e,n,i,a){const r=i.paint.get("background-color"),o=i.paint.get("background-opacity"),s=i.paint.get("background-emissive-strength");if(0===o)return;const l=e.context,c=l.gl,u=e.transform,h=u.tileSize,d=i.paint.get("background-pattern");let p;if(void 0!==d){if(null===d)return;if(p=e.imageManager.getPattern(d.toString(),i.scope,e.style.getLut(i.scope)),!p)return}const f=!d&&1===r.a&&1===o&&e.opaquePassEnabledForLayer()?"opaque":"translucent";if(e.renderPass!==f)return;const m=t.ag.disabled,g=e.depthModeForSublayer(0,"opaque"===f?t.ae.ReadWrite:t.ae.ReadOnly),_=e.colorModeForDrapableLayerRenderPass(s),y=d?"backgroundPattern":"background";let x,v=a;v||(x=e.getBackgroundTiles(),v=Object.values(x).map((t=>t.tileID))),d&&(l.activeTexture.set(c.TEXTURE0),e.imageManager.bind(e.context,i.scope));for(const f of v){const v=e.isTileAffectedByFog(f),b=e.getOrCreateProgram(y,{overrideFog:v}),w=f.toUnwrapped(),A=a?f.projMatrix:e.transform.calculateProjMatrix(w);e.prepareDrawTile();const C=n?n.getTile(f):x?x[f.key]:new t.by(f,h,u.zoom,e),E=d?gi(A,s,o,e,0,i.scope,p,{tileID:f,tileSize:h}):mi(A,s,o,r.toRenderColor(i.lut));e.uploadCommonUniforms(l,b,w);const{tileBoundsBuffer:T,tileBoundsIndexBuffer:S,tileBoundsSegments:M}=e.getTileBoundsBuffers(C);b.draw(e,c.TRIANGLES,g,m,_,t.af.disabled,E,i.id,T,S,M)}},sky:function(e,n,i){const a=e._atmosphere?t.a1(e.transform.zoom):1,r=i.paint.get("sky-opacity")*a;if(0===r)return;const o=e.context,s=i.paint.get("sky-type"),l=new t.ae(o.gl.LEQUAL,t.ae.ReadOnly,[0,1]),c=e.frameCounter/1e3%1;"atmosphere"===s?"offscreen"===e.renderPass?i.needsSkyboxCapture(e)&&(function(e,n,i,a){const r=e.context,o=r.gl;let s=n.skyboxFbo;if(!s){s=n.skyboxFbo=r.createFramebuffer(32,32,!0,null),n.skyboxGeometry=new ra(r),n.skyboxTexture=r.gl.createTexture(),o.bindTexture(o.TEXTURE_CUBE_MAP,n.skyboxTexture),o.texParameteri(o.TEXTURE_CUBE_MAP,o.TEXTURE_WRAP_S,o.CLAMP_TO_EDGE),o.texParameteri(o.TEXTURE_CUBE_MAP,o.TEXTURE_WRAP_T,o.CLAMP_TO_EDGE),o.texParameteri(o.TEXTURE_CUBE_MAP,o.TEXTURE_MIN_FILTER,o.LINEAR),o.texParameteri(o.TEXTURE_CUBE_MAP,o.TEXTURE_MAG_FILTER,o.LINEAR);for(let t=0;t<6;++t)o.texImage2D(o.TEXTURE_CUBE_MAP_POSITIVE_X+t,0,o.RGBA,32,32,0,o.RGBA,o.UNSIGNED_BYTE,null)}r.bindFramebuffer.set(s.framebuffer),r.viewport.set([0,0,32,32]);const l=n.getCenter(e,!0),c=e.getOrCreateProgram("skyboxCapture"),u=new Float64Array(16);t.ad.identity(u),t.ad.rotateY(u,u,.5*-Math.PI),oa(e,n,c,u,l,0),t.ad.identity(u),t.ad.rotateY(u,u,.5*Math.PI),oa(e,n,c,u,l,1),t.ad.identity(u),t.ad.rotateX(u,u,.5*-Math.PI),oa(e,n,c,u,l,2),t.ad.identity(u),t.ad.rotateX(u,u,.5*Math.PI),oa(e,n,c,u,l,3),t.ad.identity(u),oa(e,n,c,u,l,4),t.ad.identity(u),t.ad.rotateY(u,u,Math.PI),oa(e,n,c,u,l,5),r.viewport.set([0,0,e.width,e.height])}(e,i),i.markSkyboxValid(e)):"sky"===e.renderPass&&function(e,n,i,a,r){const o=e.context,s=o.gl,l=e.transform,c=e.getOrCreateProgram("skybox");o.activeTexture.set(s.TEXTURE0),s.bindTexture(s.TEXTURE_CUBE_MAP,n.skyboxTexture);const u=((t,e,n,i,a)=>({u_matrix:t,u_sun_direction:e,u_cubemap:0,u_opacity:i,u_temporal_offset:a}))(l.skyboxMatrix,n.getCenter(e,!1),0,a,r);e.uploadCommonUniforms(o,c),c.draw(e,s.TRIANGLES,i,t.ag.disabled,e.colorModeForRenderPass(),t.af.backCW,u,"skybox",n.skyboxGeometry.vertexBuffer,n.skyboxGeometry.indexBuffer,n.skyboxGeometry.segment)}(e,i,l,r,c):"gradient"===s&&"sky"===e.renderPass&&function(e,n,i,a,r){const o=e.context,s=o.gl,l=e.transform,c=e.getOrCreateProgram("skyboxGradient");n.skyboxGeometry||(n.skyboxGeometry=new ra(o)),o.activeTexture.set(s.TEXTURE0);let u=n.colorRampTexture;u||(u=n.colorRampTexture=new t.T(o,n.colorRamp,s.RGBA)),u.bind(s.LINEAR,s.CLAMP_TO_EDGE);const h=((e,n,i,a,r)=>({u_matrix:e,u_color_ramp:0,u_center_direction:n,u_radius:t.ab(i),u_opacity:a,u_temporal_offset:r}))(l.skyboxMatrix,n.getCenter(e,!1),n.paint.get("sky-gradient-radius"),a,r);e.uploadCommonUniforms(o,c),c.draw(e,s.TRIANGLES,i,t.ag.disabled,e.colorModeForRenderPass(),t.af.backCW,h,"skyboxGradient",n.skyboxGeometry.vertexBuffer,n.skyboxGeometry.indexBuffer,n.skyboxGeometry.segment)}(e,i,l,r,c)},debug:function(e,n,i,a,r,o){for(let s=0;s<i.length;s++)if(r){const r=1,l=.8,c=new t.C(a.r*l,a.g*l,a.b*l,1);Qi(e,n,i[s],a,-r,-r,o),Qi(e,n,i[s],a,-r,r,o),Qi(e,n,i[s],a,r,r,o),Qi(e,n,i[s],a,r,-r,o),Qi(e,n,i[s],c,0,0,o)}else Qi(e,n,i[s],a,0,0,o)},custom:function(e,n,i,a){const r=e.context,o=i.implementation;if(!e.transform.projection.unsupportedLayers||!e.transform.projection.unsupportedLayers.includes("custom")||e.terrain&&(e.terrain.renderingToTexture||"offscreen"===e.renderPass)&&i.isDraped(n)){if("offscreen"===e.renderPass){const n=o.prerender;if(n){if(e.setCustomLayerDefaults(),r.setColorMode(e.colorModeForRenderPass()),"globe"===e.transform.projection.name){const i=e.transform.pointMerc;n.call(o,r.gl,e.transform.customLayerMatrix(),e.transform.getProjection(),e.transform.globeToMercatorMatrix(),t.a1(e.transform.zoom),[i.x,i.y],e.transform.pixelsPerMeterRatio)}else n.call(o,r.gl,e.transform.customLayerMatrix());r.setDirty(),e.setBaseState()}}else if("translucent"===e.renderPass){if(e.terrain&&e.terrain.renderingToTexture){const n=o.renderToTile;if(n){const i=a[0].canonical,s=new t.Y(i.x+a[0].wrap*(1<<i.z),i.y,i.z);r.setDepthMode(t.ae.disabled),r.setStencilMode(t.ag.disabled),r.setColorMode(e.colorModeForRenderPass()),e.setCustomLayerDefaults(),n.call(o,r.gl,s),r.setDirty(),e.setBaseState()}return}e.setCustomLayerDefaults(),r.setColorMode(e.colorModeForRenderPass()),r.setStencilMode(t.ag.disabled);const n="3d"===o.renderingMode?new t.ae(e.context.gl.LEQUAL,t.ae.ReadWrite,e.depthRangeFor3D):e.depthModeForSublayer(0,t.ae.ReadOnly);if(r.setDepthMode(n),"globe"===e.transform.projection.name){const n=e.transform.pointMerc;o.render(r.gl,e.transform.customLayerMatrix(),e.transform.getProjection(),e.transform.globeToMercatorMatrix(),t.a1(e.transform.zoom),[n.x,n.y],e.transform.pixelsPerMeterRatio)}else o.render(r.gl,e.transform.customLayerMatrix());r.setDirty(),e.setBaseState(),r.bindFramebuffer.set(null)}}else t.w("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")},model:function(e,n,i,a){if("opaque"===e.renderPass)return;const r=i.paint.get("model-opacity");if(0===r)return;const o=i.paint.get("model-cast-shadows");if("shadow"===e.renderPass){if(!o)return;if(e.terrain&&r<.65&&i._transitionablePaint._values["model-opacity"].value.expression instanceof t.Z)return}const s=e.shadowRenderer,l=i.paint.get("model-receive-shadows");s&&(s.useNormalOffset=!0,l||(s.enabled=!1));const c=()=>{s&&(s.useNormalOffset=!0,l||(s.enabled=!0))},u=n.getSource();if("light-beam"===e.renderPass&&"batched-model"!==u.type)return;if("vector"===u.type||"geojson"===u.type)return function(e,n,i,a,r){const o=e.transform;if("mercator"!==o.projection.name)return void t.w(`Drawing 3D models for ${o.projection.name} projection is not yet implemented`);const s=o.getFreeCameraOptions().position;if(!e.modelManager)return;const l=e.modelManager;i.modelManager=l;const c=e.shadowRenderer;if(!i._unevaluatedLayout._values.hasOwnProperty("model-id"))return;const u=i._unevaluatedLayout._values["model-id"],h={...i.layout.get("model-id").parameters},d=e.style.order.indexOf(i.fqid);for(const p of a){const a=n.getTile(p).getBucket(i);if(!a||a.projection.name!==o.projection.name)continue;const f=a.getModelUris();f&&!a.modelsRequested&&(l.addModelsFromBucket(f,r),a.modelsRequested=!0);const m=xa(p,o);h.zoom=m;const g=u.possiblyEvaluate(h);if(_a(e,a,p),ya.shadowUniformsInitialized=!1,ya.useSingleShadowCascade=!!c&&0===c.getMaxCascadeForTile(p.toUnwrapped()),"shadow"===e.renderPass&&c){if(1===e.currentShadowCascade&&a.isInsideFirstShadowMapFrustum)continue;const n=o.calculatePosMatrix(p.toUnwrapped(),o.worldSize);if(ya.tileMatrix.set(n),ya.shadowTileMatrix=Float32Array.from(c.calculateShadowPassMatrixFromMatrix(n)),ya.aabb.min.fill(0),ya.aabb.max[0]=ya.aabb.max[1]=t.a3,ya.aabb.max[2]=0,wa(a,ya,e,i.scope))continue}const _=1<<p.canonical.z,y=[((s.x-p.wrap)*_-p.canonical.x)*t.a3,(s.y*_-p.canonical.y)*t.a3,s.z*_*t.a3];e.conflationActive&&Object.keys(a.instancesPerModel).length>0&&e.style.isLayerClipped(i,n.getSource())&&a.updateReplacement(p,e.replacementSource,d)&&(a.uploaded=!1,a.upload(e.context));for(let t in a.instancesPerModel){const n=a.instancesPerModel[t];n.features.length>0&&(t=g.evaluate(n.features[0].feature,{}));const o=l.getModel(t,r);if(o&&o.uploaded)for(const t of o.nodes)va(e,i,t,n,y,p,ya)}}}(e,n,i,a,"vector"===u.type?i.scope:""),void c();if(!u.loaded())return;if("batched-model"===u.type)return function(e,n,i,a){i.resetLayerRenderingStats(e);const r=e.context,o=e.transform,s=e.style.fog,l=e.shadowRenderer;if("mercator"!==o.projection.name)return void t.w(`Drawing 3D landmark models for ${o.projection.name} projection is not yet implemented`);const c=e.transform.getFreeCameraOptions().position,u=t._.scale([],[c.x,c.y,c.z],e.transform.worldSize);t._.negate(u,u);const h=t.ad.identity([]),d=t.cg(o.center.lat,o.zoom),p=t.ad.fromScaling([],[1,1,1/d]);t.ad.translate(h,h,u);const f=i.paint.get("model-opacity"),m=new t.ae(r.gl.LEQUAL,t.ae.ReadWrite,e.depthRangeFor3D),g=new t.ae(r.gl.LEQUAL,t.ae.ReadOnly,e.depthRangeFor3D),_=new t.b6([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),y="shadow"===e.renderPass,x=y&&l?l.getCurrentCascadeFrustum():o.getFrustum(o.scaleZoom(o.worldSize)),v=i.paint.get("model-front-cutoff"),b=v[2]<1,w=_n(e,i.paint.get("model-cutoff-fade-range")),A=i.getLayerRenderingStats();(function(t,e,n,i){const a=t.terrain?t.terrain.exaggeration():0,r=t.transform.zoom;for(const o of i){const i=e.getTile(o).getBucket(n);i&&(t.conflationActive&&i.updateReplacement(o,t.replacementSource),i.evaluateScale(t,n),t.terrain&&a>0&&i.elevationUpdate(t.terrain,a,o,n.source),i.needsReEvaluation(t,r,n)&&i.evaluate(n))}})(e,n,i,a),function(){let c,u,d;b?(c=a.length-1,u=-1,d=-1):(c=0,u=a.length,d=1);for(let C=c;C!==u;C+=d){const c=a[C],u=n.getTile(c).getBucket(i);if(!u||!u.uploaded)continue;let d=!1;l&&(d=0===l.getMaxCascadeForTile(c.toUnwrapped()));const E=o.calculatePosMatrix(c.toUnwrapped(),o.worldSize),T=u.modelTraits,S=[];for(const n of u.getNodesInfo()){if(n.hiddenByReplacement)continue;if(!n.node.meshes)continue;const i=n.node;let a=0;e.terrain&&i.elevation&&(a=i.elevation*e.terrain.exaggeration());const r=n.evaluatedScale;if(r[0]<=1&&r[1]<=1&&r[2]<=1&&0===(()=>{const e=n.aabb;return _.min=[...e.min],_.max=[...e.max],_.min[2]+=a,_.max[2]+=a,t._.transformMat4(_.min,_.min,E),t._.transformMat4(_.max,_.max,E),_})().intersects(x))continue;const s=[...E],l=i.anchor?i.anchor[0]:0,c=i.anchor?i.anchor[1]:0;t.ad.translate(s,s,[l*(r[0]-1),c*(r[1]-1),a]),t._.exactEquals(r,t.cj)||t.ad.scale(s,s,r);const u=t.ad.multiply([],s,i.matrix),h=t.ad.multiply([],o.expandedFarZProjMatrix,u),d=t.ad.multiply([],o.expandedFarZProjMatrix,s),p=t.aA.transformMat4([],[l,c,a,1],h)[2];i.hidden=!1;let m=f;y||(b&&(m*=Ca(s,o,n.aabb,v)),m*=Aa(w,p)),0!==m?S.push({nodeInfo:n,depth:p,opacity:m,wvpForNode:h,wvpForTile:d,nodeModelMatrix:u,tileModelMatrix:s}):i.hidden=!0}y||S.sort(((t,e)=>!b||1===t.opacity&&1===e.opacity?t.depth<e.depth?-1:1:1===t.opacity?-1:1===e.opacity?1:t.depth>e.depth?-1:1));for(const n of S){const a=n.nodeInfo,c=a.node;let u=t.ad.multiply([],p,n.tileModelMatrix);t.ad.multiply(u,h,u);const f=t.ad.invert([],u);t.ad.transpose(f,f),t.ad.scale(f,f,ba),u=t.ad.multiply(u,u,c.matrix);const _="light-beam"===e.renderPass,x=T&t.cl.HasMapboxMeshFeatures,v=x?0:a.evaluatedRMEA[0][2];for(let h=0;h<c.meshes.length;++h){const p=c.meshes[h],b=h===c.lightMeshIndex;let w=n.wvpForNode;if(b){if(!_&&!e.terrain&&e.shadowRenderer){e.currentLayer<e.firstLightBeamLayer&&(e.firstLightBeamLayer=e.currentLayer);continue}w=n.wvpForTile}else if(_)continue;const C={defines:[]},E=[];if(pa(C.defines,E,p,e,i.lut),x||C.defines.push("DIFFUSE_SHADED"),d&&C.defines.push("SHADOWS_SINGLE_CASCADE"),A&&(y?A.numRenderedVerticesInShadowPass+=p.vertexArray.length:A.numRenderedVerticesInTransparentPass+=p.vertexArray.length),y){ga(p,n.nodeModelMatrix,e,i);continue}let T=null;if(s){const t=da(n.nodeModelMatrix,e.transform);if(T=new Float32Array(t),"globe"!==o.projection.name){const e=p.aabb.min,n=p.aabb.max,[i,a]=s.getOpacityForBounds(t,e[0],e[1],n[0],n[1]);C.overrideFog=i>=ne||a>=ne}}const S=p.material;let M;S.occlusionTexture&&S.occlusionTexture.offsetScale&&(M=S.occlusionTexture.offsetScale,C.defines.push("OCCLUSION_TEXTURE_TRANSFORM")),!y&&l&&(l.useNormalOffset=!!p.normalBuffer);const k=e.getOrCreateProgram("model",C);!y&&l&&l.setupShadowsFromMatrix(n.tileModelMatrix,k,l.useNormalOffset),e.uploadCommonUniforms(r,k,null,T);const I=S.pbrMetallicRoughness;I.metallicFactor=.9,I.roughnessFactor=.5;const P=yi(new Float32Array(w),new Float32Array(u),new Float32Array(f),new Float32Array(c.matrix),e,n.opacity,I.baseColorFactor.toRenderColor(null),S.emissiveFactor,I.metallicFactor,I.roughnessFactor,S,v,i,[0,0,0],M);!b&&(a.hasTranslucentParts||n.opacity<1)&&k.draw(e,r.gl.TRIANGLES,m,t.ag.disabled,t.a.disabled,t.af.backCCW,P,i.id,p.vertexBuffer,p.indexBuffer,p.segments,i.paint,e.transform.zoom,void 0,E),k.draw(e,r.gl.TRIANGLES,b?g:m,t.ag.disabled,b||n.opacity<1||a.hasTranslucentParts?t.a.alphaBlended:t.a.unblended,t.af.backCCW,P,i.id,p.vertexBuffer,p.indexBuffer,p.segments,i.paint,e.transform.zoom,void 0,E)}}}}()}(e,n,i,a),void c();const h=u.getModels(),d=[],p=e.transform.getFreeCameraOptions().position,f=t._.scale([],[p.x,p.y,p.z],e.transform.worldSize);t._.negate(f,f);const m=[],g=[];let _=0;for(const n of h){const a=i.paint.get("model-rotation").constantOr(null),r=i.paint.get("model-scale").constantOr(null),o=i.paint.get("model-translation").constantOr(null);n.computeModelMatrix(e,a,r,o,!0,!0,!1);const s=t.ad.identity([]),l=t.cg(n.position.lat,e.transform.zoom),c=t.ad.fromScaling([],[1,1,1/l]);t.ad.translate(s,s,f),d.push({zScaleMatrix:c,negCameraPosMatrix:s});for(const t of n.nodes)ma(e.transform,t,n.matrix,e.transform.expandedFarZProjMatrix,_,m,g);_++}if(m.sort(((t,e)=>e.depth-t.depth)),"shadow"!==e.renderPass){if(1===r)for(const n of g)fa(n,e,i,d[n.modelIndex],t.ag.disabled,e.colorModeForRenderPass());else{for(const n of g)fa(n,e,i,d[n.modelIndex],t.ag.disabled,t.a.disabled);for(const t of g)fa(t,e,i,d[t.modelIndex],e.stencilModeFor3D(),e.colorModeForRenderPass());e.resetStencilClippingMasks()}for(const n of m)fa(n,e,i,d[n.modelIndex],t.ag.disabled,e.colorModeForRenderPass());c()}else{for(const t of g)ga(t.mesh,t.nodeModelMatrix,e,i);for(const t of m)ga(t.mesh,t.nodeModelMatrix,e,i);c()}}},Ia={model:function(t,e,n){const i=e.getSource();if(!i.loaded())return;if("vector"===i.type||"geojson"===i.type)return void(n.modelManager&&n.modelManager.upload(n,"vector"===i.type?t.scope:""));if("batched-model"===i.type)return;const a=i.getModels();for(const t of a)t.upload(n.context)},raster:function(t,e,n){const i=e.getSource();if(!(i instanceof Dn&&i.loaded()))return;const a=t.sourceLayer||i.rasterLayerIds&&i.rasterLayerIds[0];if(!a)return;const r=t.paint.get("raster-array-band")||i.getInitialBand(a);if(null==r)return;const o=e.getIds().map((t=>e.getTileByID(t)));for(const t of o)t.updateNeeded(a,r)&&i.prepareTile(t,a,r)},"raster-particle":function(t,e,n){const i=e.getSource();if(!(i instanceof Dn&&i.loaded()))return;const a=t.sourceLayer||i.rasterLayerIds&&i.rasterLayerIds[0];if(!a)return;const r=t.paint.get("raster-particle-array-band")||i.getInitialBand(a);if(null==r)return;const o=e.getIds().map((t=>e.getTileByID(t)));for(const t of o)t.updateNeeded(a,r)&&i.prepareTile(t,a,r)}};class Pa{constructor(e,n,i,a){this.context=new rt(e,n),this.occlusionBuffers=new Ma(this.context),this.transform=i,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.tp=a,this._timeStamp=t.e.now(),this._averageFPS=0,this._fpsHistory=[],this._dt=0,this._debugParams={showTerrainProxyTiles:!1,fpsWindow:30,continousRedraw:!1,enabledLayers:{}};const r=["fill","line","symbol","circle","heatmap","fill-extrusion","raster","raster-particle","hillshade","model","background","sky"];for(const t of r)this._debugParams.enabledLayers[t]=!0;a.registerParameter(this._debugParams,["Terrain"],"showTerrainProxyTiles",{},(()=>{this.style.map.triggerRepaint()})),a.registerParameter(this._debugParams,["FPS"],"fpsWindow",{min:1,max:100,step:1}),a.registerBinding(this._debugParams,["FPS"],"continousRedraw",{readonly:!0,label:"continuous redraw"}),a.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"value"}),a.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"graph",view:"graph",min:0,max:200});for(const t of r)a.registerParameter(this._debugParams.enabledLayers,["Debug","Layers"],t);this.symbolParams=new st(a),this.setup(),this.numSublayers=t.bv.maxUnderzooming+t.bv.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={},this.conflationActive=!1,this.replacementSource=new t.co,this.longestCutoffRange=0,this.minCutoffZoom=0,this._fogVisible=!1,this._cachedTileFogOpacities={},this._shadowRenderer=new bn(this),this._wireframeDebugCache=new Ta,this.renderDefaultNorthPole=!0,this.renderDefaultSouthPole=!0,this.layersWithOcclusionOpacity=[]}updateTerrain(t,e){const n=!!t&&!!t.terrain&&this.transform.projection.supportsTerrain;if(!(n||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new Nn(this,t));const i=this._terrain;this.transform.elevation=n?i:null,i.update(t,this.transform,e),this.transform.elevation&&!i.enabled&&(this.transform.elevation=null)}_updateFog(t){const e=t.fog;if(!e||"globe"===this.transform.projection.name||e.getOpacity(this.transform.pitch)<1||e.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[n,i]=e.getFovAdjustedRange(this.transform._fov);if(n>i)return void(this.transform.fogCullDistSq=null);const a=n+.78*(i-n);this.transform.fogCullDistSq=a*a}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled||this._forceTerrainMode?this._terrain:null}get forceTerrainMode(){return this._forceTerrainMode}set forceTerrainMode(t){t&&!this._terrain&&(this._terrain=new Nn(this,this.style)),this._forceTerrainMode=t}get shadowRenderer(){return this._shadowRenderer&&this._shadowRenderer.enabled?this._shadowRenderer:null}get wireframeDebugCache(){return this._wireframeDebugCache}resize(e,n){if(this.width=e*t.e.devicePixelRatio,this.height=n*t.e.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const t of this.style.order)this.style._mergedLayers[t].resize()}setup(){const e=this.context,n=new t.bt;n.emplaceBack(0,0),n.emplaceBack(t.a3,0),n.emplaceBack(0,t.a3),n.emplaceBack(t.a3,t.a3),this.tileExtentBuffer=e.createVertexBuffer(n,t.br.members),this.tileExtentSegments=t.b.simpleSegment(0,0,4,2);const i=new t.bt;i.emplaceBack(0,0),i.emplaceBack(t.a3,0),i.emplaceBack(0,t.a3),i.emplaceBack(t.a3,t.a3),this.debugBuffer=e.createVertexBuffer(i,t.br.members),this.debugSegments=t.b.simpleSegment(0,0,4,5);const a=new t.bt;a.emplaceBack(-1,-1),a.emplaceBack(1,-1),a.emplaceBack(-1,1),a.emplaceBack(1,1),this.viewportBuffer=e.createVertexBuffer(a,t.br.members),this.viewportSegments=t.b.simpleSegment(0,0,4,2);const r=new t.cp;r.emplaceBack(0,0,0,0),r.emplaceBack(t.a3,0,t.a3,0),r.emplaceBack(0,t.a3,0,t.a3),r.emplaceBack(t.a3,t.a3,t.a3,t.a3),this.mercatorBoundsBuffer=e.createVertexBuffer(r,t.cq.members),this.mercatorBoundsSegments=t.b.simpleSegment(0,0,4,2);const o=new t.bu;o.emplaceBack(0,1,2),o.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=e.createIndexBuffer(o);const s=new t.cr;for(const t of[0,1,3,2,0])s.emplaceBack(t);this.debugIndexBuffer=e.createIndexBuffer(s),this.emptyTexture=new t.T(e,new t.i({width:1,height:1},Uint8Array.of(0,0,0,0)),e.gl.RGBA),this.identityMat=t.ad.create();const l=this.context.gl;this.stencilClearMode=new t.ag({func:l.ALWAYS,mask:0},0,255,l.ZERO,l.ZERO,l.ZERO),this.loadTimeStamps.push(performance.now())}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(t){return t._makeTileBoundsBuffers(this.context,this.transform.projection),t._tileBoundsBuffer?{tileBoundsBuffer:t._tileBoundsBuffer,tileBoundsIndexBuffer:t._tileBoundsIndexBuffer,tileBoundsSegments:t._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const e=this.context.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.getOrCreateProgram("clippingMask").draw(this,e.TRIANGLES,t.ae.disabled,this.stencilClearMode,t.a.disabled,t.af.disabled,Pn(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(e,n,i){if(!n||this.currentStencilSource===n.id||!e.isTileClipped()||!i||0===i.length)return;if(this._tileClippingMaskIDs&&!this.terrain){let t=!1;for(const e of i)if(void 0===this._tileClippingMaskIDs[e.key]){t=!0;break}if(!t)return}this.currentStencilSource=n.id;const a=this.context,r=a.gl;this.nextStencilID+i.length>256&&this.clearStencil(),a.setColorMode(t.a.disabled),a.setDepthMode(t.ae.disabled);const o=this.getOrCreateProgram("clippingMask");this._tileClippingMaskIDs={};for(const e of i){const i=n.getTile(e),a=this._tileClippingMaskIDs[e.key]=this.nextStencilID++,{tileBoundsBuffer:s,tileBoundsIndexBuffer:l,tileBoundsSegments:c}=this.getTileBoundsBuffers(i);o.draw(this,r.TRIANGLES,t.ae.disabled,new t.ag({func:r.ALWAYS,mask:0},a,255,r.KEEP,r.KEEP,r.REPLACE),t.a.disabled,t.af.disabled,Pn(e.projMatrix),"$clipping",s,l,c)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const e=this.nextStencilID++,n=this.context.gl;return new t.ag({func:n.NOTEQUAL,mask:255},e,255,n.KEEP,n.KEEP,n.REPLACE)}stencilModeForClipping(e){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(e);const n=this.context.gl;return new t.ag({func:n.EQUAL,mask:255},this._tileClippingMaskIDs[e.key],0,n.KEEP,n.KEEP,n.REPLACE)}stencilConfigForOverlap(e){const n=this.context.gl,i=e.sort(((t,e)=>e.overscaledZ-t.overscaledZ)),a=i[i.length-1].overscaledZ,r=i[0].overscaledZ-a+1;if(r>1){this.currentStencilSource=void 0,this.nextStencilID+r>256&&this.clearStencil();const e={};for(let i=0;i<r;i++)e[i+a]=new t.ag({func:n.GEQUAL,mask:255},i+this.nextStencilID,255,n.KEEP,n.KEEP,n.REPLACE);return this.nextStencilID+=r,[e,i]}return[{[a]:t.ag.disabled},i]}colorModeForRenderPass(){const e=this.context.gl;if(this._showOverdrawInspector){const n=1/8;return new t.a([e.CONSTANT_COLOR,e.ONE,e.CONSTANT_COLOR,e.ONE],new t.C(n,n,n,0),[!0,!0,!0,!0])}return"opaque"===this.renderPass?t.a.unblended:t.a.alphaBlended}colorModeForDrapableLayerRenderPass(e){const n=this.context.gl;return(()=>this.style&&this.style.enable3dLights()&&this.terrain&&this.terrain.renderingToTexture)()&&"translucent"===this.renderPass?new t.a([n.ONE,n.ONE_MINUS_SRC_ALPHA,n.CONSTANT_ALPHA,n.ONE_MINUS_SRC_ALPHA],new t.C(0,0,0,void 0===e?0:e),[!0,!0,!0,!0]):this.colorModeForRenderPass()}depthModeForSublayer(e,n,i,a=!1){if(this.depthOcclusion)return new t.ae(this.context.gl.GREATER,t.ae.ReadOnly,this.depthRangeFor3D);if(!this.opaquePassEnabledForLayer()&&!a)return t.ae.disabled;const r=1-((1+this.currentLayer)*this.numSublayers+e)*this.depthEpsilon;return new t.ae(i||this.context.gl.LEQUAL,n,[r,r])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}updateAverageFPS(){this._fpsHistory.push(0===this._dt?0:1e3/this._dt),this._fpsHistory.length>this._debugParams.fpsWindow&&this._fpsHistory.splice(0,this._fpsHistory.length-this._debugParams.fpsWindow),this._averageFPS=Math.round(this._fpsHistory.reduce(((t,e)=>t+e/this._fpsHistory.length),0))}render(e,n){const i=t.e.now();this._dt=i-this._timeStamp,this._timeStamp=i,this._wireframeDebugCache.update(this.frameCounter),this._debugParams.continousRedraw=e.map.repaint,this.style=e,this.options=n;const a=this.style._mergedLayers,r=this.style.order.filter((t=>{const e=a[t];return!(e.type in this._debugParams.enabledLayers)||this._debugParams.enabledLayers[e.type]})),o=r.map((t=>a[t])),s=this.style._mergedSourceCaches;this.imageManager=e.imageManager,this.modelManager=e.modelManager,this.symbolFadeChange=e.placement.symbolFadeChange(t.e.now()),this.imageManager.beginFrame();let l=0,c=!1;for(const t in s){const e=s[t];e.used&&(e.prepare(this.context),e.getSource().usedInConflation&&++l)}let u=!1;for(const t of o)t.isHidden(this.transform.zoom)||("clip"===t.type&&(u=!0),this.prepareLayer(t));const h={},d={},p={},f={},m={};for(const t in s){const e=s[t];h[t]=e.getVisibleCoordinates(),d[t]=h[t].slice().reverse(),p[t]=e.getVisibleCoordinates(!0).reverse(),f[t]=e.getShadowCasterCoordinates(),m[t]=e.sortCoordinatesByDistance(h[t])}const g=t=>{const e=this.style.getLayerSourceCache(t);return e&&e.used?e.getSource():null};if(l||u){const e=[],n=[];let i=0;for(const t of o)this.isSourceForClippingOrConflation(t,g(t))&&(e.push(t),n.push(i)),i++;if(e&&(u||e.length>1)){const i=[];for(let a=0;a<e.length;a++){const r=e[a],o=n[a],s=this.style.getLayerSourceCache(r);if(!s||!s.used||!s.getSource().usedInConflation&&"clip"!==r.type)continue;let l=1/0,c=t.cu.None;if("clip"===r.type){l=o;for(const e of r.layout.get("clip-layer-types"))c|="model"===e?t.cu.Model:"symbol"===e?t.cu.Symbol:t.cu.FillExtrusion}i.push({layer:r.fqid,cache:s,order:l,clipMask:c})}this.replacementSource.setSources(i),c=!0}}c||this.replacementSource.clear(),this.conflationActive=c,this.minCutoffZoom=0,this.longestCutoffRange=0,this.opaquePassCutoff=1/0,this._lastOcclusionLayer=-1,this.layersWithOcclusionOpacity=[];for(let t=0;t<o.length;t++){const e=o[t],n=e.cutoffRange();if(this.longestCutoffRange=Math.max(n,this.longestCutoffRange),n>0){const t=g(e);t&&(this.minCutoffZoom=Math.max(t.minzoom,this.minCutoffZoom)),e.minzoom&&(this.minCutoffZoom=Math.max(e.minzoom,this.minCutoffZoom))}e.is3D()&&(this.opaquePassCutoff===1/0&&(this.opaquePassCutoff=t),this._lastOcclusionLayer=t)}const _=this.style&&this.style.fog;_?(this._fogVisible=0!==_.getOpacity(this.transform.pitch),this._fogVisible&&"globe"!==this.transform.projection.name&&(this._fogVisible=_.isVisibleOnFrustum(this.transform.cameraFrustum))):this._fogVisible=!1,this._cachedTileFogOpacities={},this.terrain&&(this.terrain.updateTileBinding(p),this.opaquePassCutoff=0);const y=this._shadowRenderer;if(y){y.updateShadowParameters(this.transform,this.style.directionalLight);for(const t in s)for(const e of h[t]){let t={min:0,max:0};this.terrain&&(t=this.terrain.getMinMaxForTile(e)||t),y.addShadowReceiver(e.toUnwrapped(),t.min,t.max)}}if("globe"!==this.transform.projection.name||this.globeSharedBuffers||(this.globeSharedBuffers=new t.cs(this.context)),this.style.fog&&this.transform.projection.supportsFog?(this._atmosphere||(this._atmosphere=new ha(this)),this._atmosphere.update(this)):this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),!t.ct(this.context.gl))return;this.renderPass="offscreen";for(const t of o){const n=e.getLayerSourceCache(t);if(!t.hasOffscreenPass()||t.isHidden(this.transform.zoom))continue;const i=n?d[n.id]:void 0;("custom"===t.type||"raster"===t.type||"raster-particle"===t.type||t.isSky()||i&&i.length)&&this.renderLayer(this,n,t,i)}this.depthRangeFor3D=[0,1-(o.length+2)*this.numSublayers*this.depthEpsilon];const x=this.terrain;x&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&!this.transform.isOrthographic&&x.drawDepth(),this._shadowRenderer&&(this.renderPass="shadow",this._shadowRenderer.drawShadowPass(this.style,f)),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]);const v="globe"===this.transform.projection.name||this.transform.isHorizonVisible(),b=(()=>{if(n.showOverdrawInspector)return t.C.black;const e=this.style.fog;if(e&&this.transform.projection.supportsFog){const n=this.style.getLut(e.scope);if(!v){const i=e.properties.get("color").toRenderColor(n).toArray01();return new t.C(...i)}if(v){const i=e.properties.get("space-color").toRenderColor(n).toArray01();return new t.C(...i)}}return t.C.transparent})();if(this.context.clear({color:b,depth:1}),this.clearStencil(),this._showOverdrawInspector=n.showOverdrawInspector,this.renderPass="opaque",this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&v&&this._atmosphere.drawStars(this,this.style.fog),!this.terrain)for(this.currentLayer=r.length-1;this.currentLayer>=0;this.currentLayer--){const t=o[this.currentLayer],n=e.getLayerSourceCache(t);if(t.isSky())continue;const i=n?(t.is3D()?m:d)[n.id]:void 0;this._renderTileClippingMasks(t,n,i),this.renderLayer(this,n,t,i)}if(this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&v&&this._atmosphere.drawAtmosphereGlow(this,this.style.fog),this.renderPass="sky",(!this._atmosphere||t.a1(this.transform.zoom)>0)&&("globe"===this.transform.projection.name||this.transform.isHorizonVisible()))for(this.currentLayer=0;this.currentLayer<r.length;this.currentLayer++){const t=o[this.currentLayer],n=e.getLayerSourceCache(t);t.isSky()&&this.renderLayer(this,n,t,n?d[n.id]:void 0)}function w(t,e){let n;return e&&(n=("symbol"===t.type?p:t.is3D()?m:d)[e.id]),n}if(this.renderPass="translucent","globe"===this.transform.projection.name){for(this.renderElevatedRasterBackface=!0,this.currentLayer=0;this.currentLayer<r.length;){const t=o[this.currentLayer];if("raster"===t.type){const n=e.getLayerSourceCache(t);this.renderLayer(this,n,t,w(t,n))}++this.currentLayer}this.renderElevatedRasterBackface=!1}this.currentLayer=0,this.firstLightBeamLayer=Number.MAX_SAFE_INTEGER;let A=0;for(y&&(A=y.getShadowCastingLayerCount());this.currentLayer<r.length;){const t=o[this.currentLayer],n=e.getLayerSourceCache(t);if(t.isSky())++this.currentLayer;else if(x&&this.style.isLayerDraped(t)){if(t.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=x.renderBatch(this.currentLayer),this._lastOcclusionLayer=Math.max(this.currentLayer,this._lastOcclusionLayer)}else{if(t.is3D()||this.terrain||this._renderTileClippingMasks(t,n,n?h[n.id]:void 0),this.renderLayer(this,n,t,w(t,n)),!x&&y&&A>0&&t.hasShadowPass()&&0==--A&&(y.drawGroundShadows(),this.firstLightBeamLayer<=this.currentLayer)){const t=this.currentLayer;for(this.renderPass="light-beam",this.currentLayer=this.firstLightBeamLayer;this.currentLayer<=t;this.currentLayer++){const t=o[this.currentLayer];if(!t.hasLightBeamPass())continue;const n=e.getLayerSourceCache(t);this.renderLayer(this,n,t,n?d[n.id]:void 0)}this.currentLayer=t,this.renderPass="translucent"}if(this.currentLayer>=this._lastOcclusionLayer&&this.layersWithOcclusionOpacity.length>0){const t=this.currentLayer;this.depthOcclusion=!0;for(const t of this.layersWithOcclusionOpacity){this.currentLayer=t;const n=o[this.currentLayer],i=e.getLayerSourceCache(n),a=i?d[i.id]:void 0;n.is3D()||this.terrain||this._renderTileClippingMasks(n,i,i?h[i.id]:void 0),this.renderLayer(this,i,n,a)}this.depthOcclusion=!1,this.currentLayer=t,this.renderPass="translucent",this.layersWithOcclusionOpacity=[]}++this.currentLayer}}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let n=null;o.forEach((t=>{const i=e.getLayerSourceCache(t);i&&!t.isHidden(this.transform.zoom)&&i.getVisibleCoordinates().length&&(!n||n.getSource().maxzoom<i.getSource().maxzoom)&&(n=i)})),n&&this.options.showTileBoundaries&&ka.debug(this,n,n.getVisibleCoordinates(),t.C.red,!1,this.options.showParseStatus)}this.terrain&&this._debugParams.showTerrainProxyTiles&&ka.debug(this,this.terrain.proxySourceCache,this.terrain.proxyCoords,new t.C(1,.8,.1,1),!0,this.options.showParseStatus),this.options.showPadding&&function(t){const e=t.transform.padding;Ji(t,t.transform.height-(e.top||0),3,Hi),Ji(t,e.bottom||0,3,Zi),ta(t,e.left||0,3,Yi),ta(t,t.transform.width-(e.right||0),3,Xi);const n=t.transform.centerPoint;!function(t,e,n,i){ea(t,e-1,n-10,2,20,i),ea(t,e-10,n-1,20,2,i)}(t,n.x,t.transform.height-n.y,Ki)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(performance.now()),this.saveCanvasCopy()),c||(this.conflationActive=!1)}prepareLayer(t){this.gpuTimingStart(t);const{unsupportedLayers:e}=this.transform.projection,n=!e||!e.includes(t.type);if(Ia[t.type]&&(n||this.terrain&&"custom"===t.type)){const e=this.style.getLayerSourceCache(t);Ia[t.type](t,e,this)}this.gpuTimingEnd()}renderLayer(t,e,n,i){n.isHidden(this.transform.zoom)||("background"===n.type||"sky"===n.type||"custom"===n.type||"model"===n.type||"raster"===n.type||"raster-particle"===n.type||i&&i.length)&&(this.id=n.id,this.gpuTimingStart(n),t.transform.projection.unsupportedLayers&&t.transform.projection.unsupportedLayers.includes(n.type)&&(!t.terrain||"custom"!==n.type)||"clip"===n.type||ka[n.type](t,e,n,i,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(t){if(!this.options.gpuTiming)return;const e=this.context.extTimerQuery,n=this.context.gl;let i=this.gpuTimers[t.id];i||(i=this.gpuTimers[t.id]={calls:0,cpuTime:0,query:n.createQuery()}),i.calls++,n.beginQuery(e.TIME_ELAPSED_EXT,i.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const t=this.context.extTimerQuery,e=this.context.gl,n=e.createQuery();this.deferredRenderGpuTimeQueries.push(n),e.beginQuery(t.TIME_ELAPSED_EXT,n)}}gpuTimingDeferredRenderEnd(){this.options.gpuTimingDeferredRender&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}gpuTimingEnd(){this.options.gpuTiming&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}collectGpuTimers(){const t=this.gpuTimers;return this.gpuTimers={},t}collectDeferredRenderGpuQueries(){const t=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],t}queryGpuTimers(t){const e={};for(const n in t){const i=t[n],a=this.context.extTimerQuery,r=a.getQueryParameter(i.query,this.context.gl.QUERY_RESULT)/1e6;a.deleteQueryEXT(i.query),e[n]=r}return e}queryGpuTimeDeferredRender(t){if(!this.options.gpuTimingDeferredRender)return 0;const e=this.context.extTimerQuery,n=this.context.gl;let i=0;for(const a of t)i+=e.getQueryParameter(a,n.QUERY_RESULT)/1e6,e.deleteQueryEXT(a);return i}translatePosMatrix(e,n,i,a,r){if(!i[0]&&!i[1])return e;const o=r?"map"===a?this.transform.angle:0:"viewport"===a?-this.transform.angle:0;if(o){const t=Math.sin(o),e=Math.cos(o);i=[i[0]*e-i[1]*t,i[0]*t+i[1]*e]}const s=[r?i[0]:t.bB(n,i[0],this.transform.zoom),r?i[1]:t.bB(n,i[1],this.transform.zoom),0],l=new Float32Array(16);return t.ad.translate(l,e,s),l}saveTileTexture(t){const e=t.size[0],n=this._tileTextures[e];n?n.push(t):this._tileTextures[e]=[t]}getTileTexture(t){const e=this._tileTextures[t];return e&&e.length>0?e.pop():null}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture||this.forceTerrainMode}linearFloatFilteringSupported(){return null!=this.context.extTextureFloatLinear}currentGlobalDefines(t,e,n){const i=void 0===n?this.terrain&&this.terrain.renderingToTexture:n,a=[];return this.style&&this.style.enable3dLights()&&("globeRaster"===t||"terrainRaster"===t?(a.push("LIGHTING_3D_MODE"),a.push("LIGHTING_3D_ALPHA_EMISSIVENESS")):i||a.push("LIGHTING_3D_MODE")),"shadow"===this.renderPass?this._shadowMapDebug||a.push("DEPTH_TEXTURE"):this.shadowRenderer&&(this.shadowRenderer.useNormalOffset?a.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET"):a.push("RENDER_SHADOWS","DEPTH_TEXTURE")),this.terrainRenderModeElevated()&&(a.push("TERRAIN"),this.linearFloatFilteringSupported()&&a.push("TERRAIN_DEM_FLOAT_FORMAT")),"globe"===this.transform.projection.name&&a.push("GLOBE"),!this._fogVisible||i||void 0!==e&&!e||a.push("FOG","FOG_DITHERING"),i&&a.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&a.push("OVERDRAW_INSPECTOR"),a}getOrCreateProgram(t,e){this.cache=this.cache||{};const n=e&&e.defines||[],i=e&&e.config,a=this.currentGlobalDefines(t,e&&e.overrideFog,e&&e.overrideRtt).concat(n),r=Gn.cacheKey(Me[t],t,a,i);return this.cache[r]||(this.cache[r]=new Gn(this.context,t,Me[t],i,bi[t],a)),this.cache[r]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const t=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(t.FUNC_ADD)}initDebugOverlayCanvas(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new t.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this._wireframeDebugCache.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}uploadCommonLightUniforms(e,n){if(this.style.enable3dLights()){const i=this.style.directionalLight,a=this.style.ambientLight;if(i&&a){const r=((e,n,i)=>{const a=e.properties.get("direction"),r=e.properties.get("color").toRenderColor(i.getLut(e.scope)).toArray01(),o=e.properties.get("intensity"),s=n.properties.get("color").toRenderColor(i.getLut(n.scope)).toArray01(),l=n.properties.get("intensity"),c=[a.x,a.y,a.z],u=t.bA(s,l),h=t.bA(r,o);return{u_lighting_ambient_color:u,u_lighting_directional_dir:c,u_lighting_directional_color:h,u_ground_radiance:jn(c,h,u)}})(i,a,this.style);n.setLightsUniformValues(e,r)}}}uploadCommonUniforms(e,n,i,a,r){if(this.uploadCommonLightUniforms(e,n),this.terrain&&this.terrain.renderingToTexture)return;const o=this.style.fog;if(o){const r=o.getOpacity(this.transform.pitch),s=((e,n,i,a,r,o,s,l,c,u,h,d)=>{const p=e.transform,f=n.properties.get("color").toRenderColor(e.style.getLut(n.scope)).toArray01();f[3]=a;const m=e.frameCounter/1e3%1,[g,_]=n.properties.get("vertical-range");return{u_fog_matrix:i?p.calculateFogTileMatrix(i):d||e.identityMat,u_fog_range:n.getFovAdjustedRange(p._fov),u_fog_color:f,u_fog_horizon_blend:n.properties.get("horizon-blend"),u_fog_vertical_limit:[Math.min(g,_),_],u_fog_temporal_offset:m,u_frustum_tl:r,u_frustum_tr:o,u_frustum_br:s,u_frustum_bl:l,u_globe_pos:c,u_globe_radius:u,u_viewport:h,u_globe_transition:t.a1(p.zoom),u_is_globe:+("globe"===p.projection.name)}})(this,o,i,r,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*t.e.devicePixelRatio,this.transform.height*t.e.devicePixelRatio],a);n.setFogUniformValues(e,s)}r&&n.setCutoffUniformValues(e,r.uniformValues)}setTileLoadedFlag(t){this.tileLoaded=t}saveCanvasCopy(){const t=this.canvasCopy();t&&(this.frameCopies.push(t),this.tileLoaded=!1)}canvasCopy(){const t=this.context.gl,e=t.createTexture();return t.bindTexture(t.TEXTURE_2D,e),t.copyTexImage2D(t.TEXTURE_2D,0,t.RGBA,0,0,t.drawingBufferWidth,t.drawingBufferHeight,0),e}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const t=this.style&&this.style.fog;return!!t&&0!==t.getOpacity(this.transform.pitch)}getBackgroundTiles(){const e=this._backgroundTiles,n=this._backgroundTiles={},i=this.transform.coveringTiles({tileSize:512});for(const a of i)n[a.key]=e[a.key]||new t.by(a,512,this.transform.tileZoom,this);return n}clearBackgroundTiles(){this._backgroundTiles={}}isSourceForClippingOrConflation(t,e){return!(!t.is3D()||t.minzoom&&t.minzoom>this.transform.zoom||(this.style._clipLayerIndices.length||"building"!==t.sourceLayer)&&"clip"!==t.type&&(!e||"batched-model"!==e.type))}isTileAffectedByFog(t){if(!this.style||!this.style.fog)return!1;if("globe"===this.transform.projection.name)return!0;let e=this._cachedTileFogOpacities[t.key];return e||(this._cachedTileFogOpacities[t.key]=e=this.style.fog.getOpacityForTile(t)),e[0]>=ne||e[1]>=ne}}class za{constructor(t,e,n,i){this.screenBounds=t,this.cameraPoint=e,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=n,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,i)}static createFromScreenPoints(e,n){let i,a;if(e instanceof t.P||"number"==typeof e[0]){const r=t.P.convert(e);i=[r],a=n.isPointAboveHorizon(r)}else{const r=t.P.convert(e[0]),o=t.P.convert(e[1]);i=[r,o],a=t.cv(r,o).every((t=>n.isPointAboveHorizon(t)))}return new za(i,n.getCameraPoint(),a,n)}isPointQuery(){return 1===this.screenBounds.length}bufferedScreenGeometry(e){return t.cv(this.screenBounds[0],1===this.screenBounds.length?this.screenBounds[0]:this.screenBounds[1],e)}bufferedCameraGeometry(e){const n=this.screenBounds[0],i=1===this.screenBounds.length?this.screenBounds[0].add(new t.P(1,1)):this.screenBounds[1],a=t.cv(n,i,0,!1);return this.cameraPoint.y>i.y&&(this.cameraPoint.x>n.x&&this.cameraPoint.x<i.x?a.splice(3,0,this.cameraPoint):this.cameraPoint.x>=i.x?a[2]=this.cameraPoint:this.cameraPoint.x<=n.x&&(a[3]=this.cameraPoint)),t.cw(a,e)}bufferedCameraGeometryGlobe(e){const n=this.screenBounds[0],i=1===this.screenBounds.length?this.screenBounds[0].add(new t.P(1,1)):this.screenBounds[1],a=t.cv(n,i,e),r=this.cameraPoint.clone();switch(3*((r.y>n.y)+(r.y>i.y))+((r.x>n.x)+(r.x>i.x))){case 0:a[0]=r,a[4]=r.clone();break;case 1:a.splice(1,0,r);break;case 2:a[1]=r;break;case 3:a.splice(4,0,r);break;case 5:a.splice(2,0,r);break;case 6:a[3]=r;break;case 7:a.splice(3,0,r);break;case 8:a[2]=r}return a}containsTile(e,n,i,a=0){const r=e.queryPadding/n._pixelsPerMercatorPixel+1,o=i?this._bufferedCameraMercator(r,n):this._bufferedScreenMercator(r,n);let s=e.tileID.wrap+(o.unwrapped?a:0);const l=o.polygon.map((n=>t.cx(e.tileTransform,n,s)));if(!t.cy(l,0,0,t.a3,t.a3))return;s=e.tileID.wrap+(this.screenGeometryMercator.unwrapped?a:0);const c=this.screenGeometryMercator.polygon.map((n=>t.cz(e.tileTransform,n,s))),u=c.map((e=>new t.P(e[0],e[1]))),h=n.getFreeCameraOptions().position||new t.Y(0,0,0),d=t.cz(e.tileTransform,h,s),p=c.map((e=>{const n=t._.sub(e,e,d);return t._.normalize(n,n),new t.aT(d,n)})),f=t.bB(e,1,n.zoom)*n._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:u,tilespaceRays:p,bufferedTilespaceGeometry:l,bufferedTilespaceBounds:(m=t.cA(l),m.min.x=t.at(m.min.x,0,t.a3),m.min.y=t.at(m.min.y,0,t.a3),m.max.x=t.at(m.max.x,0,t.a3),m.max.y=t.at(m.max.y,0,t.a3),m),tile:e,tileID:e.tileID,pixelToTileUnitsFactor:f};var m}_bufferedScreenMercator(t,e){const n=Ba(t);if(this._screenRaycastCache[n])return this._screenRaycastCache[n];{let i;return i="globe"===e.projection.name?this._projectAndResample(this.bufferedScreenGeometry(t),e):{polygon:this.bufferedScreenGeometry(t).map((t=>e.pointCoordinate3D(t))),unwrapped:!0},this._screenRaycastCache[n]=i,i}}_bufferedCameraMercator(t,e){const n=Ba(t);if(this._cameraRaycastCache[n])return this._cameraRaycastCache[n];{let i;return i="globe"===e.projection.name?this._projectAndResample(this.bufferedCameraGeometryGlobe(t),e):{polygon:this.bufferedCameraGeometry(t).map((t=>e.pointCoordinate3D(t))),unwrapped:!0},this._cameraRaycastCache[n]=i,i}}_projectAndResample(e,n){const i=function(e,n){const i=t.ad.multiply([],n.pixelMatrix,n.globeMatrix),a=[0,-t.cD,0,1],r=[0,t.cD,0,1],o=[0,0,0,1];t.aA.transformMat4(a,a,i),t.aA.transformMat4(r,r,i),t.aA.transformMat4(o,o,i);const s=new t.P(a[0]/a[3],a[1]/a[3]),l=new t.P(r[0]/r[3],r[1]/r[3]),c=t.cB(e,s)&&a[3]<o[3],u=t.cB(e,l)&&r[3]<o[3];if(!c&&!u)return null;const h=function(t,e,n){for(let i=1;i<t.length;i++){const a=La(e.pointCoordinate3D(t[i-1]).x),r=La(e.pointCoordinate3D(t[i]).x);if(n<0){if(a<r)return{idx:i,t:-a/(r-1-a)}}else if(r<a)return{idx:i,t:(1-a)/(r+1-a)}}return null}(e,n,c?-1:1);if(!h)return null;const{idx:d,t:p}=h;let f=d>1?Da(e.slice(0,d),n):[],m=d<e.length?Da(e.slice(d),n):[];f=f.map((e=>new t.P(La(e.x),e.y))),m=m.map((e=>new t.P(La(e.x),e.y)));const g=[...f];0===g.length&&g.push(m[m.length-1]);const _=t.a2(g[g.length-1].y,(0===m.length?f[0]:m[0]).y,p);let y;return y=c?[new t.P(0,_),new t.P(0,0),new t.P(1,0),new t.P(1,_)]:[new t.P(1,_),new t.P(1,1),new t.P(0,1),new t.P(0,_)],g.push(...y),0===m.length?g.push(f[0]):g.push(...m),{polygon:g.map((e=>new t.Y(e.x,e.y))),unwrapped:!1}}(e,n);if(i)return i;const a=function(e,n){let i=!1,a=-1/0,r=0;for(let t=0;t<e.length-1;t++)e[t].x>a&&(a=e[t].x,r=t);for(let t=0;t<e.length-1;t++){const n=(r+t)%(e.length-1),a=e[n],o=e[n+1];Math.abs(a.x-o.x)>.5&&(a.x<o.x?(a.x+=1,0===n&&(e[e.length-1].x+=1)):(o.x+=1,n+1===e.length-1&&(e[0].x+=1)),i=!0)}const o=t.aj(n.center.lng);return i&&o<Math.abs(o-1)&&e.forEach((t=>{t.x-=1})),{polygon:e,unwrapped:i}}(Da(e,n).map((e=>new t.P(La(e.x),e.y))),n);return{polygon:a.polygon.map((e=>new t.Y(e.x,e.y))),unwrapped:a.unwrapped}}}function Da(e,n){return t.cC(e,(t=>{const e=n.pointCoordinate3D(t);t.x=e.x,t.y=e.y}),1/256)}function La(t){return t<0?1+t%1:t%1}function Ba(t){return 100*t|0}function Oa(e,n){const i=t.ad.identity([]);return t.ad.scale(i,i,[.5*e.width,.5*-e.height,1]),t.ad.translate(i,i,[1,-1,0]),t.ad.multiply(i,i,e.calculateProjMatrix(n.toUnwrapped())),Float32Array.from(i)}function Ra(t,e,n,i,a,r,o,s=!1){const l=t.tilesIn(i,o,s);l.sort(Na);const c=[];for(const i of l)c.push({wrappedTileID:i.tile.tileID.wrapped().key,queryResults:i.tile.queryRenderedFeatures(e,n,t._state,i,a,r,Oa(t.transform,i.tile.tileID),s)});const u=function(t){const e={},n={};for(const i of t){const t=i.queryResults,a=i.wrappedTileID,r=n[a]=n[a]||{};for(const n in t){const i=t[n],a=r[n]=r[n]||{},o=e[n]=e[n]||[];for(const t of i)a[t.featureIndex]||(a[t.featureIndex]=!0,o.push(t))}}return e}(c);for(const e in u)u[e].forEach((e=>{const n=e.feature,i=n.layer;i&&"background"!==i.type&&"sky"!==i.type&&"slot"!==i.type&&(n.source=i.source,i["source-layer"]&&(n.sourceLayer=i["source-layer"]),n.state=void 0!==n.id?t.getFeatureState(i["source-layer"],n.id):{})}));return u}function Fa(t,e){const n=t.getRenderableIds().map((e=>t.getTileByID(e))),i=[],a={};for(let t=0;t<n.length;t++){const r=n[t],o=r.tileID.canonical.key;a[o]||(a[o]=!0,r.querySourceFeatures(i,e))}return i}function Na(t,e){const n=t.tileID,i=e.tileID;return n.overscaledZ-i.overscaledZ||n.canonical.y-i.canonical.y||n.wrap-i.wrap||n.canonical.x-i.canonical.x}class ja{constructor(t){this.style=t,this.layersGotHidden=!1,this.layers=[]}processLayersChanged(){this.layers=[];const t=!1,e=!1;for(const n in this.style._mergedLayers){const i=this.style._mergedLayers[n];if("fill-extrusion"===i.type)this.layers.push({layer:i,visible:t,visibilityChanged:e});else if("model"===i.type){const n=this.style.getLayerSource(i);n&&"batched-model"===n.type&&this.layers.push({layer:i,visible:t,visibilityChanged:e})}}}onNewFrame(t){this.layersGotHidden=!1;for(const e of this.layers){const n=e.layer;let i=!1;"fill-extrusion"===n.type?i=!n.isHidden(t)&&n.paint.get("fill-extrusion-opacity")>0:"model"===n.type&&(i=!n.isHidden(t)&&n.paint.get("model-opacity")>0),this.layersGotHidden=this.layersGotHidden||!i&&e.visible,e.visible=i}}updateZOffset(t,e){this.currentBuildingBuckets=[];for(const t of this.layers){const n=t.layer,i=this.style.getLayerSourceCache(n);let a=1;"fill-extrusion"===n.type&&(a=t.visible?n.paint.get("fill-extrusion-vertical-scale"):0);let r=i?i.getTile(e):null;if(!r&&i&&e.canonical.z>i.getSource().minzoom){let t=e.scaledTo(Math.min(i.getSource().maxzoom,e.overscaledZ-1));for(;t.overscaledZ>=i.getSource().minzoom&&(r=i.getTile(t),!r&&0!==t.overscaledZ);)t=t.scaledTo(t.overscaledZ-1)}this.currentBuildingBuckets.push({bucket:r?r.getBucket(n):null,tileID:r?r.tileID:e,verticalScale:a})}t.hasAnyZOffset=!1;let n=!1;for(let i=0;i<t.symbolInstances.length;i++){const a=t.symbolInstances.get(i),r=a.zOffset,o=this._getHeightAtTileOffset(e,a.tileAnchorX,a.tileAnchorY);a.zOffset=o!==Number.NEGATIVE_INFINITY?o:r,n||r===a.zOffset||(n=!0),t.hasAnyZOffset||0===a.zOffset||(t.hasAnyZOffset=!0)}n&&(t.zOffsetBuffersNeedUpload=!0,t.zOffsetSortDirty=!0)}_mapCoordToOverlappingTile(e,n,i,a){let r=n,o=i;if(e.canonical.z!==a.canonical.z){const s=a.canonical,l=1/(1<<e.canonical.z-s.z);r=(n+e.canonical.x*t.a3)*l-s.x*t.a3|0,o=(i+e.canonical.y*t.a3)*l-s.y*t.a3|0}return{tileX:r,tileY:o}}_getHeightAtTileOffset(t,e,n){let i,a;for(let r=0;r<this.layers.length;++r){if("fill-extrusion"!==this.layers[r].layer.type)continue;const{bucket:o,tileID:s,verticalScale:l}=this.currentBuildingBuckets[r];if(!o)continue;const{tileX:c,tileY:u}=this._mapCoordToOverlappingTile(t,e,n,s),h=o.getHeightAtTileCoord(c,u);h&&void 0!==h.height&&(h.hidden?i=h.height:a=Math.max(h.height*l,a||0))}if(void 0!==a)return a;for(let a=0;a<this.layers.length;++a){const r=this.layers[a];if("model"!==r.layer.type||!r.visible)continue;const{bucket:o,tileID:s}=this.currentBuildingBuckets[a];if(!o)continue;const{tileX:l,tileY:c}=this._mapCoordToOverlappingTile(t,e,n,s),u=o.getHeightAtTileCoord(l,c);if(u&&!u.hidden)return void 0===u.height&&void 0!==i?Math.min(u.maxHeight,i)*u.verticalScale:u.height?u.height*u.verticalScale:Number.NEGATIVE_INFINITY}return this.layersGotHidden?0:Number.NEGATIVE_INFINITY}}function Va(e,n){const i={};for(const t in e)"ref"!==t&&(i[t]=e[t]);return t.cE.forEach((t=>{t in n&&(i[t]=n[t])})),i}function Ua(t){t=t.slice();const e=Object.create(null);for(let n=0;n<t.length;n++)e[t[n].id]=t[n];for(let n=0;n<t.length;n++)"ref"in t[n]&&(t[n]=Va(t[n],e[t[n].ref]));return t}const Ga={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setSlot:"setSlot",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setCamera:"setCamera",setLights:"setLights",setProjection:"setProjection",addImport:"addImport",removeImport:"removeImport",updateImport:"updateImport"};function qa(t,e,n){n.push({command:Ga.addSource,args:[t,e[t]]})}function $a(t,e,n){e.push({command:Ga.removeSource,args:[t]}),n[t]=!0}function Wa(t,e,n,i){$a(t,n,i),qa(t,e,n)}function Ha(t,n,i){let a;for(a in t[i])if(t[i].hasOwnProperty(a)&&"data"!==a&&!e(t[i][a],n[i][a]))return!1;for(a in n[i])if(n[i].hasOwnProperty(a)&&"data"!==a&&!e(t[i][a],n[i][a]))return!1;return!0}function Za(t,n,i,a,r,o){let s;for(s in n=n||{},t=t||{})t.hasOwnProperty(s)&&(e(t[s],n[s])||i.push({command:o,args:[a,s,n[s],r]}));for(s in n)n.hasOwnProperty(s)&&!t.hasOwnProperty(s)&&(e(t[s],n[s])||i.push({command:o,args:[a,s,n[s],r]}))}function Ya(t){return t.id}function Xa(t,e){return t[e.id]=e,t}class Ka{constructor(t,e){this.reset(t,e)}reset(t,e){this.points=t||[],this._distances=[0];for(let t=1;t<this.points.length;t++)this._distances[t]=this._distances[t-1]+this.points[t].dist(this.points[t-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(e||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(e){if(1===this.points.length)return this.points[0];e=t.at(e,0,1);let n=1,i=this._distances[n];const a=e*this.paddedLength+this.padding;for(;i<a&&n<this._distances.length;)i=this._distances[++n];const r=n-1,o=this._distances[r],s=i-o,l=s>0?(a-o)/s:0;return this.points[r].mult(1-l).add(this.points[n].mult(l))}}class Qa{constructor(t,e,n){const i=this.boxCells=[],a=this.circleCells=[];this.xCellCount=Math.ceil(t/n),this.yCellCount=Math.ceil(e/n);for(let t=0;t<this.xCellCount*this.yCellCount;t++)i.push([]),a.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=t,this.height=e,this.xScale=this.xCellCount/t,this.yScale=this.yCellCount/e,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(t,e,n,i,a){this._forEachCell(e,n,i,a,this._insertBoxCell,this.boxUid++),this.boxKeys.push(t),this.bboxes.push(e),this.bboxes.push(n),this.bboxes.push(i),this.bboxes.push(a)}insertCircle(t,e,n,i){this._forEachCell(e-i,n-i,e+i,n+i,this._insertCircleCell,this.circleUid++),this.circleKeys.push(t),this.circles.push(e),this.circles.push(n),this.circles.push(i)}_insertBoxCell(t,e,n,i,a,r){this.boxCells[a].push(r)}_insertCircleCell(t,e,n,i,a,r){this.circleCells[a].push(r)}_query(t,e,n,i,a,r){if(n<0||t>this.width||i<0||e>this.height)return!a&&[];const o=[];if(t<=0&&e<=0&&this.width<=n&&this.height<=i){if(a)return!0;for(let t=0;t<this.boxKeys.length;t++)o.push({key:this.boxKeys[t],x1:this.bboxes[4*t],y1:this.bboxes[4*t+1],x2:this.bboxes[4*t+2],y2:this.bboxes[4*t+3]});for(let t=0;t<this.circleKeys.length;t++){const e=this.circles[3*t],n=this.circles[3*t+1],i=this.circles[3*t+2];o.push({key:this.circleKeys[t],x1:e-i,y1:n-i,x2:e+i,y2:n+i})}return r?o.filter(r):o}return this._forEachCell(t,e,n,i,this._queryCell,o,{hitTest:a,seenUids:{box:{},circle:{}}},r),a?o.length>0:o}_queryCircle(t,e,n,i,a){const r=t-n,o=t+n,s=e-n,l=e+n;if(o<0||r>this.width||l<0||s>this.height)return!i&&[];const c=[];return this._forEachCell(r,s,o,l,this._queryCellCircle,c,{hitTest:i,circle:{x:t,y:e,radius:n},seenUids:{box:{},circle:{}}},a),i?c.length>0:c}query(t,e,n,i,a){return this._query(t,e,n,i,!1,a)}hitTest(t,e,n,i,a){return this._query(t,e,n,i,!0,a)}hitTestCircle(t,e,n,i){return this._queryCircle(t,e,n,!0,i)}_queryCell(t,e,n,i,a,r,o,s){const l=o.seenUids,c=this.boxCells[a];if(null!==c){const a=this.bboxes;for(const u of c)if(!l.box[u]){l.box[u]=!0;const c=4*u;if(t<=a[c+2]&&e<=a[c+3]&&n>=a[c+0]&&i>=a[c+1]&&(!s||s(this.boxKeys[u]))){if(o.hitTest)return r.push(!0),!0;r.push({key:this.boxKeys[u],x1:a[c],y1:a[c+1],x2:a[c+2],y2:a[c+3]})}}}const u=this.circleCells[a];if(null!==u){const a=this.circles;for(const c of u)if(!l.circle[c]){l.circle[c]=!0;const u=3*c;if(this._circleAndRectCollide(a[u],a[u+1],a[u+2],t,e,n,i)&&(!s||s(this.circleKeys[c]))){if(o.hitTest)return r.push(!0),!0;{const t=a[u],e=a[u+1],n=a[u+2];r.push({key:this.circleKeys[c],x1:t-n,y1:e-n,x2:t+n,y2:e+n})}}}}}_queryCellCircle(t,e,n,i,a,r,o,s){const l=o.circle,c=o.seenUids,u=this.boxCells[a];if(null!==u){const t=this.bboxes;for(const e of u)if(!c.box[e]){c.box[e]=!0;const n=4*e;if(this._circleAndRectCollide(l.x,l.y,l.radius,t[n+0],t[n+1],t[n+2],t[n+3])&&(!s||s(this.boxKeys[e])))return r.push(!0),!0}}const h=this.circleCells[a];if(null!==h){const t=this.circles;for(const e of h)if(!c.circle[e]){c.circle[e]=!0;const n=3*e;if(this._circlesCollide(t[n],t[n+1],t[n+2],l.x,l.y,l.radius)&&(!s||s(this.circleKeys[e])))return r.push(!0),!0}}}_forEachCell(t,e,n,i,a,r,o,s){const l=this._convertToXCellCoord(t),c=this._convertToYCellCoord(e),u=this._convertToXCellCoord(n),h=this._convertToYCellCoord(i);for(let d=l;d<=u;d++)for(let l=c;l<=h;l++)if(a.call(this,t,e,n,i,this.xCellCount*l+d,r,o,s))return}_convertToXCellCoord(t){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(t*this.xScale)))}_convertToYCellCoord(t){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(t*this.yScale)))}_circlesCollide(t,e,n,i,a,r){const o=i-t,s=a-e,l=n+r;return l*l>o*o+s*s}_circleAndRectCollide(t,e,n,i,a,r,o){const s=(r-i)/2,l=Math.abs(t-(i+s));if(l>s+n)return!1;const c=(o-a)/2,u=Math.abs(e-(a+c));if(u>c+n)return!1;if(l<=s||u<=c)return!0;const h=l-s,d=u-c;return h*h+d*d<=n*n}}const Ja=100;class tr{constructor(t,e,n=new Qa(t.width+200,t.height+200,25),i=new Qa(t.width+200,t.height+200,25)){this.transform=t,this.grid=n,this.ignoredGrid=i,this.pitchfactor=Math.cos(t._pitch)*t.cameraToCenterDistance,this.screenRightBoundary=t.width+Ja,this.screenBottomBoundary=t.height+Ja,this.gridRightBoundary=t.width+200,this.gridBottomBoundary=t.height+200,this.fogState=e}placeCollisionBox(t,e,n,i,a,r,o,s){let l=n.projectedAnchorX,c=n.projectedAnchorY,u=n.projectedAnchorZ;const h=n.elevation,d=n.tileID,p=t.getProjection();if(h&&d){const[t,e,i]=p.upVector(d.canonical,n.tileAnchorX,n.tileAnchorY),a=p.upVectorScale(d.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;l+=t*h*a,c+=e*h*a,u+=i*h*a}const f=this.projectAndGetPerspectiveRatio(o,l,c,u,n.tileID,"globe"===p.name||!!h||this.transform.pitch>0,p),m=r*f.perspectiveRatio,g=(n.x1*e+i.x-n.padding)*m+f.point.x,_=(n.y1*e+i.y-n.padding)*m+f.point.y,y=(n.x2*e+i.x+n.padding)*m+f.point.x,x=(n.y2*e+i.y+n.padding)*m+f.point.y,v=f.perspectiveRatio<=.55||f.occluded;return!this.isInsideGrid(g,_,y,x)||!a&&this.grid.hitTest(g,_,y,x,s)||v?{box:[],offscreen:!1,occluded:f.occluded}:{box:[g,_,y,x],offscreen:this.isOffscreen(g,_,y,x),occluded:!1}}placeCollisionCircles(e,n,i,a,r,o,s,l,c,u,h,d,p,f,m){const g=[],_=this.transform.elevation,y=e.getProjection(),x=_?_.getAtTileOffsetFunc(m,this.transform.center.lat,this.transform.worldSize,y):null,v=new t.P(i.tileAnchorX,i.tileAnchorY);let{x:b,y:w,z:A}=y.projectTilePoint(v.x,v.y,m.canonical);if(x){const[t,e,n]=x(v);b+=t,w+=e,A+=n}const C="globe"===y.name,E=this.projectAndGetPerspectiveRatio(s,b,w,A,m,C||!!_||this.transform.pitch>0,y),{perspectiveRatio:T}=E,S=(h?o/T:o*T)/t.bN,M=tn(b,w,A,l),k=E.signedDistanceFromCamera>0?rn(S,r,i.lineOffsetX*S,i.lineOffsetY*S,!1,M,v,i,a,l,{},_&&!h?x:null,h&&!!_,y,m,h):null;let I=!1,P=!1,z=!0;if(k&&!E.occluded){const e=.5*p*T+f,i=new t.P(-100,-100),a=new t.P(this.screenRightBoundary,this.screenBottomBoundary),r=new Ka,{first:o,last:s}=k,l=o.path.length;let h=[];for(let t=l-1;t>=1;t--)h.push(o.path[t]);for(let t=1;t<s.path.length;t++)h.push(s.path[t]);const m=2.5*e;c&&(h=h.map((([t,e,n],i)=>(x&&!C&&(n=x(i<l-1?o.tilePath[l-1-i]:s.tilePath[i-l+2])[2]),tn(t,e,n,c)))),h.some((t=>t[3]<=0))&&(h=[]));let _=[];if(h.length>0){let e=1/0,n=-1/0,r=1/0,o=-1/0;for(const t of h)e=Math.min(e,t[0]),r=Math.min(r,t[1]),n=Math.max(n,t[0]),o=Math.max(o,t[1]);n>=i.x&&e<=a.x&&o>=i.y&&r<=a.y&&(_=[h.map((e=>new t.P(e[0],e[1])))],(e<i.x||n>a.x||r<i.y||o>a.y)&&(_=t.cF(_,i.x,i.y,a.x,a.y)))}for(const t of _){r.reset(t,.25*e);let i=0;i=r.length<=.5*e?1:Math.ceil(r.paddedLength/m)+1;for(let t=0;t<i;t++){const a=t/Math.max(i-1,1),o=r.lerp(a),s=o.x+Ja,l=o.y+Ja;g.push(s,l,e,0);const c=s-e,h=l-e,p=s+e,f=l+e;if(z=z&&this.isOffscreen(c,h,p,f),P=P||this.isInsideGrid(c,h,p,f),!n&&this.grid.hitTestCircle(s,l,e,d)&&(I=!0,!u))return{circles:[],offscreen:!1,collisionDetected:I,occluded:!1}}}}return{circles:!u&&I||!P?[]:g,offscreen:z,collisionDetected:I,occluded:E.occluded}}queryRenderedSymbols(e){if(0===e.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};const n=[];let i=1/0,a=1/0,r=-1/0,o=-1/0;for(const s of e){const e=new t.P(s.x+Ja,s.y+Ja);i=Math.min(i,e.x),a=Math.min(a,e.y),r=Math.max(r,e.x),o=Math.max(o,e.y),n.push(e)}const s=this.grid.query(i,a,r,o).concat(this.ignoredGrid.query(i,a,r,o)),l={},c={};for(const e of s){const i=e.key;if(void 0===l[i.bucketInstanceId]&&(l[i.bucketInstanceId]={}),l[i.bucketInstanceId][i.featureIndex])continue;const a=[new t.P(e.x1,e.y1),new t.P(e.x2,e.y1),new t.P(e.x2,e.y2),new t.P(e.x1,e.y2)];t.cG(n,a)&&(l[i.bucketInstanceId][i.featureIndex]=!0,void 0===c[i.bucketInstanceId]&&(c[i.bucketInstanceId]=[]),c[i.bucketInstanceId].push(i.featureIndex))}return c}insertCollisionBox(t,e,n,i,a){(e?this.ignoredGrid:this.grid).insert({bucketInstanceId:n,featureIndex:i,collisionGroupID:a},t[0],t[1],t[2],t[3])}insertCollisionCircles(t,e,n,i,a){const r=e?this.ignoredGrid:this.grid,o={bucketInstanceId:n,featureIndex:i,collisionGroupID:a};for(let e=0;e<t.length;e+=4)r.insertCircle(o,t[e],t[e+1],t[e+2])}projectAndGetPerspectiveRatio(e,n,i,a,r,o,s){const l=[n,i,a,1];let c=!1;if(a||this.transform.pitch>0){if(t.aA.transformMat4(l,l,e),this.fogState&&r&&"globe"!==s.name){const e=function(e,n,i,a,r,o){const s=o.calculateFogTileMatrix(r),l=[n,i,a];return t._.transformMat4(l,l,s),ie(e,t._.length(l),o.pitch,o._fov)}(this.fogState,n,i,a,r.toUnwrapped(),this.transform);c=e>.9}}else dn(l,l,e);const u=l[3];return{point:new t.P((l[0]/u+1)/2*this.transform.width+Ja,(-l[1]/u+1)/2*this.transform.height+Ja),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(s)/u*.5,1.5),signedDistanceFromCamera:u,occluded:o&&l[2]>u||c}}isOffscreen(t,e,n,i){return n<Ja||t>=this.screenRightBoundary||i<Ja||e>this.screenBottomBoundary}isInsideGrid(t,e,n,i){return n>=0&&t<this.gridRightBoundary&&i>=0&&e<this.gridBottomBoundary}getViewportMatrix(){const e=t.ad.identity([]);return t.ad.translate(e,e,[-100,-100,0]),e}}class er{constructor(t,e,n,i){this.opacity=t?Math.max(0,Math.min(1,t.opacity+(t.placed?e:-e))):i&&n?1:0,this.placed=n}isHidden(){return 0===this.opacity&&!this.placed}}class nr{constructor(t,e,n,i,a,r=!1){this.text=new er(t?t.text:null,e,n,a),this.icon=new er(t?t.icon:null,e,i,a),this.clipped=r}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class ir{constructor(t,e,n,i=!1){this.text=t,this.icon=e,this.skipFade=n,this.clipped=i}}class ar{constructor(){this.invProjMatrix=t.ad.create(),this.viewportMatrix=t.ad.create(),this.circles=[]}}class rr{constructor(t,e,n,i,a){this.bucketInstanceId=t,this.featureIndex=e,this.sourceLayerIndex=n,this.bucketIndex=i,this.tileID=a}}class or{constructor(t){this.crossSourceCollisions=t,this.maxGroupID=0,this.collisionGroups={}}get(t){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[t]){const e=++this.maxGroupID;this.collisionGroups[t]={ID:e,predicate:t=>t.collisionGroupID===e}}return this.collisionGroups[t]}}function sr(e,n,i,a,r){const{horizontalAlign:o,verticalAlign:s}=t.bQ(e),l=-(o-.5)*n,c=-(s-.5)*i,u=t.bP(e,a);return new t.P(l+u[0]*r,c+u[1]*r)}function lr(e,n,i,a,r){const o=new t.P(e,n);return i&&o._rotate(a?r:-r),o}class cr{constructor(t,e,n,i,a,r){this.transform=t.clone(),this.projection=t.projection.name,this.collisionIndex=new tr(this.transform,a),this.buildingIndex=r,this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=e,this.retainedQueryData={},this.collisionGroups=new or(n),this.collisionCircleArrays={},this.prevPlacement=i,i&&(i.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(e,n,i,a){const r=i.getBucket(n),o=i.latestFeatureIndex;if(!r||!o||n.fqid!==r.layerIds[0])return;const s=r.layers[0].layout,l=i.collisionBoxArray,c=Math.pow(2,this.transform.zoom-i.tileID.overscaledZ),u=i.tileSize/t.a3,h=i.tileID.toUnwrapped();this.transform.setProjection(r.projection);const d=(p=i.tileID,f=r.getProjection(),m=this.transform,f.name===this.projection?m.calculateProjMatrix(p.toUnwrapped()):wi(m,f,p));var p,f,m;const g="map"===s.get("text-pitch-alignment"),_="map"===s.get("text-rotation-alignment");n.compileFilter();const y=n.dynamicFilter(),x=n.dynamicFilterNeedsFeature(),v=this.transform.calculatePixelsToTileUnitsMatrix(i),b=Qe(d,i.tileID.canonical,g,_,this.transform,r.getProjection(),v);let w=null;if(g){const e=Je(d,i.tileID.canonical,g,_,this.transform,r.getProjection(),v);w=t.ad.multiply([],this.transform.labelPlaneMatrix,e)}let A=null;y&&i.latestFeatureIndex&&(A={unwrappedTileID:h,dynamicFilter:y,dynamicFilterNeedsFeature:x,featureIndex:i.latestFeatureIndex}),this.retainedQueryData[r.bucketInstanceId]=new rr(r.bucketInstanceId,o,r.sourceLayerIndex,r.index,i.tileID);const C={bucket:r,layout:s,posMatrix:d,textLabelPlaneMatrix:b,labelToScreenMatrix:w,clippingData:A,scale:c,textPixelRatio:u,holdingForFade:i.holdingForFade(),collisionBoxArray:l,partiallyEvaluatedTextSize:t.aD(r.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:t.aD(r.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(r.sourceID)};if(a)for(const t of r.sortKeyRanges){const{sortKey:n,symbolInstanceStart:i,symbolInstanceEnd:a}=t;e.push({sortKey:n,symbolInstanceStart:i,symbolInstanceEnd:a,parameters:C})}else e.push({symbolInstanceStart:0,symbolInstanceEnd:r.symbolInstances.length,parameters:C})}attemptAnchorPlacement(t,e,n,i,a,r,o,s,l,c,u,h,d,p,f,m,g,_){const{textOffset0:y,textOffset1:x,crossTileID:v}=h,b=[y,x],w=sr(t,n,i,b,a),A=this.collisionIndex.placeCollisionBox(p,a,e,lr(w.x,w.y,r,o,this.transform.angle),u,s,l,c.predicate);if(m){const t=p.getSymbolInstanceIconSize(_,this.transform.zoom,h.placedIconSymbolIndex);if(0===this.collisionIndex.placeCollisionBox(p,t,m,lr(w.x,w.y,r,o,this.transform.angle),u,s,l,c.predicate).box.length)return}if(A.box.length>0){let e;return this.prevPlacement&&this.prevPlacement.variableOffsets[v]&&this.prevPlacement.placements[v]&&this.prevPlacement.placements[v].text&&(e=this.prevPlacement.variableOffsets[v].anchor),this.variableOffsets[v]={textOffset:b,width:n,height:i,anchor:t,textScale:a,prevAnchor:e},this.markUsedJustification(p,t,h,f),p.allowVerticalPlacement&&(this.markUsedOrientation(p,f,h),this.placedOrientations[v]=f),{shift:w,placedGlyphBoxes:A}}}placeLayerBucketPart(e,n,i,a){const{bucket:r,layout:o,posMatrix:s,textLabelPlaneMatrix:l,labelToScreenMatrix:c,clippingData:u,textPixelRatio:h,holdingForFade:d,collisionBoxArray:p,partiallyEvaluatedTextSize:f,partiallyEvaluatedIconSize:m,collisionGroup:g}=e.parameters,_=o.get("text-optional"),y=o.get("icon-optional"),x=o.get("text-allow-overlap"),v=o.get("icon-allow-overlap"),b="map"===o.get("text-rotation-alignment"),w="map"===o.get("text-pitch-alignment"),A="viewport-y"===o.get("symbol-z-order"),C=o.get("symbol-z-elevate");this.transform.setProjection(r.projection);let E=x&&(v||!r.hasIconData()||y),T=v&&(x||!r.hasTextData()||_);!r.collisionArrays&&p&&r.deserializeCollisionBoxes(p),i&&a&&r.updateCollisionDebugBuffers(this.transform.zoom,p);const S=(e,a,p)=>{const{crossTileID:A,numVerticalGlyphVertices:C}=e;if(u){const i={zoom:this.transform.zoom,pitch:this.transform.pitch};let a=null;if(u.dynamicFilterNeedsFeature){const t=this.retainedQueryData[r.bucketInstanceId];a=u.featureIndex.loadFeature({featureIndex:e.featureIndex,bucketIndex:t.bucketIndex,sourceLayerIndex:t.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,u.dynamicFilter)(i,a,this.retainedQueryData[r.bucketInstanceId].tileID.canonical,new t.P(e.tileAnchorX,e.tileAnchorY),this.transform.calculateDistanceTileData(u.unwrappedTileID)))return this.placements[A]=new ir(!1,!1,!1,!0),void n.add(A)}if(n.has(A))return;if(d)return void(this.placements[A]=new ir(!1,!1,!1));let S=!1,M=!1,k=!0,I=!1,P=!1,z=null,D={box:null,offscreen:null,occluded:null},L={box:null,offscreen:null,occluded:null},B=null,O=null,R=null,F=0,N=0,j=0;p.textFeatureIndex?F=p.textFeatureIndex:e.useRuntimeCollisionCircles&&(F=e.featureIndex),p.verticalTextFeatureIndex&&(N=p.verticalTextFeatureIndex);const V=t=>{t.tileID=this.retainedQueryData[r.bucketInstanceId].tileID;const n=this.transform.elevation;t.elevation=e.zOffset+(n?n.getAtTileOffset(t.tileID,t.tileAnchorX,t.tileAnchorY):0)},U=p.textBox;if(U){V(U);const n=n=>{let i=t.aE.horizontal;if(r.allowVerticalPlacement&&!n&&this.prevPlacement){const t=this.prevPlacement.placedOrientations[A];t&&(this.placedOrientations[A]=t,i=t,this.markUsedOrientation(r,i,e))}return i},i=(e,n)=>{if(r.allowVerticalPlacement&&C>0&&p.verticalTextBox){for(const i of r.writingModes)if(i===t.aE.vertical?(D=n(),L=D):D=e(),D&&D.box&&D.box.length)break}else D=e()};if(o.get("text-variable-anchor")){let l=o.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[A]){const t=this.prevPlacement.variableOffsets[A];l.indexOf(t.anchor)>0&&(l=l.filter((e=>e!==t.anchor)),l.unshift(t.anchor))}const c=(t,n,i)=>{const o=r.getSymbolInstanceTextSize(f,e,this.transform.zoom,a),c=(t.x2-t.x1)*o+2*t.padding,u=(t.y2-t.y1)*o+2*t.padding,d=e.hasIconTextFit&&!v?n:null;d&&V(d);let p={box:[],offscreen:!1,occluded:!1};const _=x?2*l.length:l.length;for(let n=0;n<_;++n){const _=this.attemptAnchorPlacement(l[n%l.length],t,c,u,o,b,w,h,s,g,n>=l.length,e,a,r,i,d,f,m);if(_&&(p=_.placedGlyphBoxes,p&&p.box&&p.box.length)){S=!0,z=_.shift;break}}return p};i((()=>c(U,p.iconBox,t.aE.horizontal)),(()=>{const e=p.verticalTextBox;return e&&V(e),r.allowVerticalPlacement&&!(D&&D.box&&D.box.length)&&C>0&&e?c(e,p.verticalIconBox,t.aE.vertical):{box:null,offscreen:null,occluded:null}})),D&&(S=D.box,k=D.offscreen,I=D.occluded);const u=n(!(!D||!D.box));if(!S&&this.prevPlacement){const t=this.prevPlacement.variableOffsets[A];t&&(this.variableOffsets[A]=t,this.markUsedJustification(r,t.anchor,e,u))}}else{const o=(n,i)=>{const o=r.getSymbolInstanceTextSize(f,e,this.transform.zoom,a),l=this.collisionIndex.placeCollisionBox(r,o,n,new t.P(0,0),x,h,s,g.predicate);return l&&l.box&&l.box.length&&(this.markUsedOrientation(r,i,e),this.placedOrientations[A]=i),l};i((()=>o(U,t.aE.horizontal)),(()=>{const e=p.verticalTextBox;return r.allowVerticalPlacement&&C>0&&e?(V(e),o(e,t.aE.vertical)):{box:null,offscreen:null,occluded:null}})),n(!!(D&&D.box&&D.box.length))}}if(B=D,S=B&&B.box&&B.box.length>0,k=B&&B.offscreen,I=B&&B.occluded,e.useRuntimeCollisionCircles){const n=r.text.placedSymbolArray.get(e.centerJustifiedTextSymbolIndex>=0?e.centerJustifiedTextSymbolIndex:e.verticalPlacedTextSymbolIndex),a=t.aF(r.textSizeData,f,n),u=o.get("text-padding");O=this.collisionIndex.placeCollisionCircles(r,x,n,r.lineVertexArray,r.glyphOffsetArray,a,s,l,c,i,w,g.predicate,e.collisionCircleDiameter*a/t.bN,u,this.retainedQueryData[r.bucketInstanceId].tileID),S=x||O.circles.length>0&&!O.collisionDetected,k=k&&O.offscreen,I=O.occluded}if(p.iconFeatureIndex&&(j=p.iconFeatureIndex),p.iconBox){const n=n=>{V(n);const i=e.hasIconTextFit&&z?lr(z.x,z.y,b,w,this.transform.angle):new t.P(0,0),a=r.getSymbolInstanceIconSize(m,this.transform.zoom,e.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(r,a,n,i,v,h,s,g.predicate)};L&&L.box&&L.box.length&&p.verticalIconBox?(R=n(p.verticalIconBox),M=R.box.length>0):(R=n(p.iconBox),M=R.box.length>0),k=k&&R.offscreen,P=R.occluded}const G=_||0===e.numHorizontalGlyphVertices&&0===C,q=y||0===e.numIconVertices;if(G||q?q?G||(M=M&&S):S=M&&S:M=S=M&&S,S&&B&&B.box&&this.collisionIndex.insertCollisionBox(B.box,o.get("text-ignore-placement"),r.bucketInstanceId,L&&L.box&&N?N:F,g.ID),M&&R&&this.collisionIndex.insertCollisionBox(R.box,o.get("icon-ignore-placement"),r.bucketInstanceId,j,g.ID),O&&(S&&this.collisionIndex.insertCollisionCircles(O.circles,o.get("text-ignore-placement"),r.bucketInstanceId,F,g.ID),i)){const t=r.bucketInstanceId;let e=this.collisionCircleArrays[t];void 0===e&&(e=this.collisionCircleArrays[t]=new ar);for(let t=0;t<O.circles.length;t+=4)e.circles.push(O.circles[t+0]),e.circles.push(O.circles[t+1]),e.circles.push(O.circles[t+2]),e.circles.push(O.collisionDetected?1:0)}const $="globe"!==r.projection.name;E=E&&($||!I),T=T&&($||!P),this.placements[A]=new ir(S||E,M||T,k||r.justReloaded),n.add(A)};if(C&&this.buildingIndex&&(this.buildingIndex.updateZOffset(r,this.retainedQueryData[r.bucketInstanceId].tileID),r.updateZOffset()),A){const e=r.getSortedSymbolIndexes(this.transform.angle);for(let t=e.length-1;t>=0;--t){const n=e[t];S(r.symbolInstances.get(n),n,r.collisionArrays[n])}r.hasAnyZOffset&&t.w(`${r.layerIds[0]} layer symbol-z-elevate: symbols are not sorted by elevation if symbol-z-order is evaluated to viewport-y`)}else if(r.hasAnyZOffset){const t=r.getSortedIndexesByZOffset();for(let e=0;e<t.length;++e){const n=t[e];S(r.symbolInstances.get(n),n,r.collisionArrays[n])}}else for(let t=e.symbolInstanceStart;t<e.symbolInstanceEnd;t++)S(r.symbolInstances.get(t),t,r.collisionArrays[t]);if(i&&r.bucketInstanceId in this.collisionCircleArrays){const e=this.collisionCircleArrays[r.bucketInstanceId];t.ad.invert(e.invProjMatrix,s),e.viewportMatrix=this.collisionIndex.getViewportMatrix()}r.justReloaded=!1}markUsedJustification(e,n,i,a){const{leftJustifiedTextSymbolIndex:r,centerJustifiedTextSymbolIndex:o,rightJustifiedTextSymbolIndex:s,verticalPlacedTextSymbolIndex:l,crossTileID:c}=i,u=t.cJ(n),h=a===t.aE.vertical?l:"left"===u?r:"center"===u?o:"right"===u?s:-1;r>=0&&(e.text.placedSymbolArray.get(r).crossTileID=h>=0&&r!==h?0:c),o>=0&&(e.text.placedSymbolArray.get(o).crossTileID=h>=0&&o!==h?0:c),s>=0&&(e.text.placedSymbolArray.get(s).crossTileID=h>=0&&s!==h?0:c),l>=0&&(e.text.placedSymbolArray.get(l).crossTileID=h>=0&&l!==h?0:c)}markUsedOrientation(e,n,i){const a=n===t.aE.horizontal||n===t.aE.horizontalOnly?n:0,r=n===t.aE.vertical?n:0,{leftJustifiedTextSymbolIndex:o,centerJustifiedTextSymbolIndex:s,rightJustifiedTextSymbolIndex:l,verticalPlacedTextSymbolIndex:c}=i,u=e.text.placedSymbolArray;o>=0&&(u.get(o).placedOrientation=a),s>=0&&(u.get(s).placedOrientation=a),l>=0&&(u.get(l).placedOrientation=a),c>=0&&(u.get(c).placedOrientation=r)}commit(t){this.commitTime=t,this.zoomAtLastRecencyCheck=this.transform.zoom;const e=this.prevPlacement;let n=!1;this.prevZoomAdjustment=e?e.zoomAdjustment(this.transform.zoom):0;const i=e?e.symbolFadeChange(t):1,a=e?e.opacities:{},r=e?e.variableOffsets:{},o=e?e.placedOrientations:{};for(const t in this.placements){const e=this.placements[t],r=a[t];r?(this.opacities[t]=new nr(r,i,e.text,e.icon,null,e.clipped),n=n||e.text!==r.text.placed||e.icon!==r.icon.placed):(this.opacities[t]=new nr(null,i,e.text,e.icon,e.skipFade,e.clipped),n=n||e.text||e.icon)}for(const t in a){const e=a[t];if(!this.opacities[t]){const a=new nr(e,i,!1,!1);a.isHidden()||(this.opacities[t]=a,n=n||e.text.placed||e.icon.placed)}}for(const t in r)this.variableOffsets[t]||!this.opacities[t]||this.opacities[t].isHidden()||(this.variableOffsets[t]=r[t]);for(const t in o)this.placedOrientations[t]||!this.opacities[t]||this.opacities[t].isHidden()||(this.placedOrientations[t]=o[t]);n?this.lastPlacementChangeTime=t:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=e?e.lastPlacementChangeTime:t)}updateLayerOpacities(t,e,n,i){const a=new Set;for(const r of e){const e=r.getBucket(t);e&&r.latestFeatureIndex&&t.fqid===e.layerIds[0]&&(this.updateBucketOpacities(e,a,r.collisionBoxArray,n,i,r.tileID),e.layers[0].layout.get("symbol-z-elevate")&&this.buildingIndex&&(this.buildingIndex.updateZOffset(e,r.tileID),e.updateZOffset()))}}updateBucketOpacities(e,n,i,a,r,o){e.hasTextData()&&e.text.opacityVertexArray.clear(),e.hasIconData()&&e.icon.opacityVertexArray.clear(),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexArray.clear(),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexArray.clear();const s=e.layers[0].layout,l=!!e.layers[0].dynamicFilter(),c=new nr(null,0,!1,!1,!0),u=s.get("text-allow-overlap"),h=s.get("icon-allow-overlap"),d=s.get("text-variable-anchor"),p="map"===s.get("text-rotation-alignment"),f="map"===s.get("text-pitch-alignment"),m=new nr(null,0,u&&(h||!e.hasIconData()||s.get("icon-optional")),h&&(u||!e.hasTextData()||s.get("text-optional")),!0);!e.collisionArrays&&i&&(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData())&&e.deserializeCollisionBoxes(i);const g=(t,e,n)=>{for(let i=0;i<e/4;i++)t.opacityVertexArray.emplaceBack(n)};let _=0;r&&e.updateReplacement(o,r);for(let i=0;i<e.symbolInstances.length;i++){const s=e.symbolInstances.get(i),{numHorizontalGlyphVertices:u,numVerticalGlyphVertices:h,crossTileID:y,numIconVertices:x,tileAnchorX:v,tileAnchorY:b}=s,w=n.has(y);let A=this.opacities[y];w?A=c:A||(A=m,this.opacities[y]=A),n.add(y);const C=u>0||h>0,E=x>0,T=this.placedOrientations[y],S=T===t.aE.vertical,M=T===t.aE.horizontal||T===t.aE.horizontalOnly;!C&&!E||A.isHidden()||_++;let k=!1;if((C||E)&&r)for(const n of e.activeReplacements){if(n.order<a||n.order===1/0||!(n.clipMask&t.cu.Symbol))continue;if(n.min.x>v||v>n.max.x||n.min.y>b||b>n.max.y)continue;const e=t.cH(v,b,o.canonical,n.footprintTileId.canonical);if(k=t.cI(e,n),k)break}if(C){const t=k?xr:yr(A.text);g(e.text,u,S?xr:t),g(e.text,h,M?xr:t);const n=A.text.isHidden(),{leftJustifiedTextSymbolIndex:i,centerJustifiedTextSymbolIndex:a,rightJustifiedTextSymbolIndex:r,verticalPlacedTextSymbolIndex:o}=s,l=e.text.placedSymbolArray,c=n||S?1:0;i>=0&&(l.get(i).hidden=c),a>=0&&(l.get(a).hidden=c),r>=0&&(l.get(r).hidden=c),o>=0&&(l.get(o).hidden=n||M?1:0);const d=this.variableOffsets[y];d&&this.markUsedJustification(e,d.anchor,s,T);const p=this.placedOrientations[y];p&&(this.markUsedJustification(e,"left",s,p),this.markUsedOrientation(e,p,s))}if(E){const t=k?xr:yr(A.icon),{placedIconSymbolIndex:n,verticalPlacedIconSymbolIndex:i}=s,a=e.icon.placedSymbolArray,r=A.icon.isHidden()?1:0;n>=0&&(g(e.icon,x,S?xr:t),a.get(n).hidden=r),i>=0&&(g(e.icon,s.numVerticalIconVertices,M?xr:t),a.get(i).hidden=r)}if(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData()){const n=e.collisionArrays[i];if(n){let i=new t.P(0,0),a=!0;if(n.textBox||n.verticalTextBox){if(d){const t=this.variableOffsets[y];t?(i=sr(t.anchor,t.width,t.height,t.textOffset,t.textScale),p&&i._rotate(f?this.transform.angle:-this.transform.angle)):a=!1}l&&(a=!A.clipped),n.textBox&&ur(e.textCollisionBox.collisionVertexArray,A.text.placed,!a||S,i.x,i.y),n.verticalTextBox&&ur(e.textCollisionBox.collisionVertexArray,A.text.placed,!a||M,i.x,i.y)}const r=a&&Boolean(!M&&n.verticalIconBox);n.iconBox&&ur(e.iconCollisionBox.collisionVertexArray,A.icon.placed,r,s.hasIconTextFit?i.x:0,s.hasIconTextFit?i.y:0),n.verticalIconBox&&ur(e.iconCollisionBox.collisionVertexArray,A.icon.placed,!r,s.hasIconTextFit?i.x:0,s.hasIconTextFit?i.y:0)}}}if(e.fullyClipped=0===_,e.sortFeatures(this.transform.angle),this.retainedQueryData[e.bucketInstanceId]&&(this.retainedQueryData[e.bucketInstanceId].featureSortOrder=e.featureSortOrder),e.hasTextData()&&e.text.opacityVertexBuffer&&e.text.opacityVertexBuffer.updateData(e.text.opacityVertexArray),e.hasIconData()&&e.icon.opacityVertexBuffer&&e.icon.opacityVertexBuffer.updateData(e.icon.opacityVertexArray),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexBuffer&&e.iconCollisionBox.collisionVertexBuffer.updateData(e.iconCollisionBox.collisionVertexArray),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexBuffer&&e.textCollisionBox.collisionVertexBuffer.updateData(e.textCollisionBox.collisionVertexArray),e.bucketInstanceId in this.collisionCircleArrays){const t=this.collisionCircleArrays[e.bucketInstanceId];e.placementInvProjMatrix=t.invProjMatrix,e.placementViewportMatrix=t.viewportMatrix,e.collisionCircleArray=t.circles,delete this.collisionCircleArrays[e.bucketInstanceId]}}symbolFadeChange(t){return 0===this.fadeDuration?1:(t-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(t){return Math.max(0,(this.transform.zoom-t)/1.5)}hasTransitions(t){return this.stale||t-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(t,e){const n=this.zoomAtLastRecencyCheck===e?1-this.zoomAdjustment(e):1;return this.zoomAtLastRecencyCheck=e,this.commitTime+this.fadeDuration*n>t}setStale(){this.stale=!0}}function ur(t,e,n,i,a){t.emplaceBack(e?1:0,n?1:0,i||0,a||0),t.emplaceBack(e?1:0,n?1:0,i||0,a||0),t.emplaceBack(e?1:0,n?1:0,i||0,a||0),t.emplaceBack(e?1:0,n?1:0,i||0,a||0)}const hr=Math.pow(2,25),dr=Math.pow(2,24),pr=Math.pow(2,17),fr=Math.pow(2,16),mr=Math.pow(2,9),gr=Math.pow(2,8),_r=Math.pow(2,1);function yr(t){if(0===t.opacity&&!t.placed)return 0;if(1===t.opacity&&t.placed)return 4294967295;const e=t.placed?1:0,n=Math.floor(127*t.opacity);return n*hr+e*dr+n*pr+e*fr+n*mr+e*gr+n*_r+e}const xr=0;class vr{constructor(t){this._sortAcrossTiles="viewport-y"!==t.layout.get("symbol-z-order")&&void 0!==t.layout.get("symbol-sort-key").constantOr(1),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(t,e,n,i,a){const r=this._bucketParts;for(;this._currentTileIndex<t.length;)if(e.getBucketParts(r,i,t[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,a())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,r.sort(((t,e)=>t.sortKey-e.sortKey)));this._currentPartIndex<r.length;){const t=r[this._currentPartIndex];if(e.placeLayerBucketPart(t,this._seenCrossTileIDs,n,0===t.symbolInstanceStart),this._currentPartIndex++,a())return!0}return!1}}class br{constructor(t,e,n,i,a,r,o,s,l){this.placement=new cr(t,a,r,o,s,l),this._currentPlacementIndex=e.length-1,this._forceFullPlacement=n,this._showCollisionBoxes=i,this._done=!1}isDone(){return this._done}continuePlacement(e,n,i,a){const r=t.e.now(),o=()=>{const e=t.e.now()-r;return!this._forceFullPlacement&&e>2};for(;this._currentPlacementIndex>=0;){const r=n[e[this._currentPlacementIndex]],s=this.placement.collisionIndex.transform.zoom;if("symbol"===r.type&&(!r.minzoom||r.minzoom<=s)&&(!r.maxzoom||r.maxzoom>s)){const e=r,n=e.layout.get("symbol-z-elevate"),s=this._inProgressLayer=this._inProgressLayer||new vr(e),l=t.al(r.source,r.scope);if(s.continuePlacement(n?a[l]:i[l],this.placement,this._showCollisionBoxes,r,o))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(t){return this.placement.commit(t),this.placement}}const wr=512/t.a3/2;class Ar{constructor(e,n,i){this.tileID=e,this.bucketInstanceId=i,this.index=new t.cK(n.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const a=e.canonical.x*t.a3,r=e.canonical.y*t.a3;for(let t=0;t<n.length;t++){const{key:e,crossTileID:i,tileAnchorX:o,tileAnchorY:s}=n.get(t),l=Math.floor((a+o)*wr),c=Math.floor((r+s)*wr);this.index.add(l,c),this.keys.push(e),this.crossTileIDs.push(i)}this.index.finish()}findMatches(e,n,i){const a=this.tileID.canonical.z<n.canonical.z?1:Math.pow(2,this.tileID.canonical.z-n.canonical.z),r=wr/Math.pow(2,n.canonical.z-this.tileID.canonical.z),o=n.canonical.x*t.a3,s=n.canonical.y*t.a3;for(let t=0;t<e.length;t++){const n=e.get(t);if(n.crossTileID)continue;const{key:l,tileAnchorX:c,tileAnchorY:u}=n,h=Math.floor((o+c)*r),d=Math.floor((s+u)*r),p=this.index.range(h-a,d-a,h+a,d+a);for(const t of p){const e=this.crossTileIDs[t];if(this.keys[t]===l&&!i.has(e)){i.add(e),n.crossTileID=e;break}}}}}class Cr{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Er{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(t){const e=Math.round((t-this.lng)/360);if(0!==e)for(const t in this.indexes){const n=this.indexes[t],i={};for(const t in n){const a=n[t];a.tileID=a.tileID.unwrapTo(a.tileID.wrap+e),i[a.tileID.key]=a}this.indexes[t]=i}this.lng=t}addBucket(t,e,n){if(this.indexes[t.overscaledZ]&&this.indexes[t.overscaledZ][t.key]){if(this.indexes[t.overscaledZ][t.key].bucketInstanceId===e.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(t.overscaledZ,this.indexes[t.overscaledZ][t.key])}for(let t=0;t<e.symbolInstances.length;t++)e.symbolInstances.get(t).crossTileID=0;this.usedCrossTileIDs[t.overscaledZ]||(this.usedCrossTileIDs[t.overscaledZ]=new Set);const i=this.usedCrossTileIDs[t.overscaledZ];for(const n in this.indexes){const a=this.indexes[n];if(Number(n)>t.overscaledZ)for(const n in a){const r=a[n];r.tileID.isChildOf(t)&&r.findMatches(e.symbolInstances,t,i)}else{const r=a[t.scaledTo(Number(n)).key];r&&r.findMatches(e.symbolInstances,t,i)}}for(let t=0;t<e.symbolInstances.length;t++){const a=e.symbolInstances.get(t);a.crossTileID||(a.crossTileID=n.generate(),i.add(a.crossTileID))}return void 0===this.indexes[t.overscaledZ]&&(this.indexes[t.overscaledZ]={}),this.indexes[t.overscaledZ][t.key]=new Ar(t,e.symbolInstances,e.bucketInstanceId),!0}removeBucketCrossTileIDs(t,e){for(const n of e.crossTileIDs)this.usedCrossTileIDs[t].delete(n)}removeStaleBuckets(t){let e=!1;for(const n in this.indexes){const i=this.indexes[n];for(const a in i)t[i[a].bucketInstanceId]||(this.removeBucketCrossTileIDs(n,i[a]),delete i[a],e=!0)}return e}}class Tr{constructor(){this.layerIndexes={},this.crossTileIDs=new Cr,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(t,e,n,i){let a=this.layerIndexes[t.fqid];void 0===a&&(a=this.layerIndexes[t.fqid]=new Er);let r=!1;const o={};"globe"!==i.name&&a.handleWrapJump(n);for(const n of e){const e=n.getBucket(t);e&&t.fqid===e.layerIds[0]&&(e.bucketInstanceId||(e.bucketInstanceId=++this.maxBucketInstanceId),a.addBucket(n.tileID,e,this.crossTileIDs)&&(r=!0),o[e.bucketInstanceId]=!0)}return a.removeStaleBuckets(o)&&(r=!0),r}pruneUnusedLayers(t){const e={};t.forEach((t=>{e[t]=!0}));for(const t in this.layerIndexes)e[t]||delete this.layerIndexes[t]}}const Sr=new t.N({data:new t.O(t.L.colorTheme.data)}),Mr=(t,e)=>Yt(t,e&&e.filter((t=>"source.canvas"!==t.identifier))),kr=t.ah(Ga,["addLayer","removeLayer","setLights","setPaintProperty","setLayoutProperty","setSlot","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection","setCamera","addImport","removeImport","updateImport"]),Ir=t.ah(Ga,["setCenter","setZoom","setBearing","setPitch"]),Pr={version:8,layers:[],sources:{}},zr={duration:300,delay:0};class Dr extends t.E{constructor(e,n={}){super(),this.map=e,this.scope=n.scope||"",this.globalId=null,this.fragments=[],this.importDepth=n.importDepth||0,this.importsCache=n.importsCache||new Map,this.resolvedImports=n.resolvedImports||new Set,this.transition=t.W({},zr),this._buildingIndex=new ja(this),this.crossTileSymbolIndex=new Tr,this._mergedOrder=[],this._drapedFirstOrder=[],this._mergedLayers={},this._mergedSourceCaches={},this._mergedOtherSourceCaches={},this._mergedSymbolSourceCaches={},this._clipLayerIndices=[],this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this._changes=n.styleChanges||new y,this.dispatcher=n.dispatcher?n.dispatcher:new t.bw(t.bx(),this),n.imageManager?this.imageManager=n.imageManager:(this.imageManager=new ht,this.imageManager.setEventedParent(this)),this.imageManager.createScope(this.scope),this.glyphManager=n.glyphManager?n.glyphManager:new t.cM(e._requestManager,n.localFontFamily?t.cN.all:n.localIdeographFontFamily?t.cN.ideographs:t.cN.none,n.localFontFamily||n.localIdeographFontFamily),n.modelManager?this.modelManager=n.modelManager:(this.modelManager=new ct(e._requestManager),this.modelManager.setEventedParent(this)),this._layers={},this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._precompileDone=!1,this._shouldPrecompile=!1,this._availableImages=[],this._order=[],this._markersNeedUpdate=!1,this._styleColorTheme={lut:null,lutLoading:!1,colorTheme:null},this._styleColorThemeForScope={},this.options=n.configOptions?n.configOptions:new Map,this._configDependentLayers=n.configDependentLayers?n.configDependentLayers:new Set,this._config=n.config,this._initialConfig=n.initialConfig,this.dispatcher.broadcast("setReferrer",t.cO());const i=this;this._rtlTextPluginCallback=Dr.registerForPluginStateChange((e=>{i.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:e.pluginStatus,pluginURL:e.pluginURL},((e,n)=>{if(t.cP(e),n&&n.every((t=>t)))for(const t in i._sourceCaches){const e=i._sourceCaches[t],n=e.getSource().type;"vector"!==n&&"geojson"!==n||e.reload()}}))})),this.on("data",(t=>{if("source"!==t.dataType||"metadata"!==t.sourceDataType)return;const e=this.getOwnSource(t.sourceId);if(e&&e.vectorLayerIds)for(const t in this._layers){const n=this._layers[t];n.source===e.id&&this._validateLayer(n)}}))}load(t){return t?("string"==typeof t?this.loadURL(t):this.loadJSON(t),this):this}_getGlobalId(e){if(!e)return null;if("string"==typeof e){if(t.cQ(e))return e;const n=t.cR(e);if(!n.startsWith("http"))try{return new URL(n,location.href).toString()}catch(t){return n}return n}return`json://${t.cS(JSON.stringify(e))}`}_diffStyle(e,n,i){this.globalId=this._getGlobalId(e);const a=(t,e)=>{try{e(null,this.setState(t,i))}catch(t){e(t,!1)}};if("string"==typeof e){const i=this.map._requestManager.normalizeStyleURL(e),r=this.map._requestManager.transformRequest(i,t.R.Style);t.g(r,((e,i)=>{e?this.fire(new t.d(e)):i&&a(i,n)}))}else"object"==typeof e&&a(e,n)}loadURL(e,n={}){this.fire(new t.f("dataloading",{dataType:"style"}));const i="boolean"==typeof n.validate?n.validate:!t.cQ(e);this.globalId=this._getGlobalId(e),e=this.map._requestManager.normalizeStyleURL(e,n.accessToken),this.resolvedImports.add(e);const a=this.importsCache.get(e);if(a)return this._load(a,i);const r=this.map._requestManager.transformRequest(e,t.R.Style);this._request=t.g(r,((n,a)=>{if(this._request=null,n)this.fire(new t.d(n));else if(a)return this.importsCache.set(e,a),this._load(a,i)}))}loadJSON(e,n={}){this.fire(new t.f("dataloading",{dataType:"style"})),this.globalId=this._getGlobalId(e),this._request=t.e.frame((()=>{this._request=null,this._load(e,!1!==n.validate)}))}loadEmpty(){this.fire(new t.f("dataloading",{dataType:"style"})),this._load(Pr,!1)}_loadImports(e,n,i){if(this.importDepth>=4)return t.w("Style doesn't support nesting deeper than 5"),Promise.resolve();const a=[];for(const t of e){const e=this._createFragmentStyle(t),r=new Promise((t=>{e.once("style.import.load",t),e.once("error",t)})).then((()=>this.mergeAll()));if(a.push(r),this.resolvedImports.has(t.url)){e.loadEmpty();continue}const o=t.data||this.importsCache.get(t.url);o?(e.loadJSON(o,{validate:n}),this._isInternalStyle(o)&&(e.globalId=null)):t.url?e.loadURL(t.url,{validate:n}):e.loadEmpty();const s={style:e,id:t.id,config:t.config};if(i){const t=this.fragments.findIndex((({id:t})=>t===i));this.fragments=this.fragments.slice(0,t).concat(s).concat(this.fragments.slice(t))}else this.fragments.push(s)}return Promise.allSettled(a)}getImportGlobalIds(t=this,e=new Set){for(const n of t.fragments)n.style.globalId&&e.add(n.style.globalId),this.getImportGlobalIds(n.style,e);return[...e.values()]}_createFragmentStyle(e){const n=this.scope?t.al(e.id,this.scope):e.id;let i;const a=this._initialConfig&&this._initialConfig[n];(e.config||a)&&(i=t.W({},e.config,a));const r=new Dr(this.map,{scope:n,styleChanges:this._changes,importDepth:this.importDepth+1,importsCache:this.importsCache,resolvedImports:new Set(this.resolvedImports),dispatcher:this.dispatcher,imageManager:this.imageManager,glyphManager:this.glyphManager,modelManager:this.modelManager,config:i,configOptions:this.options,configDependentLayers:this._configDependentLayers});return r.setEventedParent(this.map,{style:r}),r}_reloadImports(){this.mergeAll(),this._updateMapProjection(),this.updateConfigDependencies(),this.map._triggerCameraUpdate(this.camera),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),this._shouldPrecompile=this.isRootStyle()}_isInternalStyle(t){return this.isRootStyle()&&(t.fragment||!!t.schema&&!1!==t.fragment)}_load(e,n){const i=e.schema;if(this._isInternalStyle(e)){const i=t.W({},Pr,{imports:[{id:"basemap",data:e,url:""}]});return void this._load(i,n)}if(this.updateConfig(this._config,i),n&&Mr(this,Rt(e)))return;this._loaded=!0,this.stylesheet=t.cT(e);const a=()=>{for(const t in e.sources)this.addSource(t,e.sources[t],{validate:!1,isInitialLoad:!0});e.sprite?this._loadSprite(e.sprite):(this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0})),this.glyphManager.setURL(e.glyphs,this.scope);const i=Ua(this.stylesheet.layers);if(this._order=i.map((t=>t.id)),this.stylesheet.light&&t.w("The `light` root property is deprecated, prefer using `lights` with `flat` light type instead."),this.stylesheet.lights)if(1===this.stylesheet.lights.length&&"flat"===this.stylesheet.lights[0].type){const t=this.stylesheet.lights[0];this.light=new Kt(t.properties,t.id)}else this.setLights(this.stylesheet.lights);this.light||(this.light=new Kt(this.stylesheet.light)),this._layers={},this._serializedLayers={};for(const e of i){const n=t.cY(e,this.scope,this._styleColorTheme.lut,this.options);n.isConfigDependent&&this._configDependentLayers.add(n.fqid),n.setEventedParent(this,{layer:{id:n.id}}),this._layers[n.id]=n,this._serializedLayers[n.id]=n.serialize();const i=this.getOwnLayerSourceCache(n),a=!!this.directionalLight&&this.directionalLight.shadowsEnabled();i&&n.canCastShadows()&&a&&(i.castsShadows=!0)}this.stylesheet.models&&this.modelManager.addModels(this.stylesheet.models,this.scope);const a=this.stylesheet.terrain;a&&(this.checkCanvasFingerprintNoise(),this.terrainSetForDrapingOnly()||this._createTerrain(a,1)),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this.stylesheet.transition&&this.setTransition(this.stylesheet.transition),this.fire(new t.f("data",{dataType:"style"}));const r=this.isRootStyle();e.imports?this._loadImports(e.imports,n).then((()=>{this._reloadImports(),this.fire(new t.f(r?"style.load":"style.import.load"))})):(this._reloadImports(),this.fire(new t.f(r?"style.load":"style.import.load")))},r=this.stylesheet["color-theme"];if(this._styleColorTheme.colorTheme=r,r){const e=this._evaluateColorThemeData(r);this._loadColorTheme(e).then((()=>{a()})).catch((e=>{t.w(`Couldn't load color theme from the stylesheet: ${e}`),a()}))}else this._styleColorTheme.lut=null,a()}isRootStyle(){return 0===this.importDepth}mergeAll(){let e,n,i,a,r,o,s,l;const c={};this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle((t=>{if(t.stylesheet){if(null!=t.light&&(e=t.light),t.stylesheet.lights)for(const e of t.stylesheet.lights)"ambient"===e.type&&null!=t.ambientLight&&(n=t.ambientLight),"directional"===e.type&&null!=t.directionalLight&&(i=t.directionalLight);a=this._prioritizeTerrain(a,t.terrain,t.stylesheet.terrain),t.stylesheet.fog&&null!=t.fog&&(r=t.fog),null!=t.stylesheet.camera&&(l=t.stylesheet.camera),null!=t.stylesheet.projection&&(o=t.stylesheet.projection),null!=t.stylesheet.transition&&(s=t.stylesheet.transition),c[t.scope]=t._styleColorTheme}})),this.light=e,this.ambientLight=n,this.directionalLight=i,this.fog=r,this._styleColorThemeForScope=c,null===a?delete this.terrain:this.terrain=a,this.camera=l||{"camera-projection":"perspective"},this.projection=o||{name:"mercator"},this.transition=t.W({},zr,s),this.mergeSources(),this.mergeLayers()}forEachFragmentStyle(t){const e=n=>{for(const t of n.fragments)e(t.style);t(n)};e(this)}_prioritizeTerrain(t,e,n){const i=t&&0===t.drapeRenderMode;return null===n?e&&0===e.drapeRenderMode?e:i?t:null:null!=e&&(!t||i||e&&1===e.drapeRenderMode)?e:t}mergeTerrain(){let t;this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle((e=>{t=this._prioritizeTerrain(t,e.terrain,e.stylesheet.terrain)})),null===t?delete this.terrain:this.terrain=t}mergeProjection(){let t;this.forEachFragmentStyle((e=>{null!=e.stylesheet.projection&&(t=e.stylesheet.projection)})),this.projection=t||{name:"mercator"}}mergeSources(){const e={},n={},i={};this.forEachFragmentStyle((a=>{for(const n in a._sourceCaches){const i=t.al(n,a.scope);e[i]=a._sourceCaches[n]}for(const e in a._otherSourceCaches){const i=t.al(e,a.scope);n[i]=a._otherSourceCaches[e]}for(const e in a._symbolSourceCaches){const n=t.al(e,a.scope);i[n]=a._symbolSourceCaches[e]}})),this._mergedSourceCaches=e,this._mergedOtherSourceCaches=n,this._mergedSymbolSourceCaches=i}mergeLayers(){const e={},n=[],i={};this._mergedSlots=[],this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this.forEachFragmentStyle((i=>{for(const a of i._order){const r=i._layers[a];if("slot"===r.type){const n=t.cU(a);if(e[n])continue;e[n]=[]}r.slot&&e[r.slot]?e[r.slot].push(r):n.push(r)}})),this._mergedOrder=[],this._clipLayerIndices=[];let a=0;const r=(n=[])=>{for(const o of n)if("slot"===o.type){const n=t.cU(o.id);e[n]&&r(e[n]),this._mergedSlots.push(n)}else{const e=t.al(o.id,o.scope);this._mergedOrder.push(e),i[e]=o,o.is3D()&&(this._has3DLayers=!0),"circle"===o.type&&(this._hasCircleLayers=!0),"symbol"===o.type&&(this._hasSymbolLayers=!0),"clip"===o.type&&this._clipLayerIndices.push(a),a++}};r(n),this._mergedLayers=i,this.updateDrapeFirstLayers(),this._buildingIndex.processLayersChanged()}terrainSetForDrapingOnly(){return!!this.terrain&&0===this.terrain.drapeRenderMode}getCamera(){return this.stylesheet.camera}setCamera(e){return this.stylesheet.camera=t.W({},this.stylesheet.camera,e),this.camera=this.stylesheet.camera,this}_evaluateColorThemeData(e){return e.data?function(e,n,i){const a=t.W({},n);for(const e of Object.keys(t.L.colorTheme))void 0===a[e]&&(a[e]=t.L.colorTheme[e].default);const r=new t.U(Sr,e,new Map(i));return r.setTransitionOrValue(a,i),r.untransitioned().possiblyEvaluate(new t.X(0))}(this.scope,e,this.options).get("data"):null}_loadColorTheme(e){return this._styleColorTheme.lutLoading=!0,new Promise(((n,i)=>{const a="data:image/png;base64,";if(0===e.length)return this._styleColorTheme.lut=null,this._styleColorTheme.lutLoading=!1,void n();e.startsWith(a)||(e=a+e);const r="mapbox-reserved-lut",o=new Image;o.src=e,o.onerror=()=>{this._styleColorTheme.lutLoading=!1,i(new Error("Failed to load image data"))},o.onload=()=>{this._styleColorTheme.lutLoading=!1;const{width:a,height:s,data:l}=t.e.getImageData(o);if(s>32)return void i(new Error("The height of the image must be less than or equal to 32 pixels."));if(a!==s*s)return void i(new Error("The width of the image must be equal to the height squared."));this.getImage(r)&&this.removeImage(r),this.addImage(r,{data:new t.i({width:a,height:s},l),pixelRatio:1,sdf:!1,version:0});const c=this.imageManager.getImage(r,this.scope);c?(this._styleColorTheme.lut={image:c.data,data:e},n()):i(new Error("Missing LUT image."))}}))}getLut(t){const e=this._styleColorThemeForScope[t];return e?e.lut:null}setProjection(t){t?this.stylesheet.projection=t:delete this.stylesheet.projection,this.mergeProjection(),this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?(this.getTerrain()||this.stylesheet.terrain)&&!this.disableElevatedTerrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null,0))}_updateMapProjection(){this.isRootStyle()&&(this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.projection))}_loadSprite(e){this._spriteRequest=function(e,n,i){let a,r,o;const s=t.e.devicePixelRatio>1?"@2x":"";let l=t.g(n.transformRequest(n.normalizeSpriteURL(e,s,".json"),t.R.SpriteJSON),((t,e)=>{l=null,o||(o=t,a=e,u())})),c=t.h(n.transformRequest(n.normalizeSpriteURL(e,s,".png"),t.R.SpriteImage),((t,e)=>{c=null,o||(o=t,r=e,u())}));function u(){if(o)i(o);else if(a&&r){const e=t.e.getImageData(r),n={};for(const i in a){const{width:r,height:o,x:s,y:l,sdf:c,pixelRatio:u,stretchX:h,stretchY:d,content:p}=a[i],f=new t.i({width:r,height:o});t.i.copy(e,f,{x:s,y:l},{x:0,y:0},{width:r,height:o},null),n[i]={data:f,pixelRatio:u,sdf:c,stretchX:h,stretchY:d,content:p}}i(null,n)}}return{cancel(){l&&(l.cancel(),l=null),c&&(c.cancel(),c=null)}}}(e,this.map._requestManager,((e,n)=>{if(this._spriteRequest=null,e)this.fire(new t.d(e));else if(n)for(const t in n)this.imageManager.addImage(t,this.scope,n[t]);this.imageManager.setLoaded(!0,this.scope),this._availableImages=this.imageManager.listImages(this.scope),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new t.f("data",{dataType:"style"}))}))}_validateLayer(e){const n=this.getOwnSource(e.source);if(!n)return;const i=e.sourceLayer;i&&("geojson"===n.type||n.vectorLayerIds&&-1===n.vectorLayerIds.indexOf(i))&&this.fire(new t.d(new Error(`Source layer "${i}" does not exist on source "${n.id}" as specified by style layer "${e.id}"`)))}loaded(){if(!this._loaded)return!1;if(Object.keys(this._changes.getUpdatedSourceCaches()).length)return!1;for(const t in this._sourceCaches)if(!this._sourceCaches[t].loaded())return!1;if(!this.imageManager.isLoaded())return!1;if(!this.modelManager.isLoaded())return!1;if(this._styleColorTheme.lutLoading)return!1;for(const{style:t}of this.fragments)if(!t.loaded())return!1;return!0}_serializeImports(){if(this.stylesheet.imports)return this.stylesheet.imports.map(((t,e)=>{const n=this.fragments[e];return n&&n.style&&(t.data=n.style.serialize()),t}))}_serializeSources(){const t={};for(const e in this._sourceCaches){const n=this._sourceCaches[e].getSource();t[n.id]||(t[n.id]=n.serialize())}return t}_serializeLayers(t){const e=[];for(const n of t){const t=this._layers[n];t&&"custom"!==t.type&&e.push(t.serialize())}return e}hasLightTransitions(){return!(!this.light||!this.light.hasTransition())||!(!this.ambientLight||!this.ambientLight.hasTransition())||!(!this.directionalLight||!this.directionalLight.hasTransition())}hasFogTransition(){return!!this.fog&&this.fog.hasTransition()}hasTransitions(){if(this.hasLightTransitions())return!0;if(this.hasFogTransition())return!0;for(const t in this._sourceCaches)if(this._sourceCaches[t].hasTransition())return!0;for(const t in this._layers)if(this._layers[t].hasTransition())return!0;return!1}get order(){return this.terrain?this._drapedFirstOrder:this._mergedOrder}isLayerDraped(t){return!!this.terrain&&t.isDraped(this.getLayerSourceCache(t))}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}_checkLayer(e){const n=this.getOwnLayer(e);if(n)return n;this.fire(new t.d(new Error(`The layer '${e}' does not exist in the map's style.`)))}_checkSource(e){const n=this.getOwnSource(e);if(n)return n;this.fire(new t.d(new Error(`The source '${e}' does not exist in the map's style.`)))}update(e){if(!this._loaded)return;this.ambientLight&&this.ambientLight.recalculate(e),this.directionalLight&&this.directionalLight.recalculate(e);const n=this.calculateLightsBrightness();e.brightness=n||0,n!==this._brightness&&(this._brightness=n,this.dispatcher.broadcast("setBrightness",n));const i=this._changes.isDirty();let a=!1;if(this._changes.isDirty()){const t=this._changes.getLayerUpdatesByScope();for(const e in t){const{updatedIds:n,removedIds:i}=t[e];(n||i)&&(this._updateWorkerLayers(e,n,i),a=!0)}this.updateSourceCaches(),this._updateTilesForChangedImages(),this.updateLayers(e),this.light&&this.light.updateTransitions(e),this.ambientLight&&this.ambientLight.updateTransitions(e),this.directionalLight&&this.directionalLight.updateTransitions(e),this.fog&&this.fog.updateTransitions(e),this._changes.reset()}const r={};for(const t in this._mergedSourceCaches){const e=this._mergedSourceCaches[t];r[t]=e.used,e.used=!1,e.tileCoverLift=0}for(const t of this._mergedOrder){const n=this._mergedLayers[t];if(n.recalculate(e,this._availableImages),!n.isHidden(e.zoom)){const t=this.getLayerSourceCache(n);t&&(t.used=!0,t.tileCoverLift=Math.max(t.tileCoverLift,n.tileCoverLift()))}if(!this._precompileDone&&this._shouldPrecompile)for(let t=n.minzoom||0;t<(n.maxzoom||25.5);t++){const t=this.map.painter;if(t){const i=n.getProgramIds();if(!i)continue;for(const a of i){const i=n.getDefaultProgramParams(a,e.zoom,this._styleColorTheme.lut);i&&(t.style=this,this.fog&&(t._fogVisible=!0,i.overrideFog=!0,t.getOrCreateProgram(a,i)),t._fogVisible=!1,i.overrideFog=!1,t.getOrCreateProgram(a,i),(this.stylesheet.terrain||this.stylesheet.projection&&"globe"===this.stylesheet.projection.name)&&(i.overrideRtt=!0,t.getOrCreateProgram(a,i)))}}}}this._shouldPrecompile&&(this._precompileDone=!0),this.terrain&&a&&this.mergeLayers();for(const e in r){const n=this._mergedSourceCaches[e];r[e]!==n.used&&n.getSource().fire(new t.f("data",{sourceDataType:"visibility",dataType:"source",sourceId:n.getSource().id}))}this.light&&this.light.recalculate(e),this.terrain&&this.terrain.recalculate(e),this.fog&&this.fog.recalculate(e),this.z=e.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),i&&this.fire(new t.f("data",{dataType:"style"}))}_updateTilesForChangedImages(){const t=this._changes.getUpdatedImages();if(t.length){for(const e in this._sourceCaches)this._sourceCaches[e].reloadTilesForDependencies(["icons","patterns"],t);this._changes.resetUpdatedImages()}}_updateWorkerLayers(t,e,n){const i=this.getFragmentStyle(t);i&&this.dispatcher.broadcast("updateLayers",{layers:e?i._serializeLayers(e):[],scope:t,removedIds:n||[],options:i.options})}setState(n,i){if(this._checkLoaded(),Mr(this,Rt(n)))return!1;(n=t.cT(n)).layers=Ua(n.layers);const a=function(t,n){if(!t)return[{command:Ga.setStyle,args:[n]}];let i=[];try{if(!e(t.version,n.version))return[{command:Ga.setStyle,args:[n]}];if(e(t.center,n.center)||i.push({command:Ga.setCenter,args:[n.center]}),e(t.zoom,n.zoom)||i.push({command:Ga.setZoom,args:[n.zoom]}),e(t.bearing,n.bearing)||i.push({command:Ga.setBearing,args:[n.bearing]}),e(t.pitch,n.pitch)||i.push({command:Ga.setPitch,args:[n.pitch]}),e(t.sprite,n.sprite)||i.push({command:Ga.setSprite,args:[n.sprite]}),e(t.glyphs,n.glyphs)||i.push({command:Ga.setGlyphs,args:[n.glyphs]}),e(t.imports,n.imports)||function(t=[],n=[],i){n=n||[];const a=(t=t||[]).map(Ya),r=n.map(Ya),o=t.reduce(Xa,{}),s=n.reduce(Xa,{}),l=a.slice();let c,u,h,d;for(c=0,u=0;c<a.length;c++)h=a[c],s.hasOwnProperty(h)?u++:(i.push({command:Ga.removeImport,args:[h]}),l.splice(l.indexOf(h,u),1));for(c=0,u=0;c<r.length;c++)h=r[r.length-1-c],l[l.length-1-c]!==h&&(o.hasOwnProperty(h)?(i.push({command:Ga.removeImport,args:[h]}),l.splice(l.lastIndexOf(h,l.length-u),1)):u++,d=l[l.length-c],i.push({command:Ga.addImport,args:[s[h],d]}),l.splice(l.length-c,0,h));for(const t of n){const n=o[t.id];n&&!e(n,t)&&i.push({command:Ga.updateImport,args:[t.id,t]})}}(t.imports,n.imports,i),e(t.transition,n.transition)||i.push({command:Ga.setTransition,args:[n.transition]}),e(t.light,n.light)||i.push({command:Ga.setLight,args:[n.light]}),e(t.fog,n.fog)||i.push({command:Ga.setFog,args:[n.fog]}),e(t.projection,n.projection)||i.push({command:Ga.setProjection,args:[n.projection]}),e(t.lights,n.lights)||i.push({command:Ga.setLights,args:[n.lights]}),e(t.camera,n.camera)||i.push({command:Ga.setCamera,args:[n.camera]}),!e(t["color-theme"],n["color-theme"]))return[{command:Ga.setStyle,args:[n]}];const a={},r=[];!function(t,n,i,a){let r;for(r in n=n||{},t=t||{})t.hasOwnProperty(r)&&(n.hasOwnProperty(r)||$a(r,i,a));for(r in n){if(!n.hasOwnProperty(r))continue;const o=n[r];t.hasOwnProperty(r)?e(t[r],o)||("geojson"===t[r].type&&"geojson"===o.type&&Ha(t,n,r)?i.push({command:Ga.setGeoJSONSourceData,args:[r,o.data]}):Wa(r,n,i,a)):qa(r,n,i)}}(t.sources,n.sources,r,a);const o=[];t.layers&&t.layers.forEach((t=>{t.source&&a[t.source]?i.push({command:Ga.removeLayer,args:[t.id]}):o.push(t)}));let s=t.terrain;s&&a[s.source]&&(i.push({command:Ga.setTerrain,args:[void 0]}),s=void 0),i=i.concat(r),e(s,n.terrain)||i.push({command:Ga.setTerrain,args:[n.terrain]}),function(t,n,i){n=n||[];const a=(t=t||[]).map(Ya),r=n.map(Ya),o=t.reduce(Xa,{}),s=n.reduce(Xa,{}),l=a.slice(),c=Object.create(null);let u,h,d,p,f,m,g;for(u=0,h=0;u<a.length;u++)d=a[u],s.hasOwnProperty(d)?h++:(i.push({command:Ga.removeLayer,args:[d]}),l.splice(l.indexOf(d,h),1));for(u=0,h=0;u<r.length;u++)d=r[r.length-1-u],l[l.length-1-u]!==d&&(o.hasOwnProperty(d)?(i.push({command:Ga.removeLayer,args:[d]}),l.splice(l.lastIndexOf(d,l.length-h),1)):h++,m=l[l.length-u],i.push({command:Ga.addLayer,args:[s[d],m]}),l.splice(l.length-u,0,d),c[d]=!0);for(u=0;u<r.length;u++)if(d=r[u],p=o[d],f=s[d],!c[d]&&!e(p,f))if(e(p.source,f.source)&&e(p["source-layer"],f["source-layer"])&&e(p.type,f.type)){for(g in Za(p.layout,f.layout,i,d,null,Ga.setLayoutProperty),Za(p.paint,f.paint,i,d,null,Ga.setPaintProperty),e(p.slot,f.slot)||i.push({command:Ga.setSlot,args:[d,f.slot]}),e(p.filter,f.filter)||i.push({command:Ga.setFilter,args:[d,f.filter]}),e(p.minzoom,f.minzoom)&&e(p.maxzoom,f.maxzoom)||i.push({command:Ga.setLayerZoomRange,args:[d,f.minzoom,f.maxzoom]}),p)p.hasOwnProperty(g)&&"layout"!==g&&"paint"!==g&&"filter"!==g&&"metadata"!==g&&"minzoom"!==g&&"maxzoom"!==g&&"slot"!==g&&(0===g.indexOf("paint.")?Za(p[g],f[g],i,d,g.slice(6),Ga.setPaintProperty):e(p[g],f[g])||i.push({command:Ga.setLayerProperty,args:[d,g,f[g]]}));for(g in f)f.hasOwnProperty(g)&&!p.hasOwnProperty(g)&&"layout"!==g&&"paint"!==g&&"filter"!==g&&"metadata"!==g&&"minzoom"!==g&&"maxzoom"!==g&&"slot"!==g&&(0===g.indexOf("paint.")?Za(p[g],f[g],i,d,g.slice(6),Ga.setPaintProperty):e(p[g],f[g])||i.push({command:Ga.setLayerProperty,args:[d,g,f[g]]}))}else i.push({command:Ga.removeLayer,args:[d]}),m=l[l.lastIndexOf(d)+1],i.push({command:Ga.addLayer,args:[f,m]})}(o,n.layers,i)}catch(t){console.warn("Unable to compute style diff:",t),i=[{command:Ga.setStyle,args:[n]}]}return i}(this.serialize(),n).filter((t=>!(t.command in Ir)));if(0===a.length)return!1;const r=a.filter((t=>!(t.command in kr)));if(r.length>0)throw new Error(`Unimplemented: ${r.map((t=>t.command)).join(", ")}.`);const o=[];return a.forEach((t=>{o.push(this[t.command].apply(this,t.args))})),i&&Promise.all(o).then(i),this.stylesheet=n,this.mergeAll(),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),!0}addImage(e,n){return this.getImage(e)?this.fire(new t.d(new Error("An image with this name already exists."))):(this.imageManager.addImage(e,this.scope,n),this._afterImageUpdated(e),this)}updateImage(t,e){this.imageManager.updateImage(t,this.scope,e)}getImage(t){return this.imageManager.getImage(t,this.scope)}removeImage(e){return this.getImage(e)?(this.imageManager.removeImage(e,this.scope),this._afterImageUpdated(e),this):this.fire(new t.d(new Error("No image with this name exists.")))}_afterImageUpdated(e){this._availableImages=this.imageManager.listImages(this.scope),this._changes.updateImage(e),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.fire(new t.f("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addModel(t,e,n={}){return this._checkLoaded(),this._validate(Ht,`models.${t}`,e,null,n)||(this.modelManager.addModel(t,e,this.scope),this._changes.setDirty()),this}hasModel(t){return this.modelManager.hasModel(t,this.scope)}removeModel(e){return this.hasModel(e)?(this.modelManager.removeModel(e,this.scope),this):this.fire(new t.d(new Error("No model with this ID exists.")))}listModels(){return this._checkLoaded(),this.modelManager.listModels(this.scope)}addSource(e,n,i={}){if(this._checkLoaded(),void 0!==this.getOwnSource(e))throw new Error(`There is already a source with ID "${e}".`);if(!n.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(n).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(n.type)>=0&&this._validate(Ft,`sources.${e}`,n,null,i))return;this.map&&this.map._collectResourceTiming&&(n.collectResourceTiming=!0);const a=Bn(e,n,this.dispatcher,this);a.scope=this.scope,a.setEventedParent(this,(()=>({isSourceLoaded:this._isSourceCacheLoaded(a.id),source:a.serialize(),sourceId:a.id})));const r=e=>{const n=(e?"symbol:":"other:")+a.id,i=t.al(n,this.scope),r=this._sourceCaches[n]=new t.bv(i,a,e);(e?this._symbolSourceCaches:this._otherSourceCaches)[a.id]=r,r.onAdd(this.map)};r(!1),"vector"!==n.type&&"geojson"!==n.type||r(!0),a.onAdd&&a.onAdd(this.map),i.isInitialLoad||(this.mergeSources(),this._changes.setDirty())}removeSource(e){this._checkLoaded();const n=this.getOwnSource(e);if(!n)throw new Error("There is no source with this ID");for(const n in this._layers)if(this._layers[n].source===e)return this.fire(new t.d(new Error(`Source "${e}" cannot be removed while layer "${n}" is using it.`)));if(this.terrain&&this.terrain.scope===this.scope&&this.terrain.get().source===e)return this.fire(new t.d(new Error(`Source "${e}" cannot be removed while terrain is using it.`)));const i=this.getOwnSourceCaches(e);for(const e of i){const n=t.cU(e.id);delete this._sourceCaches[n],this._changes.discardSourceCacheUpdate(e.id),e.fire(new t.f("data",{sourceDataType:"metadata",dataType:"source",sourceId:e.getSource().id})),e.setEventedParent(null),e.clearTiles()}return delete this._otherSourceCaches[e],delete this._symbolSourceCaches[e],this.mergeSources(),n.setEventedParent(null),n.onRemove&&n.onRemove(this.map),this._changes.setDirty(),this}setGeoJSONSourceData(t,e){this._checkLoaded(),this.getOwnSource(t).setData(e),this._changes.setDirty()}getOwnSource(t){const e=this.getOwnSourceCache(t);return e&&e.getSource()}getOwnSources(){const t=[];for(const e in this._otherSourceCaches){const n=this.getOwnSourceCache(e);n&&t.push(n.getSource())}return t}areTilesLoaded(){const t=this._mergedSourceCaches;for(const e in t){const n=t[e]._tiles;for(const t in n){const e=n[t];if("loaded"!==e.state&&"errored"!==e.state)return!1}}return!0}setLights(e){if(this._checkLoaded(),!e)return delete this.ambientLight,void delete this.directionalLight;const n=this._getTransitionParameters();for(const t of e){if(this._validate(jt,"lights",t))return;switch(t.type){case"ambient":if(this.ambientLight){const e=this.ambientLight;e.set(t),e.updateTransitions(n)}else this.ambientLight=new ce(t,ue,this.scope,this.options);break;case"directional":if(this.directionalLight){const e=this.directionalLight;e.set(t),e.updateTransitions(n)}else this.directionalLight=new ce(t,he,this.scope,this.options)}}const i=new t.X(this.z||0,n);this.ambientLight&&this.ambientLight.recalculate(i),this.directionalLight&&this.directionalLight.recalculate(i),this._brightness=this.calculateLightsBrightness(),this.dispatcher.broadcast("setBrightness",this._brightness)}calculateLightsBrightness(){const e=this.directionalLight,n=this.ambientLight;if(!e||!n)return;const i=t=>.2126*(t[0]<=.03928?t[0]/12.92:Math.pow((t[0]+.055)/1.055,2.4))+.7152*(t[1]<=.03928?t[1]/12.92:Math.pow((t[1]+.055)/1.055,2.4))+.0722*(t[2]<=.03928?t[2]/12.92:Math.pow((t[2]+.055)/1.055,2.4)),a=e.properties.get("color").toRenderColor(null).toArray01(),r=e.properties.get("intensity"),o=e.properties.get("direction"),s=1-t.ac(o.x,o.y,o.z)[2]/90,l=i(a)*r*s,c=n.properties.get("color").toRenderColor(null).toArray01(),u=n.properties.get("intensity");return(l+i(c)*u)/2}getBrightness(){return this._brightness}getLights(){if(!this.enable3dLights())return null;const t=[];return this.directionalLight&&t.push(this.directionalLight.get()),this.ambientLight&&t.push(this.ambientLight.get()),t}enable3dLights(){return!!this.ambientLight&&!!this.directionalLight}getFragmentStyle(e){if(!e)return this;if(t.cV(e)){const n=t.cW(e),i=this.fragments.find((({id:t})=>t===n));if(!i)throw new Error(`Style import not found: ${e}`);const a=t.cU(e);return i.style.getFragmentStyle(a)}{const t=this.fragments.find((({id:t})=>t===e));if(!t)throw new Error(`Style import not found: ${e}`);return t.style}}getConfigProperty(e,n){const i=this.getFragmentStyle(e);if(!i)return null;const a=t.al(n,i.scope),r=i.options.get(a),o=r?r.value||r.default:null;return o?o.serialize():null}setConfigProperty(e,n,i){const a=this.getFragmentStyle(e);if(!a)return;const r=a.stylesheet.schema;if(!r||!r[n])return;const o=t.y(i);if("success"!==o.result)return void Mr(this,o.value);const s=o.value.expression,l=t.al(n,a.scope),c=a.options.get(l);if(!c)return;let u;const{minValue:h,maxValue:d,stepValue:p,type:f,values:m}=r[n],g=t.y(r[n].default);"success"===g.result&&(u=g.value.expression),u?(this.options.set(l,{...c,value:s,default:u,minValue:h,maxValue:d,stepValue:p,type:f,values:m}),this.updateConfigDependencies()):this.fire(new t.d(new Error(`No schema defined for the config option "${n}" in the "${e}" fragment.`)))}getConfig(e){const n=this.getFragmentStyle(e);if(!n)return null;const i=n.stylesheet.schema;if(!i)return null;const a={};for(const e in i){const i=t.al(e,n.scope),r=n.options.get(i),o=r?r.value||r.default:null;a[e]=o?o.serialize():null}return a}setConfig(t,e){const n=this.getFragmentStyle(t);n&&(n.updateConfig(e,n.stylesheet.schema),this.updateConfigDependencies())}getSchema(t){const e=this.getFragmentStyle(t);return e?e.stylesheet.schema:null}setSchema(t,e){const n=this.getFragmentStyle(t);n&&(n.stylesheet.schema=e,n.updateConfig(n._config,e),this.updateConfigDependencies())}updateConfig(e,n){if(this._config=e,e||n)if(n)for(const i in n){let a,r;const o=t.y(n[i].default);if("success"===o.result&&(a=o.value.expression),e&&void 0!==e[i]){const n=t.y(e[i]);"success"===n.result&&(r=n.value.expression)}const{minValue:s,maxValue:l,stepValue:c,type:u,values:h}=n[i];if(a){const e=t.al(i,this.scope);this.options.set(e,{default:a,value:r,minValue:s,maxValue:l,stepValue:c,type:u,values:h})}else this.fire(new t.d(new Error(`No schema defined for config option "${i}".`)))}else this.fire(new t.d(new Error("Attempting to set config for a style without schema.")))}updateConfigDependencies(){for(const t of this._configDependentLayers){const e=this.getLayer(t);e&&(e.possiblyEvaluateVisibility(),this._updateLayer(e))}this.ambientLight&&this.ambientLight.updateConfig(this.options),this.directionalLight&&this.directionalLight.updateConfig(this.options),this.fog&&this.fog.updateConfig(this.options),this.forEachFragmentStyle((t=>{if(t._styleColorTheme.colorTheme){const e=t._evaluateColorThemeData(t._styleColorTheme.colorTheme);(!t._styleColorTheme.lut||t._styleColorTheme.lut&&e!==t._styleColorTheme.lut.data)&&t.setColorTheme(t._styleColorTheme.colorTheme)}})),this._changes.setDirty()}addLayer(e,n,i={}){this._checkLoaded();const a=e.id;if(this._layers[a])return void this.fire(new t.d(new Error(`Layer with id "${a}" already exists on this map`)));let r;if("custom"===e.type){if(Mr(this,t.cX(e)))return;r=t.cY(e,this.scope,this._styleColorTheme.lut,this.options)}else{if("object"==typeof e.source&&(this.addSource(a,e.source),e=t.cT(e),e=t.W(e,{source:a})),this._validate(Gt,`layers.${a}`,e,{arrayIndex:-1},i))return;r=t.cY(e,this.scope,this._styleColorTheme.lut,this.options),this._validateLayer(r),r.setEventedParent(this,{layer:{id:a}}),this._serializedLayers[r.id]=r.serialize()}r.isConfigDependent&&this._configDependentLayers.add(r.fqid);let o=this._order.length;if(n){const e=this._order.indexOf(n);if(-1===e)return void this.fire(new t.d(new Error(`Layer with id "${n}" does not exist on this map.`)));r.slot===this._layers[n].slot?o=e:t.w(`Layer with id "${n}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(o,0,a),this._layerOrderChanged=!0,this._layers[a]=r;const s=this.getOwnLayerSourceCache(r),l=!!this.directionalLight&&this.directionalLight.shadowsEnabled();s&&r.canCastShadows()&&l&&(s.castsShadows=!0);const c=this._changes.getRemovedLayer(r);if(c&&r.source&&s&&"custom"!==r.type){this._changes.discardLayerRemoval(r);const e=t.al(r.source,r.scope);c.type!==r.type?this._changes.updateSourceCache(e,"clear"):(this._changes.updateSourceCache(e,"reload"),s.pause())}this._updateLayer(r),r.onAdd&&r.onAdd(this.map),r.scope=this.scope,this.mergeLayers()}moveLayer(e,n){this._checkLoaded();const i=this._checkLayer(e);if(!i)return;if(e===n)return;const a=this._order.indexOf(e);this._order.splice(a,1);let r=this._order.length;if(n){const e=this._order.indexOf(n);if(-1===e)return void this.fire(new t.d(new Error(`Layer with id "${n}" does not exist on this map.`)));i.slot===this._layers[n].slot?r=e:t.w(`Layer with id "${n}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(r,0,e),this._changes.setDirty(),this._layerOrderChanged=!0,this.mergeLayers()}removeLayer(t){this._checkLoaded();const e=this._checkLayer(t);if(!e)return;e.setEventedParent(null);const n=this._order.indexOf(t);this._order.splice(n,1),delete this._layers[t],delete this._serializedLayers[t],this._changes.setDirty(),this._layerOrderChanged=!0,this._configDependentLayers.delete(e.fqid),this._changes.removeLayer(e);const i=this.getOwnLayerSourceCache(e);if(i&&i.castsShadows){let t=!1;for(const n in this._layers)if(this._layers[n].source===e.source&&this._layers[n].canCastShadows()){t=!0;break}i.castsShadows=t}e.onRemove&&e.onRemove(this.map),this.mergeLayers()}getOwnLayer(t){return this._layers[t]}hasLayer(t){return t in this._mergedLayers}hasLayerType(t){for(const e in this._layers)if(this._layers[e].type===t)return!0;return!1}setLayerZoomRange(t,e,n){this._checkLoaded();const i=this._checkLayer(t);i&&(i.minzoom===e&&i.maxzoom===n||(null!=e&&(i.minzoom=e),null!=n&&(i.maxzoom=n),this._updateLayer(i)))}getSlots(){return this._checkLoaded(),this._mergedSlots}setSlot(t,e){this._checkLoaded();const n=this._checkLayer(t);n&&n.slot!==e&&(n.slot=e,this._updateLayer(n))}setFilter(n,i,a={}){this._checkLoaded();const r=this._checkLayer(n);if(r&&!e(r.filter,i))return null==i?(r.filter=void 0,void this._updateLayer(r)):void(this._validate(qt,`layers.${r.id}.filter`,i,{layerType:r.type},a)||(r.filter=t.cT(i),this._updateLayer(r)))}getFilter(e){const n=this._checkLayer(e);if(n)return t.cT(n.filter)}setLayoutProperty(n,i,a,r={}){this._checkLoaded();const o=this._checkLayer(n);if(o&&!e(o.getLayoutProperty(i),a)){if(null!=a&&(!r||!1!==r.validate)&&Mr(o,Wt.call(Rt,{key:`layers.${n}.layout.${i}`,layerType:o.type,objectKey:i,value:a,styleSpec:t.L,style:{glyphs:!0,sprite:!0}})))return;o.setLayoutProperty(i,a),o.isConfigDependent&&this._configDependentLayers.add(o.fqid),this._updateLayer(o)}}getLayoutProperty(t,e){const n=this._checkLayer(t);if(n)return n.getLayoutProperty(e)}setPaintProperty(n,i,a,r={}){this._checkLoaded();const o=this._checkLayer(n);if(!o)return;if(e(o.getPaintProperty(i),a))return;if(null!=a&&(!r||!1!==r.validate)&&Mr(o,$t.call(Rt,{key:`layers.${n}.paint.${i}`,layerType:o.type,objectKey:i,value:a,styleSpec:t.L})))return;const s=o.setPaintProperty(i,a);o.isConfigDependent&&this._configDependentLayers.add(o.fqid),s&&this._updateLayer(o),this._changes.updatePaintProperties(o)}getPaintProperty(t,e){const n=this._checkLayer(t);if(n)return n.getPaintProperty(e)}setFeatureState(e,n){this._checkLoaded();const i=e.source,a=e.sourceLayer,r=this._checkSource(i);if(!r)return;const o=r.type;if("geojson"===o&&a)return void this.fire(new t.d(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if("vector"===o&&!a)return void this.fire(new t.d(new Error("The sourceLayer parameter must be provided for vector source types.")));void 0===e.id&&this.fire(new t.d(new Error("The feature id parameter must be provided.")));const s=this.getOwnSourceCaches(i);for(const t of s)t.setFeatureState(a,e.id,n)}removeFeatureState(e,n){this._checkLoaded();const i=e.source,a=this._checkSource(i);if(!a)return;const r=a.type,o="vector"===r?e.sourceLayer:void 0;if("vector"===r&&!o)return void this.fire(new t.d(new Error("The sourceLayer parameter must be provided for vector source types.")));if(n&&"string"!=typeof e.id&&"number"!=typeof e.id)return void this.fire(new t.d(new Error("A feature id is required to remove its specific state property.")));const s=this.getOwnSourceCaches(i);for(const t of s)t.removeFeatureState(o,e.id,n)}getFeatureState(e){this._checkLoaded();const n=e.source,i=e.sourceLayer,a=this._checkSource(n);if(a){if("vector"!==a.type||i)return void 0===e.id&&this.fire(new t.d(new Error("The feature id parameter must be provided."))),this.getOwnSourceCaches(n)[0].getFeatureState(i,e.id);this.fire(new t.d(new Error("The sourceLayer parameter must be provided for vector source types.")))}}setTransition(e){return this.stylesheet.transition=t.W({},this.stylesheet.transition,e),this.transition=this.stylesheet.transition,this}getTransition(){return t.W({},this.stylesheet.transition)}serialize(){this._checkLoaded();const e=this.getTerrain(),n=e&&this.terrain&&this.terrain.scope===this.scope?e:this.stylesheet.terrain;return t.cZ({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,fragment:this.stylesheet.fragment,imports:this._serializeImports(),schema:this.stylesheet.schema,camera:this.stylesheet.camera,light:this.stylesheet.light,lights:this.stylesheet.lights,terrain:n,fog:this.stylesheet.fog,center:this.stylesheet.center,"color-theme":this.stylesheet["color-theme"],zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:this._serializeSources(),layers:this._serializeLayers(this._order)},(t=>void 0!==t))}_updateLayer(e){this._changes.updateLayer(e);const n=this.getLayerSourceCache(e),i=t.al(e.source,e.scope),a=this._changes.getUpdatedSourceCaches();e.source&&!a[i]&&n&&"raster"!==n.getSource().type&&(this._changes.updateSourceCache(i,"reload"),n.pause()),e.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(t){const e=t=>"fill-extrusion"===this._mergedLayers[t].type||"model"===this._mergedLayers[t].type,n=this.order,i={},a=[];for(let r=n.length-1;r>=0;r--){const o=n[r];if(e(o)){i[o]=r;for(const e of t){const t=e[o];if(t)for(const e of t)a.push(e)}}}a.sort(((t,e)=>e.intersectionZ-t.intersectionZ));const r=[];for(let o=n.length-1;o>=0;o--){const s=n[o];if(e(s))for(let t=a.length-1;t>=0;t--){const e=a[t].feature;if(e.layer&&i[e.layer.id]<o)break;r.push(e),a.pop()}else for(const e of t){const t=e[s];if(t)for(const e of t)r.push(e.feature)}}return r}queryRenderedFeatures(e,n,i){n&&n.filter&&this._validate(qt,"queryRenderedFeatures.filter",n.filter,null,n),n.scope=this.scope,n.availableImages=this._availableImages,n.serializedLayers=this._serializedLayers;const a={};if(n&&n.layers){if(!Array.isArray(n.layers))return this.fire(new t.d(new Error("parameters.layers must be an Array."))),[];for(const e of n.layers){const n=this._mergedLayers[e];if(!n)return this.fire(new t.d(new Error(`The layer '${e}' does not exist in the map's style and cannot be queried for features.`))),[];a[n.source]=!0}}const r=[],o=n.serializedLayers||{},s=n&&n.layers?n.layers.some((t=>{const e=this.getLayer(t);return e&&e.is3D()})):this.has3DLayers(),l=za.createFromScreenPoints(e,i);for(const t in this._mergedSourceCaches){const e=this._mergedSourceCaches[t].getSource();if(!e||e.scope!==n.scope)continue;const c=this._mergedSourceCaches[t].getSource().id;n.layers&&!a[c]||r.push(Ra(this._mergedSourceCaches[t],this._mergedLayers,o,l,n,i,s,!!this.map._showQueryGeometry))}return this.placement&&r.push(function(t,e,n,i,a,r,o){const s={},l=r.queryRenderedSymbols(i),c=[];for(const t of Object.keys(l).map(Number))c.push(o[t]);c.sort(Na);for(const n of c){const i=n.featureIndex.lookupSymbolFeatures(l[n.bucketInstanceId],e,n.bucketIndex,n.sourceLayerIndex,a.filter,a.layers,a.availableImages,t);for(const t in i){const e=s[t]=s[t]||[],a=i[t];a.sort(((t,e)=>{const i=n.featureSortOrder;if(i){const n=i.indexOf(t.featureIndex);return i.indexOf(e.featureIndex)-n}return e.featureIndex-t.featureIndex}));for(const t of a)e.push(t)}}for(const e in s)s[e].forEach((i=>{const a=i.feature,r=n(t[e]);if(!r)return;const o=r.getFeatureState(a.layer["source-layer"],a.id);a.source=a.layer.source,a.layer["source-layer"]&&(a.sourceLayer=a.layer["source-layer"]),a.state=o}));return s}(this._mergedLayers,o,this.getLayerSourceCache.bind(this),l.screenGeometry,n,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(r)}querySourceFeatures(t,e){e&&e.filter&&this._validate(qt,"querySourceFeatures.filter",e.filter,null,e);const n=this.getOwnSourceCaches(t);let i=[];for(const t of n)i=i.concat(Fa(t,e));return i}addSourceType(t,e,n){return Dr.getSourceType(t)?n(new Error(`A source type called "${t}" already exists.`)):(Dr.setSourceType(t,e),e.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:t,url:e.workerSourceURL},n):n(null,null))}getFlatLight(){return this.light.getLight()}setFlatLight(t,n,i={}){this._checkLoaded();const a=this.light.getLight();let r=!1;for(const n in t)if(!e(t[n],a[n])){r=!0;break}if(!r)return;const o=this._getTransitionParameters();this.light.setLight(t,n,i),this.light.updateTransitions(o)}getTerrain(){return this.terrain&&1===this.terrain.drapeRenderMode?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}checkCanvasFingerprintNoise(){void 0===this.disableElevatedTerrain&&(this.disableElevatedTerrain=t.e.hasCanvasFingerprintNoise(),this.disableElevatedTerrain&&t.w("Terrain and hillshade are disabled because of Canvas2D limitations when fingerprinting protection is enabled (e.g. in private browsing mode)."))}setTerrain(n,i=1){if(this._checkLoaded(),!n)return this.terrainSetForDrapingOnly()&&0!==i||delete this.terrain,null===n?this.stylesheet.terrain=null:delete this.stylesheet.terrain,this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);this.checkCanvasFingerprintNoise();let a=n;const r=null==n.source;if(1===i){if(this.disableElevatedTerrain)return;if("object"==typeof a.source){const e="terrain-dem-src";this.addSource(e,a.source),a=t.cT(a),a=t.W(a,{source:e})}const e=t.W({},a),n={};if(this.terrain&&r){e.source=this.terrain.get().source;const t=this.terrain?this.getFragmentStyle(this.terrain.scope):null;t&&(n.style=t.serialize())}if(this._validate(Vt,"terrain",e,n))return}if(!this.terrain||this.terrain.scope!==this.scope&&!r||this.terrain&&i!==this.terrain.drapeRenderMode){if(!a)return;this._createTerrain(a,i),this.fire(new t.f("data",{dataType:"style"}))}else{const i=this.terrain,r=i.get();for(const e of Object.keys(t.L.terrain))!a.hasOwnProperty(e)&&t.L.terrain[e].default&&(a[e]=t.L.terrain[e].default);for(const a in n)if(!e(n[a],r[a])){i.set(n,this.options),this.stylesheet.terrain=n;const e=this._getTransitionParameters({duration:0});i.updateTransitions(e),this.fire(new t.f("data",{dataType:"style"}));break}}this.mergeTerrain(),this.updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(t){const e=this.fog=new le(t,this.map.transform,this.scope,this.options);this.stylesheet.fog=e.get();const n=this._getTransitionParameters({duration:0});e.updateTransitions(n)}_updateMarkersOpacity(){0!==this.map._markers.length&&this.map._requestDomTask((()=>{for(const t of this.map._markers)t._evaluateOpacity()}))}getFog(){return this.fog?this.fog.get():null}setFog(t){if(this._checkLoaded(),!t)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const n=this.fog;if(!e(n.get(),t)){n.set(t,this.options),this.stylesheet.fog=n.get();const e=this._getTransitionParameters({duration:0});n.updateTransitions(e)}}else this._createFog(t);this._markersNeedUpdate=!0}setColorTheme(e){this._checkLoaded();const n=()=>{for(const t in this._layers)this._layers[t].lut=this._styleColorTheme.lut;for(const t in this._sourceCaches)this._sourceCaches[t].clearTiles()};if(this._styleColorTheme.colorTheme=e,!e)return this._styleColorTheme.lut=null,void n();const i=this._evaluateColorThemeData(e);this._loadColorTheme(i).then((()=>{n()})).catch((e=>{t.w(`Couldn't set color theme: ${e}`)}))}_getTransitionParameters(e){return{now:t.e.now(),transition:t.W(this.transition,e)}}updateDrapeFirstLayers(){if(!this.terrain)return;const t=[],e=[];for(const n in this._mergedLayers)this.isLayerDraped(this._mergedLayers[n])?t.push(n):e.push(n);this._drapedFirstOrder=[],this._drapedFirstOrder.push(...t),this._drapedFirstOrder.push(...e)}_createTerrain(t,e){const n=this.terrain=new Jt(t,e,this.scope,this.options);1===e&&(this.stylesheet.terrain=t),this.mergeTerrain(),this.updateDrapeFirstLayers(),this._force3DLayerUpdate();const i=this._getTransitionParameters({duration:0});n.updateTransitions(i)}_force3DLayerUpdate(){for(const t in this._layers){const e=this._layers[t];"fill-extrusion"===e.type&&this._updateLayer(e)}}_forceSymbolLayerUpdate(){for(const t in this._layers){const e=this._layers[t];"symbol"===e.type&&this._updateLayer(e)}}_validate(e,n,i,a,r={}){if(r&&!1===r.validate)return!1;const o=t.W({},this.serialize());return Mr(this,e.call(Rt,t.W({key:n,style:o,value:i,styleSpec:t.L},a)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),t.c_.off("pluginStateChange",this._rtlTextPluginCallback);for(const t in this._mergedLayers)this._mergedLayers[t].setEventedParent(null);for(const t in this._mergedSourceCaches)this._mergedSourceCaches[t].clearTiles(),this._mergedSourceCaches[t].setEventedParent(null);this.setEventedParent(null),delete this.fog,delete this.terrain,delete this.ambientLight,delete this.directionalLight,this.isRootStyle()&&(this.imageManager.setEventedParent(null),this.modelManager.setEventedParent(null),this.dispatcher.remove())}clearSource(t){const e=this.getSourceCaches(t);for(const t of e)t.clearTiles()}clearSources(){for(const t in this._mergedSourceCaches)this._mergedSourceCaches[t].clearTiles()}reloadSource(t){const e=this.getSourceCaches(t);for(const t of e)t.resume(),t.reload()}reloadSources(){for(const t of this.getSources())t.reload&&t.reload()}updateSources(t){let e;this.directionalLight&&(e=An(this.directionalLight));for(const n in this._mergedSourceCaches)this._mergedSourceCaches[n].update(t,void 0,void 0,e)}_generateCollisionBoxes(){for(const t in this._sourceCaches){const e=this._sourceCaches[t];e.resume(),e.reload()}}_updatePlacement(e,n,i,a,r,o,s=!1){let l=!1,c=!1;const u={},h={};for(const e of this._mergedOrder){const i=this._mergedLayers[e];if("symbol"!==i.type)continue;const a=t.al(i.source,i.scope);let r=u[a];if(!r){const t=this.getLayerSourceCache(i);if(!t)continue;const e=t.getRenderableIds(!0).map((e=>t.getTileByID(e)));h[a]=e.slice(),r=u[a]=e.sort(((t,e)=>e.tileID.overscaledZ-t.tileID.overscaledZ||(t.tileID.isLessThan(e.tileID)?-1:1)))}const o=this.crossTileSymbolIndex.addLayer(i,r,n.center.lng,n.projection);l=l||o}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._mergedOrder),s=s||this._layerOrderChanged||0===a,this._layerOrderChanged&&this.fire(new t.f("neworder")),(s||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(t.e.now(),n.zoom))&&(this.pauseablePlacement=new br(n,this._mergedOrder,s,i,a,r,this.placement,this.fog&&n.projection.supportsFog?this.fog.state:null,this._buildingIndex),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._mergedOrder,this._mergedLayers,u,h),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(t.e.now()),c=!0),l&&this.pauseablePlacement.placement.setStale()),c||l){this._buildingIndex.onNewFrame(n.zoom);for(let e=0;e<this._mergedOrder.length;e++){const n=this._mergedLayers[this._mergedOrder[e]];if("symbol"!==n.type)continue;const i=this.isLayerClipped(n)&&this._clipLayerIndices.some((t=>e<t));this.placement.updateLayerOpacities(n,u[t.al(n.source,n.scope)],e,i?o:null)}}let d=!1;for(const n of this._mergedOrder){const i=this._mergedLayers[n];if("symbol"!==i.type)continue;const a=u[t.al(i.source,i.scope)];for(const t of a){const n=t.getBucket(i);n&&t.latestFeatureIndex&&i.fqid===n.layerIds[0]&&(d=n.updateOcclusionOpacities(e.context,e.symbolParams,e._dt)||d)}}return{needsRerender:!this.pauseablePlacement.isDone()||this.placement.hasTransitions(t.e.now())||d,occlusionQueryBasedOpacityChanged:d}}_releaseSymbolFadeTiles(){for(const t in this._sourceCaches)this._sourceCaches[t].releaseSymbolFadeTiles()}addImport(e,n){this._checkLoaded();const i=this.stylesheet.imports=this.stylesheet.imports||[];if(-1!==i.findIndex((({id:t})=>t===e.id)))return void this.fire(new t.d(new Error(`Import with id '${e.id}' already exists in the map's style.`)));if(!n)return i.push(e),this._loadImports([e],!0);const a=i.findIndex((({id:t})=>t===n));return-1===a&&this.fire(new t.d(new Error(`Import with id "${n}" does not exist on this map.`))),this.stylesheet.imports=i.slice(0,a).concat(e).concat(i.slice(a)),this._loadImports([e],!0,n)}updateImport(t,n){this._checkLoaded();const i=this.stylesheet.imports||[],a=this.getImportIndex(t);return-1===a?this:"string"==typeof n?(this.setImportUrl(t,n),this):(n.url&&n.url!==i[a].url&&this.setImportUrl(t,n.url),e(n.config,i[a].config)||this.setImportConfig(t,n.config),e(n.data,i[a].data)||this.setImportData(t,n.data),this)}moveImport(t,e){this._checkLoaded();let n=this.stylesheet.imports||[];const i=this.getImportIndex(t);if(-1===i)return this;const a=this.getImportIndex(e);if(-1===a)return this;const r=n[i],o=this.fragments[i];return n=n.filter((({id:e})=>e!==t)),this.fragments=this.fragments.filter((({id:e})=>e!==t)),this.stylesheet.imports=n.slice(0,a).concat(r).concat(n.slice(a)),this.fragments=this.fragments.slice(0,a).concat(o).concat(this.fragments.slice(a)),this.mergeLayers(),this}setImportUrl(t,e){this._checkLoaded();const n=this.stylesheet.imports||[],i=this.getImportIndex(t);if(-1===i)return this;n[i].url=e;const a=this.fragments[i];return a.style=this._createFragmentStyle(n[i]),a.style.on("style.import.load",(()=>this.mergeAll())),a.style.loadURL(e),this}setImportData(t,e){this._checkLoaded();const n=this.getImportIndex(t),i=this.stylesheet.imports||[];return-1===n?this:e?(this.fragments[n].style.setState(e),this._reloadImports(),this):(delete i[n].data,this.setImportUrl(t,i[n].url))}setImportConfig(t,e){this._checkLoaded();const n=this.getImportIndex(t),i=this.stylesheet.imports||[];if(-1===n)return this;e?i[n].config=e:delete i[n].config;const a=this.fragments[n],r=a.style.stylesheet&&a.style.stylesheet.schema;return a.config=e,a.style.updateConfig(e,r),this.updateConfigDependencies(),this}removeImport(t){this._checkLoaded();const e=this.stylesheet.imports||[],n=this.getImportIndex(t);-1!==n&&(e.splice(n,1),this.fragments[n].style._remove(),this.fragments.splice(n,1),this._reloadImports())}getImportIndex(e){const n=(this.stylesheet.imports||[]).findIndex((t=>t.id===e));return-1===n&&this.fire(new t.d(new Error(`Import '${e}' does not exist in the map's style and cannot be updated.`))),n}getLayer(t){return this._mergedLayers[t]}getSources(){const t=[];for(const e in this._mergedOtherSourceCaches){const n=this._mergedOtherSourceCaches[e];n&&t.push(n.getSource())}return t}getSource(t,e){const n=this.getSourceCache(t,e);return n&&n.getSource()}getLayerSource(t){const e=this.getLayerSourceCache(t);return e&&e.getSource()}getSourceCache(e,n){const i=t.al(e,n);return this._mergedOtherSourceCaches[i]}getLayerSourceCache(e){const n=t.al(e.source,e.scope);return"symbol"===e.type?this._mergedSymbolSourceCaches[n]:this._mergedOtherSourceCaches[n]}getSourceCaches(t){if(null==t)return Object.values(this._mergedSourceCaches);const e=[];return this._mergedOtherSourceCaches[t]&&e.push(this._mergedOtherSourceCaches[t]),this._mergedSymbolSourceCaches[t]&&e.push(this._mergedSymbolSourceCaches[t]),e}updateSourceCaches(){const t=this._changes.getUpdatedSourceCaches();for(const e in t){const n=t[e];"reload"===n?this.reloadSource(e):"clear"===n&&this.clearSource(e)}}updateLayers(t){const e=this._changes.getUpdatedPaintProperties();for(const n of e){const e=this.getLayer(n);e&&e.updateTransitions(t)}}getImages(t,e,n){this.imageManager.getImages(e.icons,e.scope,n),this._updateTilesForChangedImages();const i=t=>{t&&t.setDependencies(e.tileID.key,e.type,e.icons)};i(this._otherSourceCaches[e.source]),i(this._symbolSourceCaches[e.source])}getGlyphs(t,e,n){this.glyphManager.getGlyphs(e.stacks,e.scope,n)}getResource(e,n,i){return t.c$(n,i)}getOwnSourceCache(t){return this._otherSourceCaches[t]}getOwnLayerSourceCache(t){return"symbol"===t.type?this._symbolSourceCaches[t.source]:this._otherSourceCaches[t.source]}getOwnSourceCaches(t){const e=[];return this._otherSourceCaches[t]&&e.push(this._otherSourceCaches[t]),this._symbolSourceCaches[t]&&e.push(this._symbolSourceCaches[t]),e}_isSourceCacheLoaded(e){const n=this.getOwnSourceCaches(e);return 0===n.length?(this.fire(new t.d(new Error(`There is no source with ID '${e}'`))),!1):n.every((t=>t.loaded()))}has3DLayers(){return this._has3DLayers}hasSymbolLayers(){return this._hasSymbolLayers}hasCircleLayers(){return this._hasCircleLayers}isLayerClipped(e,n){if(0===this._clipLayerIndices.length&&"fill-extrusion"!==e.type)return!1;const i="fill-extrusion"===e.type&&"building"===e.sourceLayer;let a=0;if(e.is3D()){if(i||n&&"batched-model"===n.type)return!0;"model"===e.type&&(a=t.cu.Model)}else"symbol"===e.type&&(a=t.cu.Symbol);for(const e of this._clipLayerIndices){const n=this._mergedLayers[this._mergedOrder[e]];if(!n)continue;const i=[];for(const e of n.layout.get("clip-layer-types"))i.push("model"===e?t.cu.Model:"symbol"===e?t.cu.Symbol:t.cu.FillExtrusion);for(const t of i)if(a&t)return!0}return!1}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.fragments.forEach((t=>{t.style._remove()})),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}function Lr(t,e){let n=!1,i=null;const a=()=>{i=null,n&&(t(),i=setTimeout(a,e),n=!1)};return()=>(n=!0,i||a(),i)}Dr.getSourceType=function(t){return Ln[t]},Dr.setSourceType=function(t,e){Ln[t]=e},Dr.registerForPluginStateChange=t.cL;class Br{constructor(e){this._hashName=e&&encodeURIComponent(e),t.bp(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=Lr(this._updateHashUnthrottled.bind(this),300)}addTo(t){return this._map=t,window.addEventListener("hashchange",this._onHashChange,!1),t.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const t=this._map;if(!t)return"";const e=Or(t);if(this._hashName){const t=this._hashName;let n=!1;const i=location.hash.slice(1).split("&").map((i=>{const a=i.split("=")[0];return a===t?(n=!0,`${a}=${e}`):i})).filter((t=>t));return n||i.push(`${t}=${e}`),`#${i.join("&")}`}return`#${e}`}_getCurrentHash(){const t=location.hash.replace("#","");if(this._hashName){let e;return t.split("&").map((t=>t.split("="))).forEach((t=>{t[0]===this._hashName&&(e=t)})),(e&&e[1]||"").split("/")}return t.split("/")}_onHashChange(){const t=this._map;if(!t)return!1;const e=this._getCurrentHash();if(e.length>=3&&!e.some((t=>isNaN(t)))){const n=t.dragRotate.isEnabled()&&t.touchZoomRotate.isEnabled()?+(e[3]||0):t.getBearing();return t.jumpTo({center:[+e[2],+e[1]],zoom:+e[0],bearing:n,pitch:+(e[4]||0)}),!0}return!1}_updateHashUnthrottled(){history.replaceState(history.state,"",location.href.replace(/(#.+)?$/,this.getHashString()))}}function Or(t,e){const n=t.getCenter(),i=Math.round(100*t.getZoom())/100,a=Math.ceil((i*Math.LN2+Math.log(512/360/.5))/Math.LN10),r=Math.pow(10,a),o=Math.round(n.lng*r)/r,s=Math.round(n.lat*r)/r,l=t.getBearing(),c=t.getPitch();let u=e?`/${o}/${s}/${i}`:`${i}/${s}/${o}`;return(l||c)&&(u+="/"+Math.round(10*l)/10),c&&(u+=`/${Math.round(c)}`),u}const Rr={linearity:.3,easing:t.d0(0,0,.3,1)},Fr=t.W({deceleration:2500,maxSpeed:1400},Rr),Nr=t.W({deceleration:20,maxSpeed:1400},Rr),jr=t.W({deceleration:1e3,maxSpeed:360},Rr),Vr=t.W({deceleration:1e3,maxSpeed:90},Rr);class Ur{constructor(t){this._map=t,this.clear()}clear(){this._inertiaBuffer=[]}record(e){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:t.e.now(),settings:e})}_drainInertiaBuffer(){const e=this._inertiaBuffer,n=t.e.now();for(;e.length>0&&n-e[0].time>160;)e.shift()}_onMoveEnd(e){if(this._map._prefersReducedMotion())return;if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const n={zoom:0,bearing:0,pitch:0,pan:new t.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:t}of this._inertiaBuffer)n.zoom+=t.zoomDelta||0,n.bearing+=t.bearingDelta||0,n.pitch+=t.pitchDelta||0,t.panDelta&&n.pan._add(t.panDelta),t.around&&(n.around=t.around),t.pinchAround&&(n.pinchAround=t.pinchAround);const i=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,a={};if(n.pan.mag()){const r=qr(n.pan.mag(),i,t.W({},Fr,e||{}));a.offset=n.pan.mult(r.amount/n.pan.mag()),a.center=this._map.transform.center,Gr(a,r)}if(n.zoom){const t=qr(n.zoom,i,Nr);a.zoom=this._map.transform.zoom+t.amount,Gr(a,t)}if(n.bearing){const e=qr(n.bearing,i,jr);a.bearing=this._map.transform.bearing+t.at(e.amount,-179,179),Gr(a,e)}if(n.pitch){const t=qr(n.pitch,i,Vr);a.pitch=this._map.transform.pitch+t.amount,Gr(a,t)}if(a.zoom||a.bearing){const t=void 0===n.pinchAround?n.around:n.pinchAround;a.around=t?this._map.unproject(t):this._map.getCenter()}return this.clear(),a.noMoveStart=!0,a}}function Gr(t,e){(!t.duration||t.duration<e.duration)&&(t.duration=e.duration,t.easing=e.easing)}function qr(e,n,i){const{maxSpeed:a,linearity:r,deceleration:o}=i,s=t.at(e*r/(n/1e3),-a,a),l=Math.abs(s)/(o*r);return{easing:i.easing,duration:1e3*l,amount:s*(l/2)}}class $r extends t.f{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,n,i,a={}){const r=f(n.getCanvasContainer(),i),o=n.unproject(r);super(e,t.W({point:r,lngLat:o,originalEvent:i},a)),this._defaultPrevented=!1,this.target=n}}class Wr extends t.f{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,n,i){const a="touchend"===e?i.changedTouches:i.touches,r=m(n.getCanvasContainer(),a),o=r.map((t=>n.unproject(t))),s=r.reduce(((t,e,n,i)=>t.add(e.div(i.length))),new t.P(0,0));super(e,{points:r,point:s,lngLats:o,lngLat:n.unproject(s),originalEvent:i}),this._defaultPrevented=!1}}class Hr extends t.f{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,e,n){super(t,{originalEvent:n}),this._defaultPrevented=!1}}class Zr{constructor(t,e){this._map=t,this._clickTolerance=e.clickTolerance}reset(){this._mousedownPos=void 0}wheel(t){return this._firePreventable(new Hr(t.type,this._map,t))}mousedown(t,e){return this._mousedownPos=e,this._firePreventable(new $r(t.type,this._map,t))}mouseup(t){this._map.fire(new $r(t.type,this._map,t))}preclick(e){const n=t.W({},e);n.type="preclick",this._map.fire(new $r(n.type,this._map,n))}click(t,e){this._mousedownPos&&this._mousedownPos.dist(e)>=this._clickTolerance||(this.preclick(t),this._map.fire(new $r(t.type,this._map,t)))}dblclick(t){return this._firePreventable(new $r(t.type,this._map,t))}mouseover(t){this._map.fire(new $r(t.type,this._map,t))}mouseout(t){this._map.fire(new $r(t.type,this._map,t))}touchstart(t){return this._firePreventable(new Wr(t.type,this._map,t))}touchmove(t){this._map.fire(new Wr(t.type,this._map,t))}touchend(t){this._map.fire(new Wr(t.type,this._map,t))}touchcancel(t){this._map.fire(new Wr(t.type,this._map,t))}_firePreventable(t){if(this._map.fire(t),t.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Yr{constructor(t){this._map=t}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(t){this._map.fire(new $r(t.type,this._map,t))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new $r("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(t){this._delayContextMenu?this._contextMenuEvent=t:this._map.fire(new $r(t.type,this._map,t)),this._map.listens("contextmenu")&&t.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Xr{constructor(t,e){this._map=t,this._el=t.getCanvasContainer(),this._container=t.getContainer(),this._clickTolerance=e.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(t,e){this.isEnabled()&&t.shiftKey&&0===t.button&&(u(),this._startPos=this._lastPos=e,this._active=!0)}mousemoveWindow(t,e){if(!this._active)return;const n=e,i=this._startPos,a=this._lastPos;if(!i||!a||a.equals(n)||!this._box&&n.dist(i)<this._clickTolerance)return;this._lastPos=n,this._box||(this._box=r("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",t));const o=Math.min(i.x,n.x),s=Math.max(i.x,n.x),l=Math.min(i.y,n.y),c=Math.max(i.y,n.y);this._map._requestDomTask((()=>{this._box&&(this._box.style.transform=`translate(${o}px,${l}px)`,this._box.style.width=s-o+"px",this._box.style.height=c-l+"px")}))}mouseupWindow(e,n){if(!this._active)return;const i=this._startPos,a=n;if(i&&0===e.button){if(this.reset(),p(),i.x!==a.x||i.y!==a.y)return this._map.fire(new t.f("boxzoomend",{originalEvent:e})),{cameraAnimation:t=>t.fitScreenCoordinates(i,a,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",e)}}keydown(t){this._active&&27===t.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",t))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),h(),delete this._startPos,delete this._lastPos}_fireEvent(e,n){return this._map.fire(new t.f(e,{originalEvent:n}))}}function Kr(t,e){const n={};for(let i=0;i<t.length;i++)n[t[i].identifier]=e[i];return n}class Qr{constructor(t){this.reset(),this.numTouches=t.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(e,n,i){(this.centroid||i.length>this.numTouches)&&(this.aborted=!0),this.aborted||(0===this.startTime&&(this.startTime=e.timeStamp),i.length===this.numTouches&&(this.centroid=function(e){const n=new t.P(0,0);for(const t of e)n._add(t);return n.div(e.length)}(n),this.touches=Kr(i,n)))}touchmove(t,e,n){if(this.aborted||!this.centroid)return;const i=Kr(n,e);for(const t in this.touches){const e=i[t];(!e||e.dist(this.touches[t])>30)&&(this.aborted=!0)}}touchend(t,e,n){if((!this.centroid||t.timeStamp-this.startTime>500)&&(this.aborted=!0),0===n.length){const t=!this.aborted&&this.centroid;if(this.reset(),t)return t}}}class Jr{constructor(t){this.singleTap=new Qr(t),this.numTaps=t.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(t,e,n){this.singleTap.touchstart(t,e,n)}touchmove(t,e,n){this.singleTap.touchmove(t,e,n)}touchend(t,e,n){const i=this.singleTap.touchend(t,e,n);if(i){const e=t.timeStamp-this.lastTime<500,n=!this.lastTap||this.lastTap.dist(i)<30;if(e&&n||this.reset(),this.count++,this.lastTime=t.timeStamp,this.lastTap=i,this.count===this.numTaps)return this.reset(),i}}}class to{constructor(){this._zoomIn=new Jr({numTouches:1,numTaps:2}),this._zoomOut=new Jr({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(t,e,n){this._zoomIn.touchstart(t,e,n),this._zoomOut.touchstart(t,e,n)}touchmove(t,e,n){this._zoomIn.touchmove(t,e,n),this._zoomOut.touchmove(t,e,n)}touchend(t,e,n){const i=this._zoomIn.touchend(t,e,n),a=this._zoomOut.touchend(t,e,n);return i?(this._active=!0,t.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:e=>e.easeTo({duration:300,zoom:e.getZoom()+1,around:e.unproject(i)},{originalEvent:t})}):a?(this._active=!0,t.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:e=>e.easeTo({duration:300,zoom:e.getZoom()-1,around:e.unproject(a)},{originalEvent:t})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const eo={0:1,2:2};class no{constructor(t){this.reset(),this._clickTolerance=t.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(t,e){return!1}_move(t,e){return{}}mousedown(t,e){if(this._lastPoint)return;const n=g(t);this._correctButton(t,n)&&(this._lastPoint=e,this._eventButton=n)}mousemoveWindow(t,e){const n=this._lastPoint;if(n)if(t.preventDefault(),null!=this._eventButton&&function(t,e){const n=eo[e];return void 0===t.buttons||(t.buttons&n)!==n}(t,this._eventButton))this.reset();else if(this._moved||!(e.dist(n)<this._clickTolerance))return this._moved=!0,this._lastPoint=e,this._move(n,e)}mouseupWindow(t){this._lastPoint&&g(t)===this._eventButton&&(this._moved&&p(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class io extends no{mousedown(t,e){super.mousedown(t,e),this._lastPoint&&(this._active=!0)}_correctButton(t,e){return 0===e&&!t.ctrlKey}_move(t,e){return{around:e,panDelta:e.sub(t)}}}class ao extends no{_correctButton(t,e){return 0===e&&t.ctrlKey||2===e}_move(t,e){const n=.8*(e.x-t.x);if(n)return this._active=!0,{bearingDelta:n}}contextmenu(t){t.preventDefault()}}class ro extends no{_correctButton(t,e){return 0===e&&t.ctrlKey||2===e}_move(t,e){const n=-.5*(e.y-t.y);if(n)return this._active=!0,{pitchDelta:n}}contextmenu(t){t.preventDefault()}}class oo{constructor(e,n){this._map=e,this._el=e.getCanvasContainer(),this._minTouches=1,this._clickTolerance=n.clickTolerance||1,this.reset(),t.bp(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new t.P(0,0)}touchstart(t,e,n){return this._calculateTransform(t,e,n)}touchmove(e,n,i){if(this._active&&!(i.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(1===i.length&&!t.d1())return void this._showTouchPanBlockerAlert();"hidden"!==this._alertContainer.style.visibility&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return e.cancelable&&e.preventDefault(),this._calculateTransform(e,n,i)}}touchend(t,e,n){this._calculateTransform(t,e,n),this._active&&n.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(e,n,i){i.length>0&&(this._active=!0);const a=Kr(i,n),r=new t.P(0,0),o=new t.P(0,0);let s=0;for(const t in a){const e=a[t],n=this._touches[t];n&&(r._add(e),o._add(e.sub(n)),s++,a[t]=e)}if(this._touches=a,s<this._minTouches||!o.mag())return;const l=o.div(s);return this._sum._add(l),this._sum.mag()<this._clickTolerance?void 0:{around:r.div(s),panDelta:l}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=r("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout((()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.removeAttribute("role")}),500)}}class so{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(t){}_move(t,e,n){return{}}touchstart(t,e,n){this._firstTwoTouches||n.length<2||(this._firstTwoTouches=[n[0].identifier,n[1].identifier],this._start([e[0],e[1]]))}touchmove(t,e,n){const i=this._firstTwoTouches;if(!i)return;t.preventDefault();const[a,r]=i,o=lo(n,e,a),s=lo(n,e,r);if(!o||!s)return;const l=this._aroundCenter?null:o.add(s).div(2);return this._move([o,s],l,t)}touchend(t,e,n){if(!this._firstTwoTouches)return;const[i,a]=this._firstTwoTouches,r=lo(n,e,i),o=lo(n,e,a);r&&o||(this._active&&p(),this.reset())}touchcancel(){this.reset()}enable(t){this._enabled=!0,this._aroundCenter=!!t&&"center"===t.around}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function lo(t,e,n){for(let i=0;i<t.length;i++)if(t[i].identifier===n)return e[i]}function co(t,e){return Math.log(t/e)/Math.LN2}class uo extends so{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(t){this._startDistance=this._distance=t[0].dist(t[1])}_move(t,e){const n=this._distance;if(this._distance=t[0].dist(t[1]),this._active||!(Math.abs(co(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:co(this._distance,n),pinchAround:e}}}function ho(t,e){return 180*t.angleWith(e)/Math.PI}class po extends so{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(t){this._startVector=this._vector=t[0].sub(t[1]),this._minDiameter=t[0].dist(t[1])}_move(t,e){const n=this._vector;if(this._vector=t[0].sub(t[1]),n&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:ho(this._vector,n),pinchAround:e}}_isBelowThreshold(t){this._minDiameter=Math.min(this._minDiameter,t.mag());const e=25/(Math.PI*this._minDiameter)*360,n=this._startVector;if(!n)return!1;const i=ho(t,n);return Math.abs(i)<e}}function fo(t){return Math.abs(t.y)>Math.abs(t.x)}class mo extends so{constructor(t){super(),this._map=t}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(t){this._lastPoints=t,fo(t[0].sub(t[1]))&&(this._valid=!1)}_move(e,n,i){const a=this._lastPoints;if(!a)return;const r=e[0].sub(a[0]),o=e[1].sub(a[1]);return this._map._cooperativeGestures&&!t.d1()&&i.touches.length<3||(this._valid=this.gestureBeginsVertically(r,o,i.timeStamp),!this._valid)?void 0:(this._lastPoints=e,this._active=!0,{pitchDelta:(r.y+o.y)/2*-.5})}gestureBeginsVertically(t,e,n){if(void 0!==this._valid)return this._valid;const i=t.mag()>=2,a=e.mag()>=2;if(!i&&!a)return;if(!i||!a)return null==this._firstMove&&(this._firstMove=n),n-this._firstMove<100&&void 0;const r=t.y>0==e.y>0;return fo(t)&&fo(e)&&r}}const go={panStep:100,bearingStep:15,pitchStep:10};class _o{constructor(){const t=go;this._panStep=t.panStep,this._bearingStep=t.bearingStep,this._pitchStep=t.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(t){if(t.altKey||t.ctrlKey||t.metaKey)return;let e=0,n=0,i=0,a=0,r=0;switch(t.keyCode){case 61:case 107:case 171:case 187:e=1;break;case 189:case 109:case 173:e=-1;break;case 37:t.shiftKey?n=-1:(t.preventDefault(),a=-1);break;case 39:t.shiftKey?n=1:(t.preventDefault(),a=1);break;case 38:t.shiftKey?i=1:(t.preventDefault(),r=-1);break;case 40:t.shiftKey?i=-1:(t.preventDefault(),r=1);break;default:return}return this._rotationDisabled&&(n=0,i=0),{cameraAnimation:o=>{const s=o.getZoom();o.easeTo({duration:300,easeId:"keyboardHandler",easing:yo,zoom:e?Math.round(s)+e*(t.shiftKey?2:1):s,bearing:o.getBearing()+n*this._bearingStep,pitch:o.getPitch()+i*this._pitchStep,offset:[-a*this._panStep,-r*this._panStep],center:o.getCenter()},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function yo(t){return t*(2-t)}const xo=4.000244140625,vo=1/450;class bo{constructor(e,n){this._map=e,this._el=e.getCanvasContainer(),this._handler=n,this._delta=0,this._lastDelta=0,this._defaultZoomRate=.01,this._wheelZoomRate=vo,t.bp(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(t){this._defaultZoomRate=t}setWheelZoomRate(t){this._wheelZoomRate=t}isEnabled(){return!!this._enabled}isActive(){return this._active||void 0!==this._finishTimeout}isZooming(){return!!this._zooming}enable(t){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!t&&"center"===t.around,this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(e){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(e.ctrlKey||e.metaKey||this.isZooming()||t.d1()))return void this._showBlockerAlert();"hidden"!==this._alertContainer.style.visibility&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let n=e.deltaMode===WheelEvent.DOM_DELTA_LINE?40*e.deltaY:e.deltaY;const i=t.e.now(),a=i-(this._lastWheelEventTime||0);this._lastWheelEventTime=i,0!==n&&n%xo==0?this._type="wheel":0!==n&&Math.abs(n)<4?this._type="trackpad":a>400?(this._type=null,this._lastValue=n,this._timeout=setTimeout(this._onTimeout,40,e)):this._type||(this._type=Math.abs(a*n)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,n+=this._lastValue)),e.shiftKey&&n&&(n/=4),this._type&&(this._lastWheelEvent=e,this._delta-=n,this._active||this._start(e)),e.preventDefault()}_onTimeout(t){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(t)}_start(t){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const e=f(this._el,t);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:e,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId)return;if(this._frameId=null,!this.isActive())return;const e=this._map.transform;"wheel"===this._type&&e.projection.wrap&&(e._center.lng>=180||e._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const n=()=>e._terrainEnabled()&&this._aroundCoord?e.computeZoomRelativeTo(this._aroundCoord):e.zoom;if(0!==this._delta){const t="wheel"===this._type&&Math.abs(this._delta)>xo?this._wheelZoomRate:this._defaultZoomRate;let i=2/(1+Math.exp(-Math.abs(this._delta*t)));this._delta<0&&0!==i&&(i=1/i);const a=n(),r=Math.pow(2,a),o="number"==typeof this._targetZoom?e.zoomScale(this._targetZoom):r;this._targetZoom=Math.min(e.maxZoom,Math.max(e.minZoom,e.scaleZoom(o*i))),"wheel"===this._type&&(this._startZoom=a,this._easing=this._smoothOutEasing(200)),this._lastDelta=this._delta,this._delta=0}const i="number"==typeof this._targetZoom?this._targetZoom:n(),a=this._startZoom,r=this._easing;let o,s=!1;if("wheel"===this._type&&a&&r){const e=Math.min((t.e.now()-this._lastWheelEventTime)/200,1),n=r(e);o=t.a2(a,i,n),e<1?this._frameId||(this._frameId=!0):s=!0}else o=i,s=!0;this._active=!0,s&&(this._active=!1,this._finishTimeout=setTimeout((()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout}),200));let l=o-n();return l*this._lastDelta<0&&(l=0),{noInertia:!0,needsRenderFrame:!s,zoomDelta:l,around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(e){let n=t.d2;if(this._prevEase){const e=this._prevEase,i=(t.e.now()-e.start)/e.duration,a=e.easing(i+.01)-e.easing(i),r=.27/Math.sqrt(a*a+1e-4)*.01,o=Math.sqrt(.0729-r*r);n=t.d0(r,o,.25,1)}return this._prevEase={start:t.e.now(),duration:e,easing:n},n}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=r("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout((()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.removeAttribute("role")}),200)}}class wo{constructor(t,e){this._clickZoom=t,this._tapZoom=e}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Ao{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(t,e){return t.preventDefault(),{cameraAnimation:n=>{n.easeTo({duration:300,zoom:n.getZoom()+(t.shiftKey?-1:1),around:n.unproject(e)},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Co{constructor(){this._tap=new Jr({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(t,e,n){this._swipePoint||(this._tapTime&&t.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?n.length>0&&(this._swipePoint=e[0],this._swipeTouch=n[0].identifier):this._tap.touchstart(t,e,n))}touchmove(t,e,n){if(this._tapTime){if(this._swipePoint){if(n[0].identifier!==this._swipeTouch)return;const i=e[0],a=i.y-this._swipePoint.y;return this._swipePoint=i,t.preventDefault(),this._active=!0,{zoomDelta:a/128}}}else this._tap.touchmove(t,e,n)}touchend(t,e,n){this._tapTime?this._swipePoint&&0===n.length&&this.reset():this._tap.touchend(t,e,n)&&(this._tapTime=t.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Eo{constructor(t,e,n){this._el=t,this._mousePan=e,this._touchPan=n}enable(t){this._inertiaOptions=t||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class To{constructor(t,e,n){this._pitchWithRotate=t.pitchWithRotate,this._mouseRotate=e,this._mousePitch=n}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class So{constructor(t,e,n,i){this._el=t,this._touchZoom=e,this._touchRotate=n,this._tapDragZoom=i,this._rotationDisabled=!1,this._enabled=!0}enable(t){this._touchZoom.enable(t),this._rotationDisabled||this._touchRotate.enable(t),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Mo=t=>t.zoom||t.drag||t.pitch||t.rotate;class ko extends t.f{}class Io{constructor(){this.constants=[1,1,.01],this.radius=0}setup(e,n){const i=t._.sub([],n,e);this.radius=t._.length(i[2]<0?t._.div([],i,this.constants):[i[0],i[1],0])}projectRay(e){t._.div(e,e,this.constants),t._.normalize(e,e),t._.mul(e,e,this.constants);const n=t._.scale([],e,this.radius);if(n[2]>0){const e=t._.scale([],[0,0,1],t._.dot(n,[0,0,1])),i=t._.scale([],t._.normalize([],[n[0],n[1],0]),this.radius),a=t._.add([],n,t._.scale([],t._.sub([],t._.add([],i,e),n),2));n[0]=a[0],n[1]=a[1]}return n}}function Po(t){return t.panDelta&&t.panDelta.mag()||t.zoomDelta||t.bearingDelta||t.pitchDelta}class zo{constructor(e,n){this._map=e,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Ur(e),this._bearingSnap=n.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new Io,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(n),t.bp(["handleEvent","handleWindowEvent"],this);const i=this._el;this._listeners=[[i,"touchstart",{passive:!0}],[i,"touchmove",{passive:!1}],[i,"touchend",void 0],[i,"touchcancel",void 0],[i,"mousedown",void 0],[i,"mousemove",void 0],[i,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[i,"mouseover",void 0],[i,"mouseout",void 0],[i,"dblclick",void 0],[i,"click",void 0],[i,"keydown",{capture:!1}],[i,"keyup",void 0],[i,"wheel",{passive:!1}],[i,"contextmenu",void 0],[window,"blur",void 0]];for(const[t,e,n]of this._listeners){const i=t===document?this.handleWindowEvent:this.handleEvent;t.addEventListener(e,i,n)}}destroy(){for(const[t,e,n]of this._listeners){const i=t===document?this.handleWindowEvent:this.handleEvent;t.removeEventListener(e,i,n)}}_addDefaultHandlers(t){const e=this._map,n=e.getCanvasContainer();this._add("mapEvent",new Zr(e,t));const i=e.boxZoom=new Xr(e,t);this._add("boxZoom",i);const a=new to,r=new Ao;e.doubleClickZoom=new wo(r,a),this._add("tapZoom",a),this._add("clickZoom",r);const o=new Co;this._add("tapDragZoom",o);const s=e.touchPitch=new mo(e);this._add("touchPitch",s);const l=new ao(t),c=new ro(t);e.dragRotate=new To(t,l,c),this._add("mouseRotate",l,["mousePitch"]),this._add("mousePitch",c,["mouseRotate"]);const u=new io(t),h=new oo(e,t);e.dragPan=new Eo(n,u,h),this._add("mousePan",u),this._add("touchPan",h,["touchZoom","touchRotate"]);const d=new po,p=new uo;e.touchZoomRotate=new So(n,p,d,o),this._add("touchRotate",d,["touchPan","touchZoom"]),this._add("touchZoom",p,["touchPan","touchRotate"]),this._add("blockableMapEvent",new Yr(e));const f=e.scrollZoom=new bo(e,this);this._add("scrollZoom",f,["mousePan"]);const m=e.keyboard=new _o;this._add("keyboard",m);for(const n of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])t.interactive&&t[n]&&e[n].enable(t[n])}_add(t,e,n){this._handlers.push({handlerName:t,handler:e,allowed:n}),this._handlersById[t]=e}stop(t){if(!this._updatingCamera){for(const{handler:t}of this._handlers)t.reset();this._inertia.clear(),this._fireEvents({},{},t),this._changes=[],this._originalZoom=void 0}}isActive(){for(const{handler:t}of this._handlers)if(t.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Mo(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(t,e,n){for(const i in t)if(i!==n&&(!e||e.indexOf(i)<0))return!0;return!1}handleWindowEvent(t){this.handleEvent(t,`${t.type}Window`)}_getMapTouches(t){const e=[];for(const n of t)this._el.contains(n.target)&&e.push(n);return e}handleEvent(t,e){this._updatingCamera=!0;const n="renderFrame"===t.type,i=n?void 0:t,a={needsRenderFrame:!1},r={},o={},s=t.touches?this._getMapTouches(t.touches):void 0,l=s?m(this._el,s):n?void 0:f(this._el,t);for(const{handlerName:n,handler:c,allowed:u}of this._handlers){if(!c.isEnabled())continue;let h;this._blockedByActive(o,u,n)?c.reset():c[e||t.type]&&(h=c[e||t.type](t,l,s),this.mergeHandlerResult(a,r,h,n,i),h&&h.needsRenderFrame&&this._triggerRenderFrame()),(h||c.isActive())&&(o[n]=c)}const c={};for(const t in this._previousActiveHandlers)o[t]||(c[t]=i);this._previousActiveHandlers=o,(Object.keys(c).length||Po(a))&&(this._changes.push([a,r,c]),this._triggerRenderFrame()),(Object.keys(o).length||Po(a))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:u}=a;u&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],u(this._map))}mergeHandlerResult(e,n,i,a,r){if(!i)return;t.W(e,i);const o={handlerName:a,originalEvent:i.originalEvent||r};void 0!==i.zoomDelta&&(n.zoom=o),void 0!==i.panDelta&&(n.drag=o),void 0!==i.pitchDelta&&(n.pitch=o),void 0!==i.bearingDelta&&(n.rotate=o)}_applyChanges(){const e={},n={},i={};for(const[a,r,o]of this._changes)a.panDelta&&(e.panDelta=(e.panDelta||new t.P(0,0))._add(a.panDelta)),a.zoomDelta&&(e.zoomDelta=(e.zoomDelta||0)+a.zoomDelta),a.bearingDelta&&(e.bearingDelta=(e.bearingDelta||0)+a.bearingDelta),a.pitchDelta&&(e.pitchDelta=(e.pitchDelta||0)+a.pitchDelta),void 0!==a.around&&(e.around=a.around),void 0!==a.aroundCoord&&(e.aroundCoord=a.aroundCoord),void 0!==a.pinchAround&&(e.pinchAround=a.pinchAround),a.noInertia&&(e.noInertia=a.noInertia),t.W(n,r),t.W(i,o);this._updateMapTransform(e,n,i),this._changes=[]}_updateMapTransform(e,n,i){const a=this._map,r=a.transform,o=t=>[t.x,t.y,t.z];if((t=>{const e=this._eventsInProgress.drag;return e&&!this._handlersById[e.handlerName].isActive()})()&&!Po(e)){const t=r.zoom;r.cameraElevationReference="sea",null!=this._originalZoom&&r._orthographicProjectionAtLowPitch&&"globe"!==r.projection.name&&0===r.pitch?(r.cameraElevationReference="ground",r.zoom=this._originalZoom):(r.recenterOnTerrain(),r.cameraElevationReference="ground"),t!==r.zoom&&this._map._update(!0)}if(r._isCameraConstrained&&a._stop(!0),!Po(e))return void this._fireEvents(n,i,!0);let{panDelta:s,zoomDelta:l,bearingDelta:c,pitchDelta:u,around:h,aroundCoord:d,pinchAround:p}=e;r._isCameraConstrained&&(l>0&&(l=0),r._isCameraConstrained=!1),void 0!==p&&(h=p),(l||(t=>n[t]&&!this._eventsInProgress[t])("drag"))&&h&&(this._dragOrigin=o(r.pointCoordinate3D(h)),this._originalZoom=r.zoom,this._trackingEllipsoid.setup(r._camera.position,this._dragOrigin)),r.cameraElevationReference="sea",a._stop(!0),h=h||a.transform.centerPoint,c&&(r.bearing+=c),u&&(r.pitch+=u),r._updateCameraState();const f=[0,0,0];if(s)if("mercator"===r.projection.name){const t=this._trackingEllipsoid.projectRay(r.screenPointToMercatorRay(h).dir),e=this._trackingEllipsoid.projectRay(r.screenPointToMercatorRay(h.sub(s)).dir);f[0]=e[0]-t[0],f[1]=e[1]-t[1]}else{const e=r.pointCoordinate(h);if("globe"===r.projection.name){s=s.rotate(-r.angle);const n=r._pixelsPerMercatorPixel/r.worldSize;f[0]=-s.x*t.d3(t.ay(e.y))*n,f[1]=-s.y*t.d3(r.center.lat)*n}else{const t=r.pointCoordinate(h.sub(s));e&&t&&(f[0]=t.x-e.x,f[1]=t.y-e.y)}}const m=r.zoom,g=[0,0,0];if(l){const e=o(d||r.pointCoordinate3D(h)),n={dir:t._.normalize([],t._.sub([],e,r._camera.position))};if(n.dir[2]<0){const i=r.zoomDeltaToMovement(e,l);t._.scale(g,n.dir,i)}}const _=t._.add(f,f,g);r._translateCameraConstrained(_),l&&Math.abs(r.zoom-m)>1e-4&&r.recenterOnTerrain(),r.cameraElevationReference="ground",this._map._update(),e.noInertia||this._inertia.record(e),this._fireEvents(n,i,!0)}_fireEvents(e,n,i){const a=Mo(this._eventsInProgress),r=Mo(e),o={};for(const t in e){const{originalEvent:n}=e[t];this._eventsInProgress[t]||(o[`${t}start`]=n),this._eventsInProgress[t]=e[t]}!a&&r&&this._fireEvent("movestart",r.originalEvent);for(const t in o)this._fireEvent(t,o[t]);r&&this._fireEvent("move",r.originalEvent);for(const t in e){const{originalEvent:n}=e[t];this._fireEvent(t,n)}const s={};let l;for(const t in this._eventsInProgress){const{handlerName:e,originalEvent:i}=this._eventsInProgress[t];this._handlersById[e].isActive()||(delete this._eventsInProgress[t],l=n[e]||i,s[`${t}end`]=l)}for(const t in s)this._fireEvent(t,s[t]);const c=Mo(this._eventsInProgress);if(i&&(a||r)&&!c){this._updatingCamera=!0;const e=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),n=t=>0!==t&&-this._bearingSnap<t&&t<this._bearingSnap;e?(n(e.bearing||this._map.getBearing())&&(e.bearing=0),this._map.easeTo(e,{originalEvent:l})):(this._map.fire(new t.f("moveend",{originalEvent:l})),n(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(e,n){this._map.fire(new t.f(e,n?{originalEvent:n}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add((t=>{this._frameId=void 0,this.handleEvent(new ko("renderFrame",{timeStamp:t})),this._applyChanges()}))}_triggerRenderFrame(){void 0===this._frameId&&(this._frameId=this._requestFrame())}}const Do="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class Lo extends t.E{constructor(e,n){super(),this._moving=!1,this._zooming=!1,this.transform=e,this._bearingSnap=n.bearingSnap,this._respectPrefersReducedMotion=!1!==n.respectPrefersReducedMotion,t.bp(["_renderFrameCallback"],this)}getCenter(){return new t.aI(this.transform.center.lng,this.transform.center.lat)}setCenter(t,e){return this.jumpTo({center:t},e)}panBy(e,n,i){return e=t.P.convert(e).mult(-1),this.panTo(this.transform.center,t.W({offset:e},n),i)}panTo(e,n,i){return this.easeTo(t.W({center:e},n),i)}getZoom(){return this.transform.zoom}setZoom(t,e){return this.jumpTo({zoom:t},e),this}zoomTo(e,n,i){return this.easeTo(t.W({zoom:e},n),i)}zoomIn(t,e){return this.zoomTo(this.getZoom()+1,t,e),this}zoomOut(t,e){return this.zoomTo(this.getZoom()-1,t,e),this}getBearing(){return this.transform.bearing}setBearing(t,e){return this.jumpTo({bearing:t},e),this}getPadding(){return this.transform.padding}setPadding(t,e){return this.jumpTo({padding:t},e),this}rotateTo(e,n,i){return this.easeTo(t.W({bearing:e},n),i)}resetNorth(e,n){return this.rotateTo(0,t.W({duration:1e3},e),n),this}resetNorthPitch(e,n){return this.easeTo(t.W({bearing:0,pitch:0,duration:1e3},e),n),this}snapToNorth(t,e){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(t,e):this}getPitch(){return this.transform.pitch}setPitch(t,e){return this.jumpTo({pitch:t},e),this}cameraForBounds(e,n){e=t.ai.convert(e);const i=n&&n.bearing||0,a=n&&n.pitch||0,r=e.getNorthWest(),o=e.getSouthEast();return this._cameraForBounds(this.transform,r,o,i,a,n)}_extendPadding(e){const n={top:0,right:0,bottom:0,left:0};return null==e?t.W({},n,this.transform.padding):"number"==typeof e?{top:e,bottom:e,right:e,left:e}:t.W({},n,e)}_extendCameraOptions(e){return(e=t.W({offset:[0,0],maxZoom:this.transform.maxZoom},e)).padding=this._extendPadding(e.padding),e}_minimumAABBFrustumDistance(t,e){const n=e.max[0]-e.min[0],i=e.max[1]-e.min[1];return n/i>t.aspect?n/(2*Math.tan(.5*t.fovX)*t.aspect):i/(2*Math.tan(.5*t.fovY)*t.aspect)}_cameraForBoundsOnGlobe(e,n,i,a,r,o){const s=e.clone(),l=this._extendCameraOptions(o);s.bearing=a,s.pitch=r;const c=t.aI.convert(n),u=t.aI.convert(i),h=.5*(c.lat+u.lat),d=.5*(c.lng+u.lng),p=t.d4(h,d),f=t._.normalize([],p),m=t._.normalize([],t._.cross([],f,[0,1,0])),g=t._.cross([],m,f),_=[m[0],m[1],m[2],0,g[0],g[1],g[2],0,f[0],f[1],f[2],0,0,0,0,1],y=[p,t.d4(c.lat,c.lng),t.d4(u.lat,c.lng),t.d4(u.lat,u.lng),t.d4(c.lat,u.lng),t.d4(h,c.lng),t.d4(h,u.lng),t.d4(c.lat,d),t.d4(u.lat,d)];let x=t.b6.fromPoints(y.map((e=>[t._.dot(m,e),t._.dot(g,e),t._.dot(f,e)])));const v=t._.transformMat4([],x.center,_);0===t._.squaredLength(v)&&t._.set(v,0,0,1),t._.normalize(v,v),t._.scale(v,v,t.cD),s.center=t.d5(v);const b=s.getWorldToCameraMatrix(),w=t.ad.invert(new Float64Array(16),b);x=t.b6.applyTransform(x,t.ad.multiply([],b,_));const A=this._extendAABB(x,s,l,a);if(!A)return void t.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");x=A,t._.transformMat4(v,v,b);const C=.5*(x.max[2]-x.min[2]),E=this._minimumAABBFrustumDistance(s,x),T=t._.scale([],[0,0,1],C),S=t._.add(T,v,T),M=E+(0===s.pitch?0:t._.distance(v,S)),k=s.globeCenterInViewSpace,I=t._.sub([],v,[k[0],k[1],k[2]]);t._.normalize(I,I),t._.scale(I,I,M);const P=t._.add([],v,I);t._.transformMat4(P,P,w);const z=t.d7/t.cD,D=t._.length(P),L=t.ax(Math.max(D*z-t.d7,Number.EPSILON),0),B=Math.min(s.zoomFromMercatorZAdjusted(L),l.maxZoom);return B>.5*(t.b1+t.aU)?(s.setProjection({name:"mercator"}),s.zoom=B,this._cameraForBounds(s,n,i,a,r,o)):{center:s.center,zoom:B,bearing:a,pitch:r}}_extendAABB(e,n,i,a){const r=.5*((i.padding.left||0)+(i.padding.right||0)),o=.5*((i.padding.top||0)+(i.padding.bottom||0)),s=o,l=r,c=r,u=o,h=n.width-(l+c),d=n.height-(s+u),p=t._.sub([],e.max,e.min),f=Math.min(h/p[0],d/p[1]),m=Math.min(n.scaleZoom(n.scale*f),i.maxZoom);if(isNaN(m))return null;const g=n.scale/n.zoomScale(m),_=new t.b6([e.min[0]-l*g,e.min[1]-u*g,e.min[2]],[e.max[0]+c*g,e.max[1]+s*g,e.max[2]]),y=("number"==typeof i.offset.x&&"number"==typeof i.offset.y?new t.P(i.offset.x,i.offset.y):t.P.convert(i.offset)).rotate(-t.ab(a));return _.center[0]-=y.x*g,_.center[1]+=y.y*g,_}queryTerrainElevation(e,n){const i=this.transform.elevation;return i?(n=t.W({},{exaggerated:!0},n),i.getAtPoint(t.Y.fromLngLat(e),null,n.exaggerated)):null}_cameraForBounds(e,n,i,a,r,o){if("globe"===e.projection.name)return this._cameraForBoundsOnGlobe(e,n,i,a,r,o);const s=e.clone(),l=this._extendCameraOptions(o);s.bearing=a,s.pitch=r;const c=t.aI.convert(n),u=t.aI.convert(i),h=new t.aI(c.lng,u.lat),d=new t.aI(u.lng,c.lat),p=s.project(c),f=s.project(u),m=this.queryTerrainElevation(c),g=this.queryTerrainElevation(u),_=this.queryTerrainElevation(h),y=this.queryTerrainElevation(d),x=[[p.x,p.y,Math.min(m||0,g||0,_||0,y||0)],[f.x,f.y,Math.max(m||0,g||0,_||0,y||0)]];let v=t.b6.fromPoints(x);const b=s.getWorldToCameraMatrix(),w=t.ad.invert(new Float64Array(16),b);v=t.b6.applyTransform(v,b);const A=this._extendAABB(v,s,l,a);if(!A)return void t.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");v=A;const C=.5*t._.sub([],v.max,v.min)[2],E=this._minimumAABBFrustumDistance(s,v),T=[0,0,1,0];t.aA.transformMat4(T,T,b),t.aA.normalize(T,T);const S=t._.scale([],T,E+C),M=t._.add([],v.center,S);t._.transformMat4(v.center,v.center,w),t._.transformMat4(M,M,w);const k=[v.center[0],v.center[1],M[2]*s.pixelsPerMeter];t._.scale(k,k,1/s.worldSize);const I=t.d6(k[0]),P=t.ay(k[1]),z=Math.min(s._zoomFromMercatorZ(k[2]),l.maxZoom),D=new t.aI(I,P);return s.mercatorFromTransition&&z<.5*(t.b1+t.aU)?(s.setProjection({name:"globe"}),s.zoom=z,this._cameraForBounds(s,n,i,a,r,o)):{center:D,zoom:z,bearing:a,pitch:r}}fitBounds(t,e,n){const i=this.cameraForBounds(t,e);return this._fitInternal(i,e,n)}fitScreenCoordinates(e,n,i,a,r){const o=t.P.convert(e),s=t.P.convert(n),l=new t.P(Math.min(o.x,s.x),Math.min(o.y,s.y)),c=new t.P(Math.max(o.x,s.x),Math.max(o.y,s.y));if("mercator"===this.transform.projection.name&&this.transform.anyCornerOffEdge(o,s))return this;const u=this.transform.pointLocation3D(l),h=this.transform.pointLocation3D(c),d=this.transform.pointLocation3D(new t.P(l.x,c.y)),p=this.transform.pointLocation3D(new t.P(c.x,l.y)),f=[Math.min(u.lng,h.lng,d.lng,p.lng),Math.min(u.lat,h.lat,d.lat,p.lat)],m=[Math.max(u.lng,h.lng,d.lng,p.lng),Math.max(u.lat,h.lat,d.lat,p.lat)],g=a&&a.pitch?a.pitch:this.getPitch(),_=this._cameraForBounds(this.transform,f,m,i,g,a);return this._fitInternal(_,a,r)}_fitInternal(e,n,i){return e?(n=t.W(e,n)).linear?this.easeTo(n,i):this.flyTo(n,i):this}jumpTo(e,n){this.stop();const i=e.preloadOnly?this.transform.clone():this.transform;let a=!1,r=!1,o=!1;return"zoom"in e&&i.zoom!==+e.zoom&&(a=!0,i.zoom=+e.zoom),void 0!==e.center&&(i.center=t.aI.convert(e.center)),"bearing"in e&&i.bearing!==+e.bearing&&(r=!0,i.bearing=+e.bearing),"pitch"in e&&i.pitch!==+e.pitch&&(o=!0,i.pitch=+e.pitch),null==e.padding||i.isPaddingEqual(e.padding)||(i.padding=e.padding),e.preloadOnly?(this._preloadTiles(i),this):(this.fire(new t.f("movestart",n)).fire(new t.f("move",n)),a&&this.fire(new t.f("zoomstart",n)).fire(new t.f("zoom",n)).fire(new t.f("zoomend",n)),r&&this.fire(new t.f("rotatestart",n)).fire(new t.f("rotate",n)).fire(new t.f("rotateend",n)),o&&this.fire(new t.f("pitchstart",n)).fire(new t.f("pitch",n)).fire(new t.f("pitchend",n)),this.fire(new t.f("moveend",n)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||t.w(Do),this.transform.getFreeCameraOptions()}setFreeCameraOptions(e,n){const i=this.transform;if(!i.projection.supportsFreeCamera)return t.w(Do),this;this.stop();const a=i.zoom,r=i.pitch,o=i.bearing;i.setFreeCameraOptions(e);const s=a!==i.zoom,l=r!==i.pitch,c=o!==i.bearing;return this.fire(new t.f("movestart",n)).fire(new t.f("move",n)),s&&this.fire(new t.f("zoomstart",n)).fire(new t.f("zoom",n)).fire(new t.f("zoomend",n)),c&&this.fire(new t.f("rotatestart",n)).fire(new t.f("rotate",n)).fire(new t.f("rotateend",n)),l&&this.fire(new t.f("pitchstart",n)).fire(new t.f("pitch",n)).fire(new t.f("pitchend",n)),this.fire(new t.f("moveend",n)),this}easeTo(e,n){this._stop(!1,e.easeId),(!1===(e=t.W({offset:[0,0],duration:500,easing:t.d2},e)).animate||this._prefersReducedMotion(e))&&(e.duration=0);const i=this.transform,a=this.getZoom(),r=this.getBearing(),o=this.getPitch(),s=this.getPadding(),l="zoom"in e?+e.zoom:a,c="bearing"in e?this._normalizeBearing(e.bearing,r):r,u="pitch"in e?+e.pitch:o,h=this._extendPadding(e.padding),d=t.P.convert(e.offset);let p,f,m;if("globe"===i.projection.name){const n=t.Y.fromLngLat(i.center),a=d.rotate(-i.angle);n.x+=a.x/i.worldSize,n.y+=a.y/i.worldSize;const r=n.toLngLat(),o=t.aI.convert(e.center||r);this._normalizeCenter(o),p=i.centerPoint.add(a),f=new t.P(n.x,n.y).mult(i.worldSize),m=new t.P(t.aj(o.lng),t.ak(o.lat)).mult(i.worldSize).sub(f)}else{p=i.centerPoint.add(d);const n=i.pointLocation(p),a=t.aI.convert(e.center||n);this._normalizeCenter(a),f=i.project(n),m=i.project(a).sub(f)}const g=i.zoomScale(l-a);let _,y;e.around&&(_=t.aI.convert(e.around),y=i.locationPoint(_));const x=this._zooming||l!==a,v=this._rotating||r!==c,b=this._pitching||u!==o,w=!i.isPaddingEqual(h),A=i=>A=>{if(x&&(i.zoom=t.a2(a,l,A)),v&&(i.bearing=t.a2(r,c,A)),b&&(i.pitch=t.a2(o,u,A)),w&&(i.interpolatePadding(s,h,A),p=i.centerPoint.add(d)),_)i.setLocationAtPoint(_,y);else{const t=i.zoomScale(i.zoom-a),e=l>a?Math.min(2,g):Math.max(.5,g),n=Math.pow(e,1-A),r=i.unproject(f.add(m.mult(A*n)).mult(t));i.setLocationAtPoint(i.renderWorldCopies?r.wrap():r,p)}return e.preloadOnly||this._fireMoveEvents(n),i};if(e.preloadOnly){const t=this._emulate(A,e.duration,i);return this._preloadTiles(t),this}const C={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=x,this._rotating=v,this._pitching=b,this._padding=w,this._easeId=e.easeId,this._prepareEase(n,e.noMoveStart,C),this._ease(A(i),(t=>{"sea"===i.cameraElevationReference&&i.recenterOnTerrain(),this._afterEase(n,t)}),e),this}_prepareEase(e,n,i={}){this._moving=!0,this.transform.cameraElevationReference="sea",this.transform._orthographicProjectionAtLowPitch&&0===this.transform.pitch&&"globe"!==this.transform.projection.name&&(this.transform.cameraElevationReference="ground"),n||i.moving||this.fire(new t.f("movestart",e)),this._zooming&&!i.zooming&&this.fire(new t.f("zoomstart",e)),this._rotating&&!i.rotating&&this.fire(new t.f("rotatestart",e)),this._pitching&&!i.pitching&&this.fire(new t.f("pitchstart",e))}_fireMoveEvents(e){this.fire(new t.f("move",e)),this._zooming&&this.fire(new t.f("zoom",e)),this._rotating&&this.fire(new t.f("rotate",e)),this._pitching&&this.fire(new t.f("pitch",e))}_afterEase(e,n){if(this._easeId&&n&&this._easeId===n)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const i=this._zooming,a=this._rotating,r=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,i&&this.fire(new t.f("zoomend",e)),a&&this.fire(new t.f("rotateend",e)),r&&this.fire(new t.f("pitchend",e)),this.fire(new t.f("moveend",e))}flyTo(e,n){if(this._prefersReducedMotion(e)){const i=t.ah(e,["center","zoom","bearing","pitch","around","padding"]);return this.jumpTo(i,n)}this.stop(),e=t.W({offset:[0,0],speed:1.2,curve:1.42,easing:t.d2},e);const i=this.transform,a=this.getZoom(),r=this.getBearing(),o=this.getPitch(),s=this.getPadding(),l="zoom"in e?t.at(+e.zoom,i.minZoom,i.maxZoom):a,c="bearing"in e?this._normalizeBearing(e.bearing,r):r,u="pitch"in e?+e.pitch:o,h=this._extendPadding(e.padding),d=i.zoomScale(l-a),p=t.P.convert(e.offset);let f=i.centerPoint.add(p);const m=i.pointLocation(f),g=t.aI.convert(e.center||m);this._normalizeCenter(g);const _=i.project(m),y=i.project(g).sub(_);let x=e.curve;const v=Math.max(i.width,i.height),b=v/d,w=y.mag();if("minZoom"in e){const n=t.at(Math.min(e.minZoom,a,l),i.minZoom,i.maxZoom),r=v/i.zoomScale(n-a);x=Math.sqrt(r/w*2)}const A=x*x;function C(t){const e=(b*b-v*v+(t?-1:1)*A*A*w*w)/(2*(t?b:v)*A*w);return Math.log(Math.sqrt(e*e+1)-e)}function E(t){return(Math.exp(t)-Math.exp(-t))/2}function T(t){return(Math.exp(t)+Math.exp(-t))/2}const S=C(0);let M=function(t){return T(S)/T(S+x*t)},k=function(t){return v*((T(S)*(E(e=S+x*t)/T(e))-E(S))/A)/w;var e},I=(C(1)-S)/x;if(Math.abs(w)<1e-6||!isFinite(I)){if(Math.abs(v-b)<1e-6)return this.easeTo(e,n);const t=b<v?-1:1;I=Math.abs(Math.log(b/v))/x,k=function(){return 0},M=function(e){return Math.exp(t*x*e)}}e.duration="duration"in e?+e.duration:1e3*I/("screenSpeed"in e?+e.screenSpeed/x:+e.speed),e.maxDuration&&e.duration>e.maxDuration&&(e.duration=0);const P=r!==c,z=u!==o,D=!i.isPaddingEqual(h),L=i=>d=>{const m=d*I,x=1/M(m);i.zoom=1===d?l:a+i.scaleZoom(x),P&&(i.bearing=t.a2(r,c,d)),z&&(i.pitch=t.a2(o,u,d)),D&&(i.interpolatePadding(s,h,d),f=i.centerPoint.add(p));const v=1===d?g:i.unproject(_.add(y.mult(k(m))).mult(x));return i.setLocationAtPoint(i.renderWorldCopies?v.wrap():v,f),i._updateCameraOnTerrain(),e.preloadOnly||this._fireMoveEvents(n),i};if(e.preloadOnly){const t=this._emulate(L,e.duration,i);return this._preloadTiles(t),this}return this._zooming=!0,this._rotating=P,this._pitching=z,this._padding=D,this._prepareEase(n,!1),this._ease(L(i),(()=>this._afterEase(n)),e),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_requestRenderFrame(t){}_cancelRenderFrame(t){}_stop(t,e){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const t=this._onEaseEnd;this._onEaseEnd=void 0,t.call(this,e)}if(!t){const t=this.handlers;t&&t.stop(!1)}return this}_ease(e,n,i){!1===i.animate||0===i.duration?(e(1),n()):(this._easeStart=t.e.now(),this._easeOptions=i,this._onEaseFrame=e,this._onEaseEnd=n,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const e=Math.min((t.e.now()-this._easeStart)/this._easeOptions.duration,1),n=this._onEaseFrame;n&&n(this._easeOptions.easing(e)),e<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(e,n){e=t.au(e,-180,180);const i=Math.abs(e-n);return Math.abs(e-360-n)<i&&(e-=360),Math.abs(e+360-n)<i&&(e+=360),e}_normalizeCenter(t){const e=this.transform;if(e.maxBounds)return;if("globe"!==e.projection.name&&!e.renderWorldCopies)return;const n=t.lng-e.center.lng;t.lng+=n>180?-360:n<-180?360:0}_prefersReducedMotion(e){return this._respectPrefersReducedMotion&&t.e.prefersReducedMotion&&!(e&&e.essential)}_emulate(t,e,n){const i=Math.ceil(15*e/1e3),a=[],r=t(n.clone());for(let t=0;t<=i;t++){const e=r(t/i);a.push(e.clone())}return a}_preloadTiles(t,e){}}class Bo{constructor(e={}){this.options=e,t.bp(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(t){const e=this.options&&this.options.compact;return this._map=t,this._container=r("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=r("button","mapboxgl-ctrl-attrib-button",this._container),r("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden","true"),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=r("div","mapboxgl-ctrl-attrib-inner",this._container),e&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),void 0===e&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(t,e){const n=this._map._getUIString(`AttributionControl.${e}`);t.removeAttribute("title"),t.firstElementChild&&t.firstElementChild.setAttribute("title",n)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let e=this._editLink;e||(e=this._editLink=this._container.querySelector(".mapbox-improve-map"));const n=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||t.d8.ACCESS_TOKEN}];if(e){const i=n.reduce(((t,e,i)=>(e.value&&(t+=`${e.key}=${e.value}${i<n.length-1?"&":""}`),t)),"?");e.href=`${t.d8.FEEDBACK_URL}/${i}#${Or(this._map,!0)}`,e.rel="noopener nofollow",this._setElementTitle(e,"MapFeedback")}}_updateData(t){!t||"metadata"!==t.sourceDataType&&"visibility"!==t.sourceDataType&&"style"!==t.dataType||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let t=[];if(this._map.style.stylesheet){const t=this._map.style.stylesheet;this.styleOwner=t.owner,this.styleId=t.id}const e=this._map.style._mergedSourceCaches;for(const n in e){const i=e[n];if(i.used){const e=i.getSource();e.attribution&&t.indexOf(e.attribution)<0&&t.push(e.attribution)}}t.sort(((t,e)=>t.length-e.length)),t=t.filter(((e,n)=>{for(let i=n+1;i<t.length;i++)if(t[i].indexOf(e)>=0)return!1;return!0})),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?t=[...this.options.customAttribution,...t]:t.unshift(this.options.customAttribution));const n=t.join(" | ");n!==this._attribHTML&&(this._attribHTML=n,t.length?(this._innerContainer.innerHTML=n,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class Oo{constructor(){t.bp(["_updateLogo","_updateCompact"],this)}onAdd(t){this._map=t,this._container=r("div","mapboxgl-ctrl");const e=r("a","mapboxgl-ctrl-logo");return e.target="_blank",e.rel="noopener nofollow",e.href="https://www.mapbox.com/",e.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),e.setAttribute("rel","noopener nofollow"),this._container.appendChild(e),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(t){t&&"metadata"!==t.sourceDataType||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const t=this._map.style._sourceCaches;if(0===Object.entries(t).length)return!0;for(const e in t){const n=t[e].getSource();if(n.hasOwnProperty("mapbox_logo")&&!n.mapbox_logo)return!1}return!0}_updateCompact(){const t=this._container.children;if(t.length){const e=t[0];this._map.getCanvasContainer().offsetWidth<250?e.classList.add("mapboxgl-compact"):e.classList.remove("mapboxgl-compact")}}}class Ro{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(t){const e=++this._id;return this._queue.push({callback:t,id:e,cancelled:!1}),e}remove(t){const e=this._currentlyRunning,n=e?this._queue.concat(e):this._queue;for(const e of n)if(e.id===t)return void(e.cancelled=!0)}run(t=0){const e=this._currentlyRunning=this._queue;this._queue=[];for(const n of e)if(!n.cancelled&&(n.callback(t),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function Fo(e,n,i){if(e=new t.aI(e.lng,e.lat),n){const a=new t.aI(e.lng-360,e.lat),r=new t.aI(e.lng+360,e.lat),o=360*Math.ceil(Math.abs(e.lng-i.center.lng)/360),s=i.locationPoint(e).distSqr(n),l=n.x<0||n.y<0||n.x>i.width||n.y>i.height;i.locationPoint(a).distSqr(n)<s&&(l||Math.abs(a.lng-i.center.lng)<o)?e=a:i.locationPoint(r).distSqr(n)<s&&(l||Math.abs(r.lng-i.center.lng)<o)&&(e=r)}for(;Math.abs(e.lng-i.center.lng)>180;){const t=i.locationPoint(e);if(t.x>=0&&t.y>=0&&t.x<=i.width&&t.y<=i.height)break;e.lng>i.center.lng?e.lng-=360:e.lng+=360}return e}const No={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class jo extends t.E{constructor(e,n){if(super(),(e instanceof HTMLElement||n)&&(e=t.W({element:e},n)),t.bp(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=e&&e.anchor||"center",this._color=e&&e.color||"#3FB1CE",this._scale=e&&e.scale||1,this._draggable=e&&e.draggable||!1,this._clickTolerance=e&&e.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=e&&e.rotation||0,this._rotationAlignment=e&&e.rotationAlignment||"auto",this._pitchAlignment=e&&e.pitchAlignment&&e.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=e&&e.occludedOpacity||.2,e&&e.element)this._element=e.element,this._offset=t.P.convert(e&&e.offset||[0,0]);else{this._defaultMarker=!0,this._element=r("div");const n=41,i=27,a=o("svg",{display:"block",height:n*this._scale+"px",width:i*this._scale+"px",viewBox:`0 0 ${i} ${n}`},this._element),s=o("radialGradient",{id:"shadowGradient"},o("defs",{},a));o("stop",{offset:"10%","stop-opacity":.4},s),o("stop",{offset:"100%","stop-opacity":.05},s),o("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},a),o("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},a),o("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},a),o("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},a),this._offset=t.P.convert(e&&e.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.hasAttribute("role")||this._element.setAttribute("role","img"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",(t=>{t.preventDefault()})),this._element.addEventListener("mousedown",(t=>{t.preventDefault()}));const i=this._element.classList;for(const t in No)i.remove(`mapboxgl-marker-anchor-${t}`);i.add(`mapboxgl-marker-anchor-${this._anchor}`);const a=e&&e.className?e.className.trim().split(/\s+/):[];i.add(...a),this._popup=null}addTo(t){return t===this._map||(this.remove(),this._map=t,t.getCanvasContainer().appendChild(this._element),t.on("move",this._updateMoving),t.on("moveend",this._update),t.on("remove",this._clearFadeTimer),t._addMarker(this),this.setDraggable(this._draggable),this._update(),t.on("click",this._onMapClick)),this}remove(){const t=this._map;return t&&(t.off("click",this._onMapClick),t.off("move",this._updateMoving),t.off("moveend",this._update),t.off("mousedown",this._addDragHandler),t.off("touchstart",this._addDragHandler),t.off("mouseup",this._onUp),t.off("touchend",this._onUp),t.off("mousemove",this._onMove),t.off("touchmove",this._onMove),t.off("remove",this._clearFadeTimer),t._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(e){return this._lngLat=t.aI.convert(e),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(t){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),t){if(!("offset"in t.options)){const e=38.1,n=13.5,i=Math.sqrt(Math.pow(n,2)/2);t.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-e],"bottom-left":[i,-1*(e-n+i)],"bottom-right":[-i,-1*(e-n+i)],left:[n,-1*(e-n)],right:[-n,-1*(e-n)]}:this._offset}this._popup=t,t._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(t){const e=t.code,n=t.charCode||t.keyCode;"Space"!==e&&"Enter"!==e&&32!==n&&13!==n||this.togglePopup()}_onMapClick(t){const e=t.originalEvent.target,n=this._element;this._popup&&(e===n||n.contains(e))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const t=this._popup;return t?(t.isOpen()?(t.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(t.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const t=this._map,e=this._pos;if(!t||!e)return!1;const n=t.unproject(e),i=t.getFreeCameraOptions();if(!i.position)return!1;const a=i.position.toLngLat();return a.distanceTo(n)<.9*a.distanceTo(this._lngLat)}_evaluateOpacity(){const e=this._map;if(!e)return;const n=this._pos;if(!n||n.x<0||n.x>e.transform.width||n.y<0||n.y>e.transform.height)return void this._clearFadeTimer();const i=e.unproject(n);let a;e._showingGlobe()&&t.d9(e.transform,this._lngLat)?a=0:(a=1-e._queryFogOpacity(i),e.transform._terrainEnabled()&&e.getTerrain()&&this._behindTerrain()&&(a*=this._occludedOpacity)),this._element.style.opacity=`${a}`,this._element.style.pointerEvents=a>0?"auto":"none",this._popup&&this._popup._setOpacity(a),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const t=this._pos;if(!t||!this._map)return;const e=this._offset.mult(this._scale);this._element.style.transform=`\n            translate(${t.x}px,${t.y}px)\n            ${No[this._anchor]}\n            ${this._calculateXYTransform()} ${this._calculateZTransform()}\n            translate(${e.x}px,${e.y}px)\n        `}_calculateXYTransform(){const e=this._pos,n=this._map,i=this.getPitchAlignment();if(!n||!e||"map"!==i)return"";if(!n._showingGlobe()){const t=n.getPitch();return t?`rotateX(${t}deg)`:""}const a=t.b0(t.da(n.transform,this._lngLat)),r=e.sub(t.db(n.transform)),o=Math.abs(r.x)+Math.abs(r.y);if(0===o)return"";const s=a/o;return`rotateX(${-r.y*s}deg) rotateY(${r.x*s}deg)`}_calculateZTransform(){const e=this._pos,n=this._map;if(!n||!e)return"";let i=0;const a=this.getRotationAlignment();if("map"===a)if(n._showingGlobe()){const e=n.project(new t.aI(this._lngLat.lng,this._lngLat.lat+.001)),a=n.project(new t.aI(this._lngLat.lng,this._lngLat.lat-.001)).sub(e);i=t.b0(Math.atan2(a.y,a.x))-90}else i=-n.getBearing();else if("horizon"===a){const a=t.$(4,6,n.getZoom()),r=t.db(n.transform);r.y+=a*n.transform.height;const o=e.sub(r),s=t.b0(Math.atan2(o.y,o.x));i=(s>90?s-270:s+90)*(1-a)}return i+=this._rotation,i?`rotateZ(${i}deg)`:""}_update(t){cancelAnimationFrame(this._updateFrameId);const e=this._map;e&&(e.transform.renderWorldCopies&&(this._lngLat=Fo(this._lngLat,this._pos,e.transform)),this._pos=e.project(this._lngLat),!0===t?this._updateFrameId=requestAnimationFrame((()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())})):this._pos=this._pos.round(),e._requestDomTask((()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(e._showingGlobe()||e.getTerrain()||e.getFog())&&!this._fadeTimer&&(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))})))}getOffset(){return this._offset}setOffset(e){return this._offset=t.P.convert(e),this._update(),this}addClassName(t){return this._element.classList.add(t),this}removeClassName(t){return this._element.classList.remove(t),this}toggleClassName(t){return this._element.classList.toggle(t)}_onMove(e){const n=this._map;if(!n)return;const i=this._pointerdownPos,a=this._positionDelta;if(i&&a){if(!this._isDragging){const t=this._clickTolerance||n._clickTolerance;if(e.point.dist(i)<t)return;this._isDragging=!0}this._pos=e.point.sub(a),this._lngLat=n.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new t.f("dragstart"))),this.fire(new t.f("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const e=this._map;e&&(e.off("mousemove",this._onMove),e.off("touchmove",this._onMove)),"active"===this._state&&this.fire(new t.f("dragend")),this._state="inactive"}_addDragHandler(t){const e=this._map,n=this._pos;e&&n&&this._element.contains(t.originalEvent.target)&&(t.preventDefault(),this._positionDelta=t.point.sub(n),this._pointerdownPos=t.point,this._state="pending",e.on("mousemove",this._onMove),e.on("touchmove",this._onMove),e.once("mouseup",this._onUp),e.once("touchend",this._onUp))}setDraggable(t){this._draggable=!!t;const e=this._map;return e&&(t?(e.on("mousedown",this._addDragHandler),e.on("touchstart",this._addDragHandler)):(e.off("mousedown",this._addDragHandler),e.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(t){return this._rotation=t||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(t){return this._rotationAlignment=t||"auto",this._update(),this}getRotationAlignment(){return"auto"===this._rotationAlignment||"horizon"===this._rotationAlignment&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(t){return this._pitchAlignment=t||"auto",this._update(),this}getPitchAlignment(){return"auto"===this._pitchAlignment?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(t){return this._occludedOpacity=t||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const Vo={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Uo=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Go(e=new t.P(0,0),n="bottom"){if("number"==typeof e){const i=Math.round(Math.sqrt(.5*Math.pow(e,2)));switch(n){case"top":return new t.P(0,e);case"top-left":return new t.P(i,i);case"top-right":return new t.P(-i,i);case"bottom":return new t.P(0,-e);case"bottom-left":return new t.P(i,-i);case"bottom-right":return new t.P(-i,-i);case"left":return new t.P(e,0);case"right":return new t.P(-e,0)}return new t.P(0,0)}return e instanceof t.P||Array.isArray(e)?t.P.convert(e):t.P.convert(e[n]||[0,0])}class qo{constructor(t){this.jumpTo(t)}getValue(e){if(e<=this._startTime)return this._start;if(e>=this._endTime)return this._end;const n=t.b9((e-this._startTime)/(this._endTime-this._startTime));return this._start*(1-n)+this._end*n}isEasing(t){return t>=this._startTime&&t<=this._endTime}jumpTo(t){this._startTime=-1/0,this._endTime=-1/0,this._start=t,this._end=t}easeTo(t,e,n){this._start=this.getValue(e),this._end=t,this._startTime=e,this._endTime=e+n}}const $o={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use ⌘ + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"};class Wo{registerParameter(){}registerButton(){}registerBinding(){}refreshUI(){}}const Ho={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,antialias:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0,collectResourceTiming:!1,testMode:!1},Zo={showCompass:!0,showZoom:!0,visualizePitch:!1};class Yo{constructor(e,n,i=!1){this._clickTolerance=10,this.element=n,this.mouseRotate=new ao({clickTolerance:e.dragRotate._mouseRotate._clickTolerance}),this.map=e,i&&(this.mousePitch=new ro({clickTolerance:e.dragRotate._mousePitch._clickTolerance})),t.bp(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),n.addEventListener("mousedown",this.mousedown),n.addEventListener("touchstart",this.touchstart,{passive:!1}),n.addEventListener("touchmove",this.touchmove),n.addEventListener("touchend",this.touchend),n.addEventListener("touchcancel",this.reset)}down(t,e){this.mouseRotate.mousedown(t,e),this.mousePitch&&this.mousePitch.mousedown(t,e),u()}move(t,e){const n=this.map,i=this.mouseRotate.mousemoveWindow(t,e),a=i&&i.bearingDelta;if(a&&n.setBearing(n.getBearing()+a),this.mousePitch){const i=this.mousePitch.mousemoveWindow(t,e),a=i&&i.pitchDelta;a&&n.setPitch(n.getPitch()+a)}}off(){const t=this.element;t.removeEventListener("mousedown",this.mousedown),t.removeEventListener("touchstart",this.touchstart,{passive:!1}),t.removeEventListener("touchmove",this.touchmove),t.removeEventListener("touchend",this.touchend),t.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){h(),window.removeEventListener("mousemove",this.mousemove),window.removeEventListener("mouseup",this.mouseup)}mousedown(e){this.down(t.W({},e,{ctrlKey:!0,preventDefault:()=>e.preventDefault()}),f(this.element,e)),window.addEventListener("mousemove",this.mousemove),window.addEventListener("mouseup",this.mouseup)}mousemove(t){this.move(t,f(this.element,t))}mouseup(t){this.mouseRotate.mouseupWindow(t),this.mousePitch&&this.mousePitch.mouseupWindow(t),this.offTemp()}touchstart(t){1!==t.targetTouches.length?this.reset():(this._startPos=this._lastPos=m(this.element,t.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>t.preventDefault()},this._startPos))}touchmove(t){1!==t.targetTouches.length?this.reset():(this._lastPos=m(this.element,t.targetTouches)[0],this.move({preventDefault:()=>t.preventDefault()},this._lastPos))}touchend(t){0===t.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const Xo={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},Ko={maxWidth:100,unit:"metric"},Qo={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"},Jo={version:t.dt,supported:n,setRTLTextPlugin:t.dv,getRTLTextPluginStatus:t.dw,Map:class extends Lo{constructor(e){t.dc.mark(t.dd.create);const n=e;if(null!=(e=t.W({},Ho,e)).minZoom&&null!=e.maxZoom&&e.minZoom>e.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=e.minPitch&&null!=e.maxPitch&&e.minPitch>e.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=e.minPitch&&e.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(null!=e.maxPitch&&e.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(e.antialias&&t.de(window)&&(e.antialias=!1,t.w("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new mn(e.minZoom,e.maxZoom,e.minPitch,e.maxPitch,e.renderWorldCopies),e),this._repaint=!!e.repaint,this._interactive=e.interactive,this._minTileCacheSize=e.minTileCacheSize,this._maxTileCacheSize=e.maxTileCacheSize,this._failIfMajorPerformanceCaveat=e.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=e.preserveDrawingBuffer,this._antialias=e.antialias,this._trackResize=e.trackResize,this._bearingSnap=e.bearingSnap,this._refreshExpiredTiles=e.refreshExpiredTiles,this._fadeDuration=e.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=e.crossSourceCollisions,this._collectResourceTiming=e.collectResourceTiming,this._language=this._parseLanguage(e.language),this._worldview=e.worldview,this._renderTaskQueue=new Ro,this._domRenderTaskQueue=new Ro,this._controls=[],this._markers=[],this._popups=[],this._mapId=t.df(),this._locale=t.W({},$o,e.locale),this._clickTolerance=e.clickTolerance,this._cooperativeGestures=e.cooperativeGestures,this._performanceMetricsCollection=e.performanceMetricsCollection,this._tessellationStep=e.tessellationStep,this._containerWidth=0,this._containerHeight=0,this._showParseStatus=!0,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new qo(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._frameId=0,this._lastDirtyFrameId=0,this._requestManager=new t.dg(e.transformRequest,e.accessToken,e.testMode),this._silenceAuthErrors=!!e.testMode,this._contextCreateOptions=e.contextCreateOptions?{...e.contextCreateOptions}:{},"string"==typeof e.container){const t=document.getElementById(e.container);if(!t)throw new Error(`Container '${e.container.toString()}' not found.`);this._container=t}else{if(!(e.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=e.container}if(this._container.childNodes.length>0&&t.w("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),e.maxBounds&&this.setMaxBounds(e.maxBounds),t.bp(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._tp||(this._tp=new Wo),this._tp.registerParameter(this,["Debug"],"showOverdrawInspector"),this._tp.registerParameter(this,["Debug"],"showTileBoundaries"),this._tp.registerParameter(this,["Debug"],"showParseStatus"),this._tp.registerParameter(this,["Debug"],"repaint"),this._tp.registerParameter(this,["Debug"],"showTileAABBs"),this._tp.registerParameter(this,["Debug"],"showPadding"),this._tp.registerParameter(this,["Debug"],"showCollisionBoxes",{noSave:!0}),this._tp.registerParameter(this.transform,["Debug"],"freezeTileCoverage",{noSave:!0},(()=>{this._update()})),this._tp.registerParameter(this,["Debug","Wireframe"],"showTerrainWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers2DWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers3DWireframe"),this._setupPainter(),void 0===this.painter)throw new Error("Failed to initialize WebGL.");if(this.on("move",(()=>this._update(!1))),this.on("moveend",(()=>this._update(!1))),this.on("zoom",(()=>this._update(!0))),this._fullscreenchangeEvent="onfullscreenchange"in document?"fullscreenchange":"webkitfullscreenchange",window.addEventListener("online",this._onWindowOnline,!1),window.addEventListener("resize",this._onWindowResize,!1),window.addEventListener("orientationchange",this._onWindowResize,!1),window.addEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.addEventListener("visibilitychange",this._onVisibilityChange,!1),this.handlers=new zo(this,e),this._localFontFamily=e.localFontFamily,this._localIdeographFontFamily=e.localIdeographFontFamily,(e.style||!e.testMode)&&this.setStyle(e.style||t.d8.DEFAULT_STYLE,{config:e.config,localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),e.projection&&this.setProjection(e.projection),e.hash&&(this._hash=new Br("string"==typeof e.hash&&e.hash||void 0).addTo(this)),!this._hash||!this._hash._onHashChange()){null==n.center&&null==n.zoom||(this.transform._unmodified=!1),this.jumpTo({center:e.center,zoom:e.zoom,bearing:e.bearing,pitch:e.pitch});const i=e.bounds;i&&(this.resize(),this.fitBounds(i,t.W({},e.fitBoundsOptions,{duration:0})))}this.resize(),e.attributionControl&&this.addControl(new Bo({customAttribution:e.customAttribution})),this._logoControl=new Oo,this.addControl(this._logoControl,e.logoPosition),this.on("style.load",(()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet),this._postStyleLoadEvent()})),this.on("data",(e=>{this._update("style"===e.dataType),this.fire(new t.f(`${e.dataType}data`,e))})),this.on("dataloading",(e=>{this.fire(new t.f(`${e.dataType}dataloading`,e))}))}_getMapId(){return this._mapId}addControl(e,n){if(void 0===n&&(n=e.getDefaultPosition?e.getDefaultPosition():"top-right"),!e||!e.onAdd)return this.fire(new t.d(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const i=e.onAdd(this);this._controls.push(e);const a=this._controlPositions[n];return-1!==n.indexOf("bottom")?a.insertBefore(i,a.firstChild):a.appendChild(i),this}removeControl(e){if(!e||!e.onRemove)return this.fire(new t.d(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const n=this._controls.indexOf(e);return n>-1&&this._controls.splice(n,1),e.onRemove(this),this}hasControl(t){return this._controls.indexOf(t)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(e){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const n=!this._moving;return n&&this.fire(new t.f("movestart",e)).fire(new t.f("move",e)),this.fire(new t.f("resize",e)),n&&this.fire(new t.f("moveend",e)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(e){return this.transform.setMaxBounds(t.ai.convert(e)),this._update()}setMinZoom(e){if((e=e??-2)>=-2&&e<=this.transform.maxZoom)return this.transform.minZoom=e,this._update(),this.getZoom()<e?this.setZoom(e):this.fire(new t.f("zoomstart")).fire(new t.f("zoom")).fire(new t.f("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(e){if((e=e??22)>=this.transform.minZoom)return this.transform.maxZoom=e,this._update(),this.getZoom()>e?this.setZoom(e):this.fire(new t.f("zoomstart")).fire(new t.f("zoom")).fire(new t.f("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(e){if((e=e??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(e>=0&&e<=this.transform.maxPitch)return this.transform.minPitch=e,this._update(),this.getPitch()<e?this.setPitch(e):this.fire(new t.f("pitchstart")).fire(new t.f("pitch")).fire(new t.f("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(e){if((e=e??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(e>=this.transform.minPitch)return this.transform.maxPitch=e,this._update(),this.getPitch()>e?this.setPitch(e):this.fire(new t.f("pitchstart")).fire(new t.f("pitch")).fire(new t.f("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(t){return this.transform.renderWorldCopies=t,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(t){return"auto"===t?navigator.language:Array.isArray(t)?0===t.length?void 0:t.map((t=>"auto"===t?navigator.language:t)):t}setLanguage(t){const e=this._parseLanguage(t);if(!this.style||e===this._language)return this;this._language=e,this.style.reloadSources();for(const t of this._controls)t._setLanguage&&t._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(t){return this.style&&t!==this._worldview?(this._worldview=t,this.style.reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return"globe"===this.transform.projection.name}setProjection(t){return this._lazyInitEmptyStyle(),t?"string"==typeof t&&(t={name:t}):t=null,this._useExplicitProjection=!!t,this._prioritizeAndUpdateProjection(t,this.style.projection)}_updateProjectionTransition(){if("globe"!==this.getProjection().name)return;const e=this.transform,n=e.projection.name;let i;"globe"===n&&e.zoom>=t.aU?(e.setMercatorFromTransition(),i=!0):"mercator"===n&&e.zoom<t.aU&&(e.setProjection({name:"globe"}),i=!0),i&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(t,e){return this._updateProjection(t||e||{name:"mercator"})}_updateProjection(e){let n;return n="globe"===e.name&&this.transform.zoom>=t.aU?this.transform.setMercatorFromTransition():this.transform.setProjection(e),this.style.applyProjectionUpdate(),n&&(this.painter.clearBackgroundTiles(),this.style.clearSources(),this._update(!0),this._forceMarkerAndPopupUpdate(!0)),this}project(e){return this.transform.locationPoint3D(t.aI.convert(e))}unproject(e){return this.transform.pointLocation3D(t.P.convert(e))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(t,e,n){if("mouseenter"===t||"mouseover"===t){let i=!1;const a=a=>{const r=e.filter((t=>this.getLayer(t))),o=r.length?this.queryRenderedFeatures(a.point,{layers:r}):[];o.length?i||(i=!0,n.call(this,new $r(t,this,a.originalEvent,{features:o}))):i=!1},r=()=>{i=!1};return{layers:new Set(e),listener:n,delegates:{mousemove:a,mouseout:r}}}if("mouseleave"===t||"mouseout"===t){let i=!1;const a=a=>{const r=e.filter((t=>this.getLayer(t)));(r.length?this.queryRenderedFeatures(a.point,{layers:r}):[]).length?i=!0:i&&(i=!1,n.call(this,new $r(t,this,a.originalEvent)))},r=e=>{i&&(i=!1,n.call(this,new $r(t,this,e.originalEvent)))};return{layers:new Set(e),listener:n,delegates:{mousemove:a,mouseout:r}}}{const i=t=>{const i=e.filter((t=>this.getLayer(t))),a=i.length?this.queryRenderedFeatures(t.point,{layers:i}):[];a.length&&(t.features=a,n.call(this,t),delete t.features)};return{layers:new Set(e),listener:n,delegates:{[t]:i}}}}on(t,e,n){if("function"==typeof e||void 0===n)return super.on(t,e);if(Array.isArray(e)||(e=[e]),e)for(const t of e)if(!this._isValidId(t))return this;const i=this._createDelegatedListener(t,e,n);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[t]=this._delegatedListeners[t]||[],this._delegatedListeners[t].push(i);for(const t in i.delegates)this.on(t,i.delegates[t]);return this}once(t,e,n){if("function"==typeof e||void 0===n)return super.once(t,e);if(Array.isArray(e)||(e=[e]),e)for(const t of e)if(!this._isValidId(t))return this;const i=this._createDelegatedListener(t,e,n);for(const t in i.delegates)this.once(t,i.delegates[t]);return this}off(t,e,n){if("function"==typeof e||void 0===n)return super.off(t,e);const i=new Set(Array.isArray(e)?e:[e]);for(const t of i)if(!this._isValidId(t))return this;const a=(t,e)=>{if(t.size!==e.size)return!1;for(const n of t)if(!e.has(n))return!1;return!0},r=this._delegatedListeners?this._delegatedListeners[t]:void 0;return r&&(t=>{for(let e=0;e<t.length;e++){const r=t[e];if(r.listener===n&&a(r.layers,i)){for(const t in r.delegates)this.off(t,r.delegates[t]);return t.splice(e,1),this}}})(r),this}queryRenderedFeatures(e,n){if(!this.style)return[];if(void 0!==n||void 0===e||e instanceof t.P||Array.isArray(e)||(n=e,e=void 0),e=e||[[0,0],[this.transform.width,this.transform.height]],(n=n||{}).layers&&Array.isArray(n.layers))for(const t of n.layers)if(!this._isValidId(t))return[];return this.style.queryRenderedFeatures(e,n,this.transform)}querySourceFeatures(t,e){return this._isValidId(t)?this.style.querySourceFeatures(t,e):[]}isPointOnSurface(e){const{name:n}=this.transform.projection;return"globe"!==n&&"mercator"!==n&&t.w(`${n} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(t.P.convert(e))}setStyle(e,n){return n=t.W({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},n),this.style&&e&&!1!==n.diff&&n.localFontFamily===this._localFontFamily&&n.localIdeographFontFamily===this._localIdeographFontFamily&&!n.config?(this.style._diffStyle(e,((i,a)=>{i?(t.w(`Unable to perform style diff: ${String(i.message||i.error||i)}. Rebuilding the style from scratch.`),this._updateStyle(e,n)):a&&this._update(!0)}),(()=>{this._postStyleLoadEvent()})),this):(this._localIdeographFontFamily=n.localIdeographFontFamily,this._localFontFamily=n.localFontFamily,this._updateStyle(e,n))}_getUIString(t){const e=this._locale[t];if(null==e)throw new Error(`Missing UI string '${t}'`);return e}_updateStyle(e,n){if(this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),e){const i=t.W({},n);n&&n.config&&(i.initialConfig=n.config,delete i.config),this.style=new Dr(this,i).load(e),this.style.setEventedParent(this,{style:this.style})}return this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new Dr(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(t.w("There is no style added to the map."),!1)}_isValidId(e){return null==e?(this.fire(new t.d(new Error("IDs can't be empty."))),!1):!t.cV(e)||(this.fire(new t.d(new Error(`IDs can't contain special symbols: "${e}".`))),!1)}addSource(t,e){return this._isValidId(t)?(this._lazyInitEmptyStyle(),this.style.addSource(t,e),this._update(!0)):this}isSourceLoaded(t){return!!this._isValidId(t)&&!!this.style&&this.style._isSourceCacheLoaded(t)}areTilesLoaded(){return this.style.areTilesLoaded()}addSourceType(t,e,n){this._lazyInitEmptyStyle(),this.style.addSourceType(t,e,n)}removeSource(t){return this._isValidId(t)?(this.style.removeSource(t),this._updateTerrain(),this._update(!0)):this}getSource(t){return this._isValidId(t)?this.style.getOwnSource(t):null}addImage(e,n,{pixelRatio:i=1,sdf:a=!1,stretchX:r,stretchY:o,content:s}={}){if(this._lazyInitEmptyStyle(),n instanceof HTMLImageElement||ImageBitmap&&n instanceof ImageBitmap){const{width:l,height:c,data:u}=t.e.getImageData(n);this.style.addImage(e,{data:new t.i({width:l,height:c},u),pixelRatio:i,stretchX:r,stretchY:o,content:s,sdf:a,version:0})}else if(void 0===n.width||void 0===n.height)this.fire(new t.d(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:l,height:c}=n,u=n;this.style.addImage(e,{data:new t.i({width:l,height:c},new Uint8Array(u.data)),pixelRatio:i,stretchX:r,stretchY:o,content:s,sdf:a,version:0,userImage:u}),u.onAdd&&u.onAdd(this,e)}}updateImage(e,n){this._lazyInitEmptyStyle();const i=this.style.getImage(e);if(!i)return void this.fire(new t.d(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const a=n instanceof HTMLImageElement||ImageBitmap&&n instanceof ImageBitmap?t.e.getImageData(n):n,{width:r,height:o,data:s}=a;if(void 0===r||void 0===o)return void this.fire(new t.d(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(r!==i.data.width||o!==i.data.height)return void this.fire(new t.d(new Error(`The width and height of the updated image (${r}, ${o})\n                must be that same as the previous version of the image\n                (${i.data.width}, ${i.data.height})`)));const l=!(n instanceof HTMLImageElement||ImageBitmap&&n instanceof ImageBitmap);i.data.replace(s,l),this.style.updateImage(e,i)}hasImage(e){return e?!!this.style&&!!this.style.getImage(e):(this.fire(new t.d(new Error("Missing required image id"))),!1)}removeImage(t){this.style.removeImage(t)}loadImage(e,n){t.h(this._requestManager.transformRequest(e,t.R.Image),((e,i)=>{n(e,i instanceof HTMLImageElement?t.e.getImageData(i):i)}))}listImages(){return this.style.listImages()}addModel(t,e){this._lazyInitEmptyStyle(),this.style.addModel(t,e)}hasModel(e){return e?this.style.hasModel(e):(this.fire(new t.d(new Error("Missing required model id"))),!1)}removeModel(t){this.style.removeModel(t)}listModels(){return this.style.listModels()}addLayer(t,e){return this._isValidId(t.id)?(this._lazyInitEmptyStyle(),this.style.addLayer(t,e),this._update(!0)):this}getSlot(t){const e=this.getLayer(t);return e&&e.slot||null}setSlot(t,e){return this.style.setSlot(t,e),this.style.mergeLayers(),this._update(!0)}addImport(t,e){return this.style.addImport(t,e),this}updateImport(t,e){return"string"!=typeof e&&e.id!==t?(this.removeImport(t),this.addImport(e)):(this.style.updateImport(t,e),this._update(!0))}removeImport(t){return this.style.removeImport(t),this}moveImport(t,e){return this.style.moveImport(t,e),this._update(!0)}moveLayer(t,e){return this._isValidId(t)?(this.style.moveLayer(t,e),this._update(!0)):this}removeLayer(t){return this._isValidId(t)?(this.style.removeLayer(t),this._update(!0)):this}getLayer(t){return this._isValidId(t)?this.style.getOwnLayer(t):null}getSlots(){return this.style.getSlots()}setLayerZoomRange(t,e,n){return this._isValidId(t)?(this.style.setLayerZoomRange(t,e,n),this._update(!0)):this}setFilter(t,e,n={}){return this._isValidId(t)?(this.style.setFilter(t,e,n),this._update(!0)):this}getFilter(t){return this._isValidId(t)?this.style.getFilter(t):null}setPaintProperty(t,e,n,i={}){return this._isValidId(t)?(this.style.setPaintProperty(t,e,n,i),this._update(!0)):this}getPaintProperty(t,e){return this._isValidId(t)?this.style.getPaintProperty(t,e):null}setLayoutProperty(t,e,n,i={}){return this._isValidId(t)?(this.style.setLayoutProperty(t,e,n,i),this._update(!0)):this}getLayoutProperty(t,e){return this._isValidId(t)?this.style.getLayoutProperty(t,e):null}getSchema(t){return this.style.getSchema(t)}setSchema(t,e){return this.style.setSchema(t,e),this._update(!0)}getConfig(t){return this.style.getConfig(t)}setConfig(t,e){return this.style.setConfig(t,e),this._update(!0)}getConfigProperty(t,e){return this.style.getConfigProperty(t,e)}setConfigProperty(t,e,n){return this.style.setConfigProperty(t,e,n),this._update(!0)}setLights(t){if(this._lazyInitEmptyStyle(),t&&1===t.length&&"flat"===t[0].type){const e=t[0];e.properties?this.style.setFlatLight(e.properties,e.id,{}):this.style.setFlatLight({},"flat")}else this.style.setLights(t),this.painter.terrain&&(this.painter.terrain.invalidateRenderCache=!0);return this._update(!0)}getLights(){const t=this.style.getLights()||[];return 0===t.length&&t.push({id:this.style.light.id,type:"flat",properties:this.style.getFlatLight()}),t}setLight(t,e={}){return console.log("The `map.setLight` function is deprecated, prefer using `map.setLights` with `flat` light type instead."),this.setLights([{id:"flat",type:"flat",properties:t}])}getLight(){return console.log("The `map.getLight` function is deprecated, prefer using `map.getLights` instead."),this.style.getFlatLight()}setTerrain(t){return this._lazyInitEmptyStyle(),!t&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(t),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(t){return this._lazyInitEmptyStyle(),this.style.setFog(t),this._update(!0)}getFog(){return this.style?this.style.getFog():null}setColorTheme(t){return this._lazyInitEmptyStyle(),this.style.setColorTheme(t),this._update(!0)}setCamera(t){return this.style.setCamera(t),this._triggerCameraUpdate(t)}_triggerCameraUpdate(t){return this._update(this.transform.setOrthographicProjectionAtLowPitch("orthographic"===t["camera-projection"]))}getCamera(){return this.style.camera}_queryFogOpacity(e){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(t.aI.convert(e),this.transform):0}setFeatureState(t,e){return this._isValidId(t.source)?(this.style.setFeatureState(t,e),this._update()):this}removeFeatureState(t,e){return this._isValidId(t.source)?(this.style.removeFeatureState(t,e),this._update()):this}getFeatureState(t){return this._isValidId(t.source)?this.style.getFeatureState(t):null}_updateContainerDimensions(){if(!this._container)return;const t=this._container.getBoundingClientRect().width||400,e=this._container.getBoundingClientRect().height||300;let n,i,a,r=this._container;for(;r&&(!i||!a);){const t=window.getComputedStyle(r).transform;t&&"none"!==t&&(n=t.match(/matrix.*\((.+)\)/)[1].split(", "),n[0]&&"0"!==n[0]&&"1"!==n[0]&&(i=n[0]),n[3]&&"0"!==n[3]&&"1"!==n[3]&&(a=n[3])),r=r.parentElement}this._containerWidth=i?Math.abs(t/i):t,this._containerHeight=a?Math.abs(e/a):e}_detectMissingCSS(){"rgb(250, 128, 114)"!==window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")&&t.w("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const t=this._container;t.classList.add("mapboxgl-map"),(this._missingCSSCanary=r("div","mapboxgl-canary",t)).style.visibility="hidden",this._detectMissingCSS();const e=this._canvasContainer=r("div","mapboxgl-canvas-container",t);this._canvas=r("canvas","mapboxgl-canvas",e),this._interactive&&(e.classList.add("mapboxgl-interactive"),this._canvas.setAttribute("tabindex","0")),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const n=this._controlContainer=r("div","mapboxgl-control-container",t),i=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach((t=>{i[t]=r("div",`mapboxgl-ctrl-${t}`,n)})),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(e,n){const i=t.e.devicePixelRatio||1;this._canvas.width=i*Math.ceil(e),this._canvas.height=i*Math.ceil(n),this._canvas.style.width=`${e}px`,this._canvas.style.height=`${n}px`}_addMarker(t){this._markers.push(t)}_removeMarker(t){const e=this._markers.indexOf(t);-1!==e&&this._markers.splice(e,1)}_addPopup(t){this._popups.push(t)}_removePopup(t){const e=this._popups.indexOf(t);-1!==e&&this._popups.splice(e,1)}_setupPainter(){const e=t.W({},n.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),i=this._canvas.getContext("webgl2",e);i?(t.dh(i,!0),this.painter=new Pa(i,this._contextCreateOptions,this.transform,this._tp),this.on("data",(t=>{"source"===t.dataType&&this.painter.setTileLoadedFlag(!0)})),t.di.testSupport(i)):this.fire(new t.d(new Error("Failed to initialize WebGL")))}_contextLost(e){e.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new t.f("webglcontextlost",{originalEvent:e}))}_contextRestored(e){this._setupPainter(),this.resize(),this._update(),this.fire(new t.f("webglcontextrestored",{originalEvent:e}))}_onMapScroll(t){if(t.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}frameReady(){return this.loaded()&&!this._placementDirty&&!this._occlusionOpacityChanged&&this._occlusionCriteriaSatisfied()}_update(t){return this.style?(this._styleDirty=this._styleDirty||t,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(t){return this._update(),this._renderTaskQueue.add(t)}_cancelRenderFrame(t){this._renderTaskQueue.remove(t)}_requestDomTask(t){!this.loaded()||this.loaded()&&!this.isMoving()?t():this._domRenderTaskQueue.add(t)}_render(e){let n;this.fire(new t.f("renderstart")),++this._frameId;const i=this.painter.context.extTimerQuery,a=t.e.now(),r=this.painter.context.gl;if(this.listens("gpu-timing-frame")&&(n=r.createQuery(),r.beginQuery(i.TIME_ELAPSED_EXT,n)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],performance.now())),this._renderTaskQueue.run(e),this._domRenderTaskQueue.run(e),this._removed)return;this._updateProjectionTransition();const o=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const e=this.transform.zoom,n=this.transform.pitch,i=t.e.now(),a=new t.X(e,{now:i,fadeDuration:o,pitch:n,transition:this.style.transition});this.style.update(a)}this.style&&this.style.hasFogTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let s=!1;this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),s=this._updateAverageElevation(a),this.style.updateSources(this.transform),this._forceMarkerAndPopupUpdate()):s=this._updateAverageElevation(a);const l=this.style&&this.style._updatePlacement(this.painter,this.painter.transform,this.showCollisionBoxes,o,this._crossSourceCollisions,this.painter.replacementSource);if(l&&(this._placementDirty=l.needsRerender,this._occlusionOpacityChanged=l.occlusionQueryBasedOpacityChanged),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showParseStatus:this.showParseStatus,wireframe:{terrain:this.showTerrainWireframe,layers2D:this.showLayers2DWireframe,layers3D:this.showLayers3DWireframe},showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:o,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new t.f("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,t.dc.mark(t.dd.load),this.fire(new t.f("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),n){const e=t.e.now()-a;r.endQuery(i.TIME_ELAPSED_EXT),setTimeout((()=>{const i=r.getQueryParameter(n,r.QUERY_RESULT)/1e6;r.deleteQuery(n),this.fire(new t.f("gpu-timing-frame",{cpuTime:e,gpuTime:i}))}),50)}if(this.listens("gpu-timing-layer")){const e=this.painter.collectGpuTimers();setTimeout((()=>{const n=this.painter.queryGpuTimers(e);this.fire(new t.f("gpu-timing-layer",{layerTimes:n}))}),50)}if(this.listens("gpu-timing-deferred-render")){const e=this.painter.collectDeferredRenderGpuQueries();setTimeout((()=>{const n=this.painter.queryGpuTimeDeferredRender(e);this.fire(new t.f("gpu-timing-deferred-render",{gpuTime:n}))}),50)}const c=this._sourcesDirty||this._styleDirty||this._placementDirty||this._occlusionOpacityChanged||s;if((this._sourcesDirty||this._styleDirty||s||this._occlusionOpacityChanged)&&(this._lastDirtyFrameId=this._frameId),c||this._repaint||!this._occlusionCriteriaSatisfied())this.triggerRepaint();else{const e=!this.isMoving()&&this.loaded();if(e&&(s=this._updateAverageElevation(a,!0)),s)this.triggerRepaint();else if(this._triggerFrame(!1),e&&(this.fire(new t.f("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const e=this._calculateSpeedIndex();this.fire(new t.f("speedindexcompleted",{speedIndex:e})),this.speedIndexTiming=!1}}this._loaded&&!this._fullyLoaded&&!c&&this._occlusionCriteriaSatisfied()&&(this._fullyLoaded=!0,t.dc.mark(t.dd.fullLoad),this._performanceMetricsCollection&&t.dj(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(t){for(const e of this._markers)t&&!this.getRenderWorldCopies()&&(e._lngLat=e._lngLat.wrap()),e._update();for(const e of this._popups)!t||this.getRenderWorldCopies()||e._trackPointer||(e._lngLat=e._lngLat.wrap()),e._update()}_updateAverageElevation(t,e=!1){const n=t=>(this.transform.averageElevation=t,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return 0!==this.transform.averageElevation&&n(0);const i=this.transform.elevation&&this.transform.elevation.exaggeration()!==this._averageElevationExaggeration;if(i||(e||t-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(t)){const e=this.transform.averageElevation;let a=this.transform.sampleAverageElevation();null!=this.transform.elevation&&(this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(a)?a=0:this._averageElevationLastSampledAt=t;const r=Math.abs(e-a);if(r>1){if(this._isInitialLoad||i)return this._averageElevation.jumpTo(a),n(a);this._averageElevation.easeTo(a,t,300)}else if(r>1e-4)return this._averageElevation.jumpTo(a),n(a)}return!!this._averageElevation.isEasing(t)&&n(this._averageElevation.getValue(t))}_authenticate(){t.dk(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,(e=>{if(e&&(e.message===t.dl||401===e.status)){const e=this.painter.context.gl;t.dh(e,!1),this._logoControl instanceof Oo&&this._logoControl._updateLogo(),e&&e.clear(e.DEPTH_BUFFER_BIT|e.COLOR_BUFFER_BIT|e.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new t.d(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}})),t.dm(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,(()=>{}))}_postStyleLoadEvent(){this.style.globalId&&t.dn(this._requestManager._customAccessToken,{map:this,skuToken:this._requestManager._skuToken,style:this.style.globalId,importedStyles:this.style.getImportGlobalIds()})}_updateTerrain(){const t=this._isDragging();this.painter.updateTerrain(this.style,t)}_calculateSpeedIndex(){const t=this.painter.canvasCopy(),e=this.painter.getCanvasCopiesAndTimestamps();e.timeStamps.push(performance.now());const n=this.painter.context.gl,i=n.createFramebuffer();function a(t){n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,t,0);const e=new Uint8Array(n.drawingBufferWidth*n.drawingBufferHeight*4);return n.readPixels(0,0,n.drawingBufferWidth,n.drawingBufferHeight,n.RGBA,n.UNSIGNED_BYTE,e),e}return n.bindFramebuffer(n.FRAMEBUFFER,i),this._canvasPixelComparison(a(t),e.canvasCopies.map(a),e.timeStamps)}_canvasPixelComparison(t,e,n){let i=n[1]-n[0];const a=t.length/4;for(let r=0;r<e.length;r++){const o=e[r];let s=0;for(let e=0;e<o.length;e+=4)o[e]===t[e]&&o[e+1]===t[e+1]&&o[e+2]===t[e+2]&&o[e+3]===t[e+3]&&(s+=1);i+=(n[r+2]-n[r+1])*(1-s/a)}return i}remove(){this._hash&&this._hash.remove();for(const t of this._controls)t.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),window.removeEventListener("resize",this._onWindowResize,!1),window.removeEventListener("orientationchange",this._onWindowResize,!1),window.removeEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.removeEventListener("online",this._onWindowOnline,!1),window.removeEventListener("visibilitychange",this._onVisibilityChange,!1);const e=this.painter.context.gl.getExtension("WEBGL_lose_context");e&&e.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),t.dp(this.painter.context.gl),t.dq.remove(),t.dr.remove(),this._removed=!0,this.fire(new t.f("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(e){this._renderNextFrame=this._renderNextFrame||e,this.style&&!this._frame&&(this._frame=t.e.frame((t=>{const e=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,e&&this._render(t)})))}_preloadTiles(e){const n=this.style?this.style.getSourceCaches():[];return t.ds(n,((t,n)=>t._preloadTiles(e,n)),(()=>{this.triggerRepaint()})),this}_onWindowOnline(){this._update()}_onWindowResize(t){this._trackResize&&this.resize({originalEvent:t})._update()}_onVisibilityChange(){"hidden"===document.visibilityState&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(t){this._showTileBoundaries!==t&&(this._showTileBoundaries=t,this._tp.refreshUI(),this._update())}get showParseStatus(){return!!this._showParseStatus}set showParseStatus(t){this._showParseStatus!==t&&(this._showParseStatus=t,this._tp.refreshUI(),this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(t){this._showTerrainWireframe!==t&&(this._showTerrainWireframe=t,this._tp.refreshUI(),this._update())}get showLayers2DWireframe(){return!!this._showLayers2DWireframe}set showLayers2DWireframe(t){this._showLayers2DWireframe!==t&&(this._showLayers2DWireframe=t,this._tp.refreshUI(),this._update())}get showLayers3DWireframe(){return!!this._showLayers3DWireframe}set showLayers3DWireframe(t){this._showLayers3DWireframe!==t&&(this._showLayers3DWireframe=t,this._tp.refreshUI(),this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(t){this._speedIndexTiming!==t&&(this._speedIndexTiming=t,this._update())}get showPadding(){return!!this._showPadding}set showPadding(t){this._showPadding!==t&&(this._showPadding=t,this._tp.refreshUI(),this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(t){this._showCollisionBoxes!==t&&(this._showCollisionBoxes=t,this._tp.refreshUI(),t?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(t){this._showOverdrawInspector!==t&&(this._showOverdrawInspector=t,this._tp.refreshUI(),this._update())}get repaint(){return!!this._repaint}set repaint(t){this._repaint!==t&&(this._repaint=t,this._tp.refreshUI(),this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(t){this._vertices=t,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(t){this._showTileAABBs!==t&&(this._showTileAABBs=t,this._tp.refreshUI(),t&&this._update())}_setCacheLimits(e,n){t.du(e,n)}_occlusionCriteriaSatisfied(){const t=this.style&&(this.style.has3DLayers()||this.style.terrain&&!this.style.disableElevatedTerrain);return!(this.style&&this.style.hasSymbolLayers()&&t&&this.painter)||this._frameId-this._lastDirtyFrameId>5+2*this.painter.symbolParams.occlusionQueryFrameWindow}get version(){return t.dt}},NavigationControl:class{constructor(e){this.options=t.W({},Zo,e),this._container=r("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",(t=>t.preventDefault())),this.options.showZoom&&(t.bp(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",(t=>{this._map&&this._map.zoomIn({},{originalEvent:t})})),r("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",(t=>{this._map&&this._map.zoomOut({},{originalEvent:t})})),r("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(t.bp(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",(t=>{const e=this._map;e&&(this.options.visualizePitch?e.resetNorthPitch({},{originalEvent:t}):e.resetNorth({},{originalEvent:t}))})),this._compassIcon=r("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const t=this._map;if(!t)return;const e=t.getZoom(),n=e===t.getMaxZoom(),i=e===t.getMinZoom();this._zoomInButton.disabled=n,this._zoomOutButton.disabled=i,this._zoomInButton.setAttribute("aria-disabled",n.toString()),this._zoomOutButton.setAttribute("aria-disabled",i.toString())}_rotateCompassArrow(){const t=this._map;if(!t)return;const e=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(t.transform.pitch*(Math.PI/180)),.5)}) rotateX(${t.transform.pitch}deg) rotateZ(${t.transform.angle*(180/Math.PI)}deg)`:`rotate(${t.transform.angle*(180/Math.PI)}deg)`;t._requestDomTask((()=>{this._compassIcon&&(this._compassIcon.style.transform=e)}))}onAdd(t){return this._map=t,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),t.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&t.on("pitch",this._rotateCompassArrow),t.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Yo(t,this._compass,this.options.visualizePitch)),this._container}onRemove(){const t=this._map;t&&(this._container.remove(),this.options.showZoom&&t.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&t.off("pitch",this._rotateCompassArrow),t.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(t,e){const n=r("button",t,this._container);return n.type="button",n.addEventListener("click",e),n}_setButtonTitle(t,e){if(!this._map)return;const n=this._map._getUIString(`NavigationControl.${e}`);t.setAttribute("aria-label",n),t.firstElementChild&&t.firstElementChild.setAttribute("title",n)}},GeolocateControl:class extends t.E{constructor(e){super();const n=navigator.geolocation;this.options=t.W({geolocation:n},Xo,e),t.bp(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=Lr(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(t){return this._map=t,this._container=r("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){void 0!==this._geolocationWatchID&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(t){const e=(e=!!this.options.geolocation)=>{this._supportsGeolocation=e,t(e)};void 0!==this._supportsGeolocation?t(this._supportsGeolocation):void 0!==navigator.permissions?navigator.permissions.query({name:"geolocation"}).then((t=>e("denied"!==t.state))).catch((()=>e())):e()}_isOutOfMapMaxBounds(t){const e=this._map.getMaxBounds(),n=t.coords;return!!e&&(n.longitude<e.getWest()||n.longitude>e.getEast()||n.latitude<e.getSouth()||n.latitude>e.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(e){if(this._map){if(this._isOutOfMapMaxBounds(e))return this._setErrorState(),this.fire(new t.f("outofmaxbounds",e)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=e,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(e),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(e),this.options.showUserLocation&&this._userLocationDotMarker.removeClassName("mapboxgl-user-location-dot-stale"),this.fire(new t.f("geolocate",e)),this._finish()}}_updateCamera(e){const n=new t.aI(e.coords.longitude,e.coords.latitude),i=e.coords.accuracy,a=this._map.getBearing(),r=t.W({bearing:a},this.options.fitBoundsOptions);this._map.fitBounds(n.toBounds(i),r,{geolocateSource:!0})}_updateMarker(e){if(e){const n=new t.aI(e.coords.longitude,e.coords.latitude);this._accuracyCircleMarker.setLngLat(n).addTo(this._map),this._userLocationDotMarker.setLngLat(n).addTo(this._map),this._accuracy=e.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const e=this._map.transform,n=t.ax(1,e._center.lat)*e.worldSize,i=Math.ceil(2*this._accuracy*n);this._circleElement.style.width=`${i}px`,this._circleElement.style.height=`${i}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&"number"==typeof this._heading?(this._userLocationDotMarker.setRotation(this._heading),this._userLocationDotMarker.addClassName("mapboxgl-user-location-show-heading")):(this._userLocationDotMarker.removeClassName("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(e){if(this._map){if(this.options.trackUserLocation)if(1===e.code){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const t=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",t),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",t),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===e.code&&this._noTimeout)return;this._setErrorState()}"OFF"!==this._watchState&&this.options.showUserLocation&&this._userLocationDotMarker.addClassName("mapboxgl-user-location-dot-stale"),this.fire(new t.f("error",e)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(e){if(void 0!==this._map){if(this._container.addEventListener("contextmenu",(t=>t.preventDefault())),this._geolocateButton=r("button","mapboxgl-ctrl-geolocate",this._container),r("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",!1===e){t.w("Geolocation support is not available so the GeolocateControl will be disabled.");const e=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",e),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",e)}else{const t=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",t),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",t)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=r("div","mapboxgl-user-location"),this._dotElement.appendChild(r("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(r("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new jo({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=r("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new jo({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",(e=>{e.geolocateSource||"ACTIVE_LOCK"!==this._watchState||e.originalEvent&&"resize"===e.originalEvent.type||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new t.f("trackuserlocationend")))}))}}_onDeviceOrientation(t){this._userLocationDotMarker&&(t.webkitCompassHeading?this._heading=t.webkitCompassHeading:!0===t.absolute&&(this._heading=-1*t.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return t.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new t.f("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new t.f("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new t.f("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){let t;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(t={maximumAge:6e5,timeout:0},this._noTimeout=!0):(t=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,t),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const t=()=>{"ondeviceorientationabsolute"in window?window.addEventListener("deviceorientationabsolute",this._onDeviceOrientation):window.addEventListener("deviceorientation",this._onDeviceOrientation)};"undefined"!=typeof DeviceMotionEvent&&"function"==typeof DeviceMotionEvent.requestPermission?DeviceOrientationEvent.requestPermission().then((e=>{"granted"===e&&t()})).catch(console.error):t()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),window.removeEventListener("deviceorientation",this._onDeviceOrientation),window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:Bo,ScaleControl:class{constructor(e){this.options=t.W({},Ko,e),this._isNumberFormatSupported=function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch(t){return!1}}(),t.bp(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const t=this.options.maxWidth||100,e=this._map,n=e._containerHeight/2,i=e._containerWidth/2-t/2,a=e.unproject([i,n]),r=e.unproject([i+t,n]),o=a.distanceTo(r);if("imperial"===this.options.unit){const e=3.2808*o;e>5280?this._setScale(t,e/5280,"mile"):this._setScale(t,e,"foot")}else"nautical"===this.options.unit?this._setScale(t,o/1852,"nautical-mile"):o>=1e3?this._setScale(t,o/1e3,"kilometer"):this._setScale(t,o,"meter")}_setScale(t,e,n){this._map._requestDomTask((()=>{const i=function(t){const e=Math.pow(10,`${Math.floor(t)}`.length-1);let n=t/e;return n=n>=10?10:n>=5?5:n>=3?3:n>=2?2:n>=1?1:function(t){const e=Math.pow(10,Math.ceil(-Math.log(t)/Math.LN10));return Math.round(t*e)/e}(n),e*n}(e),a=i/e;this._container.innerHTML=this._isNumberFormatSupported&&"nautical-mile"!==n?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:n}).format(i):`${i}&nbsp;${Qo[n]}`,this._container.style.width=t*a+"px"}))}onAdd(t){return this._map=t,this._language=t.getLanguage(),this._container=r("div","mapboxgl-ctrl mapboxgl-ctrl-scale",t.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(t){this._language=t,this._update()}setUnit(t){this.options.unit=t,this._update()}},FullscreenControl:class{constructor(e){this._fullscreen=!1,e&&e.container&&(e.container instanceof HTMLElement?this._container=e.container:t.w("Full screen control 'container' must be a DOM element.")),t.bp(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(e){return this._map=e,this._container||(this._container=this._map.getContainer()),this._controlContainer=r("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",t.w("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!document.fullscreenEnabled&&!document.webkitFullscreenEnabled)}_setupUI(){const t=this._fullscreenButton=r("button","mapboxgl-ctrl-fullscreen",this._controlContainer);r("span","mapboxgl-ctrl-icon",t).setAttribute("aria-hidden","true"),t.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const t=this._getTitle();this._fullscreenButton.setAttribute("aria-label",t),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",t)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(document.fullscreenElement||document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?document.exitFullscreen?document.exitFullscreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends t.E{constructor(e){super(),this.options=t.W(Object.create(Vo),e),t.bp(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(e&&e.className?e.className.trim().split(/\s+/):[])}addTo(e){return this._map&&this.remove(),this._map=e,this.options.closeOnClick&&e.on("preclick",this._onClose),this.options.closeOnMove&&e.on("move",this._onClose),e.on("remove",this.remove),this._update(),e._addPopup(this),this._focusFirstElement(),this._trackPointer?(e.on("mousemove",this._onMouseEvent),e.on("mouseup",this._onMouseEvent),e._canvasContainer.classList.add("mapboxgl-track-pointer")):e.on("move",this._update),this.fire(new t.f("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const e=this._map;return e&&(e.off("move",this._update),e.off("move",this._onClose),e.off("preclick",this._onClose),e.off("click",this._onClose),e.off("remove",this.remove),e.off("mousemove",this._onMouseEvent),e.off("mouseup",this._onMouseEvent),e.off("drag",this._onMouseEvent),e._canvasContainer&&e._canvasContainer.classList.remove("mapboxgl-track-pointer"),e._removePopup(this),this._map=void 0),this.fire(new t.f("close")),this}getLngLat(){return this._lngLat}setLngLat(e){this._lngLat=t.aI.convert(e),this._pos=null,this._trackPointer=!1,this._update();const n=this._map;return n&&(n.on("move",this._update),n.off("mousemove",this._onMouseEvent),n._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const t=this._map;return t&&(t.off("move",this._update),t.on("mousemove",this._onMouseEvent),t.on("drag",this._onMouseEvent),t._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(t){return this.setDOMContent(document.createTextNode(t))}setHTML(t){const e=document.createDocumentFragment(),n=document.createElement("body");let i;for(n.innerHTML=t;i=n.firstChild,i;)e.appendChild(i);return this.setDOMContent(e)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(t){return this.options.maxWidth=t,this._update(),this}setDOMContent(t){let e=this._content;if(e)for(;e.hasChildNodes();)e.firstChild&&e.removeChild(e.firstChild);else e=this._content=r("div","mapboxgl-popup-content",this._container||void 0);if(e.appendChild(t),this.options.closeButton){const t=this._closeButton=r("button","mapboxgl-popup-close-button",e);t.type="button",t.setAttribute("aria-label","Close popup"),t.setAttribute("aria-hidden","true"),t.innerHTML="&#215;",t.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(t){return this._classList.add(t),this._updateClassList(),this}removeClassName(t){return this._classList.delete(t),this._updateClassList(),this}setOffset(t){return this.options.offset=t,this._update(),this}toggleClassName(t){let e;return this._classList.delete(t)?e=!1:(this._classList.add(t),e=!0),this._updateClassList(),e}_onMouseEvent(t){this._update(t.point)}_getAnchor(t){if(this.options.anchor)return this.options.anchor;const e=this._map,n=this._container,i=this._pos;if(!e||!n||!i)return"bottom";const a=n.offsetWidth,r=n.offsetHeight,o=i.x<a/2,s=i.x>e.transform.width-a/2;if(i.y+t<r)return o?"top-left":s?"top-right":"top";if(i.y>e.transform.height-r){if(o)return"bottom-left";if(s)return"bottom-right"}return o?"left":s?"right":"bottom"}_updateClassList(){const t=this._container;if(!t)return;const e=[...this._classList];e.push("mapboxgl-popup"),this._anchor&&e.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&e.push("mapboxgl-popup-track-pointer"),t.className=e.join(" ")}_update(e){const n=this._map,i=this._content;if(!n||!this._lngLat&&!this._trackPointer||!i)return;let a=this._container;if(a||(a=this._container=r("div","mapboxgl-popup",n.getContainer()),this._tip=r("div","mapboxgl-popup-tip",a),a.appendChild(i)),this.options.maxWidth&&a.style.maxWidth!==this.options.maxWidth&&(a.style.maxWidth=this.options.maxWidth),n.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Fo(this._lngLat,this._pos,n.transform)),!this._trackPointer||e){const t=this._pos=this._trackPointer&&e?e:n.project(this._lngLat),i=Go(this.options.offset),a=this._anchor=this._getAnchor(i.y),r=Go(this.options.offset,a),o=t.add(r).round();n._requestDomTask((()=>{this._container&&a&&(this._container.style.transform=`${No[a]} translate(${o.x}px,${o.y}px)`)}))}if(!this._marker&&n._showingGlobe()){const e=t.d9(n.transform,this._lngLat)?0:1;this._setOpacity(e)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const t=this._container.querySelector(Uo);t&&t.focus()}_onClose(){this.remove()}_setOpacity(t){this._container&&(this._container.style.opacity=`${t}`),this._content&&(this._content.style.pointerEvents=t?"auto":"none")}},Marker:jo,Style:Dr,LngLat:t.aI,LngLatBounds:t.ai,Point:t.P,MercatorCoordinate:t.Y,FreeCameraOptions:He,Evented:t.E,config:t.d8,prewarm:t.dx,clearPrewarmedResources:t.dy,get accessToken(){return t.d8.ACCESS_TOKEN},set accessToken(e){t.d8.ACCESS_TOKEN=e},get baseApiUrl(){return t.d8.API_URL},set baseApiUrl(e){t.d8.API_URL=e},get workerCount(){return t.dz.workerCount},set workerCount(e){t.dz.workerCount=e},get maxParallelImageRequests(){return t.d8.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(e){t.d8.MAX_PARALLEL_IMAGE_REQUESTS=e},clearStorage(e){t.dA(e)},get workerUrl(){return t.dB.workerUrl},set workerUrl(e){t.dB.workerUrl=e},get workerClass(){return t.dB.workerClass},set workerClass(e){t.dB.workerClass=e},get workerParams(){return t.dB.workerParams},set workerParams(e){t.dB.workerParams=e},get dracoUrl(){return t.dC()},set dracoUrl(e){t.dD(e)},get meshoptUrl(){return t.dE()},set meshoptUrl(e){t.dF(e)},setNow:t.e.setNow,restoreNow:t.e.restoreNow};return Jo})),n}()},2694:(t,e,n)=>{"use strict";var i=n(6925);function a(){}function r(){}r.resetWarningCache=a,t.exports=function(){function t(t,e,n,a,r,o){if(o!==i){var s=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw s.name="Invariant Violation",s}}function e(){return t}t.isRequired=t;var n={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,elementType:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:r,resetWarningCache:a};return n.PropTypes=n,n}},5556:(t,e,n)=>{t.exports=n(2694)()},6925:t=>{"use strict";t.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},2551:(t,e,n)=>{"use strict";var i=n(6540),a=n(9982);function r(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=new Set,s={};function l(t,e){c(t,e),c(t+"Capture",e)}function c(t,e){for(s[t]=e,t=0;t<e.length;t++)o.add(e[t])}var u=!("undefined"==typeof window||void 0===window.document||void 0===window.document.createElement),h=Object.prototype.hasOwnProperty,d=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,p={},f={};function m(t,e,n,i,a,r,o){this.acceptsBooleans=2===e||3===e||4===e,this.attributeName=i,this.attributeNamespace=a,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=r,this.removeEmptyString=o}var g={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(t){g[t]=new m(t,0,!1,t,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(t){var e=t[0];g[e]=new m(e,1,!1,t[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(t){g[t]=new m(t,2,!1,t.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(t){g[t]=new m(t,2,!1,t,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(t){g[t]=new m(t,3,!1,t.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(t){g[t]=new m(t,3,!0,t,null,!1,!1)})),["capture","download"].forEach((function(t){g[t]=new m(t,4,!1,t,null,!1,!1)})),["cols","rows","size","span"].forEach((function(t){g[t]=new m(t,6,!1,t,null,!1,!1)})),["rowSpan","start"].forEach((function(t){g[t]=new m(t,5,!1,t.toLowerCase(),null,!1,!1)}));var _=/[\-:]([a-z])/g;function y(t){return t[1].toUpperCase()}function x(t,e,n,i){var a=g.hasOwnProperty(e)?g[e]:null;(null!==a?0!==a.type:i||!(2<e.length)||"o"!==e[0]&&"O"!==e[0]||"n"!==e[1]&&"N"!==e[1])&&(function(t,e,n,i){if(null==e||function(t,e,n,i){if(null!==n&&0===n.type)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return!i&&(null!==n?!n.acceptsBooleans:"data-"!==(t=t.toLowerCase().slice(0,5))&&"aria-"!==t);default:return!1}}(t,e,n,i))return!0;if(i)return!1;if(null!==n)switch(n.type){case 3:return!e;case 4:return!1===e;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}(e,n,a,i)&&(n=null),i||null===a?function(t){return!!h.call(f,t)||!h.call(p,t)&&(d.test(t)?f[t]=!0:(p[t]=!0,!1))}(e)&&(null===n?t.removeAttribute(e):t.setAttribute(e,""+n)):a.mustUseProperty?t[a.propertyName]=null===n?3!==a.type&&"":n:(e=a.attributeName,i=a.attributeNamespace,null===n?t.removeAttribute(e):(n=3===(a=a.type)||4===a&&!0===n?"":""+n,i?t.setAttributeNS(i,e,n):t.setAttribute(e,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(t){var e=t.replace(_,y);g[e]=new m(e,1,!1,t,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(t){var e=t.replace(_,y);g[e]=new m(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(t){var e=t.replace(_,y);g[e]=new m(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(t){g[t]=new m(t,1,!1,t.toLowerCase(),null,!1,!1)})),g.xlinkHref=new m("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(t){g[t]=new m(t,1,!1,t.toLowerCase(),null,!0,!0)}));var v=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,b=Symbol.for("react.element"),w=Symbol.for("react.portal"),A=Symbol.for("react.fragment"),C=Symbol.for("react.strict_mode"),E=Symbol.for("react.profiler"),T=Symbol.for("react.provider"),S=Symbol.for("react.context"),M=Symbol.for("react.forward_ref"),k=Symbol.for("react.suspense"),I=Symbol.for("react.suspense_list"),P=Symbol.for("react.memo"),z=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var D=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var L=Symbol.iterator;function B(t){return null===t||"object"!=typeof t?null:"function"==typeof(t=L&&t[L]||t["@@iterator"])?t:null}var O,R=Object.assign;function F(t){if(void 0===O)try{throw Error()}catch(t){var e=t.stack.trim().match(/\n( *(at )?)/);O=e&&e[1]||""}return"\n"+O+t}var N=!1;function j(t,e){if(!t||N)return"";N=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),"object"==typeof Reflect&&Reflect.construct){try{Reflect.construct(e,[])}catch(t){var i=t}Reflect.construct(t,[],e)}else{try{e.call()}catch(t){i=t}t.call(e.prototype)}else{try{throw Error()}catch(t){i=t}t()}}catch(e){if(e&&i&&"string"==typeof e.stack){for(var a=e.stack.split("\n"),r=i.stack.split("\n"),o=a.length-1,s=r.length-1;1<=o&&0<=s&&a[o]!==r[s];)s--;for(;1<=o&&0<=s;o--,s--)if(a[o]!==r[s]){if(1!==o||1!==s)do{if(o--,0>--s||a[o]!==r[s]){var l="\n"+a[o].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}}while(1<=o&&0<=s);break}}}finally{N=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?F(t):""}function V(t){switch(t.tag){case 5:return F(t.type);case 16:return F("Lazy");case 13:return F("Suspense");case 19:return F("SuspenseList");case 0:case 2:case 15:return j(t.type,!1);case 11:return j(t.type.render,!1);case 1:return j(t.type,!0);default:return""}}function U(t){if(null==t)return null;if("function"==typeof t)return t.displayName||t.name||null;if("string"==typeof t)return t;switch(t){case A:return"Fragment";case w:return"Portal";case E:return"Profiler";case C:return"StrictMode";case k:return"Suspense";case I:return"SuspenseList"}if("object"==typeof t)switch(t.$$typeof){case S:return(t.displayName||"Context")+".Consumer";case T:return(t._context.displayName||"Context")+".Provider";case M:var e=t.render;return(t=t.displayName)||(t=""!==(t=e.displayName||e.name||"")?"ForwardRef("+t+")":"ForwardRef"),t;case P:return null!==(e=t.displayName||null)?e:U(t.type)||"Memo";case z:e=t._payload,t=t._init;try{return U(t(e))}catch(t){}}return null}function G(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=(t=e.render).displayName||t.name||"",e.displayName||(""!==t?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return U(e);case 8:return e===C?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"==typeof e)return e.displayName||e.name||null;if("string"==typeof e)return e}return null}function q(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":case"object":return t;default:return""}}function $(t){var e=t.type;return(t=t.nodeName)&&"input"===t.toLowerCase()&&("checkbox"===e||"radio"===e)}function W(t){t._valueTracker||(t._valueTracker=function(t){var e=$(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),i=""+t[e];if(!t.hasOwnProperty(e)&&void 0!==n&&"function"==typeof n.get&&"function"==typeof n.set){var a=n.get,r=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return a.call(this)},set:function(t){i=""+t,r.call(this,t)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return i},setValue:function(t){i=""+t},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}(t))}function H(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),i="";return t&&(i=$(t)?t.checked?"true":"false":t.value),(t=i)!==n&&(e.setValue(t),!0)}function Z(t){if(void 0===(t=t||("undefined"!=typeof document?document:void 0)))return null;try{return t.activeElement||t.body}catch(e){return t.body}}function Y(t,e){var n=e.checked;return R({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:t._wrapperState.initialChecked})}function X(t,e){var n=null==e.defaultValue?"":e.defaultValue,i=null!=e.checked?e.checked:e.defaultChecked;n=q(null!=e.value?e.value:n),t._wrapperState={initialChecked:i,initialValue:n,controlled:"checkbox"===e.type||"radio"===e.type?null!=e.checked:null!=e.value}}function K(t,e){null!=(e=e.checked)&&x(t,"checked",e,!1)}function Q(t,e){K(t,e);var n=q(e.value),i=e.type;if(null!=n)"number"===i?(0===n&&""===t.value||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if("submit"===i||"reset"===i)return void t.removeAttribute("value");e.hasOwnProperty("value")?tt(t,e.type,n):e.hasOwnProperty("defaultValue")&&tt(t,e.type,q(e.defaultValue)),null==e.checked&&null!=e.defaultChecked&&(t.defaultChecked=!!e.defaultChecked)}function J(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var i=e.type;if(!("submit"!==i&&"reset"!==i||void 0!==e.value&&null!==e.value))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}""!==(n=t.name)&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,""!==n&&(t.name=n)}function tt(t,e,n){"number"===e&&Z(t.ownerDocument)===t||(null==n?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var et=Array.isArray;function nt(t,e,n,i){if(t=t.options,e){e={};for(var a=0;a<n.length;a++)e["$"+n[a]]=!0;for(n=0;n<t.length;n++)a=e.hasOwnProperty("$"+t[n].value),t[n].selected!==a&&(t[n].selected=a),a&&i&&(t[n].defaultSelected=!0)}else{for(n=""+q(n),e=null,a=0;a<t.length;a++){if(t[a].value===n)return t[a].selected=!0,void(i&&(t[a].defaultSelected=!0));null!==e||t[a].disabled||(e=t[a])}null!==e&&(e.selected=!0)}}function it(t,e){if(null!=e.dangerouslySetInnerHTML)throw Error(r(91));return R({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function at(t,e){var n=e.value;if(null==n){if(n=e.children,e=e.defaultValue,null!=n){if(null!=e)throw Error(r(92));if(et(n)){if(1<n.length)throw Error(r(93));n=n[0]}e=n}null==e&&(e=""),n=e}t._wrapperState={initialValue:q(n)}}function rt(t,e){var n=q(e.value),i=q(e.defaultValue);null!=n&&((n=""+n)!==t.value&&(t.value=n),null==e.defaultValue&&t.defaultValue!==n&&(t.defaultValue=n)),null!=i&&(t.defaultValue=""+i)}function ot(t){var e=t.textContent;e===t._wrapperState.initialValue&&""!==e&&null!==e&&(t.value=e)}function st(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function lt(t,e){return null==t||"http://www.w3.org/1999/xhtml"===t?st(e):"http://www.w3.org/2000/svg"===t&&"foreignObject"===e?"http://www.w3.org/1999/xhtml":t}var ct,ut,ht=(ut=function(t,e){if("http://www.w3.org/2000/svg"!==t.namespaceURI||"innerHTML"in t)t.innerHTML=e;else{for((ct=ct||document.createElement("div")).innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=ct.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}},"undefined"!=typeof MSApp&&MSApp.execUnsafeLocalFunction?function(t,e,n,i){MSApp.execUnsafeLocalFunction((function(){return ut(t,e)}))}:ut);function dt(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&3===n.nodeType)return void(n.nodeValue=e)}t.textContent=e}var pt={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},ft=["Webkit","ms","Moz","O"];function mt(t,e,n){return null==e||"boolean"==typeof e||""===e?"":n||"number"!=typeof e||0===e||pt.hasOwnProperty(t)&&pt[t]?(""+e).trim():e+"px"}function gt(t,e){for(var n in t=t.style,e)if(e.hasOwnProperty(n)){var i=0===n.indexOf("--"),a=mt(n,e[n],i);"float"===n&&(n="cssFloat"),i?t.setProperty(n,a):t[n]=a}}Object.keys(pt).forEach((function(t){ft.forEach((function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),pt[e]=pt[t]}))}));var _t=R({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function yt(t,e){if(e){if(_t[t]&&(null!=e.children||null!=e.dangerouslySetInnerHTML))throw Error(r(137,t));if(null!=e.dangerouslySetInnerHTML){if(null!=e.children)throw Error(r(60));if("object"!=typeof e.dangerouslySetInnerHTML||!("__html"in e.dangerouslySetInnerHTML))throw Error(r(61))}if(null!=e.style&&"object"!=typeof e.style)throw Error(r(62))}}function xt(t,e){if(-1===t.indexOf("-"))return"string"==typeof e.is;switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var vt=null;function bt(t){return(t=t.target||t.srcElement||window).correspondingUseElement&&(t=t.correspondingUseElement),3===t.nodeType?t.parentNode:t}var wt=null,At=null,Ct=null;function Et(t){if(t=xa(t)){if("function"!=typeof wt)throw Error(r(280));var e=t.stateNode;e&&(e=ba(e),wt(t.stateNode,t.type,e))}}function Tt(t){At?Ct?Ct.push(t):Ct=[t]:At=t}function St(){if(At){var t=At,e=Ct;if(Ct=At=null,Et(t),e)for(t=0;t<e.length;t++)Et(e[t])}}function Mt(t,e){return t(e)}function kt(){}var It=!1;function Pt(t,e,n){if(It)return t(e,n);It=!0;try{return Mt(t,e,n)}finally{It=!1,(null!==At||null!==Ct)&&(kt(),St())}}function zt(t,e){var n=t.stateNode;if(null===n)return null;var i=ba(n);if(null===i)return null;n=i[e];t:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(i=!("button"===(t=t.type)||"input"===t||"select"===t||"textarea"===t)),t=!i;break t;default:t=!1}if(t)return null;if(n&&"function"!=typeof n)throw Error(r(231,e,typeof n));return n}var Dt=!1;if(u)try{var Lt={};Object.defineProperty(Lt,"passive",{get:function(){Dt=!0}}),window.addEventListener("test",Lt,Lt),window.removeEventListener("test",Lt,Lt)}catch(ut){Dt=!1}function Bt(t,e,n,i,a,r,o,s,l){var c=Array.prototype.slice.call(arguments,3);try{e.apply(n,c)}catch(t){this.onError(t)}}var Ot=!1,Rt=null,Ft=!1,Nt=null,jt={onError:function(t){Ot=!0,Rt=t}};function Vt(t,e,n,i,a,r,o,s,l){Ot=!1,Rt=null,Bt.apply(jt,arguments)}function Ut(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do{!!(4098&(e=t).flags)&&(n=e.return),t=e.return}while(t)}return 3===e.tag?n:null}function Gt(t){if(13===t.tag){var e=t.memoizedState;if(null===e&&null!==(t=t.alternate)&&(e=t.memoizedState),null!==e)return e.dehydrated}return null}function qt(t){if(Ut(t)!==t)throw Error(r(188))}function $t(t){return null!==(t=function(t){var e=t.alternate;if(!e){if(null===(e=Ut(t)))throw Error(r(188));return e!==t?null:t}for(var n=t,i=e;;){var a=n.return;if(null===a)break;var o=a.alternate;if(null===o){if(null!==(i=a.return)){n=i;continue}break}if(a.child===o.child){for(o=a.child;o;){if(o===n)return qt(a),t;if(o===i)return qt(a),e;o=o.sibling}throw Error(r(188))}if(n.return!==i.return)n=a,i=o;else{for(var s=!1,l=a.child;l;){if(l===n){s=!0,n=a,i=o;break}if(l===i){s=!0,i=a,n=o;break}l=l.sibling}if(!s){for(l=o.child;l;){if(l===n){s=!0,n=o,i=a;break}if(l===i){s=!0,i=o,n=a;break}l=l.sibling}if(!s)throw Error(r(189))}}if(n.alternate!==i)throw Error(r(190))}if(3!==n.tag)throw Error(r(188));return n.stateNode.current===n?t:e}(t))?Wt(t):null}function Wt(t){if(5===t.tag||6===t.tag)return t;for(t=t.child;null!==t;){var e=Wt(t);if(null!==e)return e;t=t.sibling}return null}var Ht=a.unstable_scheduleCallback,Zt=a.unstable_cancelCallback,Yt=a.unstable_shouldYield,Xt=a.unstable_requestPaint,Kt=a.unstable_now,Qt=a.unstable_getCurrentPriorityLevel,Jt=a.unstable_ImmediatePriority,te=a.unstable_UserBlockingPriority,ee=a.unstable_NormalPriority,ne=a.unstable_LowPriority,ie=a.unstable_IdlePriority,ae=null,re=null,oe=Math.clz32?Math.clz32:function(t){return 0===(t>>>=0)?32:31-(se(t)/le|0)|0},se=Math.log,le=Math.LN2,ce=64,ue=4194304;function he(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&t;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&t;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function de(t,e){var n=t.pendingLanes;if(0===n)return 0;var i=0,a=t.suspendedLanes,r=t.pingedLanes,o=268435455&n;if(0!==o){var s=o&~a;0!==s?i=he(s):0!=(r&=o)&&(i=he(r))}else 0!=(o=n&~a)?i=he(o):0!==r&&(i=he(r));if(0===i)return 0;if(0!==e&&e!==i&&!(e&a)&&((a=i&-i)>=(r=e&-e)||16===a&&4194240&r))return e;if(4&i&&(i|=16&n),0!==(e=t.entangledLanes))for(t=t.entanglements,e&=i;0<e;)a=1<<(n=31-oe(e)),i|=t[n],e&=~a;return i}function pe(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;default:return-1}}function fe(t){return 0!=(t=-1073741825&t.pendingLanes)?t:1073741824&t?1073741824:0}function me(){var t=ce;return!(4194240&(ce<<=1))&&(ce=64),t}function ge(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function _e(t,e,n){t.pendingLanes|=e,536870912!==e&&(t.suspendedLanes=0,t.pingedLanes=0),(t=t.eventTimes)[e=31-oe(e)]=n}function ye(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var i=31-oe(n),a=1<<i;a&e|t[i]&e&&(t[i]|=e),n&=~a}}var xe=0;function ve(t){return 1<(t&=-t)?4<t?268435455&t?16:536870912:4:1}var be,we,Ae,Ce,Ee,Te=!1,Se=[],Me=null,ke=null,Ie=null,Pe=new Map,ze=new Map,De=[],Le="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Be(t,e){switch(t){case"focusin":case"focusout":Me=null;break;case"dragenter":case"dragleave":ke=null;break;case"mouseover":case"mouseout":Ie=null;break;case"pointerover":case"pointerout":Pe.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":ze.delete(e.pointerId)}}function Oe(t,e,n,i,a,r){return null===t||t.nativeEvent!==r?(t={blockedOn:e,domEventName:n,eventSystemFlags:i,nativeEvent:r,targetContainers:[a]},null!==e&&null!==(e=xa(e))&&we(e),t):(t.eventSystemFlags|=i,e=t.targetContainers,null!==a&&-1===e.indexOf(a)&&e.push(a),t)}function Re(t){var e=ya(t.target);if(null!==e){var n=Ut(e);if(null!==n)if(13===(e=n.tag)){if(null!==(e=Gt(n)))return t.blockedOn=e,void Ee(t.priority,(function(){Ae(n)}))}else if(3===e&&n.stateNode.current.memoizedState.isDehydrated)return void(t.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}t.blockedOn=null}function Fe(t){if(null!==t.blockedOn)return!1;for(var e=t.targetContainers;0<e.length;){var n=Ye(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(null!==n)return null!==(e=xa(n))&&we(e),t.blockedOn=n,!1;var i=new(n=t.nativeEvent).constructor(n.type,n);vt=i,n.target.dispatchEvent(i),vt=null,e.shift()}return!0}function Ne(t,e,n){Fe(t)&&n.delete(e)}function je(){Te=!1,null!==Me&&Fe(Me)&&(Me=null),null!==ke&&Fe(ke)&&(ke=null),null!==Ie&&Fe(Ie)&&(Ie=null),Pe.forEach(Ne),ze.forEach(Ne)}function Ve(t,e){t.blockedOn===e&&(t.blockedOn=null,Te||(Te=!0,a.unstable_scheduleCallback(a.unstable_NormalPriority,je)))}function Ue(t){function e(e){return Ve(e,t)}if(0<Se.length){Ve(Se[0],t);for(var n=1;n<Se.length;n++){var i=Se[n];i.blockedOn===t&&(i.blockedOn=null)}}for(null!==Me&&Ve(Me,t),null!==ke&&Ve(ke,t),null!==Ie&&Ve(Ie,t),Pe.forEach(e),ze.forEach(e),n=0;n<De.length;n++)(i=De[n]).blockedOn===t&&(i.blockedOn=null);for(;0<De.length&&null===(n=De[0]).blockedOn;)Re(n),null===n.blockedOn&&De.shift()}var Ge=v.ReactCurrentBatchConfig,qe=!0;function $e(t,e,n,i){var a=xe,r=Ge.transition;Ge.transition=null;try{xe=1,He(t,e,n,i)}finally{xe=a,Ge.transition=r}}function We(t,e,n,i){var a=xe,r=Ge.transition;Ge.transition=null;try{xe=4,He(t,e,n,i)}finally{xe=a,Ge.transition=r}}function He(t,e,n,i){if(qe){var a=Ye(t,e,n,i);if(null===a)qi(t,e,i,Ze,n),Be(t,i);else if(function(t,e,n,i,a){switch(e){case"focusin":return Me=Oe(Me,t,e,n,i,a),!0;case"dragenter":return ke=Oe(ke,t,e,n,i,a),!0;case"mouseover":return Ie=Oe(Ie,t,e,n,i,a),!0;case"pointerover":var r=a.pointerId;return Pe.set(r,Oe(Pe.get(r)||null,t,e,n,i,a)),!0;case"gotpointercapture":return r=a.pointerId,ze.set(r,Oe(ze.get(r)||null,t,e,n,i,a)),!0}return!1}(a,t,e,n,i))i.stopPropagation();else if(Be(t,i),4&e&&-1<Le.indexOf(t)){for(;null!==a;){var r=xa(a);if(null!==r&&be(r),null===(r=Ye(t,e,n,i))&&qi(t,e,i,Ze,n),r===a)break;a=r}null!==a&&i.stopPropagation()}else qi(t,e,i,null,n)}}var Ze=null;function Ye(t,e,n,i){if(Ze=null,null!==(t=ya(t=bt(i))))if(null===(e=Ut(t)))t=null;else if(13===(n=e.tag)){if(null!==(t=Gt(e)))return t;t=null}else if(3===n){if(e.stateNode.current.memoizedState.isDehydrated)return 3===e.tag?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Ze=t,null}function Xe(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Qt()){case Jt:return 1;case te:return 4;case ee:case ne:return 16;case ie:return 536870912;default:return 16}default:return 16}}var Ke=null,Qe=null,Je=null;function tn(){if(Je)return Je;var t,e,n=Qe,i=n.length,a="value"in Ke?Ke.value:Ke.textContent,r=a.length;for(t=0;t<i&&n[t]===a[t];t++);var o=i-t;for(e=1;e<=o&&n[i-e]===a[r-e];e++);return Je=a.slice(t,1<e?1-e:void 0)}function en(t){var e=t.keyCode;return"charCode"in t?0===(t=t.charCode)&&13===e&&(t=13):t=e,10===t&&(t=13),32<=t||13===t?t:0}function nn(){return!0}function an(){return!1}function rn(t){function e(e,n,i,a,r){for(var o in this._reactName=e,this._targetInst=i,this.type=n,this.nativeEvent=a,this.target=r,this.currentTarget=null,t)t.hasOwnProperty(o)&&(e=t[o],this[o]=e?e(a):a[o]);return this.isDefaultPrevented=(null!=a.defaultPrevented?a.defaultPrevented:!1===a.returnValue)?nn:an,this.isPropagationStopped=an,this}return R(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():"unknown"!=typeof t.returnValue&&(t.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():"unknown"!=typeof t.cancelBubble&&(t.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),e}var on,sn,ln,cn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},un=rn(cn),hn=R({},cn,{view:0,detail:0}),dn=rn(hn),pn=R({},hn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:En,button:0,buttons:0,relatedTarget:function(t){return void 0===t.relatedTarget?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==ln&&(ln&&"mousemove"===t.type?(on=t.screenX-ln.screenX,sn=t.screenY-ln.screenY):sn=on=0,ln=t),on)},movementY:function(t){return"movementY"in t?t.movementY:sn}}),fn=rn(pn),mn=rn(R({},pn,{dataTransfer:0})),gn=rn(R({},hn,{relatedTarget:0})),_n=rn(R({},cn,{animationName:0,elapsedTime:0,pseudoElement:0})),yn=R({},cn,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),xn=rn(yn),vn=rn(R({},cn,{data:0})),bn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},wn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},An={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Cn(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):!!(t=An[t])&&!!e[t]}function En(){return Cn}var Tn=R({},hn,{key:function(t){if(t.key){var e=bn[t.key]||t.key;if("Unidentified"!==e)return e}return"keypress"===t.type?13===(t=en(t))?"Enter":String.fromCharCode(t):"keydown"===t.type||"keyup"===t.type?wn[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:En,charCode:function(t){return"keypress"===t.type?en(t):0},keyCode:function(t){return"keydown"===t.type||"keyup"===t.type?t.keyCode:0},which:function(t){return"keypress"===t.type?en(t):"keydown"===t.type||"keyup"===t.type?t.keyCode:0}}),Sn=rn(Tn),Mn=rn(R({},pn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),kn=rn(R({},hn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:En})),In=rn(R({},cn,{propertyName:0,elapsedTime:0,pseudoElement:0})),Pn=R({},pn,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),zn=rn(Pn),Dn=[9,13,27,32],Ln=u&&"CompositionEvent"in window,Bn=null;u&&"documentMode"in document&&(Bn=document.documentMode);var On=u&&"TextEvent"in window&&!Bn,Rn=u&&(!Ln||Bn&&8<Bn&&11>=Bn),Fn=String.fromCharCode(32),Nn=!1;function jn(t,e){switch(t){case"keyup":return-1!==Dn.indexOf(e.keyCode);case"keydown":return 229!==e.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Vn(t){return"object"==typeof(t=t.detail)&&"data"in t?t.data:null}var Un=!1,Gn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function qn(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return"input"===e?!!Gn[t.type]:"textarea"===e}function $n(t,e,n,i){Tt(i),0<(e=Wi(e,"onChange")).length&&(n=new un("onChange","change",null,n,i),t.push({event:n,listeners:e}))}var Wn=null,Hn=null;function Zn(t){Fi(t,0)}function Yn(t){if(H(va(t)))return t}function Xn(t,e){if("change"===t)return e}var Kn=!1;if(u){var Qn;if(u){var Jn="oninput"in document;if(!Jn){var ti=document.createElement("div");ti.setAttribute("oninput","return;"),Jn="function"==typeof ti.oninput}Qn=Jn}else Qn=!1;Kn=Qn&&(!document.documentMode||9<document.documentMode)}function ei(){Wn&&(Wn.detachEvent("onpropertychange",ni),Hn=Wn=null)}function ni(t){if("value"===t.propertyName&&Yn(Hn)){var e=[];$n(e,Hn,t,bt(t)),Pt(Zn,e)}}function ii(t,e,n){"focusin"===t?(ei(),Hn=n,(Wn=e).attachEvent("onpropertychange",ni)):"focusout"===t&&ei()}function ai(t){if("selectionchange"===t||"keyup"===t||"keydown"===t)return Yn(Hn)}function ri(t,e){if("click"===t)return Yn(e)}function oi(t,e){if("input"===t||"change"===t)return Yn(e)}var si="function"==typeof Object.is?Object.is:function(t,e){return t===e&&(0!==t||1/t==1/e)||t!=t&&e!=e};function li(t,e){if(si(t,e))return!0;if("object"!=typeof t||null===t||"object"!=typeof e||null===e)return!1;var n=Object.keys(t),i=Object.keys(e);if(n.length!==i.length)return!1;for(i=0;i<n.length;i++){var a=n[i];if(!h.call(e,a)||!si(t[a],e[a]))return!1}return!0}function ci(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function ui(t,e){var n,i=ci(t);for(t=0;i;){if(3===i.nodeType){if(n=t+i.textContent.length,t<=e&&n>=e)return{node:i,offset:e-t};t=n}t:{for(;i;){if(i.nextSibling){i=i.nextSibling;break t}i=i.parentNode}i=void 0}i=ci(i)}}function hi(t,e){return!(!t||!e)&&(t===e||(!t||3!==t.nodeType)&&(e&&3===e.nodeType?hi(t,e.parentNode):"contains"in t?t.contains(e):!!t.compareDocumentPosition&&!!(16&t.compareDocumentPosition(e))))}function di(){for(var t=window,e=Z();e instanceof t.HTMLIFrameElement;){try{var n="string"==typeof e.contentWindow.location.href}catch(t){n=!1}if(!n)break;e=Z((t=e.contentWindow).document)}return e}function pi(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&("input"===e&&("text"===t.type||"search"===t.type||"tel"===t.type||"url"===t.type||"password"===t.type)||"textarea"===e||"true"===t.contentEditable)}function fi(t){var e=di(),n=t.focusedElem,i=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&hi(n.ownerDocument.documentElement,n)){if(null!==i&&pi(n))if(e=i.start,void 0===(t=i.end)&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if((t=(e=n.ownerDocument||document)&&e.defaultView||window).getSelection){t=t.getSelection();var a=n.textContent.length,r=Math.min(i.start,a);i=void 0===i.end?r:Math.min(i.end,a),!t.extend&&r>i&&(a=i,i=r,r=a),a=ui(n,r);var o=ui(n,i);a&&o&&(1!==t.rangeCount||t.anchorNode!==a.node||t.anchorOffset!==a.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&((e=e.createRange()).setStart(a.node,a.offset),t.removeAllRanges(),r>i?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}for(e=[],t=n;t=t.parentNode;)1===t.nodeType&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for("function"==typeof n.focus&&n.focus(),n=0;n<e.length;n++)(t=e[n]).element.scrollLeft=t.left,t.element.scrollTop=t.top}}var mi=u&&"documentMode"in document&&11>=document.documentMode,gi=null,_i=null,yi=null,xi=!1;function vi(t,e,n){var i=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;xi||null==gi||gi!==Z(i)||(i="selectionStart"in(i=gi)&&pi(i)?{start:i.selectionStart,end:i.selectionEnd}:{anchorNode:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset},yi&&li(yi,i)||(yi=i,0<(i=Wi(_i,"onSelect")).length&&(e=new un("onSelect","select",null,e,n),t.push({event:e,listeners:i}),e.target=gi)))}function bi(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var wi={animationend:bi("Animation","AnimationEnd"),animationiteration:bi("Animation","AnimationIteration"),animationstart:bi("Animation","AnimationStart"),transitionend:bi("Transition","TransitionEnd")},Ai={},Ci={};function Ei(t){if(Ai[t])return Ai[t];if(!wi[t])return t;var e,n=wi[t];for(e in n)if(n.hasOwnProperty(e)&&e in Ci)return Ai[t]=n[e];return t}u&&(Ci=document.createElement("div").style,"AnimationEvent"in window||(delete wi.animationend.animation,delete wi.animationiteration.animation,delete wi.animationstart.animation),"TransitionEvent"in window||delete wi.transitionend.transition);var Ti=Ei("animationend"),Si=Ei("animationiteration"),Mi=Ei("animationstart"),ki=Ei("transitionend"),Ii=new Map,Pi="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function zi(t,e){Ii.set(t,e),l(e,[t])}for(var Di=0;Di<Pi.length;Di++){var Li=Pi[Di];zi(Li.toLowerCase(),"on"+(Li[0].toUpperCase()+Li.slice(1)))}zi(Ti,"onAnimationEnd"),zi(Si,"onAnimationIteration"),zi(Mi,"onAnimationStart"),zi("dblclick","onDoubleClick"),zi("focusin","onFocus"),zi("focusout","onBlur"),zi(ki,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Bi="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Oi=new Set("cancel close invalid load scroll toggle".split(" ").concat(Bi));function Ri(t,e,n){var i=t.type||"unknown-event";t.currentTarget=n,function(t,e,n,i,a,o,s,l,c){if(Vt.apply(this,arguments),Ot){if(!Ot)throw Error(r(198));var u=Rt;Ot=!1,Rt=null,Ft||(Ft=!0,Nt=u)}}(i,e,void 0,t),t.currentTarget=null}function Fi(t,e){e=!!(4&e);for(var n=0;n<t.length;n++){var i=t[n],a=i.event;i=i.listeners;t:{var r=void 0;if(e)for(var o=i.length-1;0<=o;o--){var s=i[o],l=s.instance,c=s.currentTarget;if(s=s.listener,l!==r&&a.isPropagationStopped())break t;Ri(a,s,c),r=l}else for(o=0;o<i.length;o++){if(l=(s=i[o]).instance,c=s.currentTarget,s=s.listener,l!==r&&a.isPropagationStopped())break t;Ri(a,s,c),r=l}}}if(Ft)throw t=Nt,Ft=!1,Nt=null,t}function Ni(t,e){var n=e[ma];void 0===n&&(n=e[ma]=new Set);var i=t+"__bubble";n.has(i)||(Gi(e,t,2,!1),n.add(i))}function ji(t,e,n){var i=0;e&&(i|=4),Gi(n,t,i,e)}var Vi="_reactListening"+Math.random().toString(36).slice(2);function Ui(t){if(!t[Vi]){t[Vi]=!0,o.forEach((function(e){"selectionchange"!==e&&(Oi.has(e)||ji(e,!1,t),ji(e,!0,t))}));var e=9===t.nodeType?t:t.ownerDocument;null===e||e[Vi]||(e[Vi]=!0,ji("selectionchange",!1,e))}}function Gi(t,e,n,i){switch(Xe(e)){case 1:var a=$e;break;case 4:a=We;break;default:a=He}n=a.bind(null,e,n,t),a=void 0,!Dt||"touchstart"!==e&&"touchmove"!==e&&"wheel"!==e||(a=!0),i?void 0!==a?t.addEventListener(e,n,{capture:!0,passive:a}):t.addEventListener(e,n,!0):void 0!==a?t.addEventListener(e,n,{passive:a}):t.addEventListener(e,n,!1)}function qi(t,e,n,i,a){var r=i;if(!(1&e||2&e||null===i))t:for(;;){if(null===i)return;var o=i.tag;if(3===o||4===o){var s=i.stateNode.containerInfo;if(s===a||8===s.nodeType&&s.parentNode===a)break;if(4===o)for(o=i.return;null!==o;){var l=o.tag;if((3===l||4===l)&&((l=o.stateNode.containerInfo)===a||8===l.nodeType&&l.parentNode===a))return;o=o.return}for(;null!==s;){if(null===(o=ya(s)))return;if(5===(l=o.tag)||6===l){i=r=o;continue t}s=s.parentNode}}i=i.return}Pt((function(){var i=r,a=bt(n),o=[];t:{var s=Ii.get(t);if(void 0!==s){var l=un,c=t;switch(t){case"keypress":if(0===en(n))break t;case"keydown":case"keyup":l=Sn;break;case"focusin":c="focus",l=gn;break;case"focusout":c="blur",l=gn;break;case"beforeblur":case"afterblur":l=gn;break;case"click":if(2===n.button)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=fn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=mn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=kn;break;case Ti:case Si:case Mi:l=_n;break;case ki:l=In;break;case"scroll":l=dn;break;case"wheel":l=zn;break;case"copy":case"cut":case"paste":l=xn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=Mn}var u=!!(4&e),h=!u&&"scroll"===t,d=u?null!==s?s+"Capture":null:s;u=[];for(var p,f=i;null!==f;){var m=(p=f).stateNode;if(5===p.tag&&null!==m&&(p=m,null!==d&&null!=(m=zt(f,d))&&u.push($i(f,m,p))),h)break;f=f.return}0<u.length&&(s=new l(s,c,null,n,a),o.push({event:s,listeners:u}))}}if(!(7&e)){if(l="mouseout"===t||"pointerout"===t,(!(s="mouseover"===t||"pointerover"===t)||n===vt||!(c=n.relatedTarget||n.fromElement)||!ya(c)&&!c[fa])&&(l||s)&&(s=a.window===a?a:(s=a.ownerDocument)?s.defaultView||s.parentWindow:window,l?(l=i,null!==(c=(c=n.relatedTarget||n.toElement)?ya(c):null)&&(c!==(h=Ut(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(l=null,c=i),l!==c)){if(u=fn,m="onMouseLeave",d="onMouseEnter",f="mouse","pointerout"!==t&&"pointerover"!==t||(u=Mn,m="onPointerLeave",d="onPointerEnter",f="pointer"),h=null==l?s:va(l),p=null==c?s:va(c),(s=new u(m,f+"leave",l,n,a)).target=h,s.relatedTarget=p,m=null,ya(a)===i&&((u=new u(d,f+"enter",c,n,a)).target=p,u.relatedTarget=h,m=u),h=m,l&&c)t:{for(d=c,f=0,p=u=l;p;p=Hi(p))f++;for(p=0,m=d;m;m=Hi(m))p++;for(;0<f-p;)u=Hi(u),f--;for(;0<p-f;)d=Hi(d),p--;for(;f--;){if(u===d||null!==d&&u===d.alternate)break t;u=Hi(u),d=Hi(d)}u=null}else u=null;null!==l&&Zi(o,s,l,u,!1),null!==c&&null!==h&&Zi(o,h,c,u,!0)}if("select"===(l=(s=i?va(i):window).nodeName&&s.nodeName.toLowerCase())||"input"===l&&"file"===s.type)var g=Xn;else if(qn(s))if(Kn)g=oi;else{g=ai;var _=ii}else(l=s.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===s.type||"radio"===s.type)&&(g=ri);switch(g&&(g=g(t,i))?$n(o,g,n,a):(_&&_(t,s,i),"focusout"===t&&(_=s._wrapperState)&&_.controlled&&"number"===s.type&&tt(s,"number",s.value)),_=i?va(i):window,t){case"focusin":(qn(_)||"true"===_.contentEditable)&&(gi=_,_i=i,yi=null);break;case"focusout":yi=_i=gi=null;break;case"mousedown":xi=!0;break;case"contextmenu":case"mouseup":case"dragend":xi=!1,vi(o,n,a);break;case"selectionchange":if(mi)break;case"keydown":case"keyup":vi(o,n,a)}var y;if(Ln)t:{switch(t){case"compositionstart":var x="onCompositionStart";break t;case"compositionend":x="onCompositionEnd";break t;case"compositionupdate":x="onCompositionUpdate";break t}x=void 0}else Un?jn(t,n)&&(x="onCompositionEnd"):"keydown"===t&&229===n.keyCode&&(x="onCompositionStart");x&&(Rn&&"ko"!==n.locale&&(Un||"onCompositionStart"!==x?"onCompositionEnd"===x&&Un&&(y=tn()):(Qe="value"in(Ke=a)?Ke.value:Ke.textContent,Un=!0)),0<(_=Wi(i,x)).length&&(x=new vn(x,t,null,n,a),o.push({event:x,listeners:_}),(y||null!==(y=Vn(n)))&&(x.data=y))),(y=On?function(t,e){switch(t){case"compositionend":return Vn(e);case"keypress":return 32!==e.which?null:(Nn=!0,Fn);case"textInput":return(t=e.data)===Fn&&Nn?null:t;default:return null}}(t,n):function(t,e){if(Un)return"compositionend"===t||!Ln&&jn(t,e)?(t=tn(),Je=Qe=Ke=null,Un=!1,t):null;switch(t){case"paste":default:return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Rn&&"ko"!==e.locale?null:e.data}}(t,n))&&0<(i=Wi(i,"onBeforeInput")).length&&(a=new vn("onBeforeInput","beforeinput",null,n,a),o.push({event:a,listeners:i}),a.data=y)}Fi(o,e)}))}function $i(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Wi(t,e){for(var n=e+"Capture",i=[];null!==t;){var a=t,r=a.stateNode;5===a.tag&&null!==r&&(a=r,null!=(r=zt(t,n))&&i.unshift($i(t,r,a)),null!=(r=zt(t,e))&&i.push($i(t,r,a))),t=t.return}return i}function Hi(t){if(null===t)return null;do{t=t.return}while(t&&5!==t.tag);return t||null}function Zi(t,e,n,i,a){for(var r=e._reactName,o=[];null!==n&&n!==i;){var s=n,l=s.alternate,c=s.stateNode;if(null!==l&&l===i)break;5===s.tag&&null!==c&&(s=c,a?null!=(l=zt(n,r))&&o.unshift($i(n,l,s)):a||null!=(l=zt(n,r))&&o.push($i(n,l,s))),n=n.return}0!==o.length&&t.push({event:e,listeners:o})}var Yi=/\r\n?/g,Xi=/\u0000|\uFFFD/g;function Ki(t){return("string"==typeof t?t:""+t).replace(Yi,"\n").replace(Xi,"")}function Qi(t,e,n){if(e=Ki(e),Ki(t)!==e&&n)throw Error(r(425))}function Ji(){}var ta=null,ea=null;function na(t,e){return"textarea"===t||"noscript"===t||"string"==typeof e.children||"number"==typeof e.children||"object"==typeof e.dangerouslySetInnerHTML&&null!==e.dangerouslySetInnerHTML&&null!=e.dangerouslySetInnerHTML.__html}var ia="function"==typeof setTimeout?setTimeout:void 0,aa="function"==typeof clearTimeout?clearTimeout:void 0,ra="function"==typeof Promise?Promise:void 0,oa="function"==typeof queueMicrotask?queueMicrotask:void 0!==ra?function(t){return ra.resolve(null).then(t).catch(sa)}:ia;function sa(t){setTimeout((function(){throw t}))}function la(t,e){var n=e,i=0;do{var a=n.nextSibling;if(t.removeChild(n),a&&8===a.nodeType)if("/$"===(n=a.data)){if(0===i)return t.removeChild(a),void Ue(e);i--}else"$"!==n&&"$?"!==n&&"$!"!==n||i++;n=a}while(n);Ue(e)}function ca(t){for(;null!=t;t=t.nextSibling){var e=t.nodeType;if(1===e||3===e)break;if(8===e){if("$"===(e=t.data)||"$!"===e||"$?"===e)break;if("/$"===e)return null}}return t}function ua(t){t=t.previousSibling;for(var e=0;t;){if(8===t.nodeType){var n=t.data;if("$"===n||"$!"===n||"$?"===n){if(0===e)return t;e--}else"/$"===n&&e++}t=t.previousSibling}return null}var ha=Math.random().toString(36).slice(2),da="__reactFiber$"+ha,pa="__reactProps$"+ha,fa="__reactContainer$"+ha,ma="__reactEvents$"+ha,ga="__reactListeners$"+ha,_a="__reactHandles$"+ha;function ya(t){var e=t[da];if(e)return e;for(var n=t.parentNode;n;){if(e=n[fa]||n[da]){if(n=e.alternate,null!==e.child||null!==n&&null!==n.child)for(t=ua(t);null!==t;){if(n=t[da])return n;t=ua(t)}return e}n=(t=n).parentNode}return null}function xa(t){return!(t=t[da]||t[fa])||5!==t.tag&&6!==t.tag&&13!==t.tag&&3!==t.tag?null:t}function va(t){if(5===t.tag||6===t.tag)return t.stateNode;throw Error(r(33))}function ba(t){return t[pa]||null}var wa=[],Aa=-1;function Ca(t){return{current:t}}function Ea(t){0>Aa||(t.current=wa[Aa],wa[Aa]=null,Aa--)}function Ta(t,e){Aa++,wa[Aa]=t.current,t.current=e}var Sa={},Ma=Ca(Sa),ka=Ca(!1),Ia=Sa;function Pa(t,e){var n=t.type.contextTypes;if(!n)return Sa;var i=t.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===e)return i.__reactInternalMemoizedMaskedChildContext;var a,r={};for(a in n)r[a]=e[a];return i&&((t=t.stateNode).__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=r),r}function za(t){return null!=t.childContextTypes}function Da(){Ea(ka),Ea(Ma)}function La(t,e,n){if(Ma.current!==Sa)throw Error(r(168));Ta(Ma,e),Ta(ka,n)}function Ba(t,e,n){var i=t.stateNode;if(e=e.childContextTypes,"function"!=typeof i.getChildContext)return n;for(var a in i=i.getChildContext())if(!(a in e))throw Error(r(108,G(t)||"Unknown",a));return R({},n,i)}function Oa(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Sa,Ia=Ma.current,Ta(Ma,t),Ta(ka,ka.current),!0}function Ra(t,e,n){var i=t.stateNode;if(!i)throw Error(r(169));n?(t=Ba(t,e,Ia),i.__reactInternalMemoizedMergedChildContext=t,Ea(ka),Ea(Ma),Ta(Ma,t)):Ea(ka),Ta(ka,n)}var Fa=null,Na=!1,ja=!1;function Va(t){null===Fa?Fa=[t]:Fa.push(t)}function Ua(){if(!ja&&null!==Fa){ja=!0;var t=0,e=xe;try{var n=Fa;for(xe=1;t<n.length;t++){var i=n[t];do{i=i(!0)}while(null!==i)}Fa=null,Na=!1}catch(e){throw null!==Fa&&(Fa=Fa.slice(t+1)),Ht(Jt,Ua),e}finally{xe=e,ja=!1}}return null}var Ga=[],qa=0,$a=null,Wa=0,Ha=[],Za=0,Ya=null,Xa=1,Ka="";function Qa(t,e){Ga[qa++]=Wa,Ga[qa++]=$a,$a=t,Wa=e}function Ja(t,e,n){Ha[Za++]=Xa,Ha[Za++]=Ka,Ha[Za++]=Ya,Ya=t;var i=Xa;t=Ka;var a=32-oe(i)-1;i&=~(1<<a),n+=1;var r=32-oe(e)+a;if(30<r){var o=a-a%5;r=(i&(1<<o)-1).toString(32),i>>=o,a-=o,Xa=1<<32-oe(e)+a|n<<a|i,Ka=r+t}else Xa=1<<r|n<<a|i,Ka=t}function tr(t){null!==t.return&&(Qa(t,1),Ja(t,1,0))}function er(t){for(;t===$a;)$a=Ga[--qa],Ga[qa]=null,Wa=Ga[--qa],Ga[qa]=null;for(;t===Ya;)Ya=Ha[--Za],Ha[Za]=null,Ka=Ha[--Za],Ha[Za]=null,Xa=Ha[--Za],Ha[Za]=null}var nr=null,ir=null,ar=!1,rr=null;function or(t,e){var n=Pc(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,null===(e=t.deletions)?(t.deletions=[n],t.flags|=16):e.push(n)}function sr(t,e){switch(t.tag){case 5:var n=t.type;return null!==(e=1!==e.nodeType||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e)&&(t.stateNode=e,nr=t,ir=ca(e.firstChild),!0);case 6:return null!==(e=""===t.pendingProps||3!==e.nodeType?null:e)&&(t.stateNode=e,nr=t,ir=null,!0);case 13:return null!==(e=8!==e.nodeType?null:e)&&(n=null!==Ya?{id:Xa,overflow:Ka}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},(n=Pc(18,null,null,0)).stateNode=e,n.return=t,t.child=n,nr=t,ir=null,!0);default:return!1}}function lr(t){return!(!(1&t.mode)||128&t.flags)}function cr(t){if(ar){var e=ir;if(e){var n=e;if(!sr(t,e)){if(lr(t))throw Error(r(418));e=ca(n.nextSibling);var i=nr;e&&sr(t,e)?or(i,n):(t.flags=-4097&t.flags|2,ar=!1,nr=t)}}else{if(lr(t))throw Error(r(418));t.flags=-4097&t.flags|2,ar=!1,nr=t}}}function ur(t){for(t=t.return;null!==t&&5!==t.tag&&3!==t.tag&&13!==t.tag;)t=t.return;nr=t}function hr(t){if(t!==nr)return!1;if(!ar)return ur(t),ar=!0,!1;var e;if((e=3!==t.tag)&&!(e=5!==t.tag)&&(e="head"!==(e=t.type)&&"body"!==e&&!na(t.type,t.memoizedProps)),e&&(e=ir)){if(lr(t))throw dr(),Error(r(418));for(;e;)or(t,e),e=ca(e.nextSibling)}if(ur(t),13===t.tag){if(!(t=null!==(t=t.memoizedState)?t.dehydrated:null))throw Error(r(317));t:{for(t=t.nextSibling,e=0;t;){if(8===t.nodeType){var n=t.data;if("/$"===n){if(0===e){ir=ca(t.nextSibling);break t}e--}else"$"!==n&&"$!"!==n&&"$?"!==n||e++}t=t.nextSibling}ir=null}}else ir=nr?ca(t.stateNode.nextSibling):null;return!0}function dr(){for(var t=ir;t;)t=ca(t.nextSibling)}function pr(){ir=nr=null,ar=!1}function fr(t){null===rr?rr=[t]:rr.push(t)}var mr=v.ReactCurrentBatchConfig;function gr(t,e,n){if(null!==(t=n.ref)&&"function"!=typeof t&&"object"!=typeof t){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(r(309));var i=n.stateNode}if(!i)throw Error(r(147,t));var a=i,o=""+t;return null!==e&&null!==e.ref&&"function"==typeof e.ref&&e.ref._stringRef===o?e.ref:(e=function(t){var e=a.refs;null===t?delete e[o]:e[o]=t},e._stringRef=o,e)}if("string"!=typeof t)throw Error(r(284));if(!n._owner)throw Error(r(290,t))}return t}function _r(t,e){throw t=Object.prototype.toString.call(e),Error(r(31,"[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function yr(t){return(0,t._init)(t._payload)}function xr(t){function e(e,n){if(t){var i=e.deletions;null===i?(e.deletions=[n],e.flags|=16):i.push(n)}}function n(n,i){if(!t)return null;for(;null!==i;)e(n,i),i=i.sibling;return null}function i(t,e){for(t=new Map;null!==e;)null!==e.key?t.set(e.key,e):t.set(e.index,e),e=e.sibling;return t}function a(t,e){return(t=Dc(t,e)).index=0,t.sibling=null,t}function o(e,n,i){return e.index=i,t?null!==(i=e.alternate)?(i=i.index)<n?(e.flags|=2,n):i:(e.flags|=2,n):(e.flags|=1048576,n)}function s(e){return t&&null===e.alternate&&(e.flags|=2),e}function l(t,e,n,i){return null===e||6!==e.tag?((e=Rc(n,t.mode,i)).return=t,e):((e=a(e,n)).return=t,e)}function c(t,e,n,i){var r=n.type;return r===A?h(t,e,n.props.children,i,n.key):null!==e&&(e.elementType===r||"object"==typeof r&&null!==r&&r.$$typeof===z&&yr(r)===e.type)?((i=a(e,n.props)).ref=gr(t,e,n),i.return=t,i):((i=Lc(n.type,n.key,n.props,null,t.mode,i)).ref=gr(t,e,n),i.return=t,i)}function u(t,e,n,i){return null===e||4!==e.tag||e.stateNode.containerInfo!==n.containerInfo||e.stateNode.implementation!==n.implementation?((e=Fc(n,t.mode,i)).return=t,e):((e=a(e,n.children||[])).return=t,e)}function h(t,e,n,i,r){return null===e||7!==e.tag?((e=Bc(n,t.mode,i,r)).return=t,e):((e=a(e,n)).return=t,e)}function d(t,e,n){if("string"==typeof e&&""!==e||"number"==typeof e)return(e=Rc(""+e,t.mode,n)).return=t,e;if("object"==typeof e&&null!==e){switch(e.$$typeof){case b:return(n=Lc(e.type,e.key,e.props,null,t.mode,n)).ref=gr(t,null,e),n.return=t,n;case w:return(e=Fc(e,t.mode,n)).return=t,e;case z:return d(t,(0,e._init)(e._payload),n)}if(et(e)||B(e))return(e=Bc(e,t.mode,n,null)).return=t,e;_r(t,e)}return null}function p(t,e,n,i){var a=null!==e?e.key:null;if("string"==typeof n&&""!==n||"number"==typeof n)return null!==a?null:l(t,e,""+n,i);if("object"==typeof n&&null!==n){switch(n.$$typeof){case b:return n.key===a?c(t,e,n,i):null;case w:return n.key===a?u(t,e,n,i):null;case z:return p(t,e,(a=n._init)(n._payload),i)}if(et(n)||B(n))return null!==a?null:h(t,e,n,i,null);_r(t,n)}return null}function f(t,e,n,i,a){if("string"==typeof i&&""!==i||"number"==typeof i)return l(e,t=t.get(n)||null,""+i,a);if("object"==typeof i&&null!==i){switch(i.$$typeof){case b:return c(e,t=t.get(null===i.key?n:i.key)||null,i,a);case w:return u(e,t=t.get(null===i.key?n:i.key)||null,i,a);case z:return f(t,e,n,(0,i._init)(i._payload),a)}if(et(i)||B(i))return h(e,t=t.get(n)||null,i,a,null);_r(e,i)}return null}function m(a,r,s,l){for(var c=null,u=null,h=r,m=r=0,g=null;null!==h&&m<s.length;m++){h.index>m?(g=h,h=null):g=h.sibling;var _=p(a,h,s[m],l);if(null===_){null===h&&(h=g);break}t&&h&&null===_.alternate&&e(a,h),r=o(_,r,m),null===u?c=_:u.sibling=_,u=_,h=g}if(m===s.length)return n(a,h),ar&&Qa(a,m),c;if(null===h){for(;m<s.length;m++)null!==(h=d(a,s[m],l))&&(r=o(h,r,m),null===u?c=h:u.sibling=h,u=h);return ar&&Qa(a,m),c}for(h=i(a,h);m<s.length;m++)null!==(g=f(h,a,m,s[m],l))&&(t&&null!==g.alternate&&h.delete(null===g.key?m:g.key),r=o(g,r,m),null===u?c=g:u.sibling=g,u=g);return t&&h.forEach((function(t){return e(a,t)})),ar&&Qa(a,m),c}function g(a,s,l,c){var u=B(l);if("function"!=typeof u)throw Error(r(150));if(null==(l=u.call(l)))throw Error(r(151));for(var h=u=null,m=s,g=s=0,_=null,y=l.next();null!==m&&!y.done;g++,y=l.next()){m.index>g?(_=m,m=null):_=m.sibling;var x=p(a,m,y.value,c);if(null===x){null===m&&(m=_);break}t&&m&&null===x.alternate&&e(a,m),s=o(x,s,g),null===h?u=x:h.sibling=x,h=x,m=_}if(y.done)return n(a,m),ar&&Qa(a,g),u;if(null===m){for(;!y.done;g++,y=l.next())null!==(y=d(a,y.value,c))&&(s=o(y,s,g),null===h?u=y:h.sibling=y,h=y);return ar&&Qa(a,g),u}for(m=i(a,m);!y.done;g++,y=l.next())null!==(y=f(m,a,g,y.value,c))&&(t&&null!==y.alternate&&m.delete(null===y.key?g:y.key),s=o(y,s,g),null===h?u=y:h.sibling=y,h=y);return t&&m.forEach((function(t){return e(a,t)})),ar&&Qa(a,g),u}return function t(i,r,o,l){if("object"==typeof o&&null!==o&&o.type===A&&null===o.key&&(o=o.props.children),"object"==typeof o&&null!==o){switch(o.$$typeof){case b:t:{for(var c=o.key,u=r;null!==u;){if(u.key===c){if((c=o.type)===A){if(7===u.tag){n(i,u.sibling),(r=a(u,o.props.children)).return=i,i=r;break t}}else if(u.elementType===c||"object"==typeof c&&null!==c&&c.$$typeof===z&&yr(c)===u.type){n(i,u.sibling),(r=a(u,o.props)).ref=gr(i,u,o),r.return=i,i=r;break t}n(i,u);break}e(i,u),u=u.sibling}o.type===A?((r=Bc(o.props.children,i.mode,l,o.key)).return=i,i=r):((l=Lc(o.type,o.key,o.props,null,i.mode,l)).ref=gr(i,r,o),l.return=i,i=l)}return s(i);case w:t:{for(u=o.key;null!==r;){if(r.key===u){if(4===r.tag&&r.stateNode.containerInfo===o.containerInfo&&r.stateNode.implementation===o.implementation){n(i,r.sibling),(r=a(r,o.children||[])).return=i,i=r;break t}n(i,r);break}e(i,r),r=r.sibling}(r=Fc(o,i.mode,l)).return=i,i=r}return s(i);case z:return t(i,r,(u=o._init)(o._payload),l)}if(et(o))return m(i,r,o,l);if(B(o))return g(i,r,o,l);_r(i,o)}return"string"==typeof o&&""!==o||"number"==typeof o?(o=""+o,null!==r&&6===r.tag?(n(i,r.sibling),(r=a(r,o)).return=i,i=r):(n(i,r),(r=Rc(o,i.mode,l)).return=i,i=r),s(i)):n(i,r)}}var vr=xr(!0),br=xr(!1),wr=Ca(null),Ar=null,Cr=null,Er=null;function Tr(){Er=Cr=Ar=null}function Sr(t){var e=wr.current;Ea(wr),t._currentValue=e}function Mr(t,e,n){for(;null!==t;){var i=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,null!==i&&(i.childLanes|=e)):null!==i&&(i.childLanes&e)!==e&&(i.childLanes|=e),t===n)break;t=t.return}}function kr(t,e){Ar=t,Er=Cr=null,null!==(t=t.dependencies)&&null!==t.firstContext&&(!!(t.lanes&e)&&(xs=!0),t.firstContext=null)}function Ir(t){var e=t._currentValue;if(Er!==t)if(t={context:t,memoizedValue:e,next:null},null===Cr){if(null===Ar)throw Error(r(308));Cr=t,Ar.dependencies={lanes:0,firstContext:t}}else Cr=Cr.next=t;return e}var Pr=null;function zr(t){null===Pr?Pr=[t]:Pr.push(t)}function Dr(t,e,n,i){var a=e.interleaved;return null===a?(n.next=n,zr(e)):(n.next=a.next,a.next=n),e.interleaved=n,Lr(t,i)}function Lr(t,e){t.lanes|=e;var n=t.alternate;for(null!==n&&(n.lanes|=e),n=t,t=t.return;null!==t;)t.childLanes|=e,null!==(n=t.alternate)&&(n.childLanes|=e),n=t,t=t.return;return 3===n.tag?n.stateNode:null}var Br=!1;function Or(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Rr(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Fr(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Nr(t,e,n){var i=t.updateQueue;if(null===i)return null;if(i=i.shared,2&Ml){var a=i.pending;return null===a?e.next=e:(e.next=a.next,a.next=e),i.pending=e,Lr(t,n)}return null===(a=i.interleaved)?(e.next=e,zr(i)):(e.next=a.next,a.next=e),i.interleaved=e,Lr(t,n)}function jr(t,e,n){if(null!==(e=e.updateQueue)&&(e=e.shared,4194240&n)){var i=e.lanes;n|=i&=t.pendingLanes,e.lanes=n,ye(t,n)}}function Vr(t,e){var n=t.updateQueue,i=t.alternate;if(null!==i&&n===(i=i.updateQueue)){var a=null,r=null;if(null!==(n=n.firstBaseUpdate)){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===r?a=r=o:r=r.next=o,n=n.next}while(null!==n);null===r?a=r=e:r=r.next=e}else a=r=e;return n={baseState:i.baseState,firstBaseUpdate:a,lastBaseUpdate:r,shared:i.shared,effects:i.effects},void(t.updateQueue=n)}null===(t=n.lastBaseUpdate)?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Ur(t,e,n,i){var a=t.updateQueue;Br=!1;var r=a.firstBaseUpdate,o=a.lastBaseUpdate,s=a.shared.pending;if(null!==s){a.shared.pending=null;var l=s,c=l.next;l.next=null,null===o?r=c:o.next=c,o=l;var u=t.alternate;null!==u&&(s=(u=u.updateQueue).lastBaseUpdate)!==o&&(null===s?u.firstBaseUpdate=c:s.next=c,u.lastBaseUpdate=l)}if(null!==r){var h=a.baseState;for(o=0,u=c=l=null,s=r;;){var d=s.lane,p=s.eventTime;if((i&d)===d){null!==u&&(u=u.next={eventTime:p,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});t:{var f=t,m=s;switch(d=e,p=n,m.tag){case 1:if("function"==typeof(f=m.payload)){h=f.call(p,h,d);break t}h=f;break t;case 3:f.flags=-65537&f.flags|128;case 0:if(null==(d="function"==typeof(f=m.payload)?f.call(p,h,d):f))break t;h=R({},h,d);break t;case 2:Br=!0}}null!==s.callback&&0!==s.lane&&(t.flags|=64,null===(d=a.effects)?a.effects=[s]:d.push(s))}else p={eventTime:p,lane:d,tag:s.tag,payload:s.payload,callback:s.callback,next:null},null===u?(c=u=p,l=h):u=u.next=p,o|=d;if(null===(s=s.next)){if(null===(s=a.shared.pending))break;s=(d=s).next,d.next=null,a.lastBaseUpdate=d,a.shared.pending=null}}if(null===u&&(l=h),a.baseState=l,a.firstBaseUpdate=c,a.lastBaseUpdate=u,null!==(e=a.shared.interleaved)){a=e;do{o|=a.lane,a=a.next}while(a!==e)}else null===r&&(a.shared.lanes=0);Ol|=o,t.lanes=o,t.memoizedState=h}}function Gr(t,e,n){if(t=e.effects,e.effects=null,null!==t)for(e=0;e<t.length;e++){var i=t[e],a=i.callback;if(null!==a){if(i.callback=null,i=n,"function"!=typeof a)throw Error(r(191,a));a.call(i)}}}var qr={},$r=Ca(qr),Wr=Ca(qr),Hr=Ca(qr);function Zr(t){if(t===qr)throw Error(r(174));return t}function Yr(t,e){switch(Ta(Hr,e),Ta(Wr,t),Ta($r,qr),t=e.nodeType){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:lt(null,"");break;default:e=lt(e=(t=8===t?e.parentNode:e).namespaceURI||null,t=t.tagName)}Ea($r),Ta($r,e)}function Xr(){Ea($r),Ea(Wr),Ea(Hr)}function Kr(t){Zr(Hr.current);var e=Zr($r.current),n=lt(e,t.type);e!==n&&(Ta(Wr,t),Ta($r,n))}function Qr(t){Wr.current===t&&(Ea($r),Ea(Wr))}var Jr=Ca(0);function to(t){for(var e=t;null!==e;){if(13===e.tag){var n=e.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return e}else if(19===e.tag&&void 0!==e.memoizedProps.revealOrder){if(128&e.flags)return e}else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break;for(;null===e.sibling;){if(null===e.return||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var eo=[];function no(){for(var t=0;t<eo.length;t++)eo[t]._workInProgressVersionPrimary=null;eo.length=0}var io=v.ReactCurrentDispatcher,ao=v.ReactCurrentBatchConfig,ro=0,oo=null,so=null,lo=null,co=!1,uo=!1,ho=0,po=0;function fo(){throw Error(r(321))}function mo(t,e){if(null===e)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!si(t[n],e[n]))return!1;return!0}function go(t,e,n,i,a,o){if(ro=o,oo=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,io.current=null===t||null===t.memoizedState?Jo:ts,t=n(i,a),uo){o=0;do{if(uo=!1,ho=0,25<=o)throw Error(r(301));o+=1,lo=so=null,e.updateQueue=null,io.current=es,t=n(i,a)}while(uo)}if(io.current=Qo,e=null!==so&&null!==so.next,ro=0,lo=so=oo=null,co=!1,e)throw Error(r(300));return t}function _o(){var t=0!==ho;return ho=0,t}function yo(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===lo?oo.memoizedState=lo=t:lo=lo.next=t,lo}function xo(){if(null===so){var t=oo.alternate;t=null!==t?t.memoizedState:null}else t=so.next;var e=null===lo?oo.memoizedState:lo.next;if(null!==e)lo=e,so=t;else{if(null===t)throw Error(r(310));t={memoizedState:(so=t).memoizedState,baseState:so.baseState,baseQueue:so.baseQueue,queue:so.queue,next:null},null===lo?oo.memoizedState=lo=t:lo=lo.next=t}return lo}function vo(t,e){return"function"==typeof e?e(t):e}function bo(t){var e=xo(),n=e.queue;if(null===n)throw Error(r(311));n.lastRenderedReducer=t;var i=so,a=i.baseQueue,o=n.pending;if(null!==o){if(null!==a){var s=a.next;a.next=o.next,o.next=s}i.baseQueue=a=o,n.pending=null}if(null!==a){o=a.next,i=i.baseState;var l=s=null,c=null,u=o;do{var h=u.lane;if((ro&h)===h)null!==c&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),i=u.hasEagerState?u.eagerState:t(i,u.action);else{var d={lane:h,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};null===c?(l=c=d,s=i):c=c.next=d,oo.lanes|=h,Ol|=h}u=u.next}while(null!==u&&u!==o);null===c?s=i:c.next=l,si(i,e.memoizedState)||(xs=!0),e.memoizedState=i,e.baseState=s,e.baseQueue=c,n.lastRenderedState=i}if(null!==(t=n.interleaved)){a=t;do{o=a.lane,oo.lanes|=o,Ol|=o,a=a.next}while(a!==t)}else null===a&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function wo(t){var e=xo(),n=e.queue;if(null===n)throw Error(r(311));n.lastRenderedReducer=t;var i=n.dispatch,a=n.pending,o=e.memoizedState;if(null!==a){n.pending=null;var s=a=a.next;do{o=t(o,s.action),s=s.next}while(s!==a);si(o,e.memoizedState)||(xs=!0),e.memoizedState=o,null===e.baseQueue&&(e.baseState=o),n.lastRenderedState=o}return[o,i]}function Ao(){}function Co(t,e){var n=oo,i=xo(),a=e(),o=!si(i.memoizedState,a);if(o&&(i.memoizedState=a,xs=!0),i=i.queue,Oo(So.bind(null,n,i,t),[t]),i.getSnapshot!==e||o||null!==lo&&1&lo.memoizedState.tag){if(n.flags|=2048,Po(9,To.bind(null,n,i,a,e),void 0,null),null===kl)throw Error(r(349));30&ro||Eo(n,e,a)}return a}function Eo(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},null===(e=oo.updateQueue)?(e={lastEffect:null,stores:null},oo.updateQueue=e,e.stores=[t]):null===(n=e.stores)?e.stores=[t]:n.push(t)}function To(t,e,n,i){e.value=n,e.getSnapshot=i,Mo(e)&&ko(t)}function So(t,e,n){return n((function(){Mo(e)&&ko(t)}))}function Mo(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!si(t,n)}catch(t){return!0}}function ko(t){var e=Lr(t,1);null!==e&&nc(e,t,1,-1)}function Io(t){var e=yo();return"function"==typeof t&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:vo,lastRenderedState:t},e.queue=t,t=t.dispatch=Zo.bind(null,oo,t),[e.memoizedState,t]}function Po(t,e,n,i){return t={tag:t,create:e,destroy:n,deps:i,next:null},null===(e=oo.updateQueue)?(e={lastEffect:null,stores:null},oo.updateQueue=e,e.lastEffect=t.next=t):null===(n=e.lastEffect)?e.lastEffect=t.next=t:(i=n.next,n.next=t,t.next=i,e.lastEffect=t),t}function zo(){return xo().memoizedState}function Do(t,e,n,i){var a=yo();oo.flags|=t,a.memoizedState=Po(1|e,n,void 0,void 0===i?null:i)}function Lo(t,e,n,i){var a=xo();i=void 0===i?null:i;var r=void 0;if(null!==so){var o=so.memoizedState;if(r=o.destroy,null!==i&&mo(i,o.deps))return void(a.memoizedState=Po(e,n,r,i))}oo.flags|=t,a.memoizedState=Po(1|e,n,r,i)}function Bo(t,e){return Do(8390656,8,t,e)}function Oo(t,e){return Lo(2048,8,t,e)}function Ro(t,e){return Lo(4,2,t,e)}function Fo(t,e){return Lo(4,4,t,e)}function No(t,e){return"function"==typeof e?(t=t(),e(t),function(){e(null)}):null!=e?(t=t(),e.current=t,function(){e.current=null}):void 0}function jo(t,e,n){return n=null!=n?n.concat([t]):null,Lo(4,4,No.bind(null,e,t),n)}function Vo(){}function Uo(t,e){var n=xo();e=void 0===e?null:e;var i=n.memoizedState;return null!==i&&null!==e&&mo(e,i[1])?i[0]:(n.memoizedState=[t,e],t)}function Go(t,e){var n=xo();e=void 0===e?null:e;var i=n.memoizedState;return null!==i&&null!==e&&mo(e,i[1])?i[0]:(t=t(),n.memoizedState=[t,e],t)}function qo(t,e,n){return 21&ro?(si(n,e)||(n=me(),oo.lanes|=n,Ol|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,xs=!0),t.memoizedState=n)}function $o(t,e){var n=xe;xe=0!==n&&4>n?n:4,t(!0);var i=ao.transition;ao.transition={};try{t(!1),e()}finally{xe=n,ao.transition=i}}function Wo(){return xo().memoizedState}function Ho(t,e,n){var i=ec(t);n={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null},Yo(t)?Xo(e,n):null!==(n=Dr(t,e,n,i))&&(nc(n,t,i,tc()),Ko(n,e,i))}function Zo(t,e,n){var i=ec(t),a={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null};if(Yo(t))Xo(e,a);else{var r=t.alternate;if(0===t.lanes&&(null===r||0===r.lanes)&&null!==(r=e.lastRenderedReducer))try{var o=e.lastRenderedState,s=r(o,n);if(a.hasEagerState=!0,a.eagerState=s,si(s,o)){var l=e.interleaved;return null===l?(a.next=a,zr(e)):(a.next=l.next,l.next=a),void(e.interleaved=a)}}catch(t){}null!==(n=Dr(t,e,a,i))&&(nc(n,t,i,a=tc()),Ko(n,e,i))}}function Yo(t){var e=t.alternate;return t===oo||null!==e&&e===oo}function Xo(t,e){uo=co=!0;var n=t.pending;null===n?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function Ko(t,e,n){if(4194240&n){var i=e.lanes;n|=i&=t.pendingLanes,e.lanes=n,ye(t,n)}}var Qo={readContext:Ir,useCallback:fo,useContext:fo,useEffect:fo,useImperativeHandle:fo,useInsertionEffect:fo,useLayoutEffect:fo,useMemo:fo,useReducer:fo,useRef:fo,useState:fo,useDebugValue:fo,useDeferredValue:fo,useTransition:fo,useMutableSource:fo,useSyncExternalStore:fo,useId:fo,unstable_isNewReconciler:!1},Jo={readContext:Ir,useCallback:function(t,e){return yo().memoizedState=[t,void 0===e?null:e],t},useContext:Ir,useEffect:Bo,useImperativeHandle:function(t,e,n){return n=null!=n?n.concat([t]):null,Do(4194308,4,No.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Do(4194308,4,t,e)},useInsertionEffect:function(t,e){return Do(4,2,t,e)},useMemo:function(t,e){var n=yo();return e=void 0===e?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var i=yo();return e=void 0!==n?n(e):e,i.memoizedState=i.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},i.queue=t,t=t.dispatch=Ho.bind(null,oo,t),[i.memoizedState,t]},useRef:function(t){return t={current:t},yo().memoizedState=t},useState:Io,useDebugValue:Vo,useDeferredValue:function(t){return yo().memoizedState=t},useTransition:function(){var t=Io(!1),e=t[0];return t=$o.bind(null,t[1]),yo().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var i=oo,a=yo();if(ar){if(void 0===n)throw Error(r(407));n=n()}else{if(n=e(),null===kl)throw Error(r(349));30&ro||Eo(i,e,n)}a.memoizedState=n;var o={value:n,getSnapshot:e};return a.queue=o,Bo(So.bind(null,i,o,t),[t]),i.flags|=2048,Po(9,To.bind(null,i,o,n,e),void 0,null),n},useId:function(){var t=yo(),e=kl.identifierPrefix;if(ar){var n=Ka;e=":"+e+"R"+(n=(Xa&~(1<<32-oe(Xa)-1)).toString(32)+n),0<(n=ho++)&&(e+="H"+n.toString(32)),e+=":"}else e=":"+e+"r"+(n=po++).toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},ts={readContext:Ir,useCallback:Uo,useContext:Ir,useEffect:Oo,useImperativeHandle:jo,useInsertionEffect:Ro,useLayoutEffect:Fo,useMemo:Go,useReducer:bo,useRef:zo,useState:function(){return bo(vo)},useDebugValue:Vo,useDeferredValue:function(t){return qo(xo(),so.memoizedState,t)},useTransition:function(){return[bo(vo)[0],xo().memoizedState]},useMutableSource:Ao,useSyncExternalStore:Co,useId:Wo,unstable_isNewReconciler:!1},es={readContext:Ir,useCallback:Uo,useContext:Ir,useEffect:Oo,useImperativeHandle:jo,useInsertionEffect:Ro,useLayoutEffect:Fo,useMemo:Go,useReducer:wo,useRef:zo,useState:function(){return wo(vo)},useDebugValue:Vo,useDeferredValue:function(t){var e=xo();return null===so?e.memoizedState=t:qo(e,so.memoizedState,t)},useTransition:function(){return[wo(vo)[0],xo().memoizedState]},useMutableSource:Ao,useSyncExternalStore:Co,useId:Wo,unstable_isNewReconciler:!1};function ns(t,e){if(t&&t.defaultProps){for(var n in e=R({},e),t=t.defaultProps)void 0===e[n]&&(e[n]=t[n]);return e}return e}function is(t,e,n,i){n=null==(n=n(i,e=t.memoizedState))?e:R({},e,n),t.memoizedState=n,0===t.lanes&&(t.updateQueue.baseState=n)}var as={isMounted:function(t){return!!(t=t._reactInternals)&&Ut(t)===t},enqueueSetState:function(t,e,n){t=t._reactInternals;var i=tc(),a=ec(t),r=Fr(i,a);r.payload=e,null!=n&&(r.callback=n),null!==(e=Nr(t,r,a))&&(nc(e,t,a,i),jr(e,t,a))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var i=tc(),a=ec(t),r=Fr(i,a);r.tag=1,r.payload=e,null!=n&&(r.callback=n),null!==(e=Nr(t,r,a))&&(nc(e,t,a,i),jr(e,t,a))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=tc(),i=ec(t),a=Fr(n,i);a.tag=2,null!=e&&(a.callback=e),null!==(e=Nr(t,a,i))&&(nc(e,t,i,n),jr(e,t,i))}};function rs(t,e,n,i,a,r,o){return"function"==typeof(t=t.stateNode).shouldComponentUpdate?t.shouldComponentUpdate(i,r,o):!(e.prototype&&e.prototype.isPureReactComponent&&li(n,i)&&li(a,r))}function os(t,e,n){var i=!1,a=Sa,r=e.contextType;return"object"==typeof r&&null!==r?r=Ir(r):(a=za(e)?Ia:Ma.current,r=(i=null!=(i=e.contextTypes))?Pa(t,a):Sa),e=new e(n,r),t.memoizedState=null!==e.state&&void 0!==e.state?e.state:null,e.updater=as,t.stateNode=e,e._reactInternals=t,i&&((t=t.stateNode).__reactInternalMemoizedUnmaskedChildContext=a,t.__reactInternalMemoizedMaskedChildContext=r),e}function ss(t,e,n,i){t=e.state,"function"==typeof e.componentWillReceiveProps&&e.componentWillReceiveProps(n,i),"function"==typeof e.UNSAFE_componentWillReceiveProps&&e.UNSAFE_componentWillReceiveProps(n,i),e.state!==t&&as.enqueueReplaceState(e,e.state,null)}function ls(t,e,n,i){var a=t.stateNode;a.props=n,a.state=t.memoizedState,a.refs={},Or(t);var r=e.contextType;"object"==typeof r&&null!==r?a.context=Ir(r):(r=za(e)?Ia:Ma.current,a.context=Pa(t,r)),a.state=t.memoizedState,"function"==typeof(r=e.getDerivedStateFromProps)&&(is(t,e,r,n),a.state=t.memoizedState),"function"==typeof e.getDerivedStateFromProps||"function"==typeof a.getSnapshotBeforeUpdate||"function"!=typeof a.UNSAFE_componentWillMount&&"function"!=typeof a.componentWillMount||(e=a.state,"function"==typeof a.componentWillMount&&a.componentWillMount(),"function"==typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount(),e!==a.state&&as.enqueueReplaceState(a,a.state,null),Ur(t,n,a,i),a.state=t.memoizedState),"function"==typeof a.componentDidMount&&(t.flags|=4194308)}function cs(t,e){try{var n="",i=e;do{n+=V(i),i=i.return}while(i);var a=n}catch(t){a="\nError generating stack: "+t.message+"\n"+t.stack}return{value:t,source:e,stack:a,digest:null}}function us(t,e,n){return{value:t,source:null,stack:null!=n?n:null,digest:null!=e?e:null}}function hs(t,e){try{console.error(e.value)}catch(t){setTimeout((function(){throw t}))}}var ds="function"==typeof WeakMap?WeakMap:Map;function ps(t,e,n){(n=Fr(-1,n)).tag=3,n.payload={element:null};var i=e.value;return n.callback=function(){ql||(ql=!0,$l=i),hs(0,e)},n}function fs(t,e,n){(n=Fr(-1,n)).tag=3;var i=t.type.getDerivedStateFromError;if("function"==typeof i){var a=e.value;n.payload=function(){return i(a)},n.callback=function(){hs(0,e)}}var r=t.stateNode;return null!==r&&"function"==typeof r.componentDidCatch&&(n.callback=function(){hs(0,e),"function"!=typeof i&&(null===Wl?Wl=new Set([this]):Wl.add(this));var t=e.stack;this.componentDidCatch(e.value,{componentStack:null!==t?t:""})}),n}function ms(t,e,n){var i=t.pingCache;if(null===i){i=t.pingCache=new ds;var a=new Set;i.set(e,a)}else void 0===(a=i.get(e))&&(a=new Set,i.set(e,a));a.has(n)||(a.add(n),t=Ec.bind(null,t,e,n),e.then(t,t))}function gs(t){do{var e;if((e=13===t.tag)&&(e=null===(e=t.memoizedState)||null!==e.dehydrated),e)return t;t=t.return}while(null!==t);return null}function _s(t,e,n,i,a){return 1&t.mode?(t.flags|=65536,t.lanes=a,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((e=Fr(-1,1)).tag=2,Nr(n,e,1))),n.lanes|=1),t)}var ys=v.ReactCurrentOwner,xs=!1;function vs(t,e,n,i){e.child=null===t?br(e,null,n,i):vr(e,t.child,n,i)}function bs(t,e,n,i,a){n=n.render;var r=e.ref;return kr(e,a),i=go(t,e,n,i,r,a),n=_o(),null===t||xs?(ar&&n&&tr(e),e.flags|=1,vs(t,e,i,a),e.child):(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~a,qs(t,e,a))}function ws(t,e,n,i,a){if(null===t){var r=n.type;return"function"!=typeof r||zc(r)||void 0!==r.defaultProps||null!==n.compare||void 0!==n.defaultProps?((t=Lc(n.type,null,i,e,e.mode,a)).ref=e.ref,t.return=e,e.child=t):(e.tag=15,e.type=r,As(t,e,r,i,a))}if(r=t.child,!(t.lanes&a)){var o=r.memoizedProps;if((n=null!==(n=n.compare)?n:li)(o,i)&&t.ref===e.ref)return qs(t,e,a)}return e.flags|=1,(t=Dc(r,i)).ref=e.ref,t.return=e,e.child=t}function As(t,e,n,i,a){if(null!==t){var r=t.memoizedProps;if(li(r,i)&&t.ref===e.ref){if(xs=!1,e.pendingProps=i=r,!(t.lanes&a))return e.lanes=t.lanes,qs(t,e,a);131072&t.flags&&(xs=!0)}}return Ts(t,e,n,i,a)}function Cs(t,e,n){var i=e.pendingProps,a=i.children,r=null!==t?t.memoizedState:null;if("hidden"===i.mode)if(1&e.mode){if(!(1073741824&n))return t=null!==r?r.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Ta(Dl,zl),zl|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=null!==r?r.baseLanes:n,Ta(Dl,zl),zl|=i}else e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ta(Dl,zl),zl|=n;else null!==r?(i=r.baseLanes|n,e.memoizedState=null):i=n,Ta(Dl,zl),zl|=i;return vs(t,e,a,n),e.child}function Es(t,e){var n=e.ref;(null===t&&null!==n||null!==t&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Ts(t,e,n,i,a){var r=za(n)?Ia:Ma.current;return r=Pa(e,r),kr(e,a),n=go(t,e,n,i,r,a),i=_o(),null===t||xs?(ar&&i&&tr(e),e.flags|=1,vs(t,e,n,a),e.child):(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~a,qs(t,e,a))}function Ss(t,e,n,i,a){if(za(n)){var r=!0;Oa(e)}else r=!1;if(kr(e,a),null===e.stateNode)Gs(t,e),os(e,n,i),ls(e,n,i,a),i=!0;else if(null===t){var o=e.stateNode,s=e.memoizedProps;o.props=s;var l=o.context,c=n.contextType;c="object"==typeof c&&null!==c?Ir(c):Pa(e,c=za(n)?Ia:Ma.current);var u=n.getDerivedStateFromProps,h="function"==typeof u||"function"==typeof o.getSnapshotBeforeUpdate;h||"function"!=typeof o.UNSAFE_componentWillReceiveProps&&"function"!=typeof o.componentWillReceiveProps||(s!==i||l!==c)&&ss(e,o,i,c),Br=!1;var d=e.memoizedState;o.state=d,Ur(e,i,o,a),l=e.memoizedState,s!==i||d!==l||ka.current||Br?("function"==typeof u&&(is(e,n,u,i),l=e.memoizedState),(s=Br||rs(e,n,s,i,d,l,c))?(h||"function"!=typeof o.UNSAFE_componentWillMount&&"function"!=typeof o.componentWillMount||("function"==typeof o.componentWillMount&&o.componentWillMount(),"function"==typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount()),"function"==typeof o.componentDidMount&&(e.flags|=4194308)):("function"==typeof o.componentDidMount&&(e.flags|=4194308),e.memoizedProps=i,e.memoizedState=l),o.props=i,o.state=l,o.context=c,i=s):("function"==typeof o.componentDidMount&&(e.flags|=4194308),i=!1)}else{o=e.stateNode,Rr(t,e),s=e.memoizedProps,c=e.type===e.elementType?s:ns(e.type,s),o.props=c,h=e.pendingProps,d=o.context,l="object"==typeof(l=n.contextType)&&null!==l?Ir(l):Pa(e,l=za(n)?Ia:Ma.current);var p=n.getDerivedStateFromProps;(u="function"==typeof p||"function"==typeof o.getSnapshotBeforeUpdate)||"function"!=typeof o.UNSAFE_componentWillReceiveProps&&"function"!=typeof o.componentWillReceiveProps||(s!==h||d!==l)&&ss(e,o,i,l),Br=!1,d=e.memoizedState,o.state=d,Ur(e,i,o,a);var f=e.memoizedState;s!==h||d!==f||ka.current||Br?("function"==typeof p&&(is(e,n,p,i),f=e.memoizedState),(c=Br||rs(e,n,c,i,d,f,l)||!1)?(u||"function"!=typeof o.UNSAFE_componentWillUpdate&&"function"!=typeof o.componentWillUpdate||("function"==typeof o.componentWillUpdate&&o.componentWillUpdate(i,f,l),"function"==typeof o.UNSAFE_componentWillUpdate&&o.UNSAFE_componentWillUpdate(i,f,l)),"function"==typeof o.componentDidUpdate&&(e.flags|=4),"function"==typeof o.getSnapshotBeforeUpdate&&(e.flags|=1024)):("function"!=typeof o.componentDidUpdate||s===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),"function"!=typeof o.getSnapshotBeforeUpdate||s===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),e.memoizedProps=i,e.memoizedState=f),o.props=i,o.state=f,o.context=l,i=c):("function"!=typeof o.componentDidUpdate||s===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),"function"!=typeof o.getSnapshotBeforeUpdate||s===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),i=!1)}return Ms(t,e,n,i,r,a)}function Ms(t,e,n,i,a,r){Es(t,e);var o=!!(128&e.flags);if(!i&&!o)return a&&Ra(e,n,!1),qs(t,e,r);i=e.stateNode,ys.current=e;var s=o&&"function"!=typeof n.getDerivedStateFromError?null:i.render();return e.flags|=1,null!==t&&o?(e.child=vr(e,t.child,null,r),e.child=vr(e,null,s,r)):vs(t,e,s,r),e.memoizedState=i.state,a&&Ra(e,n,!0),e.child}function ks(t){var e=t.stateNode;e.pendingContext?La(0,e.pendingContext,e.pendingContext!==e.context):e.context&&La(0,e.context,!1),Yr(t,e.containerInfo)}function Is(t,e,n,i,a){return pr(),fr(a),e.flags|=256,vs(t,e,n,i),e.child}var Ps,zs,Ds,Ls,Bs={dehydrated:null,treeContext:null,retryLane:0};function Os(t){return{baseLanes:t,cachePool:null,transitions:null}}function Rs(t,e,n){var i,a=e.pendingProps,o=Jr.current,s=!1,l=!!(128&e.flags);if((i=l)||(i=(null===t||null!==t.memoizedState)&&!!(2&o)),i?(s=!0,e.flags&=-129):null!==t&&null===t.memoizedState||(o|=1),Ta(Jr,1&o),null===t)return cr(e),null!==(t=e.memoizedState)&&null!==(t=t.dehydrated)?(1&e.mode?"$!"===t.data?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(l=a.children,t=a.fallback,s?(a=e.mode,s=e.child,l={mode:"hidden",children:l},1&a||null===s?s=Oc(l,a,0,null):(s.childLanes=0,s.pendingProps=l),t=Bc(t,a,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=Os(n),e.memoizedState=Bs,t):Fs(e,l));if(null!==(o=t.memoizedState)&&null!==(i=o.dehydrated))return function(t,e,n,i,a,o,s){if(n)return 256&e.flags?(e.flags&=-257,Ns(t,e,s,i=us(Error(r(422))))):null!==e.memoizedState?(e.child=t.child,e.flags|=128,null):(o=i.fallback,a=e.mode,i=Oc({mode:"visible",children:i.children},a,0,null),(o=Bc(o,a,s,null)).flags|=2,i.return=e,o.return=e,i.sibling=o,e.child=i,1&e.mode&&vr(e,t.child,null,s),e.child.memoizedState=Os(s),e.memoizedState=Bs,o);if(!(1&e.mode))return Ns(t,e,s,null);if("$!"===a.data){if(i=a.nextSibling&&a.nextSibling.dataset)var l=i.dgst;return i=l,Ns(t,e,s,i=us(o=Error(r(419)),i,void 0))}if(l=!!(s&t.childLanes),xs||l){if(null!==(i=kl)){switch(s&-s){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}0!==(a=a&(i.suspendedLanes|s)?0:a)&&a!==o.retryLane&&(o.retryLane=a,Lr(t,a),nc(i,t,a,-1))}return mc(),Ns(t,e,s,i=us(Error(r(421))))}return"$?"===a.data?(e.flags|=128,e.child=t.child,e=Sc.bind(null,t),a._reactRetry=e,null):(t=o.treeContext,ir=ca(a.nextSibling),nr=e,ar=!0,rr=null,null!==t&&(Ha[Za++]=Xa,Ha[Za++]=Ka,Ha[Za++]=Ya,Xa=t.id,Ka=t.overflow,Ya=e),(e=Fs(e,i.children)).flags|=4096,e)}(t,e,l,a,i,o,n);if(s){s=a.fallback,l=e.mode,i=(o=t.child).sibling;var c={mode:"hidden",children:a.children};return 1&l||e.child===o?(a=Dc(o,c)).subtreeFlags=14680064&o.subtreeFlags:((a=e.child).childLanes=0,a.pendingProps=c,e.deletions=null),null!==i?s=Dc(i,s):(s=Bc(s,l,n,null)).flags|=2,s.return=e,a.return=e,a.sibling=s,e.child=a,a=s,s=e.child,l=null===(l=t.child.memoizedState)?Os(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},s.memoizedState=l,s.childLanes=t.childLanes&~n,e.memoizedState=Bs,a}return t=(s=t.child).sibling,a=Dc(s,{mode:"visible",children:a.children}),!(1&e.mode)&&(a.lanes=n),a.return=e,a.sibling=null,null!==t&&(null===(n=e.deletions)?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=a,e.memoizedState=null,a}function Fs(t,e){return(e=Oc({mode:"visible",children:e},t.mode,0,null)).return=t,t.child=e}function Ns(t,e,n,i){return null!==i&&fr(i),vr(e,t.child,null,n),(t=Fs(e,e.pendingProps.children)).flags|=2,e.memoizedState=null,t}function js(t,e,n){t.lanes|=e;var i=t.alternate;null!==i&&(i.lanes|=e),Mr(t.return,e,n)}function Vs(t,e,n,i,a){var r=t.memoizedState;null===r?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:i,tail:n,tailMode:a}:(r.isBackwards=e,r.rendering=null,r.renderingStartTime=0,r.last=i,r.tail=n,r.tailMode=a)}function Us(t,e,n){var i=e.pendingProps,a=i.revealOrder,r=i.tail;if(vs(t,e,i.children,n),2&(i=Jr.current))i=1&i|2,e.flags|=128;else{if(null!==t&&128&t.flags)t:for(t=e.child;null!==t;){if(13===t.tag)null!==t.memoizedState&&js(t,n,e);else if(19===t.tag)js(t,n,e);else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break t;for(;null===t.sibling;){if(null===t.return||t.return===e)break t;t=t.return}t.sibling.return=t.return,t=t.sibling}i&=1}if(Ta(Jr,i),1&e.mode)switch(a){case"forwards":for(n=e.child,a=null;null!==n;)null!==(t=n.alternate)&&null===to(t)&&(a=n),n=n.sibling;null===(n=a)?(a=e.child,e.child=null):(a=n.sibling,n.sibling=null),Vs(e,!1,a,n,r);break;case"backwards":for(n=null,a=e.child,e.child=null;null!==a;){if(null!==(t=a.alternate)&&null===to(t)){e.child=a;break}t=a.sibling,a.sibling=n,n=a,a=t}Vs(e,!0,n,null,r);break;case"together":Vs(e,!1,null,null,void 0);break;default:e.memoizedState=null}else e.memoizedState=null;return e.child}function Gs(t,e){!(1&e.mode)&&null!==t&&(t.alternate=null,e.alternate=null,e.flags|=2)}function qs(t,e,n){if(null!==t&&(e.dependencies=t.dependencies),Ol|=e.lanes,!(n&e.childLanes))return null;if(null!==t&&e.child!==t.child)throw Error(r(153));if(null!==e.child){for(n=Dc(t=e.child,t.pendingProps),e.child=n,n.return=e;null!==t.sibling;)t=t.sibling,(n=n.sibling=Dc(t,t.pendingProps)).return=e;n.sibling=null}return e.child}function $s(t,e){if(!ar)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;null!==e;)null!==e.alternate&&(n=e),e=e.sibling;null===n?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var i=null;null!==n;)null!==n.alternate&&(i=n),n=n.sibling;null===i?e||null===t.tail?t.tail=null:t.tail.sibling=null:i.sibling=null}}function Ws(t){var e=null!==t.alternate&&t.alternate.child===t.child,n=0,i=0;if(e)for(var a=t.child;null!==a;)n|=a.lanes|a.childLanes,i|=14680064&a.subtreeFlags,i|=14680064&a.flags,a.return=t,a=a.sibling;else for(a=t.child;null!==a;)n|=a.lanes|a.childLanes,i|=a.subtreeFlags,i|=a.flags,a.return=t,a=a.sibling;return t.subtreeFlags|=i,t.childLanes=n,e}function Hs(t,e,n){var i=e.pendingProps;switch(er(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ws(e),null;case 1:case 17:return za(e.type)&&Da(),Ws(e),null;case 3:return i=e.stateNode,Xr(),Ea(ka),Ea(Ma),no(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),null!==t&&null!==t.child||(hr(e)?e.flags|=4:null===t||t.memoizedState.isDehydrated&&!(256&e.flags)||(e.flags|=1024,null!==rr&&(oc(rr),rr=null))),zs(t,e),Ws(e),null;case 5:Qr(e);var a=Zr(Hr.current);if(n=e.type,null!==t&&null!=e.stateNode)Ds(t,e,n,i,a),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!i){if(null===e.stateNode)throw Error(r(166));return Ws(e),null}if(t=Zr($r.current),hr(e)){i=e.stateNode,n=e.type;var o=e.memoizedProps;switch(i[da]=e,i[pa]=o,t=!!(1&e.mode),n){case"dialog":Ni("cancel",i),Ni("close",i);break;case"iframe":case"object":case"embed":Ni("load",i);break;case"video":case"audio":for(a=0;a<Bi.length;a++)Ni(Bi[a],i);break;case"source":Ni("error",i);break;case"img":case"image":case"link":Ni("error",i),Ni("load",i);break;case"details":Ni("toggle",i);break;case"input":X(i,o),Ni("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!o.multiple},Ni("invalid",i);break;case"textarea":at(i,o),Ni("invalid",i)}for(var l in yt(n,o),a=null,o)if(o.hasOwnProperty(l)){var c=o[l];"children"===l?"string"==typeof c?i.textContent!==c&&(!0!==o.suppressHydrationWarning&&Qi(i.textContent,c,t),a=["children",c]):"number"==typeof c&&i.textContent!==""+c&&(!0!==o.suppressHydrationWarning&&Qi(i.textContent,c,t),a=["children",""+c]):s.hasOwnProperty(l)&&null!=c&&"onScroll"===l&&Ni("scroll",i)}switch(n){case"input":W(i),J(i,o,!0);break;case"textarea":W(i),ot(i);break;case"select":case"option":break;default:"function"==typeof o.onClick&&(i.onclick=Ji)}i=a,e.updateQueue=i,null!==i&&(e.flags|=4)}else{l=9===a.nodeType?a:a.ownerDocument,"http://www.w3.org/1999/xhtml"===t&&(t=st(n)),"http://www.w3.org/1999/xhtml"===t?"script"===n?((t=l.createElement("div")).innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):"string"==typeof i.is?t=l.createElement(n,{is:i.is}):(t=l.createElement(n),"select"===n&&(l=t,i.multiple?l.multiple=!0:i.size&&(l.size=i.size))):t=l.createElementNS(t,n),t[da]=e,t[pa]=i,Ps(t,e,!1,!1),e.stateNode=t;t:{switch(l=xt(n,i),n){case"dialog":Ni("cancel",t),Ni("close",t),a=i;break;case"iframe":case"object":case"embed":Ni("load",t),a=i;break;case"video":case"audio":for(a=0;a<Bi.length;a++)Ni(Bi[a],t);a=i;break;case"source":Ni("error",t),a=i;break;case"img":case"image":case"link":Ni("error",t),Ni("load",t),a=i;break;case"details":Ni("toggle",t),a=i;break;case"input":X(t,i),a=Y(t,i),Ni("invalid",t);break;case"option":default:a=i;break;case"select":t._wrapperState={wasMultiple:!!i.multiple},a=R({},i,{value:void 0}),Ni("invalid",t);break;case"textarea":at(t,i),a=it(t,i),Ni("invalid",t)}for(o in yt(n,a),c=a)if(c.hasOwnProperty(o)){var u=c[o];"style"===o?gt(t,u):"dangerouslySetInnerHTML"===o?null!=(u=u?u.__html:void 0)&&ht(t,u):"children"===o?"string"==typeof u?("textarea"!==n||""!==u)&&dt(t,u):"number"==typeof u&&dt(t,""+u):"suppressContentEditableWarning"!==o&&"suppressHydrationWarning"!==o&&"autoFocus"!==o&&(s.hasOwnProperty(o)?null!=u&&"onScroll"===o&&Ni("scroll",t):null!=u&&x(t,o,u,l))}switch(n){case"input":W(t),J(t,i,!1);break;case"textarea":W(t),ot(t);break;case"option":null!=i.value&&t.setAttribute("value",""+q(i.value));break;case"select":t.multiple=!!i.multiple,null!=(o=i.value)?nt(t,!!i.multiple,o,!1):null!=i.defaultValue&&nt(t,!!i.multiple,i.defaultValue,!0);break;default:"function"==typeof a.onClick&&(t.onclick=Ji)}switch(n){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break t;case"img":i=!0;break t;default:i=!1}}i&&(e.flags|=4)}null!==e.ref&&(e.flags|=512,e.flags|=2097152)}return Ws(e),null;case 6:if(t&&null!=e.stateNode)Ls(t,e,t.memoizedProps,i);else{if("string"!=typeof i&&null===e.stateNode)throw Error(r(166));if(n=Zr(Hr.current),Zr($r.current),hr(e)){if(i=e.stateNode,n=e.memoizedProps,i[da]=e,(o=i.nodeValue!==n)&&null!==(t=nr))switch(t.tag){case 3:Qi(i.nodeValue,n,!!(1&t.mode));break;case 5:!0!==t.memoizedProps.suppressHydrationWarning&&Qi(i.nodeValue,n,!!(1&t.mode))}o&&(e.flags|=4)}else(i=(9===n.nodeType?n:n.ownerDocument).createTextNode(i))[da]=e,e.stateNode=i}return Ws(e),null;case 13:if(Ea(Jr),i=e.memoizedState,null===t||null!==t.memoizedState&&null!==t.memoizedState.dehydrated){if(ar&&null!==ir&&1&e.mode&&!(128&e.flags))dr(),pr(),e.flags|=98560,o=!1;else if(o=hr(e),null!==i&&null!==i.dehydrated){if(null===t){if(!o)throw Error(r(318));if(!(o=null!==(o=e.memoizedState)?o.dehydrated:null))throw Error(r(317));o[da]=e}else pr(),!(128&e.flags)&&(e.memoizedState=null),e.flags|=4;Ws(e),o=!1}else null!==rr&&(oc(rr),rr=null),o=!0;if(!o)return 65536&e.flags?e:null}return 128&e.flags?(e.lanes=n,e):((i=null!==i)!=(null!==t&&null!==t.memoizedState)&&i&&(e.child.flags|=8192,1&e.mode&&(null===t||1&Jr.current?0===Ll&&(Ll=3):mc())),null!==e.updateQueue&&(e.flags|=4),Ws(e),null);case 4:return Xr(),zs(t,e),null===t&&Ui(e.stateNode.containerInfo),Ws(e),null;case 10:return Sr(e.type._context),Ws(e),null;case 19:if(Ea(Jr),null===(o=e.memoizedState))return Ws(e),null;if(i=!!(128&e.flags),null===(l=o.rendering))if(i)$s(o,!1);else{if(0!==Ll||null!==t&&128&t.flags)for(t=e.child;null!==t;){if(null!==(l=to(t))){for(e.flags|=128,$s(o,!1),null!==(i=l.updateQueue)&&(e.updateQueue=i,e.flags|=4),e.subtreeFlags=0,i=n,n=e.child;null!==n;)t=i,(o=n).flags&=14680066,null===(l=o.alternate)?(o.childLanes=0,o.lanes=t,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=l.childLanes,o.lanes=l.lanes,o.child=l.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=l.memoizedProps,o.memoizedState=l.memoizedState,o.updateQueue=l.updateQueue,o.type=l.type,t=l.dependencies,o.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Ta(Jr,1&Jr.current|2),e.child}t=t.sibling}null!==o.tail&&Kt()>Ul&&(e.flags|=128,i=!0,$s(o,!1),e.lanes=4194304)}else{if(!i)if(null!==(t=to(l))){if(e.flags|=128,i=!0,null!==(n=t.updateQueue)&&(e.updateQueue=n,e.flags|=4),$s(o,!0),null===o.tail&&"hidden"===o.tailMode&&!l.alternate&&!ar)return Ws(e),null}else 2*Kt()-o.renderingStartTime>Ul&&1073741824!==n&&(e.flags|=128,i=!0,$s(o,!1),e.lanes=4194304);o.isBackwards?(l.sibling=e.child,e.child=l):(null!==(n=o.last)?n.sibling=l:e.child=l,o.last=l)}return null!==o.tail?(e=o.tail,o.rendering=e,o.tail=e.sibling,o.renderingStartTime=Kt(),e.sibling=null,n=Jr.current,Ta(Jr,i?1&n|2:1&n),e):(Ws(e),null);case 22:case 23:return hc(),i=null!==e.memoizedState,null!==t&&null!==t.memoizedState!==i&&(e.flags|=8192),i&&1&e.mode?!!(1073741824&zl)&&(Ws(e),6&e.subtreeFlags&&(e.flags|=8192)):Ws(e),null;case 24:case 25:return null}throw Error(r(156,e.tag))}function Zs(t,e){switch(er(e),e.tag){case 1:return za(e.type)&&Da(),65536&(t=e.flags)?(e.flags=-65537&t|128,e):null;case 3:return Xr(),Ea(ka),Ea(Ma),no(),65536&(t=e.flags)&&!(128&t)?(e.flags=-65537&t|128,e):null;case 5:return Qr(e),null;case 13:if(Ea(Jr),null!==(t=e.memoizedState)&&null!==t.dehydrated){if(null===e.alternate)throw Error(r(340));pr()}return 65536&(t=e.flags)?(e.flags=-65537&t|128,e):null;case 19:return Ea(Jr),null;case 4:return Xr(),null;case 10:return Sr(e.type._context),null;case 22:case 23:return hc(),null;default:return null}}Ps=function(t,e){for(var n=e.child;null!==n;){if(5===n.tag||6===n.tag)t.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===e)break;for(;null===n.sibling;){if(null===n.return||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},zs=function(){},Ds=function(t,e,n,i){var a=t.memoizedProps;if(a!==i){t=e.stateNode,Zr($r.current);var r,o=null;switch(n){case"input":a=Y(t,a),i=Y(t,i),o=[];break;case"select":a=R({},a,{value:void 0}),i=R({},i,{value:void 0}),o=[];break;case"textarea":a=it(t,a),i=it(t,i),o=[];break;default:"function"!=typeof a.onClick&&"function"==typeof i.onClick&&(t.onclick=Ji)}for(u in yt(n,i),n=null,a)if(!i.hasOwnProperty(u)&&a.hasOwnProperty(u)&&null!=a[u])if("style"===u){var l=a[u];for(r in l)l.hasOwnProperty(r)&&(n||(n={}),n[r]="")}else"dangerouslySetInnerHTML"!==u&&"children"!==u&&"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&"autoFocus"!==u&&(s.hasOwnProperty(u)?o||(o=[]):(o=o||[]).push(u,null));for(u in i){var c=i[u];if(l=null!=a?a[u]:void 0,i.hasOwnProperty(u)&&c!==l&&(null!=c||null!=l))if("style"===u)if(l){for(r in l)!l.hasOwnProperty(r)||c&&c.hasOwnProperty(r)||(n||(n={}),n[r]="");for(r in c)c.hasOwnProperty(r)&&l[r]!==c[r]&&(n||(n={}),n[r]=c[r])}else n||(o||(o=[]),o.push(u,n)),n=c;else"dangerouslySetInnerHTML"===u?(c=c?c.__html:void 0,l=l?l.__html:void 0,null!=c&&l!==c&&(o=o||[]).push(u,c)):"children"===u?"string"!=typeof c&&"number"!=typeof c||(o=o||[]).push(u,""+c):"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&(s.hasOwnProperty(u)?(null!=c&&"onScroll"===u&&Ni("scroll",t),o||l===c||(o=[])):(o=o||[]).push(u,c))}n&&(o=o||[]).push("style",n);var u=o;(e.updateQueue=u)&&(e.flags|=4)}},Ls=function(t,e,n,i){n!==i&&(e.flags|=4)};var Ys=!1,Xs=!1,Ks="function"==typeof WeakSet?WeakSet:Set,Qs=null;function Js(t,e){var n=t.ref;if(null!==n)if("function"==typeof n)try{n(null)}catch(n){Cc(t,e,n)}else n.current=null}function tl(t,e,n){try{n()}catch(n){Cc(t,e,n)}}var el=!1;function nl(t,e,n){var i=e.updateQueue;if(null!==(i=null!==i?i.lastEffect:null)){var a=i=i.next;do{if((a.tag&t)===t){var r=a.destroy;a.destroy=void 0,void 0!==r&&tl(e,n,r)}a=a.next}while(a!==i)}}function il(t,e){if(null!==(e=null!==(e=e.updateQueue)?e.lastEffect:null)){var n=e=e.next;do{if((n.tag&t)===t){var i=n.create;n.destroy=i()}n=n.next}while(n!==e)}}function al(t){var e=t.ref;if(null!==e){var n=t.stateNode;t.tag,t=n,"function"==typeof e?e(t):e.current=t}}function rl(t){var e=t.alternate;null!==e&&(t.alternate=null,rl(e)),t.child=null,t.deletions=null,t.sibling=null,5===t.tag&&null!==(e=t.stateNode)&&(delete e[da],delete e[pa],delete e[ma],delete e[ga],delete e[_a]),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function ol(t){return 5===t.tag||3===t.tag||4===t.tag}function sl(t){t:for(;;){for(;null===t.sibling;){if(null===t.return||ol(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;5!==t.tag&&6!==t.tag&&18!==t.tag;){if(2&t.flags)continue t;if(null===t.child||4===t.tag)continue t;t.child.return=t,t=t.child}if(!(2&t.flags))return t.stateNode}}function ll(t,e,n){var i=t.tag;if(5===i||6===i)t=t.stateNode,e?8===n.nodeType?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(8===n.nodeType?(e=n.parentNode).insertBefore(t,n):(e=n).appendChild(t),null!=(n=n._reactRootContainer)||null!==e.onclick||(e.onclick=Ji));else if(4!==i&&null!==(t=t.child))for(ll(t,e,n),t=t.sibling;null!==t;)ll(t,e,n),t=t.sibling}function cl(t,e,n){var i=t.tag;if(5===i||6===i)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(4!==i&&null!==(t=t.child))for(cl(t,e,n),t=t.sibling;null!==t;)cl(t,e,n),t=t.sibling}var ul=null,hl=!1;function dl(t,e,n){for(n=n.child;null!==n;)pl(t,e,n),n=n.sibling}function pl(t,e,n){if(re&&"function"==typeof re.onCommitFiberUnmount)try{re.onCommitFiberUnmount(ae,n)}catch(t){}switch(n.tag){case 5:Xs||Js(n,e);case 6:var i=ul,a=hl;ul=null,dl(t,e,n),hl=a,null!==(ul=i)&&(hl?(t=ul,n=n.stateNode,8===t.nodeType?t.parentNode.removeChild(n):t.removeChild(n)):ul.removeChild(n.stateNode));break;case 18:null!==ul&&(hl?(t=ul,n=n.stateNode,8===t.nodeType?la(t.parentNode,n):1===t.nodeType&&la(t,n),Ue(t)):la(ul,n.stateNode));break;case 4:i=ul,a=hl,ul=n.stateNode.containerInfo,hl=!0,dl(t,e,n),ul=i,hl=a;break;case 0:case 11:case 14:case 15:if(!Xs&&null!==(i=n.updateQueue)&&null!==(i=i.lastEffect)){a=i=i.next;do{var r=a,o=r.destroy;r=r.tag,void 0!==o&&(2&r||4&r)&&tl(n,e,o),a=a.next}while(a!==i)}dl(t,e,n);break;case 1:if(!Xs&&(Js(n,e),"function"==typeof(i=n.stateNode).componentWillUnmount))try{i.props=n.memoizedProps,i.state=n.memoizedState,i.componentWillUnmount()}catch(t){Cc(n,e,t)}dl(t,e,n);break;case 21:dl(t,e,n);break;case 22:1&n.mode?(Xs=(i=Xs)||null!==n.memoizedState,dl(t,e,n),Xs=i):dl(t,e,n);break;default:dl(t,e,n)}}function fl(t){var e=t.updateQueue;if(null!==e){t.updateQueue=null;var n=t.stateNode;null===n&&(n=t.stateNode=new Ks),e.forEach((function(e){var i=Mc.bind(null,t,e);n.has(e)||(n.add(e),e.then(i,i))}))}}function ml(t,e){var n=e.deletions;if(null!==n)for(var i=0;i<n.length;i++){var a=n[i];try{var o=t,s=e,l=s;t:for(;null!==l;){switch(l.tag){case 5:ul=l.stateNode,hl=!1;break t;case 3:case 4:ul=l.stateNode.containerInfo,hl=!0;break t}l=l.return}if(null===ul)throw Error(r(160));pl(o,s,a),ul=null,hl=!1;var c=a.alternate;null!==c&&(c.return=null),a.return=null}catch(t){Cc(a,e,t)}}if(12854&e.subtreeFlags)for(e=e.child;null!==e;)gl(e,t),e=e.sibling}function gl(t,e){var n=t.alternate,i=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(ml(e,t),_l(t),4&i){try{nl(3,t,t.return),il(3,t)}catch(e){Cc(t,t.return,e)}try{nl(5,t,t.return)}catch(e){Cc(t,t.return,e)}}break;case 1:ml(e,t),_l(t),512&i&&null!==n&&Js(n,n.return);break;case 5:if(ml(e,t),_l(t),512&i&&null!==n&&Js(n,n.return),32&t.flags){var a=t.stateNode;try{dt(a,"")}catch(e){Cc(t,t.return,e)}}if(4&i&&null!=(a=t.stateNode)){var o=t.memoizedProps,s=null!==n?n.memoizedProps:o,l=t.type,c=t.updateQueue;if(t.updateQueue=null,null!==c)try{"input"===l&&"radio"===o.type&&null!=o.name&&K(a,o),xt(l,s);var u=xt(l,o);for(s=0;s<c.length;s+=2){var h=c[s],d=c[s+1];"style"===h?gt(a,d):"dangerouslySetInnerHTML"===h?ht(a,d):"children"===h?dt(a,d):x(a,h,d,u)}switch(l){case"input":Q(a,o);break;case"textarea":rt(a,o);break;case"select":var p=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!o.multiple;var f=o.value;null!=f?nt(a,!!o.multiple,f,!1):p!==!!o.multiple&&(null!=o.defaultValue?nt(a,!!o.multiple,o.defaultValue,!0):nt(a,!!o.multiple,o.multiple?[]:"",!1))}a[pa]=o}catch(e){Cc(t,t.return,e)}}break;case 6:if(ml(e,t),_l(t),4&i){if(null===t.stateNode)throw Error(r(162));a=t.stateNode,o=t.memoizedProps;try{a.nodeValue=o}catch(e){Cc(t,t.return,e)}}break;case 3:if(ml(e,t),_l(t),4&i&&null!==n&&n.memoizedState.isDehydrated)try{Ue(e.containerInfo)}catch(e){Cc(t,t.return,e)}break;case 4:default:ml(e,t),_l(t);break;case 13:ml(e,t),_l(t),8192&(a=t.child).flags&&(o=null!==a.memoizedState,a.stateNode.isHidden=o,!o||null!==a.alternate&&null!==a.alternate.memoizedState||(Vl=Kt())),4&i&&fl(t);break;case 22:if(h=null!==n&&null!==n.memoizedState,1&t.mode?(Xs=(u=Xs)||h,ml(e,t),Xs=u):ml(e,t),_l(t),8192&i){if(u=null!==t.memoizedState,(t.stateNode.isHidden=u)&&!h&&1&t.mode)for(Qs=t,h=t.child;null!==h;){for(d=Qs=h;null!==Qs;){switch(f=(p=Qs).child,p.tag){case 0:case 11:case 14:case 15:nl(4,p,p.return);break;case 1:Js(p,p.return);var m=p.stateNode;if("function"==typeof m.componentWillUnmount){i=p,n=p.return;try{e=i,m.props=e.memoizedProps,m.state=e.memoizedState,m.componentWillUnmount()}catch(t){Cc(i,n,t)}}break;case 5:Js(p,p.return);break;case 22:if(null!==p.memoizedState){bl(d);continue}}null!==f?(f.return=p,Qs=f):bl(d)}h=h.sibling}t:for(h=null,d=t;;){if(5===d.tag){if(null===h){h=d;try{a=d.stateNode,u?"function"==typeof(o=a.style).setProperty?o.setProperty("display","none","important"):o.display="none":(l=d.stateNode,s=null!=(c=d.memoizedProps.style)&&c.hasOwnProperty("display")?c.display:null,l.style.display=mt("display",s))}catch(e){Cc(t,t.return,e)}}}else if(6===d.tag){if(null===h)try{d.stateNode.nodeValue=u?"":d.memoizedProps}catch(e){Cc(t,t.return,e)}}else if((22!==d.tag&&23!==d.tag||null===d.memoizedState||d===t)&&null!==d.child){d.child.return=d,d=d.child;continue}if(d===t)break t;for(;null===d.sibling;){if(null===d.return||d.return===t)break t;h===d&&(h=null),d=d.return}h===d&&(h=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:ml(e,t),_l(t),4&i&&fl(t);case 21:}}function _l(t){var e=t.flags;if(2&e){try{t:{for(var n=t.return;null!==n;){if(ol(n)){var i=n;break t}n=n.return}throw Error(r(160))}switch(i.tag){case 5:var a=i.stateNode;32&i.flags&&(dt(a,""),i.flags&=-33),cl(t,sl(t),a);break;case 3:case 4:var o=i.stateNode.containerInfo;ll(t,sl(t),o);break;default:throw Error(r(161))}}catch(e){Cc(t,t.return,e)}t.flags&=-3}4096&e&&(t.flags&=-4097)}function yl(t,e,n){Qs=t,xl(t,e,n)}function xl(t,e,n){for(var i=!!(1&t.mode);null!==Qs;){var a=Qs,r=a.child;if(22===a.tag&&i){var o=null!==a.memoizedState||Ys;if(!o){var s=a.alternate,l=null!==s&&null!==s.memoizedState||Xs;s=Ys;var c=Xs;if(Ys=o,(Xs=l)&&!c)for(Qs=a;null!==Qs;)l=(o=Qs).child,22===o.tag&&null!==o.memoizedState?wl(a):null!==l?(l.return=o,Qs=l):wl(a);for(;null!==r;)Qs=r,xl(r,e,n),r=r.sibling;Qs=a,Ys=s,Xs=c}vl(t)}else 8772&a.subtreeFlags&&null!==r?(r.return=a,Qs=r):vl(t)}}function vl(t){for(;null!==Qs;){var e=Qs;if(8772&e.flags){var n=e.alternate;try{if(8772&e.flags)switch(e.tag){case 0:case 11:case 15:Xs||il(5,e);break;case 1:var i=e.stateNode;if(4&e.flags&&!Xs)if(null===n)i.componentDidMount();else{var a=e.elementType===e.type?n.memoizedProps:ns(e.type,n.memoizedProps);i.componentDidUpdate(a,n.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var o=e.updateQueue;null!==o&&Gr(e,o,i);break;case 3:var s=e.updateQueue;if(null!==s){if(n=null,null!==e.child)switch(e.child.tag){case 5:case 1:n=e.child.stateNode}Gr(e,s,n)}break;case 5:var l=e.stateNode;if(null===n&&4&e.flags){n=l;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===e.memoizedState){var u=e.alternate;if(null!==u){var h=u.memoizedState;if(null!==h){var d=h.dehydrated;null!==d&&Ue(d)}}}break;default:throw Error(r(163))}Xs||512&e.flags&&al(e)}catch(t){Cc(e,e.return,t)}}if(e===t){Qs=null;break}if(null!==(n=e.sibling)){n.return=e.return,Qs=n;break}Qs=e.return}}function bl(t){for(;null!==Qs;){var e=Qs;if(e===t){Qs=null;break}var n=e.sibling;if(null!==n){n.return=e.return,Qs=n;break}Qs=e.return}}function wl(t){for(;null!==Qs;){var e=Qs;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{il(4,e)}catch(t){Cc(e,n,t)}break;case 1:var i=e.stateNode;if("function"==typeof i.componentDidMount){var a=e.return;try{i.componentDidMount()}catch(t){Cc(e,a,t)}}var r=e.return;try{al(e)}catch(t){Cc(e,r,t)}break;case 5:var o=e.return;try{al(e)}catch(t){Cc(e,o,t)}}}catch(t){Cc(e,e.return,t)}if(e===t){Qs=null;break}var s=e.sibling;if(null!==s){s.return=e.return,Qs=s;break}Qs=e.return}}var Al,Cl=Math.ceil,El=v.ReactCurrentDispatcher,Tl=v.ReactCurrentOwner,Sl=v.ReactCurrentBatchConfig,Ml=0,kl=null,Il=null,Pl=0,zl=0,Dl=Ca(0),Ll=0,Bl=null,Ol=0,Rl=0,Fl=0,Nl=null,jl=null,Vl=0,Ul=1/0,Gl=null,ql=!1,$l=null,Wl=null,Hl=!1,Zl=null,Yl=0,Xl=0,Kl=null,Ql=-1,Jl=0;function tc(){return 6&Ml?Kt():-1!==Ql?Ql:Ql=Kt()}function ec(t){return 1&t.mode?2&Ml&&0!==Pl?Pl&-Pl:null!==mr.transition?(0===Jl&&(Jl=me()),Jl):0!==(t=xe)?t:t=void 0===(t=window.event)?16:Xe(t.type):1}function nc(t,e,n,i){if(50<Xl)throw Xl=0,Kl=null,Error(r(185));_e(t,n,i),2&Ml&&t===kl||(t===kl&&(!(2&Ml)&&(Rl|=n),4===Ll&&sc(t,Pl)),ic(t,i),1===n&&0===Ml&&!(1&e.mode)&&(Ul=Kt()+500,Na&&Ua()))}function ic(t,e){var n=t.callbackNode;!function(t,e){for(var n=t.suspendedLanes,i=t.pingedLanes,a=t.expirationTimes,r=t.pendingLanes;0<r;){var o=31-oe(r),s=1<<o,l=a[o];-1===l?s&n&&!(s&i)||(a[o]=pe(s,e)):l<=e&&(t.expiredLanes|=s),r&=~s}}(t,e);var i=de(t,t===kl?Pl:0);if(0===i)null!==n&&Zt(n),t.callbackNode=null,t.callbackPriority=0;else if(e=i&-i,t.callbackPriority!==e){if(null!=n&&Zt(n),1===e)0===t.tag?function(t){Na=!0,Va(t)}(lc.bind(null,t)):Va(lc.bind(null,t)),oa((function(){!(6&Ml)&&Ua()})),n=null;else{switch(ve(i)){case 1:n=Jt;break;case 4:n=te;break;case 16:default:n=ee;break;case 536870912:n=ie}n=kc(n,ac.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function ac(t,e){if(Ql=-1,Jl=0,6&Ml)throw Error(r(327));var n=t.callbackNode;if(wc()&&t.callbackNode!==n)return null;var i=de(t,t===kl?Pl:0);if(0===i)return null;if(30&i||i&t.expiredLanes||e)e=gc(t,i);else{e=i;var a=Ml;Ml|=2;var o=fc();for(kl===t&&Pl===e||(Gl=null,Ul=Kt()+500,dc(t,e));;)try{yc();break}catch(e){pc(t,e)}Tr(),El.current=o,Ml=a,null!==Il?e=0:(kl=null,Pl=0,e=Ll)}if(0!==e){if(2===e&&0!==(a=fe(t))&&(i=a,e=rc(t,a)),1===e)throw n=Bl,dc(t,0),sc(t,i),ic(t,Kt()),n;if(6===e)sc(t,i);else{if(a=t.current.alternate,!(30&i||function(t){for(var e=t;;){if(16384&e.flags){var n=e.updateQueue;if(null!==n&&null!==(n=n.stores))for(var i=0;i<n.length;i++){var a=n[i],r=a.getSnapshot;a=a.value;try{if(!si(r(),a))return!1}catch(t){return!1}}}if(n=e.child,16384&e.subtreeFlags&&null!==n)n.return=e,e=n;else{if(e===t)break;for(;null===e.sibling;){if(null===e.return||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}(a)||(e=gc(t,i),2===e&&(o=fe(t),0!==o&&(i=o,e=rc(t,o))),1!==e)))throw n=Bl,dc(t,0),sc(t,i),ic(t,Kt()),n;switch(t.finishedWork=a,t.finishedLanes=i,e){case 0:case 1:throw Error(r(345));case 2:case 5:bc(t,jl,Gl);break;case 3:if(sc(t,i),(130023424&i)===i&&10<(e=Vl+500-Kt())){if(0!==de(t,0))break;if(((a=t.suspendedLanes)&i)!==i){tc(),t.pingedLanes|=t.suspendedLanes&a;break}t.timeoutHandle=ia(bc.bind(null,t,jl,Gl),e);break}bc(t,jl,Gl);break;case 4:if(sc(t,i),(4194240&i)===i)break;for(e=t.eventTimes,a=-1;0<i;){var s=31-oe(i);o=1<<s,(s=e[s])>a&&(a=s),i&=~o}if(i=a,10<(i=(120>(i=Kt()-i)?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*Cl(i/1960))-i)){t.timeoutHandle=ia(bc.bind(null,t,jl,Gl),i);break}bc(t,jl,Gl);break;default:throw Error(r(329))}}}return ic(t,Kt()),t.callbackNode===n?ac.bind(null,t):null}function rc(t,e){var n=Nl;return t.current.memoizedState.isDehydrated&&(dc(t,e).flags|=256),2!==(t=gc(t,e))&&(e=jl,jl=n,null!==e&&oc(e)),t}function oc(t){null===jl?jl=t:jl.push.apply(jl,t)}function sc(t,e){for(e&=~Fl,e&=~Rl,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-oe(e),i=1<<n;t[n]=-1,e&=~i}}function lc(t){if(6&Ml)throw Error(r(327));wc();var e=de(t,0);if(!(1&e))return ic(t,Kt()),null;var n=gc(t,e);if(0!==t.tag&&2===n){var i=fe(t);0!==i&&(e=i,n=rc(t,i))}if(1===n)throw n=Bl,dc(t,0),sc(t,e),ic(t,Kt()),n;if(6===n)throw Error(r(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,bc(t,jl,Gl),ic(t,Kt()),null}function cc(t,e){var n=Ml;Ml|=1;try{return t(e)}finally{0===(Ml=n)&&(Ul=Kt()+500,Na&&Ua())}}function uc(t){null!==Zl&&0===Zl.tag&&!(6&Ml)&&wc();var e=Ml;Ml|=1;var n=Sl.transition,i=xe;try{if(Sl.transition=null,xe=1,t)return t()}finally{xe=i,Sl.transition=n,!(6&(Ml=e))&&Ua()}}function hc(){zl=Dl.current,Ea(Dl)}function dc(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(-1!==n&&(t.timeoutHandle=-1,aa(n)),null!==Il)for(n=Il.return;null!==n;){var i=n;switch(er(i),i.tag){case 1:null!=(i=i.type.childContextTypes)&&Da();break;case 3:Xr(),Ea(ka),Ea(Ma),no();break;case 5:Qr(i);break;case 4:Xr();break;case 13:case 19:Ea(Jr);break;case 10:Sr(i.type._context);break;case 22:case 23:hc()}n=n.return}if(kl=t,Il=t=Dc(t.current,null),Pl=zl=e,Ll=0,Bl=null,Fl=Rl=Ol=0,jl=Nl=null,null!==Pr){for(e=0;e<Pr.length;e++)if(null!==(i=(n=Pr[e]).interleaved)){n.interleaved=null;var a=i.next,r=n.pending;if(null!==r){var o=r.next;r.next=a,i.next=o}n.pending=i}Pr=null}return t}function pc(t,e){for(;;){var n=Il;try{if(Tr(),io.current=Qo,co){for(var i=oo.memoizedState;null!==i;){var a=i.queue;null!==a&&(a.pending=null),i=i.next}co=!1}if(ro=0,lo=so=oo=null,uo=!1,ho=0,Tl.current=null,null===n||null===n.return){Ll=1,Bl=e,Il=null;break}t:{var o=t,s=n.return,l=n,c=e;if(e=Pl,l.flags|=32768,null!==c&&"object"==typeof c&&"function"==typeof c.then){var u=c,h=l,d=h.tag;if(!(1&h.mode||0!==d&&11!==d&&15!==d)){var p=h.alternate;p?(h.updateQueue=p.updateQueue,h.memoizedState=p.memoizedState,h.lanes=p.lanes):(h.updateQueue=null,h.memoizedState=null)}var f=gs(s);if(null!==f){f.flags&=-257,_s(f,s,l,0,e),1&f.mode&&ms(o,u,e),c=u;var m=(e=f).updateQueue;if(null===m){var g=new Set;g.add(c),e.updateQueue=g}else m.add(c);break t}if(!(1&e)){ms(o,u,e),mc();break t}c=Error(r(426))}else if(ar&&1&l.mode){var _=gs(s);if(null!==_){!(65536&_.flags)&&(_.flags|=256),_s(_,s,l,0,e),fr(cs(c,l));break t}}o=c=cs(c,l),4!==Ll&&(Ll=2),null===Nl?Nl=[o]:Nl.push(o),o=s;do{switch(o.tag){case 3:o.flags|=65536,e&=-e,o.lanes|=e,Vr(o,ps(0,c,e));break t;case 1:l=c;var y=o.type,x=o.stateNode;if(!(128&o.flags||"function"!=typeof y.getDerivedStateFromError&&(null===x||"function"!=typeof x.componentDidCatch||null!==Wl&&Wl.has(x)))){o.flags|=65536,e&=-e,o.lanes|=e,Vr(o,fs(o,l,e));break t}}o=o.return}while(null!==o)}vc(n)}catch(t){e=t,Il===n&&null!==n&&(Il=n=n.return);continue}break}}function fc(){var t=El.current;return El.current=Qo,null===t?Qo:t}function mc(){0!==Ll&&3!==Ll&&2!==Ll||(Ll=4),null===kl||!(268435455&Ol)&&!(268435455&Rl)||sc(kl,Pl)}function gc(t,e){var n=Ml;Ml|=2;var i=fc();for(kl===t&&Pl===e||(Gl=null,dc(t,e));;)try{_c();break}catch(e){pc(t,e)}if(Tr(),Ml=n,El.current=i,null!==Il)throw Error(r(261));return kl=null,Pl=0,Ll}function _c(){for(;null!==Il;)xc(Il)}function yc(){for(;null!==Il&&!Yt();)xc(Il)}function xc(t){var e=Al(t.alternate,t,zl);t.memoizedProps=t.pendingProps,null===e?vc(t):Il=e,Tl.current=null}function vc(t){var e=t;do{var n=e.alternate;if(t=e.return,32768&e.flags){if(null!==(n=Zs(n,e)))return n.flags&=32767,void(Il=n);if(null===t)return Ll=6,void(Il=null);t.flags|=32768,t.subtreeFlags=0,t.deletions=null}else if(null!==(n=Hs(n,e,zl)))return void(Il=n);if(null!==(e=e.sibling))return void(Il=e);Il=e=t}while(null!==e);0===Ll&&(Ll=5)}function bc(t,e,n){var i=xe,a=Sl.transition;try{Sl.transition=null,xe=1,function(t,e,n,i){do{wc()}while(null!==Zl);if(6&Ml)throw Error(r(327));n=t.finishedWork;var a=t.finishedLanes;if(null===n)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(r(177));t.callbackNode=null,t.callbackPriority=0;var o=n.lanes|n.childLanes;if(function(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var i=t.eventTimes;for(t=t.expirationTimes;0<n;){var a=31-oe(n),r=1<<a;e[a]=0,i[a]=-1,t[a]=-1,n&=~r}}(t,o),t===kl&&(Il=kl=null,Pl=0),!(2064&n.subtreeFlags)&&!(2064&n.flags)||Hl||(Hl=!0,kc(ee,(function(){return wc(),null}))),o=!!(15990&n.flags),15990&n.subtreeFlags||o){o=Sl.transition,Sl.transition=null;var s=xe;xe=1;var l=Ml;Ml|=4,Tl.current=null,function(t,e){if(ta=qe,pi(t=di())){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else t:{var i=(n=(n=t.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(i&&0!==i.rangeCount){n=i.anchorNode;var a=i.anchorOffset,o=i.focusNode;i=i.focusOffset;try{n.nodeType,o.nodeType}catch(t){n=null;break t}var s=0,l=-1,c=-1,u=0,h=0,d=t,p=null;e:for(;;){for(var f;d!==n||0!==a&&3!==d.nodeType||(l=s+a),d!==o||0!==i&&3!==d.nodeType||(c=s+i),3===d.nodeType&&(s+=d.nodeValue.length),null!==(f=d.firstChild);)p=d,d=f;for(;;){if(d===t)break e;if(p===n&&++u===a&&(l=s),p===o&&++h===i&&(c=s),null!==(f=d.nextSibling))break;p=(d=p).parentNode}d=f}n=-1===l||-1===c?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(ea={focusedElem:t,selectionRange:n},qe=!1,Qs=e;null!==Qs;)if(t=(e=Qs).child,1028&e.subtreeFlags&&null!==t)t.return=e,Qs=t;else for(;null!==Qs;){e=Qs;try{var m=e.alternate;if(1024&e.flags)switch(e.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==m){var g=m.memoizedProps,_=m.memoizedState,y=e.stateNode,x=y.getSnapshotBeforeUpdate(e.elementType===e.type?g:ns(e.type,g),_);y.__reactInternalSnapshotBeforeUpdate=x}break;case 3:var v=e.stateNode.containerInfo;1===v.nodeType?v.textContent="":9===v.nodeType&&v.documentElement&&v.removeChild(v.documentElement);break;default:throw Error(r(163))}}catch(t){Cc(e,e.return,t)}if(null!==(t=e.sibling)){t.return=e.return,Qs=t;break}Qs=e.return}m=el,el=!1}(t,n),gl(n,t),fi(ea),qe=!!ta,ea=ta=null,t.current=n,yl(n,t,a),Xt(),Ml=l,xe=s,Sl.transition=o}else t.current=n;if(Hl&&(Hl=!1,Zl=t,Yl=a),0===(o=t.pendingLanes)&&(Wl=null),function(t){if(re&&"function"==typeof re.onCommitFiberRoot)try{re.onCommitFiberRoot(ae,t,void 0,!(128&~t.current.flags))}catch(t){}}(n.stateNode),ic(t,Kt()),null!==e)for(i=t.onRecoverableError,n=0;n<e.length;n++)i((a=e[n]).value,{componentStack:a.stack,digest:a.digest});if(ql)throw ql=!1,t=$l,$l=null,t;!!(1&Yl)&&0!==t.tag&&wc(),1&(o=t.pendingLanes)?t===Kl?Xl++:(Xl=0,Kl=t):Xl=0,Ua()}(t,e,n,i)}finally{Sl.transition=a,xe=i}return null}function wc(){if(null!==Zl){var t=ve(Yl),e=Sl.transition,n=xe;try{if(Sl.transition=null,xe=16>t?16:t,null===Zl)var i=!1;else{if(t=Zl,Zl=null,Yl=0,6&Ml)throw Error(r(331));var a=Ml;for(Ml|=4,Qs=t.current;null!==Qs;){var o=Qs,s=o.child;if(16&Qs.flags){var l=o.deletions;if(null!==l){for(var c=0;c<l.length;c++){var u=l[c];for(Qs=u;null!==Qs;){var h=Qs;switch(h.tag){case 0:case 11:case 15:nl(8,h,o)}var d=h.child;if(null!==d)d.return=h,Qs=d;else for(;null!==Qs;){var p=(h=Qs).sibling,f=h.return;if(rl(h),h===u){Qs=null;break}if(null!==p){p.return=f,Qs=p;break}Qs=f}}}var m=o.alternate;if(null!==m){var g=m.child;if(null!==g){m.child=null;do{var _=g.sibling;g.sibling=null,g=_}while(null!==g)}}Qs=o}}if(2064&o.subtreeFlags&&null!==s)s.return=o,Qs=s;else t:for(;null!==Qs;){if(2048&(o=Qs).flags)switch(o.tag){case 0:case 11:case 15:nl(9,o,o.return)}var y=o.sibling;if(null!==y){y.return=o.return,Qs=y;break t}Qs=o.return}}var x=t.current;for(Qs=x;null!==Qs;){var v=(s=Qs).child;if(2064&s.subtreeFlags&&null!==v)v.return=s,Qs=v;else t:for(s=x;null!==Qs;){if(2048&(l=Qs).flags)try{switch(l.tag){case 0:case 11:case 15:il(9,l)}}catch(t){Cc(l,l.return,t)}if(l===s){Qs=null;break t}var b=l.sibling;if(null!==b){b.return=l.return,Qs=b;break t}Qs=l.return}}if(Ml=a,Ua(),re&&"function"==typeof re.onPostCommitFiberRoot)try{re.onPostCommitFiberRoot(ae,t)}catch(t){}i=!0}return i}finally{xe=n,Sl.transition=e}}return!1}function Ac(t,e,n){t=Nr(t,e=ps(0,e=cs(n,e),1),1),e=tc(),null!==t&&(_e(t,1,e),ic(t,e))}function Cc(t,e,n){if(3===t.tag)Ac(t,t,n);else for(;null!==e;){if(3===e.tag){Ac(e,t,n);break}if(1===e.tag){var i=e.stateNode;if("function"==typeof e.type.getDerivedStateFromError||"function"==typeof i.componentDidCatch&&(null===Wl||!Wl.has(i))){e=Nr(e,t=fs(e,t=cs(n,t),1),1),t=tc(),null!==e&&(_e(e,1,t),ic(e,t));break}}e=e.return}}function Ec(t,e,n){var i=t.pingCache;null!==i&&i.delete(e),e=tc(),t.pingedLanes|=t.suspendedLanes&n,kl===t&&(Pl&n)===n&&(4===Ll||3===Ll&&(130023424&Pl)===Pl&&500>Kt()-Vl?dc(t,0):Fl|=n),ic(t,e)}function Tc(t,e){0===e&&(1&t.mode?(e=ue,!(130023424&(ue<<=1))&&(ue=4194304)):e=1);var n=tc();null!==(t=Lr(t,e))&&(_e(t,e,n),ic(t,n))}function Sc(t){var e=t.memoizedState,n=0;null!==e&&(n=e.retryLane),Tc(t,n)}function Mc(t,e){var n=0;switch(t.tag){case 13:var i=t.stateNode,a=t.memoizedState;null!==a&&(n=a.retryLane);break;case 19:i=t.stateNode;break;default:throw Error(r(314))}null!==i&&i.delete(e),Tc(t,n)}function kc(t,e){return Ht(t,e)}function Ic(t,e,n,i){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Pc(t,e,n,i){return new Ic(t,e,n,i)}function zc(t){return!(!(t=t.prototype)||!t.isReactComponent)}function Dc(t,e){var n=t.alternate;return null===n?((n=Pc(t.tag,e,t.key,t.mode)).elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&t.flags,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Lc(t,e,n,i,a,o){var s=2;if(i=t,"function"==typeof t)zc(t)&&(s=1);else if("string"==typeof t)s=5;else t:switch(t){case A:return Bc(n.children,a,o,e);case C:s=8,a|=8;break;case E:return(t=Pc(12,n,e,2|a)).elementType=E,t.lanes=o,t;case k:return(t=Pc(13,n,e,a)).elementType=k,t.lanes=o,t;case I:return(t=Pc(19,n,e,a)).elementType=I,t.lanes=o,t;case D:return Oc(n,a,o,e);default:if("object"==typeof t&&null!==t)switch(t.$$typeof){case T:s=10;break t;case S:s=9;break t;case M:s=11;break t;case P:s=14;break t;case z:s=16,i=null;break t}throw Error(r(130,null==t?t:typeof t,""))}return(e=Pc(s,n,e,a)).elementType=t,e.type=i,e.lanes=o,e}function Bc(t,e,n,i){return(t=Pc(7,t,i,e)).lanes=n,t}function Oc(t,e,n,i){return(t=Pc(22,t,i,e)).elementType=D,t.lanes=n,t.stateNode={isHidden:!1},t}function Rc(t,e,n){return(t=Pc(6,t,null,e)).lanes=n,t}function Fc(t,e,n){return(e=Pc(4,null!==t.children?t.children:[],t.key,e)).lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function Nc(t,e,n,i,a){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ge(0),this.expirationTimes=ge(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ge(0),this.identifierPrefix=i,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function jc(t,e,n,i,a,r,o,s,l){return t=new Nc(t,e,n,s,l),1===e?(e=1,!0===r&&(e|=8)):e=0,r=Pc(3,null,null,e),t.current=r,r.stateNode=t,r.memoizedState={element:i,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Or(r),t}function Vc(t){if(!t)return Sa;t:{if(Ut(t=t._reactInternals)!==t||1!==t.tag)throw Error(r(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break t;case 1:if(za(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break t}}e=e.return}while(null!==e);throw Error(r(171))}if(1===t.tag){var n=t.type;if(za(n))return Ba(t,n,e)}return e}function Uc(t,e,n,i,a,r,o,s,l){return(t=jc(n,i,!0,t,0,r,0,s,l)).context=Vc(null),n=t.current,(r=Fr(i=tc(),a=ec(n))).callback=null!=e?e:null,Nr(n,r,a),t.current.lanes=a,_e(t,a,i),ic(t,i),t}function Gc(t,e,n,i){var a=e.current,r=tc(),o=ec(a);return n=Vc(n),null===e.context?e.context=n:e.pendingContext=n,(e=Fr(r,o)).payload={element:t},null!==(i=void 0===i?null:i)&&(e.callback=i),null!==(t=Nr(a,e,o))&&(nc(t,a,o,r),jr(t,a,o)),o}function qc(t){return(t=t.current).child?(t.child.tag,t.child.stateNode):null}function $c(t,e){if(null!==(t=t.memoizedState)&&null!==t.dehydrated){var n=t.retryLane;t.retryLane=0!==n&&n<e?n:e}}function Wc(t,e){$c(t,e),(t=t.alternate)&&$c(t,e)}Al=function(t,e,n){if(null!==t)if(t.memoizedProps!==e.pendingProps||ka.current)xs=!0;else{if(!(t.lanes&n||128&e.flags))return xs=!1,function(t,e,n){switch(e.tag){case 3:ks(e),pr();break;case 5:Kr(e);break;case 1:za(e.type)&&Oa(e);break;case 4:Yr(e,e.stateNode.containerInfo);break;case 10:var i=e.type._context,a=e.memoizedProps.value;Ta(wr,i._currentValue),i._currentValue=a;break;case 13:if(null!==(i=e.memoizedState))return null!==i.dehydrated?(Ta(Jr,1&Jr.current),e.flags|=128,null):n&e.child.childLanes?Rs(t,e,n):(Ta(Jr,1&Jr.current),null!==(t=qs(t,e,n))?t.sibling:null);Ta(Jr,1&Jr.current);break;case 19:if(i=!!(n&e.childLanes),128&t.flags){if(i)return Us(t,e,n);e.flags|=128}if(null!==(a=e.memoizedState)&&(a.rendering=null,a.tail=null,a.lastEffect=null),Ta(Jr,Jr.current),i)break;return null;case 22:case 23:return e.lanes=0,Cs(t,e,n)}return qs(t,e,n)}(t,e,n);xs=!!(131072&t.flags)}else xs=!1,ar&&1048576&e.flags&&Ja(e,Wa,e.index);switch(e.lanes=0,e.tag){case 2:var i=e.type;Gs(t,e),t=e.pendingProps;var a=Pa(e,Ma.current);kr(e,n),a=go(null,e,i,t,a,n);var o=_o();return e.flags|=1,"object"==typeof a&&null!==a&&"function"==typeof a.render&&void 0===a.$$typeof?(e.tag=1,e.memoizedState=null,e.updateQueue=null,za(i)?(o=!0,Oa(e)):o=!1,e.memoizedState=null!==a.state&&void 0!==a.state?a.state:null,Or(e),a.updater=as,e.stateNode=a,a._reactInternals=e,ls(e,i,t,n),e=Ms(null,e,i,!0,o,n)):(e.tag=0,ar&&o&&tr(e),vs(null,e,a,n),e=e.child),e;case 16:i=e.elementType;t:{switch(Gs(t,e),t=e.pendingProps,i=(a=i._init)(i._payload),e.type=i,a=e.tag=function(t){if("function"==typeof t)return zc(t)?1:0;if(null!=t){if((t=t.$$typeof)===M)return 11;if(t===P)return 14}return 2}(i),t=ns(i,t),a){case 0:e=Ts(null,e,i,t,n);break t;case 1:e=Ss(null,e,i,t,n);break t;case 11:e=bs(null,e,i,t,n);break t;case 14:e=ws(null,e,i,ns(i.type,t),n);break t}throw Error(r(306,i,""))}return e;case 0:return i=e.type,a=e.pendingProps,Ts(t,e,i,a=e.elementType===i?a:ns(i,a),n);case 1:return i=e.type,a=e.pendingProps,Ss(t,e,i,a=e.elementType===i?a:ns(i,a),n);case 3:t:{if(ks(e),null===t)throw Error(r(387));i=e.pendingProps,a=(o=e.memoizedState).element,Rr(t,e),Ur(e,i,null,n);var s=e.memoizedState;if(i=s.element,o.isDehydrated){if(o={element:i,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},e.updateQueue.baseState=o,e.memoizedState=o,256&e.flags){e=Is(t,e,i,n,a=cs(Error(r(423)),e));break t}if(i!==a){e=Is(t,e,i,n,a=cs(Error(r(424)),e));break t}for(ir=ca(e.stateNode.containerInfo.firstChild),nr=e,ar=!0,rr=null,n=br(e,null,i,n),e.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(pr(),i===a){e=qs(t,e,n);break t}vs(t,e,i,n)}e=e.child}return e;case 5:return Kr(e),null===t&&cr(e),i=e.type,a=e.pendingProps,o=null!==t?t.memoizedProps:null,s=a.children,na(i,a)?s=null:null!==o&&na(i,o)&&(e.flags|=32),Es(t,e),vs(t,e,s,n),e.child;case 6:return null===t&&cr(e),null;case 13:return Rs(t,e,n);case 4:return Yr(e,e.stateNode.containerInfo),i=e.pendingProps,null===t?e.child=vr(e,null,i,n):vs(t,e,i,n),e.child;case 11:return i=e.type,a=e.pendingProps,bs(t,e,i,a=e.elementType===i?a:ns(i,a),n);case 7:return vs(t,e,e.pendingProps,n),e.child;case 8:case 12:return vs(t,e,e.pendingProps.children,n),e.child;case 10:t:{if(i=e.type._context,a=e.pendingProps,o=e.memoizedProps,s=a.value,Ta(wr,i._currentValue),i._currentValue=s,null!==o)if(si(o.value,s)){if(o.children===a.children&&!ka.current){e=qs(t,e,n);break t}}else for(null!==(o=e.child)&&(o.return=e);null!==o;){var l=o.dependencies;if(null!==l){s=o.child;for(var c=l.firstContext;null!==c;){if(c.context===i){if(1===o.tag){(c=Fr(-1,n&-n)).tag=2;var u=o.updateQueue;if(null!==u){var h=(u=u.shared).pending;null===h?c.next=c:(c.next=h.next,h.next=c),u.pending=c}}o.lanes|=n,null!==(c=o.alternate)&&(c.lanes|=n),Mr(o.return,n,e),l.lanes|=n;break}c=c.next}}else if(10===o.tag)s=o.type===e.type?null:o.child;else if(18===o.tag){if(null===(s=o.return))throw Error(r(341));s.lanes|=n,null!==(l=s.alternate)&&(l.lanes|=n),Mr(s,n,e),s=o.sibling}else s=o.child;if(null!==s)s.return=o;else for(s=o;null!==s;){if(s===e){s=null;break}if(null!==(o=s.sibling)){o.return=s.return,s=o;break}s=s.return}o=s}vs(t,e,a.children,n),e=e.child}return e;case 9:return a=e.type,i=e.pendingProps.children,kr(e,n),i=i(a=Ir(a)),e.flags|=1,vs(t,e,i,n),e.child;case 14:return a=ns(i=e.type,e.pendingProps),ws(t,e,i,a=ns(i.type,a),n);case 15:return As(t,e,e.type,e.pendingProps,n);case 17:return i=e.type,a=e.pendingProps,a=e.elementType===i?a:ns(i,a),Gs(t,e),e.tag=1,za(i)?(t=!0,Oa(e)):t=!1,kr(e,n),os(e,i,a),ls(e,i,a,n),Ms(null,e,i,!0,t,n);case 19:return Us(t,e,n);case 22:return Cs(t,e,n)}throw Error(r(156,e.tag))};var Hc="function"==typeof reportError?reportError:function(t){console.error(t)};function Zc(t){this._internalRoot=t}function Yc(t){this._internalRoot=t}function Xc(t){return!(!t||1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType)}function Kc(t){return!(!t||1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType&&(8!==t.nodeType||" react-mount-point-unstable "!==t.nodeValue))}function Qc(){}function Jc(t,e,n,i,a){var r=n._reactRootContainer;if(r){var o=r;if("function"==typeof a){var s=a;a=function(){var t=qc(o);s.call(t)}}Gc(e,o,t,a)}else o=function(t,e,n,i,a){if(a){if("function"==typeof i){var r=i;i=function(){var t=qc(o);r.call(t)}}var o=Uc(e,i,t,0,null,!1,0,"",Qc);return t._reactRootContainer=o,t[fa]=o.current,Ui(8===t.nodeType?t.parentNode:t),uc(),o}for(;a=t.lastChild;)t.removeChild(a);if("function"==typeof i){var s=i;i=function(){var t=qc(l);s.call(t)}}var l=jc(t,0,!1,null,0,!1,0,"",Qc);return t._reactRootContainer=l,t[fa]=l.current,Ui(8===t.nodeType?t.parentNode:t),uc((function(){Gc(e,l,n,i)})),l}(n,e,t,a,i);return qc(o)}Yc.prototype.render=Zc.prototype.render=function(t){var e=this._internalRoot;if(null===e)throw Error(r(409));Gc(t,e,null,null)},Yc.prototype.unmount=Zc.prototype.unmount=function(){var t=this._internalRoot;if(null!==t){this._internalRoot=null;var e=t.containerInfo;uc((function(){Gc(null,t,null,null)})),e[fa]=null}},Yc.prototype.unstable_scheduleHydration=function(t){if(t){var e=Ce();t={blockedOn:null,target:t,priority:e};for(var n=0;n<De.length&&0!==e&&e<De[n].priority;n++);De.splice(n,0,t),0===n&&Re(t)}},be=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=he(e.pendingLanes);0!==n&&(ye(e,1|n),ic(e,Kt()),!(6&Ml)&&(Ul=Kt()+500,Ua()))}break;case 13:uc((function(){var e=Lr(t,1);if(null!==e){var n=tc();nc(e,t,1,n)}})),Wc(t,1)}},we=function(t){if(13===t.tag){var e=Lr(t,134217728);null!==e&&nc(e,t,134217728,tc()),Wc(t,134217728)}},Ae=function(t){if(13===t.tag){var e=ec(t),n=Lr(t,e);null!==n&&nc(n,t,e,tc()),Wc(t,e)}},Ce=function(){return xe},Ee=function(t,e){var n=xe;try{return xe=t,e()}finally{xe=n}},wt=function(t,e,n){switch(e){case"input":if(Q(t,n),e=n.name,"radio"===n.type&&null!=e){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var i=n[e];if(i!==t&&i.form===t.form){var a=ba(i);if(!a)throw Error(r(90));H(i),Q(i,a)}}}break;case"textarea":rt(t,n);break;case"select":null!=(e=n.value)&&nt(t,!!n.multiple,e,!1)}},Mt=cc,kt=uc;var tu={usingClientEntryPoint:!1,Events:[xa,va,ba,Tt,St,cc]},eu={findFiberByHostInstance:ya,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},nu={bundleType:eu.bundleType,version:eu.version,rendererPackageName:eu.rendererPackageName,rendererConfig:eu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:v.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return null===(t=$t(t))?null:t.stateNode},findFiberByHostInstance:eu.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var iu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!iu.isDisabled&&iu.supportsFiber)try{ae=iu.inject(nu),re=iu}catch(ut){}}e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=tu,e.createPortal=function(t,e){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Xc(e))throw Error(r(200));return function(t,e,n){var i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:w,key:null==i?null:""+i,children:t,containerInfo:e,implementation:n}}(t,e,null,n)},e.createRoot=function(t,e){if(!Xc(t))throw Error(r(299));var n=!1,i="",a=Hc;return null!=e&&(!0===e.unstable_strictMode&&(n=!0),void 0!==e.identifierPrefix&&(i=e.identifierPrefix),void 0!==e.onRecoverableError&&(a=e.onRecoverableError)),e=jc(t,1,!1,null,0,n,0,i,a),t[fa]=e.current,Ui(8===t.nodeType?t.parentNode:t),new Zc(e)},e.findDOMNode=function(t){if(null==t)return null;if(1===t.nodeType)return t;var e=t._reactInternals;if(void 0===e){if("function"==typeof t.render)throw Error(r(188));throw t=Object.keys(t).join(","),Error(r(268,t))}return null===(t=$t(e))?null:t.stateNode},e.flushSync=function(t){return uc(t)},e.hydrate=function(t,e,n){if(!Kc(e))throw Error(r(200));return Jc(null,t,e,!0,n)},e.hydrateRoot=function(t,e,n){if(!Xc(t))throw Error(r(405));var i=null!=n&&n.hydratedSources||null,a=!1,o="",s=Hc;if(null!=n&&(!0===n.unstable_strictMode&&(a=!0),void 0!==n.identifierPrefix&&(o=n.identifierPrefix),void 0!==n.onRecoverableError&&(s=n.onRecoverableError)),e=Uc(e,null,t,1,null!=n?n:null,a,0,o,s),t[fa]=e.current,Ui(t),i)for(t=0;t<i.length;t++)a=(a=(n=i[t])._getVersion)(n._source),null==e.mutableSourceEagerHydrationData?e.mutableSourceEagerHydrationData=[n,a]:e.mutableSourceEagerHydrationData.push(n,a);return new Yc(e)},e.render=function(t,e,n){if(!Kc(e))throw Error(r(200));return Jc(null,t,e,!1,n)},e.unmountComponentAtNode=function(t){if(!Kc(t))throw Error(r(40));return!!t._reactRootContainer&&(uc((function(){Jc(null,null,t,!1,(function(){t._reactRootContainer=null,t[fa]=null}))})),!0)},e.unstable_batchedUpdates=cc,e.unstable_renderSubtreeIntoContainer=function(t,e,n,i){if(!Kc(n))throw Error(r(200));if(null==t||void 0===t._reactInternals)throw Error(r(38));return Jc(t,e,n,!1,i)},e.version="18.3.1-next-f1338f8080-20240426"},5338:(t,e,n)=>{"use strict";var i=n(961);e.createRoot=i.createRoot,e.hydrateRoot=i.hydrateRoot},961:(t,e,n)=>{"use strict";!function t(){if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(t){console.error(t)}}(),t.exports=n(2551)},1921:(t,e,n)=>{(()=>{var e={181:(t,e,n)=>{var i=/^\s+|\s+$/g,a=/^[-+]0x[0-9a-f]+$/i,r=/^0b[01]+$/i,o=/^0o[0-7]+$/i,s=parseInt,l="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g,c="object"==typeof self&&self&&self.Object===Object&&self,u=l||c||Function("return this")(),h=Object.prototype.toString,d=Math.max,p=Math.min,f=function(){return u.Date.now()};function m(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function g(t){if("number"==typeof t)return t;if(function(t){return"symbol"==typeof t||function(t){return!!t&&"object"==typeof t}(t)&&"[object Symbol]"==h.call(t)}(t))return NaN;if(m(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=m(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(i,"");var n=r.test(t);return n||o.test(t)?s(t.slice(2),n?2:8):a.test(t)?NaN:+t}t.exports=function(t,e,n){var i,a,r,o,s,l,c=0,u=!1,h=!1,_=!0;if("function"!=typeof t)throw new TypeError("Expected a function");function y(e){var n=i,r=a;return i=a=void 0,c=e,o=t.apply(r,n)}function x(t){var n=t-l;return void 0===l||n>=e||n<0||h&&t-c>=r}function v(){var t=f();if(x(t))return b(t);s=setTimeout(v,function(t){var n=e-(t-l);return h?p(n,r-(t-c)):n}(t))}function b(t){return s=void 0,_&&i?y(t):(i=a=void 0,o)}function w(){var t=f(),n=x(t);if(i=arguments,a=this,l=t,n){if(void 0===s)return function(t){return c=t,s=setTimeout(v,e),u?y(t):o}(l);if(h)return s=setTimeout(v,e),y(l)}return void 0===s&&(s=setTimeout(v,e)),o}return e=g(e)||0,m(n)&&(u=!!n.leading,r=(h="maxWait"in n)?d(g(n.maxWait)||0,e):r,_="trailing"in n?!!n.trailing:_),w.cancel=function(){void 0!==s&&clearTimeout(s),c=0,i=l=a=s=void 0},w.flush=function(){return void 0===s?o:b(f())},w}},858:(t,e,n)=>{var i="Expected a function",a=/^\s+|\s+$/g,r=/^[-+]0x[0-9a-f]+$/i,o=/^0b[01]+$/i,s=/^0o[0-7]+$/i,l=parseInt,c="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g,u="object"==typeof self&&self&&self.Object===Object&&self,h=c||u||Function("return this")(),d=Object.prototype.toString,p=Math.max,f=Math.min,m=function(){return h.Date.now()};function g(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function _(t){if("number"==typeof t)return t;if(function(t){return"symbol"==typeof t||function(t){return!!t&&"object"==typeof t}(t)&&"[object Symbol]"==d.call(t)}(t))return NaN;if(g(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=g(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(a,"");var n=o.test(t);return n||s.test(t)?l(t.slice(2),n?2:8):r.test(t)?NaN:+t}t.exports=function(t,e,n){var a=!0,r=!0;if("function"!=typeof t)throw new TypeError(i);return g(n)&&(a="leading"in n?!!n.leading:a,r="trailing"in n?!!n.trailing:r),function(t,e,n){var a,r,o,s,l,c,u=0,h=!1,d=!1,y=!0;if("function"!=typeof t)throw new TypeError(i);function x(e){var n=a,i=r;return a=r=void 0,u=e,s=t.apply(i,n)}function v(t){var n=t-c;return void 0===c||n>=e||n<0||d&&t-u>=o}function b(){var t=m();if(v(t))return w(t);l=setTimeout(b,function(t){var n=e-(t-c);return d?f(n,o-(t-u)):n}(t))}function w(t){return l=void 0,y&&a?x(t):(a=r=void 0,s)}function A(){var t=m(),n=v(t);if(a=arguments,r=this,c=t,n){if(void 0===l)return function(t){return u=t,l=setTimeout(b,e),h?x(t):s}(c);if(d)return l=setTimeout(b,e),x(c)}return void 0===l&&(l=setTimeout(b,e)),s}return e=_(e)||0,g(n)&&(h=!!n.leading,o=(d="maxWait"in n)?p(_(n.maxWait)||0,e):o,y="trailing"in n?!!n.trailing:y),A.cancel=function(){void 0!==l&&clearTimeout(l),u=0,a=c=r=l=void 0},A.flush=function(){return void 0===l?s:w(m())},A}(t,e,{leading:a,maxWait:e,trailing:r})}},694:(t,e,n)=>{"use strict";var i=n(925);function a(){}function r(){}r.resetWarningCache=a,t.exports=function(){function t(t,e,n,a,r,o){if(o!==i){var s=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw s.name="Invariant Violation",s}}function e(){return t}t.isRequired=t;var n={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,elementType:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:r,resetWarningCache:a};return n.PropTypes=n,n}},556:(t,e,n)=>{t.exports=n(694)()},925:t=>{"use strict";t.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"}},i={};function a(t){var n=i[t];if(void 0!==n)return n.exports;var r=i[t]={exports:{}};return e[t](r,r.exports,a),r.exports}a.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return a.d(e,{a:e}),e},a.d=(t,e)=>{for(var n in e)a.o(e,n)&&!a.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},a.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),a.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),a.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var r={};(()=>{"use strict";a.r(r),a.d(r,{LazyLoadComponent:()=>Q,LazyLoadImage:()=>ht,trackWindowScroll:()=>O});const t=n(6540);var e=a.n(t),i=a(556);function o(){return"undefined"!=typeof window&&"IntersectionObserver"in window&&"isIntersecting"in window.IntersectionObserverEntry.prototype}function s(t){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s(t)}function l(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function c(t,e,n){return(e=u(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function u(t){var e=function(t,e){if("object"!=s(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,"string");if("object"!=s(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==s(e)?e:e+""}function h(t,e,n){return e=p(e),function(t,e){if(e&&("object"==s(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,d()?Reflect.construct(e,n||[],p(t).constructor):e.apply(t,n))}function d(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(d=function(){return!!t})()}function p(t){return p=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},p(t)}function f(t,e){return f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},f(t,e)}var m=function(t){t.forEach((function(t){t.isIntersecting&&t.target.onVisible()}))},g={},_=function(t){function n(t){var e;if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),(e=h(this,n,[t])).supportsObserver=!t.scrollPosition&&t.useIntersectionObserver&&o(),e.supportsObserver){var i=t.threshold;e.observer=function(t){return g[t]=g[t]||new IntersectionObserver(m,{rootMargin:t+"px"}),g[t]}(i)}return e}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&f(t,e)}(n,t),i=n,a=[{key:"componentDidMount",value:function(){this.placeholder&&this.observer&&(this.placeholder.onVisible=this.props.onVisible,this.observer.observe(this.placeholder)),this.supportsObserver||this.updateVisibility()}},{key:"componentWillUnmount",value:function(){this.observer&&this.placeholder&&this.observer.unobserve(this.placeholder)}},{key:"componentDidUpdate",value:function(){this.supportsObserver||this.updateVisibility()}},{key:"getPlaceholderBoundingBox",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props.scrollPosition,e=this.placeholder.getBoundingClientRect(),n=this.placeholder.style,i=parseInt(n.getPropertyValue("margin-left"),10)||0,a=parseInt(n.getPropertyValue("margin-top"),10)||0;return{bottom:t.y+e.bottom+a,left:t.x+e.left+i,right:t.x+e.right+i,top:t.y+e.top+a}}},{key:"isPlaceholderInViewport",value:function(){if("undefined"==typeof window||!this.placeholder)return!1;var t=this.props,e=t.scrollPosition,n=t.threshold,i=this.getPlaceholderBoundingBox(e),a=e.y+window.innerHeight,r=e.x,o=e.x+window.innerWidth,s=e.y;return Boolean(s-n<=i.bottom&&a+n>=i.top&&r-n<=i.right&&o+n>=i.left)}},{key:"updateVisibility",value:function(){this.isPlaceholderInViewport()&&this.props.onVisible()}},{key:"render",value:function(){var t=this,n=this.props,i=n.className,a=n.height,r=n.placeholder,o=n.style,s=n.width;if(r&&"function"!=typeof r.type)return e().cloneElement(r,{ref:function(e){return t.placeholder=e}});var u=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?l(Object(n),!0).forEach((function(e){c(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({display:"inline-block"},o);return void 0!==s&&(u.width=s),void 0!==a&&(u.height=a),e().createElement("span",{className:i,ref:function(e){return t.placeholder=e},style:u},r)}}],a&&function(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,u(i.key),i)}}(i.prototype,a),Object.defineProperty(i,"prototype",{writable:!1}),i;var i,a}(e().Component);_.propTypes={onVisible:i.PropTypes.func.isRequired,className:i.PropTypes.string,height:i.PropTypes.oneOfType([i.PropTypes.number,i.PropTypes.string]),placeholder:i.PropTypes.element,threshold:i.PropTypes.number,useIntersectionObserver:i.PropTypes.bool,scrollPosition:i.PropTypes.shape({x:i.PropTypes.number.isRequired,y:i.PropTypes.number.isRequired}),width:i.PropTypes.oneOfType([i.PropTypes.number,i.PropTypes.string])},_.defaultProps={className:"",placeholder:null,threshold:100,useIntersectionObserver:!0};const y=_;var x=a(181),v=a.n(x),b=a(858),w=a.n(b),A=function(t){var e=getComputedStyle(t,null);return e.getPropertyValue("overflow")+e.getPropertyValue("overflow-y")+e.getPropertyValue("overflow-x")};const C=function(t){if(!(t instanceof HTMLElement))return window;for(var e=t;e&&e instanceof HTMLElement;){if(/(scroll|auto)/.test(A(e)))return e;e=e.parentNode}return window};function E(t){return E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},E(t)}var T=["delayMethod","delayTime"];function S(){return S=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)({}).hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},S.apply(null,arguments)}function M(t){var e=function(t,e){if("object"!=E(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,"string");if("object"!=E(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==E(e)?e:e+""}function k(t,e,n){return e=z(e),I(t,P()?Reflect.construct(e,n||[],z(t).constructor):e.apply(t,n))}function I(t,e){if(e&&("object"==E(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function P(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(P=function(){return!!t})()}function z(t){return z=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},z(t)}function D(t,e){return D=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},D(t,e)}var L=function(){return"undefined"==typeof window?0:window.scrollX||window.pageXOffset},B=function(){return"undefined"==typeof window?0:window.scrollY||window.pageYOffset};const O=function(t){var n=function(n){function i(t){var n;if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(n=k(this,i,[t])).useIntersectionObserver=t.useIntersectionObserver&&o(),n.useIntersectionObserver)return I(n);var a=n.onChangeScroll.bind(n);return"debounce"===t.delayMethod?n.delayedScroll=v()(a,t.delayTime):"throttle"===t.delayMethod&&(n.delayedScroll=w()(a,t.delayTime)),n.state={scrollPosition:{x:L(),y:B()}},n.baseComponentRef=e().createRef(),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&D(t,e)}(i,n),a=i,r=[{key:"componentDidMount",value:function(){this.addListeners()}},{key:"componentWillUnmount",value:function(){this.removeListeners()}},{key:"componentDidUpdate",value:function(){"undefined"==typeof window||this.useIntersectionObserver||C(this.baseComponentRef.current)!==this.scrollElement&&(this.removeListeners(),this.addListeners())}},{key:"addListeners",value:function(){"undefined"==typeof window||this.useIntersectionObserver||(this.scrollElement=C(this.baseComponentRef.current),this.scrollElement.addEventListener("scroll",this.delayedScroll,{passive:!0}),window.addEventListener("resize",this.delayedScroll,{passive:!0}),this.scrollElement!==window&&window.addEventListener("scroll",this.delayedScroll,{passive:!0}))}},{key:"removeListeners",value:function(){"undefined"==typeof window||this.useIntersectionObserver||(this.scrollElement.removeEventListener("scroll",this.delayedScroll),window.removeEventListener("resize",this.delayedScroll),this.scrollElement!==window&&window.removeEventListener("scroll",this.delayedScroll))}},{key:"onChangeScroll",value:function(){this.useIntersectionObserver||this.setState({scrollPosition:{x:L(),y:B()}})}},{key:"render",value:function(){var n=this.props,i=(n.delayMethod,n.delayTime,function(t,e){if(null==t)return{};var n,i,a=function(t,e){if(null==t)return{};var n={};for(var i in t)if({}.hasOwnProperty.call(t,i)){if(e.indexOf(i)>=0)continue;n[i]=t[i]}return n}(t,e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);for(i=0;i<r.length;i++)n=r[i],e.indexOf(n)>=0||{}.propertyIsEnumerable.call(t,n)&&(a[n]=t[n])}return a}(n,T)),a=this.useIntersectionObserver?null:this.state.scrollPosition;return e().createElement(t,S({forwardRef:this.baseComponentRef,scrollPosition:a},i))}}],r&&function(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,M(i.key),i)}}(a.prototype,r),Object.defineProperty(a,"prototype",{writable:!1}),a;var a,r}(e().Component);return n.propTypes={delayMethod:i.PropTypes.oneOf(["debounce","throttle"]),delayTime:i.PropTypes.number,useIntersectionObserver:i.PropTypes.bool},n.defaultProps={delayMethod:"throttle",delayTime:300,useIntersectionObserver:!0},n};function R(t){return R="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},R(t)}function F(t){var e=function(t,e){if("object"!=R(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,"string");if("object"!=R(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==R(e)?e:e+""}function N(t,e,n){return e=V(e),function(t,e){if(e&&("object"==R(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,j()?Reflect.construct(e,n||[],V(t).constructor):e.apply(t,n))}function j(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(j=function(){return!!t})()}function V(t){return V=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},V(t)}function U(t,e){return U=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},U(t,e)}var G=function(t){function n(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),N(this,n,[t])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&U(t,e)}(n,t),i=n,(a=[{key:"render",value:function(){return e().createElement(y,this.props)}}])&&function(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,F(i.key),i)}}(i.prototype,a),Object.defineProperty(i,"prototype",{writable:!1}),i;var i,a}(e().Component);const q=O(G);function $(t){return $="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$(t)}function W(t){var e=function(t,e){if("object"!=$(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,"string");if("object"!=$(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==$(e)?e:e+""}function H(t,e,n){return e=Y(e),function(t,e){if(e&&("object"==$(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Z()?Reflect.construct(e,n||[],Y(t).constructor):e.apply(t,n))}function Z(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Z=function(){return!!t})()}function Y(t){return Y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Y(t)}function X(t,e){return X=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},X(t,e)}var K=function(t){function n(t){var e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),e=H(this,n,[t]);var i=t.afterLoad,a=t.beforeLoad,r=t.scrollPosition,o=t.visibleByDefault;return e.state={visible:o},o&&(a(),i()),e.onVisible=e.onVisible.bind(e),e.isScrollTracked=Boolean(r&&Number.isFinite(r.x)&&r.x>=0&&Number.isFinite(r.y)&&r.y>=0),e}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&X(t,e)}(n,t),i=n,(a=[{key:"componentDidUpdate",value:function(t,e){e.visible!==this.state.visible&&this.props.afterLoad()}},{key:"onVisible",value:function(){this.props.beforeLoad(),this.setState({visible:!0})}},{key:"render",value:function(){if(this.state.visible)return this.props.children;var t=this.props,n=t.className,i=t.delayMethod,a=t.delayTime,r=t.height,s=t.placeholder,l=t.scrollPosition,c=t.style,u=t.threshold,h=t.useIntersectionObserver,d=t.width;return this.isScrollTracked||h&&o()?e().createElement(y,{className:n,height:r,onVisible:this.onVisible,placeholder:s,scrollPosition:l,style:c,threshold:u,useIntersectionObserver:h,width:d}):e().createElement(q,{className:n,delayMethod:i,delayTime:a,height:r,onVisible:this.onVisible,placeholder:s,style:c,threshold:u,width:d})}}])&&function(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,W(i.key),i)}}(i.prototype,a),Object.defineProperty(i,"prototype",{writable:!1}),i;var i,a}(e().Component);K.propTypes={afterLoad:i.PropTypes.func,beforeLoad:i.PropTypes.func,useIntersectionObserver:i.PropTypes.bool,visibleByDefault:i.PropTypes.bool},K.defaultProps={afterLoad:function(){return{}},beforeLoad:function(){return{}},useIntersectionObserver:!0,visibleByDefault:!1};const Q=K;function J(t){return J="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},J(t)}var tt=["afterLoad","beforeLoad","delayMethod","delayTime","effect","placeholder","placeholderSrc","scrollPosition","threshold","useIntersectionObserver","visibleByDefault","wrapperClassName","wrapperProps"];function et(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function nt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?et(Object(n),!0).forEach((function(e){it(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):et(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function it(t,e,n){return(e=rt(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function at(){return at=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)({}).hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},at.apply(null,arguments)}function rt(t){var e=function(t,e){if("object"!=J(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,"string");if("object"!=J(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==J(e)?e:e+""}function ot(t,e,n){return e=lt(e),function(t,e){if(e&&("object"==J(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,st()?Reflect.construct(e,n||[],lt(t).constructor):e.apply(t,n))}function st(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(st=function(){return!!t})()}function lt(t){return lt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},lt(t)}function ct(t,e){return ct=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},ct(t,e)}var ut=function(t){function n(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),(e=ot(this,n,[t])).state={loaded:!1},e}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ct(t,e)}(n,t),i=n,a=[{key:"onImageLoad",value:function(){var t=this;return this.state.loaded?null:function(e){t.props.onLoad(e),t.props.afterLoad(),t.setState({loaded:!0})}}},{key:"getImg",value:function(){var t=this.props,n=(t.afterLoad,t.beforeLoad,t.delayMethod,t.delayTime,t.effect,t.placeholder,t.placeholderSrc,t.scrollPosition,t.threshold,t.useIntersectionObserver,t.visibleByDefault,t.wrapperClassName,t.wrapperProps,function(t,e){if(null==t)return{};var n,i,a=function(t,e){if(null==t)return{};var n={};for(var i in t)if({}.hasOwnProperty.call(t,i)){if(e.indexOf(i)>=0)continue;n[i]=t[i]}return n}(t,e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);for(i=0;i<r.length;i++)n=r[i],e.indexOf(n)>=0||{}.propertyIsEnumerable.call(t,n)&&(a[n]=t[n])}return a}(t,tt));return e().createElement("img",at({},n,{onLoad:this.onImageLoad()}))}},{key:"getLazyLoadImage",value:function(){var t=this.props,n=t.beforeLoad,i=t.className,a=t.delayMethod,r=t.delayTime,o=t.height,s=t.placeholder,l=t.scrollPosition,c=t.style,u=t.threshold,h=t.useIntersectionObserver,d=t.visibleByDefault,p=t.width;return e().createElement(Q,{beforeLoad:n,className:i,delayMethod:a,delayTime:r,height:o,placeholder:s,scrollPosition:l,style:c,threshold:u,useIntersectionObserver:h,visibleByDefault:d,width:p},this.getImg())}},{key:"getWrappedLazyLoadImage",value:function(t){var n=this.props,i=n.effect,a=n.height,r=n.placeholderSrc,o=n.width,s=n.wrapperClassName,l=n.wrapperProps,c=this.state.loaded,u=c?" lazy-load-image-loaded":"",h=c||!r?{}:{backgroundImage:"url(".concat(r,")"),backgroundSize:"100% 100%"};return e().createElement("span",at({className:s+" lazy-load-image-background "+i+u,style:nt(nt({},h),{},{color:"transparent",display:"inline-block",height:a,width:o})},l),t)}},{key:"render",value:function(){var t=this.props,e=t.effect,n=t.placeholderSrc,i=t.visibleByDefault,a=t.wrapperClassName,r=t.wrapperProps,o=this.getLazyLoadImage();return(e||n)&&!i||a||r?this.getWrappedLazyLoadImage(o):o}}],a&&function(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,rt(i.key),i)}}(i.prototype,a),Object.defineProperty(i,"prototype",{writable:!1}),i;var i,a}(e().Component);ut.propTypes={onLoad:i.PropTypes.func,afterLoad:i.PropTypes.func,beforeLoad:i.PropTypes.func,delayMethod:i.PropTypes.string,delayTime:i.PropTypes.number,effect:i.PropTypes.string,placeholderSrc:i.PropTypes.string,threshold:i.PropTypes.number,useIntersectionObserver:i.PropTypes.bool,visibleByDefault:i.PropTypes.bool,wrapperClassName:i.PropTypes.string,wrapperProps:i.PropTypes.object},ut.defaultProps={onLoad:function(){},afterLoad:function(){return{}},beforeLoad:function(){return{}},delayMethod:"throttle",delayTime:300,effect:"",placeholderSrc:null,threshold:100,useIntersectionObserver:!0,visibleByDefault:!1,wrapperClassName:""};const ht=ut})(),t.exports=r})()},5287:(t,e)=>{"use strict";var n=Symbol.for("react.element"),i=Symbol.for("react.portal"),a=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),p=Symbol.iterator,f={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},m=Object.assign,g={};function _(t,e,n){this.props=t,this.context=e,this.refs=g,this.updater=n||f}function y(){}function x(t,e,n){this.props=t,this.context=e,this.refs=g,this.updater=n||f}_.prototype.isReactComponent={},_.prototype.setState=function(t,e){if("object"!=typeof t&&"function"!=typeof t&&null!=t)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")},_.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")},y.prototype=_.prototype;var v=x.prototype=new y;v.constructor=x,m(v,_.prototype),v.isPureReactComponent=!0;var b=Array.isArray,w=Object.prototype.hasOwnProperty,A={current:null},C={key:!0,ref:!0,__self:!0,__source:!0};function E(t,e,i){var a,r={},o=null,s=null;if(null!=e)for(a in void 0!==e.ref&&(s=e.ref),void 0!==e.key&&(o=""+e.key),e)w.call(e,a)&&!C.hasOwnProperty(a)&&(r[a]=e[a]);var l=arguments.length-2;if(1===l)r.children=i;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];r.children=c}if(t&&t.defaultProps)for(a in l=t.defaultProps)void 0===r[a]&&(r[a]=l[a]);return{$$typeof:n,type:t,key:o,ref:s,props:r,_owner:A.current}}function T(t){return"object"==typeof t&&null!==t&&t.$$typeof===n}var S=/\/+/g;function M(t,e){return"object"==typeof t&&null!==t&&null!=t.key?function(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,(function(t){return e[t]}))}(""+t.key):e.toString(36)}function k(t,e,a,r,o){var s=typeof t;"undefined"!==s&&"boolean"!==s||(t=null);var l=!1;if(null===t)l=!0;else switch(s){case"string":case"number":l=!0;break;case"object":switch(t.$$typeof){case n:case i:l=!0}}if(l)return o=o(l=t),t=""===r?"."+M(l,0):r,b(o)?(a="",null!=t&&(a=t.replace(S,"$&/")+"/"),k(o,e,a,"",(function(t){return t}))):null!=o&&(T(o)&&(o=function(t,e){return{$$typeof:n,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}(o,a+(!o.key||l&&l.key===o.key?"":(""+o.key).replace(S,"$&/")+"/")+t)),e.push(o)),1;if(l=0,r=""===r?".":r+":",b(t))for(var c=0;c<t.length;c++){var u=r+M(s=t[c],c);l+=k(s,e,a,u,o)}else if(u=function(t){return null===t||"object"!=typeof t?null:"function"==typeof(t=p&&t[p]||t["@@iterator"])?t:null}(t),"function"==typeof u)for(t=u.call(t),c=0;!(s=t.next()).done;)l+=k(s=s.value,e,a,u=r+M(s,c++),o);else if("object"===s)throw e=String(t),Error("Objects are not valid as a React child (found: "+("[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return l}function I(t,e,n){if(null==t)return t;var i=[],a=0;return k(t,i,"","",(function(t){return e.call(n,t,a++)})),i}function P(t){if(-1===t._status){var e=t._result;(e=e()).then((function(e){0!==t._status&&-1!==t._status||(t._status=1,t._result=e)}),(function(e){0!==t._status&&-1!==t._status||(t._status=2,t._result=e)})),-1===t._status&&(t._status=0,t._result=e)}if(1===t._status)return t._result.default;throw t._result}var z={current:null},D={transition:null},L={ReactCurrentDispatcher:z,ReactCurrentBatchConfig:D,ReactCurrentOwner:A};function B(){throw Error("act(...) is not supported in production builds of React.")}e.Children={map:I,forEach:function(t,e,n){I(t,(function(){e.apply(this,arguments)}),n)},count:function(t){var e=0;return I(t,(function(){e++})),e},toArray:function(t){return I(t,(function(t){return t}))||[]},only:function(t){if(!T(t))throw Error("React.Children.only expected to receive a single React element child.");return t}},e.Component=_,e.Fragment=a,e.Profiler=o,e.PureComponent=x,e.StrictMode=r,e.Suspense=u,e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=L,e.act=B,e.cloneElement=function(t,e,i){if(null==t)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var a=m({},t.props),r=t.key,o=t.ref,s=t._owner;if(null!=e){if(void 0!==e.ref&&(o=e.ref,s=A.current),void 0!==e.key&&(r=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(c in e)w.call(e,c)&&!C.hasOwnProperty(c)&&(a[c]=void 0===e[c]&&void 0!==l?l[c]:e[c])}var c=arguments.length-2;if(1===c)a.children=i;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];a.children=l}return{$$typeof:n,type:t.type,key:r,ref:o,props:a,_owner:s}},e.createContext=function(t){return(t={$$typeof:l,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:s,_context:t},t.Consumer=t},e.createElement=E,e.createFactory=function(t){var e=E.bind(null,t);return e.type=t,e},e.createRef=function(){return{current:null}},e.forwardRef=function(t){return{$$typeof:c,render:t}},e.isValidElement=T,e.lazy=function(t){return{$$typeof:d,_payload:{_status:-1,_result:t},_init:P}},e.memo=function(t,e){return{$$typeof:h,type:t,compare:void 0===e?null:e}},e.startTransition=function(t){var e=D.transition;D.transition={};try{t()}finally{D.transition=e}},e.unstable_act=B,e.useCallback=function(t,e){return z.current.useCallback(t,e)},e.useContext=function(t){return z.current.useContext(t)},e.useDebugValue=function(){},e.useDeferredValue=function(t){return z.current.useDeferredValue(t)},e.useEffect=function(t,e){return z.current.useEffect(t,e)},e.useId=function(){return z.current.useId()},e.useImperativeHandle=function(t,e,n){return z.current.useImperativeHandle(t,e,n)},e.useInsertionEffect=function(t,e){return z.current.useInsertionEffect(t,e)},e.useLayoutEffect=function(t,e){return z.current.useLayoutEffect(t,e)},e.useMemo=function(t,e){return z.current.useMemo(t,e)},e.useReducer=function(t,e,n){return z.current.useReducer(t,e,n)},e.useRef=function(t){return z.current.useRef(t)},e.useState=function(t){return z.current.useState(t)},e.useSyncExternalStore=function(t,e,n){return z.current.useSyncExternalStore(t,e,n)},e.useTransition=function(){return z.current.useTransition()},e.version="18.3.1"},6540:(t,e,n)=>{"use strict";t.exports=n(5287)},7463:(t,e)=>{"use strict";function n(t,e){var n=t.length;t.push(e);t:for(;0<n;){var i=n-1>>>1,a=t[i];if(!(0<r(a,e)))break t;t[i]=e,t[n]=a,n=i}}function i(t){return 0===t.length?null:t[0]}function a(t){if(0===t.length)return null;var e=t[0],n=t.pop();if(n!==e){t[0]=n;t:for(var i=0,a=t.length,o=a>>>1;i<o;){var s=2*(i+1)-1,l=t[s],c=s+1,u=t[c];if(0>r(l,n))c<a&&0>r(u,l)?(t[i]=u,t[c]=n,i=c):(t[i]=l,t[s]=n,i=s);else{if(!(c<a&&0>r(u,n)))break t;t[i]=u,t[c]=n,i=c}}}return e}function r(t,e){var n=t.sortIndex-e.sortIndex;return 0!==n?n:t.id-e.id}if("object"==typeof performance&&"function"==typeof performance.now){var o=performance;e.unstable_now=function(){return o.now()}}else{var s=Date,l=s.now();e.unstable_now=function(){return s.now()-l}}var c=[],u=[],h=1,d=null,p=3,f=!1,m=!1,g=!1,_="function"==typeof setTimeout?setTimeout:null,y="function"==typeof clearTimeout?clearTimeout:null,x="undefined"!=typeof setImmediate?setImmediate:null;function v(t){for(var e=i(u);null!==e;){if(null===e.callback)a(u);else{if(!(e.startTime<=t))break;a(u),e.sortIndex=e.expirationTime,n(c,e)}e=i(u)}}function b(t){if(g=!1,v(t),!m)if(null!==i(c))m=!0,D(w);else{var e=i(u);null!==e&&L(b,e.startTime-t)}}function w(t,n){m=!1,g&&(g=!1,y(T),T=-1),f=!0;var r=p;try{for(v(n),d=i(c);null!==d&&(!(d.expirationTime>n)||t&&!k());){var o=d.callback;if("function"==typeof o){d.callback=null,p=d.priorityLevel;var s=o(d.expirationTime<=n);n=e.unstable_now(),"function"==typeof s?d.callback=s:d===i(c)&&a(c),v(n)}else a(c);d=i(c)}if(null!==d)var l=!0;else{var h=i(u);null!==h&&L(b,h.startTime-n),l=!1}return l}finally{d=null,p=r,f=!1}}"undefined"!=typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var A,C=!1,E=null,T=-1,S=5,M=-1;function k(){return!(e.unstable_now()-M<S)}function I(){if(null!==E){var t=e.unstable_now();M=t;var n=!0;try{n=E(!0,t)}finally{n?A():(C=!1,E=null)}}else C=!1}if("function"==typeof x)A=function(){x(I)};else if("undefined"!=typeof MessageChannel){var P=new MessageChannel,z=P.port2;P.port1.onmessage=I,A=function(){z.postMessage(null)}}else A=function(){_(I,0)};function D(t){E=t,C||(C=!0,A())}function L(t,n){T=_((function(){t(e.unstable_now())}),n)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(t){t.callback=null},e.unstable_continueExecution=function(){m||f||(m=!0,D(w))},e.unstable_forceFrameRate=function(t){0>t||125<t?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):S=0<t?Math.floor(1e3/t):5},e.unstable_getCurrentPriorityLevel=function(){return p},e.unstable_getFirstCallbackNode=function(){return i(c)},e.unstable_next=function(t){switch(p){case 1:case 2:case 3:var e=3;break;default:e=p}var n=p;p=e;try{return t()}finally{p=n}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(t,e){switch(t){case 1:case 2:case 3:case 4:case 5:break;default:t=3}var n=p;p=t;try{return e()}finally{p=n}},e.unstable_scheduleCallback=function(t,a,r){var o=e.unstable_now();switch(r="object"==typeof r&&null!==r&&"number"==typeof(r=r.delay)&&0<r?o+r:o,t){case 1:var s=-1;break;case 2:s=250;break;case 5:s=1073741823;break;case 4:s=1e4;break;default:s=5e3}return t={id:h++,callback:a,priorityLevel:t,startTime:r,expirationTime:s=r+s,sortIndex:-1},r>o?(t.sortIndex=r,n(u,t),null===i(c)&&t===i(u)&&(g?(y(T),T=-1):g=!0,L(b,r-o))):(t.sortIndex=s,n(c,t),m||f||(m=!0,D(w))),t},e.unstable_shouldYield=k,e.unstable_wrapCallback=function(t){var e=p;return function(){var n=p;p=e;try{return t.apply(this,arguments)}finally{p=n}}}},9982:(t,e,n)=>{"use strict";t.exports=n(7463)},2833:t=>{t.exports=function(t,e,n,i){var a=n?n.call(i,t,e):void 0;if(void 0!==a)return!!a;if(t===e)return!0;if("object"!=typeof t||!t||"object"!=typeof e||!e)return!1;var r=Object.keys(t),o=Object.keys(e);if(r.length!==o.length)return!1;for(var s=Object.prototype.hasOwnProperty.bind(e),l=0;l<r.length;l++){var c=r[l];if(!s(c))return!1;var u=t[c],h=e[c];if(!1===(a=n?n.call(i,u,h,c):void 0)||void 0===a&&u!==h)return!1}return!0}},5072:t=>{"use strict";var e=[];function n(t){for(var n=-1,i=0;i<e.length;i++)if(e[i].identifier===t){n=i;break}return n}function i(t,i){for(var r={},o=[],s=0;s<t.length;s++){var l=t[s],c=i.base?l[0]+i.base:l[0],u=r[c]||0,h="".concat(c," ").concat(u);r[c]=u+1;var d=n(h),p={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==d)e[d].references++,e[d].updater(p);else{var f=a(p,i);i.byIndex=s,e.splice(s,0,{identifier:h,updater:f,references:1})}o.push(h)}return o}function a(t,e){var n=e.domAPI(e);return n.update(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap&&e.supports===t.supports&&e.layer===t.layer)return;n.update(t=e)}else n.remove()}}t.exports=function(t,a){var r=i(t=t||[],a=a||{});return function(t){t=t||[];for(var o=0;o<r.length;o++){var s=n(r[o]);e[s].references--}for(var l=i(t,a),c=0;c<r.length;c++){var u=n(r[c]);0===e[u].references&&(e[u].updater(),e.splice(u,1))}r=l}}},7659:t=>{"use strict";var e={};t.exports=function(t,n){var i=function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(t){n=null}e[t]=n}return e[t]}(t);if(!i)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");i.appendChild(n)}},540:t=>{"use strict";t.exports=function(t){var e=document.createElement("style");return t.setAttributes(e,t.attributes),t.insert(e,t.options),e}},5056:(t,e,n)=>{"use strict";t.exports=function(t){var e=n.nc;e&&t.setAttribute("nonce",e)}},7825:t=>{"use strict";t.exports=function(t){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var e=t.insertStyleElement(t);return{update:function(n){!function(t,e,n){var i="";n.supports&&(i+="@supports (".concat(n.supports,") {")),n.media&&(i+="@media ".concat(n.media," {"));var a=void 0!==n.layer;a&&(i+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),i+=n.css,a&&(i+="}"),n.media&&(i+="}"),n.supports&&(i+="}");var r=n.sourceMap;r&&"undefined"!=typeof btoa&&(i+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(r))))," */")),e.styleTagTransform(i,t,e.options)}(e,t,n)},remove:function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(e)}}}},1113:t=>{"use strict";t.exports=function(t,e){if(e.styleSheet)e.styleSheet.cssText=t;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(t))}}},9098:t=>{"use strict";t.exports="data:image/svg+xml;charset=utf-8,%3Csvg viewBox=%270 0 20 20%27 xmlns=%27http://www.w3.org/2000/svg%27 fill-rule=%27evenodd%27 fill=%27%23fff%27%3E%3Cpath d=%27M4 10a6 6 0 1 0 12 0 6 6 0 1 0-12 0m5-3a1 1 0 1 0 2 0 1 1 0 1 0-2 0m0 3a1 1 0 1 1 2 0v3a1 1 0 1 1-2 0%27/%3E%3C/svg%3E"},8548:t=>{"use strict";t.exports="data:image/svg+xml;charset=utf-8,%3Csvg viewBox=%270 0 20 20%27 xmlns=%27http://www.w3.org/2000/svg%27 fill-rule=%27evenodd%27%3E%3Cpath d=%27M4 10a6 6 0 1 0 12 0 6 6 0 1 0-12 0m5-3a1 1 0 1 0 2 0 1 1 0 1 0-2 0m0 3a1 1 0 1 1 2 0v3a1 1 0 1 1-2 0%27/%3E%3C/svg%3E"},6008:t=>{"use strict";t.exports="data:image/svg+xml;charset=utf-8,%3Csvg viewBox=%270 0 20 20%27 xmlns=%27http://www.w3.org/2000/svg%27 fill=%27%23000%27%3E%3Cpath d=%27M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7z%27/%3E%3Ccircle id=%27dot%27 cx=%2710%27 cy=%2710%27 r=%272%27/%3E%3Cpath id=%27stroke%27 d=%27M14 5l1 1-9 9-1-1 9-9z%27 display=%27none%27/%3E%3C/svg%3E"},1991:t=>{"use strict";t.exports="data:image/svg+xml;charset=utf-8,%3Csvg viewBox=%270 0 20 20%27 xmlns=%27http://www.w3.org/2000/svg%27 fill=%27%23333%27%3E%3Cpath d=%27M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7z%27/%3E%3Ccircle id=%27dot%27 cx=%2710%27 cy=%2710%27 r=%272%27/%3E%3Cpath id=%27stroke%27 d=%27M14 5l1 1-9 9-1-1 9-9z%27 display=%27none%27/%3E%3C/svg%3E"},2990:t=>{"use strict";t.exports="data:image/svg+xml;charset=utf-8,%3Csvg viewBox=%270 0 20 20%27 xmlns=%27http://www.w3.org/2000/svg%27 fill=%27%2333b5e5%27%3E%3Cpath d=%27M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7z%27/%3E%3Ccircle id=%27dot%27 cx=%2710%27 cy=%2710%27 r=%272%27 display=%27none%27/%3E%3Cpath id=%27stroke%27 d=%27M14 5l1 1-9 9-1-1 9-9z%27 display=%27none%27/%3E%3C/svg%3E"},311:t=>{"use strict";t.exports="data:image/svg+xml;charset=utf-8,%3Csvg viewBox=%270 0 20 20%27 xmlns=%27http://www.w3.org/2000/svg%27 fill=%27%2333b5e5%27%3E%3Cpath d=%27M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7z%27/%3E%3Ccircle id=%27dot%27 cx=%2710%27 cy=%2710%27 r=%272%27/%3E%3Cpath id=%27stroke%27 d=%27M14 5l1 1-9 9-1-1 9-9z%27 display=%27none%27/%3E%3C/svg%3E"},5721:t=>{"use strict";t.exports="data:image/svg+xml;charset=utf-8,%3Csvg viewBox=%270 0 20 20%27 xmlns=%27http://www.w3.org/2000/svg%27 fill=%27%23666%27%3E%3Cpath d=%27M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7z%27/%3E%3Ccircle id=%27dot%27 cx=%2710%27 cy=%2710%27 r=%272%27/%3E%3Cpath id=%27stroke%27 d=%27M14 5l1 1-9 9-1-1 9-9z%27 fill=%27%23f00%27/%3E%3C/svg%3E"},1340:t=>{"use strict";t.exports="data:image/svg+xml;charset=utf-8,%3Csvg viewBox=%270 0 20 20%27 xmlns=%27http://www.w3.org/2000/svg%27 fill=%27%23999%27%3E%3Cpath d=%27M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7z%27/%3E%3Ccircle id=%27dot%27 cx=%2710%27 cy=%2710%27 r=%272%27/%3E%3Cpath id=%27stroke%27 d=%27M14 5l1 1-9 9-1-1 9-9z%27 fill=%27%23f00%27/%3E%3C/svg%3E"},3764:t=>{"use strict";t.exports="data:image/svg+xml;charset=utf-8,%3Csvg viewBox=%270 0 20 20%27 xmlns=%27http://www.w3.org/2000/svg%27 fill=%27%23aaa%27%3E%3Cpath d=%27M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7z%27/%3E%3Ccircle id=%27dot%27 cx=%2710%27 cy=%2710%27 r=%272%27/%3E%3Cpath id=%27stroke%27 d=%27M14 5l1 1-9 9-1-1 9-9z%27 fill=%27%23f00%27/%3E%3C/svg%3E"},3200:t=>{"use strict";t.exports="data:image/svg+xml;charset=utf-8,%3Csvg viewBox=%270 0 20 20%27 xmlns=%27http://www.w3.org/2000/svg%27 fill=%27%23e54e33%27%3E%3Cpath d=%27M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7z%27/%3E%3Ccircle id=%27dot%27 cx=%2710%27 cy=%2710%27 r=%272%27 display=%27none%27/%3E%3Cpath id=%27stroke%27 d=%27M14 5l1 1-9 9-1-1 9-9z%27 display=%27none%27/%3E%3C/svg%3E"},20:t=>{"use strict";t.exports="data:image/svg+xml;charset=utf-8,%3Csvg viewBox=%270 0 20 20%27 xmlns=%27http://www.w3.org/2000/svg%27 fill=%27%23e58978%27%3E%3Cpath d=%27M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7z%27/%3E%3Ccircle id=%27dot%27 cx=%2710%27 cy=%2710%27 r=%272%27/%3E%3Cpath id=%27stroke%27 d=%27M14 5l1 1-9 9-1-1 9-9z%27 display=%27none%27/%3E%3C/svg%3E"},5454:t=>{"use strict";t.exports="data:image/svg+xml;charset=utf-8,%3Csvg viewBox=%270 0 20 20%27 xmlns=%27http://www.w3.org/2000/svg%27 fill=%27%23fff%27%3E%3Cpath d=%27M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7z%27/%3E%3Ccircle id=%27dot%27 cx=%2710%27 cy=%2710%27 r=%272%27/%3E%3Cpath id=%27stroke%27 d=%27M14 5l1 1-9 9-1-1 9-9z%27 display=%27none%27/%3E%3C/svg%3E"},3825:t=>{"use strict";t.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 fill=%27%23000%27 viewBox=%270 0 29 29%27%3E%3Cpath d=%27M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z%27/%3E%3C/svg%3E"},5565:t=>{"use strict";t.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 fill=%27%23000%27 viewBox=%270 0 29 29%27%3E%3Cpath d=%27M10.5 14l4-8 4 8h-8z%27/%3E%3Cpath id=%27south%27 d=%27M10.5 16l4 8 4-8h-8z%27 fill=%27%23ccc%27/%3E%3C/svg%3E"},6686:t=>{"use strict";t.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 fill=%27%23000%27 viewBox=%270 0 29 29%27%3E%3Cpath d=%27M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z%27/%3E%3C/svg%3E"},2556:t=>{"use strict";t.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 fill=%27%23000%27 viewBox=%270 0 29 29%27%3E%3Cpath d=%27M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z%27/%3E%3C/svg%3E"},2912:t=>{"use strict";t.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 fill=%27%23000%27 viewBox=%270 0 29 29%27%3E%3Cpath d=%27M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z%27/%3E%3C/svg%3E"},426:t=>{"use strict";t.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 fill=%27%23333%27 viewBox=%270 0 29 29%27%3E%3Cpath d=%27M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z%27/%3E%3C/svg%3E"},3750:t=>{"use strict";t.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 fill=%27%23333%27 viewBox=%270 0 29 29%27%3E%3Cpath d=%27M10.5 14l4-8 4 8h-8z%27/%3E%3Cpath id=%27south%27 d=%27M10.5 16l4 8 4-8h-8z%27 fill=%27%23ccc%27/%3E%3C/svg%3E"},3873:t=>{"use strict";t.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 fill=%27%23333%27 viewBox=%270 0 29 29%27%3E%3Cpath d=%27M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z%27/%3E%3C/svg%3E"},6827:t=>{"use strict";t.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 fill=%27%23333%27 viewBox=%270 0 29 29%27%3E%3Cpath d=%27M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z%27/%3E%3C/svg%3E"},6839:t=>{"use strict";t.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 fill=%27%23fff%27 viewBox=%270 0 29 29%27%3E%3Cpath d=%27M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z%27/%3E%3C/svg%3E"},577:t=>{"use strict";t.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 fill=%27%23fff%27 viewBox=%270 0 29 29%27%3E%3Cpath d=%27M10.5 14l4-8 4 8h-8z%27/%3E%3Cpath id=%27south%27 d=%27M10.5 16l4 8 4-8h-8z%27 fill=%27%23999%27/%3E%3C/svg%3E"},4972:t=>{"use strict";t.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 fill=%27%23fff%27 viewBox=%270 0 29 29%27%3E%3Cpath d=%27M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z%27/%3E%3C/svg%3E"},4262:t=>{"use strict";t.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 fill=%27%23fff%27 viewBox=%270 0 29 29%27%3E%3Cpath d=%27M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z%27/%3E%3C/svg%3E"},690:t=>{"use strict";t.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 fill=%27%23fff%27 viewBox=%270 0 29 29%27%3E%3Cpath d=%27M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z%27/%3E%3C/svg%3E"},7324:t=>{"use strict";t.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 29 29%27%3E%3Cpath d=%27M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z%27/%3E%3C/svg%3E"},7138:t=>{"use strict";t.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 xmlns:xlink=%27http://www.w3.org/1999/xlink%27 fill-rule=%27evenodd%27 viewBox=%270 0 88 23%27%3E%3Cdefs%3E%3Cpath id=%27logo%27 d=%27M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z%27/%3E%3Cpath id=%27text%27 d=%27M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z%27/%3E%3C/defs%3E%3Cmask id=%27clip%27%3E%3Crect x=%270%27 y=%270%27 width=%27100%25%27 height=%27100%25%27 fill=%27white%27/%3E%3Cuse xlink:href=%27%23logo%27/%3E%3Cuse xlink:href=%27%23text%27/%3E%3C/mask%3E%3Cg id=%27outline%27 opacity=%270.3%27 stroke=%27%23000%27 stroke-width=%273%27%3E%3Ccircle mask=%27url%28%23clip%29%27 cx=%2711.5%27 cy=%2711.5%27 r=%279.25%27/%3E%3Cuse xlink:href=%27%23text%27 mask=%27url%28%23clip%29%27/%3E%3C/g%3E%3Cg id=%27fill%27 opacity=%270.9%27 fill=%27%23fff%27%3E%3Cuse xlink:href=%27%23logo%27/%3E%3Cuse xlink:href=%27%23text%27/%3E%3C/g%3E%3C/svg%3E"},7256:t=>{"use strict";t.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 xmlns:xlink=%27http://www.w3.org/1999/xlink%27 fill-rule=%27evenodd%27 viewBox=%270 0 88 23%27%3E%3Cdefs%3E%3Cpath id=%27logo%27 d=%27M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z%27/%3E%3Cpath id=%27text%27 d=%27M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z%27/%3E%3C/defs%3E%3Cmask id=%27clip%27%3E%3Crect x=%270%27 y=%270%27 width=%27100%25%27 height=%27100%25%27 fill=%27white%27/%3E%3Cuse xlink:href=%27%23logo%27/%3E%3Cuse xlink:href=%27%23text%27/%3E%3C/mask%3E%3Cg id=%27outline%27 opacity=%271%27 stroke=%27%23000%27 stroke-width=%273%27%3E%3Ccircle mask=%27url%28%23clip%29%27 cx=%2711.5%27 cy=%2711.5%27 r=%279.25%27/%3E%3Cuse xlink:href=%27%23text%27 mask=%27url%28%23clip%29%27/%3E%3C/g%3E%3Cg id=%27fill%27 opacity=%271%27 fill=%27%23fff%27%3E%3Cuse xlink:href=%27%23logo%27/%3E%3Cuse xlink:href=%27%23text%27/%3E%3C/g%3E%3C/svg%3E"},7354:t=>{"use strict";t.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 xmlns:xlink=%27http://www.w3.org/1999/xlink%27 fill-rule=%27evenodd%27 viewBox=%270 0 88 23%27%3E%3Cdefs%3E%3Cpath id=%27logo%27 d=%27M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z%27/%3E%3Cpath id=%27text%27 d=%27M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z%27/%3E%3C/defs%3E%3Cmask id=%27clip%27%3E%3Crect x=%270%27 y=%270%27 width=%27100%25%27 height=%27100%25%27 fill=%27white%27/%3E%3Cuse xlink:href=%27%23logo%27/%3E%3Cuse xlink:href=%27%23text%27/%3E%3C/mask%3E%3Cg id=%27outline%27 opacity=%271%27 stroke=%27%23fff%27 stroke-width=%273%27 fill=%27%23fff%27%3E%3Ccircle mask=%27url%28%23clip%29%27 cx=%2711.5%27 cy=%2711.5%27 r=%279.25%27/%3E%3Cuse xlink:href=%27%23text%27 mask=%27url%28%23clip%29%27/%3E%3C/g%3E%3Cg id=%27fill%27 opacity=%271%27 fill=%27%23000%27%3E%3Cuse xlink:href=%27%23logo%27/%3E%3Cuse xlink:href=%27%23text%27/%3E%3C/g%3E%3C/svg%3E"}},i={};function a(t){var e=i[t];if(void 0!==e)return e.exports;var r=i[t]={id:t,loaded:!1,exports:{}};return n[t].call(r.exports,r,r.exports,a),r.loaded=!0,r.exports}a.m=n,a.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return a.d(e,{a:e}),e},e=Object.getPrototypeOf?t=>Object.getPrototypeOf(t):t=>t.__proto__,a.t=function(n,i){if(1&i&&(n=this(n)),8&i)return n;if("object"==typeof n&&n){if(4&i&&n.__esModule)return n;if(16&i&&"function"==typeof n.then)return n}var r=Object.create(null);a.r(r);var o={};t=t||[null,e({}),e([]),e(e)];for(var s=2&i&&n;"object"==typeof s&&!~t.indexOf(s);s=e(s))Object.getOwnPropertyNames(s).forEach((t=>o[t]=()=>n[t]));return o.default=()=>n,a.d(r,o),r},a.d=(t,e)=>{for(var n in e)a.o(e,n)&&!a.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},a.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),a.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),a.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.nmd=t=>(t.paths=[],t.children||(t.children=[]),t),(()=>{var t;a.g.importScripts&&(t=a.g.location+"");var e=a.g.document;if(!t&&e&&(e.currentScript&&(t=e.currentScript.src),!t)){var n=e.getElementsByTagName("script");if(n.length)for(var i=n.length-1;i>-1&&(!t||!/^http(s?):/.test(t));)t=n[i--].src}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),a.p=t})(),a.b=document.baseURI||self.location.href,a.nc=void 0,(()=>{"use strict";var t={};a.r(t),a.d(t,{hasBrowserEnv:()=>Da,hasStandardBrowserEnv:()=>La,hasStandardBrowserWebWorkerEnv:()=>Oa,origin:()=>Ra});var e,n=a(6540),i=a.t(n,2),r=a(5338),o=a(961),s=a.t(o,2);function l(){return l=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},l.apply(this,arguments)}!function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"}(e||(e={}));const c="popstate";function u(t,e){if(!1===t||null==t)throw new Error(e)}function h(t,e){if(!t){"undefined"!=typeof console&&console.warn(e);try{throw new Error(e)}catch(t){}}}function d(t,e){return{usr:t.state,key:t.key,idx:e}}function p(t,e,n,i){return void 0===n&&(n=null),l({pathname:"string"==typeof t?t:t.pathname,search:"",hash:""},"string"==typeof e?m(e):e,{state:n,key:e&&e.key||i||Math.random().toString(36).substr(2,8)})}function f(t){let{pathname:e="/",search:n="",hash:i=""}=t;return n&&"?"!==n&&(e+="?"===n.charAt(0)?n:"?"+n),i&&"#"!==i&&(e+="#"===i.charAt(0)?i:"#"+i),e}function m(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let i=t.indexOf("?");i>=0&&(e.search=t.substr(i),t=t.substr(0,i)),t&&(e.pathname=t)}return e}var g;function _(t,e,n){void 0===n&&(n="/");let i=P(("string"==typeof e?m(e):e).pathname||"/",n);if(null==i)return null;let a=y(t);!function(t){t.sort(((t,e)=>t.score!==e.score?e.score-t.score:function(t,e){return t.length===e.length&&t.slice(0,-1).every(((t,n)=>t===e[n]))?t[t.length-1]-e[e.length-1]:0}(t.routesMeta.map((t=>t.childrenIndex)),e.routesMeta.map((t=>t.childrenIndex)))))}(a);let r=null;for(let t=0;null==r&&t<a.length;++t){let e=I(i);r=M(a[t],e)}return r}function y(t,e,n,i){void 0===e&&(e=[]),void 0===n&&(n=[]),void 0===i&&(i="");let a=(t,a,r)=>{let o={relativePath:void 0===r?t.path||"":r,caseSensitive:!0===t.caseSensitive,childrenIndex:a,route:t};o.relativePath.startsWith("/")&&(u(o.relativePath.startsWith(i),'Absolute route path "'+o.relativePath+'" nested under path "'+i+'" is not valid. An absolute child route path must start with the combined path of all its parent routes.'),o.relativePath=o.relativePath.slice(i.length));let s=B([i,o.relativePath]),l=n.concat(o);t.children&&t.children.length>0&&(u(!0!==t.index,'Index routes must not have child routes. Please remove all child routes from route path "'+s+'".'),y(t.children,e,l,s)),(null!=t.path||t.index)&&e.push({path:s,score:S(s,t.index),routesMeta:l})};return t.forEach(((t,e)=>{var n;if(""!==t.path&&null!=(n=t.path)&&n.includes("?"))for(let n of x(t.path))a(t,e,n);else a(t,e)})),e}function x(t){let e=t.split("/");if(0===e.length)return[];let[n,...i]=e,a=n.endsWith("?"),r=n.replace(/\?$/,"");if(0===i.length)return a?[r,""]:[r];let o=x(i.join("/")),s=[];return s.push(...o.map((t=>""===t?r:[r,t].join("/")))),a&&s.push(...o),s.map((e=>t.startsWith("/")&&""===e?"/":e))}!function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"}(g||(g={})),new Set(["lazy","caseSensitive","path","id","index","children"]);const v=/^:[\w-]+$/,b=3,w=2,A=1,C=10,E=-2,T=t=>"*"===t;function S(t,e){let n=t.split("/"),i=n.length;return n.some(T)&&(i+=E),e&&(i+=w),n.filter((t=>!T(t))).reduce(((t,e)=>t+(v.test(e)?b:""===e?A:C)),i)}function M(t,e){let{routesMeta:n}=t,i={},a="/",r=[];for(let t=0;t<n.length;++t){let o=n[t],s=t===n.length-1,l="/"===a?e:e.slice(a.length)||"/",c=k({path:o.relativePath,caseSensitive:o.caseSensitive,end:s},l);if(!c)return null;Object.assign(i,c.params);let u=o.route;r.push({params:i,pathname:B([a,c.pathname]),pathnameBase:O(B([a,c.pathnameBase])),route:u}),"/"!==c.pathnameBase&&(a=B([a,c.pathnameBase]))}return r}function k(t,e){"string"==typeof t&&(t={path:t,caseSensitive:!1,end:!0});let[n,i]=function(t,e,n){void 0===e&&(e=!1),void 0===n&&(n=!0),h("*"===t||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were "'+t.replace(/\*$/,"/*")+'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "'+t.replace(/\*$/,"/*")+'".');let i=[],a="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,((t,e,n)=>(i.push({paramName:e,isOptional:null!=n}),n?"/?([^\\/]+)?":"/([^\\/]+)")));return t.endsWith("*")?(i.push({paramName:"*"}),a+="*"===t||"/*"===t?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?a+="\\/*$":""!==t&&"/"!==t&&(a+="(?:(?=\\/|$))"),[new RegExp(a,e?void 0:"i"),i]}(t.path,t.caseSensitive,t.end),a=e.match(n);if(!a)return null;let r=a[0],o=r.replace(/(.)\/+$/,"$1"),s=a.slice(1);return{params:i.reduce(((t,e,n)=>{let{paramName:i,isOptional:a}=e;if("*"===i){let t=s[n]||"";o=r.slice(0,r.length-t.length).replace(/(.)\/+$/,"$1")}const l=s[n];return t[i]=a&&!l?void 0:(l||"").replace(/%2F/g,"/"),t}),{}),pathname:r,pathnameBase:o,pattern:t}}function I(t){try{return t.split("/").map((t=>decodeURIComponent(t).replace(/\//g,"%2F"))).join("/")}catch(e){return h(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent encoding ('+e+")."),t}}function P(t,e){if("/"===e)return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,i=t.charAt(n);return i&&"/"!==i?null:t.slice(n)||"/"}function z(t,e,n,i){return"Cannot include a '"+t+"' character in a manually specified `to."+e+"` field ["+JSON.stringify(i)+"].  Please separate it out to the `to."+n+'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.'}function D(t,e){let n=function(t){return t.filter(((t,e)=>0===e||t.route.path&&t.route.path.length>0))}(t);return e?n.map(((e,n)=>n===t.length-1?e.pathname:e.pathnameBase)):n.map((t=>t.pathnameBase))}function L(t,e,n,i){let a;void 0===i&&(i=!1),"string"==typeof t?a=m(t):(a=l({},t),u(!a.pathname||!a.pathname.includes("?"),z("?","pathname","search",a)),u(!a.pathname||!a.pathname.includes("#"),z("#","pathname","hash",a)),u(!a.search||!a.search.includes("#"),z("#","search","hash",a)));let r,o=""===t||""===a.pathname,s=o?"/":a.pathname;if(null==s)r=n;else{let t=e.length-1;if(!i&&s.startsWith("..")){let e=s.split("/");for(;".."===e[0];)e.shift(),t-=1;a.pathname=e.join("/")}r=t>=0?e[t]:"/"}let c=function(t,e){void 0===e&&(e="/");let{pathname:n,search:i="",hash:a=""}="string"==typeof t?m(t):t,r=n?n.startsWith("/")?n:function(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach((t=>{".."===t?n.length>1&&n.pop():"."!==t&&n.push(t)})),n.length>1?n.join("/"):"/"}(n,e):e;return{pathname:r,search:R(i),hash:F(a)}}(a,r),h=s&&"/"!==s&&s.endsWith("/"),d=(o||"."===s)&&n.endsWith("/");return c.pathname.endsWith("/")||!h&&!d||(c.pathname+="/"),c}const B=t=>t.join("/").replace(/\/\/+/g,"/"),O=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),R=t=>t&&"?"!==t?t.startsWith("?")?t:"?"+t:"",F=t=>t&&"#"!==t?t.startsWith("#")?t:"#"+t:"";Error;const N=["post","put","patch","delete"],j=(new Set(N),["get",...N]);function V(){return V=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},V.apply(this,arguments)}new Set(j),new Set([301,302,303,307,308]),new Set([307,308]),Symbol("deferred");const U=n.createContext(null),G=n.createContext(null),q=n.createContext(null),$=n.createContext(null),W=n.createContext({outlet:null,matches:[],isDataRoute:!1}),H=n.createContext(null);function Z(){return null!=n.useContext($)}function Y(){return Z()||u(!1),n.useContext($).location}function X(t){n.useContext(q).static||n.useLayoutEffect(t)}function K(){let{isDataRoute:t}=n.useContext(W);return t?function(){let{router:t}=function(t){let e=n.useContext(U);return e||u(!1),e}(at.UseNavigateStable),e=ot(rt.UseNavigateStable),i=n.useRef(!1);X((()=>{i.current=!0}));let a=n.useCallback((function(n,a){void 0===a&&(a={}),i.current&&("number"==typeof n?t.navigate(n):t.navigate(n,V({fromRouteId:e},a)))}),[t,e]);return a}():function(){Z()||u(!1);let t=n.useContext(U),{basename:e,future:i,navigator:a}=n.useContext(q),{matches:r}=n.useContext(W),{pathname:o}=Y(),s=JSON.stringify(D(r,i.v7_relativeSplatPath)),l=n.useRef(!1);X((()=>{l.current=!0}));let c=n.useCallback((function(n,i){if(void 0===i&&(i={}),!l.current)return;if("number"==typeof n)return void a.go(n);let r=L(n,JSON.parse(s),o,"path"===i.relative);null==t&&"/"!==e&&(r.pathname="/"===r.pathname?e:B([e,r.pathname])),(i.replace?a.replace:a.push)(r,i.state,i)}),[e,a,s,o,t]);return c}()}function Q(t,e){let{relative:i}=void 0===e?{}:e,{future:a}=n.useContext(q),{matches:r}=n.useContext(W),{pathname:o}=Y(),s=JSON.stringify(D(r,a.v7_relativeSplatPath));return n.useMemo((()=>L(t,JSON.parse(s),o,"path"===i)),[t,s,o,i])}function J(t,i,a,r){Z()||u(!1);let{navigator:o}=n.useContext(q),{matches:s}=n.useContext(W),l=s[s.length-1],c=l?l.params:{},h=(l&&l.pathname,l?l.pathnameBase:"/");l&&l.route;let d,p=Y();if(i){var f;let t="string"==typeof i?m(i):i;"/"===h||(null==(f=t.pathname)?void 0:f.startsWith(h))||u(!1),d=t}else d=p;let g=d.pathname||"/",y=g;if("/"!==h){let t=h.replace(/^\//,"").split("/");y="/"+g.replace(/^\//,"").split("/").slice(t.length).join("/")}let x=_(t,{pathname:y}),v=function(t,e,i,a){var r;if(void 0===e&&(e=[]),void 0===i&&(i=null),void 0===a&&(a=null),null==t){var o;if(null==(o=i)||!o.errors)return null;t=i.matches}let s=t,l=null==(r=i)?void 0:r.errors;if(null!=l){let t=s.findIndex((t=>t.route.id&&void 0!==(null==l?void 0:l[t.route.id])));t>=0||u(!1),s=s.slice(0,Math.min(s.length,t+1))}let c=!1,h=-1;if(i&&a&&a.v7_partialHydration)for(let t=0;t<s.length;t++){let e=s[t];if((e.route.HydrateFallback||e.route.hydrateFallbackElement)&&(h=t),e.route.id){let{loaderData:t,errors:n}=i,a=e.route.loader&&void 0===t[e.route.id]&&(!n||void 0===n[e.route.id]);if(e.route.lazy||a){c=!0,s=h>=0?s.slice(0,h+1):[s[0]];break}}}return s.reduceRight(((t,a,r)=>{let o,u=!1,d=null,p=null;var f;i&&(o=l&&a.route.id?l[a.route.id]:void 0,d=a.route.errorElement||et,c&&(h<0&&0===r?(st[f="route-fallback"]||(st[f]=!0),u=!0,p=null):h===r&&(u=!0,p=a.route.hydrateFallbackElement||null)));let m=e.concat(s.slice(0,r+1)),g=()=>{let e;return e=o?d:u?p:a.route.Component?n.createElement(a.route.Component,null):a.route.element?a.route.element:t,n.createElement(it,{match:a,routeContext:{outlet:t,matches:m,isDataRoute:null!=i},children:e})};return i&&(a.route.ErrorBoundary||a.route.errorElement||0===r)?n.createElement(nt,{location:i.location,revalidation:i.revalidation,component:d,error:o,children:g(),routeContext:{outlet:null,matches:m,isDataRoute:!0}}):g()}),null)}(x&&x.map((t=>Object.assign({},t,{params:Object.assign({},c,t.params),pathname:B([h,o.encodeLocation?o.encodeLocation(t.pathname).pathname:t.pathname]),pathnameBase:"/"===t.pathnameBase?h:B([h,o.encodeLocation?o.encodeLocation(t.pathnameBase).pathname:t.pathnameBase])}))),s,a,r);return i&&v?n.createElement($.Provider,{value:{location:V({pathname:"/",search:"",hash:"",state:null,key:"default"},d),navigationType:e.Pop}},v):v}function tt(){let t=function(){var t;let e=n.useContext(H),i=function(t){let e=n.useContext(G);return e||u(!1),e}(rt.UseRouteError),a=ot(rt.UseRouteError);return void 0!==e?e:null==(t=i.errors)?void 0:t[a]}(),e=function(t){return null!=t&&"number"==typeof t.status&&"string"==typeof t.statusText&&"boolean"==typeof t.internal&&"data"in t}(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),i=t instanceof Error?t.stack:null,a={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return n.createElement(n.Fragment,null,n.createElement("h2",null,"Unexpected Application Error!"),n.createElement("h3",{style:{fontStyle:"italic"}},e),i?n.createElement("pre",{style:a},i):null,null)}const et=n.createElement(tt,null);class nt extends n.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,e){return e.location!==t.location||"idle"!==e.revalidation&&"idle"===t.revalidation?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:void 0!==t.error?t.error:e.error,location:e.location,revalidation:t.revalidation||e.revalidation}}componentDidCatch(t,e){console.error("React Router caught the following error during render",t,e)}render(){return void 0!==this.state.error?n.createElement(W.Provider,{value:this.props.routeContext},n.createElement(H.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function it(t){let{routeContext:e,match:i,children:a}=t,r=n.useContext(U);return r&&r.static&&r.staticContext&&(i.route.errorElement||i.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=i.route.id),n.createElement(W.Provider,{value:e},a)}var at=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(at||{}),rt=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(rt||{});function ot(t){let e=function(t){let e=n.useContext(W);return e||u(!1),e}(),i=e.matches[e.matches.length-1];return i.route.id||u(!1),i.route.id}const st={};function lt(t){u(!1)}function ct(t){let{basename:i="/",children:a=null,location:r,navigationType:o=e.Pop,navigator:s,static:l=!1,future:c}=t;Z()&&u(!1);let h=i.replace(/^\/*/,"/"),d=n.useMemo((()=>({basename:h,navigator:s,static:l,future:V({v7_relativeSplatPath:!1},c)})),[h,c,s,l]);"string"==typeof r&&(r=m(r));let{pathname:p="/",search:f="",hash:g="",state:_=null,key:y="default"}=r,x=n.useMemo((()=>{let t=P(p,h);return null==t?null:{location:{pathname:t,search:f,hash:g,state:_,key:y},navigationType:o}}),[h,p,f,g,_,y,o]);return null==x?null:n.createElement(q.Provider,{value:d},n.createElement($.Provider,{children:a,value:x}))}function ut(t){let{children:e,location:n}=t;return J(ht(e),n)}function ht(t,e){void 0===e&&(e=[]);let i=[];return n.Children.forEach(t,((t,a)=>{if(!n.isValidElement(t))return;let r=[...e,a];if(t.type===n.Fragment)return void i.push.apply(i,ht(t.props.children,r));t.type!==lt&&u(!1),t.props.index&&t.props.children&&u(!1);let o={id:t.props.id||r.join("-"),caseSensitive:t.props.caseSensitive,element:t.props.element,Component:t.props.Component,index:t.props.index,path:t.props.path,loader:t.props.loader,action:t.props.action,errorElement:t.props.errorElement,ErrorBoundary:t.props.ErrorBoundary,hasErrorBoundary:null!=t.props.ErrorBoundary||null!=t.props.errorElement,shouldRevalidate:t.props.shouldRevalidate,handle:t.props.handle,lazy:t.props.lazy};t.props.children&&(o.children=ht(t.props.children,r)),i.push(o)})),i}function dt(){return dt=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},dt.apply(this,arguments)}function pt(t,e){if(null==t)return{};var n,i,a={},r=Object.keys(t);for(i=0;i<r.length;i++)n=r[i],e.indexOf(n)>=0||(a[n]=t[n]);return a}i.startTransition,new Promise((()=>{})),n.Component,new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);const ft=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","unstable_viewTransition"],mt=["aria-current","caseSensitive","className","end","style","to","unstable_viewTransition","children"];try{window.__reactRouterVersion="6"}catch(Mi){}const gt=n.createContext({isTransitioning:!1});new Map;const _t=i.startTransition;function yt(t){let{basename:i,children:a,future:r,window:o}=t,s=n.useRef();null==s.current&&(s.current=function(t){return void 0===t&&(t={}),function(t,n,i,a){void 0===a&&(a={});let{window:r=document.defaultView,v5Compat:o=!1}=a,s=r.history,h=e.Pop,m=null,g=_();function _(){return(s.state||{idx:null}).idx}function y(){h=e.Pop;let t=_(),n=null==t?null:t-g;g=t,m&&m({action:h,location:v.location,delta:n})}function x(t){let e="null"!==r.location.origin?r.location.origin:r.location.href,n="string"==typeof t?t:f(t);return n=n.replace(/ $/,"%20"),u(e,"No window.location.(origin|href) available to create URL for href: "+n),new URL(n,e)}null==g&&(g=0,s.replaceState(l({},s.state,{idx:g}),""));let v={get action(){return h},get location(){return t(r,s)},listen(t){if(m)throw new Error("A history only accepts one active listener");return r.addEventListener(c,y),m=t,()=>{r.removeEventListener(c,y),m=null}},createHref:t=>n(r,t),createURL:x,encodeLocation(t){let e=x(t);return{pathname:e.pathname,search:e.search,hash:e.hash}},push:function(t,n){h=e.Push;let a=p(v.location,t,n);i&&i(a,t),g=_()+1;let l=d(a,g),c=v.createHref(a);try{s.pushState(l,"",c)}catch(t){if(t instanceof DOMException&&"DataCloneError"===t.name)throw t;r.location.assign(c)}o&&m&&m({action:h,location:v.location,delta:1})},replace:function(t,n){h=e.Replace;let a=p(v.location,t,n);i&&i(a,t),g=_();let r=d(a,g),l=v.createHref(a);s.replaceState(r,"",l),o&&m&&m({action:h,location:v.location,delta:0})},go:t=>s.go(t)};return v}((function(t,e){let{pathname:n,search:i,hash:a}=t.location;return p("",{pathname:n,search:i,hash:a},e.state&&e.state.usr||null,e.state&&e.state.key||"default")}),(function(t,e){return"string"==typeof e?e:f(e)}),null,t)}({window:o,v5Compat:!0}));let h=s.current,[m,g]=n.useState({action:h.action,location:h.location}),{v7_startTransition:_}=r||{},y=n.useCallback((t=>{_&&_t?_t((()=>g(t))):g(t)}),[g,_]);return n.useLayoutEffect((()=>h.listen(y)),[h,y]),n.createElement(ct,{basename:i,children:a,location:m.location,navigationType:m.action,navigator:h,future:r})}s.flushSync,i.useId;const xt="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement,vt=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,bt=n.forwardRef((function(t,e){let i,{onClick:a,relative:r,reloadDocument:o,replace:s,state:l,target:c,to:h,preventScrollReset:d,unstable_viewTransition:p}=t,m=pt(t,ft),{basename:g}=n.useContext(q),_=!1;if("string"==typeof h&&vt.test(h)&&(i=h,xt))try{let t=new URL(window.location.href),e=h.startsWith("//")?new URL(t.protocol+h):new URL(h),n=P(e.pathname,g);e.origin===t.origin&&null!=n?h=n+e.search+e.hash:_=!0}catch(t){}let y=function(t,e){let{relative:i}=void 0===e?{}:e;Z()||u(!1);let{basename:a,navigator:r}=n.useContext(q),{hash:o,pathname:s,search:l}=Q(t,{relative:i}),c=s;return"/"!==a&&(c="/"===s?a:B([a,s])),r.createHref({pathname:c,search:l,hash:o})}(h,{relative:r}),x=function(t,e){let{target:i,replace:a,state:r,preventScrollReset:o,relative:s,unstable_viewTransition:l}=void 0===e?{}:e,c=K(),u=Y(),h=Q(t,{relative:s});return n.useCallback((e=>{if(function(t,e){return!(0!==t.button||e&&"_self"!==e||function(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}(t))}(e,i)){e.preventDefault();let n=void 0!==a?a:f(u)===f(h);c(t,{replace:n,state:r,preventScrollReset:o,relative:s,unstable_viewTransition:l})}}),[u,c,h,a,r,i,t,o,s,l])}(h,{replace:s,state:l,target:c,preventScrollReset:d,relative:r,unstable_viewTransition:p});return n.createElement("a",dt({},m,{href:i||y,onClick:_||o?a:function(t){a&&a(t),t.defaultPrevented||x(t)},ref:e,target:c}))})),wt=n.forwardRef((function(t,e){let{"aria-current":i="page",caseSensitive:a=!1,className:r="",end:o=!1,style:s,to:l,unstable_viewTransition:c,children:h}=t,d=pt(t,mt),p=Q(l,{relative:d.relative}),f=Y(),m=n.useContext(G),{navigator:g,basename:_}=n.useContext(q),y=null!=m&&function(t,e){void 0===e&&(e={});let i=n.useContext(gt);null==i&&u(!1);let{basename:a}=function(t){let e=n.useContext(U);return e||u(!1),e}(At.useViewTransitionState),r=Q(t,{relative:e.relative});if(!i.isTransitioning)return!1;let o=P(i.currentLocation.pathname,a)||i.currentLocation.pathname,s=P(i.nextLocation.pathname,a)||i.nextLocation.pathname;return null!=k(r.pathname,s)||null!=k(r.pathname,o)}(p)&&!0===c,x=g.encodeLocation?g.encodeLocation(p).pathname:p.pathname,v=f.pathname,b=m&&m.navigation&&m.navigation.location?m.navigation.location.pathname:null;a||(v=v.toLowerCase(),b=b?b.toLowerCase():null,x=x.toLowerCase()),b&&_&&(b=P(b,_)||b);const w="/"!==x&&x.endsWith("/")?x.length-1:x.length;let A,C=v===x||!o&&v.startsWith(x)&&"/"===v.charAt(w),E=null!=b&&(b===x||!o&&b.startsWith(x)&&"/"===b.charAt(x.length)),T={isActive:C,isPending:E,isTransitioning:y},S=C?i:void 0;A="function"==typeof r?r(T):[r,C?"active":null,E?"pending":null,y?"transitioning":null].filter(Boolean).join(" ");let M="function"==typeof s?s(T):s;return n.createElement(bt,dt({},d,{"aria-current":S,className:A,ref:e,style:M,to:l,unstable_viewTransition:c}),"function"==typeof h?h(T):h)}));var At,Ct;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(At||(At={})),function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"}(Ct||(Ct={}));var Et=function(){return Et=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var a in e=arguments[n])Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t},Et.apply(this,arguments)};function Tt(t,e,n){if(n||2===arguments.length)for(var i,a=0,r=e.length;a<r;a++)!i&&a in e||(i||(i=Array.prototype.slice.call(e,0,a)),i[a]=e[a]);return t.concat(i||Array.prototype.slice.call(e))}Object.create,Object.create,"function"==typeof SuppressedError&&SuppressedError;var St=a(2833),Mt=a.n(St),kt="-ms-",It="-moz-",Pt="-webkit-",zt="comm",Dt="rule",Lt="decl",Bt="@import",Ot="@keyframes",Rt="@layer",Ft=Math.abs,Nt=String.fromCharCode,jt=Object.assign;function Vt(t){return t.trim()}function Ut(t,e){return(t=e.exec(t))?t[0]:t}function Gt(t,e,n){return t.replace(e,n)}function qt(t,e,n){return t.indexOf(e,n)}function $t(t,e){return 0|t.charCodeAt(e)}function Wt(t,e,n){return t.slice(e,n)}function Ht(t){return t.length}function Zt(t){return t.length}function Yt(t,e){return e.push(t),t}function Xt(t,e){return t.filter((function(t){return!Ut(t,e)}))}var Kt=1,Qt=1,Jt=0,te=0,ee=0,ne="";function ie(t,e,n,i,a,r,o,s){return{value:t,root:e,parent:n,type:i,props:a,children:r,line:Kt,column:Qt,length:o,return:"",siblings:s}}function ae(t,e){return jt(ie("",null,null,"",null,null,0,t.siblings),t,{length:-t.length},e)}function re(t){for(;t.root;)t=ae(t.root,{children:[t]});Yt(t,t.siblings)}function oe(){return ee=te>0?$t(ne,--te):0,Qt--,10===ee&&(Qt=1,Kt--),ee}function se(){return ee=te<Jt?$t(ne,te++):0,Qt++,10===ee&&(Qt=1,Kt++),ee}function le(){return $t(ne,te)}function ce(){return te}function ue(t,e){return Wt(ne,t,e)}function he(t){switch(t){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function de(t){return Vt(ue(te-1,me(91===t?t+2:40===t?t+1:t)))}function pe(t){for(;(ee=le())&&ee<33;)se();return he(t)>2||he(ee)>3?"":" "}function fe(t,e){for(;--e&&se()&&!(ee<48||ee>102||ee>57&&ee<65||ee>70&&ee<97););return ue(t,ce()+(e<6&&32==le()&&32==se()))}function me(t){for(;se();)switch(ee){case t:return te;case 34:case 39:34!==t&&39!==t&&me(ee);break;case 40:41===t&&me(t);break;case 92:se()}return te}function ge(t,e){for(;se()&&t+ee!==57&&(t+ee!==84||47!==le()););return"/*"+ue(e,te-1)+"*"+Nt(47===t?t:se())}function _e(t){for(;!he(le());)se();return ue(t,te)}function ye(t,e){for(var n="",i=0;i<t.length;i++)n+=e(t[i],i,t,e)||"";return n}function xe(t,e,n,i){switch(t.type){case Rt:if(t.children.length)break;case Bt:case Lt:return t.return=t.return||t.value;case zt:return"";case Ot:return t.return=t.value+"{"+ye(t.children,i)+"}";case Dt:if(!Ht(t.value=t.props.join(",")))return""}return Ht(n=ye(t.children,i))?t.return=t.value+"{"+n+"}":""}function ve(t,e,n){switch(function(t,e){return 45^$t(t,0)?(((e<<2^$t(t,0))<<2^$t(t,1))<<2^$t(t,2))<<2^$t(t,3):0}(t,e)){case 5103:return Pt+"print-"+t+t;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return Pt+t+t;case 4789:return It+t+t;case 5349:case 4246:case 4810:case 6968:case 2756:return Pt+t+It+t+kt+t+t;case 5936:switch($t(t,e+11)){case 114:return Pt+t+kt+Gt(t,/[svh]\w+-[tblr]{2}/,"tb")+t;case 108:return Pt+t+kt+Gt(t,/[svh]\w+-[tblr]{2}/,"tb-rl")+t;case 45:return Pt+t+kt+Gt(t,/[svh]\w+-[tblr]{2}/,"lr")+t}case 6828:case 4268:case 2903:return Pt+t+kt+t+t;case 6165:return Pt+t+kt+"flex-"+t+t;case 5187:return Pt+t+Gt(t,/(\w+).+(:[^]+)/,Pt+"box-$1$2"+kt+"flex-$1$2")+t;case 5443:return Pt+t+kt+"flex-item-"+Gt(t,/flex-|-self/g,"")+(Ut(t,/flex-|baseline/)?"":kt+"grid-row-"+Gt(t,/flex-|-self/g,""))+t;case 4675:return Pt+t+kt+"flex-line-pack"+Gt(t,/align-content|flex-|-self/g,"")+t;case 5548:return Pt+t+kt+Gt(t,"shrink","negative")+t;case 5292:return Pt+t+kt+Gt(t,"basis","preferred-size")+t;case 6060:return Pt+"box-"+Gt(t,"-grow","")+Pt+t+kt+Gt(t,"grow","positive")+t;case 4554:return Pt+Gt(t,/([^-])(transform)/g,"$1"+Pt+"$2")+t;case 6187:return Gt(Gt(Gt(t,/(zoom-|grab)/,Pt+"$1"),/(image-set)/,Pt+"$1"),t,"")+t;case 5495:case 3959:return Gt(t,/(image-set\([^]*)/,Pt+"$1$`$1");case 4968:return Gt(Gt(t,/(.+:)(flex-)?(.*)/,Pt+"box-pack:$3"+kt+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+Pt+t+t;case 4200:if(!Ut(t,/flex-|baseline/))return kt+"grid-column-align"+Wt(t,e)+t;break;case 2592:case 3360:return kt+Gt(t,"template-","")+t;case 4384:case 3616:return n&&n.some((function(t,n){return e=n,Ut(t.props,/grid-\w+-end/)}))?~qt(t+(n=n[e].value),"span",0)?t:kt+Gt(t,"-start","")+t+kt+"grid-row-span:"+(~qt(n,"span",0)?Ut(n,/\d+/):+Ut(n,/\d+/)-+Ut(t,/\d+/))+";":kt+Gt(t,"-start","")+t;case 4896:case 4128:return n&&n.some((function(t){return Ut(t.props,/grid-\w+-start/)}))?t:kt+Gt(Gt(t,"-end","-span"),"span ","")+t;case 4095:case 3583:case 4068:case 2532:return Gt(t,/(.+)-inline(.+)/,Pt+"$1$2")+t;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(Ht(t)-1-e>6)switch($t(t,e+1)){case 109:if(45!==$t(t,e+4))break;case 102:return Gt(t,/(.+:)(.+)-([^]+)/,"$1"+Pt+"$2-$3$1"+It+(108==$t(t,e+3)?"$3":"$2-$3"))+t;case 115:return~qt(t,"stretch",0)?ve(Gt(t,"stretch","fill-available"),e,n)+t:t}break;case 5152:case 5920:return Gt(t,/(.+?):(\d+)(\s*\/\s*(span)?\s*(\d+))?(.*)/,(function(e,n,i,a,r,o,s){return kt+n+":"+i+s+(a?kt+n+"-span:"+(r?o:+o-+i)+s:"")+t}));case 4949:if(121===$t(t,e+6))return Gt(t,":",":"+Pt)+t;break;case 6444:switch($t(t,45===$t(t,14)?18:11)){case 120:return Gt(t,/(.+:)([^;\s!]+)(;|(\s+)?!.+)?/,"$1"+Pt+(45===$t(t,14)?"inline-":"")+"box$3$1"+Pt+"$2$3$1"+kt+"$2box$3")+t;case 100:return Gt(t,":",":"+kt)+t}break;case 5719:case 2647:case 2135:case 3927:case 2391:return Gt(t,"scroll-","scroll-snap-")+t}return t}function be(t,e,n,i){if(t.length>-1&&!t.return)switch(t.type){case Lt:return void(t.return=ve(t.value,t.length,n));case Ot:return ye([ae(t,{value:Gt(t.value,"@","@"+Pt)})],i);case Dt:if(t.length)return function(t,e){return t.map(e).join("")}(n=t.props,(function(e){switch(Ut(e,i=/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":re(ae(t,{props:[Gt(e,/:(read-\w+)/,":"+It+"$1")]})),re(ae(t,{props:[e]})),jt(t,{props:Xt(n,i)});break;case"::placeholder":re(ae(t,{props:[Gt(e,/:(plac\w+)/,":"+Pt+"input-$1")]})),re(ae(t,{props:[Gt(e,/:(plac\w+)/,":"+It+"$1")]})),re(ae(t,{props:[Gt(e,/:(plac\w+)/,kt+"input-$1")]})),re(ae(t,{props:[e]})),jt(t,{props:Xt(n,i)})}return""}))}}function we(t){return function(t){return ne="",t}(Ae("",null,null,null,[""],t=function(t){return Kt=Qt=1,Jt=Ht(ne=t),te=0,[]}(t),0,[0],t))}function Ae(t,e,n,i,a,r,o,s,l){for(var c=0,u=0,h=o,d=0,p=0,f=0,m=1,g=1,_=1,y=0,x="",v=a,b=r,w=i,A=x;g;)switch(f=y,y=se()){case 40:if(108!=f&&58==$t(A,h-1)){-1!=qt(A+=Gt(de(y),"&","&\f"),"&\f",Ft(c?s[c-1]:0))&&(_=-1);break}case 34:case 39:case 91:A+=de(y);break;case 9:case 10:case 13:case 32:A+=pe(f);break;case 92:A+=fe(ce()-1,7);continue;case 47:switch(le()){case 42:case 47:Yt(Ee(ge(se(),ce()),e,n,l),l);break;default:A+="/"}break;case 123*m:s[c++]=Ht(A)*_;case 125*m:case 59:case 0:switch(y){case 0:case 125:g=0;case 59+u:-1==_&&(A=Gt(A,/\f/g,"")),p>0&&Ht(A)-h&&Yt(p>32?Te(A+";",i,n,h-1,l):Te(Gt(A," ","")+";",i,n,h-2,l),l);break;case 59:A+=";";default:if(Yt(w=Ce(A,e,n,c,u,a,s,x,v=[],b=[],h,r),r),123===y)if(0===u)Ae(A,e,w,w,v,r,h,s,b);else switch(99===d&&110===$t(A,3)?100:d){case 100:case 108:case 109:case 115:Ae(t,w,w,i&&Yt(Ce(t,w,w,0,0,a,s,x,a,v=[],h,b),b),a,b,h,s,i?v:b);break;default:Ae(A,w,w,w,[""],b,0,s,b)}}c=u=p=0,m=_=1,x=A="",h=o;break;case 58:h=1+Ht(A),p=f;default:if(m<1)if(123==y)--m;else if(125==y&&0==m++&&125==oe())continue;switch(A+=Nt(y),y*m){case 38:_=u>0?1:(A+="\f",-1);break;case 44:s[c++]=(Ht(A)-1)*_,_=1;break;case 64:45===le()&&(A+=de(se())),d=le(),u=h=Ht(x=A+=_e(ce())),y++;break;case 45:45===f&&2==Ht(A)&&(m=0)}}return r}function Ce(t,e,n,i,a,r,o,s,l,c,u,h){for(var d=a-1,p=0===a?r:[""],f=Zt(p),m=0,g=0,_=0;m<i;++m)for(var y=0,x=Wt(t,d+1,d=Ft(g=o[m])),v=t;y<f;++y)(v=Vt(g>0?p[y]+" "+x:Gt(x,/&\f/g,p[y])))&&(l[_++]=v);return ie(t,e,n,0===a?Dt:s,l,c,u,h)}function Ee(t,e,n,i){return ie(t,e,n,zt,Nt(ee),Wt(t,2,-2),0,i)}function Te(t,e,n,i,a){return ie(t,e,n,Lt,Wt(t,0,i),Wt(t,i+1,-1),i,a)}var Se={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},Me="undefined"!=typeof process&&("MISSING_ENV_VAR".REACT_APP_SC_ATTR||"MISSING_ENV_VAR".SC_ATTR)||"data-styled",ke="active",Ie="data-styled-version",Pe="6.1.11",ze="/*!sc*/\n",De="undefined"!=typeof window&&"HTMLElement"in window,Le=Boolean("boolean"==typeof SC_DISABLE_SPEEDY?SC_DISABLE_SPEEDY:"undefined"!=typeof process&&void 0!=="MISSING_ENV_VAR".REACT_APP_SC_DISABLE_SPEEDY&&""!=="MISSING_ENV_VAR".REACT_APP_SC_DISABLE_SPEEDY?"false"!=="MISSING_ENV_VAR".REACT_APP_SC_DISABLE_SPEEDY&&"MISSING_ENV_VAR".REACT_APP_SC_DISABLE_SPEEDY:"undefined"!=typeof process&&void 0!=="MISSING_ENV_VAR".SC_DISABLE_SPEEDY&&""!=="MISSING_ENV_VAR".SC_DISABLE_SPEEDY&&"false"!=="MISSING_ENV_VAR".SC_DISABLE_SPEEDY&&"MISSING_ENV_VAR".SC_DISABLE_SPEEDY),Be={},Oe=(new Set,Object.freeze([])),Re=Object.freeze({});function Fe(t,e,n){return void 0===n&&(n=Re),t.theme!==n.theme&&t.theme||e||n.theme}var Ne=new Set(["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","tr","track","u","ul","use","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","marker","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"]),je=/[!"#$%&'()*+,./:;<=>?@[\\\]^`{|}~-]+/g,Ve=/(^-|-$)/g;function Ue(t){return t.replace(je,"-").replace(Ve,"")}var Ge=/(a)(d)/gi,qe=52,$e=function(t){return String.fromCharCode(t+(t>25?39:97))};function We(t){var e,n="";for(e=Math.abs(t);e>qe;e=e/qe|0)n=$e(e%qe)+n;return($e(e%qe)+n).replace(Ge,"$1-$2")}var He,Ze=5381,Ye=function(t,e){for(var n=e.length;n;)t=33*t^e.charCodeAt(--n);return t},Xe=function(t){return Ye(Ze,t)};function Ke(t){return We(Xe(t)>>>0)}function Qe(t){return"string"==typeof t&&!0}var Je="function"==typeof Symbol&&Symbol.for,tn=Je?Symbol.for("react.memo"):60115,en=Je?Symbol.for("react.forward_ref"):60112,nn={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},an={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},rn={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},on=((He={})[en]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},He[tn]=rn,He);function sn(t){return("type"in(e=t)&&e.type.$$typeof)===tn?rn:"$$typeof"in t?on[t.$$typeof]:nn;var e}var ln=Object.defineProperty,cn=Object.getOwnPropertyNames,un=Object.getOwnPropertySymbols,hn=Object.getOwnPropertyDescriptor,dn=Object.getPrototypeOf,pn=Object.prototype;function fn(t,e,n){if("string"!=typeof e){if(pn){var i=dn(e);i&&i!==pn&&fn(t,i,n)}var a=cn(e);un&&(a=a.concat(un(e)));for(var r=sn(t),o=sn(e),s=0;s<a.length;++s){var l=a[s];if(!(l in an||n&&n[l]||o&&l in o||r&&l in r)){var c=hn(e,l);try{ln(t,l,c)}catch(t){}}}}return t}function mn(t){return"function"==typeof t}function gn(t){return"object"==typeof t&&"styledComponentId"in t}function _n(t,e){return t&&e?"".concat(t," ").concat(e):t||e||""}function yn(t,e){if(0===t.length)return"";for(var n=t[0],i=1;i<t.length;i++)n+=e?e+t[i]:t[i];return n}function xn(t){return null!==t&&"object"==typeof t&&t.constructor.name===Object.name&&!("props"in t&&t.$$typeof)}function vn(t,e,n){if(void 0===n&&(n=!1),!n&&!xn(t)&&!Array.isArray(t))return e;if(Array.isArray(e))for(var i=0;i<e.length;i++)t[i]=vn(t[i],e[i]);else if(xn(e))for(var i in e)t[i]=vn(t[i],e[i]);return t}function bn(t,e){Object.defineProperty(t,"toString",{value:e})}function wn(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return new Error("An error occurred. See https://github.com/styled-components/styled-components/blob/main/packages/styled-components/src/utils/errors.md#".concat(t," for more information.").concat(e.length>0?" Args: ".concat(e.join(", ")):""))}var An=function(){function t(t){this.groupSizes=new Uint32Array(512),this.length=512,this.tag=t}return t.prototype.indexOfGroup=function(t){for(var e=0,n=0;n<t;n++)e+=this.groupSizes[n];return e},t.prototype.insertRules=function(t,e){if(t>=this.groupSizes.length){for(var n=this.groupSizes,i=n.length,a=i;t>=a;)if((a<<=1)<0)throw wn(16,"".concat(t));this.groupSizes=new Uint32Array(a),this.groupSizes.set(n),this.length=a;for(var r=i;r<a;r++)this.groupSizes[r]=0}for(var o=this.indexOfGroup(t+1),s=(r=0,e.length);r<s;r++)this.tag.insertRule(o,e[r])&&(this.groupSizes[t]++,o++)},t.prototype.clearGroup=function(t){if(t<this.length){var e=this.groupSizes[t],n=this.indexOfGroup(t),i=n+e;this.groupSizes[t]=0;for(var a=n;a<i;a++)this.tag.deleteRule(n)}},t.prototype.getGroup=function(t){var e="";if(t>=this.length||0===this.groupSizes[t])return e;for(var n=this.groupSizes[t],i=this.indexOfGroup(t),a=i+n,r=i;r<a;r++)e+="".concat(this.tag.getRule(r)).concat(ze);return e},t}(),Cn=new Map,En=new Map,Tn=1,Sn=function(t){if(Cn.has(t))return Cn.get(t);for(;En.has(Tn);)Tn++;var e=Tn++;return Cn.set(t,e),En.set(e,t),e},Mn=function(t,e){Tn=e+1,Cn.set(t,e),En.set(e,t)},kn="style[".concat(Me,"][").concat(Ie,'="').concat(Pe,'"]'),In=new RegExp("^".concat(Me,'\\.g(\\d+)\\[id="([\\w\\d-]+)"\\].*?"([^"]*)')),Pn=function(t,e,n){for(var i,a=n.split(","),r=0,o=a.length;r<o;r++)(i=a[r])&&t.registerName(e,i)},zn=function(t,e){for(var n,i=(null!==(n=e.textContent)&&void 0!==n?n:"").split(ze),a=[],r=0,o=i.length;r<o;r++){var s=i[r].trim();if(s){var l=s.match(In);if(l){var c=0|parseInt(l[1],10),u=l[2];0!==c&&(Mn(u,c),Pn(t,u,l[3]),t.getTag().insertRules(c,a)),a.length=0}else a.push(s)}}};function Dn(){return a.nc}var Ln=function(t){var e=document.head,n=t||e,i=document.createElement("style"),a=function(t){var e=Array.from(t.querySelectorAll("style[".concat(Me,"]")));return e[e.length-1]}(n),r=void 0!==a?a.nextSibling:null;i.setAttribute(Me,ke),i.setAttribute(Ie,Pe);var o=Dn();return o&&i.setAttribute("nonce",o),n.insertBefore(i,r),i},Bn=function(){function t(t){this.element=Ln(t),this.element.appendChild(document.createTextNode("")),this.sheet=function(t){if(t.sheet)return t.sheet;for(var e=document.styleSheets,n=0,i=e.length;n<i;n++){var a=e[n];if(a.ownerNode===t)return a}throw wn(17)}(this.element),this.length=0}return t.prototype.insertRule=function(t,e){try{return this.sheet.insertRule(e,t),this.length++,!0}catch(t){return!1}},t.prototype.deleteRule=function(t){this.sheet.deleteRule(t),this.length--},t.prototype.getRule=function(t){var e=this.sheet.cssRules[t];return e&&e.cssText?e.cssText:""},t}(),On=function(){function t(t){this.element=Ln(t),this.nodes=this.element.childNodes,this.length=0}return t.prototype.insertRule=function(t,e){if(t<=this.length&&t>=0){var n=document.createTextNode(e);return this.element.insertBefore(n,this.nodes[t]||null),this.length++,!0}return!1},t.prototype.deleteRule=function(t){this.element.removeChild(this.nodes[t]),this.length--},t.prototype.getRule=function(t){return t<this.length?this.nodes[t].textContent:""},t}(),Rn=function(){function t(t){this.rules=[],this.length=0}return t.prototype.insertRule=function(t,e){return t<=this.length&&(this.rules.splice(t,0,e),this.length++,!0)},t.prototype.deleteRule=function(t){this.rules.splice(t,1),this.length--},t.prototype.getRule=function(t){return t<this.length?this.rules[t]:""},t}(),Fn=De,Nn={isServer:!De,useCSSOMInjection:!Le},jn=function(){function t(t,e,n){void 0===t&&(t=Re),void 0===e&&(e={});var i=this;this.options=Et(Et({},Nn),t),this.gs=e,this.names=new Map(n),this.server=!!t.isServer,!this.server&&De&&Fn&&(Fn=!1,function(t){for(var e=document.querySelectorAll(kn),n=0,i=e.length;n<i;n++){var a=e[n];a&&a.getAttribute(Me)!==ke&&(zn(t,a),a.parentNode&&a.parentNode.removeChild(a))}}(this)),bn(this,(function(){return function(t){for(var e=t.getTag(),n=e.length,i="",a=function(n){var a=function(t){return En.get(t)}(n);if(void 0===a)return"continue";var r=t.names.get(a),o=e.getGroup(n);if(void 0===r||0===o.length)return"continue";var s="".concat(Me,".g").concat(n,'[id="').concat(a,'"]'),l="";void 0!==r&&r.forEach((function(t){t.length>0&&(l+="".concat(t,","))})),i+="".concat(o).concat(s,'{content:"').concat(l,'"}').concat(ze)},r=0;r<n;r++)a(r);return i}(i)}))}return t.registerId=function(t){return Sn(t)},t.prototype.reconstructWithOptions=function(e,n){return void 0===n&&(n=!0),new t(Et(Et({},this.options),e),this.gs,n&&this.names||void 0)},t.prototype.allocateGSInstance=function(t){return this.gs[t]=(this.gs[t]||0)+1},t.prototype.getTag=function(){return this.tag||(this.tag=(t=function(t){var e=t.useCSSOMInjection,n=t.target;return t.isServer?new Rn(n):e?new Bn(n):new On(n)}(this.options),new An(t)));var t},t.prototype.hasNameForId=function(t,e){return this.names.has(t)&&this.names.get(t).has(e)},t.prototype.registerName=function(t,e){if(Sn(t),this.names.has(t))this.names.get(t).add(e);else{var n=new Set;n.add(e),this.names.set(t,n)}},t.prototype.insertRules=function(t,e,n){this.registerName(t,e),this.getTag().insertRules(Sn(t),n)},t.prototype.clearNames=function(t){this.names.has(t)&&this.names.get(t).clear()},t.prototype.clearRules=function(t){this.getTag().clearGroup(Sn(t)),this.clearNames(t)},t.prototype.clearTag=function(){this.tag=void 0},t}(),Vn=/&/g,Un=/^\s*\/\/.*$/gm;function Gn(t,e){return t.map((function(t){return"rule"===t.type&&(t.value="".concat(e," ").concat(t.value),t.value=t.value.replaceAll(",",",".concat(e," ")),t.props=t.props.map((function(t){return"".concat(e," ").concat(t)}))),Array.isArray(t.children)&&"@keyframes"!==t.type&&(t.children=Gn(t.children,e)),t}))}function qn(t){var e,n,i,a=void 0===t?Re:t,r=a.options,o=void 0===r?Re:r,s=a.plugins,l=void 0===s?Oe:s,c=function(t,i,a){return a.startsWith(n)&&a.endsWith(n)&&a.replaceAll(n,"").length>0?".".concat(e):t},u=l.slice();u.push((function(t){t.type===Dt&&t.value.includes("&")&&(t.props[0]=t.props[0].replace(Vn,n).replace(i,c))})),o.prefix&&u.push(be),u.push(xe);var h=function(t,a,r,s){void 0===a&&(a=""),void 0===r&&(r=""),void 0===s&&(s="&"),e=s,n=a,i=new RegExp("\\".concat(n,"\\b"),"g");var l=t.replace(Un,""),c=we(r||a?"".concat(r," ").concat(a," { ").concat(l," }"):l);o.namespace&&(c=Gn(c,o.namespace));var h,d,p=[];return ye(c,(h=u.concat((function(t){t.root||(t=t.return)&&function(t){p.push(t)}(t)})),d=Zt(h),function(t,e,n,i){for(var a="",r=0;r<d;r++)a+=h[r](t,e,n,i)||"";return a})),p};return h.hash=l.length?l.reduce((function(t,e){return e.name||wn(15),Ye(t,e.name)}),Ze).toString():"",h}var $n=new jn,Wn=qn(),Hn=n.createContext({shouldForwardProp:void 0,styleSheet:$n,stylis:Wn}),Zn=(Hn.Consumer,n.createContext(void 0));function Yn(){return(0,n.useContext)(Hn)}function Xn(t){var e=(0,n.useState)(t.stylisPlugins),i=e[0],a=e[1],r=Yn().styleSheet,o=(0,n.useMemo)((function(){var e=r;return t.sheet?e=t.sheet:t.target&&(e=e.reconstructWithOptions({target:t.target},!1)),t.disableCSSOMInjection&&(e=e.reconstructWithOptions({useCSSOMInjection:!1})),e}),[t.disableCSSOMInjection,t.sheet,t.target,r]),s=(0,n.useMemo)((function(){return qn({options:{namespace:t.namespace,prefix:t.enableVendorPrefixes},plugins:i})}),[t.enableVendorPrefixes,t.namespace,i]);(0,n.useEffect)((function(){Mt()(i,t.stylisPlugins)||a(t.stylisPlugins)}),[t.stylisPlugins]);var l=(0,n.useMemo)((function(){return{shouldForwardProp:t.shouldForwardProp,styleSheet:o,stylis:s}}),[t.shouldForwardProp,o,s]);return n.createElement(Hn.Provider,{value:l},n.createElement(Zn.Provider,{value:s},t.children))}var Kn=function(){function t(t,e){var n=this;this.inject=function(t,e){void 0===e&&(e=Wn);var i=n.name+e.hash;t.hasNameForId(n.id,i)||t.insertRules(n.id,i,e(n.rules,i,"@keyframes"))},this.name=t,this.id="sc-keyframes-".concat(t),this.rules=e,bn(this,(function(){throw wn(12,String(n.name))}))}return t.prototype.getName=function(t){return void 0===t&&(t=Wn),this.name+t.hash},t}(),Qn=function(t){return t>="A"&&t<="Z"};function Jn(t){for(var e="",n=0;n<t.length;n++){var i=t[n];if(1===n&&"-"===i&&"-"===t[0])return t;Qn(i)?e+="-"+i.toLowerCase():e+=i}return e.startsWith("ms-")?"-"+e:e}var ti=function(t){return null==t||!1===t||""===t},ei=function(t){var e,n,i=[];for(var a in t){var r=t[a];t.hasOwnProperty(a)&&!ti(r)&&(Array.isArray(r)&&r.isCss||mn(r)?i.push("".concat(Jn(a),":"),r,";"):xn(r)?i.push.apply(i,Tt(Tt(["".concat(a," {")],ei(r),!1),["}"],!1)):i.push("".concat(Jn(a),": ").concat((e=a,null==(n=r)||"boolean"==typeof n||""===n?"":"number"!=typeof n||0===n||e in Se||e.startsWith("--")?String(n).trim():"".concat(n,"px")),";")))}return i};function ni(t,e,n,i){return ti(t)?[]:gn(t)?[".".concat(t.styledComponentId)]:mn(t)?!mn(a=t)||a.prototype&&a.prototype.isReactComponent||!e?[t]:ni(t(e),e,n,i):t instanceof Kn?n?(t.inject(n,i),[t.getName(i)]):[t]:xn(t)?ei(t):Array.isArray(t)?Array.prototype.concat.apply(Oe,t.map((function(t){return ni(t,e,n,i)}))):[t.toString()];var a}function ii(t){for(var e=0;e<t.length;e+=1){var n=t[e];if(mn(n)&&!gn(n))return!1}return!0}var ai=Xe(Pe),ri=function(){function t(t,e,n){this.rules=t,this.staticRulesId="",this.isStatic=(void 0===n||n.isStatic)&&ii(t),this.componentId=e,this.baseHash=Ye(ai,e),this.baseStyle=n,jn.registerId(e)}return t.prototype.generateAndInjectStyles=function(t,e,n){var i=this.baseStyle?this.baseStyle.generateAndInjectStyles(t,e,n):"";if(this.isStatic&&!n.hash)if(this.staticRulesId&&e.hasNameForId(this.componentId,this.staticRulesId))i=_n(i,this.staticRulesId);else{var a=yn(ni(this.rules,t,e,n)),r=We(Ye(this.baseHash,a)>>>0);if(!e.hasNameForId(this.componentId,r)){var o=n(a,".".concat(r),void 0,this.componentId);e.insertRules(this.componentId,r,o)}i=_n(i,r),this.staticRulesId=r}else{for(var s=Ye(this.baseHash,n.hash),l="",c=0;c<this.rules.length;c++){var u=this.rules[c];if("string"==typeof u)l+=u;else if(u){var h=yn(ni(u,t,e,n));s=Ye(s,h+c),l+=h}}if(l){var d=We(s>>>0);e.hasNameForId(this.componentId,d)||e.insertRules(this.componentId,d,n(l,".".concat(d),void 0,this.componentId)),i=_n(i,d)}}return i},t}(),oi=n.createContext(void 0);function si(t){var e=n.useContext(oi),i=(0,n.useMemo)((function(){return function(t,e){if(!t)throw wn(14);if(mn(t))return t(e);if(Array.isArray(t)||"object"!=typeof t)throw wn(8);return e?Et(Et({},e),t):t}(t.theme,e)}),[t.theme,e]);return t.children?n.createElement(oi.Provider,{value:i},t.children):null}oi.Consumer;var li={};function ci(t,e,i){var a=gn(t),r=t,o=!Qe(t),s=e.attrs,l=void 0===s?Oe:s,c=e.componentId,u=void 0===c?function(t,e){var n="string"!=typeof t?"sc":Ue(t);li[n]=(li[n]||0)+1;var i="".concat(n,"-").concat(Ke(Pe+n+li[n]));return e?"".concat(e,"-").concat(i):i}(e.displayName,e.parentComponentId):c,h=e.displayName,d=void 0===h?function(t){return Qe(t)?"styled.".concat(t):"Styled(".concat(function(t){return t.displayName||t.name||"Component"}(t),")")}(t):h,p=e.displayName&&e.componentId?"".concat(Ue(e.displayName),"-").concat(e.componentId):e.componentId||u,f=a&&r.attrs?r.attrs.concat(l).filter(Boolean):l,m=e.shouldForwardProp;if(a&&r.shouldForwardProp){var g=r.shouldForwardProp;if(e.shouldForwardProp){var _=e.shouldForwardProp;m=function(t,e){return g(t,e)&&_(t,e)}}else m=g}var y=new ri(i,p,a?r.componentStyle:void 0);function x(t,e){return function(t,e,i){var a=t.attrs,r=t.componentStyle,o=t.defaultProps,s=t.foldedComponentIds,l=t.styledComponentId,c=t.target,u=n.useContext(oi),h=Yn(),d=t.shouldForwardProp||h.shouldForwardProp,p=Fe(e,u,o)||Re,f=function(t,e,n){for(var i,a=Et(Et({},e),{className:void 0,theme:n}),r=0;r<t.length;r+=1){var o=mn(i=t[r])?i(a):i;for(var s in o)a[s]="className"===s?_n(a[s],o[s]):"style"===s?Et(Et({},a[s]),o[s]):o[s]}return e.className&&(a.className=_n(a.className,e.className)),a}(a,e,p),m=f.as||c,g={};for(var _ in f)void 0===f[_]||"$"===_[0]||"as"===_||"theme"===_&&f.theme===p||("forwardedAs"===_?g.as=f.forwardedAs:d&&!d(_,m)||(g[_]=f[_]));var y=function(t,e){var n=Yn();return t.generateAndInjectStyles(e,n.styleSheet,n.stylis)}(r,f),x=_n(s,l);return y&&(x+=" "+y),f.className&&(x+=" "+f.className),g[Qe(m)&&!Ne.has(m)?"class":"className"]=x,g.ref=i,(0,n.createElement)(m,g)}(v,t,e)}x.displayName=d;var v=n.forwardRef(x);return v.attrs=f,v.componentStyle=y,v.displayName=d,v.shouldForwardProp=m,v.foldedComponentIds=a?_n(r.foldedComponentIds,r.styledComponentId):"",v.styledComponentId=p,v.target=a?r.target:t,Object.defineProperty(v,"defaultProps",{get:function(){return this._foldedDefaultProps},set:function(t){this._foldedDefaultProps=a?function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var i=0,a=e;i<a.length;i++)vn(t,a[i],!0);return t}({},r.defaultProps,t):t}}),bn(v,(function(){return".".concat(v.styledComponentId)})),o&&fn(v,t,{attrs:!0,componentStyle:!0,displayName:!0,foldedComponentIds:!0,shouldForwardProp:!0,styledComponentId:!0,target:!0}),v}function ui(t,e){for(var n=[t[0]],i=0,a=e.length;i<a;i+=1)n.push(e[i],t[i+1]);return n}new Set;var hi=function(t){return Object.assign(t,{isCss:!0})};function di(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(mn(t)||xn(t))return hi(ni(ui(Oe,Tt([t],e,!0))));var i=t;return 0===e.length&&1===i.length&&"string"==typeof i[0]?ni(i):hi(ni(ui(i,e)))}function pi(t,e,n){if(void 0===n&&(n=Re),!e)throw wn(1,e);var i=function(i){for(var a=[],r=1;r<arguments.length;r++)a[r-1]=arguments[r];return t(e,n,di.apply(void 0,Tt([i],a,!1)))};return i.attrs=function(i){return pi(t,e,Et(Et({},n),{attrs:Array.prototype.concat(n.attrs,i).filter(Boolean)}))},i.withConfig=function(i){return pi(t,e,Et(Et({},n),i))},i}var fi=function(t){return pi(ci,t)},mi=fi;Ne.forEach((function(t){mi[t]=fi(t)}));var gi=function(){function t(t,e){this.rules=t,this.componentId=e,this.isStatic=ii(t),jn.registerId(this.componentId+1)}return t.prototype.createStyles=function(t,e,n,i){var a=i(yn(ni(this.rules,e,n,i)),""),r=this.componentId+t;n.insertRules(r,r,a)},t.prototype.removeStyles=function(t,e){e.clearRules(this.componentId+t)},t.prototype.renderStyles=function(t,e,n,i){t>2&&jn.registerId(this.componentId+t),this.removeStyles(t,n),this.createStyles(t,e,n,i)},t}();function _i(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var i=yn(di.apply(void 0,Tt([t],e,!1))),a=Ke(i);return new Kn(a,i)}(function(){function t(){var t=this;this._emitSheetCSS=function(){var e=t.instance.toString(),n=Dn(),i=yn([n&&'nonce="'.concat(n,'"'),"".concat(Me,'="true"'),"".concat(Ie,'="').concat(Pe,'"')].filter(Boolean)," ");return"<style ".concat(i,">").concat(e,"</style>")},this.getStyleTags=function(){if(t.sealed)throw wn(2);return t._emitSheetCSS()},this.getStyleElement=function(){var e;if(t.sealed)throw wn(2);var i=((e={})[Me]="",e[Ie]=Pe,e.dangerouslySetInnerHTML={__html:t.instance.toString()},e),a=Dn();return a&&(i.nonce=a),[n.createElement("style",Et({},i,{key:"sc-0-0"}))]},this.seal=function(){t.sealed=!0},this.instance=new jn({isServer:!0}),this.sealed=!1}t.prototype.collectStyles=function(t){if(this.sealed)throw wn(2);return n.createElement(Xn,{sheet:this.instance},t)},t.prototype.interleaveWithNodeStream=function(t){throw wn(3)}})(),"__sc-".concat(Me,"__");const yi={bodyBackground:"rgba(255, 255, 255, 1)",bodyColor:"rgba(0, 0, 0, 1)",textColor:"rgba(0, 0, 0, 1)",nameColor:"rgba(255, 255, 255, 1)",CardBackground:"rgba(74, 74, 79, 1)",сurrencyName:"rgba(0, 0, 0, 1)",searchBackground:"rgba(60, 58, 63, 1)",headerBackground:"linear-gradient(45deg, #fcfcfc 9%, rgba(0, 188, 79, 0.1803571770505077) 50%, #fcfcfc 89%)"},xi={bodyBackground:"rgba(3, 3, 4, 1)",bodyColor:"rgba(217, 217, 217, 0.851)",textColor:"rgba(217, 217, 217, 1)",nameColor:"rgba(255, 255, 255, 1)",CardBackground:"rgba(32, 32, 37, 1)",сurrencyName:"rgba(217, 217, 217, 1)",searchBackground:"rgba(27, 32, 40, 1)",headerBackground:"linear-gradient(50deg, rgba(3, 3, 4, 1) 9%, rgba(0, 188, 79, 0.1803571770505077) 50%, rgba(3, 3, 4, 1) 89%)"},vi={spacing:{small:"8px",medium:"16px",large:"32px",xlarge:"64px"},fontSize:{h1:"32px",h1Mobile:"28px",p:"30px",pMobile:"26px",pSmall:"16px"},borderRadius:{small:"8px"}},bi=function(t,e){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const[a,r]=(0,n.useState)((()=>{try{const n=localStorage.getItem(t);return n?JSON.parse(n):e}catch(n){return console.error('Error reading localStorage key "'.concat(t,'":'),n),e}})),o=(0,n.useCallback)((e=>{try{r(e),localStorage.setItem(t,JSON.stringify(e))}catch(e){console.error('Error setting localStorage key "'.concat(t,'":'),e)}}),[t]);return(0,n.useEffect)((()=>{if(i)try{localStorage.setItem(t,JSON.stringify(a))}catch(e){console.error('Error syncing localStorage key "'.concat(t,'":'),e)}}),[a,t,i]),(0,n.useEffect)((()=>{const n=n=>{if(n.key===t)try{r(n.newValue?JSON.parse(n.newValue):e)}catch(e){console.error('Error reading localStorage key "'.concat(t,'" from event:'),e)}};return window.addEventListener("storage",n),()=>{window.removeEventListener("storage",n)}}),[t,e]),[a,o]};var wi=a(182),Ai=a.n(wi);const Ci=(0,n.createContext)(),Ei=t=>{let{children:e}=t;const[i,a]=bi(!0,"theme",!0),r=i?xi:yi,o=Ai()({},vi,r);return n.createElement(Ci.Provider,{value:{isDarkTheme:i,toggleTheme:()=>{a((t=>!t))}}},n.createElement(si,{theme:o},e))};var Ti;const Si=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];var a=di.apply(void 0,Tt([t],e,!1)),r="sc-global-".concat(Ke(JSON.stringify(a))),o=new gi(a,r),s=function(t){var e=Yn(),i=n.useContext(oi),a=n.useRef(e.styleSheet.allocateGSInstance(r)).current;return e.styleSheet.server&&l(a,t,e.styleSheet,i,e.stylis),n.useLayoutEffect((function(){if(!e.styleSheet.server)return l(a,t,e.styleSheet,i,e.stylis),function(){return o.removeStyles(a,e.styleSheet)}}),[a,t,e.styleSheet,i,e.stylis]),null};function l(t,e,n,i,a){if(o.isStatic)o.renderStyles(t,Be,n,a);else{var r=Et(Et({},e),{theme:Fe(e,i,s.defaultProps)});o.renderStyles(t,r,n,a)}}return n.memo(s)}(Ti||(Mi=["\n\n  body {\n    font-family: 'Poppins', sans-serif;\n    background: ",";\n    color: ",";\n  }\n\n  p, h1, h2, h3, h4, h5, h6, a {\n    color: ",";\n  }\n\n"],ki||(ki=Mi.slice(0)),Ti=Object.freeze(Object.defineProperties(Mi,{raw:{value:Object.freeze(ki)}}))),(t=>{let{theme:e}=t;return e.bodyBackground}),(t=>{let{theme:e}=t;return e.bodyColor}),(t=>{let{theme:e}=t;return e.textColor}));var Mi,ki;function Ii(t,e){return function(){return t.apply(e,arguments)}}const{toString:Pi}=Object.prototype,{getPrototypeOf:zi}=Object,Di=(Li=Object.create(null),t=>{const e=Pi.call(t);return Li[e]||(Li[e]=e.slice(8,-1).toLowerCase())});var Li;const Bi=t=>(t=t.toLowerCase(),e=>Di(e)===t),Oi=t=>e=>typeof e===t,{isArray:Ri}=Array,Fi=Oi("undefined"),Ni=Bi("ArrayBuffer"),ji=Oi("string"),Vi=Oi("function"),Ui=Oi("number"),Gi=t=>null!==t&&"object"==typeof t,qi=t=>{if("object"!==Di(t))return!1;const e=zi(t);return!(null!==e&&e!==Object.prototype&&null!==Object.getPrototypeOf(e)||Symbol.toStringTag in t||Symbol.iterator in t)},$i=Bi("Date"),Wi=Bi("File"),Hi=Bi("Blob"),Zi=Bi("FileList"),Yi=Bi("URLSearchParams"),[Xi,Ki,Qi,Ji]=["ReadableStream","Request","Response","Headers"].map(Bi);function ta(t,e,{allOwnKeys:n=!1}={}){if(null==t)return;let i,a;if("object"!=typeof t&&(t=[t]),Ri(t))for(i=0,a=t.length;i<a;i++)e.call(null,t[i],i,t);else{const a=n?Object.getOwnPropertyNames(t):Object.keys(t),r=a.length;let o;for(i=0;i<r;i++)o=a[i],e.call(null,t[o],o,t)}}function ea(t,e){e=e.toLowerCase();const n=Object.keys(t);let i,a=n.length;for(;a-- >0;)if(i=n[a],e===i.toLowerCase())return i;return null}const na="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:global,ia=t=>!Fi(t)&&t!==na,aa=(ra="undefined"!=typeof Uint8Array&&zi(Uint8Array),t=>ra&&t instanceof ra);var ra;const oa=Bi("HTMLFormElement"),sa=(({hasOwnProperty:t})=>(e,n)=>t.call(e,n))(Object.prototype),la=Bi("RegExp"),ca=(t,e)=>{const n=Object.getOwnPropertyDescriptors(t),i={};ta(n,((n,a)=>{let r;!1!==(r=e(n,a,t))&&(i[a]=r||n)})),Object.defineProperties(t,i)},ua="abcdefghijklmnopqrstuvwxyz",ha="0123456789",da={DIGIT:ha,ALPHA:ua,ALPHA_DIGIT:ua+ua.toUpperCase()+ha},pa=Bi("AsyncFunction"),fa={isArray:Ri,isArrayBuffer:Ni,isBuffer:function(t){return null!==t&&!Fi(t)&&null!==t.constructor&&!Fi(t.constructor)&&Vi(t.constructor.isBuffer)&&t.constructor.isBuffer(t)},isFormData:t=>{let e;return t&&("function"==typeof FormData&&t instanceof FormData||Vi(t.append)&&("formdata"===(e=Di(t))||"object"===e&&Vi(t.toString)&&"[object FormData]"===t.toString()))},isArrayBufferView:function(t){let e;return e="undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(t):t&&t.buffer&&Ni(t.buffer),e},isString:ji,isNumber:Ui,isBoolean:t=>!0===t||!1===t,isObject:Gi,isPlainObject:qi,isReadableStream:Xi,isRequest:Ki,isResponse:Qi,isHeaders:Ji,isUndefined:Fi,isDate:$i,isFile:Wi,isBlob:Hi,isRegExp:la,isFunction:Vi,isStream:t=>Gi(t)&&Vi(t.pipe),isURLSearchParams:Yi,isTypedArray:aa,isFileList:Zi,forEach:ta,merge:function t(){const{caseless:e}=ia(this)&&this||{},n={},i=(i,a)=>{const r=e&&ea(n,a)||a;qi(n[r])&&qi(i)?n[r]=t(n[r],i):qi(i)?n[r]=t({},i):Ri(i)?n[r]=i.slice():n[r]=i};for(let t=0,e=arguments.length;t<e;t++)arguments[t]&&ta(arguments[t],i);return n},extend:(t,e,n,{allOwnKeys:i}={})=>(ta(e,((e,i)=>{n&&Vi(e)?t[i]=Ii(e,n):t[i]=e}),{allOwnKeys:i}),t),trim:t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),stripBOM:t=>(65279===t.charCodeAt(0)&&(t=t.slice(1)),t),inherits:(t,e,n,i)=>{t.prototype=Object.create(e.prototype,i),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:e.prototype}),n&&Object.assign(t.prototype,n)},toFlatObject:(t,e,n,i)=>{let a,r,o;const s={};if(e=e||{},null==t)return e;do{for(a=Object.getOwnPropertyNames(t),r=a.length;r-- >0;)o=a[r],i&&!i(o,t,e)||s[o]||(e[o]=t[o],s[o]=!0);t=!1!==n&&zi(t)}while(t&&(!n||n(t,e))&&t!==Object.prototype);return e},kindOf:Di,kindOfTest:Bi,endsWith:(t,e,n)=>{t=String(t),(void 0===n||n>t.length)&&(n=t.length),n-=e.length;const i=t.indexOf(e,n);return-1!==i&&i===n},toArray:t=>{if(!t)return null;if(Ri(t))return t;let e=t.length;if(!Ui(e))return null;const n=new Array(e);for(;e-- >0;)n[e]=t[e];return n},forEachEntry:(t,e)=>{const n=(t&&t[Symbol.iterator]).call(t);let i;for(;(i=n.next())&&!i.done;){const n=i.value;e.call(t,n[0],n[1])}},matchAll:(t,e)=>{let n;const i=[];for(;null!==(n=t.exec(e));)i.push(n);return i},isHTMLForm:oa,hasOwnProperty:sa,hasOwnProp:sa,reduceDescriptors:ca,freezeMethods:t=>{ca(t,((e,n)=>{if(Vi(t)&&-1!==["arguments","caller","callee"].indexOf(n))return!1;const i=t[n];Vi(i)&&(e.enumerable=!1,"writable"in e?e.writable=!1:e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")}))}))},toObjectSet:(t,e)=>{const n={},i=t=>{t.forEach((t=>{n[t]=!0}))};return Ri(t)?i(t):i(String(t).split(e)),n},toCamelCase:t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,(function(t,e,n){return e.toUpperCase()+n})),noop:()=>{},toFiniteNumber:(t,e)=>null!=t&&Number.isFinite(t=+t)?t:e,findKey:ea,global:na,isContextDefined:ia,ALPHABET:da,generateString:(t=16,e=da.ALPHA_DIGIT)=>{let n="";const{length:i}=e;for(;t--;)n+=e[Math.random()*i|0];return n},isSpecCompliantForm:function(t){return!!(t&&Vi(t.append)&&"FormData"===t[Symbol.toStringTag]&&t[Symbol.iterator])},toJSONObject:t=>{const e=new Array(10),n=(t,i)=>{if(Gi(t)){if(e.indexOf(t)>=0)return;if(!("toJSON"in t)){e[i]=t;const a=Ri(t)?[]:{};return ta(t,((t,e)=>{const r=n(t,i+1);!Fi(r)&&(a[e]=r)})),e[i]=void 0,a}}return t};return n(t,0)},isAsyncFn:pa,isThenable:t=>t&&(Gi(t)||Vi(t))&&Vi(t.then)&&Vi(t.catch)};function ma(t,e,n,i,a){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack,this.message=t,this.name="AxiosError",e&&(this.code=e),n&&(this.config=n),i&&(this.request=i),a&&(this.response=a)}fa.inherits(ma,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:fa.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});const ga=ma.prototype,_a={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach((t=>{_a[t]={value:t}})),Object.defineProperties(ma,_a),Object.defineProperty(ga,"isAxiosError",{value:!0}),ma.from=(t,e,n,i,a,r)=>{const o=Object.create(ga);return fa.toFlatObject(t,o,(function(t){return t!==Error.prototype}),(t=>"isAxiosError"!==t)),ma.call(o,t.message,e,n,i,a),o.cause=t,o.name=t.name,r&&Object.assign(o,r),o};const ya=ma;function xa(t){return fa.isPlainObject(t)||fa.isArray(t)}function va(t){return fa.endsWith(t,"[]")?t.slice(0,-2):t}function ba(t,e,n){return t?t.concat(e).map((function(t,e){return t=va(t),!n&&e?"["+t+"]":t})).join(n?".":""):e}const wa=fa.toFlatObject(fa,{},null,(function(t){return/^is[A-Z]/.test(t)})),Aa=function(t,e,n){if(!fa.isObject(t))throw new TypeError("target must be an object");e=e||new FormData;const i=(n=fa.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,(function(t,e){return!fa.isUndefined(e[t])}))).metaTokens,a=n.visitor||c,r=n.dots,o=n.indexes,s=(n.Blob||"undefined"!=typeof Blob&&Blob)&&fa.isSpecCompliantForm(e);if(!fa.isFunction(a))throw new TypeError("visitor must be a function");function l(t){if(null===t)return"";if(fa.isDate(t))return t.toISOString();if(!s&&fa.isBlob(t))throw new ya("Blob is not supported. Use a Buffer instead.");return fa.isArrayBuffer(t)||fa.isTypedArray(t)?s&&"function"==typeof Blob?new Blob([t]):Buffer.from(t):t}function c(t,n,a){let s=t;if(t&&!a&&"object"==typeof t)if(fa.endsWith(n,"{}"))n=i?n:n.slice(0,-2),t=JSON.stringify(t);else if(fa.isArray(t)&&function(t){return fa.isArray(t)&&!t.some(xa)}(t)||(fa.isFileList(t)||fa.endsWith(n,"[]"))&&(s=fa.toArray(t)))return n=va(n),s.forEach((function(t,i){!fa.isUndefined(t)&&null!==t&&e.append(!0===o?ba([n],i,r):null===o?n:n+"[]",l(t))})),!1;return!!xa(t)||(e.append(ba(a,n,r),l(t)),!1)}const u=[],h=Object.assign(wa,{defaultVisitor:c,convertValue:l,isVisitable:xa});if(!fa.isObject(t))throw new TypeError("data must be an object");return function t(n,i){if(!fa.isUndefined(n)){if(-1!==u.indexOf(n))throw Error("Circular reference detected in "+i.join("."));u.push(n),fa.forEach(n,(function(n,r){!0===(!(fa.isUndefined(n)||null===n)&&a.call(e,n,fa.isString(r)?r.trim():r,i,h))&&t(n,i?i.concat(r):[r])})),u.pop()}}(t),e};function Ca(t){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,(function(t){return e[t]}))}function Ea(t,e){this._pairs=[],t&&Aa(t,this,e)}const Ta=Ea.prototype;Ta.append=function(t,e){this._pairs.push([t,e])},Ta.toString=function(t){const e=t?function(e){return t.call(this,e,Ca)}:Ca;return this._pairs.map((function(t){return e(t[0])+"="+e(t[1])}),"").join("&")};const Sa=Ea;function Ma(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function ka(t,e,n){if(!e)return t;const i=n&&n.encode||Ma,a=n&&n.serialize;let r;if(r=a?a(e,n):fa.isURLSearchParams(e)?e.toString():new Sa(e,n).toString(i),r){const e=t.indexOf("#");-1!==e&&(t=t.slice(0,e)),t+=(-1===t.indexOf("?")?"?":"&")+r}return t}const Ia=class{constructor(){this.handlers=[]}use(t,e,n){return this.handlers.push({fulfilled:t,rejected:e,synchronous:!!n&&n.synchronous,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){fa.forEach(this.handlers,(function(e){null!==e&&t(e)}))}},Pa={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},za={isBrowser:!0,classes:{URLSearchParams:"undefined"!=typeof URLSearchParams?URLSearchParams:Sa,FormData:"undefined"!=typeof FormData?FormData:null,Blob:"undefined"!=typeof Blob?Blob:null},protocols:["http","https","file","blob","url","data"]},Da="undefined"!=typeof window&&"undefined"!=typeof document,La=(Ba="undefined"!=typeof navigator&&navigator.product,Da&&["ReactNative","NativeScript","NS"].indexOf(Ba)<0);var Ba;const Oa="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&"function"==typeof self.importScripts,Ra=Da&&window.location.href||"http://localhost",Fa={...t,...za},Na=function(t){function e(t,n,i,a){let r=t[a++];if("__proto__"===r)return!0;const o=Number.isFinite(+r),s=a>=t.length;return r=!r&&fa.isArray(i)?i.length:r,s?(fa.hasOwnProp(i,r)?i[r]=[i[r],n]:i[r]=n,!o):(i[r]&&fa.isObject(i[r])||(i[r]=[]),e(t,n,i[r],a)&&fa.isArray(i[r])&&(i[r]=function(t){const e={},n=Object.keys(t);let i;const a=n.length;let r;for(i=0;i<a;i++)r=n[i],e[r]=t[r];return e}(i[r])),!o)}if(fa.isFormData(t)&&fa.isFunction(t.entries)){const n={};return fa.forEachEntry(t,((t,i)=>{e(function(t){return fa.matchAll(/\w+|\[(\w*)]/g,t).map((t=>"[]"===t[0]?"":t[1]||t[0]))}(t),i,n,0)})),n}return null},ja={transitional:Pa,adapter:["xhr","http","fetch"],transformRequest:[function(t,e){const n=e.getContentType()||"",i=n.indexOf("application/json")>-1,a=fa.isObject(t);if(a&&fa.isHTMLForm(t)&&(t=new FormData(t)),fa.isFormData(t))return i?JSON.stringify(Na(t)):t;if(fa.isArrayBuffer(t)||fa.isBuffer(t)||fa.isStream(t)||fa.isFile(t)||fa.isBlob(t)||fa.isReadableStream(t))return t;if(fa.isArrayBufferView(t))return t.buffer;if(fa.isURLSearchParams(t))return e.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let r;if(a){if(n.indexOf("application/x-www-form-urlencoded")>-1)return function(t,e){return Aa(t,new Fa.classes.URLSearchParams,Object.assign({visitor:function(t,e,n,i){return Fa.isNode&&fa.isBuffer(t)?(this.append(e,t.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)}},e))}(t,this.formSerializer).toString();if((r=fa.isFileList(t))||n.indexOf("multipart/form-data")>-1){const e=this.env&&this.env.FormData;return Aa(r?{"files[]":t}:t,e&&new e,this.formSerializer)}}return a||i?(e.setContentType("application/json",!1),function(t,e,n){if(fa.isString(t))try{return(0,JSON.parse)(t),fa.trim(t)}catch(t){if("SyntaxError"!==t.name)throw t}return(0,JSON.stringify)(t)}(t)):t}],transformResponse:[function(t){const e=this.transitional||ja.transitional,n=e&&e.forcedJSONParsing,i="json"===this.responseType;if(fa.isResponse(t)||fa.isReadableStream(t))return t;if(t&&fa.isString(t)&&(n&&!this.responseType||i)){const n=!(e&&e.silentJSONParsing)&&i;try{return JSON.parse(t)}catch(t){if(n){if("SyntaxError"===t.name)throw ya.from(t,ya.ERR_BAD_RESPONSE,this,null,this.response);throw t}}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Fa.classes.FormData,Blob:Fa.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};fa.forEach(["delete","get","head","post","put","patch"],(t=>{ja.headers[t]={}}));const Va=ja,Ua=fa.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Ga=Symbol("internals");function qa(t){return t&&String(t).trim().toLowerCase()}function $a(t){return!1===t||null==t?t:fa.isArray(t)?t.map($a):String(t)}function Wa(t,e,n,i,a){return fa.isFunction(i)?i.call(this,e,n):(a&&(e=n),fa.isString(e)?fa.isString(i)?-1!==e.indexOf(i):fa.isRegExp(i)?i.test(e):void 0:void 0)}class Ha{constructor(t){t&&this.set(t)}set(t,e,n){const i=this;function a(t,e,n){const a=qa(e);if(!a)throw new Error("header name must be a non-empty string");const r=fa.findKey(i,a);(!r||void 0===i[r]||!0===n||void 0===n&&!1!==i[r])&&(i[r||e]=$a(t))}const r=(t,e)=>fa.forEach(t,((t,n)=>a(t,n,e)));if(fa.isPlainObject(t)||t instanceof this.constructor)r(t,e);else if(fa.isString(t)&&(t=t.trim())&&!/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim()))r((t=>{const e={};let n,i,a;return t&&t.split("\n").forEach((function(t){a=t.indexOf(":"),n=t.substring(0,a).trim().toLowerCase(),i=t.substring(a+1).trim(),!n||e[n]&&Ua[n]||("set-cookie"===n?e[n]?e[n].push(i):e[n]=[i]:e[n]=e[n]?e[n]+", "+i:i)})),e})(t),e);else if(fa.isHeaders(t))for(const[e,i]of t.entries())a(i,e,n);else null!=t&&a(e,t,n);return this}get(t,e){if(t=qa(t)){const n=fa.findKey(this,t);if(n){const t=this[n];if(!e)return t;if(!0===e)return function(t){const e=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let i;for(;i=n.exec(t);)e[i[1]]=i[2];return e}(t);if(fa.isFunction(e))return e.call(this,t,n);if(fa.isRegExp(e))return e.exec(t);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,e){if(t=qa(t)){const n=fa.findKey(this,t);return!(!n||void 0===this[n]||e&&!Wa(0,this[n],n,e))}return!1}delete(t,e){const n=this;let i=!1;function a(t){if(t=qa(t)){const a=fa.findKey(n,t);!a||e&&!Wa(0,n[a],a,e)||(delete n[a],i=!0)}}return fa.isArray(t)?t.forEach(a):a(t),i}clear(t){const e=Object.keys(this);let n=e.length,i=!1;for(;n--;){const a=e[n];t&&!Wa(0,this[a],a,t,!0)||(delete this[a],i=!0)}return i}normalize(t){const e=this,n={};return fa.forEach(this,((i,a)=>{const r=fa.findKey(n,a);if(r)return e[r]=$a(i),void delete e[a];const o=t?function(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,((t,e,n)=>e.toUpperCase()+n))}(a):String(a).trim();o!==a&&delete e[a],e[o]=$a(i),n[o]=!0})),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const e=Object.create(null);return fa.forEach(this,((n,i)=>{null!=n&&!1!==n&&(e[i]=t&&fa.isArray(n)?n.join(", "):n)})),e}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map((([t,e])=>t+": "+e)).join("\n")}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...e){const n=new this(t);return e.forEach((t=>n.set(t))),n}static accessor(t){const e=(this[Ga]=this[Ga]={accessors:{}}).accessors,n=this.prototype;function i(t){const i=qa(t);e[i]||(function(t,e){const n=fa.toCamelCase(" "+e);["get","set","has"].forEach((i=>{Object.defineProperty(t,i+n,{value:function(t,n,a){return this[i].call(this,e,t,n,a)},configurable:!0})}))}(n,t),e[i]=!0)}return fa.isArray(t)?t.forEach(i):i(t),this}}Ha.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),fa.reduceDescriptors(Ha.prototype,(({value:t},e)=>{let n=e[0].toUpperCase()+e.slice(1);return{get:()=>t,set(t){this[n]=t}}})),fa.freezeMethods(Ha);const Za=Ha;function Ya(t,e){const n=this||Va,i=e||n,a=Za.from(i.headers);let r=i.data;return fa.forEach(t,(function(t){r=t.call(n,r,a.normalize(),e?e.status:void 0)})),a.normalize(),r}function Xa(t){return!(!t||!t.__CANCEL__)}function Ka(t,e,n){ya.call(this,null==t?"canceled":t,ya.ERR_CANCELED,e,n),this.name="CanceledError"}fa.inherits(Ka,ya,{__CANCEL__:!0});const Qa=Ka;function Ja(t,e,n){const i=n.config.validateStatus;n.status&&i&&!i(n.status)?e(new ya("Request failed with status code "+n.status,[ya.ERR_BAD_REQUEST,ya.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n)):t(n)}const tr=(t,e,n=3)=>{let i=0;const a=function(t,e){t=t||10;const n=new Array(t),i=new Array(t);let a,r=0,o=0;return e=void 0!==e?e:1e3,function(s){const l=Date.now(),c=i[o];a||(a=l),n[r]=s,i[r]=l;let u=o,h=0;for(;u!==r;)h+=n[u++],u%=t;if(r=(r+1)%t,r===o&&(o=(o+1)%t),l-a<e)return;const d=c&&l-c;return d?Math.round(1e3*h/d):void 0}}(50,250);return function(t,e){let n=0;const i=1e3/e;let a=null;return function(){const e=!0===this,r=Date.now();if(e||r-n>i)return a&&(clearTimeout(a),a=null),n=r,t.apply(null,arguments);a||(a=setTimeout((()=>(a=null,n=Date.now(),t.apply(null,arguments))),i-(r-n)))}}((n=>{const r=n.loaded,o=n.lengthComputable?n.total:void 0,s=r-i,l=a(s);i=r;const c={loaded:r,total:o,progress:o?r/o:void 0,bytes:s,rate:l||void 0,estimated:l&&o&&r<=o?(o-r)/l:void 0,event:n,lengthComputable:null!=o};c[e?"download":"upload"]=!0,t(c)}),n)},er=Fa.hasStandardBrowserEnv?function(){const t=/(msie|trident)/i.test(navigator.userAgent),e=document.createElement("a");let n;function i(n){let i=n;return t&&(e.setAttribute("href",i),i=e.href),e.setAttribute("href",i),{href:e.href,protocol:e.protocol?e.protocol.replace(/:$/,""):"",host:e.host,search:e.search?e.search.replace(/^\?/,""):"",hash:e.hash?e.hash.replace(/^#/,""):"",hostname:e.hostname,port:e.port,pathname:"/"===e.pathname.charAt(0)?e.pathname:"/"+e.pathname}}return n=i(window.location.href),function(t){const e=fa.isString(t)?i(t):t;return e.protocol===n.protocol&&e.host===n.host}}():function(){return!0},nr=Fa.hasStandardBrowserEnv?{write(t,e,n,i,a,r){const o=[t+"="+encodeURIComponent(e)];fa.isNumber(n)&&o.push("expires="+new Date(n).toGMTString()),fa.isString(i)&&o.push("path="+i),fa.isString(a)&&o.push("domain="+a),!0===r&&o.push("secure"),document.cookie=o.join("; ")},read(t){const e=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove(t){this.write(t,"",Date.now()-864e5)}}:{write(){},read:()=>null,remove(){}};function ir(t,e){return t&&!/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)?function(t,e){return e?t.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):t}(t,e):e}const ar=t=>t instanceof Za?{...t}:t;function rr(t,e){e=e||{};const n={};function i(t,e,n){return fa.isPlainObject(t)&&fa.isPlainObject(e)?fa.merge.call({caseless:n},t,e):fa.isPlainObject(e)?fa.merge({},e):fa.isArray(e)?e.slice():e}function a(t,e,n){return fa.isUndefined(e)?fa.isUndefined(t)?void 0:i(void 0,t,n):i(t,e,n)}function r(t,e){if(!fa.isUndefined(e))return i(void 0,e)}function o(t,e){return fa.isUndefined(e)?fa.isUndefined(t)?void 0:i(void 0,t):i(void 0,e)}function s(n,a,r){return r in e?i(n,a):r in t?i(void 0,n):void 0}const l={url:r,method:r,data:r,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:s,headers:(t,e)=>a(ar(t),ar(e),!0)};return fa.forEach(Object.keys(Object.assign({},t,e)),(function(i){const r=l[i]||a,o=r(t[i],e[i],i);fa.isUndefined(o)&&r!==s||(n[i]=o)})),n}const or=t=>{const e=rr({},t);let n,{data:i,withXSRFToken:a,xsrfHeaderName:r,xsrfCookieName:o,headers:s,auth:l}=e;if(e.headers=s=Za.from(s),e.url=ka(ir(e.baseURL,e.url),t.params,t.paramsSerializer),l&&s.set("Authorization","Basic "+btoa((l.username||"")+":"+(l.password?unescape(encodeURIComponent(l.password)):""))),fa.isFormData(i))if(Fa.hasStandardBrowserEnv||Fa.hasStandardBrowserWebWorkerEnv)s.setContentType(void 0);else if(!1!==(n=s.getContentType())){const[t,...e]=n?n.split(";").map((t=>t.trim())).filter(Boolean):[];s.setContentType([t||"multipart/form-data",...e].join("; "))}if(Fa.hasStandardBrowserEnv&&(a&&fa.isFunction(a)&&(a=a(e)),a||!1!==a&&er(e.url))){const t=r&&o&&nr.read(o);t&&s.set(r,t)}return e},sr="undefined"!=typeof XMLHttpRequest&&function(t){return new Promise((function(e,n){const i=or(t);let a=i.data;const r=Za.from(i.headers).normalize();let o,{responseType:s}=i;function l(){i.cancelToken&&i.cancelToken.unsubscribe(o),i.signal&&i.signal.removeEventListener("abort",o)}let c=new XMLHttpRequest;function u(){if(!c)return;const i=Za.from("getAllResponseHeaders"in c&&c.getAllResponseHeaders());Ja((function(t){e(t),l()}),(function(t){n(t),l()}),{data:s&&"text"!==s&&"json"!==s?c.response:c.responseText,status:c.status,statusText:c.statusText,headers:i,config:t,request:c}),c=null}c.open(i.method.toUpperCase(),i.url,!0),c.timeout=i.timeout,"onloadend"in c?c.onloadend=u:c.onreadystatechange=function(){c&&4===c.readyState&&(0!==c.status||c.responseURL&&0===c.responseURL.indexOf("file:"))&&setTimeout(u)},c.onabort=function(){c&&(n(new ya("Request aborted",ya.ECONNABORTED,i,c)),c=null)},c.onerror=function(){n(new ya("Network Error",ya.ERR_NETWORK,i,c)),c=null},c.ontimeout=function(){let t=i.timeout?"timeout of "+i.timeout+"ms exceeded":"timeout exceeded";const e=i.transitional||Pa;i.timeoutErrorMessage&&(t=i.timeoutErrorMessage),n(new ya(t,e.clarifyTimeoutError?ya.ETIMEDOUT:ya.ECONNABORTED,i,c)),c=null},void 0===a&&r.setContentType(null),"setRequestHeader"in c&&fa.forEach(r.toJSON(),(function(t,e){c.setRequestHeader(e,t)})),fa.isUndefined(i.withCredentials)||(c.withCredentials=!!i.withCredentials),s&&"json"!==s&&(c.responseType=i.responseType),"function"==typeof i.onDownloadProgress&&c.addEventListener("progress",tr(i.onDownloadProgress,!0)),"function"==typeof i.onUploadProgress&&c.upload&&c.upload.addEventListener("progress",tr(i.onUploadProgress)),(i.cancelToken||i.signal)&&(o=e=>{c&&(n(!e||e.type?new Qa(null,t,c):e),c.abort(),c=null)},i.cancelToken&&i.cancelToken.subscribe(o),i.signal&&(i.signal.aborted?o():i.signal.addEventListener("abort",o)));const h=function(t){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return e&&e[1]||""}(i.url);h&&-1===Fa.protocols.indexOf(h)?n(new ya("Unsupported protocol "+h+":",ya.ERR_BAD_REQUEST,t)):c.send(a||null)}))},lr=(t,e)=>{let n,i=new AbortController;const a=function(t){if(!n){n=!0,o();const e=t instanceof Error?t:this.reason;i.abort(e instanceof ya?e:new Qa(e instanceof Error?e.message:e))}};let r=e&&setTimeout((()=>{a(new ya(`timeout ${e} of ms exceeded`,ya.ETIMEDOUT))}),e);const o=()=>{t&&(r&&clearTimeout(r),r=null,t.forEach((t=>{t&&(t.removeEventListener?t.removeEventListener("abort",a):t.unsubscribe(a))})),t=null)};t.forEach((t=>t&&t.addEventListener&&t.addEventListener("abort",a)));const{signal:s}=i;return s.unsubscribe=o,[s,()=>{r&&clearTimeout(r),r=null}]},cr=function*(t,e){let n=t.byteLength;if(!e||n<e)return void(yield t);let i,a=0;for(;a<n;)i=a+e,yield t.slice(a,i),a=i},ur=(t,e,n,i,a)=>{const r=async function*(t,e,n){for await(const i of t)yield*cr(ArrayBuffer.isView(i)?i:await n(String(i)),e)}(t,e,a);let o=0;return new ReadableStream({type:"bytes",async pull(t){const{done:e,value:a}=await r.next();if(e)return t.close(),void i();let s=a.byteLength;n&&n(o+=s),t.enqueue(new Uint8Array(a))},cancel:t=>(i(t),r.return())},{highWaterMark:2})},hr=(t,e)=>{const n=null!=t;return i=>setTimeout((()=>e({lengthComputable:n,total:t,loaded:i})))},dr="function"==typeof fetch&&"function"==typeof Request&&"function"==typeof Response,pr=dr&&"function"==typeof ReadableStream,fr=dr&&("function"==typeof TextEncoder?(mr=new TextEncoder,t=>mr.encode(t)):async t=>new Uint8Array(await new Response(t).arrayBuffer()));var mr;const gr=pr&&(()=>{let t=!1;const e=new Request(Fa.origin,{body:new ReadableStream,method:"POST",get duplex(){return t=!0,"half"}}).headers.has("Content-Type");return t&&!e})(),_r=pr&&!!(()=>{try{return fa.isReadableStream(new Response("").body)}catch(t){}})(),yr={stream:_r&&(t=>t.body)};var xr;dr&&(xr=new Response,["text","arrayBuffer","blob","formData","stream"].forEach((t=>{!yr[t]&&(yr[t]=fa.isFunction(xr[t])?e=>e[t]():(e,n)=>{throw new ya(`Response type '${t}' is not supported`,ya.ERR_NOT_SUPPORT,n)})})));const vr=dr&&(async t=>{let{url:e,method:n,data:i,signal:a,cancelToken:r,timeout:o,onDownloadProgress:s,onUploadProgress:l,responseType:c,headers:u,withCredentials:h="same-origin",fetchOptions:d}=or(t);c=c?(c+"").toLowerCase():"text";let p,f,[m,g]=a||r||o?lr([a,r],o):[];const _=()=>{!p&&setTimeout((()=>{m&&m.unsubscribe()})),p=!0};let y;try{if(l&&gr&&"get"!==n&&"head"!==n&&0!==(y=await(async(t,e)=>{const n=fa.toFiniteNumber(t.getContentLength());return null==n?(async t=>null==t?0:fa.isBlob(t)?t.size:fa.isSpecCompliantForm(t)?(await new Request(t).arrayBuffer()).byteLength:fa.isArrayBufferView(t)?t.byteLength:(fa.isURLSearchParams(t)&&(t+=""),fa.isString(t)?(await fr(t)).byteLength:void 0))(e):n})(u,i))){let t,n=new Request(e,{method:"POST",body:i,duplex:"half"});fa.isFormData(i)&&(t=n.headers.get("content-type"))&&u.setContentType(t),n.body&&(i=ur(n.body,65536,hr(y,tr(l)),null,fr))}fa.isString(h)||(h=h?"cors":"omit"),f=new Request(e,{...d,signal:m,method:n.toUpperCase(),headers:u.normalize().toJSON(),body:i,duplex:"half",withCredentials:h});let a=await fetch(f);const r=_r&&("stream"===c||"response"===c);if(_r&&(s||r)){const t={};["status","statusText","headers"].forEach((e=>{t[e]=a[e]}));const e=fa.toFiniteNumber(a.headers.get("content-length"));a=new Response(ur(a.body,65536,s&&hr(e,tr(s,!0)),r&&_,fr),t)}c=c||"text";let o=await yr[fa.findKey(yr,c)||"text"](a,t);return!r&&_(),g&&g(),await new Promise(((e,n)=>{Ja(e,n,{data:o,headers:Za.from(a.headers),status:a.status,statusText:a.statusText,config:t,request:f})}))}catch(e){if(_(),e&&"TypeError"===e.name&&/fetch/i.test(e.message))throw Object.assign(new ya("Network Error",ya.ERR_NETWORK,t,f),{cause:e.cause||e});throw ya.from(e,e&&e.code,t,f)}}),br={http:null,xhr:sr,fetch:vr};fa.forEach(br,((t,e)=>{if(t){try{Object.defineProperty(t,"name",{value:e})}catch(t){}Object.defineProperty(t,"adapterName",{value:e})}}));const wr=t=>`- ${t}`,Ar=t=>fa.isFunction(t)||null===t||!1===t,Cr=t=>{t=fa.isArray(t)?t:[t];const{length:e}=t;let n,i;const a={};for(let r=0;r<e;r++){let e;if(n=t[r],i=n,!Ar(n)&&(i=br[(e=String(n)).toLowerCase()],void 0===i))throw new ya(`Unknown adapter '${e}'`);if(i)break;a[e||"#"+r]=i}if(!i){const t=Object.entries(a).map((([t,e])=>`adapter ${t} `+(!1===e?"is not supported by the environment":"is not available in the build")));let n=e?t.length>1?"since :\n"+t.map(wr).join("\n"):" "+wr(t[0]):"as no adapter specified";throw new ya("There is no suitable adapter to dispatch the request "+n,"ERR_NOT_SUPPORT")}return i};function Er(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new Qa(null,t)}function Tr(t){return Er(t),t.headers=Za.from(t.headers),t.data=Ya.call(t,t.transformRequest),-1!==["post","put","patch"].indexOf(t.method)&&t.headers.setContentType("application/x-www-form-urlencoded",!1),Cr(t.adapter||Va.adapter)(t).then((function(e){return Er(t),e.data=Ya.call(t,t.transformResponse,e),e.headers=Za.from(e.headers),e}),(function(e){return Xa(e)||(Er(t),e&&e.response&&(e.response.data=Ya.call(t,t.transformResponse,e.response),e.response.headers=Za.from(e.response.headers))),Promise.reject(e)}))}const Sr={};["object","boolean","number","function","string","symbol"].forEach(((t,e)=>{Sr[t]=function(n){return typeof n===t||"a"+(e<1?"n ":" ")+t}}));const Mr={};Sr.transitional=function(t,e,n){function i(t,e){return"[Axios v1.7.2] Transitional option '"+t+"'"+e+(n?". "+n:"")}return(n,a,r)=>{if(!1===t)throw new ya(i(a," has been removed"+(e?" in "+e:"")),ya.ERR_DEPRECATED);return e&&!Mr[a]&&(Mr[a]=!0,console.warn(i(a," has been deprecated since v"+e+" and will be removed in the near future"))),!t||t(n,a,r)}};const kr={assertOptions:function(t,e,n){if("object"!=typeof t)throw new ya("options must be an object",ya.ERR_BAD_OPTION_VALUE);const i=Object.keys(t);let a=i.length;for(;a-- >0;){const r=i[a],o=e[r];if(o){const e=t[r],n=void 0===e||o(e,r,t);if(!0!==n)throw new ya("option "+r+" must be "+n,ya.ERR_BAD_OPTION_VALUE)}else if(!0!==n)throw new ya("Unknown option "+r,ya.ERR_BAD_OPTION)}},validators:Sr},Ir=kr.validators;class Pr{constructor(t){this.defaults=t,this.interceptors={request:new Ia,response:new Ia}}async request(t,e){try{return await this._request(t,e)}catch(t){if(t instanceof Error){let e;Error.captureStackTrace?Error.captureStackTrace(e={}):e=new Error;const n=e.stack?e.stack.replace(/^.+\n/,""):"";try{t.stack?n&&!String(t.stack).endsWith(n.replace(/^.+\n.+\n/,""))&&(t.stack+="\n"+n):t.stack=n}catch(t){}}throw t}}_request(t,e){"string"==typeof t?(e=e||{}).url=t:e=t||{},e=rr(this.defaults,e);const{transitional:n,paramsSerializer:i,headers:a}=e;void 0!==n&&kr.assertOptions(n,{silentJSONParsing:Ir.transitional(Ir.boolean),forcedJSONParsing:Ir.transitional(Ir.boolean),clarifyTimeoutError:Ir.transitional(Ir.boolean)},!1),null!=i&&(fa.isFunction(i)?e.paramsSerializer={serialize:i}:kr.assertOptions(i,{encode:Ir.function,serialize:Ir.function},!0)),e.method=(e.method||this.defaults.method||"get").toLowerCase();let r=a&&fa.merge(a.common,a[e.method]);a&&fa.forEach(["delete","get","head","post","put","patch","common"],(t=>{delete a[t]})),e.headers=Za.concat(r,a);const o=[];let s=!0;this.interceptors.request.forEach((function(t){"function"==typeof t.runWhen&&!1===t.runWhen(e)||(s=s&&t.synchronous,o.unshift(t.fulfilled,t.rejected))}));const l=[];let c;this.interceptors.response.forEach((function(t){l.push(t.fulfilled,t.rejected)}));let u,h=0;if(!s){const t=[Tr.bind(this),void 0];for(t.unshift.apply(t,o),t.push.apply(t,l),u=t.length,c=Promise.resolve(e);h<u;)c=c.then(t[h++],t[h++]);return c}u=o.length;let d=e;for(h=0;h<u;){const t=o[h++],e=o[h++];try{d=t(d)}catch(t){e.call(this,t);break}}try{c=Tr.call(this,d)}catch(t){return Promise.reject(t)}for(h=0,u=l.length;h<u;)c=c.then(l[h++],l[h++]);return c}getUri(t){return ka(ir((t=rr(this.defaults,t)).baseURL,t.url),t.params,t.paramsSerializer)}}fa.forEach(["delete","get","head","options"],(function(t){Pr.prototype[t]=function(e,n){return this.request(rr(n||{},{method:t,url:e,data:(n||{}).data}))}})),fa.forEach(["post","put","patch"],(function(t){function e(e){return function(n,i,a){return this.request(rr(a||{},{method:t,headers:e?{"Content-Type":"multipart/form-data"}:{},url:n,data:i}))}}Pr.prototype[t]=e(),Pr.prototype[t+"Form"]=e(!0)}));const zr=Pr;class Dr{constructor(t){if("function"!=typeof t)throw new TypeError("executor must be a function.");let e;this.promise=new Promise((function(t){e=t}));const n=this;this.promise.then((t=>{if(!n._listeners)return;let e=n._listeners.length;for(;e-- >0;)n._listeners[e](t);n._listeners=null})),this.promise.then=t=>{let e;const i=new Promise((t=>{n.subscribe(t),e=t})).then(t);return i.cancel=function(){n.unsubscribe(e)},i},t((function(t,i,a){n.reason||(n.reason=new Qa(t,i,a),e(n.reason))}))}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){this.reason?t(this.reason):this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const e=this._listeners.indexOf(t);-1!==e&&this._listeners.splice(e,1)}static source(){let t;return{token:new Dr((function(e){t=e})),cancel:t}}}const Lr=Dr,Br={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Br).forEach((([t,e])=>{Br[e]=t}));const Or=Br,Rr=function t(e){const n=new zr(e),i=Ii(zr.prototype.request,n);return fa.extend(i,zr.prototype,n,{allOwnKeys:!0}),fa.extend(i,n,null,{allOwnKeys:!0}),i.create=function(n){return t(rr(e,n))},i}(Va);Rr.Axios=zr,Rr.CanceledError=Qa,Rr.CancelToken=Lr,Rr.isCancel=Xa,Rr.VERSION="1.7.2",Rr.toFormData=Aa,Rr.AxiosError=ya,Rr.Cancel=Rr.CanceledError,Rr.all=function(t){return Promise.all(t)},Rr.spread=function(t){return function(e){return t.apply(null,e)}},Rr.isAxiosError=function(t){return fa.isObject(t)&&!0===t.isAxiosError},Rr.mergeConfig=rr,Rr.AxiosHeaders=Za,Rr.formToJSON=t=>Na(fa.isHTMLForm(t)?new FormData(t):t),Rr.getAdapter=Cr,Rr.HttpStatusCode=Or,Rr.default=Rr;const Fr=Rr,Nr=["USD","CAD","AUD","EUR","GBP","ARS","JPY","CNY","BTC"],jr=Nr.reduce(((t,e)=>(t[e]=null,t)),{}),Vr=()=>{const[t,e]=bi("currentRates",jr),[i,a]=bi("lastUpdate",null),{data:r,error:o,fetchData:s}=(()=>{const[t,e]=(0,n.useState)(null),[i,a]=(0,n.useState)(null);return{data:t,error:i,fetchData:async()=>{try{const t=await Fr.get("https://api.currencyapi.com/v3/latest",{params:{apikey:"cur_live_oUXxBapGtYuIOAoXFx7AqDV6fwyKP4HLMntI5ZPJ",base_currency:"USD"}}),{data:n}=t,i=Nr.reduce(((t,e)=>(t[e]=n.data[e],t)),{});e(i)}catch(t){a(t)}}}})();return(0,n.useEffect)((()=>{const t=252e5,e=new Date;(!i||e-new Date(i)>t)&&s();const n=setInterval(s,t);return()=>clearInterval(n)}),[i,s]),(0,n.useEffect)((()=>{if(r){e(r);const t=new Date;a(t.toISOString())}}),[r,e,a]),(0,n.useEffect)((()=>{o&&console.error("Error fetching the currency data",o)}),[o]),{currencyRates:t,lastUpdate:i?(l=i,new Date(l).toLocaleString("en-US",{hour:"numeric",minute:"numeric",hour12:!0})):null};var l},Ur=a.p+"images/logo.png",Gr=a.p+"images/switchOff.png",qr=a.p+"images/switchOn.png",$r=a.p+"images/circleupdate.png",Wr=a.p+"images/menuIcon.png",Hr=a.p+"images/menuIcon-dark.png",Zr=a.p+"images/menuIcon-close.png";var Yr,Xr,Kr,Qr,Jr,to,eo,no,io,ao,ro,oo;function so(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}const lo=mi.header(Yr||(Yr=so([""]))),co=mi.div(Xr||(Xr=so(["\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n\n  img {\n    padding-left: 20px;\n  }\n"]))),uo=mi.div(Kr||(Kr=so(["\n  display: grid;\n  grid-template-columns: auto 1fr auto;\n  align-items: center;\n  gap: 20px;\n  @media (max-width: 450px) {\n    gap: 8px;\n  }\n"]))),ho=mi.div(Qr||(Qr=so(["\n  padding-right: 20px;\n  @media (max-width: 900px) {\n    padding-top: 8px;\n  }\n  @media (max-width: 450px) {\n    padding-left: 2px;\n    padding-top: 7px;\n  }\n"]))),po=mi.img(Jr||(Jr=so(["\n  max-width: 40px;\n  @media (max-width: 900px) {\n    max-width: 35px;\n  }\n"]))),fo=mi.div(to||(to=so(["\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  margin: 56px auto;\n  gap: 10px;\n"]))),mo=mi.p(eo||(eo=so(["\n  font-size: 32.91px;\n  font-weight: 300;\n  line-height: 41.14px;\n  @media (max-width: 900px) {\n    font-size: 26px;\n  }\n"]))),go=_i(no||(no=so(["\n  0% {\n    transform: scale(1);\n  }\n  50% {\n    transform: scale(1.2);\n  }\n  100% {\n    transform: scale(1);\n  }\n"]))),_o=mi.img(io||(io=so(["\n  animation: "," 2s infinite;\n  @media (max-width: 900px) {\n    max-width: 40px;\n  }\n"])),go),yo=mi.img(ao||(ao=so(["\n  z-index: 10;\n  max-width: 40px;\n  display: none;\n  cursor: pointer;\n  @media (max-width: 900px) {\n    display: block;\n    padding-left: 10px;\n  }\n"]))),xo=mi.div(ro||(ro=so(["\n  display: none;\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100vh;\n  background-color: rgb(238, 238, 238);\n  flex-direction: column;\n  padding: 20px;\n  box-sizing: border-box;\n  transition: all 0.3s ease-in-out;\n  z-index: 2;\n  ","\n  @media (max-width: 450px) {\n    height: 45vh;\n    border-top-left-radius: 10px;\n    border-top-right-radius: 10px;\n    border-bottom-left-radius: 40px;\n    border-bottom-right-radius: 40px;\n  }\n"])),(t=>t.isOpen&&"\n    display: flex;\n    align-items: center;\n    justify-content: center;\n  ")),vo=mi.nav(oo||(oo=so(["\n  display: flex;\n  align-items: center;\n  @media (max-width: 900px) {\n    display: none;\n  }\n"])));var bo,wo;function Ao(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}const Co=mi(wt)(bo||(bo=Ao(["\n  color: ",";\n  text-decoration: none;\n\n  &:hover {\n    opacity: 0.7;\n  }\n  @media (max-width: 900px) {\n    font-size: 50px;\n    color: rgba(47, 79, 79);\n  }\n  @media (max-width: 900px) {\n    font-size: 40px;\n  }\n"])),(t=>{let{theme:e}=t;return e.textColor})),Eo=mi.ul(wo||(wo=Ao(["\n  display: flex;\n  align-items: center;\n  gap: 115px;\n  list-style-type: none;\n  @media (max-width: 900px) {\n    flex-direction: column;\n    gap: 20px;\n  }\n"]))),To="/timeline",So="/bank-card",Mo="/contacts",ko=t=>{let{onClick:e}=t;return n.createElement(Eo,null,n.createElement("li",null,n.createElement(Co,{to:"/",onClick:e},"Home")),n.createElement("li",null,n.createElement(Co,{to:To,onClick:e},"Timeline")),n.createElement("li",null,n.createElement(Co,{to:So,onClick:e},"Bank card")),n.createElement("li",null,n.createElement(Co,{to:Mo,onClick:e},"Contacts")))};var Io,Po,zo,Do,Lo,Bo,Oo;function Ro(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}const Fo=mi.div(Io||(Io=Ro(["\n  display: flex;\n  align-items: center;\n  padding: 0 65px;\n  max-width: 100%;\n  gap: 70px;\n  background: ",";\n  @media (max-width: 900px) {\n    padding: 20px 10px;\n    flex-direction: column;\n    margin-top: 10px;\n    padding: 20px;\n  }\n  @media (max-width: 450px) {\n    padding: 15px 5px;\n  }\n"])),(t=>t.theme.headerBackground)),No=mi.div(Po||(Po=Ro(["\n  display: flex;\n  flex-direction: column;\n  @media (max-width: 900px) {\n    align-items: center;\n    text-align: center;\n  }\n"]))),jo=mi.h1(zo||(zo=Ro(["\n  font-size: 74px;\n  font-weight: 600;\n  background: linear-gradient(\n    90.18deg,\n    #00ce2c 0.18%,\n    #aedf23 49.3%,\n    #a3dc00 99.88%\n  );\n  -webkit-background-clip: text;\n  color: transparent;\n  text-align: right;\n\n  @media (max-width: 900px) {\n    font-size: 64px;\n    text-align: center;\n  }\n\n  @media (max-width: 450px) {\n    font-size: 34px;\n  }\n"]))),Vo=mi.span(Do||(Do=Ro(["\n  display: block;\n"]))),Uo=mi.div(Lo||(Lo=Ro(["\n  display: flex;\n  justify-content: end;\n  margin-top: -60px;\n  @media (max-width: 900px) {\n    justify-content: center;\n    margin-top: -20px;\n  }\n"]))),Go=mi.p(Bo||(Bo=Ro(["\n  font-size: 23px;\n  font-weight: 300;\n  line-height: 1.5;\n  max-width: 389px;\n  text-align: center;\n  color: ",";\n\n  @media (max-width: 900px) {\n    font-size: 20px;\n  }\n\n  @media (max-width: 450px) {\n    font-size: 12px;\n  }\n"])),(t=>t.theme.textColor)),qo=mi.img(Oo||(Oo=Ro(["\n  max-width: 100%;\n\n  @media (max-width: 900px) {\n    max-width: 300px;\n    margin-top: 20px;\n  }\n\n  @media (max-width: 450px) {\n    max-width: 150px;\n    margin-top: 10px;\n  }\n"]))),$o=a.p+"images/diagram.png",Wo=()=>n.createElement(Fo,null,n.createElement(No,null,n.createElement(jo,null,"Modsen Currency ",n.createElement(Vo,null,"Tracker")),n.createElement(Uo,null,n.createElement(Go,null,"Quotes for the dollar and other international currencies."))),n.createElement(qo,{src:$o,alt:"diagram"})),Ho=()=>{const{lastUpdate:t}=Vr(),{toggleTheme:e,isDarkTheme:i,theme:a}=(0,n.useContext)(Ci),[r,o]=(0,n.useState)(!1),s=(Y(),()=>{o((t=>{const e=!t;return document.body.style.overflow=e?"hidden":"auto",e}))});return n.createElement("header",null,n.createElement(lo,null,n.createElement(co,null,n.createElement("img",{src:Ur,alt:"LOGO"}),n.createElement(vo,null,n.createElement(ko,null)),n.createElement(uo,null,n.createElement(ho,{onClick:e},n.createElement(po,{src:i?Gr:qr,alt:"switch"})),n.createElement(yo,{src:r?Zr:i?Wr:Hr,alt:"Menu",onClick:s}))),n.createElement(xo,{isOpen:r},n.createElement("nav",null,n.createElement(ko,{onClick:s})))),n.createElement(Wo,null),n.createElement(fo,null,n.createElement(_o,{src:$r,alt:"Image"}),n.createElement(mo,null,"Last updated at ",(l=t)?l.toLocaleString("en-US",{hour:"numeric",minute:"numeric",hour12:!0}):"Loading...")));var l},Zo=a.p+"images/Rectangle.png",Yo=a.p+"images/IFIX.png",Xo=[{src:a.p+"images/Bovespa.png",alt:"bovespa",name:"Bovespa Index",rate:"0.15%"},{src:Yo,alt:"IFIX",name:"IFIX",rate:"0.15%"}];var Ko,Qo,Jo,ts,es,ns,is,as,rs,os,ss=a(1921);function ls(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}const cs=mi.div(Ko||(Ko=ls(["\n  padding-left: 131px;\n  padding-right: 120px;\n  @media (max-width: 600px) {\n    padding-left: 20px;\n  }\n  @media (max-width: 480px) {\n    padding-left: 10px;\n    padding-right: 10px;\n  }\n  @media (max-width: 450px) {\n    padding-left: 10px;\n    padding-right: 10px;\n  }\n"]))),us=mi.div(Qo||(Qo=ls([""]))),hs=mi.h1(Jo||(Jo=ls(["\n  font-size: ",";\n  font-weight: 300;\n  line-height: 41.14px;\n  @media (max-width: 450px) {\n    font-size: ",";\n  }\n"])),(t=>{let{theme:e}=t;return e.fontSize.h1}),(t=>{let{theme:e}=t;return e.fontSize.h1Mobile})),ds=mi(ss.LazyLoadImage)(ts||(ts=ls(["\n  @media (max-width: 480px) {\n    width: 400px;\n  }\n"]))),ps=mi.div(es||(es=ls(["\n  margin-top: ",";\n  display: grid;\n  grid-template-columns: repeat(2, 1fr);\n  grid-gap: 90px;\n  @media (max-width: 900px) {\n    grid-template-columns: repeat(1, 1fr);\n    grid-gap: 90px;\n    margin-left: 15px;\n  }\n  @media (max-width: 450px) {\n    grid-gap: 70px;\n  }\n"])),(t=>{let{theme:e}=t;return e.spacing.large})),fs=mi.div(ns||(ns=ls(["\n  width: 480px;\n  background: ",";\n  border-radius: ",";\n  display: flex;\n  align-items: center;\n  gap: ",";\n  @media (max-width: 480px) {\n    width: 430px;\n  }\n  @media (max-width: 450px) {\n    width: 360px;\n  }\n"])),(t=>{let{theme:e}=t;return e.CardBackground}),(t=>{let{theme:e}=t;return e.borderRadius.small}),(t=>{let{theme:e}=t;return e.spacing.medium})),ms=mi(ss.LazyLoadImage)(is||(is=ls(["\n  padding-left: ",";\n"])),(t=>{let{theme:e}=t;return e.spacing.large})),gs=mi.div(as||(as=ls([""]))),_s=mi.p(rs||(rs=ls(["\n  font-size: ",";\n  font-weight: 400;\n  line-height: 49.37px;\n  color: ",";\n  @media (max-width: 450px) {\n    font-size: ",";\n  }\n"])),(t=>{let{theme:e}=t;return e.fontSize.p}),(t=>{let{theme:e}=t;return e.nameColor}),(t=>{let{theme:e}=t;return e.fontSize.pMobile})),ys=mi.span(os||(os=ls(["\n  color: rgba(167, 178, 195, 1);\n  font-size: ",";\n  font-weight: 300;\n  line-height: 41.14px;\n  @media (max-width: 450px) {\n    font-size: ",";\n  }\n"])),(t=>{let{theme:e}=t;return e.fontSize.p}),(t=>{let{theme:e}=t;return e.fontSize.pMobile})),xs=()=>n.createElement(cs,null,n.createElement(us,null,n.createElement(hs,null,"Stocks"),n.createElement(ds,{src:Zo,alt:"rectangle"}),n.createElement(ps,{"data-aos":"fade-up"},Xo.map(((t,e)=>n.createElement(fs,{key:e},n.createElement(ms,{src:t.src,alt:t.alt}),n.createElement(gs,null,n.createElement(_s,null,t.name," ",n.createElement("br",null),n.createElement(ys,null,t.rate)))))))));var vs,bs,ws,As,Cs,Es=a(5556),Ts=a.n(Es);function Ss(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}const Ms=mi.div(vs||(vs=Ss(["\n  cursor: pointer;\n  width: 480px;\n  background: ",";\n  border-radius: ",";\n  display: flex;\n  align-items: center;\n  gap: 30px;\n  @media (max-width: 480px) {\n    width: 430px;\n  }\n  @media (max-width: 450px) {\n    width: 360px;\n  }\n"])),(t=>{let{theme:e}=t;return e.CardBackground}),(t=>{let{theme:e}=t;return e.borderRadius.small})),ks=mi(ss.LazyLoadImage)(bs||(bs=Ss(["\n  padding-left: ",";\n  @media (max-width: 450px) {\n    width: 70px;\n  }\n"])),(t=>{let{theme:e}=t;return e.spacing.large})),Is=mi.div(ws||(ws=Ss([""]))),Ps=mi.p(As||(As=Ss(["\n  font-size: ",";\n  font-weight: 400;\n  line-height: 49.37px;\n  color: ",";\n  @media (max-width: 480px) {\n    font-size: 24px;\n  }\n  @media (max-width: 450px) {\n    font-size: 22px;\n  }\n"])),(t=>{let{theme:e}=t;return e.fontSize.p}),(t=>{let{theme:e}=t;return e.nameColor})),zs=mi.span(Cs||(Cs=Ss(["\n  color: rgba(167, 178, 195, 1);\n  font-size: ",";\n  font-weight: 300;\n  line-height: 41.14px;\n  @media (max-width: 450px) {\n    font-size: ",";\n  }\n"])),(t=>{let{theme:e}=t;return e.fontSize.p}),(t=>{let{theme:e}=t;return e.fontSize.pMobile})),Ds=t=>{let{image:e,alt:i,name:a,rate:r,onClick:o}=t;return n.createElement(Ms,{onClick:o,"data-testid":"currency-card","data-aos":"fade-up"},n.createElement(ks,{src:e,alt:i}),n.createElement(Is,null,n.createElement(Ps,null,a," ",n.createElement("br",null),n.createElement(zs,null,r?r.value:"Loading..."))))};var Ls,Bs,Os,Rs,Fs,Ns,js,Vs;function Us(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}Ds.propTypes={image:Ts().string.isRequired,alt:Ts().string.isRequired,name:Ts().string.isRequired,rate:Ts().shape({value:Ts().oneOfType([Ts().string,Ts().number])}),onClick:Ts().func.isRequired};const Gs=mi.div(Ls||(Ls=Us(["\n  position: fixed;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  background-color: rgba(0, 0, 0, 0.5);\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  z-index: 1000;\n"]))),qs=mi.div(Bs||(Bs=Us(["\n  background-color: rgba(255, 255, 255, 1);\n  border-radius: ",";\n  width: 400px;\n  padding: 20px;\n\n  @media (max-width: 480px) {\n    width: 300px;\n  }\n"])),(t=>{let{theme:e}=t;return e.borderRadius.small})),$s=mi.div(Os||(Os=Us(["\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  border-bottom: 1px solid rgba(204, 204, 204, 1);\n  padding-bottom: 10px;\n  margin-bottom: 10px;\n\n  h2 {\n    margin: 0;\n  }\n"]))),Ws=mi.div(Rs||(Rs=Us(["\n  padding: 10px 0;\n\n  p {\n    margin: 0;\n    font-size: ",";\n  }\n\n  select {\n    width: 100%;\n    padding: 8px;\n    font-size: 14px;\n    margin-top: 8px;\n  }\n"])),(t=>{let{theme:e}=t;return e.fontSize.pSmall})),Hs=mi.div(Fs||(Fs=Us(["\n  display: flex;\n  justify-content: flex-end;\n  margin-top: 20px;\n\n  button {\n    padding: 8px 16px;\n    background-color: rgba(105, 105, 105, 1);\n    color: rgba(255, 255, 255, 1);\n    border: none;\n    border-radius: 4px;\n    cursor: pointer;\n    font-size: 14px;\n\n    &:hover {\n      background-color: rgba(51, 51, 51, 1);\n    }\n  }\n"]))),Zs=mi.input(Ns||(Ns=Us(["\n  width: 100%;\n  padding: 8px;\n  margin: 10px 0;\n  border: 1px solid #ccc;\n  border-radius: 4px;\n  box-sizing: border-box;\n"]))),Ys=mi.h2(js||(js=Us(["\n  color: rgba(65, 71, 64, 0.8);\n"]))),Xs=mi.p(Vs||(Vs=Us(["\n  color: rgba(65, 71, 64, 0.8);\n"]))),Ks=t=>{let{onClose:e,currency:i,currencyRates:a}=t;if(!i)return null;const[r,o]=(0,n.useState)(i.key),[s,l]=(0,n.useState)(1),c=(0,n.useMemo)((()=>((t,e,n,i)=>e&&e[i]&&e[n]?(t*e[n].value/e[i].value).toFixed(2):"Loading...")(s,a,i.key,r)),[s,a,i.key,r]);return n.createElement(Gs,{onClick:t=>{t.target===t.currentTarget&&e()},"data-testid":"currency-modal"},n.createElement(qs,null,n.createElement($s,null,n.createElement(Ys,null,i.name)),n.createElement(Ws,null,n.createElement(Zs,{type:"number",value:s,onChange:t=>{l(t.target.value)},min:"0","data-testid":"amount-input"}),n.createElement(Xs,null,s," ",i.name," is approximately ",c," ",r),n.createElement("select",{value:r,onChange:t=>{o(t.target.value)},"data-testid":"currency-select"},Object.keys(a).map((t=>n.createElement("option",{key:t,value:t},t))))),n.createElement(Hs,null,n.createElement("button",{onClick:e,"data-testid":"close-button"},"Close"))))};Ks.propTypes={onClose:Ts().func.isRequired,currency:Ts().object,currencyRates:Ts().object.isRequired};const Qs=Ks;var Js,tl,el,nl,il;function al(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}const rl=mi.div(Js||(Js=al(["\n  padding-left: 131px;\n  padding-right: 120px;\n  @media (max-width: 600px) {\n    padding-left: 20px;\n  }\n  @media (max-width: 480px) {\n    padding-left: 10px;\n    padding-right: 10px;\n  }\n  @media (max-width: 450px) {\n    padding-left: 10px;\n    padding-right: 10px;\n  }\n"]))),ol=mi.div(tl||(tl=al([""]))),sl=mi.h1(el||(el=al(["\n  font-size: ",";\n  font-weight: 300;\n  line-height: 41.14px;\n  @media (max-width: 450px) {\n    font-size: ",";\n  }\n"])),(t=>{let{theme:e}=t;return e.fontSize.h1}),(t=>{let{theme:e}=t;return e.fontSize.h1Mobile})),ll=mi(ss.LazyLoadImage)(nl||(nl=al(["\n  @media (max-width: 480px) {\n    width: 400px;\n  }\n"]))),cl=mi.div(il||(il=al(["\n  margin-top: 50px;\n  display: grid;\n  grid-template-columns: repeat(2, 1fr);\n  grid-gap: 90px;\n  @media (max-width: 900px) {\n    grid-template-columns: repeat(1, 1fr);\n    grid-gap: 90px;\n    margin-left: ",";\n  }\n  @media (max-width: 450px) {\n    grid-gap: 70px;\n  }\n"])),(t=>{let{theme:e}=t;return e.spacing.medium})),ul=a.p+"images/Dollar.png",hl=a.p+"images/CanadianDollar.png",dl=a.p+"images/AustralianDollar.png",pl=a.p+"images/Euro.png",fl=a.p+"images/Libra.png",ml=a.p+"images/PesoArgentino.png",gl=a.p+"images/Yen.png",_l=a.p+"images/Won.png",yl=a.p+"images/Bitcoin.png",xl=[{image:ul,alt:"Commercial Dollar",name:"Commercial Dollar",key:"USD"},{image:hl,alt:"Canadian Dollar",name:"Canadian Dollar",key:"CAD"},{image:dl,alt:"Australian Dollar",name:"Australian Dollar",key:"AUD"},{image:pl,alt:"Euro",name:"Euro",key:"EUR"},{image:fl,alt:"Libra",name:"Libra",key:"GBP"},{image:ml,alt:"Argentine Peso",name:"Argentine Peso",key:"ARS"},{image:gl,alt:"Yen",name:"Yen",key:"JPY"},{image:_l,alt:"Yuan",name:"Yuan",key:"CNY"},{image:yl,alt:"Bitcoin",name:"Bitcoin",key:"BTC"}],vl=()=>{const{currencyRates:t}=Vr(),[e,i]=(0,n.useState)(null),a=(0,n.useCallback)((t=>{i(t)}),[]),r=(0,n.useCallback)((()=>{i(null)}),[]);return n.createElement(rl,null,n.createElement(ol,null,n.createElement(sl,null,"Quotes"),n.createElement(ll,{src:Zo,alt:"rectangle"}),n.createElement(cl,null,xl.map((e=>{let{key:i,image:r,alt:o,name:s}=e;return n.createElement(Ds,{key:i,image:r,alt:o,name:s,rate:t[i],onClick:()=>a({key:i,image:r,alt:o,name:s})})})))),e&&n.createElement(Qs,{onClose:r,currency:e,currencyRates:t}))};var bl=a(4042),wl=a.n(bl),Al=a(5072),Cl=a.n(Al),El=a(7825),Tl=a.n(El),Sl=a(7659),Ml=a.n(Sl),kl=a(5056),Il=a.n(kl),Pl=a(540),zl=a.n(Pl),Dl=a(1113),Ll=a.n(Dl),Bl=a(5441),Ol={};Ol.styleTagTransform=Ll(),Ol.setAttributes=Il(),Ol.insert=Ml().bind(null,"head"),Ol.domAPI=Tl(),Ol.insertStyleElement=zl(),Cl()(Bl.A,Ol),Bl.A&&Bl.A.locals&&Bl.A.locals;const Rl=()=>((0,n.useEffect)((()=>{wl().init(),wl().refresh()}),[]),n.createElement("div",null,n.createElement(xs,null),n.createElement(vl,null))),Fl=a.p+"images/Vector.png",Nl=[{name:"Dollar",image:ul,code:"USD",description:"Commercial dollar"},{name:"Euro",image:pl,code:"EUR",description:"Euro"},{name:"Yen",image:gl,code:"JPY",description:"Yen"},{name:"Bitcoin",image:yl,code:"BTC",description:"Bitcoin"}];var jl,Vl,Ul,Gl,ql,$l,Wl,Hl;function Zl(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}const Yl=mi.div(jl||(jl=Zl(["\n  margin-left: 96px;\n  color: rgba(217, 217, 217, 1);\n"]))),Xl=mi.select(Vl||(Vl=Zl(["\n  color: ",";\n  padding: 10px 50px 10px 10px;\n  border-radius: 5px;\n  border: none;\n  margin-bottom: 60px;\n  background: transparent;\n  appearance: none;\n  -webkit-appearance: none;\n  -moz-appearance: none;\n  cursor: pointer;\n  outline: none;\n  font-size: 25px;\n  font-weight: 500;\n  line-height: 45px;\n  background-image: ",";\n  background-repeat: no-repeat;\n  background-position: right 10px center;\n  background-size: 20px;\n\n  &:focus {\n    outline: none;\n  }\n\n  option {\n    background: rgba(51, 51, 51, 0.7);\n    border: none;\n    max-width: 100px;\n  }\n\n  @media (max-width: 450px) {\n    option {\n      font-size: 12px;\n      padding: 5px 10px;\n    }\n    margin-bottom: 30px;\n    line-height: 30px;\n  }\n\n  &::-ms-expand {\n    display: none;\n  }\n"])),(t=>{let{theme:e}=t;return e.сurrencyName}),(t=>"url(".concat(t.vector,")"))),Kl=mi.div(Ul||(Ul=Zl(["\n  display: flex;\n  align-items: center;\n  padding: 10px;\n  border-radius: 5px;\n"]))),Ql=mi(ss.LazyLoadImage)(Gl||(Gl=Zl(["\n  width: 70px;\n  margin-right: 20px;\n"]))),Jl=mi.div(ql||(ql=Zl(["\n  display: flex;\n  flex-direction: column;\n"]))),tc=mi.div($l||($l=Zl(["\n  font-size: 30px;\n  font-weight: 400;\n  line-height: 49.37px;\n"]))),ec=mi.div(Wl||(Wl=Zl(["\n  color: rgba(255, 255, 255, 1);\n  font-size: 14px;\n  font-weight: 300;\n  line-height: 24px;\n"])));mi.button(Hl||(Hl=Zl(["\n  background-color: #1b1831;\n  color: rgb(204, 204, 204);\n  border: none;\n  padding: 10px 20px;\n  cursor: pointer;\n  margin-top: 10px;\n  font-size: 16px;\n  border-radius: 6px;\n\n  &:hover {\n    background-color: #14121f;\n  }\n"])));class nc extends n.Component{render(){const{value:t,onChange:e}=this.props,i=Nl.find((e=>{let{code:n}=e;return n===t}));return n.createElement(Yl,null,n.createElement(Xl,{onChange:e,value:t,vector:Fl,"data-testid":"select-dropdown"},Nl.map((t=>{let{code:e,name:i}=t;return n.createElement("option",{key:e,value:e},i)}))),i&&n.createElement(Kl,null,n.createElement(Ql,{src:i.image,alt:i.name}),n.createElement(Jl,null,n.createElement(tc,null,i.description),n.createElement(ec,null,i.code))))}}function ic(t){return t+.5|0}const ac=(t,e,n)=>Math.max(Math.min(t,n),e);function rc(t){return ac(ic(2.55*t),0,255)}function oc(t){return ac(ic(255*t),0,255)}function sc(t){return ac(ic(t/2.55)/100,0,1)}function lc(t){return ac(ic(100*t),0,100)}const cc={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},uc=[..."0123456789ABCDEF"],hc=t=>uc[15&t],dc=t=>uc[(240&t)>>4]+uc[15&t],pc=t=>(240&t)>>4==(15&t);const fc=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function mc(t,e,n){const i=e*Math.min(n,1-n),a=(e,a=(e+t/30)%12)=>n-i*Math.max(Math.min(a-3,9-a,1),-1);return[a(0),a(8),a(4)]}function gc(t,e,n){const i=(i,a=(i+t/60)%6)=>n-n*e*Math.max(Math.min(a,4-a,1),0);return[i(5),i(3),i(1)]}function _c(t,e,n){const i=mc(t,1,.5);let a;for(e+n>1&&(a=1/(e+n),e*=a,n*=a),a=0;a<3;a++)i[a]*=1-e-n,i[a]+=e;return i}function yc(t){const e=t.r/255,n=t.g/255,i=t.b/255,a=Math.max(e,n,i),r=Math.min(e,n,i),o=(a+r)/2;let s,l,c;return a!==r&&(c=a-r,l=o>.5?c/(2-a-r):c/(a+r),s=function(t,e,n,i,a){return t===a?(e-n)/i+(e<n?6:0):e===a?(n-t)/i+2:(t-e)/i+4}(e,n,i,c,a),s=60*s+.5),[0|s,l||0,o]}function xc(t,e,n,i){return(Array.isArray(e)?t(e[0],e[1],e[2]):t(e,n,i)).map(oc)}function vc(t,e,n){return xc(mc,t,e,n)}function bc(t){return(t%360+360)%360}const wc={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},Ac={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};let Cc;const Ec=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/,Tc=t=>t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055,Sc=t=>t<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4);function Mc(t,e,n){if(t){let i=yc(t);i[e]=Math.max(0,Math.min(i[e]+i[e]*n,0===e?360:1)),i=vc(i),t.r=i[0],t.g=i[1],t.b=i[2]}}function kc(t,e){return t?Object.assign(e||{},t):t}function Ic(t){var e={r:0,g:0,b:0,a:255};return Array.isArray(t)?t.length>=3&&(e={r:t[0],g:t[1],b:t[2],a:255},t.length>3&&(e.a=oc(t[3]))):(e=kc(t,{r:0,g:0,b:0,a:1})).a=oc(e.a),e}function Pc(t){return"r"===t.charAt(0)?function(t){const e=Ec.exec(t);let n,i,a,r=255;if(e){if(e[7]!==n){const t=+e[7];r=e[8]?rc(t):ac(255*t,0,255)}return n=+e[1],i=+e[3],a=+e[5],n=255&(e[2]?rc(n):ac(n,0,255)),i=255&(e[4]?rc(i):ac(i,0,255)),a=255&(e[6]?rc(a):ac(a,0,255)),{r:n,g:i,b:a,a:r}}}(t):function(t){const e=fc.exec(t);let n,i=255;if(!e)return;e[5]!==n&&(i=e[6]?rc(+e[5]):oc(+e[5]));const a=bc(+e[2]),r=+e[3]/100,o=+e[4]/100;return n="hwb"===e[1]?function(t,e,n){return xc(_c,t,e,n)}(a,r,o):"hsv"===e[1]?function(t,e,n){return xc(gc,t,e,n)}(a,r,o):vc(a,r,o),{r:n[0],g:n[1],b:n[2],a:i}}(t)}class zc{constructor(t){if(t instanceof zc)return t;const e=typeof t;let n;var i,a,r;"object"===e?n=Ic(t):"string"===e&&(r=(i=t).length,"#"===i[0]&&(4===r||5===r?a={r:255&17*cc[i[1]],g:255&17*cc[i[2]],b:255&17*cc[i[3]],a:5===r?17*cc[i[4]]:255}:7!==r&&9!==r||(a={r:cc[i[1]]<<4|cc[i[2]],g:cc[i[3]]<<4|cc[i[4]],b:cc[i[5]]<<4|cc[i[6]],a:9===r?cc[i[7]]<<4|cc[i[8]]:255})),n=a||function(t){Cc||(Cc=function(){const t={},e=Object.keys(Ac),n=Object.keys(wc);let i,a,r,o,s;for(i=0;i<e.length;i++){for(o=s=e[i],a=0;a<n.length;a++)r=n[a],s=s.replace(r,wc[r]);r=parseInt(Ac[o],16),t[s]=[r>>16&255,r>>8&255,255&r]}return t}(),Cc.transparent=[0,0,0,0]);const e=Cc[t.toLowerCase()];return e&&{r:e[0],g:e[1],b:e[2],a:4===e.length?e[3]:255}}(t)||Pc(t)),this._rgb=n,this._valid=!!n}get valid(){return this._valid}get rgb(){var t=kc(this._rgb);return t&&(t.a=sc(t.a)),t}set rgb(t){this._rgb=Ic(t)}rgbString(){return this._valid?function(t){return t&&(t.a<255?`rgba(${t.r}, ${t.g}, ${t.b}, ${sc(t.a)})`:`rgb(${t.r}, ${t.g}, ${t.b})`)}(this._rgb):void 0}hexString(){return this._valid?function(t){var e=(t=>pc(t.r)&&pc(t.g)&&pc(t.b)&&pc(t.a))(t)?hc:dc;return t?"#"+e(t.r)+e(t.g)+e(t.b)+((t,e)=>t<255?e(t):"")(t.a,e):void 0}(this._rgb):void 0}hslString(){return this._valid?function(t){if(!t)return;const e=yc(t),n=e[0],i=lc(e[1]),a=lc(e[2]);return t.a<255?`hsla(${n}, ${i}%, ${a}%, ${sc(t.a)})`:`hsl(${n}, ${i}%, ${a}%)`}(this._rgb):void 0}mix(t,e){if(t){const n=this.rgb,i=t.rgb;let a;const r=e===a?.5:e,o=2*r-1,s=n.a-i.a,l=((o*s==-1?o:(o+s)/(1+o*s))+1)/2;a=1-l,n.r=255&l*n.r+a*i.r+.5,n.g=255&l*n.g+a*i.g+.5,n.b=255&l*n.b+a*i.b+.5,n.a=r*n.a+(1-r)*i.a,this.rgb=n}return this}interpolate(t,e){return t&&(this._rgb=function(t,e,n){const i=Sc(sc(t.r)),a=Sc(sc(t.g)),r=Sc(sc(t.b));return{r:oc(Tc(i+n*(Sc(sc(e.r))-i))),g:oc(Tc(a+n*(Sc(sc(e.g))-a))),b:oc(Tc(r+n*(Sc(sc(e.b))-r))),a:t.a+n*(e.a-t.a)}}(this._rgb,t._rgb,e)),this}clone(){return new zc(this.rgb)}alpha(t){return this._rgb.a=oc(t),this}clearer(t){return this._rgb.a*=1-t,this}greyscale(){const t=this._rgb,e=ic(.3*t.r+.59*t.g+.11*t.b);return t.r=t.g=t.b=e,this}opaquer(t){return this._rgb.a*=1+t,this}negate(){const t=this._rgb;return t.r=255-t.r,t.g=255-t.g,t.b=255-t.b,this}lighten(t){return Mc(this._rgb,2,t),this}darken(t){return Mc(this._rgb,2,-t),this}saturate(t){return Mc(this._rgb,1,t),this}desaturate(t){return Mc(this._rgb,1,-t),this}rotate(t){return function(t,e){var n=yc(t);n[0]=bc(n[0]+e),n=vc(n),t.r=n[0],t.g=n[1],t.b=n[2]}(this._rgb,t),this}}function Dc(){}const Lc=(()=>{let t=0;return()=>t++})();function Bc(t){return null==t}function Oc(t){if(Array.isArray&&Array.isArray(t))return!0;const e=Object.prototype.toString.call(t);return"[object"===e.slice(0,7)&&"Array]"===e.slice(-6)}function Rc(t){return null!==t&&"[object Object]"===Object.prototype.toString.call(t)}function Fc(t){return("number"==typeof t||t instanceof Number)&&isFinite(+t)}function Nc(t,e){return Fc(t)?t:e}function jc(t,e){return void 0===t?e:t}function Vc(t,e,n){if(t&&"function"==typeof t.call)return t.apply(n,e)}function Uc(t,e,n,i){let a,r,o;if(Oc(t))if(r=t.length,i)for(a=r-1;a>=0;a--)e.call(n,t[a],a);else for(a=0;a<r;a++)e.call(n,t[a],a);else if(Rc(t))for(o=Object.keys(t),r=o.length,a=0;a<r;a++)e.call(n,t[o[a]],o[a])}function Gc(t,e){let n,i,a,r;if(!t||!e||t.length!==e.length)return!1;for(n=0,i=t.length;n<i;++n)if(a=t[n],r=e[n],a.datasetIndex!==r.datasetIndex||a.index!==r.index)return!1;return!0}function qc(t){if(Oc(t))return t.map(qc);if(Rc(t)){const e=Object.create(null),n=Object.keys(t),i=n.length;let a=0;for(;a<i;++a)e[n[a]]=qc(t[n[a]]);return e}return t}function $c(t){return-1===["__proto__","prototype","constructor"].indexOf(t)}function Wc(t,e,n,i){if(!$c(t))return;const a=e[t],r=n[t];Rc(a)&&Rc(r)?Hc(a,r,i):e[t]=qc(r)}function Hc(t,e,n){const i=Oc(e)?e:[e],a=i.length;if(!Rc(t))return t;const r=(n=n||{}).merger||Wc;let o;for(let e=0;e<a;++e){if(o=i[e],!Rc(o))continue;const a=Object.keys(o);for(let e=0,i=a.length;e<i;++e)r(a[e],t,o,n)}return t}function Zc(t,e){return Hc(t,e,{merger:Yc})}function Yc(t,e,n){if(!$c(t))return;const i=e[t],a=n[t];Rc(i)&&Rc(a)?Zc(i,a):Object.prototype.hasOwnProperty.call(e,t)||(e[t]=qc(a))}const Xc={"":t=>t,x:t=>t.x,y:t=>t.y};function Kc(t,e){const n=Xc[e]||(Xc[e]=function(t){const e=function(t){const e=t.split("."),n=[];let i="";for(const t of e)i+=t,i.endsWith("\\")?i=i.slice(0,-1)+".":(n.push(i),i="");return n}(t);return t=>{for(const n of e){if(""===n)break;t=t&&t[n]}return t}}(e));return n(t)}function Qc(t){return t.charAt(0).toUpperCase()+t.slice(1)}const Jc=t=>void 0!==t,tu=t=>"function"==typeof t,eu=(t,e)=>{if(t.size!==e.size)return!1;for(const n of t)if(!e.has(n))return!1;return!0},nu=Math.PI,iu=2*nu,au=Number.POSITIVE_INFINITY,ru=nu/180,ou=nu/2,su=nu/4,lu=2*nu/3,cu=Math.log10,uu=Math.sign;function hu(t,e,n){return Math.abs(t-e)<n}function du(t){const e=Math.round(t);t=hu(t,e,t/1e3)?e:t;const n=Math.pow(10,Math.floor(cu(t))),i=t/n;return(i<=1?1:i<=2?2:i<=5?5:10)*n}function pu(t){return!isNaN(parseFloat(t))&&isFinite(t)}function fu(t){return t*(nu/180)}function mu(t){if(!Fc(t))return;let e=1,n=0;for(;Math.round(t*e)/e!==t;)e*=10,n++;return n}function gu(t){return(t%iu+iu)%iu}function _u(t,e,n){return Math.max(e,Math.min(n,t))}function yu(t,e,n,i=1e-6){return t>=Math.min(e,n)-i&&t<=Math.max(e,n)+i}function xu(t,e,n){n=n||(n=>t[n]<e);let i,a=t.length-1,r=0;for(;a-r>1;)i=r+a>>1,n(i)?r=i:a=i;return{lo:r,hi:a}}const vu=(t,e,n,i)=>xu(t,n,i?i=>{const a=t[i][e];return a<n||a===n&&t[i+1][e]===n}:i=>t[i][e]<n),bu=(t,e,n)=>xu(t,n,(i=>t[i][e]>=n)),wu=["push","pop","shift","splice","unshift"];function Au(t,e){const n=t._chartjs;if(!n)return;const i=n.listeners,a=i.indexOf(e);-1!==a&&i.splice(a,1),i.length>0||(wu.forEach((e=>{delete t[e]})),delete t._chartjs)}function Cu(t){const e=new Set(t);return e.size===t.length?t:Array.from(e)}const Eu="undefined"==typeof window?function(t){return t()}:window.requestAnimationFrame;function Tu(t,e){let n=[],i=!1;return function(...a){n=a,i||(i=!0,Eu.call(window,(()=>{i=!1,t.apply(e,n)})))}}const Su=t=>"start"===t?"left":"end"===t?"right":"center",Mu=(t,e,n)=>"start"===t?e:"end"===t?n:(e+n)/2,ku=t=>0===t||1===t,Iu=(t,e,n)=>-Math.pow(2,10*(t-=1))*Math.sin((t-e)*iu/n),Pu=(t,e,n)=>Math.pow(2,-10*t)*Math.sin((t-e)*iu/n)+1,zu={linear:t=>t,easeInQuad:t=>t*t,easeOutQuad:t=>-t*(t-2),easeInOutQuad:t=>(t/=.5)<1?.5*t*t:-.5*(--t*(t-2)-1),easeInCubic:t=>t*t*t,easeOutCubic:t=>(t-=1)*t*t+1,easeInOutCubic:t=>(t/=.5)<1?.5*t*t*t:.5*((t-=2)*t*t+2),easeInQuart:t=>t*t*t*t,easeOutQuart:t=>-((t-=1)*t*t*t-1),easeInOutQuart:t=>(t/=.5)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2),easeInQuint:t=>t*t*t*t*t,easeOutQuint:t=>(t-=1)*t*t*t*t+1,easeInOutQuint:t=>(t/=.5)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2),easeInSine:t=>1-Math.cos(t*ou),easeOutSine:t=>Math.sin(t*ou),easeInOutSine:t=>-.5*(Math.cos(nu*t)-1),easeInExpo:t=>0===t?0:Math.pow(2,10*(t-1)),easeOutExpo:t=>1===t?1:1-Math.pow(2,-10*t),easeInOutExpo:t=>ku(t)?t:t<.5?.5*Math.pow(2,10*(2*t-1)):.5*(2-Math.pow(2,-10*(2*t-1))),easeInCirc:t=>t>=1?t:-(Math.sqrt(1-t*t)-1),easeOutCirc:t=>Math.sqrt(1-(t-=1)*t),easeInOutCirc:t=>(t/=.5)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1),easeInElastic:t=>ku(t)?t:Iu(t,.075,.3),easeOutElastic:t=>ku(t)?t:Pu(t,.075,.3),easeInOutElastic(t){const e=.1125;return ku(t)?t:t<.5?.5*Iu(2*t,e,.45):.5+.5*Pu(2*t-1,e,.45)},easeInBack(t){const e=1.70158;return t*t*((e+1)*t-e)},easeOutBack(t){const e=1.70158;return(t-=1)*t*((e+1)*t+e)+1},easeInOutBack(t){let e=1.70158;return(t/=.5)<1?t*t*((1+(e*=1.525))*t-e)*.5:.5*((t-=2)*t*((1+(e*=1.525))*t+e)+2)},easeInBounce:t=>1-zu.easeOutBounce(1-t),easeOutBounce(t){const e=7.5625,n=2.75;return t<1/n?e*t*t:t<2/n?e*(t-=1.5/n)*t+.75:t<2.5/n?e*(t-=2.25/n)*t+.9375:e*(t-=2.625/n)*t+.984375},easeInOutBounce:t=>t<.5?.5*zu.easeInBounce(2*t):.5*zu.easeOutBounce(2*t-1)+.5};function Du(t){if(t&&"object"==typeof t){const e=t.toString();return"[object CanvasPattern]"===e||"[object CanvasGradient]"===e}return!1}function Lu(t){return Du(t)?t:new zc(t)}function Bu(t){return Du(t)?t:new zc(t).saturate(.5).darken(.1).hexString()}const Ou=["x","y","borderWidth","radius","tension"],Ru=["color","borderColor","backgroundColor"],Fu=new Map;function Nu(t,e,n){return function(t,e){e=e||{};const n=t+JSON.stringify(e);let i=Fu.get(n);return i||(i=new Intl.NumberFormat(t,e),Fu.set(n,i)),i}(e,n).format(t)}const ju={values:t=>Oc(t)?t:""+t,numeric(t,e,n){if(0===t)return"0";const i=this.chart.options.locale;let a,r=t;if(n.length>1){const e=Math.max(Math.abs(n[0].value),Math.abs(n[n.length-1].value));(e<1e-4||e>1e15)&&(a="scientific"),r=function(t,e){let n=e.length>3?e[2].value-e[1].value:e[1].value-e[0].value;return Math.abs(n)>=1&&t!==Math.floor(t)&&(n=t-Math.floor(t)),n}(t,n)}const o=cu(Math.abs(r)),s=isNaN(o)?1:Math.max(Math.min(-1*Math.floor(o),20),0),l={notation:a,minimumFractionDigits:s,maximumFractionDigits:s};return Object.assign(l,this.options.ticks.format),Nu(t,i,l)},logarithmic(t,e,n){if(0===t)return"0";const i=n[e].significand||t/Math.pow(10,Math.floor(cu(t)));return[1,2,3,5,10,15].includes(i)||e>.8*n.length?ju.numeric.call(this,t,e,n):""}};var Vu={formatters:ju};const Uu=Object.create(null),Gu=Object.create(null);function qu(t,e){if(!e)return t;const n=e.split(".");for(let e=0,i=n.length;e<i;++e){const i=n[e];t=t[i]||(t[i]=Object.create(null))}return t}function $u(t,e,n){return"string"==typeof e?Hc(qu(t,e),n):Hc(qu(t,""),e)}class Wu{constructor(t,e){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=t=>t.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(t,e)=>Bu(e.backgroundColor),this.hoverBorderColor=(t,e)=>Bu(e.borderColor),this.hoverColor=(t,e)=>Bu(e.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(t),this.apply(e)}set(t,e){return $u(this,t,e)}get(t){return qu(this,t)}describe(t,e){return $u(Gu,t,e)}override(t,e){return $u(Uu,t,e)}route(t,e,n,i){const a=qu(this,t),r=qu(this,n),o="_"+e;Object.defineProperties(a,{[o]:{value:a[e],writable:!0},[e]:{enumerable:!0,get(){const t=this[o],e=r[i];return Rc(t)?Object.assign({},e,t):jc(t,e)},set(t){this[o]=t}}})}apply(t){t.forEach((t=>t(this)))}}var Hu=new Wu({_scriptable:t=>!t.startsWith("on"),_indexable:t=>"events"!==t,hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[function(t){t.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),t.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:t=>"onProgress"!==t&&"onComplete"!==t&&"fn"!==t}),t.set("animations",{colors:{type:"color",properties:Ru},numbers:{type:"number",properties:Ou}}),t.describe("animations",{_fallback:"animation"}),t.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:t=>0|t}}}})},function(t){t.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})},function(t){t.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(t,e)=>e.lineWidth,tickColor:(t,e)=>e.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:Vu.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),t.route("scale.ticks","color","","color"),t.route("scale.grid","color","","borderColor"),t.route("scale.border","color","","borderColor"),t.route("scale.title","color","","color"),t.describe("scale",{_fallback:!1,_scriptable:t=>!t.startsWith("before")&&!t.startsWith("after")&&"callback"!==t&&"parser"!==t,_indexable:t=>"borderDash"!==t&&"tickBorderDash"!==t&&"dash"!==t}),t.describe("scales",{_fallback:"scale"}),t.describe("scale.ticks",{_scriptable:t=>"backdropPadding"!==t&&"callback"!==t,_indexable:t=>"backdropPadding"!==t})}]);function Zu(t,e,n,i,a){let r=e[a];return r||(r=e[a]=t.measureText(a).width,n.push(a)),r>i&&(i=r),i}function Yu(t,e,n){const i=t.currentDevicePixelRatio,a=0!==n?Math.max(n/2,.5):0;return Math.round((e-a)*i)/i+a}function Xu(t,e){(e||t)&&((e=e||t.getContext("2d")).save(),e.resetTransform(),e.clearRect(0,0,t.width,t.height),e.restore())}function Ku(t,e,n,i){!function(t,e,n,i,a){let r,o,s,l,c,u,h,d;const p=e.pointStyle,f=e.rotation,m=e.radius;let g=(f||0)*ru;if(p&&"object"==typeof p&&(r=p.toString(),"[object HTMLImageElement]"===r||"[object HTMLCanvasElement]"===r))return t.save(),t.translate(n,i),t.rotate(g),t.drawImage(p,-p.width/2,-p.height/2,p.width,p.height),void t.restore();if(!(isNaN(m)||m<=0)){switch(t.beginPath(),p){default:a?t.ellipse(n,i,a/2,m,0,0,iu):t.arc(n,i,m,0,iu),t.closePath();break;case"triangle":u=a?a/2:m,t.moveTo(n+Math.sin(g)*u,i-Math.cos(g)*m),g+=lu,t.lineTo(n+Math.sin(g)*u,i-Math.cos(g)*m),g+=lu,t.lineTo(n+Math.sin(g)*u,i-Math.cos(g)*m),t.closePath();break;case"rectRounded":c=.516*m,l=m-c,o=Math.cos(g+su)*l,h=Math.cos(g+su)*(a?a/2-c:l),s=Math.sin(g+su)*l,d=Math.sin(g+su)*(a?a/2-c:l),t.arc(n-h,i-s,c,g-nu,g-ou),t.arc(n+d,i-o,c,g-ou,g),t.arc(n+h,i+s,c,g,g+ou),t.arc(n-d,i+o,c,g+ou,g+nu),t.closePath();break;case"rect":if(!f){l=Math.SQRT1_2*m,u=a?a/2:l,t.rect(n-u,i-l,2*u,2*l);break}g+=su;case"rectRot":h=Math.cos(g)*(a?a/2:m),o=Math.cos(g)*m,s=Math.sin(g)*m,d=Math.sin(g)*(a?a/2:m),t.moveTo(n-h,i-s),t.lineTo(n+d,i-o),t.lineTo(n+h,i+s),t.lineTo(n-d,i+o),t.closePath();break;case"crossRot":g+=su;case"cross":h=Math.cos(g)*(a?a/2:m),o=Math.cos(g)*m,s=Math.sin(g)*m,d=Math.sin(g)*(a?a/2:m),t.moveTo(n-h,i-s),t.lineTo(n+h,i+s),t.moveTo(n+d,i-o),t.lineTo(n-d,i+o);break;case"star":h=Math.cos(g)*(a?a/2:m),o=Math.cos(g)*m,s=Math.sin(g)*m,d=Math.sin(g)*(a?a/2:m),t.moveTo(n-h,i-s),t.lineTo(n+h,i+s),t.moveTo(n+d,i-o),t.lineTo(n-d,i+o),g+=su,h=Math.cos(g)*(a?a/2:m),o=Math.cos(g)*m,s=Math.sin(g)*m,d=Math.sin(g)*(a?a/2:m),t.moveTo(n-h,i-s),t.lineTo(n+h,i+s),t.moveTo(n+d,i-o),t.lineTo(n-d,i+o);break;case"line":o=a?a/2:Math.cos(g)*m,s=Math.sin(g)*m,t.moveTo(n-o,i-s),t.lineTo(n+o,i+s);break;case"dash":t.moveTo(n,i),t.lineTo(n+Math.cos(g)*(a?a/2:m),i+Math.sin(g)*m);break;case!1:t.closePath()}t.fill(),e.borderWidth>0&&t.stroke()}}(t,e,n,i,null)}function Qu(t,e,n){return n=n||.5,!e||t&&t.x>e.left-n&&t.x<e.right+n&&t.y>e.top-n&&t.y<e.bottom+n}function Ju(t,e){t.save(),t.beginPath(),t.rect(e.left,e.top,e.right-e.left,e.bottom-e.top),t.clip()}function th(t){t.restore()}function eh(t,e,n,i,a){if(a.strikethrough||a.underline){const r=t.measureText(i),o=e-r.actualBoundingBoxLeft,s=e+r.actualBoundingBoxRight,l=n-r.actualBoundingBoxAscent,c=n+r.actualBoundingBoxDescent,u=a.strikethrough?(l+c)/2:c;t.strokeStyle=t.fillStyle,t.beginPath(),t.lineWidth=a.decorationWidth||2,t.moveTo(o,u),t.lineTo(s,u),t.stroke()}}function nh(t,e){const n=t.fillStyle;t.fillStyle=e.color,t.fillRect(e.left,e.top,e.width,e.height),t.fillStyle=n}function ih(t,e,n,i,a,r={}){const o=Oc(e)?e:[e],s=r.strokeWidth>0&&""!==r.strokeColor;let l,c;for(t.save(),t.font=a.string,function(t,e){e.translation&&t.translate(e.translation[0],e.translation[1]),Bc(e.rotation)||t.rotate(e.rotation),e.color&&(t.fillStyle=e.color),e.textAlign&&(t.textAlign=e.textAlign),e.textBaseline&&(t.textBaseline=e.textBaseline)}(t,r),l=0;l<o.length;++l)c=o[l],r.backdrop&&nh(t,r.backdrop),s&&(r.strokeColor&&(t.strokeStyle=r.strokeColor),Bc(r.strokeWidth)||(t.lineWidth=r.strokeWidth),t.strokeText(c,n,i,r.maxWidth)),t.fillText(c,n,i,r.maxWidth),eh(t,n,i,c,r),i+=Number(a.lineHeight);t.restore()}function ah(t,e){const{x:n,y:i,w:a,h:r,radius:o}=e;t.arc(n+o.topLeft,i+o.topLeft,o.topLeft,1.5*nu,nu,!0),t.lineTo(n,i+r-o.bottomLeft),t.arc(n+o.bottomLeft,i+r-o.bottomLeft,o.bottomLeft,nu,ou,!0),t.lineTo(n+a-o.bottomRight,i+r),t.arc(n+a-o.bottomRight,i+r-o.bottomRight,o.bottomRight,ou,0,!0),t.lineTo(n+a,i+o.topRight),t.arc(n+a-o.topRight,i+o.topRight,o.topRight,0,-ou,!0),t.lineTo(n+o.topLeft,i)}const rh=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,oh=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function sh(t,e){const n=(""+t).match(rh);if(!n||"normal"===n[1])return 1.2*e;switch(t=+n[2],n[3]){case"px":return t;case"%":t/=100}return e*t}const lh=t=>+t||0;function ch(t,e){const n={},i=Rc(e),a=i?Object.keys(e):e,r=Rc(t)?i?n=>jc(t[n],t[e[n]]):e=>t[e]:()=>t;for(const t of a)n[t]=lh(r(t));return n}function uh(t){return ch(t,{top:"y",right:"x",bottom:"y",left:"x"})}function hh(t){return ch(t,["topLeft","topRight","bottomLeft","bottomRight"])}function dh(t){const e=uh(t);return e.width=e.left+e.right,e.height=e.top+e.bottom,e}function ph(t,e){t=t||{},e=e||Hu.font;let n=jc(t.size,e.size);"string"==typeof n&&(n=parseInt(n,10));let i=jc(t.style,e.style);i&&!(""+i).match(oh)&&(console.warn('Invalid font style specified: "'+i+'"'),i=void 0);const a={family:jc(t.family,e.family),lineHeight:sh(jc(t.lineHeight,e.lineHeight),n),size:n,style:i,weight:jc(t.weight,e.weight),string:""};return a.string=function(t){return!t||Bc(t.size)||Bc(t.family)?null:(t.style?t.style+" ":"")+(t.weight?t.weight+" ":"")+t.size+"px "+t.family}(a),a}function fh(t,e,n,i){let a,r,o,s=!0;for(a=0,r=t.length;a<r;++a)if(o=t[a],void 0!==o&&(void 0!==e&&"function"==typeof o&&(o=o(e),s=!1),void 0!==n&&Oc(o)&&(o=o[n%o.length],s=!1),void 0!==o))return i&&!s&&(i.cacheable=!1),o}function mh(t,e){return Object.assign(Object.create(t),e)}function gh(t,e=[""],n,i,a=(()=>t[0])){const r=n||t;void 0===i&&(i=Sh("_fallback",t));const o={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:t,_rootScopes:r,_fallback:i,_getTarget:a,override:n=>gh([n,...t],e,r,i)};return new Proxy(o,{deleteProperty:(e,n)=>(delete e[n],delete e._keys,delete t[0][n],!0),get:(n,i)=>bh(n,i,(()=>function(t,e,n,i){let a;for(const r of e)if(a=Sh(xh(r,t),n),void 0!==a)return vh(t,a)?Eh(n,i,t,a):a}(i,e,t,n))),getOwnPropertyDescriptor:(t,e)=>Reflect.getOwnPropertyDescriptor(t._scopes[0],e),getPrototypeOf:()=>Reflect.getPrototypeOf(t[0]),has:(t,e)=>Mh(t).includes(e),ownKeys:t=>Mh(t),set(t,e,n){const i=t._storage||(t._storage=a());return t[e]=i[e]=n,delete t._keys,!0}})}function _h(t,e,n,i){const a={_cacheable:!1,_proxy:t,_context:e,_subProxy:n,_stack:new Set,_descriptors:yh(t,i),setContext:e=>_h(t,e,n,i),override:a=>_h(t.override(a),e,n,i)};return new Proxy(a,{deleteProperty:(e,n)=>(delete e[n],delete t[n],!0),get:(t,e,n)=>bh(t,e,(()=>function(t,e,n){const{_proxy:i,_context:a,_subProxy:r,_descriptors:o}=t;let s=i[e];return tu(s)&&o.isScriptable(e)&&(s=function(t,e,n,i){const{_proxy:a,_context:r,_subProxy:o,_stack:s}=n;if(s.has(t))throw new Error("Recursion detected: "+Array.from(s).join("->")+"->"+t);s.add(t);let l=e(r,o||i);return s.delete(t),vh(t,l)&&(l=Eh(a._scopes,a,t,l)),l}(e,s,t,n)),Oc(s)&&s.length&&(s=function(t,e,n,i){const{_proxy:a,_context:r,_subProxy:o,_descriptors:s}=n;if(void 0!==r.index&&i(t))return e[r.index%e.length];if(Rc(e[0])){const n=e,i=a._scopes.filter((t=>t!==n));e=[];for(const l of n){const n=Eh(i,a,t,l);e.push(_h(n,r,o&&o[t],s))}}return e}(e,s,t,o.isIndexable)),vh(e,s)&&(s=_h(s,a,r&&r[e],o)),s}(t,e,n))),getOwnPropertyDescriptor:(e,n)=>e._descriptors.allKeys?Reflect.has(t,n)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(t,n),getPrototypeOf:()=>Reflect.getPrototypeOf(t),has:(e,n)=>Reflect.has(t,n),ownKeys:()=>Reflect.ownKeys(t),set:(e,n,i)=>(t[n]=i,delete e[n],!0)})}function yh(t,e={scriptable:!0,indexable:!0}){const{_scriptable:n=e.scriptable,_indexable:i=e.indexable,_allKeys:a=e.allKeys}=t;return{allKeys:a,scriptable:n,indexable:i,isScriptable:tu(n)?n:()=>n,isIndexable:tu(i)?i:()=>i}}const xh=(t,e)=>t?t+Qc(e):e,vh=(t,e)=>Rc(e)&&"adapters"!==t&&(null===Object.getPrototypeOf(e)||e.constructor===Object);function bh(t,e,n){if(Object.prototype.hasOwnProperty.call(t,e)||"constructor"===e)return t[e];const i=n();return t[e]=i,i}function wh(t,e,n){return tu(t)?t(e,n):t}const Ah=(t,e)=>!0===t?e:"string"==typeof t?Kc(e,t):void 0;function Ch(t,e,n,i,a){for(const r of e){const e=Ah(n,r);if(e){t.add(e);const r=wh(e._fallback,n,a);if(void 0!==r&&r!==n&&r!==i)return r}else if(!1===e&&void 0!==i&&n!==i)return null}return!1}function Eh(t,e,n,i){const a=e._rootScopes,r=wh(e._fallback,n,i),o=[...t,...a],s=new Set;s.add(i);let l=Th(s,o,n,r||n,i);return null!==l&&(void 0===r||r===n||(l=Th(s,o,r,l,i),null!==l))&&gh(Array.from(s),[""],a,r,(()=>function(t,e,n){const i=t._getTarget();e in i||(i[e]={});const a=i[e];return Oc(a)&&Rc(n)?n:a||{}}(e,n,i)))}function Th(t,e,n,i,a){for(;n;)n=Ch(t,e,n,i,a);return n}function Sh(t,e){for(const n of e){if(!n)continue;const e=n[t];if(void 0!==e)return e}}function Mh(t){let e=t._keys;return e||(e=t._keys=function(t){const e=new Set;for(const n of t)for(const t of Object.keys(n).filter((t=>!t.startsWith("_"))))e.add(t);return Array.from(e)}(t._scopes)),e}function kh(){return"undefined"!=typeof window&&"undefined"!=typeof document}function Ih(t){let e=t.parentNode;return e&&"[object ShadowRoot]"===e.toString()&&(e=e.host),e}function Ph(t,e,n){let i;return"string"==typeof t?(i=parseInt(t,10),-1!==t.indexOf("%")&&(i=i/100*e.parentNode[n])):i=t,i}Number.EPSILON;const zh=t=>t.ownerDocument.defaultView.getComputedStyle(t,null),Dh=["top","right","bottom","left"];function Lh(t,e,n){const i={};n=n?"-"+n:"";for(let a=0;a<4;a++){const r=Dh[a];i[r]=parseFloat(t[e+"-"+r+n])||0}return i.width=i.left+i.right,i.height=i.top+i.bottom,i}const Bh=(t,e,n)=>(t>0||e>0)&&(!n||!n.shadowRoot);function Oh(t,e){if("native"in t)return t;const{canvas:n,currentDevicePixelRatio:i}=e,a=zh(n),r="border-box"===a.boxSizing,o=Lh(a,"padding"),s=Lh(a,"border","width"),{x:l,y:c,box:u}=function(t,e){const n=t.touches,i=n&&n.length?n[0]:t,{offsetX:a,offsetY:r}=i;let o,s,l=!1;if(Bh(a,r,t.target))o=a,s=r;else{const t=e.getBoundingClientRect();o=i.clientX-t.left,s=i.clientY-t.top,l=!0}return{x:o,y:s,box:l}}(t,n),h=o.left+(u&&s.left),d=o.top+(u&&s.top);let{width:p,height:f}=e;return r&&(p-=o.width+s.width,f-=o.height+s.height),{x:Math.round((l-h)/p*n.width/i),y:Math.round((c-d)/f*n.height/i)}}const Rh=t=>Math.round(10*t)/10;function Fh(t,e,n){const i=e||1,a=Math.floor(t.height*i),r=Math.floor(t.width*i);t.height=Math.floor(t.height),t.width=Math.floor(t.width);const o=t.canvas;return o.style&&(n||!o.style.height&&!o.style.width)&&(o.style.height=`${t.height}px`,o.style.width=`${t.width}px`),(t.currentDevicePixelRatio!==i||o.height!==a||o.width!==r)&&(t.currentDevicePixelRatio=i,o.height=a,o.width=r,t.ctx.setTransform(i,0,0,i,0,0),!0)}const Nh=function(){let t=!1;try{const e={get passive(){return t=!0,!1}};kh()&&(window.addEventListener("test",null,e),window.removeEventListener("test",null,e))}catch(t){}return t}();function jh(t,e){const n=function(t,e){return zh(t).getPropertyValue(e)}(t,e),i=n&&n.match(/^(\d+)(\.\d+)?px$/);return i?+i[1]:void 0}function Vh(t,e,n){return t?function(t,e){return{x:n=>t+t+e-n,setWidth(t){e=t},textAlign:t=>"center"===t?t:"right"===t?"left":"right",xPlus:(t,e)=>t-e,leftForLtr:(t,e)=>t-e}}(e,n):{x:t=>t,setWidth(t){},textAlign:t=>t,xPlus:(t,e)=>t+e,leftForLtr:(t,e)=>t}}class Uh{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(t,e,n,i){const a=e.listeners[i],r=e.duration;a.forEach((i=>i({chart:t,initial:e.initial,numSteps:r,currentStep:Math.min(n-e.start,r)})))}_refresh(){this._request||(this._running=!0,this._request=Eu.call(window,(()=>{this._update(),this._request=null,this._running&&this._refresh()})))}_update(t=Date.now()){let e=0;this._charts.forEach(((n,i)=>{if(!n.running||!n.items.length)return;const a=n.items;let r,o=a.length-1,s=!1;for(;o>=0;--o)r=a[o],r._active?(r._total>n.duration&&(n.duration=r._total),r.tick(t),s=!0):(a[o]=a[a.length-1],a.pop());s&&(i.draw(),this._notify(i,n,t,"progress")),a.length||(n.running=!1,this._notify(i,n,t,"complete"),n.initial=!1),e+=a.length})),this._lastDate=t,0===e&&(this._running=!1)}_getAnims(t){const e=this._charts;let n=e.get(t);return n||(n={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},e.set(t,n)),n}listen(t,e,n){this._getAnims(t).listeners[e].push(n)}add(t,e){e&&e.length&&this._getAnims(t).items.push(...e)}has(t){return this._getAnims(t).items.length>0}start(t){const e=this._charts.get(t);e&&(e.running=!0,e.start=Date.now(),e.duration=e.items.reduce(((t,e)=>Math.max(t,e._duration)),0),this._refresh())}running(t){if(!this._running)return!1;const e=this._charts.get(t);return!!(e&&e.running&&e.items.length)}stop(t){const e=this._charts.get(t);if(!e||!e.items.length)return;const n=e.items;let i=n.length-1;for(;i>=0;--i)n[i].cancel();e.items=[],this._notify(t,e,Date.now(),"complete")}remove(t){return this._charts.delete(t)}}var Gh=new Uh;const qh="transparent",$h={boolean:(t,e,n)=>n>.5?e:t,color(t,e,n){const i=Lu(t||qh),a=i.valid&&Lu(e||qh);return a&&a.valid?a.mix(i,n).hexString():e},number:(t,e,n)=>t+(e-t)*n};class Wh{constructor(t,e,n,i){const a=e[n];i=fh([t.to,i,a,t.from]);const r=fh([t.from,a,i]);this._active=!0,this._fn=t.fn||$h[t.type||typeof r],this._easing=zu[t.easing]||zu.linear,this._start=Math.floor(Date.now()+(t.delay||0)),this._duration=this._total=Math.floor(t.duration),this._loop=!!t.loop,this._target=e,this._prop=n,this._from=r,this._to=i,this._promises=void 0}active(){return this._active}update(t,e,n){if(this._active){this._notify(!1);const i=this._target[this._prop],a=n-this._start,r=this._duration-a;this._start=n,this._duration=Math.floor(Math.max(r,t.duration)),this._total+=a,this._loop=!!t.loop,this._to=fh([t.to,e,i,t.from]),this._from=fh([t.from,i,e])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(t){const e=t-this._start,n=this._duration,i=this._prop,a=this._from,r=this._loop,o=this._to;let s;if(this._active=a!==o&&(r||e<n),!this._active)return this._target[i]=o,void this._notify(!0);e<0?this._target[i]=a:(s=e/n%2,s=r&&s>1?2-s:s,s=this._easing(Math.min(1,Math.max(0,s))),this._target[i]=this._fn(a,o,s))}wait(){const t=this._promises||(this._promises=[]);return new Promise(((e,n)=>{t.push({res:e,rej:n})}))}_notify(t){const e=t?"res":"rej",n=this._promises||[];for(let t=0;t<n.length;t++)n[t][e]()}}class Hh{constructor(t,e){this._chart=t,this._properties=new Map,this.configure(e)}configure(t){if(!Rc(t))return;const e=Object.keys(Hu.animation),n=this._properties;Object.getOwnPropertyNames(t).forEach((i=>{const a=t[i];if(!Rc(a))return;const r={};for(const t of e)r[t]=a[t];(Oc(a.properties)&&a.properties||[i]).forEach((t=>{t!==i&&n.has(t)||n.set(t,r)}))}))}_animateOptions(t,e){const n=e.options,i=function(t,e){if(!e)return;let n=t.options;if(n)return n.$shared&&(t.options=n=Object.assign({},n,{$shared:!1,$animations:{}})),n;t.options=e}(t,n);if(!i)return[];const a=this._createAnimations(i,n);return n.$shared&&function(t,e){const n=[],i=Object.keys(e);for(let e=0;e<i.length;e++){const a=t[i[e]];a&&a.active()&&n.push(a.wait())}return Promise.all(n)}(t.options.$animations,n).then((()=>{t.options=n}),(()=>{})),a}_createAnimations(t,e){const n=this._properties,i=[],a=t.$animations||(t.$animations={}),r=Object.keys(e),o=Date.now();let s;for(s=r.length-1;s>=0;--s){const l=r[s];if("$"===l.charAt(0))continue;if("options"===l){i.push(...this._animateOptions(t,e));continue}const c=e[l];let u=a[l];const h=n.get(l);if(u){if(h&&u.active()){u.update(h,c,o);continue}u.cancel()}h&&h.duration?(a[l]=u=new Wh(h,t,l,c),i.push(u)):t[l]=c}return i}update(t,e){if(0===this._properties.size)return void Object.assign(t,e);const n=this._createAnimations(t,e);return n.length?(Gh.add(this._chart,n),!0):void 0}}function Zh(t,e){const n=t&&t.options||{},i=n.reverse,a=void 0===n.min?e:0,r=void 0===n.max?e:0;return{start:i?r:a,end:i?a:r}}function Yh(t,e){const n=[],i=t._getSortedDatasetMetas(e);let a,r;for(a=0,r=i.length;a<r;++a)n.push(i[a].index);return n}function Xh(t,e,n,i={}){const a=t.keys,r="single"===i.mode;let o,s,l,c;if(null!==e){for(o=0,s=a.length;o<s;++o){if(l=+a[o],l===n){if(i.all)continue;break}c=t.values[l],Fc(c)&&(r||0===e||uu(e)===uu(c))&&(e+=c)}return e}}function Kh(t,e){const n=t&&t.options.stacked;return n||void 0===n&&void 0!==e.stack}function Qh(t,e,n){const i=t[e]||(t[e]={});return i[n]||(i[n]={})}function Jh(t,e,n,i){for(const a of e.getMatchingVisibleMetas(i).reverse()){const e=t[a.index];if(n&&e>0||!n&&e<0)return a.index}return null}function td(t,e){const{chart:n,_cachedMeta:i}=t,a=n._stacks||(n._stacks={}),{iScale:r,vScale:o,index:s}=i,l=r.axis,c=o.axis,u=function(t,e,n){return`${t.id}.${e.id}.${n.stack||n.type}`}(r,o,i),h=e.length;let d;for(let t=0;t<h;++t){const n=e[t],{[l]:r,[c]:h}=n;d=(n._stacks||(n._stacks={}))[c]=Qh(a,u,r),d[s]=h,d._top=Jh(d,o,!0,i.type),d._bottom=Jh(d,o,!1,i.type),(d._visualValues||(d._visualValues={}))[s]=h}}function ed(t,e){const n=t.scales;return Object.keys(n).filter((t=>n[t].axis===e)).shift()}function nd(t,e){const n=t.controller.index,i=t.vScale&&t.vScale.axis;if(i){e=e||t._parsed;for(const t of e){const e=t._stacks;if(!e||void 0===e[i]||void 0===e[i][n])return;delete e[i][n],void 0!==e[i]._visualValues&&void 0!==e[i]._visualValues[n]&&delete e[i]._visualValues[n]}}}const id=t=>"reset"===t||"none"===t,ad=(t,e)=>e?t:Object.assign({},t);class rd{static defaults={};static datasetElementType=null;static dataElementType=null;constructor(t,e){this.chart=t,this._ctx=t.ctx,this.index=e,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const t=this._cachedMeta;this.configure(),this.linkScales(),t._stacked=Kh(t.vScale,t),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(t){this.index!==t&&nd(this._cachedMeta),this.index=t}linkScales(){const t=this.chart,e=this._cachedMeta,n=this.getDataset(),i=(t,e,n,i)=>"x"===t?e:"r"===t?i:n,a=e.xAxisID=jc(n.xAxisID,ed(t,"x")),r=e.yAxisID=jc(n.yAxisID,ed(t,"y")),o=e.rAxisID=jc(n.rAxisID,ed(t,"r")),s=e.indexAxis,l=e.iAxisID=i(s,a,r,o),c=e.vAxisID=i(s,r,a,o);e.xScale=this.getScaleForId(a),e.yScale=this.getScaleForId(r),e.rScale=this.getScaleForId(o),e.iScale=this.getScaleForId(l),e.vScale=this.getScaleForId(c)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(t){return this.chart.scales[t]}_getOtherScale(t){const e=this._cachedMeta;return t===e.iScale?e.vScale:e.iScale}reset(){this._update("reset")}_destroy(){const t=this._cachedMeta;this._data&&Au(this._data,this),t._stacked&&nd(t)}_dataCheck(){const t=this.getDataset(),e=t.data||(t.data=[]),n=this._data;if(Rc(e)){const t=this._cachedMeta;this._data=function(t,e){const{iScale:n,vScale:i}=e,a="x"===n.axis?"x":"y",r="x"===i.axis?"x":"y",o=Object.keys(t),s=new Array(o.length);let l,c,u;for(l=0,c=o.length;l<c;++l)u=o[l],s[l]={[a]:u,[r]:t[u]};return s}(e,t)}else if(n!==e){if(n){Au(n,this);const t=this._cachedMeta;nd(t),t._parsed=[]}e&&Object.isExtensible(e)&&((i=e)._chartjs?i._chartjs.listeners.push(this):(Object.defineProperty(i,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[this]}}),wu.forEach((t=>{const e="_onData"+Qc(t),n=i[t];Object.defineProperty(i,t,{configurable:!0,enumerable:!1,value(...t){const a=n.apply(this,t);return i._chartjs.listeners.forEach((n=>{"function"==typeof n[e]&&n[e](...t)})),a}})})))),this._syncList=[],this._data=e}var i}addElements(){const t=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(t.dataset=new this.datasetElementType)}buildOrUpdateElements(t){const e=this._cachedMeta,n=this.getDataset();let i=!1;this._dataCheck();const a=e._stacked;e._stacked=Kh(e.vScale,e),e.stack!==n.stack&&(i=!0,nd(e),e.stack=n.stack),this._resyncElements(t),(i||a!==e._stacked)&&td(this,e._parsed)}configure(){const t=this.chart.config,e=t.datasetScopeKeys(this._type),n=t.getOptionScopes(this.getDataset(),e,!0);this.options=t.createResolver(n,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(t,e){const{_cachedMeta:n,_data:i}=this,{iScale:a,_stacked:r}=n,o=a.axis;let s,l,c,u=0===t&&e===i.length||n._sorted,h=t>0&&n._parsed[t-1];if(!1===this._parsing)n._parsed=i,n._sorted=!0,c=i;else{c=Oc(i[t])?this.parseArrayData(n,i,t,e):Rc(i[t])?this.parseObjectData(n,i,t,e):this.parsePrimitiveData(n,i,t,e);const a=()=>null===l[o]||h&&l[o]<h[o];for(s=0;s<e;++s)n._parsed[s+t]=l=c[s],u&&(a()&&(u=!1),h=l);n._sorted=u}r&&td(this,c)}parsePrimitiveData(t,e,n,i){const{iScale:a,vScale:r}=t,o=a.axis,s=r.axis,l=a.getLabels(),c=a===r,u=new Array(i);let h,d,p;for(h=0,d=i;h<d;++h)p=h+n,u[h]={[o]:c||a.parse(l[p],p),[s]:r.parse(e[p],p)};return u}parseArrayData(t,e,n,i){const{xScale:a,yScale:r}=t,o=new Array(i);let s,l,c,u;for(s=0,l=i;s<l;++s)c=s+n,u=e[c],o[s]={x:a.parse(u[0],c),y:r.parse(u[1],c)};return o}parseObjectData(t,e,n,i){const{xScale:a,yScale:r}=t,{xAxisKey:o="x",yAxisKey:s="y"}=this._parsing,l=new Array(i);let c,u,h,d;for(c=0,u=i;c<u;++c)h=c+n,d=e[h],l[c]={x:a.parse(Kc(d,o),h),y:r.parse(Kc(d,s),h)};return l}getParsed(t){return this._cachedMeta._parsed[t]}getDataElement(t){return this._cachedMeta.data[t]}applyStack(t,e,n){const i=this.chart,a=this._cachedMeta,r=e[t.axis];return Xh({keys:Yh(i,!0),values:e._stacks[t.axis]._visualValues},r,a.index,{mode:n})}updateRangeFromParsed(t,e,n,i){const a=n[e.axis];let r=null===a?NaN:a;const o=i&&n._stacks[e.axis];i&&o&&(i.values=o,r=Xh(i,a,this._cachedMeta.index)),t.min=Math.min(t.min,r),t.max=Math.max(t.max,r)}getMinMax(t,e){const n=this._cachedMeta,i=n._parsed,a=n._sorted&&t===n.iScale,r=i.length,o=this._getOtherScale(t),s=((t,e,n)=>t&&!e.hidden&&e._stacked&&{keys:Yh(n,!0),values:null})(e,n,this.chart),l={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:c,max:u}=function(t){const{min:e,max:n,minDefined:i,maxDefined:a}=t.getUserBounds();return{min:i?e:Number.NEGATIVE_INFINITY,max:a?n:Number.POSITIVE_INFINITY}}(o);let h,d;function p(){d=i[h];const e=d[o.axis];return!Fc(d[t.axis])||c>e||u<e}for(h=0;h<r&&(p()||(this.updateRangeFromParsed(l,t,d,s),!a));++h);if(a)for(h=r-1;h>=0;--h)if(!p()){this.updateRangeFromParsed(l,t,d,s);break}return l}getAllParsedValues(t){const e=this._cachedMeta._parsed,n=[];let i,a,r;for(i=0,a=e.length;i<a;++i)r=e[i][t.axis],Fc(r)&&n.push(r);return n}getMaxOverflow(){return!1}getLabelAndValue(t){const e=this._cachedMeta,n=e.iScale,i=e.vScale,a=this.getParsed(t);return{label:n?""+n.getLabelForValue(a[n.axis]):"",value:i?""+i.getLabelForValue(a[i.axis]):""}}_update(t){const e=this._cachedMeta;this.update(t||"default"),e._clip=function(t){let e,n,i,a;return Rc(t)?(e=t.top,n=t.right,i=t.bottom,a=t.left):e=n=i=a=t,{top:e,right:n,bottom:i,left:a,disabled:!1===t}}(jc(this.options.clip,function(t,e,n){if(!1===n)return!1;const i=Zh(t,n),a=Zh(e,n);return{top:a.end,right:i.end,bottom:a.start,left:i.start}}(e.xScale,e.yScale,this.getMaxOverflow())))}update(t){}draw(){const t=this._ctx,e=this.chart,n=this._cachedMeta,i=n.data||[],a=e.chartArea,r=[],o=this._drawStart||0,s=this._drawCount||i.length-o,l=this.options.drawActiveElementsOnTop;let c;for(n.dataset&&n.dataset.draw(t,a,o,s),c=o;c<o+s;++c){const e=i[c];e.hidden||(e.active&&l?r.push(e):e.draw(t,a))}for(c=0;c<r.length;++c)r[c].draw(t,a)}getStyle(t,e){const n=e?"active":"default";return void 0===t&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(n):this.resolveDataElementOptions(t||0,n)}getContext(t,e,n){const i=this.getDataset();let a;if(t>=0&&t<this._cachedMeta.data.length){const e=this._cachedMeta.data[t];a=e.$context||(e.$context=function(t,e,n){return mh(t,{active:!1,dataIndex:e,parsed:void 0,raw:void 0,element:n,index:e,mode:"default",type:"data"})}(this.getContext(),t,e)),a.parsed=this.getParsed(t),a.raw=i.data[t],a.index=a.dataIndex=t}else a=this.$context||(this.$context=function(t,e){return mh(t,{active:!1,dataset:void 0,datasetIndex:e,index:e,mode:"default",type:"dataset"})}(this.chart.getContext(),this.index)),a.dataset=i,a.index=a.datasetIndex=this.index;return a.active=!!e,a.mode=n,a}resolveDatasetElementOptions(t){return this._resolveElementOptions(this.datasetElementType.id,t)}resolveDataElementOptions(t,e){return this._resolveElementOptions(this.dataElementType.id,e,t)}_resolveElementOptions(t,e="default",n){const i="active"===e,a=this._cachedDataOpts,r=t+"-"+e,o=a[r],s=this.enableOptionSharing&&Jc(n);if(o)return ad(o,s);const l=this.chart.config,c=l.datasetElementScopeKeys(this._type,t),u=i?[`${t}Hover`,"hover",t,""]:[t,""],h=l.getOptionScopes(this.getDataset(),c),d=Object.keys(Hu.elements[t]),p=l.resolveNamedOptions(h,d,(()=>this.getContext(n,i,e)),u);return p.$shared&&(p.$shared=s,a[r]=Object.freeze(ad(p,s))),p}_resolveAnimations(t,e,n){const i=this.chart,a=this._cachedDataOpts,r=`animation-${e}`,o=a[r];if(o)return o;let s;if(!1!==i.options.animation){const i=this.chart.config,a=i.datasetAnimationScopeKeys(this._type,e),r=i.getOptionScopes(this.getDataset(),a);s=i.createResolver(r,this.getContext(t,n,e))}const l=new Hh(i,s&&s.animations);return s&&s._cacheable&&(a[r]=Object.freeze(l)),l}getSharedOptions(t){if(t.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},t))}includeOptions(t,e){return!e||id(t)||this.chart._animationsDisabled}_getSharedOptions(t,e){const n=this.resolveDataElementOptions(t,e),i=this._sharedOptions,a=this.getSharedOptions(n),r=this.includeOptions(e,a)||a!==i;return this.updateSharedOptions(a,e,n),{sharedOptions:a,includeOptions:r}}updateElement(t,e,n,i){id(i)?Object.assign(t,n):this._resolveAnimations(e,i).update(t,n)}updateSharedOptions(t,e,n){t&&!id(e)&&this._resolveAnimations(void 0,e).update(t,n)}_setStyle(t,e,n,i){t.active=i;const a=this.getStyle(e,i);this._resolveAnimations(e,n,i).update(t,{options:!i&&this.getSharedOptions(a)||a})}removeHoverStyle(t,e,n){this._setStyle(t,n,"active",!1)}setHoverStyle(t,e,n){this._setStyle(t,n,"active",!0)}_removeDatasetHoverStyle(){const t=this._cachedMeta.dataset;t&&this._setStyle(t,void 0,"active",!1)}_setDatasetHoverStyle(){const t=this._cachedMeta.dataset;t&&this._setStyle(t,void 0,"active",!0)}_resyncElements(t){const e=this._data,n=this._cachedMeta.data;for(const[t,e,n]of this._syncList)this[t](e,n);this._syncList=[];const i=n.length,a=e.length,r=Math.min(a,i);r&&this.parse(0,r),a>i?this._insertElements(i,a-i,t):a<i&&this._removeElements(a,i-a)}_insertElements(t,e,n=!0){const i=this._cachedMeta,a=i.data,r=t+e;let o;const s=t=>{for(t.length+=e,o=t.length-1;o>=r;o--)t[o]=t[o-e]};for(s(a),o=t;o<r;++o)a[o]=new this.dataElementType;this._parsing&&s(i._parsed),this.parse(t,e),n&&this.updateElements(a,t,e,"reset")}updateElements(t,e,n,i){}_removeElements(t,e){const n=this._cachedMeta;if(this._parsing){const i=n._parsed.splice(t,e);n._stacked&&nd(n,i)}n.data.splice(t,e)}_sync(t){if(this._parsing)this._syncList.push(t);else{const[e,n,i]=t;this[e](n,i)}this.chart._dataChanges.push([this.index,...t])}_onDataPush(){const t=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-t,t])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(t,e){e&&this._sync(["_removeElements",t,e]);const n=arguments.length-2;n&&this._sync(["_insertElements",t,n])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}function od(t){const e=t.iScale,n=function(t,e){if(!t._cache.$bar){const n=t.getMatchingVisibleMetas(e);let i=[];for(let e=0,a=n.length;e<a;e++)i=i.concat(n[e].controller.getAllParsedValues(t));t._cache.$bar=Cu(i.sort(((t,e)=>t-e)))}return t._cache.$bar}(e,t.type);let i,a,r,o,s=e._length;const l=()=>{32767!==r&&-32768!==r&&(Jc(o)&&(s=Math.min(s,Math.abs(r-o)||s)),o=r)};for(i=0,a=n.length;i<a;++i)r=e.getPixelForValue(n[i]),l();for(o=void 0,i=0,a=e.ticks.length;i<a;++i)r=e.getPixelForTick(i),l();return s}function sd(t,e,n,i){return Oc(t)?function(t,e,n,i){const a=n.parse(t[0],i),r=n.parse(t[1],i),o=Math.min(a,r),s=Math.max(a,r);let l=o,c=s;Math.abs(o)>Math.abs(s)&&(l=s,c=o),e[n.axis]=c,e._custom={barStart:l,barEnd:c,start:a,end:r,min:o,max:s}}(t,e,n,i):e[n.axis]=n.parse(t,i),e}function ld(t,e,n,i){const a=t.iScale,r=t.vScale,o=a.getLabels(),s=a===r,l=[];let c,u,h,d;for(c=n,u=n+i;c<u;++c)d=e[c],h={},h[a.axis]=s||a.parse(o[c],c),l.push(sd(d,h,r,c));return l}function cd(t){return t&&void 0!==t.barStart&&void 0!==t.barEnd}function ud(t,e,n,i){let a=e.borderSkipped;const r={};if(!a)return void(t.borderSkipped=r);if(!0===a)return void(t.borderSkipped={top:!0,right:!0,bottom:!0,left:!0});const{start:o,end:s,reverse:l,top:c,bottom:u}=function(t){let e,n,i,a,r;return t.horizontal?(e=t.base>t.x,n="left",i="right"):(e=t.base<t.y,n="bottom",i="top"),e?(a="end",r="start"):(a="start",r="end"),{start:n,end:i,reverse:e,top:a,bottom:r}}(t);"middle"===a&&n&&(t.enableBorderRadius=!0,(n._top||0)===i?a=c:(n._bottom||0)===i?a=u:(r[hd(u,o,s,l)]=!0,a=c)),r[hd(a,o,s,l)]=!0,t.borderSkipped=r}function hd(t,e,n,i){var a,r,o;return i?(o=n,t=dd(t=(a=t)===(r=e)?o:a===o?r:a,n,e)):t=dd(t,e,n),t}function dd(t,e,n){return"start"===t?e:"end"===t?n:t}function pd(t,{inflateAmount:e},n){t.inflateAmount="auto"===e?1===n?.33:0:e}class fd extends rd{static id="bar";static defaults={datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}};static overrides={scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}};parsePrimitiveData(t,e,n,i){return ld(t,e,n,i)}parseArrayData(t,e,n,i){return ld(t,e,n,i)}parseObjectData(t,e,n,i){const{iScale:a,vScale:r}=t,{xAxisKey:o="x",yAxisKey:s="y"}=this._parsing,l="x"===a.axis?o:s,c="x"===r.axis?o:s,u=[];let h,d,p,f;for(h=n,d=n+i;h<d;++h)f=e[h],p={},p[a.axis]=a.parse(Kc(f,l),h),u.push(sd(Kc(f,c),p,r,h));return u}updateRangeFromParsed(t,e,n,i){super.updateRangeFromParsed(t,e,n,i);const a=n._custom;a&&e===this._cachedMeta.vScale&&(t.min=Math.min(t.min,a.min),t.max=Math.max(t.max,a.max))}getMaxOverflow(){return 0}getLabelAndValue(t){const e=this._cachedMeta,{iScale:n,vScale:i}=e,a=this.getParsed(t),r=a._custom,o=cd(r)?"["+r.start+", "+r.end+"]":""+i.getLabelForValue(a[i.axis]);return{label:""+n.getLabelForValue(a[n.axis]),value:o}}initialize(){this.enableOptionSharing=!0,super.initialize(),this._cachedMeta.stack=this.getDataset().stack}update(t){const e=this._cachedMeta;this.updateElements(e.data,0,e.data.length,t)}updateElements(t,e,n,i){const a="reset"===i,{index:r,_cachedMeta:{vScale:o}}=this,s=o.getBasePixel(),l=o.isHorizontal(),c=this._getRuler(),{sharedOptions:u,includeOptions:h}=this._getSharedOptions(e,i);for(let d=e;d<e+n;d++){const e=this.getParsed(d),n=a||Bc(e[o.axis])?{base:s,head:s}:this._calculateBarValuePixels(d),p=this._calculateBarIndexPixels(d,c),f=(e._stacks||{})[o.axis],m={horizontal:l,base:n.base,enableBorderRadius:!f||cd(e._custom)||r===f._top||r===f._bottom,x:l?n.head:p.center,y:l?p.center:n.head,height:l?p.size:Math.abs(n.size),width:l?Math.abs(n.size):p.size};h&&(m.options=u||this.resolveDataElementOptions(d,t[d].active?"active":i));const g=m.options||t[d].options;ud(m,g,f,r),pd(m,g,c.ratio),this.updateElement(t[d],d,m,i)}}_getStacks(t,e){const{iScale:n}=this._cachedMeta,i=n.getMatchingVisibleMetas(this._type).filter((t=>t.controller.options.grouped)),a=n.options.stacked,r=[],o=t=>{const n=t.controller.getParsed(e),i=n&&n[t.vScale.axis];if(Bc(i)||isNaN(i))return!0};for(const n of i)if((void 0===e||!o(n))&&((!1===a||-1===r.indexOf(n.stack)||void 0===a&&void 0===n.stack)&&r.push(n.stack),n.index===t))break;return r.length||r.push(void 0),r}_getStackCount(t){return this._getStacks(void 0,t).length}_getStackIndex(t,e,n){const i=this._getStacks(t,n),a=void 0!==e?i.indexOf(e):-1;return-1===a?i.length-1:a}_getRuler(){const t=this.options,e=this._cachedMeta,n=e.iScale,i=[];let a,r;for(a=0,r=e.data.length;a<r;++a)i.push(n.getPixelForValue(this.getParsed(a)[n.axis],a));const o=t.barThickness;return{min:o||od(e),pixels:i,start:n._startPixel,end:n._endPixel,stackCount:this._getStackCount(),scale:n,grouped:t.grouped,ratio:o?1:t.categoryPercentage*t.barPercentage}}_calculateBarValuePixels(t){const{_cachedMeta:{vScale:e,_stacked:n,index:i},options:{base:a,minBarLength:r}}=this,o=a||0,s=this.getParsed(t),l=s._custom,c=cd(l);let u,h,d=s[e.axis],p=0,f=n?this.applyStack(e,s,n):d;f!==d&&(p=f-d,f=d),c&&(d=l.barStart,f=l.barEnd-l.barStart,0!==d&&uu(d)!==uu(l.barEnd)&&(p=0),p+=d);const m=Bc(a)||c?p:a;let g=e.getPixelForValue(m);if(u=this.chart.getDataVisibility(t)?e.getPixelForValue(p+f):g,h=u-g,Math.abs(h)<r){h=function(t,e,n){return 0!==t?uu(t):(e.isHorizontal()?1:-1)*(e.min>=n?1:-1)}(h,e,o)*r,d===o&&(g-=h/2);const t=e.getPixelForDecimal(0),a=e.getPixelForDecimal(1),l=Math.min(t,a),p=Math.max(t,a);g=Math.max(Math.min(g,p),l),u=g+h,n&&!c&&(s._stacks[e.axis]._visualValues[i]=e.getValueForPixel(u)-e.getValueForPixel(g))}if(g===e.getPixelForValue(o)){const t=uu(h)*e.getLineWidthForValue(o)/2;g+=t,h-=t}return{size:h,base:g,head:u,center:u+h/2}}_calculateBarIndexPixels(t,e){const n=e.scale,i=this.options,a=i.skipNull,r=jc(i.maxBarThickness,1/0);let o,s;if(e.grouped){const n=a?this._getStackCount(t):e.stackCount,l="flex"===i.barThickness?function(t,e,n,i){const a=e.pixels,r=a[t];let o=t>0?a[t-1]:null,s=t<a.length-1?a[t+1]:null;const l=n.categoryPercentage;null===o&&(o=r-(null===s?e.end-e.start:s-r)),null===s&&(s=r+r-o);const c=r-(r-Math.min(o,s))/2*l;return{chunk:Math.abs(s-o)/2*l/i,ratio:n.barPercentage,start:c}}(t,e,i,n):function(t,e,n,i){const a=n.barThickness;let r,o;return Bc(a)?(r=e.min*n.categoryPercentage,o=n.barPercentage):(r=a*i,o=1),{chunk:r/i,ratio:o,start:e.pixels[t]-r/2}}(t,e,i,n),c=this._getStackIndex(this.index,this._cachedMeta.stack,a?t:void 0);o=l.start+l.chunk*c+l.chunk/2,s=Math.min(r,l.chunk*l.ratio)}else o=n.getPixelForValue(this.getParsed(t)[n.axis],t),s=Math.min(r,e.min*e.ratio);return{base:o-s/2,head:o+s/2,center:o,size:s}}draw(){const t=this._cachedMeta,e=t.vScale,n=t.data,i=n.length;let a=0;for(;a<i;++a)null===this.getParsed(a)[e.axis]||n[a].hidden||n[a].draw(this._ctx)}}function md(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class gd{static override(t){Object.assign(gd.prototype,t)}options;constructor(t){this.options=t||{}}init(){}formats(){return md()}parse(){return md()}format(){return md()}add(){return md()}diff(){return md()}startOf(){return md()}endOf(){return md()}}var _d={_date:gd};function yd(t,e,n,i){const{controller:a,data:r,_sorted:o}=t,s=a._cachedMeta.iScale;if(s&&e===s.axis&&"r"!==e&&o&&r.length){const t=s._reversePixels?bu:vu;if(!i)return t(r,e,n);if(a._sharedOptions){const i=r[0],a="function"==typeof i.getRange&&i.getRange(e);if(a){const i=t(r,e,n-a),o=t(r,e,n+a);return{lo:i.lo,hi:o.hi}}}}return{lo:0,hi:r.length-1}}function xd(t,e,n,i,a){const r=t.getSortedVisibleDatasetMetas(),o=n[e];for(let t=0,n=r.length;t<n;++t){const{index:n,data:s}=r[t],{lo:l,hi:c}=yd(r[t],e,o,a);for(let t=l;t<=c;++t){const e=s[t];e.skip||i(e,n,t)}}}function vd(t,e,n,i,a){const r=[];return a||t.isPointInArea(e)?(xd(t,n,e,(function(n,o,s){(a||Qu(n,t.chartArea,0))&&n.inRange(e.x,e.y,i)&&r.push({element:n,datasetIndex:o,index:s})}),!0),r):r}function bd(t,e,n,i,a,r){return r||t.isPointInArea(e)?"r"!==n||i?function(t,e,n,i,a,r){let o=[];const s=function(t){const e=-1!==t.indexOf("x"),n=-1!==t.indexOf("y");return function(t,i){const a=e?Math.abs(t.x-i.x):0,r=n?Math.abs(t.y-i.y):0;return Math.sqrt(Math.pow(a,2)+Math.pow(r,2))}}(n);let l=Number.POSITIVE_INFINITY;return xd(t,n,e,(function(n,c,u){const h=n.inRange(e.x,e.y,a);if(i&&!h)return;const d=n.getCenterPoint(a);if(!r&&!t.isPointInArea(d)&&!h)return;const p=s(e,d);p<l?(o=[{element:n,datasetIndex:c,index:u}],l=p):p===l&&o.push({element:n,datasetIndex:c,index:u})})),o}(t,e,n,i,a,r):function(t,e,n,i){let a=[];return xd(t,n,e,(function(t,n,r){const{startAngle:o,endAngle:s}=t.getProps(["startAngle","endAngle"],i),{angle:l}=function(t,e){const n=e.x-t.x,i=e.y-t.y,a=Math.sqrt(n*n+i*i);let r=Math.atan2(i,n);return r<-.5*nu&&(r+=iu),{angle:r,distance:a}}(t,{x:e.x,y:e.y});(function(t,e,n,i){const a=gu(t),r=gu(e),o=gu(n),s=gu(r-a),l=gu(o-a),c=gu(a-r),u=gu(a-o);return a===r||a===o||i&&r===o||s>l&&c<u})(l,o,s)&&a.push({element:t,datasetIndex:n,index:r})})),a}(t,e,n,a):[]}function wd(t,e,n,i,a){const r=[],o="x"===n?"inXRange":"inYRange";let s=!1;return xd(t,n,e,((t,i,l)=>{t[o](e[n],a)&&(r.push({element:t,datasetIndex:i,index:l}),s=s||t.inRange(e.x,e.y,a))})),i&&!s?[]:r}var Ad={evaluateInteractionItems:xd,modes:{index(t,e,n,i){const a=Oh(e,t),r=n.axis||"x",o=n.includeInvisible||!1,s=n.intersect?vd(t,a,r,i,o):bd(t,a,r,!1,i,o),l=[];return s.length?(t.getSortedVisibleDatasetMetas().forEach((t=>{const e=s[0].index,n=t.data[e];n&&!n.skip&&l.push({element:n,datasetIndex:t.index,index:e})})),l):[]},dataset(t,e,n,i){const a=Oh(e,t),r=n.axis||"xy",o=n.includeInvisible||!1;let s=n.intersect?vd(t,a,r,i,o):bd(t,a,r,!1,i,o);if(s.length>0){const e=s[0].datasetIndex,n=t.getDatasetMeta(e).data;s=[];for(let t=0;t<n.length;++t)s.push({element:n[t],datasetIndex:e,index:t})}return s},point:(t,e,n,i)=>vd(t,Oh(e,t),n.axis||"xy",i,n.includeInvisible||!1),nearest(t,e,n,i){const a=Oh(e,t),r=n.axis||"xy",o=n.includeInvisible||!1;return bd(t,a,r,n.intersect,i,o)},x:(t,e,n,i)=>wd(t,Oh(e,t),"x",n.intersect,i),y:(t,e,n,i)=>wd(t,Oh(e,t),"y",n.intersect,i)}};const Cd=["left","top","right","bottom"];function Ed(t,e){return t.filter((t=>t.pos===e))}function Td(t,e){return t.filter((t=>-1===Cd.indexOf(t.pos)&&t.box.axis===e))}function Sd(t,e){return t.sort(((t,n)=>{const i=e?n:t,a=e?t:n;return i.weight===a.weight?i.index-a.index:i.weight-a.weight}))}function Md(t,e,n,i){return Math.max(t[n],e[n])+Math.max(t[i],e[i])}function kd(t,e){t.top=Math.max(t.top,e.top),t.left=Math.max(t.left,e.left),t.bottom=Math.max(t.bottom,e.bottom),t.right=Math.max(t.right,e.right)}function Id(t,e,n,i){const{pos:a,box:r}=n,o=t.maxPadding;if(!Rc(a)){n.size&&(t[a]-=n.size);const e=i[n.stack]||{size:0,count:1};e.size=Math.max(e.size,n.horizontal?r.height:r.width),n.size=e.size/e.count,t[a]+=n.size}r.getPadding&&kd(o,r.getPadding());const s=Math.max(0,e.outerWidth-Md(o,t,"left","right")),l=Math.max(0,e.outerHeight-Md(o,t,"top","bottom")),c=s!==t.w,u=l!==t.h;return t.w=s,t.h=l,n.horizontal?{same:c,other:u}:{same:u,other:c}}function Pd(t,e){const n=e.maxPadding;return function(t){const i={left:0,top:0,right:0,bottom:0};return t.forEach((t=>{i[t]=Math.max(e[t],n[t])})),i}(t?["left","right"]:["top","bottom"])}function zd(t,e,n,i){const a=[];let r,o,s,l,c,u;for(r=0,o=t.length,c=0;r<o;++r){s=t[r],l=s.box,l.update(s.width||e.w,s.height||e.h,Pd(s.horizontal,e));const{same:o,other:h}=Id(e,n,s,i);c|=o&&a.length,u=u||h,l.fullSize||a.push(s)}return c&&zd(a,e,n,i)||u}function Dd(t,e,n,i,a){t.top=n,t.left=e,t.right=e+i,t.bottom=n+a,t.width=i,t.height=a}function Ld(t,e,n,i){const a=n.padding;let{x:r,y:o}=e;for(const s of t){const t=s.box,l=i[s.stack]||{count:1,placed:0,weight:1},c=s.stackWeight/l.weight||1;if(s.horizontal){const i=e.w*c,r=l.size||t.height;Jc(l.start)&&(o=l.start),t.fullSize?Dd(t,a.left,o,n.outerWidth-a.right-a.left,r):Dd(t,e.left+l.placed,o,i,r),l.start=o,l.placed+=i,o=t.bottom}else{const i=e.h*c,o=l.size||t.width;Jc(l.start)&&(r=l.start),t.fullSize?Dd(t,r,a.top,o,n.outerHeight-a.bottom-a.top):Dd(t,r,e.top+l.placed,o,i),l.start=r,l.placed+=i,r=t.right}}e.x=r,e.y=o}var Bd={addBox(t,e){t.boxes||(t.boxes=[]),e.fullSize=e.fullSize||!1,e.position=e.position||"top",e.weight=e.weight||0,e._layers=e._layers||function(){return[{z:0,draw(t){e.draw(t)}}]},t.boxes.push(e)},removeBox(t,e){const n=t.boxes?t.boxes.indexOf(e):-1;-1!==n&&t.boxes.splice(n,1)},configure(t,e,n){e.fullSize=n.fullSize,e.position=n.position,e.weight=n.weight},update(t,e,n,i){if(!t)return;const a=dh(t.options.layout.padding),r=Math.max(e-a.width,0),o=Math.max(n-a.height,0),s=function(t){const e=function(t){const e=[];let n,i,a,r,o,s;for(n=0,i=(t||[]).length;n<i;++n)a=t[n],({position:r,options:{stack:o,stackWeight:s=1}}=a),e.push({index:n,box:a,pos:r,horizontal:a.isHorizontal(),weight:a.weight,stack:o&&r+o,stackWeight:s});return e}(t),n=Sd(e.filter((t=>t.box.fullSize)),!0),i=Sd(Ed(e,"left"),!0),a=Sd(Ed(e,"right")),r=Sd(Ed(e,"top"),!0),o=Sd(Ed(e,"bottom")),s=Td(e,"x"),l=Td(e,"y");return{fullSize:n,leftAndTop:i.concat(r),rightAndBottom:a.concat(l).concat(o).concat(s),chartArea:Ed(e,"chartArea"),vertical:i.concat(a).concat(l),horizontal:r.concat(o).concat(s)}}(t.boxes),l=s.vertical,c=s.horizontal;Uc(t.boxes,(t=>{"function"==typeof t.beforeLayout&&t.beforeLayout()}));const u=l.reduce(((t,e)=>e.box.options&&!1===e.box.options.display?t:t+1),0)||1,h=Object.freeze({outerWidth:e,outerHeight:n,padding:a,availableWidth:r,availableHeight:o,vBoxMaxWidth:r/2/u,hBoxMaxHeight:o/2}),d=Object.assign({},a);kd(d,dh(i));const p=Object.assign({maxPadding:d,w:r,h:o,x:a.left,y:a.top},a),f=function(t,e){const n=function(t){const e={};for(const n of t){const{stack:t,pos:i,stackWeight:a}=n;if(!t||!Cd.includes(i))continue;const r=e[t]||(e[t]={count:0,placed:0,weight:0,size:0});r.count++,r.weight+=a}return e}(t),{vBoxMaxWidth:i,hBoxMaxHeight:a}=e;let r,o,s;for(r=0,o=t.length;r<o;++r){s=t[r];const{fullSize:o}=s.box,l=n[s.stack],c=l&&s.stackWeight/l.weight;s.horizontal?(s.width=c?c*i:o&&e.availableWidth,s.height=a):(s.width=i,s.height=c?c*a:o&&e.availableHeight)}return n}(l.concat(c),h);zd(s.fullSize,p,h,f),zd(l,p,h,f),zd(c,p,h,f)&&zd(l,p,h,f),function(t){const e=t.maxPadding;function n(n){const i=Math.max(e[n]-t[n],0);return t[n]+=i,i}t.y+=n("top"),t.x+=n("left"),n("right"),n("bottom")}(p),Ld(s.leftAndTop,p,h,f),p.x+=p.w,p.y+=p.h,Ld(s.rightAndBottom,p,h,f),t.chartArea={left:p.left,top:p.top,right:p.left+p.w,bottom:p.top+p.h,height:p.h,width:p.w},Uc(s.chartArea,(e=>{const n=e.box;Object.assign(n,t.chartArea),n.update(p.w,p.h,{left:0,top:0,right:0,bottom:0})}))}};class Od{acquireContext(t,e){}releaseContext(t){return!1}addEventListener(t,e,n){}removeEventListener(t,e,n){}getDevicePixelRatio(){return 1}getMaximumSize(t,e,n,i){return e=Math.max(0,e||t.width),n=n||t.height,{width:e,height:Math.max(0,i?Math.floor(e/i):n)}}isAttached(t){return!0}updateConfig(t){}}class Rd extends Od{acquireContext(t){return t&&t.getContext&&t.getContext("2d")||null}updateConfig(t){t.options.animation=!1}}const Fd="$chartjs",Nd={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},jd=t=>null===t||""===t,Vd=!!Nh&&{passive:!0};function Ud(t,e,n){t&&t.canvas&&t.canvas.removeEventListener(e,n,Vd)}function Gd(t,e){for(const n of t)if(n===e||n.contains(e))return!0}function qd(t,e,n){const i=t.canvas,a=new MutationObserver((t=>{let e=!1;for(const n of t)e=e||Gd(n.addedNodes,i),e=e&&!Gd(n.removedNodes,i);e&&n()}));return a.observe(document,{childList:!0,subtree:!0}),a}function $d(t,e,n){const i=t.canvas,a=new MutationObserver((t=>{let e=!1;for(const n of t)e=e||Gd(n.removedNodes,i),e=e&&!Gd(n.addedNodes,i);e&&n()}));return a.observe(document,{childList:!0,subtree:!0}),a}const Wd=new Map;let Hd=0;function Zd(){const t=window.devicePixelRatio;t!==Hd&&(Hd=t,Wd.forEach(((e,n)=>{n.currentDevicePixelRatio!==t&&e()})))}function Yd(t,e,n){const i=t.canvas,a=i&&Ih(i);if(!a)return;const r=Tu(((t,e)=>{const i=a.clientWidth;n(t,e),i<a.clientWidth&&n()}),window),o=new ResizeObserver((t=>{const e=t[0],n=e.contentRect.width,i=e.contentRect.height;0===n&&0===i||r(n,i)}));return o.observe(a),function(t,e){Wd.size||window.addEventListener("resize",Zd),Wd.set(t,e)}(t,r),o}function Xd(t,e,n){n&&n.disconnect(),"resize"===e&&function(t){Wd.delete(t),Wd.size||window.removeEventListener("resize",Zd)}(t)}function Kd(t,e,n){const i=t.canvas,a=Tu((e=>{null!==t.ctx&&n(function(t,e){const n=Nd[t.type]||t.type,{x:i,y:a}=Oh(t,e);return{type:n,chart:e,native:t,x:void 0!==i?i:null,y:void 0!==a?a:null}}(e,t))}),t);return function(t,e,n){t&&t.addEventListener(e,n,Vd)}(i,e,a),a}class Qd extends Od{acquireContext(t,e){const n=t&&t.getContext&&t.getContext("2d");return n&&n.canvas===t?(function(t,e){const n=t.style,i=t.getAttribute("height"),a=t.getAttribute("width");if(t[Fd]={initial:{height:i,width:a,style:{display:n.display,height:n.height,width:n.width}}},n.display=n.display||"block",n.boxSizing=n.boxSizing||"border-box",jd(a)){const e=jh(t,"width");void 0!==e&&(t.width=e)}if(jd(i))if(""===t.style.height)t.height=t.width/(e||2);else{const e=jh(t,"height");void 0!==e&&(t.height=e)}}(t,e),n):null}releaseContext(t){const e=t.canvas;if(!e[Fd])return!1;const n=e[Fd].initial;["height","width"].forEach((t=>{const i=n[t];Bc(i)?e.removeAttribute(t):e.setAttribute(t,i)}));const i=n.style||{};return Object.keys(i).forEach((t=>{e.style[t]=i[t]})),e.width=e.width,delete e[Fd],!0}addEventListener(t,e,n){this.removeEventListener(t,e);const i=t.$proxies||(t.$proxies={}),a={attach:qd,detach:$d,resize:Yd}[e]||Kd;i[e]=a(t,e,n)}removeEventListener(t,e){const n=t.$proxies||(t.$proxies={}),i=n[e];i&&(({attach:Xd,detach:Xd,resize:Xd}[e]||Ud)(t,e,i),n[e]=void 0)}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(t,e,n,i){return function(t,e,n,i){const a=zh(t),r=Lh(a,"margin"),o=Ph(a.maxWidth,t,"clientWidth")||au,s=Ph(a.maxHeight,t,"clientHeight")||au,l=function(t,e,n){let i,a;if(void 0===e||void 0===n){const r=t&&Ih(t);if(r){const t=r.getBoundingClientRect(),o=zh(r),s=Lh(o,"border","width"),l=Lh(o,"padding");e=t.width-l.width-s.width,n=t.height-l.height-s.height,i=Ph(o.maxWidth,r,"clientWidth"),a=Ph(o.maxHeight,r,"clientHeight")}else e=t.clientWidth,n=t.clientHeight}return{width:e,height:n,maxWidth:i||au,maxHeight:a||au}}(t,e,n);let{width:c,height:u}=l;if("content-box"===a.boxSizing){const t=Lh(a,"border","width"),e=Lh(a,"padding");c-=e.width+t.width,u-=e.height+t.height}return c=Math.max(0,c-r.width),u=Math.max(0,i?c/i:u-r.height),c=Rh(Math.min(c,o,l.maxWidth)),u=Rh(Math.min(u,s,l.maxHeight)),c&&!u&&(u=Rh(c/2)),(void 0!==e||void 0!==n)&&i&&l.height&&u>l.height&&(u=l.height,c=Rh(Math.floor(u*i))),{width:c,height:u}}(t,e,n,i)}isAttached(t){const e=t&&Ih(t);return!(!e||!e.isConnected)}}class Jd{static defaults={};static defaultRoutes=void 0;x;y;active=!1;options;$animations;tooltipPosition(t){const{x:e,y:n}=this.getProps(["x","y"],t);return{x:e,y:n}}hasValue(){return pu(this.x)&&pu(this.y)}getProps(t,e){const n=this.$animations;if(!e||!n)return this;const i={};return t.forEach((t=>{i[t]=n[t]&&n[t].active()?n[t]._to:this[t]})),i}}function tp(t,e,n,i,a){const r=jc(i,0),o=Math.min(jc(a,t.length),t.length);let s,l,c,u=0;for(n=Math.ceil(n),a&&(s=a-i,n=s/Math.floor(s/n)),c=r;c<0;)u++,c=Math.round(r+u*n);for(l=Math.max(r,0);l<o;l++)l===c&&(e.push(t[l]),u++,c=Math.round(r+u*n))}const ep=(t,e,n)=>"top"===e||"left"===e?t[e]+n:t[e]-n,np=(t,e)=>Math.min(e||t,t);function ip(t,e){const n=[],i=t.length/e,a=t.length;let r=0;for(;r<a;r+=i)n.push(t[Math.floor(r)]);return n}function ap(t,e,n){const i=t.ticks.length,a=Math.min(e,i-1),r=t._startPixel,o=t._endPixel,s=1e-6;let l,c=t.getPixelForTick(a);if(!(n&&(l=1===i?Math.max(c-r,o-c):0===e?(t.getPixelForTick(1)-c)/2:(c-t.getPixelForTick(a-1))/2,c+=a<e?l:-l,c<r-s||c>o+s)))return c}function rp(t){return t.drawTicks?t.tickLength:0}function op(t,e){if(!t.display)return 0;const n=ph(t.font,e),i=dh(t.padding);return(Oc(t.text)?t.text.length:1)*n.lineHeight+i.height}function sp(t,e,n){let i=Su(t);return(n&&"right"!==e||!n&&"right"===e)&&(i=(t=>"left"===t?"right":"right"===t?"left":t)(i)),i}class lp extends Jd{constructor(t){super(),this.id=t.id,this.type=t.type,this.options=void 0,this.ctx=t.ctx,this.chart=t.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(t){this.options=t.setContext(this.getContext()),this.axis=t.axis,this._userMin=this.parse(t.min),this._userMax=this.parse(t.max),this._suggestedMin=this.parse(t.suggestedMin),this._suggestedMax=this.parse(t.suggestedMax)}parse(t,e){return t}getUserBounds(){let{_userMin:t,_userMax:e,_suggestedMin:n,_suggestedMax:i}=this;return t=Nc(t,Number.POSITIVE_INFINITY),e=Nc(e,Number.NEGATIVE_INFINITY),n=Nc(n,Number.POSITIVE_INFINITY),i=Nc(i,Number.NEGATIVE_INFINITY),{min:Nc(t,n),max:Nc(e,i),minDefined:Fc(t),maxDefined:Fc(e)}}getMinMax(t){let e,{min:n,max:i,minDefined:a,maxDefined:r}=this.getUserBounds();if(a&&r)return{min:n,max:i};const o=this.getMatchingVisibleMetas();for(let s=0,l=o.length;s<l;++s)e=o[s].controller.getMinMax(this,t),a||(n=Math.min(n,e.min)),r||(i=Math.max(i,e.max));return n=r&&n>i?i:n,i=a&&n>i?n:i,{min:Nc(n,Nc(i,n)),max:Nc(i,Nc(n,i))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const t=this.chart.data;return this.options.labels||(this.isHorizontal()?t.xLabels:t.yLabels)||t.labels||[]}getLabelItems(t=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(t))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){Vc(this.options.beforeUpdate,[this])}update(t,e,n){const{beginAtZero:i,grace:a,ticks:r}=this.options,o=r.sampleSize;this.beforeUpdate(),this.maxWidth=t,this.maxHeight=e,this._margins=n=Object.assign({left:0,right:0,top:0,bottom:0},n),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+n.left+n.right:this.height+n.top+n.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=function(t,e,n){const{min:i,max:a}=t,r=(l=(a-i)/2,"string"==typeof(s=e)&&s.endsWith("%")?parseFloat(s)/100*l:+s),o=(t,e)=>n&&0===t?0:t+e;var s,l;return{min:o(i,-Math.abs(r)),max:o(a,r)}}(this,a,i),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const s=o<this.ticks.length;this._convertTicksToLabels(s?ip(this.ticks,o):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),r.display&&(r.autoSkip||"auto"===r.source)&&(this.ticks=function(t,e){const n=t.options.ticks,i=function(t){const e=t.options.offset,n=t._tickSize(),i=t._length/n+(e?0:1),a=t._maxLength/n;return Math.floor(Math.min(i,a))}(t),a=Math.min(n.maxTicksLimit||i,i),r=n.major.enabled?function(t){const e=[];let n,i;for(n=0,i=t.length;n<i;n++)t[n].major&&e.push(n);return e}(e):[],o=r.length,s=r[0],l=r[o-1],c=[];if(o>a)return function(t,e,n,i){let a,r=0,o=n[0];for(i=Math.ceil(i),a=0;a<t.length;a++)a===o&&(e.push(t[a]),r++,o=n[r*i])}(e,c,r,o/a),c;const u=function(t,e,n){const i=function(t){const e=t.length;let n,i;if(e<2)return!1;for(i=t[0],n=1;n<e;++n)if(t[n]-t[n-1]!==i)return!1;return i}(t),a=e.length/n;if(!i)return Math.max(a,1);const r=function(t){const e=[],n=Math.sqrt(t);let i;for(i=1;i<n;i++)t%i==0&&(e.push(i),e.push(t/i));return n===(0|n)&&e.push(n),e.sort(((t,e)=>t-e)).pop(),e}(i);for(let t=0,e=r.length-1;t<e;t++){const e=r[t];if(e>a)return e}return Math.max(a,1)}(r,e,a);if(o>0){let t,n;const i=o>1?Math.round((l-s)/(o-1)):null;for(tp(e,c,u,Bc(i)?0:s-i,s),t=0,n=o-1;t<n;t++)tp(e,c,u,r[t],r[t+1]);return tp(e,c,u,l,Bc(i)?e.length:l+i),c}return tp(e,c,u),c}(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),s&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let t,e,n=this.options.reverse;this.isHorizontal()?(t=this.left,e=this.right):(t=this.top,e=this.bottom,n=!n),this._startPixel=t,this._endPixel=e,this._reversePixels=n,this._length=e-t,this._alignToPixels=this.options.alignToPixels}afterUpdate(){Vc(this.options.afterUpdate,[this])}beforeSetDimensions(){Vc(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){Vc(this.options.afterSetDimensions,[this])}_callHooks(t){this.chart.notifyPlugins(t,this.getContext()),Vc(this.options[t],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){Vc(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(t){const e=this.options.ticks;let n,i,a;for(n=0,i=t.length;n<i;n++)a=t[n],a.label=Vc(e.callback,[a.value,n,t],this)}afterTickToLabelConversion(){Vc(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){Vc(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const t=this.options,e=t.ticks,n=np(this.ticks.length,t.ticks.maxTicksLimit),i=e.minRotation||0,a=e.maxRotation;let r,o,s,l=i;if(!this._isVisible()||!e.display||i>=a||n<=1||!this.isHorizontal())return void(this.labelRotation=i);const c=this._getLabelSizes(),u=c.widest.width,h=c.highest.height,d=_u(this.chart.width-u,0,this.maxWidth);r=t.offset?this.maxWidth/n:d/(n-1),u+6>r&&(r=d/(n-(t.offset?.5:1)),o=this.maxHeight-rp(t.grid)-e.padding-op(t.title,this.chart.options.font),s=Math.sqrt(u*u+h*h),l=Math.min(Math.asin(_u((c.highest.height+6)/r,-1,1)),Math.asin(_u(o/s,-1,1))-Math.asin(_u(h/s,-1,1)))*(180/nu),l=Math.max(i,Math.min(a,l))),this.labelRotation=l}afterCalculateLabelRotation(){Vc(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){Vc(this.options.beforeFit,[this])}fit(){const t={width:0,height:0},{chart:e,options:{ticks:n,title:i,grid:a}}=this,r=this._isVisible(),o=this.isHorizontal();if(r){const r=op(i,e.options.font);if(o?(t.width=this.maxWidth,t.height=rp(a)+r):(t.height=this.maxHeight,t.width=rp(a)+r),n.display&&this.ticks.length){const{first:e,last:i,widest:a,highest:r}=this._getLabelSizes(),s=2*n.padding,l=fu(this.labelRotation),c=Math.cos(l),u=Math.sin(l);if(o){const e=n.mirror?0:u*a.width+c*r.height;t.height=Math.min(this.maxHeight,t.height+e+s)}else{const e=n.mirror?0:c*a.width+u*r.height;t.width=Math.min(this.maxWidth,t.width+e+s)}this._calculatePadding(e,i,u,c)}}this._handleMargins(),o?(this.width=this._length=e.width-this._margins.left-this._margins.right,this.height=t.height):(this.width=t.width,this.height=this._length=e.height-this._margins.top-this._margins.bottom)}_calculatePadding(t,e,n,i){const{ticks:{align:a,padding:r},position:o}=this.options,s=0!==this.labelRotation,l="top"!==o&&"x"===this.axis;if(this.isHorizontal()){const o=this.getPixelForTick(0)-this.left,c=this.right-this.getPixelForTick(this.ticks.length-1);let u=0,h=0;s?l?(u=i*t.width,h=n*e.height):(u=n*t.height,h=i*e.width):"start"===a?h=e.width:"end"===a?u=t.width:"inner"!==a&&(u=t.width/2,h=e.width/2),this.paddingLeft=Math.max((u-o+r)*this.width/(this.width-o),0),this.paddingRight=Math.max((h-c+r)*this.width/(this.width-c),0)}else{let n=e.height/2,i=t.height/2;"start"===a?(n=0,i=t.height):"end"===a&&(n=e.height,i=0),this.paddingTop=n+r,this.paddingBottom=i+r}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){Vc(this.options.afterFit,[this])}isHorizontal(){const{axis:t,position:e}=this.options;return"top"===e||"bottom"===e||"x"===t}isFullSize(){return this.options.fullSize}_convertTicksToLabels(t){let e,n;for(this.beforeTickToLabelConversion(),this.generateTickLabels(t),e=0,n=t.length;e<n;e++)Bc(t[e].label)&&(t.splice(e,1),n--,e--);this.afterTickToLabelConversion()}_getLabelSizes(){let t=this._labelSizes;if(!t){const e=this.options.ticks.sampleSize;let n=this.ticks;e<n.length&&(n=ip(n,e)),this._labelSizes=t=this._computeLabelSizes(n,n.length,this.options.ticks.maxTicksLimit)}return t}_computeLabelSizes(t,e,n){const{ctx:i,_longestTextCache:a}=this,r=[],o=[],s=Math.floor(e/np(e,n));let l,c,u,h,d,p,f,m,g,_,y,x=0,v=0;for(l=0;l<e;l+=s){if(h=t[l].label,d=this._resolveTickFontOptions(l),i.font=p=d.string,f=a[p]=a[p]||{data:{},gc:[]},m=d.lineHeight,g=_=0,Bc(h)||Oc(h)){if(Oc(h))for(c=0,u=h.length;c<u;++c)y=h[c],Bc(y)||Oc(y)||(g=Zu(i,f.data,f.gc,g,y),_+=m)}else g=Zu(i,f.data,f.gc,g,h),_=m;r.push(g),o.push(_),x=Math.max(g,x),v=Math.max(_,v)}!function(t,e){Uc(t,(t=>{const n=t.gc,i=n.length/2;let a;if(i>e){for(a=0;a<i;++a)delete t.data[n[a]];n.splice(0,i)}}))}(a,e);const b=r.indexOf(x),w=o.indexOf(v),A=t=>({width:r[t]||0,height:o[t]||0});return{first:A(0),last:A(e-1),widest:A(b),highest:A(w),widths:r,heights:o}}getLabelForValue(t){return t}getPixelForValue(t,e){return NaN}getValueForPixel(t){}getPixelForTick(t){const e=this.ticks;return t<0||t>e.length-1?null:this.getPixelForValue(e[t].value)}getPixelForDecimal(t){this._reversePixels&&(t=1-t);const e=this._startPixel+t*this._length;return _u(this._alignToPixels?Yu(this.chart,e,0):e,-32768,32767)}getDecimalForPixel(t){const e=(t-this._startPixel)/this._length;return this._reversePixels?1-e:e}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:t,max:e}=this;return t<0&&e<0?e:t>0&&e>0?t:0}getContext(t){const e=this.ticks||[];if(t>=0&&t<e.length){const n=e[t];return n.$context||(n.$context=function(t,e,n){return mh(t,{tick:n,index:e,type:"tick"})}(this.getContext(),t,n))}return this.$context||(this.$context=function(t,e){return mh(t,{scale:e,type:"scale"})}(this.chart.getContext(),this))}_tickSize(){const t=this.options.ticks,e=fu(this.labelRotation),n=Math.abs(Math.cos(e)),i=Math.abs(Math.sin(e)),a=this._getLabelSizes(),r=t.autoSkipPadding||0,o=a?a.widest.width+r:0,s=a?a.highest.height+r:0;return this.isHorizontal()?s*n>o*i?o/n:s/i:s*i<o*n?s/n:o/i}_isVisible(){const t=this.options.display;return"auto"!==t?!!t:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(t){const e=this.axis,n=this.chart,i=this.options,{grid:a,position:r,border:o}=i,s=a.offset,l=this.isHorizontal(),c=this.ticks.length+(s?1:0),u=rp(a),h=[],d=o.setContext(this.getContext()),p=d.display?d.width:0,f=p/2,m=function(t){return Yu(n,t,p)};let g,_,y,x,v,b,w,A,C,E,T,S;if("top"===r)g=m(this.bottom),b=this.bottom-u,A=g-f,E=m(t.top)+f,S=t.bottom;else if("bottom"===r)g=m(this.top),E=t.top,S=m(t.bottom)-f,b=g+f,A=this.top+u;else if("left"===r)g=m(this.right),v=this.right-u,w=g-f,C=m(t.left)+f,T=t.right;else if("right"===r)g=m(this.left),C=t.left,T=m(t.right)-f,v=g+f,w=this.left+u;else if("x"===e){if("center"===r)g=m((t.top+t.bottom)/2+.5);else if(Rc(r)){const t=Object.keys(r)[0],e=r[t];g=m(this.chart.scales[t].getPixelForValue(e))}E=t.top,S=t.bottom,b=g+f,A=b+u}else if("y"===e){if("center"===r)g=m((t.left+t.right)/2);else if(Rc(r)){const t=Object.keys(r)[0],e=r[t];g=m(this.chart.scales[t].getPixelForValue(e))}v=g-f,w=v-u,C=t.left,T=t.right}const M=jc(i.ticks.maxTicksLimit,c),k=Math.max(1,Math.ceil(c/M));for(_=0;_<c;_+=k){const t=this.getContext(_),e=a.setContext(t),i=o.setContext(t),r=e.lineWidth,c=e.color,u=i.dash||[],d=i.dashOffset,p=e.tickWidth,f=e.tickColor,m=e.tickBorderDash||[],g=e.tickBorderDashOffset;y=ap(this,_,s),void 0!==y&&(x=Yu(n,y,r),l?v=w=C=T=x:b=A=E=S=x,h.push({tx1:v,ty1:b,tx2:w,ty2:A,x1:C,y1:E,x2:T,y2:S,width:r,color:c,borderDash:u,borderDashOffset:d,tickWidth:p,tickColor:f,tickBorderDash:m,tickBorderDashOffset:g}))}return this._ticksLength=c,this._borderValue=g,h}_computeLabelItems(t){const e=this.axis,n=this.options,{position:i,ticks:a}=n,r=this.isHorizontal(),o=this.ticks,{align:s,crossAlign:l,padding:c,mirror:u}=a,h=rp(n.grid),d=h+c,p=u?-c:d,f=-fu(this.labelRotation),m=[];let g,_,y,x,v,b,w,A,C,E,T,S,M="middle";if("top"===i)b=this.bottom-p,w=this._getXAxisLabelAlignment();else if("bottom"===i)b=this.top+p,w=this._getXAxisLabelAlignment();else if("left"===i){const t=this._getYAxisLabelAlignment(h);w=t.textAlign,v=t.x}else if("right"===i){const t=this._getYAxisLabelAlignment(h);w=t.textAlign,v=t.x}else if("x"===e){if("center"===i)b=(t.top+t.bottom)/2+d;else if(Rc(i)){const t=Object.keys(i)[0],e=i[t];b=this.chart.scales[t].getPixelForValue(e)+d}w=this._getXAxisLabelAlignment()}else if("y"===e){if("center"===i)v=(t.left+t.right)/2-d;else if(Rc(i)){const t=Object.keys(i)[0],e=i[t];v=this.chart.scales[t].getPixelForValue(e)}w=this._getYAxisLabelAlignment(h).textAlign}"y"===e&&("start"===s?M="top":"end"===s&&(M="bottom"));const k=this._getLabelSizes();for(g=0,_=o.length;g<_;++g){y=o[g],x=y.label;const t=a.setContext(this.getContext(g));A=this.getPixelForTick(g)+a.labelOffset,C=this._resolveTickFontOptions(g),E=C.lineHeight,T=Oc(x)?x.length:1;const e=T/2,n=t.color,s=t.textStrokeColor,c=t.textStrokeWidth;let h,d=w;if(r?(v=A,"inner"===w&&(d=g===_-1?this.options.reverse?"left":"right":0===g?this.options.reverse?"right":"left":"center"),S="top"===i?"near"===l||0!==f?-T*E+E/2:"center"===l?-k.highest.height/2-e*E+E:-k.highest.height+E/2:"near"===l||0!==f?E/2:"center"===l?k.highest.height/2-e*E:k.highest.height-T*E,u&&(S*=-1),0===f||t.showLabelBackdrop||(v+=E/2*Math.sin(f))):(b=A,S=(1-T)*E/2),t.showLabelBackdrop){const e=dh(t.backdropPadding),n=k.heights[g],i=k.widths[g];let a=S-e.top,r=0-e.left;switch(M){case"middle":a-=n/2;break;case"bottom":a-=n}switch(w){case"center":r-=i/2;break;case"right":r-=i;break;case"inner":g===_-1?r-=i:g>0&&(r-=i/2)}h={left:r,top:a,width:i+e.width,height:n+e.height,color:t.backdropColor}}m.push({label:x,font:C,textOffset:S,options:{rotation:f,color:n,strokeColor:s,strokeWidth:c,textAlign:d,textBaseline:M,translation:[v,b],backdrop:h}})}return m}_getXAxisLabelAlignment(){const{position:t,ticks:e}=this.options;if(-fu(this.labelRotation))return"top"===t?"left":"right";let n="center";return"start"===e.align?n="left":"end"===e.align?n="right":"inner"===e.align&&(n="inner"),n}_getYAxisLabelAlignment(t){const{position:e,ticks:{crossAlign:n,mirror:i,padding:a}}=this.options,r=t+a,o=this._getLabelSizes().widest.width;let s,l;return"left"===e?i?(l=this.right+a,"near"===n?s="left":"center"===n?(s="center",l+=o/2):(s="right",l+=o)):(l=this.right-r,"near"===n?s="right":"center"===n?(s="center",l-=o/2):(s="left",l=this.left)):"right"===e?i?(l=this.left+a,"near"===n?s="right":"center"===n?(s="center",l-=o/2):(s="left",l-=o)):(l=this.left+r,"near"===n?s="left":"center"===n?(s="center",l+=o/2):(s="right",l=this.right)):s="right",{textAlign:s,x:l}}_computeLabelArea(){if(this.options.ticks.mirror)return;const t=this.chart,e=this.options.position;return"left"===e||"right"===e?{top:0,left:this.left,bottom:t.height,right:this.right}:"top"===e||"bottom"===e?{top:this.top,left:0,bottom:this.bottom,right:t.width}:void 0}drawBackground(){const{ctx:t,options:{backgroundColor:e},left:n,top:i,width:a,height:r}=this;e&&(t.save(),t.fillStyle=e,t.fillRect(n,i,a,r),t.restore())}getLineWidthForValue(t){const e=this.options.grid;if(!this._isVisible()||!e.display)return 0;const n=this.ticks.findIndex((e=>e.value===t));return n>=0?e.setContext(this.getContext(n)).lineWidth:0}drawGrid(t){const e=this.options.grid,n=this.ctx,i=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(t));let a,r;const o=(t,e,i)=>{i.width&&i.color&&(n.save(),n.lineWidth=i.width,n.strokeStyle=i.color,n.setLineDash(i.borderDash||[]),n.lineDashOffset=i.borderDashOffset,n.beginPath(),n.moveTo(t.x,t.y),n.lineTo(e.x,e.y),n.stroke(),n.restore())};if(e.display)for(a=0,r=i.length;a<r;++a){const t=i[a];e.drawOnChartArea&&o({x:t.x1,y:t.y1},{x:t.x2,y:t.y2},t),e.drawTicks&&o({x:t.tx1,y:t.ty1},{x:t.tx2,y:t.ty2},{color:t.tickColor,width:t.tickWidth,borderDash:t.tickBorderDash,borderDashOffset:t.tickBorderDashOffset})}}drawBorder(){const{chart:t,ctx:e,options:{border:n,grid:i}}=this,a=n.setContext(this.getContext()),r=n.display?a.width:0;if(!r)return;const o=i.setContext(this.getContext(0)).lineWidth,s=this._borderValue;let l,c,u,h;this.isHorizontal()?(l=Yu(t,this.left,r)-r/2,c=Yu(t,this.right,o)+o/2,u=h=s):(u=Yu(t,this.top,r)-r/2,h=Yu(t,this.bottom,o)+o/2,l=c=s),e.save(),e.lineWidth=a.width,e.strokeStyle=a.color,e.beginPath(),e.moveTo(l,u),e.lineTo(c,h),e.stroke(),e.restore()}drawLabels(t){if(!this.options.ticks.display)return;const e=this.ctx,n=this._computeLabelArea();n&&Ju(e,n);const i=this.getLabelItems(t);for(const t of i){const n=t.options,i=t.font;ih(e,t.label,0,t.textOffset,i,n)}n&&th(e)}drawTitle(){const{ctx:t,options:{position:e,title:n,reverse:i}}=this;if(!n.display)return;const a=ph(n.font),r=dh(n.padding),o=n.align;let s=a.lineHeight/2;"bottom"===e||"center"===e||Rc(e)?(s+=r.bottom,Oc(n.text)&&(s+=a.lineHeight*(n.text.length-1))):s+=r.top;const{titleX:l,titleY:c,maxWidth:u,rotation:h}=function(t,e,n,i){const{top:a,left:r,bottom:o,right:s,chart:l}=t,{chartArea:c,scales:u}=l;let h,d,p,f=0;const m=o-a,g=s-r;if(t.isHorizontal()){if(d=Mu(i,r,s),Rc(n)){const t=Object.keys(n)[0],i=n[t];p=u[t].getPixelForValue(i)+m-e}else p="center"===n?(c.bottom+c.top)/2+m-e:ep(t,n,e);h=s-r}else{if(Rc(n)){const t=Object.keys(n)[0],i=n[t];d=u[t].getPixelForValue(i)-g+e}else d="center"===n?(c.left+c.right)/2-g+e:ep(t,n,e);p=Mu(i,o,a),f="left"===n?-ou:ou}return{titleX:d,titleY:p,maxWidth:h,rotation:f}}(this,s,e,o);ih(t,n.text,0,0,a,{color:n.color,maxWidth:u,rotation:h,textAlign:sp(o,e,i),textBaseline:"middle",translation:[l,c]})}draw(t){this._isVisible()&&(this.drawBackground(),this.drawGrid(t),this.drawBorder(),this.drawTitle(),this.drawLabels(t))}_layers(){const t=this.options,e=t.ticks&&t.ticks.z||0,n=jc(t.grid&&t.grid.z,-1),i=jc(t.border&&t.border.z,0);return this._isVisible()&&this.draw===lp.prototype.draw?[{z:n,draw:t=>{this.drawBackground(),this.drawGrid(t),this.drawTitle()}},{z:i,draw:()=>{this.drawBorder()}},{z:e,draw:t=>{this.drawLabels(t)}}]:[{z:e,draw:t=>{this.draw(t)}}]}getMatchingVisibleMetas(t){const e=this.chart.getSortedVisibleDatasetMetas(),n=this.axis+"AxisID",i=[];let a,r;for(a=0,r=e.length;a<r;++a){const r=e[a];r[n]!==this.id||t&&r.type!==t||i.push(r)}return i}_resolveTickFontOptions(t){return ph(this.options.ticks.setContext(this.getContext(t)).font)}_maxDigits(){const t=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/t}}class cp{constructor(t,e,n){this.type=t,this.scope=e,this.override=n,this.items=Object.create(null)}isForType(t){return Object.prototype.isPrototypeOf.call(this.type.prototype,t.prototype)}register(t){const e=Object.getPrototypeOf(t);let n;(function(t){return"id"in t&&"defaults"in t})(e)&&(n=this.register(e));const i=this.items,a=t.id,r=this.scope+"."+a;if(!a)throw new Error("class does not have id: "+t);return a in i||(i[a]=t,function(t,e,n){const i=Hc(Object.create(null),[n?Hu.get(n):{},Hu.get(e),t.defaults]);Hu.set(e,i),t.defaultRoutes&&function(t,e){Object.keys(e).forEach((n=>{const i=n.split("."),a=i.pop(),r=[t].concat(i).join("."),o=e[n].split("."),s=o.pop(),l=o.join(".");Hu.route(r,a,l,s)}))}(e,t.defaultRoutes),t.descriptors&&Hu.describe(e,t.descriptors)}(t,r,n),this.override&&Hu.override(t.id,t.overrides)),r}get(t){return this.items[t]}unregister(t){const e=this.items,n=t.id,i=this.scope;n in e&&delete e[n],i&&n in Hu[i]&&(delete Hu[i][n],this.override&&delete Uu[n])}}class up{constructor(){this.controllers=new cp(rd,"datasets",!0),this.elements=new cp(Jd,"elements"),this.plugins=new cp(Object,"plugins"),this.scales=new cp(lp,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...t){this._each("register",t)}remove(...t){this._each("unregister",t)}addControllers(...t){this._each("register",t,this.controllers)}addElements(...t){this._each("register",t,this.elements)}addPlugins(...t){this._each("register",t,this.plugins)}addScales(...t){this._each("register",t,this.scales)}getController(t){return this._get(t,this.controllers,"controller")}getElement(t){return this._get(t,this.elements,"element")}getPlugin(t){return this._get(t,this.plugins,"plugin")}getScale(t){return this._get(t,this.scales,"scale")}removeControllers(...t){this._each("unregister",t,this.controllers)}removeElements(...t){this._each("unregister",t,this.elements)}removePlugins(...t){this._each("unregister",t,this.plugins)}removeScales(...t){this._each("unregister",t,this.scales)}_each(t,e,n){[...e].forEach((e=>{const i=n||this._getRegistryForType(e);n||i.isForType(e)||i===this.plugins&&e.id?this._exec(t,i,e):Uc(e,(e=>{const i=n||this._getRegistryForType(e);this._exec(t,i,e)}))}))}_exec(t,e,n){const i=Qc(t);Vc(n["before"+i],[],n),e[t](n),Vc(n["after"+i],[],n)}_getRegistryForType(t){for(let e=0;e<this._typedRegistries.length;e++){const n=this._typedRegistries[e];if(n.isForType(t))return n}return this.plugins}_get(t,e,n){const i=e.get(t);if(void 0===i)throw new Error('"'+t+'" is not a registered '+n+".");return i}}var hp=new up;class dp{constructor(){this._init=[]}notify(t,e,n,i){"beforeInit"===e&&(this._init=this._createDescriptors(t,!0),this._notify(this._init,t,"install"));const a=i?this._descriptors(t).filter(i):this._descriptors(t),r=this._notify(a,t,e,n);return"afterDestroy"===e&&(this._notify(a,t,"stop"),this._notify(this._init,t,"uninstall")),r}_notify(t,e,n,i){i=i||{};for(const a of t){const t=a.plugin;if(!1===Vc(t[n],[e,i,a.options],t)&&i.cancelable)return!1}return!0}invalidate(){Bc(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(t){if(this._cache)return this._cache;const e=this._cache=this._createDescriptors(t);return this._notifyStateChanges(t),e}_createDescriptors(t,e){const n=t&&t.config,i=jc(n.options&&n.options.plugins,{}),a=function(t){const e={},n=[],i=Object.keys(hp.plugins.items);for(let t=0;t<i.length;t++)n.push(hp.getPlugin(i[t]));const a=t.plugins||[];for(let t=0;t<a.length;t++){const i=a[t];-1===n.indexOf(i)&&(n.push(i),e[i.id]=!0)}return{plugins:n,localIds:e}}(n);return!1!==i||e?function(t,{plugins:e,localIds:n},i,a){const r=[],o=t.getContext();for(const s of e){const e=s.id,l=pp(i[e],a);null!==l&&r.push({plugin:s,options:fp(t.config,{plugin:s,local:n[e]},l,o)})}return r}(t,a,i,e):[]}_notifyStateChanges(t){const e=this._oldCache||[],n=this._cache,i=(t,e)=>t.filter((t=>!e.some((e=>t.plugin.id===e.plugin.id))));this._notify(i(e,n),t,"stop"),this._notify(i(n,e),t,"start")}}function pp(t,e){return e||!1!==t?!0===t?{}:t:null}function fp(t,{plugin:e,local:n},i,a){const r=t.pluginScopeKeys(e),o=t.getOptionScopes(i,r);return n&&e.defaults&&o.push(e.defaults),t.createResolver(o,a,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function mp(t,e){const n=Hu.datasets[t]||{};return((e.datasets||{})[t]||{}).indexAxis||e.indexAxis||n.indexAxis||"x"}function gp(t){if("x"===t||"y"===t||"r"===t)return t}function _p(t){return"top"===t||"bottom"===t?"x":"left"===t||"right"===t?"y":void 0}function yp(t,...e){if(gp(t))return t;for(const n of e){const e=n.axis||_p(n.position)||t.length>1&&gp(t[0].toLowerCase());if(e)return e}throw new Error(`Cannot determine type of '${t}' axis. Please provide 'axis' or 'position' option.`)}function xp(t,e,n){if(n[e+"AxisID"]===t)return{axis:e}}function vp(t){const e=t.options||(t.options={});e.plugins=jc(e.plugins,{}),e.scales=function(t,e){const n=Uu[t.type]||{scales:{}},i=e.scales||{},a=mp(t.type,e),r=Object.create(null);return Object.keys(i).forEach((e=>{const o=i[e];if(!Rc(o))return console.error(`Invalid scale configuration for scale: ${e}`);if(o._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${e}`);const s=yp(e,o,function(t,e){if(e.data&&e.data.datasets){const n=e.data.datasets.filter((e=>e.xAxisID===t||e.yAxisID===t));if(n.length)return xp(t,"x",n[0])||xp(t,"y",n[0])}return{}}(e,t),Hu.scales[o.type]),l=function(t,e){return t===e?"_index_":"_value_"}(s,a),c=n.scales||{};r[e]=Zc(Object.create(null),[{axis:s},o,c[s],c[l]])})),t.data.datasets.forEach((n=>{const a=n.type||t.type,o=n.indexAxis||mp(a,e),s=(Uu[a]||{}).scales||{};Object.keys(s).forEach((t=>{const e=function(t,e){let n=t;return"_index_"===t?n=e:"_value_"===t&&(n="x"===e?"y":"x"),n}(t,o),a=n[e+"AxisID"]||e;r[a]=r[a]||Object.create(null),Zc(r[a],[{axis:e},i[a],s[t]])}))})),Object.keys(r).forEach((t=>{const e=r[t];Zc(e,[Hu.scales[e.type],Hu.scale])})),r}(t,e)}function bp(t){return(t=t||{}).datasets=t.datasets||[],t.labels=t.labels||[],t}const wp=new Map,Ap=new Set;function Cp(t,e){let n=wp.get(t);return n||(n=e(),wp.set(t,n),Ap.add(n)),n}const Ep=(t,e,n)=>{const i=Kc(e,n);void 0!==i&&t.add(i)};class Tp{constructor(t){this._config=function(t){return(t=t||{}).data=bp(t.data),vp(t),t}(t),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(t){this._config.type=t}get data(){return this._config.data}set data(t){this._config.data=bp(t)}get options(){return this._config.options}set options(t){this._config.options=t}get plugins(){return this._config.plugins}update(){const t=this._config;this.clearCache(),vp(t)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(t){return Cp(t,(()=>[[`datasets.${t}`,""]]))}datasetAnimationScopeKeys(t,e){return Cp(`${t}.transition.${e}`,(()=>[[`datasets.${t}.transitions.${e}`,`transitions.${e}`],[`datasets.${t}`,""]]))}datasetElementScopeKeys(t,e){return Cp(`${t}-${e}`,(()=>[[`datasets.${t}.elements.${e}`,`datasets.${t}`,`elements.${e}`,""]]))}pluginScopeKeys(t){const e=t.id;return Cp(`${this.type}-plugin-${e}`,(()=>[[`plugins.${e}`,...t.additionalOptionScopes||[]]]))}_cachedScopes(t,e){const n=this._scopeCache;let i=n.get(t);return i&&!e||(i=new Map,n.set(t,i)),i}getOptionScopes(t,e,n){const{options:i,type:a}=this,r=this._cachedScopes(t,n),o=r.get(e);if(o)return o;const s=new Set;e.forEach((e=>{t&&(s.add(t),e.forEach((e=>Ep(s,t,e)))),e.forEach((t=>Ep(s,i,t))),e.forEach((t=>Ep(s,Uu[a]||{},t))),e.forEach((t=>Ep(s,Hu,t))),e.forEach((t=>Ep(s,Gu,t)))}));const l=Array.from(s);return 0===l.length&&l.push(Object.create(null)),Ap.has(e)&&r.set(e,l),l}chartOptionScopes(){const{options:t,type:e}=this;return[t,Uu[e]||{},Hu.datasets[e]||{},{type:e},Hu,Gu]}resolveNamedOptions(t,e,n,i=[""]){const a={$shared:!0},{resolver:r,subPrefixes:o}=Sp(this._resolverCache,t,i);let s=r;(function(t,e){const{isScriptable:n,isIndexable:i}=yh(t);for(const a of e){const e=n(a),r=i(a),o=(r||e)&&t[a];if(e&&(tu(o)||Mp(o))||r&&Oc(o))return!0}return!1})(r,e)&&(a.$shared=!1,s=_h(r,n=tu(n)?n():n,this.createResolver(t,n,o)));for(const t of e)a[t]=s[t];return a}createResolver(t,e,n=[""],i){const{resolver:a}=Sp(this._resolverCache,t,n);return Rc(e)?_h(a,e,void 0,i):a}}function Sp(t,e,n){let i=t.get(e);i||(i=new Map,t.set(e,i));const a=n.join();let r=i.get(a);return r||(r={resolver:gh(e,n),subPrefixes:n.filter((t=>!t.toLowerCase().includes("hover")))},i.set(a,r)),r}const Mp=t=>Rc(t)&&Object.getOwnPropertyNames(t).some((e=>tu(t[e]))),kp=["top","bottom","left","right","chartArea"];function Ip(t,e){return"top"===t||"bottom"===t||-1===kp.indexOf(t)&&"x"===e}function Pp(t,e){return function(n,i){return n[t]===i[t]?n[e]-i[e]:n[t]-i[t]}}function zp(t){const e=t.chart,n=e.options.animation;e.notifyPlugins("afterRender"),Vc(n&&n.onComplete,[t],e)}function Dp(t){const e=t.chart,n=e.options.animation;Vc(n&&n.onProgress,[t],e)}function Lp(t){return kh()&&"string"==typeof t?t=document.getElementById(t):t&&t.length&&(t=t[0]),t&&t.canvas&&(t=t.canvas),t}const Bp={},Op=t=>{const e=Lp(t);return Object.values(Bp).filter((t=>t.canvas===e)).pop()};function Rp(t,e,n){const i=Object.keys(t);for(const a of i){const i=+a;if(i>=e){const r=t[a];delete t[a],(n>0||i>e)&&(t[i+n]=r)}}}function Fp(t,e,n){return t.options.clip?t[n]:e[n]}class Np{static defaults=Hu;static instances=Bp;static overrides=Uu;static registry=hp;static version="4.4.3";static getChart=Op;static register(...t){hp.add(...t),jp()}static unregister(...t){hp.remove(...t),jp()}constructor(t,e){const n=this.config=new Tp(e),i=Lp(t),a=Op(i);if(a)throw new Error("Canvas is already in use. Chart with ID '"+a.id+"' must be destroyed before the canvas with ID '"+a.canvas.id+"' can be reused.");const r=n.createResolver(n.chartOptionScopes(),this.getContext());this.platform=new(n.platform||function(t){return!kh()||"undefined"!=typeof OffscreenCanvas&&t instanceof OffscreenCanvas?Rd:Qd}(i)),this.platform.updateConfig(n);const o=this.platform.acquireContext(i,r.aspectRatio),s=o&&o.canvas,l=s&&s.height,c=s&&s.width;this.id=Lc(),this.ctx=o,this.canvas=s,this.width=c,this.height=l,this._options=r,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new dp,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=function(t,e){let n;return function(...i){return e?(clearTimeout(n),n=setTimeout(t,e,i)):t.apply(this,i),e}}((t=>this.update(t)),r.resizeDelay||0),this._dataChanges=[],Bp[this.id]=this,o&&s?(Gh.listen(this,"complete",zp),Gh.listen(this,"progress",Dp),this._initialize(),this.attached&&this.update()):console.error("Failed to create chart: can't acquire context from the given item")}get aspectRatio(){const{options:{aspectRatio:t,maintainAspectRatio:e},width:n,height:i,_aspectRatio:a}=this;return Bc(t)?e&&a?a:i?n/i:null:t}get data(){return this.config.data}set data(t){this.config.data=t}get options(){return this._options}set options(t){this.config.options=t}get registry(){return hp}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():Fh(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return Xu(this.canvas,this.ctx),this}stop(){return Gh.stop(this),this}resize(t,e){Gh.running(this)?this._resizeBeforeDraw={width:t,height:e}:this._resize(t,e)}_resize(t,e){const n=this.options,i=this.canvas,a=n.maintainAspectRatio&&this.aspectRatio,r=this.platform.getMaximumSize(i,t,e,a),o=n.devicePixelRatio||this.platform.getDevicePixelRatio(),s=this.width?"resize":"attach";this.width=r.width,this.height=r.height,this._aspectRatio=this.aspectRatio,Fh(this,o,!0)&&(this.notifyPlugins("resize",{size:r}),Vc(n.onResize,[this,r],this),this.attached&&this._doResize(s)&&this.render())}ensureScalesHaveIDs(){Uc(this.options.scales||{},((t,e)=>{t.id=e}))}buildOrUpdateScales(){const t=this.options,e=t.scales,n=this.scales,i=Object.keys(n).reduce(((t,e)=>(t[e]=!1,t)),{});let a=[];e&&(a=a.concat(Object.keys(e).map((t=>{const n=e[t],i=yp(t,n),a="r"===i,r="x"===i;return{options:n,dposition:a?"chartArea":r?"bottom":"left",dtype:a?"radialLinear":r?"category":"linear"}})))),Uc(a,(e=>{const a=e.options,r=a.id,o=yp(r,a),s=jc(a.type,e.dtype);void 0!==a.position&&Ip(a.position,o)===Ip(e.dposition)||(a.position=e.dposition),i[r]=!0;let l=null;r in n&&n[r].type===s?l=n[r]:(l=new(hp.getScale(s))({id:r,type:s,ctx:this.ctx,chart:this}),n[l.id]=l),l.init(a,t)})),Uc(i,((t,e)=>{t||delete n[e]})),Uc(n,(t=>{Bd.configure(this,t,t.options),Bd.addBox(this,t)}))}_updateMetasets(){const t=this._metasets,e=this.data.datasets.length,n=t.length;if(t.sort(((t,e)=>t.index-e.index)),n>e){for(let t=e;t<n;++t)this._destroyDatasetMeta(t);t.splice(e,n-e)}this._sortedMetasets=t.slice(0).sort(Pp("order","index"))}_removeUnreferencedMetasets(){const{_metasets:t,data:{datasets:e}}=this;t.length>e.length&&delete this._stacks,t.forEach(((t,n)=>{0===e.filter((e=>e===t._dataset)).length&&this._destroyDatasetMeta(n)}))}buildOrUpdateControllers(){const t=[],e=this.data.datasets;let n,i;for(this._removeUnreferencedMetasets(),n=0,i=e.length;n<i;n++){const i=e[n];let a=this.getDatasetMeta(n);const r=i.type||this.config.type;if(a.type&&a.type!==r&&(this._destroyDatasetMeta(n),a=this.getDatasetMeta(n)),a.type=r,a.indexAxis=i.indexAxis||mp(r,this.options),a.order=i.order||0,a.index=n,a.label=""+i.label,a.visible=this.isDatasetVisible(n),a.controller)a.controller.updateIndex(n),a.controller.linkScales();else{const e=hp.getController(r),{datasetElementType:i,dataElementType:o}=Hu.datasets[r];Object.assign(e,{dataElementType:hp.getElement(o),datasetElementType:i&&hp.getElement(i)}),a.controller=new e(this,n),t.push(a.controller)}}return this._updateMetasets(),t}_resetElements(){Uc(this.data.datasets,((t,e)=>{this.getDatasetMeta(e).controller.reset()}),this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(t){const e=this.config;e.update();const n=this._options=e.createResolver(e.chartOptionScopes(),this.getContext()),i=this._animationsDisabled=!n.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),!1===this.notifyPlugins("beforeUpdate",{mode:t,cancelable:!0}))return;const a=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let r=0;for(let t=0,e=this.data.datasets.length;t<e;t++){const{controller:e}=this.getDatasetMeta(t),n=!i&&-1===a.indexOf(e);e.buildOrUpdateElements(n),r=Math.max(+e.getMaxOverflow(),r)}r=this._minPadding=n.layout.autoPadding?r:0,this._updateLayout(r),i||Uc(a,(t=>{t.reset()})),this._updateDatasets(t),this.notifyPlugins("afterUpdate",{mode:t}),this._layers.sort(Pp("z","_idx"));const{_active:o,_lastEvent:s}=this;s?this._eventHandler(s,!0):o.length&&this._updateHoverStyles(o,o,!0),this.render()}_updateScales(){Uc(this.scales,(t=>{Bd.removeBox(this,t)})),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const t=this.options,e=new Set(Object.keys(this._listeners)),n=new Set(t.events);eu(e,n)&&!!this._responsiveListeners===t.responsive||(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:t}=this,e=this._getUniformDataChanges()||[];for(const{method:n,start:i,count:a}of e)Rp(t,i,"_removeElements"===n?-a:a)}_getUniformDataChanges(){const t=this._dataChanges;if(!t||!t.length)return;this._dataChanges=[];const e=this.data.datasets.length,n=e=>new Set(t.filter((t=>t[0]===e)).map(((t,e)=>e+","+t.splice(1).join(",")))),i=n(0);for(let t=1;t<e;t++)if(!eu(i,n(t)))return;return Array.from(i).map((t=>t.split(","))).map((t=>({method:t[1],start:+t[2],count:+t[3]})))}_updateLayout(t){if(!1===this.notifyPlugins("beforeLayout",{cancelable:!0}))return;Bd.update(this,this.width,this.height,t);const e=this.chartArea,n=e.width<=0||e.height<=0;this._layers=[],Uc(this.boxes,(t=>{n&&"chartArea"===t.position||(t.configure&&t.configure(),this._layers.push(...t._layers()))}),this),this._layers.forEach(((t,e)=>{t._idx=e})),this.notifyPlugins("afterLayout")}_updateDatasets(t){if(!1!==this.notifyPlugins("beforeDatasetsUpdate",{mode:t,cancelable:!0})){for(let t=0,e=this.data.datasets.length;t<e;++t)this.getDatasetMeta(t).controller.configure();for(let e=0,n=this.data.datasets.length;e<n;++e)this._updateDataset(e,tu(t)?t({datasetIndex:e}):t);this.notifyPlugins("afterDatasetsUpdate",{mode:t})}}_updateDataset(t,e){const n=this.getDatasetMeta(t),i={meta:n,index:t,mode:e,cancelable:!0};!1!==this.notifyPlugins("beforeDatasetUpdate",i)&&(n.controller._update(e),i.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",i))}render(){!1!==this.notifyPlugins("beforeRender",{cancelable:!0})&&(Gh.has(this)?this.attached&&!Gh.running(this)&&Gh.start(this):(this.draw(),zp({chart:this})))}draw(){let t;if(this._resizeBeforeDraw){const{width:t,height:e}=this._resizeBeforeDraw;this._resize(t,e),this._resizeBeforeDraw=null}if(this.clear(),this.width<=0||this.height<=0)return;if(!1===this.notifyPlugins("beforeDraw",{cancelable:!0}))return;const e=this._layers;for(t=0;t<e.length&&e[t].z<=0;++t)e[t].draw(this.chartArea);for(this._drawDatasets();t<e.length;++t)e[t].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(t){const e=this._sortedMetasets,n=[];let i,a;for(i=0,a=e.length;i<a;++i){const a=e[i];t&&!a.visible||n.push(a)}return n}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(!1===this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0}))return;const t=this.getSortedVisibleDatasetMetas();for(let e=t.length-1;e>=0;--e)this._drawDataset(t[e]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(t){const e=this.ctx,n=t._clip,i=!n.disabled,a=function(t,e){const{xScale:n,yScale:i}=t;return n&&i?{left:Fp(n,e,"left"),right:Fp(n,e,"right"),top:Fp(i,e,"top"),bottom:Fp(i,e,"bottom")}:e}(t,this.chartArea),r={meta:t,index:t.index,cancelable:!0};!1!==this.notifyPlugins("beforeDatasetDraw",r)&&(i&&Ju(e,{left:!1===n.left?0:a.left-n.left,right:!1===n.right?this.width:a.right+n.right,top:!1===n.top?0:a.top-n.top,bottom:!1===n.bottom?this.height:a.bottom+n.bottom}),t.controller.draw(),i&&th(e),r.cancelable=!1,this.notifyPlugins("afterDatasetDraw",r))}isPointInArea(t){return Qu(t,this.chartArea,this._minPadding)}getElementsAtEventForMode(t,e,n,i){const a=Ad.modes[e];return"function"==typeof a?a(this,t,n,i):[]}getDatasetMeta(t){const e=this.data.datasets[t],n=this._metasets;let i=n.filter((t=>t&&t._dataset===e)).pop();return i||(i={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:e&&e.order||0,index:t,_dataset:e,_parsed:[],_sorted:!1},n.push(i)),i}getContext(){return this.$context||(this.$context=mh(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(t){const e=this.data.datasets[t];if(!e)return!1;const n=this.getDatasetMeta(t);return"boolean"==typeof n.hidden?!n.hidden:!e.hidden}setDatasetVisibility(t,e){this.getDatasetMeta(t).hidden=!e}toggleDataVisibility(t){this._hiddenIndices[t]=!this._hiddenIndices[t]}getDataVisibility(t){return!this._hiddenIndices[t]}_updateVisibility(t,e,n){const i=n?"show":"hide",a=this.getDatasetMeta(t),r=a.controller._resolveAnimations(void 0,i);Jc(e)?(a.data[e].hidden=!n,this.update()):(this.setDatasetVisibility(t,n),r.update(a,{visible:n}),this.update((e=>e.datasetIndex===t?i:void 0)))}hide(t,e){this._updateVisibility(t,e,!1)}show(t,e){this._updateVisibility(t,e,!0)}_destroyDatasetMeta(t){const e=this._metasets[t];e&&e.controller&&e.controller._destroy(),delete this._metasets[t]}_stop(){let t,e;for(this.stop(),Gh.remove(this),t=0,e=this.data.datasets.length;t<e;++t)this._destroyDatasetMeta(t)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:t,ctx:e}=this;this._stop(),this.config.clearCache(),t&&(this.unbindEvents(),Xu(t,e),this.platform.releaseContext(e),this.canvas=null,this.ctx=null),delete Bp[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...t){return this.canvas.toDataURL(...t)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const t=this._listeners,e=this.platform,n=(n,i)=>{e.addEventListener(this,n,i),t[n]=i},i=(t,e,n)=>{t.offsetX=e,t.offsetY=n,this._eventHandler(t)};Uc(this.options.events,(t=>n(t,i)))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const t=this._responsiveListeners,e=this.platform,n=(n,i)=>{e.addEventListener(this,n,i),t[n]=i},i=(n,i)=>{t[n]&&(e.removeEventListener(this,n,i),delete t[n])},a=(t,e)=>{this.canvas&&this.resize(t,e)};let r;const o=()=>{i("attach",o),this.attached=!0,this.resize(),n("resize",a),n("detach",r)};r=()=>{this.attached=!1,i("resize",a),this._stop(),this._resize(0,0),n("attach",o)},e.isAttached(this.canvas)?o():r()}unbindEvents(){Uc(this._listeners,((t,e)=>{this.platform.removeEventListener(this,e,t)})),this._listeners={},Uc(this._responsiveListeners,((t,e)=>{this.platform.removeEventListener(this,e,t)})),this._responsiveListeners=void 0}updateHoverStyle(t,e,n){const i=n?"set":"remove";let a,r,o,s;for("dataset"===e&&(a=this.getDatasetMeta(t[0].datasetIndex),a.controller["_"+i+"DatasetHoverStyle"]()),o=0,s=t.length;o<s;++o){r=t[o];const e=r&&this.getDatasetMeta(r.datasetIndex).controller;e&&e[i+"HoverStyle"](r.element,r.datasetIndex,r.index)}}getActiveElements(){return this._active||[]}setActiveElements(t){const e=this._active||[],n=t.map((({datasetIndex:t,index:e})=>{const n=this.getDatasetMeta(t);if(!n)throw new Error("No dataset found at index "+t);return{datasetIndex:t,element:n.data[e],index:e}}));!Gc(n,e)&&(this._active=n,this._lastEvent=null,this._updateHoverStyles(n,e))}notifyPlugins(t,e,n){return this._plugins.notify(this,t,e,n)}isPluginEnabled(t){return 1===this._plugins._cache.filter((e=>e.plugin.id===t)).length}_updateHoverStyles(t,e,n){const i=this.options.hover,a=(t,e)=>t.filter((t=>!e.some((e=>t.datasetIndex===e.datasetIndex&&t.index===e.index)))),r=a(e,t),o=n?t:a(t,e);r.length&&this.updateHoverStyle(r,i.mode,!1),o.length&&i.mode&&this.updateHoverStyle(o,i.mode,!0)}_eventHandler(t,e){const n={event:t,replay:e,cancelable:!0,inChartArea:this.isPointInArea(t)},i=e=>(e.options.events||this.options.events).includes(t.native.type);if(!1===this.notifyPlugins("beforeEvent",n,i))return;const a=this._handleEvent(t,e,n.inChartArea);return n.cancelable=!1,this.notifyPlugins("afterEvent",n,i),(a||n.changed)&&this.render(),this}_handleEvent(t,e,n){const{_active:i=[],options:a}=this,r=e,o=this._getActiveElements(t,i,n,r),s=function(t){return"mouseup"===t.type||"click"===t.type||"contextmenu"===t.type}(t),l=function(t,e,n,i){return n&&"mouseout"!==t.type?i?e:t:null}(t,this._lastEvent,n,s);n&&(this._lastEvent=null,Vc(a.onHover,[t,o,this],this),s&&Vc(a.onClick,[t,o,this],this));const c=!Gc(o,i);return(c||e)&&(this._active=o,this._updateHoverStyles(o,i,e)),this._lastEvent=l,c}_getActiveElements(t,e,n,i){if("mouseout"===t.type)return[];if(!n)return e;const a=this.options.hover;return this.getElementsAtEventForMode(t,a.mode,a,i)}}function jp(){return Uc(Np.instances,(t=>t._plugins.invalidate()))}function Vp(t,e){const{x:n,y:i,base:a,width:r,height:o}=t.getProps(["x","y","base","width","height"],e);let s,l,c,u,h;return t.horizontal?(h=o/2,s=Math.min(n,a),l=Math.max(n,a),c=i-h,u=i+h):(h=r/2,s=n-h,l=n+h,c=Math.min(i,a),u=Math.max(i,a)),{left:s,top:c,right:l,bottom:u}}function Up(t,e,n,i){return t?0:_u(e,n,i)}function Gp(t,e,n,i){const a=null===e,r=null===n,o=t&&!(a&&r)&&Vp(t,i);return o&&(a||yu(e,o.left,o.right))&&(r||yu(n,o.top,o.bottom))}function qp(t,e){t.rect(e.x,e.y,e.w,e.h)}function $p(t,e,n={}){const i=t.x!==n.x?-e:0,a=t.y!==n.y?-e:0,r=(t.x+t.w!==n.x+n.w?e:0)-i,o=(t.y+t.h!==n.y+n.h?e:0)-a;return{x:t.x+i,y:t.y+a,w:t.w+r,h:t.h+o,radius:t.radius}}class Wp extends Jd{static id="bar";static defaults={borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};constructor(t){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,t&&Object.assign(this,t)}draw(t){const{inflateAmount:e,options:{borderColor:n,backgroundColor:i}}=this,{inner:a,outer:r}=function(t){const e=Vp(t),n=e.right-e.left,i=e.bottom-e.top,a=function(t,e,n){const i=t.options.borderWidth,a=t.borderSkipped,r=uh(i);return{t:Up(a.top,r.top,0,n),r:Up(a.right,r.right,0,e),b:Up(a.bottom,r.bottom,0,n),l:Up(a.left,r.left,0,e)}}(t,n/2,i/2),r=function(t,e,n){const{enableBorderRadius:i}=t.getProps(["enableBorderRadius"]),a=t.options.borderRadius,r=hh(a),o=Math.min(e,n),s=t.borderSkipped,l=i||Rc(a);return{topLeft:Up(!l||s.top||s.left,r.topLeft,0,o),topRight:Up(!l||s.top||s.right,r.topRight,0,o),bottomLeft:Up(!l||s.bottom||s.left,r.bottomLeft,0,o),bottomRight:Up(!l||s.bottom||s.right,r.bottomRight,0,o)}}(t,n/2,i/2);return{outer:{x:e.left,y:e.top,w:n,h:i,radius:r},inner:{x:e.left+a.l,y:e.top+a.t,w:n-a.l-a.r,h:i-a.t-a.b,radius:{topLeft:Math.max(0,r.topLeft-Math.max(a.t,a.l)),topRight:Math.max(0,r.topRight-Math.max(a.t,a.r)),bottomLeft:Math.max(0,r.bottomLeft-Math.max(a.b,a.l)),bottomRight:Math.max(0,r.bottomRight-Math.max(a.b,a.r))}}}}(this),o=(s=r.radius).topLeft||s.topRight||s.bottomLeft||s.bottomRight?ah:qp;var s;t.save(),r.w===a.w&&r.h===a.h||(t.beginPath(),o(t,$p(r,e,a)),t.clip(),o(t,$p(a,-e,r)),t.fillStyle=n,t.fill("evenodd")),t.beginPath(),o(t,$p(a,e)),t.fillStyle=i,t.fill(),t.restore()}inRange(t,e,n){return Gp(this,t,e,n)}inXRange(t,e){return Gp(this,t,null,e)}inYRange(t,e){return Gp(this,null,t,e)}getCenterPoint(t){const{x:e,y:n,base:i,horizontal:a}=this.getProps(["x","y","base","horizontal"],t);return{x:a?(e+i)/2:e,y:a?n:(n+i)/2}}getRange(t){return"x"===t?this.width/2:this.height/2}}class Hp extends Jd{constructor(t){super(),this.chart=t.chart,this.options=t.options,this.ctx=t.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(t,e){const n=this.options;if(this.left=0,this.top=0,!n.display)return void(this.width=this.height=this.right=this.bottom=0);this.width=this.right=t,this.height=this.bottom=e;const i=Oc(n.text)?n.text.length:1;this._padding=dh(n.padding);const a=i*ph(n.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=a:this.width=a}isHorizontal(){const t=this.options.position;return"top"===t||"bottom"===t}_drawArgs(t){const{top:e,left:n,bottom:i,right:a,options:r}=this,o=r.align;let s,l,c,u=0;return this.isHorizontal()?(l=Mu(o,n,a),c=e+t,s=a-n):("left"===r.position?(l=n+t,c=Mu(o,i,e),u=-.5*nu):(l=a-t,c=Mu(o,e,i),u=.5*nu),s=i-e),{titleX:l,titleY:c,maxWidth:s,rotation:u}}draw(){const t=this.ctx,e=this.options;if(!e.display)return;const n=ph(e.font),i=n.lineHeight/2+this._padding.top,{titleX:a,titleY:r,maxWidth:o,rotation:s}=this._drawArgs(i);ih(t,e.text,0,0,n,{color:e.color,maxWidth:o,rotation:s,textAlign:Su(e.align),textBaseline:"middle",translation:[a,r]})}}var Zp={id:"title",_element:Hp,start(t,e,n){!function(t,e){const n=new Hp({ctx:t.ctx,options:e,chart:t});Bd.configure(t,n,e),Bd.addBox(t,n),t.titleBlock=n}(t,n)},stop(t){const e=t.titleBlock;Bd.removeBox(t,e),delete t.titleBlock},beforeUpdate(t,e,n){const i=t.titleBlock;Bd.configure(t,i,n),i.options=n},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};new WeakMap;const Yp={average(t){if(!t.length)return!1;let e,n,i=new Set,a=0,r=0;for(e=0,n=t.length;e<n;++e){const n=t[e].element;if(n&&n.hasValue()){const t=n.tooltipPosition();i.add(t.x),a+=t.y,++r}}const o=[...i].reduce(((t,e)=>t+e))/i.size;return{x:o,y:a/r}},nearest(t,e){if(!t.length)return!1;let n,i,a,r=e.x,o=e.y,s=Number.POSITIVE_INFINITY;for(n=0,i=t.length;n<i;++n){const i=t[n].element;if(i&&i.hasValue()){const t=(l=e,c=i.getCenterPoint(),Math.sqrt(Math.pow(c.x-l.x,2)+Math.pow(c.y-l.y,2)));t<s&&(s=t,a=i)}}var l,c;if(a){const t=a.tooltipPosition();r=t.x,o=t.y}return{x:r,y:o}}};function Xp(t,e){return e&&(Oc(e)?Array.prototype.push.apply(t,e):t.push(e)),t}function Kp(t){return("string"==typeof t||t instanceof String)&&t.indexOf("\n")>-1?t.split("\n"):t}function Qp(t,e){const{element:n,datasetIndex:i,index:a}=e,r=t.getDatasetMeta(i).controller,{label:o,value:s}=r.getLabelAndValue(a);return{chart:t,label:o,parsed:r.getParsed(a),raw:t.data.datasets[i].data[a],formattedValue:s,dataset:r.getDataset(),dataIndex:a,datasetIndex:i,element:n}}function Jp(t,e){const n=t.chart.ctx,{body:i,footer:a,title:r}=t,{boxWidth:o,boxHeight:s}=e,l=ph(e.bodyFont),c=ph(e.titleFont),u=ph(e.footerFont),h=r.length,d=a.length,p=i.length,f=dh(e.padding);let m=f.height,g=0,_=i.reduce(((t,e)=>t+e.before.length+e.lines.length+e.after.length),0);_+=t.beforeBody.length+t.afterBody.length,h&&(m+=h*c.lineHeight+(h-1)*e.titleSpacing+e.titleMarginBottom),_&&(m+=p*(e.displayColors?Math.max(s,l.lineHeight):l.lineHeight)+(_-p)*l.lineHeight+(_-1)*e.bodySpacing),d&&(m+=e.footerMarginTop+d*u.lineHeight+(d-1)*e.footerSpacing);let y=0;const x=function(t){g=Math.max(g,n.measureText(t).width+y)};return n.save(),n.font=c.string,Uc(t.title,x),n.font=l.string,Uc(t.beforeBody.concat(t.afterBody),x),y=e.displayColors?o+2+e.boxPadding:0,Uc(i,(t=>{Uc(t.before,x),Uc(t.lines,x),Uc(t.after,x)})),y=0,n.font=u.string,Uc(t.footer,x),n.restore(),g+=f.width,{width:g,height:m}}function tf(t,e,n,i){const{x:a,width:r}=n,{width:o,chartArea:{left:s,right:l}}=t;let c="center";return"center"===i?c=a<=(s+l)/2?"left":"right":a<=r/2?c="left":a>=o-r/2&&(c="right"),function(t,e,n,i){const{x:a,width:r}=i,o=n.caretSize+n.caretPadding;return"left"===t&&a+r+o>e.width||"right"===t&&a-r-o<0||void 0}(c,t,e,n)&&(c="center"),c}function ef(t,e,n){const i=n.yAlign||e.yAlign||function(t,e){const{y:n,height:i}=e;return n<i/2?"top":n>t.height-i/2?"bottom":"center"}(t,n);return{xAlign:n.xAlign||e.xAlign||tf(t,e,n,i),yAlign:i}}function nf(t,e,n,i){const{caretSize:a,caretPadding:r,cornerRadius:o}=t,{xAlign:s,yAlign:l}=n,c=a+r,{topLeft:u,topRight:h,bottomLeft:d,bottomRight:p}=hh(o);let f=function(t,e){let{x:n,width:i}=t;return"right"===e?n-=i:"center"===e&&(n-=i/2),n}(e,s);const m=function(t,e,n){let{y:i,height:a}=t;return"top"===e?i+=n:i-="bottom"===e?a+n:a/2,i}(e,l,c);return"center"===l?"left"===s?f+=c:"right"===s&&(f-=c):"left"===s?f-=Math.max(u,d)+a:"right"===s&&(f+=Math.max(h,p)+a),{x:_u(f,0,i.width-e.width),y:_u(m,0,i.height-e.height)}}function af(t,e,n){const i=dh(n.padding);return"center"===e?t.x+t.width/2:"right"===e?t.x+t.width-i.right:t.x+i.left}function rf(t){return Xp([],Kp(t))}function of(t,e){const n=e&&e.dataset&&e.dataset.tooltip&&e.dataset.tooltip.callbacks;return n?t.override(n):t}const sf={beforeTitle:Dc,title(t){if(t.length>0){const e=t[0],n=e.chart.data.labels,i=n?n.length:0;if(this&&this.options&&"dataset"===this.options.mode)return e.dataset.label||"";if(e.label)return e.label;if(i>0&&e.dataIndex<i)return n[e.dataIndex]}return""},afterTitle:Dc,beforeBody:Dc,beforeLabel:Dc,label(t){if(this&&this.options&&"dataset"===this.options.mode)return t.label+": "+t.formattedValue||t.formattedValue;let e=t.dataset.label||"";e&&(e+=": ");const n=t.formattedValue;return Bc(n)||(e+=n),e},labelColor(t){const e=t.chart.getDatasetMeta(t.datasetIndex).controller.getStyle(t.dataIndex);return{borderColor:e.borderColor,backgroundColor:e.backgroundColor,borderWidth:e.borderWidth,borderDash:e.borderDash,borderDashOffset:e.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(t){const e=t.chart.getDatasetMeta(t.datasetIndex).controller.getStyle(t.dataIndex);return{pointStyle:e.pointStyle,rotation:e.rotation}},afterLabel:Dc,afterBody:Dc,beforeFooter:Dc,footer:Dc,afterFooter:Dc};function lf(t,e,n,i){const a=t[e].call(n,i);return void 0===a?sf[e].call(n,i):a}class cf extends Jd{static positioners=Yp;constructor(t){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=t.chart,this.options=t.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(t){this.options=t,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const t=this._cachedAnimations;if(t)return t;const e=this.chart,n=this.options.setContext(this.getContext()),i=n.enabled&&e.options.animation&&n.animations,a=new Hh(this.chart,i);return i._cacheable&&(this._cachedAnimations=Object.freeze(a)),a}getContext(){return this.$context||(this.$context=function(t,e,n){return mh(t,{tooltip:e,tooltipItems:n,type:"tooltip"})}(this.chart.getContext(),this,this._tooltipItems))}getTitle(t,e){const{callbacks:n}=e,i=lf(n,"beforeTitle",this,t),a=lf(n,"title",this,t),r=lf(n,"afterTitle",this,t);let o=[];return o=Xp(o,Kp(i)),o=Xp(o,Kp(a)),o=Xp(o,Kp(r)),o}getBeforeBody(t,e){return rf(lf(e.callbacks,"beforeBody",this,t))}getBody(t,e){const{callbacks:n}=e,i=[];return Uc(t,(t=>{const e={before:[],lines:[],after:[]},a=of(n,t);Xp(e.before,Kp(lf(a,"beforeLabel",this,t))),Xp(e.lines,lf(a,"label",this,t)),Xp(e.after,Kp(lf(a,"afterLabel",this,t))),i.push(e)})),i}getAfterBody(t,e){return rf(lf(e.callbacks,"afterBody",this,t))}getFooter(t,e){const{callbacks:n}=e,i=lf(n,"beforeFooter",this,t),a=lf(n,"footer",this,t),r=lf(n,"afterFooter",this,t);let o=[];return o=Xp(o,Kp(i)),o=Xp(o,Kp(a)),o=Xp(o,Kp(r)),o}_createItems(t){const e=this._active,n=this.chart.data,i=[],a=[],r=[];let o,s,l=[];for(o=0,s=e.length;o<s;++o)l.push(Qp(this.chart,e[o]));return t.filter&&(l=l.filter(((e,i,a)=>t.filter(e,i,a,n)))),t.itemSort&&(l=l.sort(((e,i)=>t.itemSort(e,i,n)))),Uc(l,(e=>{const n=of(t.callbacks,e);i.push(lf(n,"labelColor",this,e)),a.push(lf(n,"labelPointStyle",this,e)),r.push(lf(n,"labelTextColor",this,e))})),this.labelColors=i,this.labelPointStyles=a,this.labelTextColors=r,this.dataPoints=l,l}update(t,e){const n=this.options.setContext(this.getContext()),i=this._active;let a,r=[];if(i.length){const t=Yp[n.position].call(this,i,this._eventPosition);r=this._createItems(n),this.title=this.getTitle(r,n),this.beforeBody=this.getBeforeBody(r,n),this.body=this.getBody(r,n),this.afterBody=this.getAfterBody(r,n),this.footer=this.getFooter(r,n);const e=this._size=Jp(this,n),o=Object.assign({},t,e),s=ef(this.chart,n,o),l=nf(n,o,s,this.chart);this.xAlign=s.xAlign,this.yAlign=s.yAlign,a={opacity:1,x:l.x,y:l.y,width:e.width,height:e.height,caretX:t.x,caretY:t.y}}else 0!==this.opacity&&(a={opacity:0});this._tooltipItems=r,this.$context=void 0,a&&this._resolveAnimations().update(this,a),t&&n.external&&n.external.call(this,{chart:this.chart,tooltip:this,replay:e})}drawCaret(t,e,n,i){const a=this.getCaretPosition(t,n,i);e.lineTo(a.x1,a.y1),e.lineTo(a.x2,a.y2),e.lineTo(a.x3,a.y3)}getCaretPosition(t,e,n){const{xAlign:i,yAlign:a}=this,{caretSize:r,cornerRadius:o}=n,{topLeft:s,topRight:l,bottomLeft:c,bottomRight:u}=hh(o),{x:h,y:d}=t,{width:p,height:f}=e;let m,g,_,y,x,v;return"center"===a?(x=d+f/2,"left"===i?(m=h,g=m-r,y=x+r,v=x-r):(m=h+p,g=m+r,y=x-r,v=x+r),_=m):(g="left"===i?h+Math.max(s,c)+r:"right"===i?h+p-Math.max(l,u)-r:this.caretX,"top"===a?(y=d,x=y-r,m=g-r,_=g+r):(y=d+f,x=y+r,m=g+r,_=g-r),v=y),{x1:m,x2:g,x3:_,y1:y,y2:x,y3:v}}drawTitle(t,e,n){const i=this.title,a=i.length;let r,o,s;if(a){const l=Vh(n.rtl,this.x,this.width);for(t.x=af(this,n.titleAlign,n),e.textAlign=l.textAlign(n.titleAlign),e.textBaseline="middle",r=ph(n.titleFont),o=n.titleSpacing,e.fillStyle=n.titleColor,e.font=r.string,s=0;s<a;++s)e.fillText(i[s],l.x(t.x),t.y+r.lineHeight/2),t.y+=r.lineHeight+o,s+1===a&&(t.y+=n.titleMarginBottom-o)}}_drawColorBox(t,e,n,i,a){const r=this.labelColors[n],o=this.labelPointStyles[n],{boxHeight:s,boxWidth:l}=a,c=ph(a.bodyFont),u=af(this,"left",a),h=i.x(u),d=s<c.lineHeight?(c.lineHeight-s)/2:0,p=e.y+d;if(a.usePointStyle){const e={radius:Math.min(l,s)/2,pointStyle:o.pointStyle,rotation:o.rotation,borderWidth:1},n=i.leftForLtr(h,l)+l/2,c=p+s/2;t.strokeStyle=a.multiKeyBackground,t.fillStyle=a.multiKeyBackground,Ku(t,e,n,c),t.strokeStyle=r.borderColor,t.fillStyle=r.backgroundColor,Ku(t,e,n,c)}else{t.lineWidth=Rc(r.borderWidth)?Math.max(...Object.values(r.borderWidth)):r.borderWidth||1,t.strokeStyle=r.borderColor,t.setLineDash(r.borderDash||[]),t.lineDashOffset=r.borderDashOffset||0;const e=i.leftForLtr(h,l),n=i.leftForLtr(i.xPlus(h,1),l-2),o=hh(r.borderRadius);Object.values(o).some((t=>0!==t))?(t.beginPath(),t.fillStyle=a.multiKeyBackground,ah(t,{x:e,y:p,w:l,h:s,radius:o}),t.fill(),t.stroke(),t.fillStyle=r.backgroundColor,t.beginPath(),ah(t,{x:n,y:p+1,w:l-2,h:s-2,radius:o}),t.fill()):(t.fillStyle=a.multiKeyBackground,t.fillRect(e,p,l,s),t.strokeRect(e,p,l,s),t.fillStyle=r.backgroundColor,t.fillRect(n,p+1,l-2,s-2))}t.fillStyle=this.labelTextColors[n]}drawBody(t,e,n){const{body:i}=this,{bodySpacing:a,bodyAlign:r,displayColors:o,boxHeight:s,boxWidth:l,boxPadding:c}=n,u=ph(n.bodyFont);let h=u.lineHeight,d=0;const p=Vh(n.rtl,this.x,this.width),f=function(n){e.fillText(n,p.x(t.x+d),t.y+h/2),t.y+=h+a},m=p.textAlign(r);let g,_,y,x,v,b,w;for(e.textAlign=r,e.textBaseline="middle",e.font=u.string,t.x=af(this,m,n),e.fillStyle=n.bodyColor,Uc(this.beforeBody,f),d=o&&"right"!==m?"center"===r?l/2+c:l+2+c:0,x=0,b=i.length;x<b;++x){for(g=i[x],_=this.labelTextColors[x],e.fillStyle=_,Uc(g.before,f),y=g.lines,o&&y.length&&(this._drawColorBox(e,t,x,p,n),h=Math.max(u.lineHeight,s)),v=0,w=y.length;v<w;++v)f(y[v]),h=u.lineHeight;Uc(g.after,f)}d=0,h=u.lineHeight,Uc(this.afterBody,f),t.y-=a}drawFooter(t,e,n){const i=this.footer,a=i.length;let r,o;if(a){const s=Vh(n.rtl,this.x,this.width);for(t.x=af(this,n.footerAlign,n),t.y+=n.footerMarginTop,e.textAlign=s.textAlign(n.footerAlign),e.textBaseline="middle",r=ph(n.footerFont),e.fillStyle=n.footerColor,e.font=r.string,o=0;o<a;++o)e.fillText(i[o],s.x(t.x),t.y+r.lineHeight/2),t.y+=r.lineHeight+n.footerSpacing}}drawBackground(t,e,n,i){const{xAlign:a,yAlign:r}=this,{x:o,y:s}=t,{width:l,height:c}=n,{topLeft:u,topRight:h,bottomLeft:d,bottomRight:p}=hh(i.cornerRadius);e.fillStyle=i.backgroundColor,e.strokeStyle=i.borderColor,e.lineWidth=i.borderWidth,e.beginPath(),e.moveTo(o+u,s),"top"===r&&this.drawCaret(t,e,n,i),e.lineTo(o+l-h,s),e.quadraticCurveTo(o+l,s,o+l,s+h),"center"===r&&"right"===a&&this.drawCaret(t,e,n,i),e.lineTo(o+l,s+c-p),e.quadraticCurveTo(o+l,s+c,o+l-p,s+c),"bottom"===r&&this.drawCaret(t,e,n,i),e.lineTo(o+d,s+c),e.quadraticCurveTo(o,s+c,o,s+c-d),"center"===r&&"left"===a&&this.drawCaret(t,e,n,i),e.lineTo(o,s+u),e.quadraticCurveTo(o,s,o+u,s),e.closePath(),e.fill(),i.borderWidth>0&&e.stroke()}_updateAnimationTarget(t){const e=this.chart,n=this.$animations,i=n&&n.x,a=n&&n.y;if(i||a){const n=Yp[t.position].call(this,this._active,this._eventPosition);if(!n)return;const r=this._size=Jp(this,t),o=Object.assign({},n,this._size),s=ef(e,t,o),l=nf(t,o,s,e);i._to===l.x&&a._to===l.y||(this.xAlign=s.xAlign,this.yAlign=s.yAlign,this.width=r.width,this.height=r.height,this.caretX=n.x,this.caretY=n.y,this._resolveAnimations().update(this,l))}}_willRender(){return!!this.opacity}draw(t){const e=this.options.setContext(this.getContext());let n=this.opacity;if(!n)return;this._updateAnimationTarget(e);const i={width:this.width,height:this.height},a={x:this.x,y:this.y};n=Math.abs(n)<.001?0:n;const r=dh(e.padding),o=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;e.enabled&&o&&(t.save(),t.globalAlpha=n,this.drawBackground(a,t,i,e),function(t,e){let n,i;"ltr"!==e&&"rtl"!==e||(n=t.canvas.style,i=[n.getPropertyValue("direction"),n.getPropertyPriority("direction")],n.setProperty("direction",e,"important"),t.prevTextDirection=i)}(t,e.textDirection),a.y+=r.top,this.drawTitle(a,t,e),this.drawBody(a,t,e),this.drawFooter(a,t,e),function(t,e){void 0!==e&&(delete t.prevTextDirection,t.canvas.style.setProperty("direction",e[0],e[1]))}(t,e.textDirection),t.restore())}getActiveElements(){return this._active||[]}setActiveElements(t,e){const n=this._active,i=t.map((({datasetIndex:t,index:e})=>{const n=this.chart.getDatasetMeta(t);if(!n)throw new Error("Cannot find a dataset at index "+t);return{datasetIndex:t,element:n.data[e],index:e}})),a=!Gc(n,i),r=this._positionChanged(i,e);(a||r)&&(this._active=i,this._eventPosition=e,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(t,e,n=!0){if(e&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const i=this.options,a=this._active||[],r=this._getActiveElements(t,a,e,n),o=this._positionChanged(r,t),s=e||!Gc(r,a)||o;return s&&(this._active=r,(i.enabled||i.external)&&(this._eventPosition={x:t.x,y:t.y},this.update(!0,e))),s}_getActiveElements(t,e,n,i){const a=this.options;if("mouseout"===t.type)return[];if(!i)return e.filter((t=>this.chart.data.datasets[t.datasetIndex]&&void 0!==this.chart.getDatasetMeta(t.datasetIndex).controller.getParsed(t.index)));const r=this.chart.getElementsAtEventForMode(t,a.mode,a,n);return a.reverse&&r.reverse(),r}_positionChanged(t,e){const{caretX:n,caretY:i,options:a}=this,r=Yp[a.position].call(this,t,e);return!1!==r&&(n!==r.x||i!==r.y)}}var uf={id:"tooltip",_element:cf,positioners:Yp,afterInit(t,e,n){n&&(t.tooltip=new cf({chart:t,options:n}))},beforeUpdate(t,e,n){t.tooltip&&t.tooltip.initialize(n)},reset(t,e,n){t.tooltip&&t.tooltip.initialize(n)},afterDraw(t){const e=t.tooltip;if(e&&e._willRender()){const n={tooltip:e};if(!1===t.notifyPlugins("beforeTooltipDraw",{...n,cancelable:!0}))return;e.draw(t.ctx),t.notifyPlugins("afterTooltipDraw",n)}},afterEvent(t,e){if(t.tooltip){const n=e.replay;t.tooltip.handleEvent(e.event,n,e.inChartArea)&&(e.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(t,e)=>e.bodyFont.size,boxWidth:(t,e)=>e.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:sf},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:t=>"filter"!==t&&"itemSort"!==t&&"external"!==t,_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]};function hf(t){const e=this.getLabels();return t>=0&&t<e.length?e[t]:t}function df(t,e,{horizontal:n,minRotation:i}){const a=fu(i),r=(n?Math.sin(a):Math.cos(a))||.001,o=.75*e*(""+t).length;return Math.min(e/r,o)}class pf extends lp{constructor(t){super(t),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(t,e){return Bc(t)||("number"==typeof t||t instanceof Number)&&!isFinite(+t)?null:+t}handleTickRangeOptions(){const{beginAtZero:t}=this.options,{minDefined:e,maxDefined:n}=this.getUserBounds();let{min:i,max:a}=this;const r=t=>i=e?i:t,o=t=>a=n?a:t;if(t){const t=uu(i),e=uu(a);t<0&&e<0?o(0):t>0&&e>0&&r(0)}if(i===a){let e=0===a?1:Math.abs(.05*a);o(a+e),t||r(i-e)}this.min=i,this.max=a}getTickLimit(){const t=this.options.ticks;let e,{maxTicksLimit:n,stepSize:i}=t;return i?(e=Math.ceil(this.max/i)-Math.floor(this.min/i)+1,e>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${i} would result generating up to ${e} ticks. Limiting to 1000.`),e=1e3)):(e=this.computeTickLimit(),n=n||11),n&&(e=Math.min(n,e)),e}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const t=this.options,e=t.ticks;let n=this.getTickLimit();n=Math.max(2,n);const i=function(t,e){const n=[],{bounds:i,step:a,min:r,max:o,precision:s,count:l,maxTicks:c,maxDigits:u,includeBounds:h}=t,d=a||1,p=c-1,{min:f,max:m}=e,g=!Bc(r),_=!Bc(o),y=!Bc(l),x=(m-f)/(u+1);let v,b,w,A,C=du((m-f)/p/d)*d;if(C<1e-14&&!g&&!_)return[{value:f},{value:m}];A=Math.ceil(m/C)-Math.floor(f/C),A>p&&(C=du(A*C/p/d)*d),Bc(s)||(v=Math.pow(10,s),C=Math.ceil(C*v)/v),"ticks"===i?(b=Math.floor(f/C)*C,w=Math.ceil(m/C)*C):(b=f,w=m),g&&_&&a&&function(t,e){const n=Math.round(t);return n-e<=t&&n+e>=t}((o-r)/a,C/1e3)?(A=Math.round(Math.min((o-r)/C,c)),C=(o-r)/A,b=r,w=o):y?(b=g?r:b,w=_?o:w,A=l-1,C=(w-b)/A):(A=(w-b)/C,A=hu(A,Math.round(A),C/1e3)?Math.round(A):Math.ceil(A));const E=Math.max(mu(C),mu(b));v=Math.pow(10,Bc(s)?E:s),b=Math.round(b*v)/v,w=Math.round(w*v)/v;let T=0;for(g&&(h&&b!==r?(n.push({value:r}),b<r&&T++,hu(Math.round((b+T*C)*v)/v,r,df(r,x,t))&&T++):b<r&&T++);T<A;++T){const t=Math.round((b+T*C)*v)/v;if(_&&t>o)break;n.push({value:t})}return _&&h&&w!==o?n.length&&hu(n[n.length-1].value,o,df(o,x,t))?n[n.length-1].value=o:n.push({value:o}):_&&w!==o||n.push({value:w}),n}({maxTicks:n,bounds:t.bounds,min:t.min,max:t.max,precision:e.precision,step:e.stepSize,count:e.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:e.minRotation||0,includeBounds:!1!==e.includeBounds},this._range||this);return"ticks"===t.bounds&&function(t,e,n){let i,a,r;for(i=0,a=t.length;i<a;i++)r=t[i][n],isNaN(r)||(e.min=Math.min(e.min,r),e.max=Math.max(e.max,r))}(i,this,"value"),t.reverse?(i.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),i}configure(){const t=this.ticks;let e=this.min,n=this.max;if(super.configure(),this.options.offset&&t.length){const i=(n-e)/Math.max(t.length-1,1)/2;e-=i,n+=i}this._startValue=e,this._endValue=n,this._valueRange=n-e}getLabelForValue(t){return Nu(t,this.chart.options.locale,this.options.ticks.format)}}class ff extends pf{static id="linear";static defaults={ticks:{callback:Vu.formatters.numeric}};determineDataLimits(){const{min:t,max:e}=this.getMinMax(!0);this.min=Fc(t)?t:0,this.max=Fc(e)?e:1,this.handleTickRangeOptions()}computeTickLimit(){const t=this.isHorizontal(),e=t?this.width:this.height,n=fu(this.options.ticks.minRotation),i=(t?Math.sin(n):Math.cos(n))||.001,a=this._resolveTickFontOptions(0);return Math.ceil(e/Math.min(40,a.lineHeight/i))}getPixelForValue(t){return null===t?NaN:this.getPixelForDecimal((t-this._startValue)/this._valueRange)}getValueForPixel(t){return this._startValue+this.getDecimalForPixel(t)*this._valueRange}}Vu.formatters.logarithmic,Vu.formatters.numeric;const mf={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},gf=Object.keys(mf);function _f(t,e){return t-e}function yf(t,e){if(Bc(e))return null;const n=t._adapter,{parser:i,round:a,isoWeekday:r}=t._parseOpts;let o=e;return"function"==typeof i&&(o=i(o)),Fc(o)||(o="string"==typeof i?n.parse(o,i):n.parse(o)),null===o?null:(a&&(o="week"!==a||!pu(r)&&!0!==r?n.startOf(o,a):n.startOf(o,"isoWeek",r)),+o)}function xf(t,e,n,i){const a=gf.length;for(let r=gf.indexOf(t);r<a-1;++r){const t=mf[gf[r]],a=t.steps?t.steps:Number.MAX_SAFE_INTEGER;if(t.common&&Math.ceil((n-e)/(a*t.size))<=i)return gf[r]}return gf[a-1]}function vf(t,e,n){if(n){if(n.length){const{lo:i,hi:a}=xu(n,e);t[n[i]>=e?n[i]:n[a]]=!0}}else t[e]=!0}function bf(t,e,n){const i=[],a={},r=e.length;let o,s;for(o=0;o<r;++o)s=e[o],a[s]=o,i.push({value:s,major:!1});return 0!==r&&n?function(t,e,n,i){const a=t._adapter,r=+a.startOf(e[0].value,i),o=e[e.length-1].value;let s,l;for(s=r;s<=o;s=+a.add(s,1,i))l=n[s],l>=0&&(e[l].major=!0);return e}(t,i,a,n):i}function wf(t,e,n,i){const a=null===e,r=null===n,o=!(!t||a&&r)&&function(t,e){const{x:n,y:i,base:a,width:r,height:o}=t.getProps(["x","low","high","width","height"],e);let s,l,c,u,h;return t.horizontal?(h=o/2,s=Math.min(n,a),l=Math.max(n,a),c=i-h,u=i+h):(h=r/2,s=n-h,l=n+h,c=Math.min(i,a),u=Math.max(i,a)),{left:s,top:c,right:l,bottom:u}}(t,i);return o&&(a||e>=o.left&&e<=o.right)&&(r||n>=o.top&&n<=o.bottom)}class Af extends Wp{static defaults={backgroundColors:{up:"rgba(75, 192, 192, 0.5)",down:"rgba(255, 99, 132, 0.5)",unchanged:"rgba(201, 203, 207, 0.5)"},borderColors:{up:"rgb(75, 192, 192)",down:"rgb(255, 99, 132)",unchanged:"rgb(201, 203, 207)"}};height(){return this.base-this.y}inRange(t,e,n){return wf(this,t,e,n)}inXRange(t,e){return wf(this,t,null,e)}inYRange(t,e){return wf(this,null,t,e)}getRange(t){return"x"===t?this.width/2:this.height/2}getCenterPoint(t){const{x:e,low:n,high:i}=this.getProps(["x","low","high"],t);return{x:e,y:(i+n)/2}}tooltipPosition(t){const{x:e,open:n,close:i}=this.getProps(["x","open","close"],t);return{x:e,y:(n+i)/2}}}Np.defaults;class Cf extends fd{static overrides={label:"",parsing:!1,hover:{mode:"label"},animations:{numbers:{type:"number",properties:["x","y","base","width","open","high","low","close"]}},scales:{x:{type:"timeseries",offset:!0,ticks:{major:{enabled:!0},source:"data",maxRotation:0,autoSkip:!0,autoSkipPadding:75,sampleSize:100}},y:{type:"linear"}},plugins:{tooltip:{intersect:!1,mode:"index",callbacks:{label(t){const e=t.parsed;if(!Bc(e.y))return Hu.plugins.tooltip.callbacks.label(t);const{o:n,h:i,l:a,c:r}=e;return`O: ${n}  H: ${i}  L: ${a}  C: ${r}`}}}}};getLabelAndValue(t){const e=this,n=e.getParsed(t),i=e._cachedMeta.iScale.axis,{o:a,h:r,l:o,c:s}=n,l=`O: ${a}  H: ${r}  L: ${o}  C: ${s}`;return{label:`${e._cachedMeta.iScale.getLabelForValue(n[i])}`,value:l}}getUserBounds(t){const{min:e,max:n,minDefined:i,maxDefined:a}=t.getUserBounds();return{min:i?e:Number.NEGATIVE_INFINITY,max:a?n:Number.POSITIVE_INFINITY}}getMinMax(t){const e=this._cachedMeta,n=e._parsed,i=e.iScale.axis,a=this._getOtherScale(t),{min:r,max:o}=this.getUserBounds(a);if(n.length<2)return{min:0,max:1};if(t===e.iScale)return{min:n[0][i],max:n[n.length-1][i]};const s=n.filter((({x:t})=>t>=r&&t<o));let l=Number.POSITIVE_INFINITY,c=Number.NEGATIVE_INFINITY;for(let t=0;t<s.length;t++){const e=s[t];l=Math.min(l,e.l),c=Math.max(c,e.h)}return{min:l,max:c}}calculateElementProperties(t,e,n,i){const a=this,r=a._cachedMeta.vScale,o=r.getBasePixel(),s=a._calculateBarIndexPixels(t,e,i),l=a.chart.data.datasets[a.index].data[t],c=r.getPixelForValue(l.o),u=r.getPixelForValue(l.h),h=r.getPixelForValue(l.l),d=r.getPixelForValue(l.c);return{base:n?o:h,x:s.center,y:(h+u)/2,width:s.size,open:c,high:u,low:h,close:d}}draw(){const t=this,e=t.chart,n=t._cachedMeta.data;Ju(e.ctx,e.chartArea);for(let e=0;e<n.length;++e)n[e].draw(t._ctx);th(e.ctx)}}class Ef extends Af{static id="candlestick";static defaults={...Af.defaults,borderWidth:1};draw(t){const e=this,{x:n,open:i,high:a,low:r,close:o}=e;let s,l=e.options.borderColors;"string"==typeof l&&(l={up:l,down:l,unchanged:l}),o<i?(s=jc(l?l.up:void 0,Hu.elements.candlestick.borderColors.up),t.fillStyle=jc(e.options.backgroundColors?e.options.backgroundColors.up:void 0,Hu.elements.candlestick.backgroundColors.up)):o>i?(s=jc(l?l.down:void 0,Hu.elements.candlestick.borderColors.down),t.fillStyle=jc(e.options.backgroundColors?e.options.backgroundColors.down:void 0,Hu.elements.candlestick.backgroundColors.down)):(s=jc(l?l.unchanged:void 0,Hu.elements.candlestick.borderColors.unchanged),t.fillStyle=jc(e.backgroundColors?e.backgroundColors.unchanged:void 0,Hu.elements.candlestick.backgroundColors.unchanged)),t.lineWidth=jc(e.options.borderWidth,Hu.elements.candlestick.borderWidth),t.strokeStyle=s,t.beginPath(),t.moveTo(n,a),t.lineTo(n,Math.min(i,o)),t.moveTo(n,r),t.lineTo(n,Math.max(i,o)),t.stroke(),t.fillRect(n-e.width/2,o,e.width,i-o),t.strokeRect(n-e.width/2,o,e.width,i-o),t.closePath()}}class Tf extends Cf{static id="candlestick";static defaults={...Cf.defaults,dataElementType:Ef.id};static defaultRoutes=fd.defaultRoutes;updateElements(t,e,n,i){const a="reset"===i,r=this._getRuler(),{sharedOptions:o,includeOptions:s}=this._getSharedOptions(e,i);for(let l=e;l<e+n;l++){const e=o||this.resolveDataElementOptions(l,i),n=this.calculateElementProperties(l,r,a,e);s&&(n.options=e),this.updateElement(t[l],l,n,i)}}}const Sf="label";function Mf(t,e){"function"==typeof t?t(e):t&&(t.current=e)}function kf(t,e){t.labels=e}function If(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Sf;const i=[];t.datasets=e.map((e=>{const a=t.datasets.find((t=>t[n]===e[n]));return a&&e.data&&!i.includes(a)?(i.push(a),Object.assign(a,e),a):{...e}}))}function Pf(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Sf;const n={labels:[],datasets:[]};return kf(n,t.labels),If(n,t.datasets,e),n}function zf(t,e){const{height:i=150,width:a=300,redraw:r=!1,datasetIdKey:o,type:s,data:l,options:c,plugins:u=[],fallbackContent:h,updateMode:d,...p}=t,f=(0,n.useRef)(null),m=(0,n.useRef)(),g=()=>{f.current&&(m.current=new Np(f.current,{type:s,data:Pf(l,o),options:c&&{...c},plugins:u}),Mf(e,m.current))},_=()=>{Mf(e,null),m.current&&(m.current.destroy(),m.current=null)};return(0,n.useEffect)((()=>{!r&&m.current&&c&&function(t,e){const n=t.options;n&&e&&Object.assign(n,e)}(m.current,c)}),[r,c]),(0,n.useEffect)((()=>{!r&&m.current&&kf(m.current.config.data,l.labels)}),[r,l.labels]),(0,n.useEffect)((()=>{!r&&m.current&&l.datasets&&If(m.current.config.data,l.datasets,o)}),[r,l.datasets]),(0,n.useEffect)((()=>{m.current&&(r?(_(),setTimeout(g)):m.current.update(d))}),[r,c,l.labels,l.datasets,d]),(0,n.useEffect)((()=>{m.current&&(_(),setTimeout(g))}),[s]),(0,n.useEffect)((()=>(g(),()=>_())),[]),n.createElement("canvas",Object.assign({ref:f,role:"img",height:i,width:a},p),h)}const Df=(0,n.forwardRef)(zf);function Lf(t){const e=Object.prototype.toString.call(t);return t instanceof Date||"object"==typeof t&&"[object Date]"===e?new t.constructor(+t):"number"==typeof t||"[object Number]"===e||"string"==typeof t||"[object String]"===e?new Date(t):new Date(NaN)}function Bf(t,e){return t instanceof Date?new t.constructor(e):new Date(e)}let Of={};function Rf(){return Of}const Ff={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}};function Nf(t){return(e={})=>{const n=e.width?String(e.width):t.defaultWidth;return t.formats[n]||t.formats[t.defaultWidth]}}const jf={date:Nf({formats:{full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},defaultWidth:"full"}),time:Nf({formats:{full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},defaultWidth:"full"}),dateTime:Nf({formats:{full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},defaultWidth:"full"})},Vf={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"};function Uf(t){return(e,n)=>{let i;if("formatting"===(n?.context?String(n.context):"standalone")&&t.formattingValues){const e=t.defaultFormattingWidth||t.defaultWidth,a=n?.width?String(n.width):e;i=t.formattingValues[a]||t.formattingValues[e]}else{const e=t.defaultWidth,a=n?.width?String(n.width):t.defaultWidth;i=t.values[a]||t.values[e]}return i[t.argumentCallback?t.argumentCallback(e):e]}}const Gf={ordinalNumber:(t,e)=>{const n=Number(t),i=n%100;if(i>20||i<10)switch(i%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},era:Uf({values:{narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},defaultWidth:"wide"}),quarter:Uf({values:{narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},defaultWidth:"wide",argumentCallback:t=>t-1}),month:Uf({values:{narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},defaultWidth:"wide"}),day:Uf({values:{narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},defaultWidth:"wide"}),dayPeriod:Uf({values:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},defaultWidth:"wide",formattingValues:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},defaultFormattingWidth:"wide"})};function qf(t){return(e,n={})=>{const i=n.width,a=i&&t.matchPatterns[i]||t.matchPatterns[t.defaultMatchWidth],r=e.match(a);if(!r)return null;const o=r[0],s=i&&t.parsePatterns[i]||t.parsePatterns[t.defaultParseWidth],l=Array.isArray(s)?function(t,e){for(let e=0;e<t.length;e++)if(t[e].test(o))return e}(s):function(t,e){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e)&&t[e].test(o))return e}(s);let c;return c=t.valueCallback?t.valueCallback(l):l,c=n.valueCallback?n.valueCallback(c):c,{value:c,rest:e.slice(o.length)}}}const $f={ordinalNumber:(Wf={matchPattern:/^(\d+)(th|st|nd|rd)?/i,parsePattern:/\d+/i,valueCallback:t=>parseInt(t,10)},(t,e={})=>{const n=t.match(Wf.matchPattern);if(!n)return null;const i=n[0],a=t.match(Wf.parsePattern);if(!a)return null;let r=Wf.valueCallback?Wf.valueCallback(a[0]):a[0];return r=e.valueCallback?e.valueCallback(r):r,{value:r,rest:t.slice(i.length)}}),era:qf({matchPatterns:{narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},defaultMatchWidth:"wide",parsePatterns:{any:[/^b/i,/^(a|c)/i]},defaultParseWidth:"any"}),quarter:qf({matchPatterns:{narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},defaultMatchWidth:"wide",parsePatterns:{any:[/1/i,/2/i,/3/i,/4/i]},defaultParseWidth:"any",valueCallback:t=>t+1}),month:qf({matchPatterns:{narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},defaultParseWidth:"any"}),day:qf({matchPatterns:{narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},defaultParseWidth:"any"}),dayPeriod:qf({matchPatterns:{narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},defaultMatchWidth:"any",parsePatterns:{any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},defaultParseWidth:"any"})};var Wf;const Hf={code:"en-US",formatDistance:(t,e,n)=>{let i;const a=Ff[t];return i="string"==typeof a?a:1===e?a.one:a.other.replace("{{count}}",e.toString()),n?.addSuffix?n.comparison&&n.comparison>0?"in "+i:i+" ago":i},formatLong:jf,formatRelative:(t,e,n,i)=>Vf[t],localize:Gf,match:$f,options:{weekStartsOn:0,firstWeekContainsDate:1}},Zf=(t,e)=>{switch(t){case"P":return e.date({width:"short"});case"PP":return e.date({width:"medium"});case"PPP":return e.date({width:"long"});default:return e.date({width:"full"})}},Yf=(t,e)=>{switch(t){case"p":return e.time({width:"short"});case"pp":return e.time({width:"medium"});case"ppp":return e.time({width:"long"});default:return e.time({width:"full"})}},Xf={p:Yf,P:(t,e)=>{const n=t.match(/(P+)(p+)?/)||[],i=n[1],a=n[2];if(!a)return Zf(t,e);let r;switch(i){case"P":r=e.dateTime({width:"short"});break;case"PP":r=e.dateTime({width:"medium"});break;case"PPP":r=e.dateTime({width:"long"});break;default:r=e.dateTime({width:"full"})}return r.replace("{{date}}",Zf(i,e)).replace("{{time}}",Yf(a,e))}},Kf=/^D+$/,Qf=/^Y+$/,Jf=["D","DD","YY","YYYY"];function tm(t){return Kf.test(t)}function em(t){return Qf.test(t)}function nm(t,e,n){const i=function(t,e,n){const i="Y"===t[0]?"years":"days of the month";return`Use \`${t.toLowerCase()}\` instead of \`${t}\` (in \`${e}\`) for formatting ${i} to the input \`${n}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}(t,e,n);if(console.warn(i),Jf.includes(t))throw new RangeError(i)}class im{subPriority=0;validate(t,e){return!0}}class am extends im{constructor(t,e,n,i,a){super(),this.value=t,this.validateValue=e,this.setValue=n,this.priority=i,a&&(this.subPriority=a)}validate(t,e){return this.validateValue(t,this.value,e)}set(t,e,n){return this.setValue(t,e,this.value,n)}}class rm extends im{priority=10;subPriority=-1;set(t,e){return e.timestampIsSet?t:Bf(t,function(t,e){const n=e instanceof Date?Bf(e,0):new e(0);return n.setFullYear(t.getFullYear(),t.getMonth(),t.getDate()),n.setHours(t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()),n}(t,Date))}}class om{run(t,e,n,i){const a=this.parse(t,e,n,i);return a?{setter:new am(a.value,this.validate,this.set,this.priority,this.subPriority),rest:a.rest}:null}validate(t,e,n){return!0}}Math.pow(10,8);const sm=6048e5,lm=864e5,cm=6e4,um=36e5,hm=/^(1[0-2]|0?\d)/,dm=/^(3[0-1]|[0-2]?\d)/,pm=/^(36[0-6]|3[0-5]\d|[0-2]?\d?\d)/,fm=/^(5[0-3]|[0-4]?\d)/,mm=/^(2[0-3]|[0-1]?\d)/,gm=/^(2[0-4]|[0-1]?\d)/,_m=/^(1[0-1]|0?\d)/,ym=/^(1[0-2]|0?\d)/,xm=/^[0-5]?\d/,vm=/^[0-5]?\d/,bm=/^\d/,wm=/^\d{1,2}/,Am=/^\d{1,3}/,Cm=/^\d{1,4}/,Em=/^-?\d+/,Tm=/^-?\d/,Sm=/^-?\d{1,2}/,Mm=/^-?\d{1,3}/,km=/^-?\d{1,4}/,Im=/^([+-])(\d{2})(\d{2})?|Z/,Pm=/^([+-])(\d{2})(\d{2})|Z/,zm=/^([+-])(\d{2})(\d{2})((\d{2}))?|Z/,Dm=/^([+-])(\d{2}):(\d{2})|Z/,Lm=/^([+-])(\d{2}):(\d{2})(:(\d{2}))?|Z/;function Bm(t,e){return t?{value:e(t.value),rest:t.rest}:t}function Om(t,e){const n=e.match(t);return n?{value:parseInt(n[0],10),rest:e.slice(n[0].length)}:null}function Rm(t,e){const n=e.match(t);if(!n)return null;if("Z"===n[0])return{value:0,rest:e.slice(1)};const i="+"===n[1]?1:-1,a=n[2]?parseInt(n[2],10):0,r=n[3]?parseInt(n[3],10):0,o=n[5]?parseInt(n[5],10):0;return{value:i*(a*um+r*cm+1e3*o),rest:e.slice(n[0].length)}}function Fm(t){return Om(Em,t)}function Nm(t,e){switch(t){case 1:return Om(bm,e);case 2:return Om(wm,e);case 3:return Om(Am,e);case 4:return Om(Cm,e);default:return Om(new RegExp("^\\d{1,"+t+"}"),e)}}function jm(t,e){switch(t){case 1:return Om(Tm,e);case 2:return Om(Sm,e);case 3:return Om(Mm,e);case 4:return Om(km,e);default:return Om(new RegExp("^-?\\d{1,"+t+"}"),e)}}function Vm(t){switch(t){case"morning":return 4;case"evening":return 17;case"pm":case"noon":case"afternoon":return 12;default:return 0}}function Um(t,e){const n=e>0,i=n?e:1-e;let a;if(i<=50)a=t||100;else{const e=i+50;a=t+100*Math.trunc(e/100)-(t>=e%100?100:0)}return n?a:1-a}function Gm(t){return t%400==0||t%4==0&&t%100!=0}function qm(t,e){const n=Rf(),i=e?.weekStartsOn??e?.locale?.options?.weekStartsOn??n.weekStartsOn??n.locale?.options?.weekStartsOn??0,a=Lf(t),r=a.getDay(),o=(r<i?7:0)+r-i;return a.setDate(a.getDate()-o),a.setHours(0,0,0,0),a}function $m(t,e){const n=Lf(t),i=n.getFullYear(),a=Rf(),r=e?.firstWeekContainsDate??e?.locale?.options?.firstWeekContainsDate??a.firstWeekContainsDate??a.locale?.options?.firstWeekContainsDate??1,o=Bf(t,0);o.setFullYear(i+1,0,r),o.setHours(0,0,0,0);const s=qm(o,e),l=Bf(t,0);l.setFullYear(i,0,r),l.setHours(0,0,0,0);const c=qm(l,e);return n.getTime()>=s.getTime()?i+1:n.getTime()>=c.getTime()?i:i-1}function Wm(t){return qm(t,{weekStartsOn:1})}function Hm(t,e){const n=Lf(t),i=+qm(n,e)-+function(t,e){const n=Rf(),i=e?.firstWeekContainsDate??e?.locale?.options?.firstWeekContainsDate??n.firstWeekContainsDate??n.locale?.options?.firstWeekContainsDate??1,a=$m(t,e),r=Bf(t,0);return r.setFullYear(a,0,i),r.setHours(0,0,0,0),qm(r,e)}(n,e);return Math.round(i/sm)+1}function Zm(t){const e=Lf(t),n=e.getFullYear(),i=Bf(t,0);i.setFullYear(n+1,0,4),i.setHours(0,0,0,0);const a=Wm(i),r=Bf(t,0);r.setFullYear(n,0,4),r.setHours(0,0,0,0);const o=Wm(r);return e.getTime()>=a.getTime()?n+1:e.getTime()>=o.getTime()?n:n-1}function Ym(t){const e=Lf(t),n=+Wm(e)-+function(t){const e=Zm(t),n=Bf(t,0);return n.setFullYear(e,0,4),n.setHours(0,0,0,0),Wm(n)}(e);return Math.round(n/sm)+1}const Xm=[31,28,31,30,31,30,31,31,30,31,30,31],Km=[31,29,31,30,31,30,31,31,30,31,30,31];function Qm(t,e){const n=Lf(t);return isNaN(e)?Bf(t,NaN):e?(n.setDate(n.getDate()+e),n):n}function Jm(t,e,n){const i=Rf(),a=n?.weekStartsOn??n?.locale?.options?.weekStartsOn??i.weekStartsOn??i.locale?.options?.weekStartsOn??0,r=Lf(t),o=r.getDay(),s=7-a;return Qm(r,e<0||e>6?e-(o+s)%7:((e%7+7)%7+s)%7-(o+s)%7)}function tg(t,e){const n=Lf(t);return Qm(n,e-function(t){let e=Lf(t).getDay();return 0===e&&(e=7),e}(n))}function eg(t){const e=Lf(t),n=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return n.setUTCFullYear(e.getFullYear()),+t-+n}const ng={G:new class extends om{priority=140;parse(t,e,n){switch(e){case"G":case"GG":case"GGG":return n.era(t,{width:"abbreviated"})||n.era(t,{width:"narrow"});case"GGGGG":return n.era(t,{width:"narrow"});default:return n.era(t,{width:"wide"})||n.era(t,{width:"abbreviated"})||n.era(t,{width:"narrow"})}}set(t,e,n){return e.era=n,t.setFullYear(n,0,1),t.setHours(0,0,0,0),t}incompatibleTokens=["R","u","t","T"]},y:new class extends om{priority=130;incompatibleTokens=["Y","R","u","w","I","i","e","c","t","T"];parse(t,e,n){const i=t=>({year:t,isTwoDigitYear:"yy"===e});switch(e){case"y":return Bm(Nm(4,t),i);case"yo":return Bm(n.ordinalNumber(t,{unit:"year"}),i);default:return Bm(Nm(e.length,t),i)}}validate(t,e){return e.isTwoDigitYear||e.year>0}set(t,e,n){const i=t.getFullYear();if(n.isTwoDigitYear){const e=Um(n.year,i);return t.setFullYear(e,0,1),t.setHours(0,0,0,0),t}const a="era"in e&&1!==e.era?1-n.year:n.year;return t.setFullYear(a,0,1),t.setHours(0,0,0,0),t}},Y:new class extends om{priority=130;parse(t,e,n){const i=t=>({year:t,isTwoDigitYear:"YY"===e});switch(e){case"Y":return Bm(Nm(4,t),i);case"Yo":return Bm(n.ordinalNumber(t,{unit:"year"}),i);default:return Bm(Nm(e.length,t),i)}}validate(t,e){return e.isTwoDigitYear||e.year>0}set(t,e,n,i){const a=$m(t,i);if(n.isTwoDigitYear){const e=Um(n.year,a);return t.setFullYear(e,0,i.firstWeekContainsDate),t.setHours(0,0,0,0),qm(t,i)}const r="era"in e&&1!==e.era?1-n.year:n.year;return t.setFullYear(r,0,i.firstWeekContainsDate),t.setHours(0,0,0,0),qm(t,i)}incompatibleTokens=["y","R","u","Q","q","M","L","I","d","D","i","t","T"]},R:new class extends om{priority=130;parse(t,e){return jm("R"===e?4:e.length,t)}set(t,e,n){const i=Bf(t,0);return i.setFullYear(n,0,4),i.setHours(0,0,0,0),Wm(i)}incompatibleTokens=["G","y","Y","u","Q","q","M","L","w","d","D","e","c","t","T"]},u:new class extends om{priority=130;parse(t,e){return jm("u"===e?4:e.length,t)}set(t,e,n){return t.setFullYear(n,0,1),t.setHours(0,0,0,0),t}incompatibleTokens=["G","y","Y","R","w","I","i","e","c","t","T"]},Q:new class extends om{priority=120;parse(t,e,n){switch(e){case"Q":case"QQ":return Nm(e.length,t);case"Qo":return n.ordinalNumber(t,{unit:"quarter"});case"QQQ":return n.quarter(t,{width:"abbreviated",context:"formatting"})||n.quarter(t,{width:"narrow",context:"formatting"});case"QQQQQ":return n.quarter(t,{width:"narrow",context:"formatting"});default:return n.quarter(t,{width:"wide",context:"formatting"})||n.quarter(t,{width:"abbreviated",context:"formatting"})||n.quarter(t,{width:"narrow",context:"formatting"})}}validate(t,e){return e>=1&&e<=4}set(t,e,n){return t.setMonth(3*(n-1),1),t.setHours(0,0,0,0),t}incompatibleTokens=["Y","R","q","M","L","w","I","d","D","i","e","c","t","T"]},q:new class extends om{priority=120;parse(t,e,n){switch(e){case"q":case"qq":return Nm(e.length,t);case"qo":return n.ordinalNumber(t,{unit:"quarter"});case"qqq":return n.quarter(t,{width:"abbreviated",context:"standalone"})||n.quarter(t,{width:"narrow",context:"standalone"});case"qqqqq":return n.quarter(t,{width:"narrow",context:"standalone"});default:return n.quarter(t,{width:"wide",context:"standalone"})||n.quarter(t,{width:"abbreviated",context:"standalone"})||n.quarter(t,{width:"narrow",context:"standalone"})}}validate(t,e){return e>=1&&e<=4}set(t,e,n){return t.setMonth(3*(n-1),1),t.setHours(0,0,0,0),t}incompatibleTokens=["Y","R","Q","M","L","w","I","d","D","i","e","c","t","T"]},M:new class extends om{incompatibleTokens=["Y","R","q","Q","L","w","I","D","i","e","c","t","T"];priority=110;parse(t,e,n){const i=t=>t-1;switch(e){case"M":return Bm(Om(hm,t),i);case"MM":return Bm(Nm(2,t),i);case"Mo":return Bm(n.ordinalNumber(t,{unit:"month"}),i);case"MMM":return n.month(t,{width:"abbreviated",context:"formatting"})||n.month(t,{width:"narrow",context:"formatting"});case"MMMMM":return n.month(t,{width:"narrow",context:"formatting"});default:return n.month(t,{width:"wide",context:"formatting"})||n.month(t,{width:"abbreviated",context:"formatting"})||n.month(t,{width:"narrow",context:"formatting"})}}validate(t,e){return e>=0&&e<=11}set(t,e,n){return t.setMonth(n,1),t.setHours(0,0,0,0),t}},L:new class extends om{priority=110;parse(t,e,n){const i=t=>t-1;switch(e){case"L":return Bm(Om(hm,t),i);case"LL":return Bm(Nm(2,t),i);case"Lo":return Bm(n.ordinalNumber(t,{unit:"month"}),i);case"LLL":return n.month(t,{width:"abbreviated",context:"standalone"})||n.month(t,{width:"narrow",context:"standalone"});case"LLLLL":return n.month(t,{width:"narrow",context:"standalone"});default:return n.month(t,{width:"wide",context:"standalone"})||n.month(t,{width:"abbreviated",context:"standalone"})||n.month(t,{width:"narrow",context:"standalone"})}}validate(t,e){return e>=0&&e<=11}set(t,e,n){return t.setMonth(n,1),t.setHours(0,0,0,0),t}incompatibleTokens=["Y","R","q","Q","M","w","I","D","i","e","c","t","T"]},w:new class extends om{priority=100;parse(t,e,n){switch(e){case"w":return Om(fm,t);case"wo":return n.ordinalNumber(t,{unit:"week"});default:return Nm(e.length,t)}}validate(t,e){return e>=1&&e<=53}set(t,e,n,i){return qm(function(t,e,n){const i=Lf(t),a=Hm(i,n)-e;return i.setDate(i.getDate()-7*a),i}(t,n,i),i)}incompatibleTokens=["y","R","u","q","Q","M","L","I","d","D","i","t","T"]},I:new class extends om{priority=100;parse(t,e,n){switch(e){case"I":return Om(fm,t);case"Io":return n.ordinalNumber(t,{unit:"week"});default:return Nm(e.length,t)}}validate(t,e){return e>=1&&e<=53}set(t,e,n){return Wm(function(t,e){const n=Lf(t),i=Ym(n)-e;return n.setDate(n.getDate()-7*i),n}(t,n))}incompatibleTokens=["y","Y","u","q","Q","M","L","w","d","D","e","c","t","T"]},d:new class extends om{priority=90;subPriority=1;parse(t,e,n){switch(e){case"d":return Om(dm,t);case"do":return n.ordinalNumber(t,{unit:"date"});default:return Nm(e.length,t)}}validate(t,e){const n=Gm(t.getFullYear()),i=t.getMonth();return n?e>=1&&e<=Km[i]:e>=1&&e<=Xm[i]}set(t,e,n){return t.setDate(n),t.setHours(0,0,0,0),t}incompatibleTokens=["Y","R","q","Q","w","I","D","i","e","c","t","T"]},D:new class extends om{priority=90;subpriority=1;parse(t,e,n){switch(e){case"D":case"DD":return Om(pm,t);case"Do":return n.ordinalNumber(t,{unit:"date"});default:return Nm(e.length,t)}}validate(t,e){return Gm(t.getFullYear())?e>=1&&e<=366:e>=1&&e<=365}set(t,e,n){return t.setMonth(0,n),t.setHours(0,0,0,0),t}incompatibleTokens=["Y","R","q","Q","M","L","w","I","d","E","i","e","c","t","T"]},E:new class extends om{priority=90;parse(t,e,n){switch(e){case"E":case"EE":case"EEE":return n.day(t,{width:"abbreviated",context:"formatting"})||n.day(t,{width:"short",context:"formatting"})||n.day(t,{width:"narrow",context:"formatting"});case"EEEEE":return n.day(t,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(t,{width:"short",context:"formatting"})||n.day(t,{width:"narrow",context:"formatting"});default:return n.day(t,{width:"wide",context:"formatting"})||n.day(t,{width:"abbreviated",context:"formatting"})||n.day(t,{width:"short",context:"formatting"})||n.day(t,{width:"narrow",context:"formatting"})}}validate(t,e){return e>=0&&e<=6}set(t,e,n,i){return(t=Jm(t,n,i)).setHours(0,0,0,0),t}incompatibleTokens=["D","i","e","c","t","T"]},e:new class extends om{priority=90;parse(t,e,n,i){const a=t=>{const e=7*Math.floor((t-1)/7);return(t+i.weekStartsOn+6)%7+e};switch(e){case"e":case"ee":return Bm(Nm(e.length,t),a);case"eo":return Bm(n.ordinalNumber(t,{unit:"day"}),a);case"eee":return n.day(t,{width:"abbreviated",context:"formatting"})||n.day(t,{width:"short",context:"formatting"})||n.day(t,{width:"narrow",context:"formatting"});case"eeeee":return n.day(t,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(t,{width:"short",context:"formatting"})||n.day(t,{width:"narrow",context:"formatting"});default:return n.day(t,{width:"wide",context:"formatting"})||n.day(t,{width:"abbreviated",context:"formatting"})||n.day(t,{width:"short",context:"formatting"})||n.day(t,{width:"narrow",context:"formatting"})}}validate(t,e){return e>=0&&e<=6}set(t,e,n,i){return(t=Jm(t,n,i)).setHours(0,0,0,0),t}incompatibleTokens=["y","R","u","q","Q","M","L","I","d","D","E","i","c","t","T"]},c:new class extends om{priority=90;parse(t,e,n,i){const a=t=>{const e=7*Math.floor((t-1)/7);return(t+i.weekStartsOn+6)%7+e};switch(e){case"c":case"cc":return Bm(Nm(e.length,t),a);case"co":return Bm(n.ordinalNumber(t,{unit:"day"}),a);case"ccc":return n.day(t,{width:"abbreviated",context:"standalone"})||n.day(t,{width:"short",context:"standalone"})||n.day(t,{width:"narrow",context:"standalone"});case"ccccc":return n.day(t,{width:"narrow",context:"standalone"});case"cccccc":return n.day(t,{width:"short",context:"standalone"})||n.day(t,{width:"narrow",context:"standalone"});default:return n.day(t,{width:"wide",context:"standalone"})||n.day(t,{width:"abbreviated",context:"standalone"})||n.day(t,{width:"short",context:"standalone"})||n.day(t,{width:"narrow",context:"standalone"})}}validate(t,e){return e>=0&&e<=6}set(t,e,n,i){return(t=Jm(t,n,i)).setHours(0,0,0,0),t}incompatibleTokens=["y","R","u","q","Q","M","L","I","d","D","E","i","e","t","T"]},i:new class extends om{priority=90;parse(t,e,n){const i=t=>0===t?7:t;switch(e){case"i":case"ii":return Nm(e.length,t);case"io":return n.ordinalNumber(t,{unit:"day"});case"iii":return Bm(n.day(t,{width:"abbreviated",context:"formatting"})||n.day(t,{width:"short",context:"formatting"})||n.day(t,{width:"narrow",context:"formatting"}),i);case"iiiii":return Bm(n.day(t,{width:"narrow",context:"formatting"}),i);case"iiiiii":return Bm(n.day(t,{width:"short",context:"formatting"})||n.day(t,{width:"narrow",context:"formatting"}),i);default:return Bm(n.day(t,{width:"wide",context:"formatting"})||n.day(t,{width:"abbreviated",context:"formatting"})||n.day(t,{width:"short",context:"formatting"})||n.day(t,{width:"narrow",context:"formatting"}),i)}}validate(t,e){return e>=1&&e<=7}set(t,e,n){return(t=tg(t,n)).setHours(0,0,0,0),t}incompatibleTokens=["y","Y","u","q","Q","M","L","w","d","D","E","e","c","t","T"]},a:new class extends om{priority=80;parse(t,e,n){switch(e){case"a":case"aa":case"aaa":return n.dayPeriod(t,{width:"abbreviated",context:"formatting"})||n.dayPeriod(t,{width:"narrow",context:"formatting"});case"aaaaa":return n.dayPeriod(t,{width:"narrow",context:"formatting"});default:return n.dayPeriod(t,{width:"wide",context:"formatting"})||n.dayPeriod(t,{width:"abbreviated",context:"formatting"})||n.dayPeriod(t,{width:"narrow",context:"formatting"})}}set(t,e,n){return t.setHours(Vm(n),0,0,0),t}incompatibleTokens=["b","B","H","k","t","T"]},b:new class extends om{priority=80;parse(t,e,n){switch(e){case"b":case"bb":case"bbb":return n.dayPeriod(t,{width:"abbreviated",context:"formatting"})||n.dayPeriod(t,{width:"narrow",context:"formatting"});case"bbbbb":return n.dayPeriod(t,{width:"narrow",context:"formatting"});default:return n.dayPeriod(t,{width:"wide",context:"formatting"})||n.dayPeriod(t,{width:"abbreviated",context:"formatting"})||n.dayPeriod(t,{width:"narrow",context:"formatting"})}}set(t,e,n){return t.setHours(Vm(n),0,0,0),t}incompatibleTokens=["a","B","H","k","t","T"]},B:new class extends om{priority=80;parse(t,e,n){switch(e){case"B":case"BB":case"BBB":return n.dayPeriod(t,{width:"abbreviated",context:"formatting"})||n.dayPeriod(t,{width:"narrow",context:"formatting"});case"BBBBB":return n.dayPeriod(t,{width:"narrow",context:"formatting"});default:return n.dayPeriod(t,{width:"wide",context:"formatting"})||n.dayPeriod(t,{width:"abbreviated",context:"formatting"})||n.dayPeriod(t,{width:"narrow",context:"formatting"})}}set(t,e,n){return t.setHours(Vm(n),0,0,0),t}incompatibleTokens=["a","b","t","T"]},h:new class extends om{priority=70;parse(t,e,n){switch(e){case"h":return Om(ym,t);case"ho":return n.ordinalNumber(t,{unit:"hour"});default:return Nm(e.length,t)}}validate(t,e){return e>=1&&e<=12}set(t,e,n){const i=t.getHours()>=12;return i&&n<12?t.setHours(n+12,0,0,0):i||12!==n?t.setHours(n,0,0,0):t.setHours(0,0,0,0),t}incompatibleTokens=["H","K","k","t","T"]},H:new class extends om{priority=70;parse(t,e,n){switch(e){case"H":return Om(mm,t);case"Ho":return n.ordinalNumber(t,{unit:"hour"});default:return Nm(e.length,t)}}validate(t,e){return e>=0&&e<=23}set(t,e,n){return t.setHours(n,0,0,0),t}incompatibleTokens=["a","b","h","K","k","t","T"]},K:new class extends om{priority=70;parse(t,e,n){switch(e){case"K":return Om(_m,t);case"Ko":return n.ordinalNumber(t,{unit:"hour"});default:return Nm(e.length,t)}}validate(t,e){return e>=0&&e<=11}set(t,e,n){return t.getHours()>=12&&n<12?t.setHours(n+12,0,0,0):t.setHours(n,0,0,0),t}incompatibleTokens=["h","H","k","t","T"]},k:new class extends om{priority=70;parse(t,e,n){switch(e){case"k":return Om(gm,t);case"ko":return n.ordinalNumber(t,{unit:"hour"});default:return Nm(e.length,t)}}validate(t,e){return e>=1&&e<=24}set(t,e,n){const i=n<=24?n%24:n;return t.setHours(i,0,0,0),t}incompatibleTokens=["a","b","h","H","K","t","T"]},m:new class extends om{priority=60;parse(t,e,n){switch(e){case"m":return Om(xm,t);case"mo":return n.ordinalNumber(t,{unit:"minute"});default:return Nm(e.length,t)}}validate(t,e){return e>=0&&e<=59}set(t,e,n){return t.setMinutes(n,0,0),t}incompatibleTokens=["t","T"]},s:new class extends om{priority=50;parse(t,e,n){switch(e){case"s":return Om(vm,t);case"so":return n.ordinalNumber(t,{unit:"second"});default:return Nm(e.length,t)}}validate(t,e){return e>=0&&e<=59}set(t,e,n){return t.setSeconds(n,0),t}incompatibleTokens=["t","T"]},S:new class extends om{priority=30;parse(t,e){return Bm(Nm(e.length,t),(t=>Math.trunc(t*Math.pow(10,3-e.length))))}set(t,e,n){return t.setMilliseconds(n),t}incompatibleTokens=["t","T"]},X:new class extends om{priority=10;parse(t,e){switch(e){case"X":return Rm(Im,t);case"XX":return Rm(Pm,t);case"XXXX":return Rm(zm,t);case"XXXXX":return Rm(Lm,t);default:return Rm(Dm,t)}}set(t,e,n){return e.timestampIsSet?t:Bf(t,t.getTime()-eg(t)-n)}incompatibleTokens=["t","T","x"]},x:new class extends om{priority=10;parse(t,e){switch(e){case"x":return Rm(Im,t);case"xx":return Rm(Pm,t);case"xxxx":return Rm(zm,t);case"xxxxx":return Rm(Lm,t);default:return Rm(Dm,t)}}set(t,e,n){return e.timestampIsSet?t:Bf(t,t.getTime()-eg(t)-n)}incompatibleTokens=["t","T","X"]},t:new class extends om{priority=40;parse(t){return Fm(t)}set(t,e,n){return[Bf(t,1e3*n),{timestampIsSet:!0}]}incompatibleTokens="*"},T:new class extends om{priority=20;parse(t){return Fm(t)}set(t,e,n){return[Bf(t,n),{timestampIsSet:!0}]}incompatibleTokens="*"}},ig=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,ag=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,rg=/^'([^]*?)'?$/,og=/''/g,sg=/\S/,lg=/[a-zA-Z]/;function cg(t,e,n,i){const a=Object.assign({},Rf()),r=i?.locale??a.locale??Hf,o=i?.firstWeekContainsDate??i?.locale?.options?.firstWeekContainsDate??a.firstWeekContainsDate??a.locale?.options?.firstWeekContainsDate??1,s=i?.weekStartsOn??i?.locale?.options?.weekStartsOn??a.weekStartsOn??a.locale?.options?.weekStartsOn??0;if(""===e)return""===t?Lf(n):Bf(n,NaN);const l={firstWeekContainsDate:o,weekStartsOn:s,locale:r},c=[new rm],u=e.match(ag).map((t=>{const e=t[0];return e in Xf?(0,Xf[e])(t,r.formatLong):t})).join("").match(ig),h=[];for(let a of u){!i?.useAdditionalWeekYearTokens&&em(a)&&nm(a,e,t),!i?.useAdditionalDayOfYearTokens&&tm(a)&&nm(a,e,t);const o=a[0],s=ng[o];if(s){const{incompatibleTokens:e}=s;if(Array.isArray(e)){const t=h.find((t=>e.includes(t.token)||t.token===o));if(t)throw new RangeError(`The format string mustn't contain \`${t.fullToken}\` and \`${a}\` at the same time`)}else if("*"===s.incompatibleTokens&&h.length>0)throw new RangeError(`The format string mustn't contain \`${a}\` and any other token at the same time`);h.push({token:o,fullToken:a});const i=s.run(t,a,r.match,l);if(!i)return Bf(n,NaN);c.push(i.setter),t=i.rest}else{if(o.match(lg))throw new RangeError("Format string contains an unescaped latin alphabet character `"+o+"`");if("''"===a?a="'":"'"===o&&(a=a.match(rg)[1].replace(og,"'")),0!==t.indexOf(a))return Bf(n,NaN);t=t.slice(a.length)}}if(t.length>0&&sg.test(t))return Bf(n,NaN);const d=c.map((t=>t.priority)).sort(((t,e)=>e-t)).filter(((t,e,n)=>n.indexOf(t)===e)).map((t=>c.filter((e=>e.priority===t)).sort(((t,e)=>e.subPriority-t.subPriority)))).map((t=>t[0]));let p=Lf(n);if(isNaN(p.getTime()))return Bf(n,NaN);const f={};for(const t of d){if(!t.validate(p,l))return Bf(n,NaN);const e=t.set(p,f,l);Array.isArray(e)?(p=e[0],Object.assign(f,e[1])):p=e}return Bf(n,p)}const ug={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},hg=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,dg=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,pg=/^([+-])(\d{2})(?::?(\d{2}))?$/;function fg(t){return t?parseInt(t):1}function mg(t){return t&&parseFloat(t.replace(",","."))||0}const gg=[31,null,31,30,31,30,31,31,30,31,30,31];function _g(t){return t%400==0||t%4==0&&t%100!=0}function yg(t){if(!(e=t,e instanceof Date||"object"==typeof e&&"[object Date]"===Object.prototype.toString.call(e)||"number"==typeof t))return!1;var e;const n=Lf(t);return!isNaN(Number(n))}function xg(t){const e=Lf(t);return e.setHours(0,0,0,0),e}function vg(t,e){const n=xg(t),i=xg(e),a=+n-eg(n),r=+i-eg(i);return Math.round((a-r)/lm)}function bg(t){const e=Lf(t),n=Bf(t,0);return n.setFullYear(e.getFullYear(),0,1),n.setHours(0,0,0,0),n}function wg(t,e){return(t<0?"-":"")+Math.abs(t).toString().padStart(e,"0")}const Ag={y(t,e){const n=t.getFullYear(),i=n>0?n:1-n;return wg("yy"===e?i%100:i,e.length)},M(t,e){const n=t.getMonth();return"M"===e?String(n+1):wg(n+1,2)},d:(t,e)=>wg(t.getDate(),e.length),a(t,e){const n=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return n.toUpperCase();case"aaa":return n;case"aaaaa":return n[0];default:return"am"===n?"a.m.":"p.m."}},h:(t,e)=>wg(t.getHours()%12||12,e.length),H:(t,e)=>wg(t.getHours(),e.length),m:(t,e)=>wg(t.getMinutes(),e.length),s:(t,e)=>wg(t.getSeconds(),e.length),S(t,e){const n=e.length,i=t.getMilliseconds();return wg(Math.trunc(i*Math.pow(10,n-3)),e.length)}},Cg={G:function(t,e,n){const i=t.getFullYear()>0?1:0;switch(e){case"G":case"GG":case"GGG":return n.era(i,{width:"abbreviated"});case"GGGGG":return n.era(i,{width:"narrow"});default:return n.era(i,{width:"wide"})}},y:function(t,e,n){if("yo"===e){const e=t.getFullYear(),i=e>0?e:1-e;return n.ordinalNumber(i,{unit:"year"})}return Ag.y(t,e)},Y:function(t,e,n,i){const a=$m(t,i),r=a>0?a:1-a;return"YY"===e?wg(r%100,2):"Yo"===e?n.ordinalNumber(r,{unit:"year"}):wg(r,e.length)},R:function(t,e){return wg(Zm(t),e.length)},u:function(t,e){return wg(t.getFullYear(),e.length)},Q:function(t,e,n){const i=Math.ceil((t.getMonth()+1)/3);switch(e){case"Q":return String(i);case"QQ":return wg(i,2);case"Qo":return n.ordinalNumber(i,{unit:"quarter"});case"QQQ":return n.quarter(i,{width:"abbreviated",context:"formatting"});case"QQQQQ":return n.quarter(i,{width:"narrow",context:"formatting"});default:return n.quarter(i,{width:"wide",context:"formatting"})}},q:function(t,e,n){const i=Math.ceil((t.getMonth()+1)/3);switch(e){case"q":return String(i);case"qq":return wg(i,2);case"qo":return n.ordinalNumber(i,{unit:"quarter"});case"qqq":return n.quarter(i,{width:"abbreviated",context:"standalone"});case"qqqqq":return n.quarter(i,{width:"narrow",context:"standalone"});default:return n.quarter(i,{width:"wide",context:"standalone"})}},M:function(t,e,n){const i=t.getMonth();switch(e){case"M":case"MM":return Ag.M(t,e);case"Mo":return n.ordinalNumber(i+1,{unit:"month"});case"MMM":return n.month(i,{width:"abbreviated",context:"formatting"});case"MMMMM":return n.month(i,{width:"narrow",context:"formatting"});default:return n.month(i,{width:"wide",context:"formatting"})}},L:function(t,e,n){const i=t.getMonth();switch(e){case"L":return String(i+1);case"LL":return wg(i+1,2);case"Lo":return n.ordinalNumber(i+1,{unit:"month"});case"LLL":return n.month(i,{width:"abbreviated",context:"standalone"});case"LLLLL":return n.month(i,{width:"narrow",context:"standalone"});default:return n.month(i,{width:"wide",context:"standalone"})}},w:function(t,e,n,i){const a=Hm(t,i);return"wo"===e?n.ordinalNumber(a,{unit:"week"}):wg(a,e.length)},I:function(t,e,n){const i=Ym(t);return"Io"===e?n.ordinalNumber(i,{unit:"week"}):wg(i,e.length)},d:function(t,e,n){return"do"===e?n.ordinalNumber(t.getDate(),{unit:"date"}):Ag.d(t,e)},D:function(t,e,n){const i=function(t){const e=Lf(t);return vg(e,bg(e))+1}(t);return"Do"===e?n.ordinalNumber(i,{unit:"dayOfYear"}):wg(i,e.length)},E:function(t,e,n){const i=t.getDay();switch(e){case"E":case"EE":case"EEE":return n.day(i,{width:"abbreviated",context:"formatting"});case"EEEEE":return n.day(i,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(i,{width:"short",context:"formatting"});default:return n.day(i,{width:"wide",context:"formatting"})}},e:function(t,e,n,i){const a=t.getDay(),r=(a-i.weekStartsOn+8)%7||7;switch(e){case"e":return String(r);case"ee":return wg(r,2);case"eo":return n.ordinalNumber(r,{unit:"day"});case"eee":return n.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return n.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(a,{width:"short",context:"formatting"});default:return n.day(a,{width:"wide",context:"formatting"})}},c:function(t,e,n,i){const a=t.getDay(),r=(a-i.weekStartsOn+8)%7||7;switch(e){case"c":return String(r);case"cc":return wg(r,e.length);case"co":return n.ordinalNumber(r,{unit:"day"});case"ccc":return n.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return n.day(a,{width:"narrow",context:"standalone"});case"cccccc":return n.day(a,{width:"short",context:"standalone"});default:return n.day(a,{width:"wide",context:"standalone"})}},i:function(t,e,n){const i=t.getDay(),a=0===i?7:i;switch(e){case"i":return String(a);case"ii":return wg(a,e.length);case"io":return n.ordinalNumber(a,{unit:"day"});case"iii":return n.day(i,{width:"abbreviated",context:"formatting"});case"iiiii":return n.day(i,{width:"narrow",context:"formatting"});case"iiiiii":return n.day(i,{width:"short",context:"formatting"});default:return n.day(i,{width:"wide",context:"formatting"})}},a:function(t,e,n){const i=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return n.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"aaa":return n.dayPeriod(i,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return n.dayPeriod(i,{width:"narrow",context:"formatting"});default:return n.dayPeriod(i,{width:"wide",context:"formatting"})}},b:function(t,e,n){const i=t.getHours();let a;switch(a=12===i?"noon":0===i?"midnight":i/12>=1?"pm":"am",e){case"b":case"bb":return n.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"bbb":return n.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return n.dayPeriod(a,{width:"narrow",context:"formatting"});default:return n.dayPeriod(a,{width:"wide",context:"formatting"})}},B:function(t,e,n){const i=t.getHours();let a;switch(a=i>=17?"evening":i>=12?"afternoon":i>=4?"morning":"night",e){case"B":case"BB":case"BBB":return n.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"BBBBB":return n.dayPeriod(a,{width:"narrow",context:"formatting"});default:return n.dayPeriod(a,{width:"wide",context:"formatting"})}},h:function(t,e,n){if("ho"===e){let e=t.getHours()%12;return 0===e&&(e=12),n.ordinalNumber(e,{unit:"hour"})}return Ag.h(t,e)},H:function(t,e,n){return"Ho"===e?n.ordinalNumber(t.getHours(),{unit:"hour"}):Ag.H(t,e)},K:function(t,e,n){const i=t.getHours()%12;return"Ko"===e?n.ordinalNumber(i,{unit:"hour"}):wg(i,e.length)},k:function(t,e,n){let i=t.getHours();return 0===i&&(i=24),"ko"===e?n.ordinalNumber(i,{unit:"hour"}):wg(i,e.length)},m:function(t,e,n){return"mo"===e?n.ordinalNumber(t.getMinutes(),{unit:"minute"}):Ag.m(t,e)},s:function(t,e,n){return"so"===e?n.ordinalNumber(t.getSeconds(),{unit:"second"}):Ag.s(t,e)},S:function(t,e){return Ag.S(t,e)},X:function(t,e,n){const i=t.getTimezoneOffset();if(0===i)return"Z";switch(e){case"X":return Tg(i);case"XXXX":case"XX":return Sg(i);default:return Sg(i,":")}},x:function(t,e,n){const i=t.getTimezoneOffset();switch(e){case"x":return Tg(i);case"xxxx":case"xx":return Sg(i);default:return Sg(i,":")}},O:function(t,e,n){const i=t.getTimezoneOffset();switch(e){case"O":case"OO":case"OOO":return"GMT"+Eg(i,":");default:return"GMT"+Sg(i,":")}},z:function(t,e,n){const i=t.getTimezoneOffset();switch(e){case"z":case"zz":case"zzz":return"GMT"+Eg(i,":");default:return"GMT"+Sg(i,":")}},t:function(t,e,n){return wg(Math.trunc(t.getTime()/1e3),e.length)},T:function(t,e,n){return wg(t.getTime(),e.length)}};function Eg(t,e=""){const n=t>0?"-":"+",i=Math.abs(t),a=Math.trunc(i/60),r=i%60;return 0===r?n+String(a):n+String(a)+e+wg(r,2)}function Tg(t,e){return t%60==0?(t>0?"-":"+")+wg(Math.abs(t)/60,2):Sg(t,e)}function Sg(t,e=""){const n=t>0?"-":"+",i=Math.abs(t);return n+wg(Math.trunc(i/60),2)+e+wg(i%60,2)}const Mg=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,kg=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,Ig=/^'([^]*?)'?$/,Pg=/''/g,zg=/[a-zA-Z]/;function Dg(t){const e=t.match(Ig);return e?e[1].replace(Pg,"'"):t}function Lg(t,e){return Bf(t,+Lf(t)+e)}function Bg(t,e){const n=Lf(t);if(isNaN(e))return Bf(t,NaN);if(!e)return n;const i=n.getDate(),a=Bf(t,n.getTime());return a.setMonth(n.getMonth()+e+1,0),i>=a.getDate()?a:(n.setFullYear(a.getFullYear(),a.getMonth(),i),n)}function Og(t,e){return+Lf(t)-+Lf(e)}function Rg(t){return e=>{const n=(t?Math[t]:Math.trunc)(e);return 0===n?0:n}}function Fg(t,e){const n=Lf(t),i=Lf(e),a=Ng(n,i),r=Math.abs(vg(n,i));n.setDate(n.getDate()-a*r);const o=a*(r-Number(Ng(n,i)===-a));return 0===o?0:o}function Ng(t,e){const n=t.getFullYear()-e.getFullYear()||t.getMonth()-e.getMonth()||t.getDate()-e.getDate()||t.getHours()-e.getHours()||t.getMinutes()-e.getMinutes()||t.getSeconds()-e.getSeconds()||t.getMilliseconds()-e.getMilliseconds();return n<0?-1:n>0?1:n}function jg(t,e){const n=Lf(t),i=Lf(e),a=n.getTime()-i.getTime();return a<0?-1:a>0?1:a}function Vg(t){const e=Lf(t);return e.setHours(23,59,59,999),e}function Ug(t){const e=Lf(t),n=e.getMonth();return e.setFullYear(e.getFullYear(),n+1,0),e.setHours(23,59,59,999),e}function Gg(t,e){const n=Lf(t),i=Lf(e),a=jg(n,i),r=Math.abs(function(t,e){const n=Lf(t),i=Lf(e);return 12*(n.getFullYear()-i.getFullYear())+(n.getMonth()-i.getMonth())}(n,i));let o;if(r<1)o=0;else{1===n.getMonth()&&n.getDate()>27&&n.setDate(30),n.setMonth(n.getMonth()-a*r);let e=jg(n,i)===-a;(function(t){const e=Lf(t);return+Vg(e)==+Ug(e)})(Lf(t))&&1===r&&1===jg(t,i)&&(e=!1),o=a*(r-Number(e))}return 0===o?0:o}function qg(t,e){const n=Lf(t),i=Lf(e),a=jg(n,i),r=Math.abs(function(t,e){const n=Lf(t),i=Lf(e);return n.getFullYear()-i.getFullYear()}(n,i));n.setFullYear(1584),i.setFullYear(1584);const o=a*(r-+(jg(n,i)===-a));return 0===o?0:o}const $g={datetime:"MMM d, yyyy, h:mm:ss aaaa",millisecond:"h:mm:ss.SSS aaaa",second:"h:mm:ss aaaa",minute:"h:mm aaaa",hour:"ha",day:"MMM d",week:"PP",month:"MMM yyyy",quarter:"qqq - yyyy",year:"yyyy"};_d._date.override({_id:"date-fns",formats:function(){return $g},parse:function(t,e){if(null==t)return null;const n=typeof t;return"number"===n||t instanceof Date?t=Lf(t):"string"===n&&(t="string"==typeof e?cg(t,e,new Date,this.options):function(t,e){const n=e?.additionalDigits??2,i=function(t){const e={},n=t.split(ug.dateTimeDelimiter);let i;if(n.length>2)return e;if(/:/.test(n[0])?i=n[0]:(e.date=n[0],i=n[1],ug.timeZoneDelimiter.test(e.date)&&(e.date=t.split(ug.timeZoneDelimiter)[0],i=t.substr(e.date.length,t.length))),i){const t=ug.timezone.exec(i);t?(e.time=i.replace(t[1],""),e.timezone=t[1]):e.time=i}return e}(t);let a;if(i.date){const t=function(t,e){const n=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+e)+"})|(\\d{2}|[+-]\\d{"+(2+e)+"})$)"),i=t.match(n);if(!i)return{year:NaN,restDateString:""};const a=i[1]?parseInt(i[1]):null,r=i[2]?parseInt(i[2]):null;return{year:null===r?a:100*r,restDateString:t.slice((i[1]||i[2]).length)}}(i.date,n);a=function(t,e){if(null===e)return new Date(NaN);const n=t.match(hg);if(!n)return new Date(NaN);const i=!!n[4],a=fg(n[1]),r=fg(n[2])-1,o=fg(n[3]),s=fg(n[4]),l=fg(n[5])-1;if(i)return function(t,e,n){return e>=1&&e<=53&&n>=0&&n<=6}(0,s,l)?function(t,e,n){const i=new Date(0);i.setUTCFullYear(t,0,4);const a=7*(e-1)+n+1-(i.getUTCDay()||7);return i.setUTCDate(i.getUTCDate()+a),i}(e,s,l):new Date(NaN);{const t=new Date(0);return function(t,e,n){return e>=0&&e<=11&&n>=1&&n<=(gg[e]||(_g(t)?29:28))}(e,r,o)&&function(t,e){return e>=1&&e<=(_g(t)?366:365)}(e,a)?(t.setUTCFullYear(e,r,Math.max(a,o)),t):new Date(NaN)}}(t.restDateString,t.year)}if(!a||isNaN(a.getTime()))return new Date(NaN);const r=a.getTime();let o,s=0;if(i.time&&(s=function(t){const e=t.match(dg);if(!e)return NaN;const n=mg(e[1]),i=mg(e[2]),a=mg(e[3]);return function(t,e,n){return 24===t?0===e&&0===n:n>=0&&n<60&&e>=0&&e<60&&t>=0&&t<25}(n,i,a)?n*um+i*cm+1e3*a:NaN}(i.time),isNaN(s)))return new Date(NaN);if(!i.timezone){const t=new Date(r+s),e=new Date(0);return e.setFullYear(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()),e.setHours(t.getUTCHours(),t.getUTCMinutes(),t.getUTCSeconds(),t.getUTCMilliseconds()),e}return o=function(t){if("Z"===t)return 0;const e=t.match(pg);if(!e)return 0;const n="+"===e[1]?-1:1,i=parseInt(e[2]),a=e[3]&&parseInt(e[3])||0;return function(t,e){return e>=0&&e<=59}(0,a)?n*(i*um+a*cm):NaN}(i.timezone),isNaN(o)?new Date(NaN):new Date(r+s+o)}(t,this.options)),yg(t)?t.getTime():null},format:function(t,e){return function(t,e,n){const i=Rf(),a=n?.locale??i.locale??Hf,r=n?.firstWeekContainsDate??n?.locale?.options?.firstWeekContainsDate??i.firstWeekContainsDate??i.locale?.options?.firstWeekContainsDate??1,o=n?.weekStartsOn??n?.locale?.options?.weekStartsOn??i.weekStartsOn??i.locale?.options?.weekStartsOn??0,s=Lf(t);if(!yg(s))throw new RangeError("Invalid time value");let l=e.match(kg).map((t=>{const e=t[0];return"p"===e||"P"===e?(0,Xf[e])(t,a.formatLong):t})).join("").match(Mg).map((t=>{if("''"===t)return{isToken:!1,value:"'"};const e=t[0];if("'"===e)return{isToken:!1,value:Dg(t)};if(Cg[e])return{isToken:!0,value:t};if(e.match(zg))throw new RangeError("Format string contains an unescaped latin alphabet character `"+e+"`");return{isToken:!1,value:t}}));a.localize.preprocessor&&(l=a.localize.preprocessor(s,l));const c={firstWeekContainsDate:r,weekStartsOn:o,locale:a};return l.map((i=>{if(!i.isToken)return i.value;const r=i.value;return(!n?.useAdditionalWeekYearTokens&&em(r)||!n?.useAdditionalDayOfYearTokens&&tm(r))&&nm(r,e,String(t)),(0,Cg[r[0]])(s,r,a.localize,c)})).join("")}(t,e,this.options)},add:function(t,e,n){switch(n){case"millisecond":return Lg(t,e);case"second":return function(t,e){return Lg(t,1e3*e)}(t,e);case"minute":return function(t,e){return Lg(t,e*cm)}(t,e);case"hour":return function(t,e){return Lg(t,e*um)}(t,e);case"day":return Qm(t,e);case"week":return function(t,e){return Qm(t,7*e)}(t,e);case"month":return Bg(t,e);case"quarter":return function(t,e){return Bg(t,3*e)}(t,e);case"year":return function(t,e){return Bg(t,12*e)}(t,e);default:return t}},diff:function(t,e,n){switch(n){case"millisecond":return Og(t,e);case"second":return function(t,e,n){const i=Og(t,e)/1e3;return Rg(n?.roundingMethod)(i)}(t,e);case"minute":return function(t,e,n){const i=Og(t,e)/cm;return Rg(n?.roundingMethod)(i)}(t,e);case"hour":return function(t,e,n){const i=Og(t,e)/um;return Rg(n?.roundingMethod)(i)}(t,e);case"day":return Fg(t,e);case"week":return function(t,e,n){const i=Fg(t,e)/7;return Rg(n?.roundingMethod)(i)}(t,e);case"month":return Gg(t,e);case"quarter":return function(t,e,n){const i=Gg(t,e)/3;return Rg(n?.roundingMethod)(i)}(t,e);case"year":return qg(t,e);default:return 0}},startOf:function(t,e,n){switch(e){case"second":return function(t){const e=Lf(t);return e.setMilliseconds(0),e}(t);case"minute":return function(t){const e=Lf(t);return e.setSeconds(0,0),e}(t);case"hour":return function(t){const e=Lf(t);return e.setMinutes(0,0,0),e}(t);case"day":return xg(t);case"week":return qm(t);case"isoWeek":return qm(t,{weekStartsOn:+n});case"month":return function(t){const e=Lf(t);return e.setDate(1),e.setHours(0,0,0,0),e}(t);case"quarter":return function(t){const e=Lf(t),n=e.getMonth(),i=n-n%3;return e.setMonth(i,1),e.setHours(0,0,0,0),e}(t);case"year":return bg(t);default:return t}},endOf:function(t,e){switch(e){case"second":return function(t){const e=Lf(t);return e.setMilliseconds(999),e}(t);case"minute":return function(t){const e=Lf(t);return e.setSeconds(59,999),e}(t);case"hour":return function(t){const e=Lf(t);return e.setMinutes(59,59,999),e}(t);case"day":return Vg(t);case"week":return function(t,e){const n=Rf(),i=e?.weekStartsOn??e?.locale?.options?.weekStartsOn??n.weekStartsOn??n.locale?.options?.weekStartsOn??0,a=Lf(t),r=a.getDay(),o=6+(r<i?-7:0)-(r-i);return a.setDate(a.getDate()+o),a.setHours(23,59,59,999),a}(t);case"month":return Ug(t);case"quarter":return function(t){const e=Lf(t),n=e.getMonth(),i=n-n%3+3;return e.setMonth(i,0),e.setHours(23,59,59,999),e}(t);case"year":return function(t){const e=Lf(t),n=e.getFullYear();return e.setFullYear(n+1,0,0),e.setHours(23,59,59,999),e}(t);default:return t}}});const Wg={responsive:!0,plugins:{legend:{position:"top"},title:{display:!0,text:"Chart"},tooltip:{position:"nearest",intersect:!1,mode:"index",callbacks:{label:t=>{const e=t.dataset.data[t.dataIndex];return[" Date: ".concat(e.x.toLocaleDateString())," Open: ".concat(e.o.toFixed(2))," High: ".concat(e.h.toFixed(2))," Low: ".concat(e.l.toFixed(2))," Close: ".concat(e.c.toFixed(2))]}}}},scales:{x:{type:"time",time:{unit:"day",tooltipFormat:"MMM dd",displayFormats:{day:"MMM dd"}},ticks:{source:"data",autoSkip:!0,maxRotation:0,sampleSize:10,font:{size:12}},title:{display:!0,text:"Date",color:"gray",font:{size:16}}},y:{type:"linear",ticks:{callback:t=>t.toFixed(2)}}},elements:{candlestick:{color:{up:"rgba(0, 255, 0, 0.5)",down:"rgba(255, 0, 0, 0.5)",unchanged:"rgba(0, 0, 255, 0.5)"},borderColor:{up:"rgba(0, 255, 0, 1)",down:"rgba(255, 0, 0, 1)",unchanged:"rgba(0, 0, 255, 1)"},borderWidth:1}},barPercentage:.1,categoryPercentage:.1};var Hg;const Zg=mi.div(Hg||(Hg=function(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}(["\n  max-width: 800px;\n  margin: 0 auto;\n"])));Np.register(class extends lp{static id="category";static defaults={ticks:{callback:hf}};constructor(t){super(t),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(t){const e=this._addedLabels;if(e.length){const t=this.getLabels();for(const{index:n,label:i}of e)t[n]===i&&t.splice(n,1);this._addedLabels=[]}super.init(t)}parse(t,e){if(Bc(t))return null;const n=this.getLabels();return((t,e)=>null===t?null:_u(Math.round(t),0,e))(e=isFinite(e)&&n[e]===t?e:function(t,e,n,i){const a=t.indexOf(e);return-1===a?((t,e,n,i)=>("string"==typeof e?(n=t.push(e)-1,i.unshift({index:n,label:e})):isNaN(e)&&(n=null),n))(t,e,n,i):a!==t.lastIndexOf(e)?n:a}(n,t,jc(e,t),this._addedLabels),n.length-1)}determineDataLimits(){const{minDefined:t,maxDefined:e}=this.getUserBounds();let{min:n,max:i}=this.getMinMax(!0);"ticks"===this.options.bounds&&(t||(n=0),e||(i=this.getLabels().length-1)),this.min=n,this.max=i}buildTicks(){const t=this.min,e=this.max,n=this.options.offset,i=[];let a=this.getLabels();a=0===t&&e===a.length-1?a:a.slice(t,e+1),this._valueRange=Math.max(a.length-(n?0:1),1),this._startValue=this.min-(n?.5:0);for(let n=t;n<=e;n++)i.push({value:n});return i}getLabelForValue(t){return hf.call(this,t)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(t){return"number"!=typeof t&&(t=this.parse(t)),null===t?NaN:this.getPixelForDecimal((t-this._startValue)/this._valueRange)}getPixelForTick(t){const e=this.ticks;return t<0||t>e.length-1?null:this.getPixelForValue(e[t].value)}getValueForPixel(t){return Math.round(this._startValue+this.getDecimalForPixel(t)*this._valueRange)}getBasePixel(){return this.bottom}},ff,class extends lp{static id="time";static defaults={bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}};constructor(t){super(t),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(t,e={}){const n=t.time||(t.time={}),i=this._adapter=new _d._date(t.adapters.date);i.init(e),Zc(n.displayFormats,i.formats()),this._parseOpts={parser:n.parser,round:n.round,isoWeekday:n.isoWeekday},super.init(t),this._normalized=e.normalized}parse(t,e){return void 0===t?null:yf(this,t)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const t=this.options,e=this._adapter,n=t.time.unit||"day";let{min:i,max:a,minDefined:r,maxDefined:o}=this.getUserBounds();function s(t){r||isNaN(t.min)||(i=Math.min(i,t.min)),o||isNaN(t.max)||(a=Math.max(a,t.max))}r&&o||(s(this._getLabelBounds()),"ticks"===t.bounds&&"labels"===t.ticks.source||s(this.getMinMax(!1))),i=Fc(i)&&!isNaN(i)?i:+e.startOf(Date.now(),n),a=Fc(a)&&!isNaN(a)?a:+e.endOf(Date.now(),n)+1,this.min=Math.min(i,a-1),this.max=Math.max(i+1,a)}_getLabelBounds(){const t=this.getLabelTimestamps();let e=Number.POSITIVE_INFINITY,n=Number.NEGATIVE_INFINITY;return t.length&&(e=t[0],n=t[t.length-1]),{min:e,max:n}}buildTicks(){const t=this.options,e=t.time,n=t.ticks,i="labels"===n.source?this.getLabelTimestamps():this._generate();"ticks"===t.bounds&&i.length&&(this.min=this._userMin||i[0],this.max=this._userMax||i[i.length-1]);const a=this.min,r=function(t,e,n){let i=0,a=t.length;for(;i<a&&t[i]<e;)i++;for(;a>i&&t[a-1]>n;)a--;return i>0||a<t.length?t.slice(i,a):t}(i,a,this.max);return this._unit=e.unit||(n.autoSkip?xf(e.minUnit,this.min,this.max,this._getLabelCapacity(a)):function(t,e,n,i,a){for(let r=gf.length-1;r>=gf.indexOf(n);r--){const n=gf[r];if(mf[n].common&&t._adapter.diff(a,i,n)>=e-1)return n}return gf[n?gf.indexOf(n):0]}(this,r.length,e.minUnit,this.min,this.max)),this._majorUnit=n.major.enabled&&"year"!==this._unit?function(t){for(let e=gf.indexOf(t)+1,n=gf.length;e<n;++e)if(mf[gf[e]].common)return gf[e]}(this._unit):void 0,this.initOffsets(i),t.reverse&&r.reverse(),bf(this,r,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map((t=>+t.value)))}initOffsets(t=[]){let e,n,i=0,a=0;this.options.offset&&t.length&&(e=this.getDecimalForValue(t[0]),i=1===t.length?1-e:(this.getDecimalForValue(t[1])-e)/2,n=this.getDecimalForValue(t[t.length-1]),a=1===t.length?n:(n-this.getDecimalForValue(t[t.length-2]))/2);const r=t.length<3?.5:.25;i=_u(i,0,r),a=_u(a,0,r),this._offsets={start:i,end:a,factor:1/(i+1+a)}}_generate(){const t=this._adapter,e=this.min,n=this.max,i=this.options,a=i.time,r=a.unit||xf(a.minUnit,e,n,this._getLabelCapacity(e)),o=jc(i.ticks.stepSize,1),s="week"===r&&a.isoWeekday,l=pu(s)||!0===s,c={};let u,h,d=e;if(l&&(d=+t.startOf(d,"isoWeek",s)),d=+t.startOf(d,l?"day":r),t.diff(n,e,r)>1e5*o)throw new Error(e+" and "+n+" are too far apart with stepSize of "+o+" "+r);const p="data"===i.ticks.source&&this.getDataTimestamps();for(u=d,h=0;u<n;u=+t.add(u,o,r),h++)vf(c,u,p);return u!==n&&"ticks"!==i.bounds&&1!==h||vf(c,u,p),Object.keys(c).sort(_f).map((t=>+t))}getLabelForValue(t){const e=this._adapter,n=this.options.time;return n.tooltipFormat?e.format(t,n.tooltipFormat):e.format(t,n.displayFormats.datetime)}format(t,e){const n=this.options.time.displayFormats,i=this._unit,a=e||n[i];return this._adapter.format(t,a)}_tickFormatFunction(t,e,n,i){const a=this.options,r=a.ticks.callback;if(r)return Vc(r,[t,e,n],this);const o=a.time.displayFormats,s=this._unit,l=this._majorUnit,c=s&&o[s],u=l&&o[l],h=n[e],d=l&&u&&h&&h.major;return this._adapter.format(t,i||(d?u:c))}generateTickLabels(t){let e,n,i;for(e=0,n=t.length;e<n;++e)i=t[e],i.label=this._tickFormatFunction(i.value,e,t)}getDecimalForValue(t){return null===t?NaN:(t-this.min)/(this.max-this.min)}getPixelForValue(t){const e=this._offsets,n=this.getDecimalForValue(t);return this.getPixelForDecimal((e.start+n)*e.factor)}getValueForPixel(t){const e=this._offsets,n=this.getDecimalForPixel(t)/e.factor-e.end;return this.min+n*(this.max-this.min)}_getLabelSize(t){const e=this.options.ticks,n=this.ctx.measureText(t).width,i=fu(this.isHorizontal()?e.maxRotation:e.minRotation),a=Math.cos(i),r=Math.sin(i),o=this._resolveTickFontOptions(0).size;return{w:n*a+o*r,h:n*r+o*a}}_getLabelCapacity(t){const e=this.options.time,n=e.displayFormats,i=n[e.unit]||n.millisecond,a=this._tickFormatFunction(t,0,bf(this,[t],this._majorUnit),i),r=this._getLabelSize(a),o=Math.floor(this.isHorizontal()?this.width/r.w:this.height/r.h)-1;return o>0?o:1}getDataTimestamps(){let t,e,n=this._cache.data||[];if(n.length)return n;const i=this.getMatchingVisibleMetas();if(this._normalized&&i.length)return this._cache.data=i[0].controller.getAllParsedValues(this);for(t=0,e=i.length;t<e;++t)n=n.concat(i[t].controller.getAllParsedValues(this));return this._cache.data=this.normalize(n)}getLabelTimestamps(){const t=this._cache.labels||[];let e,n;if(t.length)return t;const i=this.getLabels();for(e=0,n=i.length;e<n;++e)t.push(yf(this,i[e]));return this._cache.labels=this._normalized?t:this.normalize(t)}normalize(t){return Cu(t.sort(_f))}},Tf,Ef,uf,Zp);class Yg extends n.Component{render(){const{data:t}=this.props;return n.createElement(Zg,null,n.createElement(Df,{type:"candlestick",data:t,options:Wg,"data-testid":"graph"}))}}class Xg extends n.Component{render(){const{value:t,onChange:e}=this.props;return n.createElement("div",null,n.createElement("select",{onChange:e,value:t},Nl.map((t=>n.createElement("option",{key:t.code,value:t.code},t.name)))))}}var Kg,Qg,Jg,t_;function e_(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}const n_=mi.div(Kg||(Kg=e_(["\n  position: fixed;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  background-color: rgba(0, 0, 0, 0.5);\n  backdrop-filter: blur(3px);\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  z-index: 1000;\n"]))),i_=mi.div(Qg||(Qg=e_(["\n  position: relative;\n  width: 80%;\n  max-width: 500px;\n  background-color: #fff;\n  padding: 30px;\n  border-radius: 4px;\n  box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);\n  z-index: 1010;\n\n  @media (max-width: 450px) {\n    width: 60%;\n    margin-left: 150px;\n  }\n\n  label {\n    display: block;\n    margin-top: 10px;\n    font-size: ",";\n    color: rgba(65, 71, 64, 0.8);\n  }\n\n  input {\n    display: block;\n    width: 100%;\n    margin-top: 10px;\n    padding: 10px;\n    font-size: ",";\n    border-radius: 4px;\n    border: 1px solid #ccc;\n    box-sizing: border-box;\n  }\n\n  input[readonly] {\n    background-color: #f5f5f5;\n  }\n"])),(t=>{let{theme:e}=t;return e.fontSize.pSmall}),(t=>{let{theme:e}=t;return e.fontSize.pSmall})),a_=mi.button(Jg||(Jg=e_(["\n  cursor: pointer;\n  border: none;\n  background: none;\n  position: absolute;\n  top: 10px;\n  right: 10px;\n"]))),r_=mi.div(t_||(t_=e_(["\n  color: red;\n"]))),o_=(0,n.createContext)(),s_=t=>{let{children:e}=t;const[i,a]=(0,n.useState)([]);return n.createElement(o_.Provider,{value:{messages:i,addMessage:t=>{const e=i.filter((t=>!t.startsWith("The graph has been successfully built!")));a([...e,t])},clearMessages:()=>{a([])}}},e)};var l_;const c_=mi.span(l_||(l_=function(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}(["\n  color: rgba(70, 184, 48, 0.8);\n"]))),u_=()=>{const{messages:t}=(0,n.useContext)(o_);return n.createElement(n.Fragment,null,t.map(((t,e)=>n.createElement(c_,{key:e},t))))};class h_ extends n.Component{constructor(t){super(t),function(t,e,n){(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,"string");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n}(this,"handleClickOutside",(t=>{this.modalRef.current&&!this.modalRef.current.contains(t.target)&&this.props.onClose()})),this.modalRef=n.createRef()}componentDidMount(){document.addEventListener("mousedown",this.handleClickOutside)}componentWillUnmount(){document.removeEventListener("mousedown",this.handleClickOutside)}render(){const{isOpen:t,onClose:e,availableCurrencies:i,secondCurrency:a,setSecondCurrency:r,startDate:o,handleStartDateChange:s,endDate:l,dateError:c}=this.props;return t?n.createElement(n_,null,n.createElement(i_,{ref:this.modalRef,"data-testid":"currency-modal"},n.createElement(a_,{onClick:e,"data-testid":"close-button"},"X"),n.createElement("label",null,"Second currency:"),n.createElement(Xg,{options:i,value:a,onChange:t=>r(t.target.value),"data-testid":"currency-select"}),n.createElement("label",null,"Start Date:"),n.createElement("input",{type:"date",onChange:s,value:o.toISOString().split("T")[0],"data-testid":"start-date-input"}),c&&n.createElement(r_,{"data-testid":"date-error"},c),n.createElement("label",null,"Today"),n.createElement("input",{type:"date",value:l.toISOString().split("T")[0],readOnly:!0}),n.createElement(u_,null))):null}}const d_=async(t,e,n,i)=>{const a=((t,e,n,i)=>"".concat(t,"/").concat(e,"_").concat(n.toISOString(),"_").concat(i.toISOString()))(t,e,n,i),r=localStorage.getItem(a);if(r)return JSON.parse(r);try{const r=await(async(t,e,n,i)=>{const a="".concat(t,"/").concat(e),r="".concat("https://rest.coinapi.io/v1/exchangerate","/").concat(a,"/history?period_id=1DAY&time_start=").concat(n.toISOString(),"&time_end=").concat(i.toISOString(),"&limit=50");try{return(await Fr.get(r,{headers:{"X-CoinAPI-Key":"ABD6D56C-E25E-429C-B515-97F46B555BCC"}})).data}catch(t){throw console.error("Error fetching data:",t),t}})(t,e,n,i),o={datasets:[{label:"Candlestick",data:r.map((t=>({x:new Date(t.time_period_start),o:t.rate_open,h:t.rate_high,l:t.rate_low,c:t.rate_close}))),borderColor:"rgba(0, 0, 255, 0.5)",backgroundColor:"rgba(0, 0, 255, 0.5)"}]};return localStorage.setItem(a,JSON.stringify(o)),o}catch(t){throw console.error("Error fetching data:",t),t}};var p_;const f_=mi.button(p_||(p_=function(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}(["\n  cursor: pointer;\n  border: none;\n  margin-top: 30px;\n  width: 200px;\n  height: 50px;\n  margin-left: 98px;\n  background-color: rgba(29, 41, 55);\n  border-radius: 5px;\n  font-size: 18px;\n  margin-bottom: 150px;\n  color: rgba(255, 255, 255, 0.693);\n"])));var m_,g_,__,y_,x_,v_,b_,w_;function A_(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}const C_=_i(m_||(m_=A_(["\n  0% {\n    transform: translateY(0);\n  }\n  50% {\n    transform: translateY(-4px);\n  }\n  100% {\n    transform: translateY(0);\n  }\n"]))),E_=_i(g_||(g_=A_(["\n  0% {\n    transform: translateY(0);\n  }\n  50% {\n    transform: translateY(-7px);\n  }\n  100% {\n    transform: translateY(0);\n  }\n"]))),T_=_i(__||(__=A_(["\n  0% {\n    transform: translateY(0);\n  }\n  50% {\n    transform: translateY(-5px);\n  }\n  100% {\n    transform: translateY(0);\n  }\n"]))),S_=mi.p(y_||(y_=A_(["\n  font-size: 35px;\n  text-align: center;\n"]))),M_=mi.span(x_||(x_=A_(["\n  animation: "," 1.3s infinite;\n  display: inline-block;\n  margin: 0 2px;\n"])),C_),k_=mi.span(v_||(v_=A_(["\n  animation: "," 1.1s infinite;\n  display: inline-block;\n  margin: 0 2px;\n"])),E_),I_=mi.span(b_||(b_=A_(["\n  animation: "," 1.3s infinite;\n  display: inline-block;\n  margin: 0 2px;\n"])),T_),P_=(mi.span(w_||(w_=A_(["\n  color: rgba(70, 184, 48, 0.8);\n"]))),()=>n.createElement(S_,null,"Loading",n.createElement(M_,null,"."),n.createElement(k_,null,"."),n.createElement(I_,null,".")));function z_(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,"string");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class D_ extends n.Component{constructor(t){super(t),z_(this,"loadData",(()=>{const{addMessage:t,clearMessages:e}=this.context;(async(t,e,n,i)=>{const{firstCurrency:a,secondCurrency:r,startDate:o,endDate:s}=t;try{e({barChartData:await d_(a,r,o,s)}),i(),n("The graph has been successfully built!")}catch(t){console.error("Error fetching data:",t)}})(this.state,this.setState.bind(this),t,e)})),z_(this,"handleModalOpen",(()=>{this.setState({isModalOpen:!0})})),z_(this,"handleModalClose",(()=>{this.setState({isModalOpen:!1})})),z_(this,"handleFirstCurrencyChange",(t=>{this.setState({firstCurrency:t.target.value})})),z_(this,"handleSecondCurrencyChange",(t=>{this.setState({secondCurrency:t})})),this.state={isModalOpen:!1,barChartData:null,firstCurrency:"BTC",secondCurrency:"USD",startDate:new Date(Date.now()-2592e6),endDate:new Date,dateError:null}}componentDidMount(){this.loadData()}componentDidUpdate(t,e){const{firstCurrency:n,secondCurrency:i,startDate:a,endDate:r}=this.state;n===e.firstCurrency&&i===e.secondCurrency&&a===e.startDate&&r===e.endDate||this.loadData()}render(){const{isModalOpen:t,barChartData:e,firstCurrency:i,secondCurrency:a,startDate:r,endDate:o,dateError:s}=this.state,{clearMessages:l}=this.context,c=((t,e,n)=>i=>{const a=new Date(i.target.value);((t,e)=>{const n=(e.getTime()-t.getTime())/864e5;return n>=30&&n<=50})(a,t.endDate)?e({startDate:a,dateError:null}):(e({dateError:"The difference between the start date and the current date must be no less than 30 days and no more than 50 days"}),n())})(this.state,this.setState.bind(this),l);return n.createElement("div",null,n.createElement(nc,{value:i,onChange:this.handleFirstCurrencyChange}),n.createElement(f_,{onClick:this.handleModalOpen,"data-testid":"change-parameters-button"},"Change parameters"),n.createElement(h_,{isOpen:t,onClose:this.handleModalClose,secondCurrency:a,setSecondCurrency:this.handleSecondCurrencyChange,startDate:r,handleStartDateChange:c,endDate:o,dateError:s}),e?n.createElement(Yg,{data:e}):n.createElement(P_,null))}}var L_,B_,O_,R_;function F_(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}z_(D_,"contextType",o_);const N_=mi.div(L_||(L_=F_(["\n  margin-left: 200px;\n\n  @media (max-width: 450px) {\n    margin-left: 50px;\n  }\n"]))),j_=mi.h1(B_||(B_=F_([""]))),V_=mi.h3(O_||(O_=F_(["\n  margin-top: 40px;\n"]))),U_=mi.p(R_||(R_=F_([""]))),G_=()=>n.createElement(N_,null,n.createElement(j_,null,"Contact Us"),n.createElement(V_,null,"Office Address:"),n.createElement(U_,null,"MODSEN Exchange"),n.createElement(U_,null,"11 Wall St, Suite 45 "),n.createElement(U_,null,"New York, NY 10005, USA"),n.createElement(V_,null,"Phone:"),n.createElement(U_,null,"+1 212 123-4567"),n.createElement(V_,null,"Email:"),n.createElement(U_,null,"info@modsenexchange.com"),n.createElement(V_,null,"Customer Support:"),n.createElement(U_,null,"support@abcexchange.com"),n.createElement(V_,null,"Working Hours:"),n.createElement(U_,null,"Monday - Friday: 9:00 AM - 6:00 PM"),n.createElement(U_,null,"Saturday - Sunday: Closed"));var q_,$_,W_,H_,Z_,Y_,X_,K_;function Q_(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}const J_=mi.div(q_||(q_=Q_(["\n  margin-top: 105px;\n"]))),ty=mi.div($_||($_=Q_(["\n  margin: 20px;\n  display: flex;\n  justify-content: center;\n"]))),ey=mi.p(W_||(W_=Q_(["\n  font-size: 38px;\n  font-weight: 400;\n  line-height: 57px;\n  text-align: center;\n\n  @media (max-width: 450px) {\n    font-size: 25px;\n    line-height: 37px;\n  }\n"]))),ny=mi.div(H_||(H_=Q_(["\n  position: relative;\n  width: 300px;\n"]))),iy=mi.input(Z_||(Z_=Q_(["\n  max-width: 243px;\n  padding: 15px;\n  padding-right: 40px;\n  font-size: 16px;\n  border-radius: 4px;\n  border: 1px solid rgba(27, 32, 40, 1);\n  width: 100%;\n  background: ",";\n  color: rgba(211, 211, 211);\n"])),(t=>{let{theme:e}=t;return e.searchBackground})),ay=mi.button(Y_||(Y_=Q_(["\n  position: absolute;\n  top: 50%;\n  right: 10px;\n  transform: translateY(-50%);\n  border: none;\n  background: none;\n  cursor: pointer;\n\n  img {\n    width: 20px;\n    height: 20px;\n  }\n"]))),ry=mi.ul(X_||(X_=Q_(["\n  position: absolute;\n  top: 60px;\n  left: 0;\n  right: 0;\n  background: rgba(27, 32, 40, 1);\n  border: 1px solid rgba(27, 32, 40, 1);\n  border-top: none;\n  max-height: 150px;\n  overflow-y: auto;\n  z-index: 10;\n  list-style: none;\n  padding: 0;\n  margin: 0;\n"]))),oy=mi.li(K_||(K_=Q_(["\n  padding: 10px;\n  cursor: pointer;\n  color: rgba(211, 211, 211);\n\n  &:hover {\n    background-color: rgba(63, 68, 76, 1);\n  }\n"]))),sy=a.p+"images/search.png",ly=["Commercial Dollar","Canadian Dollar","Australian Dollar","Euro","Libra","Argentinian Peso","Yen","Yuan"];class cy extends n.Component{constructor(t){super(t),this.state={searchTerm:"",searchResults:[],showSuggestions:!1},this.handleInputChange=this.handleInputChange.bind(this),this.handleFormSubmit=this.handleFormSubmit.bind(this),this.handleSuggestionClick=this.handleSuggestionClick.bind(this),this.handleContainerClick=this.handleContainerClick.bind(this),this.handleOutsideClick=this.handleOutsideClick.bind(this)}handleInputChange(t){const e=t.target.value,n=ly.filter((t=>t.toLowerCase().includes(e.toLowerCase())));this.setState({searchTerm:e,searchResults:n,showSuggestions:!0})}handleFormSubmit(t){t.preventDefault(),this.props.onSearch(this.state.searchTerm)}handleSuggestionClick(t){this.setState({searchTerm:t,searchResults:[],showSuggestions:!1})}handleContainerClick(){this.setState({showSuggestions:!0})}handleOutsideClick(t){this.containerRef&&!this.containerRef.contains(t.target)&&this.setState({showSuggestions:!1})}componentDidMount(){document.addEventListener("click",this.handleOutsideClick)}componentWillUnmount(){document.removeEventListener("click",this.handleOutsideClick)}render(){const{searchTerm:t,searchResults:e,showSuggestions:i}=this.state;return n.createElement(J_,null,n.createElement(ey,null,"Search currency in the bank"),n.createElement(ty,{ref:t=>this.containerRef=t},n.createElement("form",{onSubmit:this.handleFormSubmit},n.createElement(ny,{onClick:this.handleContainerClick},n.createElement(iy,{type:"text",placeholder:"Currency search...",value:t,onChange:this.handleInputChange}),n.createElement(ay,{type:"submit"},n.createElement("img",{src:sy,alt:"Search Button"})),i&&e.length>0&&n.createElement(ry,null,e.map(((t,e)=>n.createElement(oy,{key:e,onClick:()=>this.handleSuggestionClick(t)},t))))))))}}cy.propTypes={onSearch:Ts().func.isRequired};var uy,hy,dy=a(842),py=a.n(dy),fy=a(6965),my={};function gy(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}my.styleTagTransform=Ll(),my.setAttributes=Il(),my.insert=Ml().bind(null,"head"),my.domAPI=Tl(),my.insertStyleElement=zl(),Cl()(fy.A,my),fy.A&&fy.A.locals&&fy.A.locals;const _y=mi.div(uy||(uy=gy(["\n  margin-top: 80px;\n  display: flex;\n  justify-content: center;\n"]))),yy=mi.div(hy||(hy=gy(["\n  width: 1000px;\n  height: 500px;\n  display: flex;\n  justify-content: center;\n\n  @media (max-width: 500px) {\n    width: 370px;\n    height: 400px;\n  }\n"])));py().accessToken="pk.eyJ1IjoibWF4aW1kYXZpZHNvbiIsImEiOiJjbHluMDl3YTYwMTV4MnFyM20xYzc5bmowIn0.ZSWv34EHZKQP_5ywH-e4ng";class xy extends n.Component{constructor(t){super(t),this.mapContainer=n.createRef()}componentDidMount(){const{userLocation:t,banks:e}=this.props;this.map=new(py().Map)({container:this.mapContainer.current,style:"mapbox://styles/mapbox/streets-v11",center:[t.lon,t.lat],zoom:12}),new(py().Marker)({color:"blue"}).setLngLat([t.lon,t.lat]).setPopup((new(py().Popup)).setText("You are here")).addTo(this.map),this.map.on("load",(()=>{this.map.getSource("banks")&&this.map.removeSource("banks");const t=e.filter((t=>{let{location:e}=t;return e&&e.lon&&e.lat}));this.map.addSource("banks",{type:"geojson",data:{type:"FeatureCollection",features:t.map((t=>{let{location:{lon:e,lat:n},name:i,currencies:a}=t;return{type:"Feature",geometry:{type:"Point",coordinates:[e,n]},properties:{title:i,description:a}}}))}}),t.forEach((t=>{let{location:{lon:e,lat:n},name:i,currencies:a}=t;new(py().Marker)({color:"red"}).setLngLat([e,n]).setPopup((new(py().Popup)).setHTML("<strong>".concat(i,"</strong><br/>").concat(a.join(", ")))).addTo(this.map)}))}))}componentDidUpdate(t){t.banks!==this.props.banks&&this.componentDidMount()}componentWillUnmount(){this.map.remove()}render(){return n.createElement(_y,null,n.createElement(yy,{ref:this.mapContainer}))}}xy.propTypes={userLocation:Ts().shape({lon:Ts().number.isRequired,lat:Ts().number.isRequired}).isRequired,banks:Ts().arrayOf(Ts().shape({location:Ts().shape({lon:Ts().number,lat:Ts().number}),name:Ts().string,currencies:Ts().arrayOf(Ts().string)})).isRequired};class vy{static getUserLocation(t,e){navigator.geolocation?navigator.geolocation.getCurrentPosition(t,e):console.error("Geolocation is not supported by this browser.")}}const by=[{name:"Belagroprombank",currencies:["Commercial Dollar","Euro","Yuan"]},{name:"Belarusbank",currencies:["Commercial Dollar","Euro","Yen"]},{name:"MTBank",currencies:["Libra","Euro","Yuan","Commercial Dollar"]},{name:"Belinvestbank",currencies:["Australian Dollar","Euro","Yen"]},{name:"Bank BelVEB",currencies:["Canadian Dollar","Australian Dollar","Euro"]},{name:"Alfa Bank",currencies:["Commercial Dollar","Euro","Argentinian Peso"]},{name:"Priorbank",currencies:["Libra","Euro","Yuan","Commercial Dollar","Canadian Dollar"]}];function wy(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,"string");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class Ay extends n.Component{constructor(){super(...arguments),wy(this,"state",{userLocation:null,banks:by,filteredBanks:[]}),wy(this,"onSuccessGetCurrentPosition",(t=>{const{latitude:e,longitude:n}=t.coords;this.setState({userLocation:{lat:e,lon:n}},this.generateBankLocations)})),wy(this,"generateBankLocations",(()=>{const{userLocation:t,banks:e}=this.state,n=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;return e.map((e=>{const i=Math.random()*n,a=2*Math.random()*Math.PI,r=i/6371*(180/Math.PI),o=i/(6371*Math.cos(Math.PI*t.lat/180))*(180/Math.PI);return{...e,location:{lat:t.lat+r*Math.cos(a),lon:t.lon+o*Math.sin(a)}}}))}(t,e);this.setState({banks:n})})),wy(this,"handleSearch",(t=>{const{banks:e}=this.state,n=e.filter((e=>e.currencies.includes(t)));this.setState({filteredBanks:n})}))}componentDidMount(){vy.getUserLocation(this.onSuccessGetCurrentPosition,this.onErrorGetCurrentPosition)}render(){const{filteredBanks:t,userLocation:e}=this.state,i=t.length>0?t:this.state.banks;return n.createElement("div",null,n.createElement(cy,{onSearch:this.handleSearch}),null!==e?n.createElement(xy,{userLocation:e,banks:i}):n.createElement(P_,null))}}class Cy extends n.Component{constructor(t){super(t),this.state={hasError:!1}}static getDerivedStateFromError(){return{hasError:!0}}static logErrorToMyService(t,e){console.error("Caught an error:",t,e)}componentDidCatch(t,e){Cy.logErrorToMyService(t,e)}render(){const{hasError:t}=this.state,{children:e}=this.props;return t?n.createElement("h1",null,"Something went wrong."):e}}Cy.propTypes={children:Ts().node.isRequired};const Ey=a.p+"images/ModsenCurrencyTracker.png",Ty=[{title:"General",links:["Market","Service"]},{title:"Product",links:["Sparks","Snaps"]},{title:"Community",links:["Ideas","Streams"]}];var Sy,My,ky,Iy,Py,zy,Dy,Ly,By,Oy,Ry;function Fy(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}const Ny=mi.footer(Sy||(Sy=Fy(["\n  margin-top: 250px;\n  margin-bottom: 40px;\n  @media (max-width: 450px) {\n    margin-top: 200px;\n  }\n"]))),jy=mi.div(My||(My=Fy(["\n  padding-left: 131px;\n  padding-right: 120px;\n  @media (max-width: 581px) {\n    padding-left: 15px;\n    padding-right: 1px;\n  }\n  @media (max-width: 481px) {\n    padding-left: 55px;\n    padding-right: 1px;\n  }\n  @media (max-width: 450px) {\n    padding-left: 25px;\n    padding-right: 1px;\n  }\n"]))),Vy=mi.div(ky||(ky=Fy(["\n  display: grid;\n  grid-template-columns: repeat(2, 1fr);\n  grid-gap: 100px;\n  @media (max-width: 900px) {\n    grid-template-columns: repeat(1, 1fr);\n    grid-gap: 70px;\n  }\n  @media (max-width: 450px) {\n    grid-gap: 10px;\n  }\n"]))),Uy=mi.section(Iy||(Iy=Fy([""]))),Gy=mi.div(Py||(Py=Fy(["\n  display: flex;\n  align-items: center;\n  gap: 20px;\n"]))),qy=mi.img(zy||(zy=Fy(["\n  height: auto;\n  @media (max-width: 450px) {\n    max-width: 190px; /* Ширина для маленьких экранов */\n  }\n"]))),$y=mi.p(Dy||(Dy=Fy(["\n  max-width: 482px;\n  font-size: 24px;\n  font-weight: 300;\n  line-height: 36px;\n  margin-top: ",";\n  @media (max-width: 900px) {\n    font-size: 22px;\n  }\n  @media (max-width: 670px) {\n    font-size: 18px;\n  }\n  @media (max-width: 450px) {\n    font-size: 16px;\n  }\n"])),(t=>{let{theme:e}=t;return e.spacing.medium})),Wy=mi.section(Ly||(Ly=Fy(["\n  display: grid;\n  grid-template-columns: repeat(3, 1fr);\n  grid-gap: 78px;\n  @media (max-width: 900px) {\n    grid-gap: 58px;\n  }\n"]))),Hy=mi.h2(By||(By=Fy(["\n  font-size: 28px;\n  font-weight: 400;\n  line-height: 42px;\n  padding-bottom: 20px;\n  @media (max-width: 900px) {\n    padding-bottom: 15px;\n    font-size: ",";\n  }\n  @media (max-width: 670px) {\n    font-size: 18px;\n  }\n  @media (max-width: 450px) {\n    font-size: 14px;\n  }\n"])),(t=>{let{theme:e}=t;return e.fontSize.pMobile})),Zy=mi.a(Oy||(Oy=Fy(["\n  color: rgba(137, 137, 137, 1);\n  font-size: 24px;\n  font-weight: 400;\n  line-height: 36px;\n  text-decoration: none;\n  display: block;\n\n  &:hover {\n    opacity: 0.7;\n  }\n  @media (max-width: 900px) {\n    font-size: 22px;\n  }\n  @media (max-width: 670px) {\n    font-size: 18px;\n  }\n"]))),Yy=mi.p(Ry||(Ry=Fy(["\n  text-align: center;\n  font-family: 'Inter', sans-serif;\n  font-size: 24px;\n  font-weight: 400;\n  line-height: 36px;\n  color: rgba(137, 137, 137, 1);\n  margin-top: 54px;\n  @media (max-width: 900px) {\n    font-size: 22px;\n  }\n  @media (max-width: 670px) {\n    font-size: 16px;\n  }\n  @media (max-width: 450px) {\n    font-size: 14px;\n  }\n"]))),Xy=()=>n.createElement(Ny,null,n.createElement(jy,null,n.createElement(Vy,null,n.createElement(Uy,null,n.createElement(Gy,null,n.createElement(qy,{src:Ur,alt:"Logo"}),n.createElement(qy,{src:Ey,alt:"Modsen Currency Tracker"})),n.createElement($y,null,"Since then, the company has grown organically to. Starsup is the world's largest trading platform, with $12 billion worth of currency trading and 500,000 tickets sold daily to tens of thousands of traders worldwide.")),n.createElement(Wy,null,Ty.map((t=>n.createElement("nav",{key:t.title},n.createElement(Hy,null,t.title),t.links.map((t=>n.createElement(Zy,{key:t,href:"#!"},t)))))))),n.createElement(Yy,null,"Startsup © 2023-2024, All Rights Reserved"))),Ky=()=>n.createElement(Cy,null,n.createElement(Ei,null,n.createElement(Si,null),n.createElement(Ho,null),n.createElement(s_,null,n.createElement(ut,null,n.createElement(lt,{path:"/",element:n.createElement(Rl,null)}),n.createElement(lt,{path:To,element:n.createElement(D_,null)}),n.createElement(lt,{path:So,element:n.createElement(Ay,null)}),n.createElement(lt,{path:Mo,element:n.createElement(G_,null)})),n.createElement(Xy,null))));r.createRoot(document.getElementById("root")).render(n.createElement(n.StrictMode,null,n.createElement(yt,null,n.createElement(Ky,null))))})()})();
//# sourceMappingURL=bundle.js.map